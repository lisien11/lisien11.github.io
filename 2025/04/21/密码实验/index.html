<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>å¯†ç å®éªŒ | Lçš„åšå®¢</title><meta name="author" content="L"><meta name="copyright" content="L"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="ä»¿å°„å¯†ç 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152from math import gcddef text_to_numbers(text):    return [ord(char) - ord(&#x27;a&#x27;) for char in">
<meta property="og:type" content="article">
<meta property="og:title" content="å¯†ç å®éªŒ">
<meta property="og:url" content="https://lisien11.xyz/2025/04/21/%E5%AF%86%E7%A0%81%E5%AE%9E%E9%AA%8C/index.html">
<meta property="og:site_name" content="Lçš„åšå®¢">
<meta property="og:description" content="ä»¿å°„å¯†ç 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152from math import gcddef text_to_numbers(text):    return [ord(char) - ord(&#x27;a&#x27;) for char in">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover94.jpg">
<meta property="article:published_time" content="2025-04-21T11:25:07.000Z">
<meta property="article:modified_time" content="2025-04-21T13:50:39.557Z">
<meta property="article:author" content="L">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover94.jpg"><link rel="shortcut icon" href="/img/1.jpg"><link rel="canonical" href="https://lisien11.xyz/2025/04/21/%E5%AF%86%E7%A0%81%E5%AE%9E%E9%AA%8C/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":true,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}","hits_stats":"å…±æ‰¾åˆ° ${hits} ç¯‡æ–‡ç« "}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'å¯†ç å®éªŒ',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-04-21 21:50:39'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/LSE.css"><meta name="generator" content="Hexo 7.0.0"><link rel="alternate" href="/atom.xml" title="Lçš„åšå®¢" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/%E5%9B%BE%E7%89%87/1231.jpg" onerror="onerror=null;src='/img/lll.png'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">148</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">46</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">43</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é </span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> ä¸ªäººå†™çš„å°Demo</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> ä¿¡æ¯æ”¶é›†</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> ç…§ç‰‡</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> ç”µå½±</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹æƒ…é“¾æ¥</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover94.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Lçš„åšå®¢"><span class="site-name">Lçš„åšå®¢</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é </span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> ä¸ªäººå†™çš„å°Demo</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> ä¿¡æ¯æ”¶é›†</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> ç…§ç‰‡</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> ç”µå½±</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹æƒ…é“¾æ¥</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">å¯†ç å®éªŒ</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2025-04-21T11:25:07.000Z" title="å‘è¡¨äº 2025-04-21 19:25:07">2025-04-21</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2025-04-21T13:50:39.557Z" title="æ›´æ–°äº 2025-04-21 21:50:39">2025-04-21</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">8.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>36åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span id="" data-flag-title="å¯†ç å®éªŒ"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="twikoo_visitors"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="ä»¿å°„å¯†ç "><a href="#ä»¿å°„å¯†ç " class="headerlink" title="ä»¿å°„å¯†ç "></a>ä»¿å°„å¯†ç </h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">text_to_numbers</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">ord</span>(char) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) <span class="keyword">for</span> char <span class="keyword">in</span> text.lower() <span class="keyword">if</span> char.isalpha()]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encryption</span>(<span class="params">m, a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> gcd(a, <span class="number">26</span>) != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;å¯†é’¥aå¿…é¡»ä¸26äº’è´¨ï¼&quot;</span></span><br><span class="line">    numbers = text_to_numbers(m)</span><br><span class="line">    encrypted_number = [(a * num + b) % <span class="number">26</span> <span class="keyword">for</span> num <span class="keyword">in</span> numbers]</span><br><span class="line">    encrypted_text = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(num + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)) <span class="keyword">for</span> num <span class="keyword">in</span> encrypted_number)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;åŠ å¯†åçš„å¯†æ–‡æ˜¯ï¼š&#123;&#125;&quot;</span>.<span class="built_in">format</span>(encrypted_text))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decryption</span>(<span class="params">c, a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> gcd(a, <span class="number">26</span>) != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;å¯†é’¥aå¿…é¡»ä¸26äº’è´¨ï¼&quot;</span></span><br><span class="line">    encode_c = text_to_numbers(c)</span><br><span class="line">    a_1 = <span class="built_in">pow</span>(a, -<span class="number">1</span>, <span class="number">26</span>)</span><br><span class="line">    decryption_number = [(a_1 * (num - b)) % <span class="number">26</span> <span class="keyword">for</span> num <span class="keyword">in</span> encode_c]</span><br><span class="line">    decryption_text = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(num + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)) <span class="keyword">for</span> num <span class="keyword">in</span> decryption_number)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è§£å¯†åçš„æ˜æ–‡æ˜¯ï¼š&#123;&#125;&quot;</span>.<span class="built_in">format</span>(decryption_text))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_valid_key_a</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;è¯·è¾“å…¥å¯†é’¥aï¼ˆå¿…é¡»ä¸26äº’è´¨ï¼‰ï¼š&quot;</span>))</span><br><span class="line">        <span class="keyword">if</span> gcd(a, <span class="number">26</span>) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> a</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;å¯†é’¥aå¿…é¡»ä¸26äº’è´¨ï¼Œè¯·é‡æ–°è¾“å…¥ï¼&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;******ä»¿å°„å¯†ç ******&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è¯·é€‰æ‹©æ“ä½œï¼š&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;1ï¼šåŠ å¯†&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;2ï¼šè§£å¯†&quot;</span>)</span><br><span class="line"></span><br><span class="line">    choose = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;è¯·è¾“å…¥é€‰é¡¹ï¼ˆ1æˆ–2ï¼‰ï¼š&quot;</span>))</span><br><span class="line">    <span class="keyword">if</span> choose == <span class="number">1</span>:</span><br><span class="line">        m = <span class="built_in">input</span>(<span class="string">&quot;è¯·è¾“å…¥æ˜æ–‡ï¼š&quot;</span>)</span><br><span class="line">        a = get_valid_key_a()</span><br><span class="line">        b = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;è¯·è¾“å…¥å¯†é’¥bï¼š&quot;</span>))</span><br><span class="line">        encryption(m, a, b)</span><br><span class="line">    <span class="keyword">elif</span> choose == <span class="number">2</span>:</span><br><span class="line">        c = <span class="built_in">input</span>(<span class="string">&quot;è¯·è¾“å…¥å¯†æ–‡ï¼š&quot;</span>)</span><br><span class="line">        a = get_valid_key_a()</span><br><span class="line">        b = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;è¯·è¾“å…¥å¯†é’¥bï¼š&quot;</span>))</span><br><span class="line">        decryption(c, a, b)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;æ— æ•ˆé€‰é¡¹ï¼Œè¯·é‡æ–°è¿è¡Œç¨‹åºå¹¶è¾“å…¥1æˆ–2ã€‚&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<h2 id="è§£é‡Š"><a href="#è§£é‡Š" class="headerlink" title="è§£é‡Š"></a>è§£é‡Š</h2><p>å¥½çš„ï¼Œæˆ‘ä»¬æ¥è¯¦ç»†è®²è§£ä¸€ä¸‹ <strong>ä»¿å°„å¯†ç </strong> åŠä½ è´´å‡ºæ¥çš„è¿™æ®µ Python ä»£ç ï¼Œå¸®ä½ ç†è§£å®ƒçš„åŸç†å’Œå®ç°ã€‚</p>
<hr>
<h2 id="ğŸ”-ä¸€ã€ä»€ä¹ˆæ˜¯ä»¿å°„å¯†ç ï¼ˆAffine-Cipherï¼‰ï¼Ÿ"><a href="#ğŸ”-ä¸€ã€ä»€ä¹ˆæ˜¯ä»¿å°„å¯†ç ï¼ˆAffine-Cipherï¼‰ï¼Ÿ" class="headerlink" title="ğŸ” ä¸€ã€ä»€ä¹ˆæ˜¯ä»¿å°„å¯†ç ï¼ˆAffine Cipherï¼‰ï¼Ÿ"></a>ğŸ” ä¸€ã€ä»€ä¹ˆæ˜¯ä»¿å°„å¯†ç ï¼ˆAffine Cipherï¼‰ï¼Ÿ</h2><p>ä»¿å°„å¯†ç æ˜¯ä¸€ç§<strong>å¤å…¸åŠ å¯†ç®—æ³•</strong>ï¼Œå±äºå•å­—æ¯æ›¿æ¢å¯†ç çš„èŒƒç•´ã€‚å®ƒç»“åˆäº†ä¸¤ä¸ªæ•°å­¦å˜æ¢ï¼š</p>
<ul>
<li>çº¿æ€§å˜æ¢ï¼ˆä¹˜æ³•+åŠ æ³•ï¼‰</li>
<li>æ¨¡è¿ç®—ï¼ˆå–ä½™ï¼‰</li>
</ul>
<h3 id="åŠ å¯†å…¬å¼ï¼š"><a href="#åŠ å¯†å…¬å¼ï¼š" class="headerlink" title="åŠ å¯†å…¬å¼ï¼š"></a>åŠ å¯†å…¬å¼ï¼š</h3><p>å¯¹æ¯ä¸ªæ˜æ–‡å­—æ¯ç”¨ä»¥ä¸‹å…¬å¼å˜æ¢ï¼š</p>
<p>[<br>E(x) = (a \cdot x + b) \mod 26<br>]</p>
<ul>
<li>( x )ï¼šæ˜æ–‡å­—æ¯åœ¨å­—æ¯è¡¨ä¸­çš„ä½ç½®ï¼ˆ0~25ï¼‰</li>
<li>( a, b )ï¼šå¯†é’¥å‚æ•°</li>
<li>( \mod 26 )ï¼šå› ä¸ºè‹±æ–‡å­—æ¯æœ‰26ä¸ªï¼Œæ‰€ä»¥å¯¹26å–ä½™</li>
</ul>
<h3 id="è§£å¯†å…¬å¼ï¼š"><a href="#è§£å¯†å…¬å¼ï¼š" class="headerlink" title="è§£å¯†å…¬å¼ï¼š"></a>è§£å¯†å…¬å¼ï¼š</h3><p>[<br>D(y) = a^{-1} \cdot (y - b) \mod 26<br>]</p>
<ul>
<li>( y )ï¼šå¯†æ–‡å­—æ¯åœ¨å­—æ¯è¡¨ä¸­çš„ä½ç½®</li>
<li>( a^{-1} )ï¼šæ¨¡ 26 ä¸‹çš„ ( a ) çš„ä¹˜æ³•é€†å…ƒï¼ˆå³æ»¡è¶³ ( a \cdot a^{-1} \equiv 1 \mod 26 ) çš„æ•´æ•°ï¼‰</li>
</ul>
<blockquote>
<p><strong>æ³¨æ„ï¼š</strong>åªæœ‰å½“ ( \gcd(a, 26) = 1 ) æ—¶ï¼Œä¹˜æ³•é€†å…ƒ ( a^{-1} ) æ‰å­˜åœ¨ï¼Œæ‰€ä»¥ <strong>a å¿…é¡»ä¸ 26 äº’è´¨</strong>ã€‚</p>
</blockquote>
<hr>
<h2 id="ğŸ§ -äºŒã€ä»£ç é€æ­¥è§£é‡Š"><a href="#ğŸ§ -äºŒã€ä»£ç é€æ­¥è§£é‡Š" class="headerlink" title="ğŸ§  äºŒã€ä»£ç é€æ­¥è§£é‡Š"></a>ğŸ§  äºŒã€ä»£ç é€æ­¥è§£é‡Š</h2><h3 id="1-text-to-numbers-text"><a href="#1-text-to-numbers-text" class="headerlink" title="1. text_to_numbers(text)"></a>1. <code>text_to_numbers(text)</code></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">text_to_numbers</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">ord</span>(char) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) <span class="keyword">for</span> char <span class="keyword">in</span> text.lower() <span class="keyword">if</span> char.isalpha()]</span><br></pre></td></tr></table></figure>
<p><strong>åŠŸèƒ½ï¼š</strong> æŠŠæ–‡æœ¬è½¬æ¢ä¸ºå­—æ¯åœ¨å­—æ¯è¡¨ä¸­çš„æ•°å­—ï¼ˆa=0, b=1, â€¦, z=25ï¼‰</p>
<p>ä¾‹å­ï¼š<code>text_to_numbers(&quot;abc&quot;)</code> è¾“å‡º <code>[0, 1, 2]</code></p>
<hr>
<h3 id="2-encryption-m-a-b"><a href="#2-encryption-m-a-b" class="headerlink" title="2. encryption(m, a, b)"></a>2. <code>encryption(m, a, b)</code></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">encryption</span>(<span class="params">m, a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> gcd(a, <span class="number">26</span>) != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;å¯†é’¥aå¿…é¡»ä¸26äº’è´¨ï¼&quot;</span></span><br><span class="line">    numbers = text_to_numbers(m)</span><br><span class="line">    encrypted_number = [(a * num + b) % <span class="number">26</span> <span class="keyword">for</span> num <span class="keyword">in</span> numbers]</span><br><span class="line">    encrypted_text = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(num + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)) <span class="keyword">for</span> num <span class="keyword">in</span> encrypted_number)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;åŠ å¯†åçš„å¯†æ–‡æ˜¯ï¼š&#123;&#125;&quot;</span>.<span class="built_in">format</span>(encrypted_text))</span><br></pre></td></tr></table></figure>
<p><strong>åŠŸèƒ½ï¼š</strong>ä½¿ç”¨ä»¿å°„åŠ å¯†å…¬å¼åŠ å¯†æ˜æ–‡</p>
<ul>
<li>å…ˆæŠŠæ˜æ–‡å˜æˆæ•°å­—åˆ—è¡¨</li>
<li>ç„¶åç”¨ <code>(a*x + b) % 26</code> åŠ å¯†</li>
<li>æœ€åæŠŠåŠ å¯†åçš„æ•°å­—å˜å›å­—æ¯ï¼Œæ‹¼æ¥è¾“å‡º</li>
</ul>
<hr>
<h3 id="3-decryption-c-a-b"><a href="#3-decryption-c-a-b" class="headerlink" title="3. decryption(c, a, b)"></a>3. <code>decryption(c, a, b)</code></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decryption</span>(<span class="params">c, a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> gcd(a, <span class="number">26</span>) != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;å¯†é’¥aå¿…é¡»ä¸26äº’è´¨ï¼&quot;</span></span><br><span class="line">    encode_c = text_to_numbers(c)</span><br><span class="line">    a_1 = <span class="built_in">pow</span>(a, -<span class="number">1</span>, <span class="number">26</span>)  <span class="comment"># æ±‚ a çš„æ¨¡é€†</span></span><br><span class="line">    decryption_number = [(a_1 * (num - b)) % <span class="number">26</span> <span class="keyword">for</span> num <span class="keyword">in</span> encode_c]</span><br><span class="line">    decryption_text = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(num + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)) <span class="keyword">for</span> num <span class="keyword">in</span> decryption_number)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è§£å¯†åçš„æ˜æ–‡æ˜¯ï¼š&#123;&#125;&quot;</span>.<span class="built_in">format</span>(decryption_text))</span><br></pre></td></tr></table></figure>
<p><strong>åŠŸèƒ½ï¼š</strong>ä»¿å°„è§£å¯†</p>
<ul>
<li>å…ˆæ±‚å‡º ( a^{-1} )</li>
<li>ç„¶åç”¨è§£å¯†å…¬å¼è§£å¯† <code>(a_inv * (y - b)) % 26</code></li>
<li>æœ€åè¿˜åŸæˆæ˜æ–‡è¾“å‡º</li>
</ul>
<hr>
<h3 id="4-get-valid-key-a"><a href="#4-get-valid-key-a" class="headerlink" title="4. get_valid_key_a()"></a>4. <code>get_valid_key_a()</code></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_valid_key_a</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;è¯·è¾“å…¥å¯†é’¥aï¼ˆå¿…é¡»ä¸26äº’è´¨ï¼‰ï¼š&quot;</span>))</span><br><span class="line">        <span class="keyword">if</span> gcd(a, <span class="number">26</span>) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> a</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;å¯†é’¥aå¿…é¡»ä¸26äº’è´¨ï¼Œè¯·é‡æ–°è¾“å…¥ï¼&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><strong>åŠŸèƒ½ï¼š</strong>ç¡®ä¿ç”¨æˆ·è¾“å…¥çš„ <code>a</code> åˆæ³•ï¼Œå³ä¸ 26 äº’è´¨ã€‚</p>
<hr>
<h3 id="5-main"><a href="#5-main" class="headerlink" title="5. main()"></a>5. <code>main()</code></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;******ä»¿å°„å¯†ç ******&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è¯·é€‰æ‹©æ“ä½œï¼š&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;1ï¼šåŠ å¯†&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;2ï¼šè§£å¯†&quot;</span>)</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>
<p><strong>åŠŸèƒ½ï¼š</strong>ä¸»ç¨‹åºå…¥å£</p>
<ul>
<li>ç”¨æˆ·é€‰æ‹©åŠ å¯†æˆ–è§£å¯†</li>
<li>ç„¶åè¾“å…¥æ˜æ–‡æˆ–å¯†æ–‡åŠå¯†é’¥</li>
<li>è°ƒç”¨åŠ å¯†æˆ–è§£å¯†å‡½æ•°</li>
</ul>
<hr>
<h2 id="ğŸ§ª-ä¸‰ã€å®éªŒæ“ä½œæ­¥éª¤æ€»ç»“"><a href="#ğŸ§ª-ä¸‰ã€å®éªŒæ“ä½œæ­¥éª¤æ€»ç»“" class="headerlink" title="ğŸ§ª ä¸‰ã€å®éªŒæ“ä½œæ­¥éª¤æ€»ç»“"></a>ğŸ§ª ä¸‰ã€å®éªŒæ“ä½œæ­¥éª¤æ€»ç»“</h2><ol>
<li>æ‰“å¼€ Python å¼€å‘ç¯å¢ƒï¼ˆå¦‚ IDLEã€PyCharm æˆ–ç»ˆç«¯ï¼‰</li>
<li>ç²˜è´´å¹¶è¿è¡Œä¸Šè¿°ä»£ç </li>
<li>æ ¹æ®æç¤ºè¾“å…¥ï¼š<ul>
<li>æ˜æ–‡æˆ–å¯†æ–‡</li>
<li>åˆæ³•çš„ <code>a</code>ï¼ˆä¸26äº’è´¨ï¼Œæ¯”å¦‚ 1, 3, 5, 7, 11â€¦ï¼‰</li>
<li>ä»»æ„æ•´æ•° <code>b</code></li>
</ul>
</li>
<li>æŸ¥çœ‹è¾“å‡ºçš„åŠ å¯†æˆ–è§£å¯†ç»“æœ</li>
</ol>
<hr>
<h2 id="âœ…-å››ã€å®éªŒç»“æœç¤ºä¾‹"><a href="#âœ…-å››ã€å®éªŒç»“æœç¤ºä¾‹" class="headerlink" title="âœ… å››ã€å®éªŒç»“æœç¤ºä¾‹"></a>âœ… å››ã€å®éªŒç»“æœç¤ºä¾‹</h2><h3 id="è¾“å…¥ï¼š"><a href="#è¾“å…¥ï¼š" class="headerlink" title="è¾“å…¥ï¼š"></a>è¾“å…¥ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¯·é€‰æ‹©æ“ä½œï¼š1</span><br><span class="line">è¯·è¾“å…¥æ˜æ–‡ï¼šhello</span><br><span class="line">è¯·è¾“å…¥å¯†é’¥aï¼š5</span><br><span class="line">è¯·è¾“å…¥å¯†é’¥bï¼š8</span><br></pre></td></tr></table></figure>
<h3 id="è¾“å‡ºï¼š"><a href="#è¾“å‡ºï¼š" class="headerlink" title="è¾“å‡ºï¼š"></a>è¾“å‡ºï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åŠ å¯†åçš„å¯†æ–‡æ˜¯ï¼šrclla</span><br></pre></td></tr></table></figure>
<p>ç„¶åç”¨ç›¸åŒçš„ a å’Œ b è§£å¯†ï¼š<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¯·é€‰æ‹©æ“ä½œï¼š2</span><br><span class="line">è¯·è¾“å…¥å¯†æ–‡ï¼šrclla</span><br><span class="line">è¯·è¾“å…¥å¯†é’¥aï¼š5</span><br><span class="line">è¯·è¾“å…¥å¯†é’¥bï¼š8</span><br></pre></td></tr></table></figure></p>
<p>è¾“å‡ºï¼š<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è§£å¯†åçš„æ˜æ–‡æ˜¯ï¼šhello</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="ğŸ’¡-äº”ã€å®éªŒå¿ƒå¾—"><a href="#ğŸ’¡-äº”ã€å®éªŒå¿ƒå¾—" class="headerlink" title="ğŸ’¡ äº”ã€å®éªŒå¿ƒå¾—"></a>ğŸ’¡ äº”ã€å®éªŒå¿ƒå¾—</h2><ul>
<li>ä»¿å°„å¯†ç æ˜¯ç†è§£æ›´å¤æ‚å¯†ç ç®—æ³•çš„åŸºç¡€ã€‚</li>
<li>é€šè¿‡æ‰‹åŠ¨ç¼–ç åŠ å¯†/è§£å¯†è¿‡ç¨‹ï¼Œå¯ä»¥åŠ æ·±å¯¹æ¨¡è¿ç®—å’Œé€†å…ƒçš„ç†è§£ã€‚</li>
<li>åŠ å¯†ç®—æ³•ä¸ä»…è¦ä¿è¯åŠ å¯†æ•ˆæœï¼Œè¿˜å¿…é¡»ä¿è¯å¯ä»¥è¿˜åŸï¼Œå³â€œå¯é€†æ€§â€ã€‚</li>
<li>Python çš„ <code>pow(a, -1, m)</code> å¾ˆæ–¹ä¾¿åœ°æ‰¾åˆ°äº†ä¹˜æ³•é€†å…ƒï¼Œä¸éœ€è¦æ‰‹å†™æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ã€‚</li>
</ul>
<hr>
<p>å¦‚æœä½ è¿˜æƒ³è¦ï¼š</p>
<ul>
<li>å›¾è§£åŠ å¯†è¿‡ç¨‹</li>
<li>å¯è§†åŒ–æ­¥éª¤</li>
<li>æ”¯æŒå¤§å†™å­—æ¯æˆ–ç©ºæ ¼</li>
</ul>
<p>æˆ‘ä¹Ÿå¯ä»¥å¸®ä½ æ‰©å±•è¿™ä¸ªç¨‹åºï¼è¦ä¸è¦æ¥ä¸ª GUI ç‰ˆæœ¬çš„ï¼ŸğŸ˜„</p>
<h1 id="DES"><a href="#DES" class="headerlink" title="DES"></a>DES</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># åˆå§‹ç½®æ¢ IP è¡¨ï¼ˆ64ä½ -&gt; 64ä½ï¼‰</span><br><span class="line">IP = [</span><br><span class="line">    58, 50, 42, 34, 26, 18, 10, 2,</span><br><span class="line">    60, 52, 44, 36, 28, 20, 12, 4,</span><br><span class="line">    62, 54, 46, 38, 30, 22, 14, 6,</span><br><span class="line">    64, 56, 48, 40, 32, 24, 16, 8,</span><br><span class="line">    57, 49, 41, 33, 25, 17, 9, 1,</span><br><span class="line">    59, 51, 43, 35, 27, 19, 11, 3,</span><br><span class="line">    61, 53, 45, 37, 29, 21, 13, 5,</span><br><span class="line">    63, 55, 47, 39, 31, 23, 15, 7</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># é€†åˆå§‹ç½®æ¢ IP^-1 è¡¨ï¼ˆ64ä½ -&gt; 64ä½ï¼‰</span><br><span class="line">IP_INV = [</span><br><span class="line">    40, 8, 48, 16, 56, 24, 64, 32,</span><br><span class="line">    39, 7, 47, 15, 55, 23, 63, 31,</span><br><span class="line">    38, 6, 46, 14, 54, 22, 62, 30,</span><br><span class="line">    37, 5, 45, 13, 53, 21, 61, 29,</span><br><span class="line">    36, 4, 44, 12, 52, 20, 60, 28,</span><br><span class="line">    35, 3, 43, 11, 51, 19, 59, 27,</span><br><span class="line">    34, 2, 42, 10, 50, 18, 58, 26,</span><br><span class="line">    33, 1, 41, 9, 49, 17, 57, 25</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># å¯†é’¥ç½®æ¢ PC-1 è¡¨ï¼ˆ64ä½ -&gt; 56ä½ï¼‰</span><br><span class="line">PC1 = [</span><br><span class="line">    57, 49, 41, 33, 25, 17, 9,</span><br><span class="line">    1, 58, 50, 42, 34, 26, 18,</span><br><span class="line">    10, 2, 59, 51, 43, 35, 27,</span><br><span class="line">    19, 11, 3, 60, 52, 44, 36,</span><br><span class="line">    63, 55, 47, 39, 31, 23, 15,</span><br><span class="line">    7, 62, 54, 46, 38, 30, 22,</span><br><span class="line">    14, 6, 61, 53, 45, 37, 29,</span><br><span class="line">    21, 13, 5, 28, 20, 12, 4</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># å¯†é’¥ç½®æ¢ PC-2 è¡¨ï¼ˆ56ä½ -&gt; 48ä½ï¼‰</span><br><span class="line">PC2 = [</span><br><span class="line">    14, 17, 11, 24, 1, 5,</span><br><span class="line">    3, 28, 15, 6, 21, 10,</span><br><span class="line">    23, 19, 12, 4, 26, 8,</span><br><span class="line">    16, 7, 27, 20, 13, 2,</span><br><span class="line">    41, 52, 31, 37, 47, 55,</span><br><span class="line">    30, 40, 51, 45, 33, 48,</span><br><span class="line">    44, 49, 39, 56, 34, 53,</span><br><span class="line">    46, 42, 50, 36, 29, 32</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># æ¯è½®å¾ªç¯å·¦ç§»ä½æ•°è¡¨ï¼ˆ16è½®ï¼‰</span><br><span class="line">SHIFT = [1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1]</span><br><span class="line"></span><br><span class="line"># æ‰©å±•ç½®æ¢ E è¡¨ï¼ˆ32ä½ -&gt; 48ä½ï¼‰</span><br><span class="line">E = [</span><br><span class="line">    32, 1, 2, 3, 4, 5,</span><br><span class="line">    4, 5, 6, 7, 8, 9,</span><br><span class="line">    8, 9, 10, 11, 12, 13,</span><br><span class="line">    12, 13, 14, 15, 16, 17,</span><br><span class="line">    16, 17, 18, 19, 20, 21,</span><br><span class="line">    20, 21, 22, 23, 24, 25,</span><br><span class="line">    24, 25, 26, 27, 28, 29,</span><br><span class="line">    28, 29, 30, 31, 32, 1</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># S ç›’å®šä¹‰ï¼ˆ8ä¸ª4x16çš„ç›’ï¼‰</span><br><span class="line">S_BOX = [</span><br><span class="line">    # S1</span><br><span class="line">    [</span><br><span class="line">        [14, 4, 13, 1, 2, 15, 11, 8, 3, 10, 6, 12, 5, 9, 0, 7],</span><br><span class="line">        [0, 15, 7, 4, 14, 2, 13, 1, 10, 6, 12, 11, 9, 5, 3, 8],</span><br><span class="line">        [4, 1, 14, 8, 13, 6, 2, 11, 15, 12, 9, 7, 3, 10, 5, 0],</span><br><span class="line">        [15, 12, 8, 2, 4, 9, 1, 7, 5, 11, 3, 14, 10, 0, 6, 13]</span><br><span class="line">    ],</span><br><span class="line">    # S2</span><br><span class="line">    [</span><br><span class="line">        [15, 1, 8, 14, 6, 11, 3, 4, 9, 7, 2, 13, 12, 0, 5, 10],</span><br><span class="line">        [3, 13, 4, 7, 15, 2, 8, 14, 12, 0, 1, 10, 6, 9, 11, 5],</span><br><span class="line">        [0, 14, 7, 11, 10, 4, 13, 1, 5, 8, 12, 6, 9, 3, 2, 15],</span><br><span class="line">        [13, 8, 10, 1, 3, 15, 4, 2, 11, 6, 7, 12, 0, 5, 14, 9]</span><br><span class="line">    ],</span><br><span class="line">    # S3</span><br><span class="line">    [</span><br><span class="line">        [10, 0, 9, 14, 6, 3, 15, 5, 1, 13, 12, 7, 11, 4, 2, 8],</span><br><span class="line">        [13, 7, 0, 9, 3, 4, 6, 10, 2, 8, 5, 14, 12, 11, 15, 1],</span><br><span class="line">        [13, 6, 4, 9, 8, 15, 3, 0, 11, 1, 2, 12, 5, 10, 14, 7],</span><br><span class="line">        [1, 10, 13, 0, 6, 9, 8, 7, 4, 15, 14, 3, 11, 5, 2, 12]</span><br><span class="line">    ],</span><br><span class="line">    # S4</span><br><span class="line">    [</span><br><span class="line">        [7, 13, 14, 3, 0, 6, 9, 10, 1, 2, 8, 5, 11, 12, 4, 15],</span><br><span class="line">        [13, 8, 11, 5, 6, 15, 0, 3, 4, 7, 2, 12, 1, 10, 14, 9],</span><br><span class="line">        [10, 6, 9, 0, 12, 11, 7, 13, 15, 1, 3, 14, 5, 2, 8, 4],</span><br><span class="line">        [3, 15, 0, 6, 10, 1, 13, 8, 9, 4, 5, 11, 12, 7, 2, 14]</span><br><span class="line">    ],</span><br><span class="line">    # S5</span><br><span class="line">    [</span><br><span class="line">        [2, 12, 4, 1, 7, 10, 11, 6, 8, 5, 3, 15, 13, 0, 14, 9],</span><br><span class="line">        [14, 11, 2, 12, 4, 7, 13, 1, 5, 0, 15, 10, 3, 9, 8, 6],</span><br><span class="line">        [4, 2, 1, 11, 10, 13, 7, 8, 15, 9, 12, 5, 6, 3, 0, 14],</span><br><span class="line">        [11, 8, 12, 7, 1, 14, 2, 13, 6, 15, 0, 9, 10, 4, 5, 3]</span><br><span class="line">    ],</span><br><span class="line">    # S6</span><br><span class="line">    [</span><br><span class="line">        [12, 1, 10, 15, 9, 2, 6, 8, 0, 13, 3, 4, 14, 7, 5, 11],</span><br><span class="line">        [10, 15, 4, 2, 7, 12, 9, 5, 6, 1, 13, 14, 0, 11, 3, 8],</span><br><span class="line">        [9, 14, 15, 5, 2, 8, 12, 3, 7, 0, 4, 10, 1, 13, 11, 6],</span><br><span class="line">        [4, 3, 2, 12, 9, 5, 15, 10, 11, 14, 1, 7, 6, 0, 8, 13]</span><br><span class="line">    ],</span><br><span class="line">    # S7</span><br><span class="line">    [</span><br><span class="line">        [4, 11, 2, 14, 15, 0, 8, 13, 3, 12, 9, 7, 5, 10, 6, 1],</span><br><span class="line">        [13, 0, 11, 7, 4, 9, 1, 10, 14, 3, 5, 12, 2, 15, 8, 6],</span><br><span class="line">        [1, 4, 11, 13, 12, 3, 7, 14, 10, 15, 6, 8, 0, 5, 9, 2],</span><br><span class="line">        [6, 11, 13, 8, 1, 4, 10, 7, 9, 5, 0, 15, 14, 2, 3, 12]</span><br><span class="line">    ],</span><br><span class="line">    # S8</span><br><span class="line">    [</span><br><span class="line">        [13, 2, 8, 4, 6, 15, 11, 1, 10, 9, 3, 14, 5, 0, 12, 7],</span><br><span class="line">        [1, 15, 13, 8, 10, 3, 7, 4, 12, 5, 6, 11, 0, 14, 9, 2],</span><br><span class="line">        [7, 11, 4, 1, 9, 12, 14, 2, 0, 6, 10, 13, 15, 3, 5, 8],</span><br><span class="line">        [2, 1, 14, 7, 4, 10, 8, 13, 15, 12, 9, 0, 3, 5, 6, 11]</span><br><span class="line">    ]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># P ç›’ç½®æ¢è¡¨ï¼ˆ32ä½ -&gt; 32ä½ï¼‰</span><br><span class="line">P = [</span><br><span class="line">    16, 7, 20, 21, 29, 12, 28, 17,</span><br><span class="line">    1, 15, 23, 26, 5, 18, 31, 10,</span><br><span class="line">    2, 8, 24, 14, 32, 27, 3, 9,</span><br><span class="line">    19, 13, 30, 6, 22, 11, 4, 25</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ---------------------- å·¥å…·å‡½æ•° ----------------------</span><br><span class="line"></span><br><span class="line">def text_to_bin(text, length=64):</span><br><span class="line">    &quot;&quot;&quot;å°†æ–‡æœ¬æˆ–åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²&quot;&quot;&quot;</span><br><span class="line">    if all(c in &#x27;0123456789ABCDEFabcdef&#x27; for c in text):</span><br><span class="line">        # å¤„ç†åå…­è¿›åˆ¶è¾“å…¥</span><br><span class="line">        binary = bin(int(text, 16))[2:].zfill(length)</span><br><span class="line">    else:</span><br><span class="line">        # å¤„ç†ASCIIè¾“å…¥ï¼ˆå®éªŒæµ‹è¯•ä¸­æš‚æœªä½¿ç”¨ï¼‰</span><br><span class="line">        binary = &#x27;&#x27;.join([bin(ord(c))[2:].zfill(8) for c in text])</span><br><span class="line">    return binary.zfill(length)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def bin_to_hex(binary):</span><br><span class="line">    &quot;&quot;&quot;äºŒè¿›åˆ¶å­—ç¬¦ä¸²è½¬åå…­è¿›åˆ¶&quot;&quot;&quot;</span><br><span class="line">    return hex(int(binary, 2))[2:].upper().zfill(16)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def permute(bits, table):</span><br><span class="line">    &quot;&quot;&quot;æ ¹æ®ç½®æ¢è¡¨è¿›è¡Œä½ç½®æ¢&quot;&quot;&quot;</span><br><span class="line">    # æ³¨æ„ï¼šDESç½®æ¢è¡¨ç´¢å¼•ä»1å¼€å§‹ï¼ŒPythonåˆ—è¡¨ä»0å¼€å§‹ï¼Œæ•…éœ€å‡1</span><br><span class="line">    return &#x27;&#x27;.join([bits[i - 1] for i in table])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def left_shift(bits, n):</span><br><span class="line">    &quot;&quot;&quot;å¾ªç¯å·¦ç§»nä½&quot;&quot;&quot;</span><br><span class="line">    return bits[n:] + bits[:n]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def xor(a, b):</span><br><span class="line">    &quot;&quot;&quot;å¼‚æˆ–æ“ä½œ&quot;&quot;&quot;</span><br><span class="line">    return &#x27;&#x27;.join(str(int(x) ^ int(y)) for x, y in zip(a, b))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ---------------------- å­å¯†é’¥ç”Ÿæˆ ----------------------</span><br><span class="line"></span><br><span class="line">def generate_subkeys(key):</span><br><span class="line">    &quot;&quot;&quot;ç”Ÿæˆ16è½®å­å¯†é’¥ï¼ˆ48ä½ï¼‰&quot;&quot;&quot;</span><br><span class="line">    # åˆå§‹ç½®æ¢ PC-1ï¼ˆ64ä½ -&gt; 56ä½ï¼‰</span><br><span class="line">    key = permute(key, PC1)</span><br><span class="line">    # åˆ†å‰²å·¦å³28ä½</span><br><span class="line">    left, right = key[:28], key[28:]</span><br><span class="line">    subkeys = []</span><br><span class="line">    for i in range(16):</span><br><span class="line">        # æ ¹æ®SHIFTè¡¨å¾ªç¯å·¦ç§»</span><br><span class="line">        left = left_shift(left, SHIFT[i])</span><br><span class="line">        right = left_shift(right, SHIFT[i])</span><br><span class="line">        # åˆå¹¶åç½®æ¢ PC-2ï¼ˆ56ä½ -&gt; 48ä½ï¼‰</span><br><span class="line">        combined = left + right</span><br><span class="line">        subkey = permute(combined, PC2)</span><br><span class="line">        subkeys.append(subkey)</span><br><span class="line">    return subkeys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def feistel(right, subkey):</span><br><span class="line">    &quot;&quot;&quot;Feistel å‡½æ•°ï¼ˆå¤„ç†å³åŠéƒ¨åˆ†ï¼‰&quot;&quot;&quot;</span><br><span class="line">    # æ‰©å±•ç½®æ¢ Eï¼ˆ32ä½ -&gt; 48ä½ï¼‰</span><br><span class="line">    expanded = permute(right, E)</span><br><span class="line">    # ä¸å­å¯†é’¥å¼‚æˆ–</span><br><span class="line">    xored = xor(expanded, subkey)</span><br><span class="line">    # S ç›’æ›¿æ¢ï¼ˆ48ä½ -&gt; 32ä½ï¼‰</span><br><span class="line">    s_output = &#x27;&#x27;</span><br><span class="line">    for i in range(8):</span><br><span class="line">        # æå–6ä½è¾“å…¥</span><br><span class="line">        chunk = xored[i * 6:(i + 1) * 6]</span><br><span class="line">        # è®¡ç®—è¡Œå’Œåˆ—ï¼ˆè¡Œç”±é¦–å°¾ä¸¤ä½å†³å®šï¼Œåˆ—ç”±ä¸­é—´4ä½å†³å®šï¼‰</span><br><span class="line">        row = int(chunk[0] + chunk[5], 2)</span><br><span class="line">        col = int(chunk[1:5], 2)</span><br><span class="line">        # æŸ¥Sç›’å¹¶è½¬æ¢ä¸º4ä½äºŒè¿›åˆ¶</span><br><span class="line">        val = S_BOX[i][row][col]</span><br><span class="line">        s_output += bin(val)[2:].zfill(4)</span><br><span class="line">    # P ç›’ç½®æ¢</span><br><span class="line">    p_output = permute(s_output, P)</span><br><span class="line">    return p_output</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ---------------------- DES ä¸»å‡½æ•° ----------------------</span><br><span class="line"></span><br><span class="line">def des(block, key, encrypt=True):</span><br><span class="line">    &quot;&quot;&quot;DES åŠ å¯†/è§£å¯†å•å—ï¼ˆ64ä½ï¼‰&quot;&quot;&quot;</span><br><span class="line">    # ç”Ÿæˆå­å¯†é’¥</span><br><span class="line">    subkeys = generate_subkeys(key)</span><br><span class="line">    if not encrypt:</span><br><span class="line">        subkeys = subkeys[::-1]  # è§£å¯†æ—¶é€†åºä½¿ç”¨å­å¯†é’¥</span><br><span class="line"></span><br><span class="line">    # åˆå§‹ç½®æ¢ IP</span><br><span class="line">    block = permute(block, IP)</span><br><span class="line">    # åˆ†å‰²å·¦å³32ä½</span><br><span class="line">    left, right = block[:32], block[32:]</span><br><span class="line"></span><br><span class="line">    # 16è½® Feistel ç½‘ç»œ</span><br><span class="line">    for i in range(16):</span><br><span class="line">        new_left = right</span><br><span class="line">        # Feistel å‡½æ•°å¤„ç†å³åŠéƒ¨åˆ†</span><br><span class="line">        f_result = feistel(right, subkeys[i])</span><br><span class="line">        # æ–°å³åŠéƒ¨åˆ† = å·¦åŠéƒ¨åˆ† XOR Feistelç»“æœ</span><br><span class="line">        new_right = xor(left, f_result)</span><br><span class="line">        left, right = new_left, new_right</span><br><span class="line"></span><br><span class="line">    # æœ€ç»ˆåˆå¹¶å¹¶é€†ç½®æ¢ IP^-1</span><br><span class="line">    combined = right + left  # æ³¨æ„æœ€åä¸äº¤æ¢</span><br><span class="line">    ciphertext = permute(combined, IP_INV)</span><br><span class="line">    return ciphertext</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ---------------------- æµ‹è¯•ä»£ç  ----------------------</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    # æµ‹è¯•ç”¨ä¾‹1ï¼šå¼±å¯†é’¥</span><br><span class="line">    plaintext = &#x27;aaabbaba&#x27;</span><br><span class="line">    key = &#x27;0101010101010101&#x27;</span><br><span class="line">    # è½¬æ¢ä¸ºäºŒè¿›åˆ¶</span><br><span class="line">    bin_plain = text_to_bin(plaintext)</span><br><span class="line">    bin_key = text_to_bin(key)</span><br><span class="line">    # åŠ å¯†</span><br><span class="line">    cipher_bin = des(bin_plain, bin_key, encrypt=True)</span><br><span class="line">    cipher_hex = bin_to_hex(cipher_bin)</span><br><span class="line"></span><br><span class="line">    print(f&#x27;åŠ å¯†ç»“æœ: &#123;cipher_hex&#125;&#x27;)</span><br><span class="line">    # è§£å¯†</span><br><span class="line">    decrypted_bin = des(cipher_bin, bin_key, encrypt=False)</span><br><span class="line">    decrypted_hex = bin_to_hex(decrypted_bin)</span><br><span class="line">    print(f&#x27;è§£å¯†ç»“æœ: &#123;decrypted_hex&#125;&#x27;)</span><br><span class="line"></span><br><span class="line">    #äºŒæ¬¡åŠ å¯†</span><br><span class="line">    cipher_bin2 = des(cipher_bin, bin_key, encrypt=True)</span><br><span class="line">    bin_to_hex2 = bin_to_hex(cipher_bin2)</span><br><span class="line">    print(f&quot;äºŒæ¬¡åŠ å¯†: &#123;bin_to_hex2&#125;&quot;)</span><br><span class="line"></span><br><span class="line">    # åŠå¼±å¯†é’¥</span><br><span class="line">    print()</span><br><span class="line">    print(&quot;åŠå¼±å¯†é’¥&quot;)</span><br><span class="line">    plaintext = &#x27;aaabbaba&#x27;</span><br><span class="line">    key1 = &#x27;011f011f010e010e&#x27;</span><br><span class="line">    key2 = &#x27;1f011f010e010e01&#x27;</span><br><span class="line">    # è½¬æ¢ä¸ºäºŒè¿›åˆ¶</span><br><span class="line">    bin_plain = text_to_bin(plaintext)</span><br><span class="line">    bin_key1 = text_to_bin(key1)</span><br><span class="line">    bin_key2 = text_to_bin(key2)</span><br><span class="line">    # åŠ å¯†</span><br><span class="line">    cipher_bin = des(bin_plain, bin_key1, encrypt=True)</span><br><span class="line">    cipher_hex = bin_to_hex(cipher_bin)</span><br><span class="line"></span><br><span class="line">    print(f&#x27;ä¸€æ¬¡åŠ å¯†ç»“æœ: &#123;cipher_hex&#125;&#x27;)</span><br><span class="line">    # è§£å¯†</span><br><span class="line">    decrypted_bin = des(cipher_bin, bin_key1, encrypt=False)</span><br><span class="line">    decrypted_hex = bin_to_hex(decrypted_bin)</span><br><span class="line">    print(f&#x27;è§£å¯†ç»“æœ: &#123;decrypted_hex&#125;&#x27;)</span><br><span class="line"></span><br><span class="line">    #äºŒæ¬¡åŠ å¯†</span><br><span class="line">    cipher_bin2 = des(cipher_bin, bin_key2, encrypt=True)</span><br><span class="line">    bin_to_hex2 = bin_to_hex(cipher_bin2)</span><br><span class="line">    print(f&quot;å¯¹ç§°å¯†é’¥äºŒæ¬¡åŠ å¯†: &#123;bin_to_hex2&#125;&quot;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸‹æ˜¯å…³äºDESåŠ å¯†ç®—æ³•åŠå…¶ä»£ç å®ç°çš„è¯¦ç»†è§£æï¼š</p>
<p>ä¸€ã€DESç®—æ³•æµç¨‹è§£æ</p>
<ol>
<li><p>åˆå§‹ç½®æ¢ï¼ˆIPç½®æ¢ï¼‰<br>è¾“å…¥ï¼š64ä½æ˜æ–‡<br>å¤„ç†ï¼šæ ¹æ®IPè¡¨è¿›è¡Œä½ç½®ç½®æ¢ï¼ˆåŸç¬¬58ä½æˆä¸ºæ–°ç¬¬1ä½ï¼Œç¬¬50ä½æˆä¸ºæ–°ç¬¬2ä½â€¦ï¼‰<br>è¾“å‡ºï¼šç½®æ¢åçš„64ä½æ•°æ®åˆ†ä¸ºLâ‚€ï¼ˆå‰32ä½ï¼‰å’ŒRâ‚€ï¼ˆå32ä½ï¼‰</p>
</li>
<li><p>16è½®Feistelç»“æ„<br>æ¯è½®å¤„ç†æµç¨‹ï¼š<br>å¥½é—®é¢˜ï¼DESï¼ˆæ•°æ®åŠ å¯†æ ‡å‡†ï¼‰æœ€æ ¸å¿ƒçš„ä¸€æ­¥ä¹‹ä¸€å°±æ˜¯å­å¯†é’¥çš„ç”Ÿæˆï¼Œä¹Ÿå«<strong>å¯†é’¥è°ƒåº¦ï¼ˆKey Scheduleï¼‰</strong>ã€‚æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥è®²ï¼Œä¿è¯ä½ è¿™ä¸ªå¯†ç å°ç™½ä¹Ÿèƒ½å¬æ‡‚ğŸ˜</p>
</li>
</ol>
<hr>
<h2 id="ğŸ§©-ä¸€ã€å­å¯†é’¥æ˜¯å•¥ï¼Ÿæœ‰ä»€ä¹ˆç”¨ï¼Ÿ"><a href="#ğŸ§©-ä¸€ã€å­å¯†é’¥æ˜¯å•¥ï¼Ÿæœ‰ä»€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="ğŸ§© ä¸€ã€å­å¯†é’¥æ˜¯å•¥ï¼Ÿæœ‰ä»€ä¹ˆç”¨ï¼Ÿ"></a>ğŸ§© ä¸€ã€å­å¯†é’¥æ˜¯å•¥ï¼Ÿæœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h2><ul>
<li>DES æ˜¯ä¸€ä¸ª <strong>å¯¹ç§°åŠ å¯†ç®—æ³•</strong>ï¼Œç”¨äº† 16 è½® Feistel ç»“æ„ã€‚</li>
<li>æ¯ä¸€è½®éƒ½è¦ç”¨ä¸€ä¸ª <strong>ä¸åŒçš„å­å¯†é’¥</strong>ï¼ˆå…± 16 ä¸ªå­å¯†é’¥ï¼‰ã€‚</li>
<li><strong>ä¸»å¯†é’¥æ˜¯ 64 ä½ï¼ˆä½†åªç”¨å…¶ä¸­çš„ 56 ä½ï¼‰</strong>ï¼Œä»å®ƒç”Ÿæˆ <strong>16 ä¸ª 48 ä½çš„å­å¯†é’¥</strong>ã€‚</li>
<li>æ¯è½®åŠ å¯†/è§£å¯†æ—¶ï¼Œéƒ½ä»è¿™ 16 ä¸ªå­å¯†é’¥ä¸­å–å¯¹åº”çš„ä¸€ä¸ªç”¨ã€‚</li>
</ul>
<blockquote>
<p>âœ… <strong>å­å¯†é’¥çš„ä½œç”¨ï¼š</strong><br>æ¯è½®åŠ å¯†éƒ½è¦å’Œå­å¯†é’¥åšå¼‚æˆ–ã€Sç›’æ›¿æ¢ç­‰æ“ä½œï¼Œä¸åŒå­å¯†é’¥è®©æ¯è½®åŠ å¯†éƒ½ä¸åŒï¼Œå¢å¼ºäº†å®‰å…¨æ€§ã€‚</p>
</blockquote>
<hr>
<h2 id="ğŸ”‘-äºŒã€æ€ä¹ˆä»ä¸»å¯†é’¥ç”Ÿæˆå­å¯†é’¥ï¼Ÿ"><a href="#ğŸ”‘-äºŒã€æ€ä¹ˆä»ä¸»å¯†é’¥ç”Ÿæˆå­å¯†é’¥ï¼Ÿ" class="headerlink" title="ğŸ”‘ äºŒã€æ€ä¹ˆä»ä¸»å¯†é’¥ç”Ÿæˆå­å¯†é’¥ï¼Ÿ"></a>ğŸ”‘ äºŒã€æ€ä¹ˆä»ä¸»å¯†é’¥ç”Ÿæˆå­å¯†é’¥ï¼Ÿ</h2><h3 id="Step-1ï¸âƒ£ï¼š64ä½ä¸»å¯†é’¥-â†’-56ä½æœ‰æ•ˆå¯†é’¥ï¼ˆå»é™¤å¥‡å¶æ ¡éªŒä½ï¼‰"><a href="#Step-1ï¸âƒ£ï¼š64ä½ä¸»å¯†é’¥-â†’-56ä½æœ‰æ•ˆå¯†é’¥ï¼ˆå»é™¤å¥‡å¶æ ¡éªŒä½ï¼‰" class="headerlink" title="Step 1ï¸âƒ£ï¼š64ä½ä¸»å¯†é’¥ â†’ 56ä½æœ‰æ•ˆå¯†é’¥ï¼ˆå»é™¤å¥‡å¶æ ¡éªŒä½ï¼‰"></a>Step 1ï¸âƒ£ï¼š64ä½ä¸»å¯†é’¥ â†’ 56ä½æœ‰æ•ˆå¯†é’¥ï¼ˆå»é™¤å¥‡å¶æ ¡éªŒä½ï¼‰</h3><p>ä¸»å¯†é’¥é•¿è¿™æ ·ï¼ˆ64 ä½ï¼‰ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">K = k1 k2 k3 ... k64</span><br></pre></td></tr></table></figure>
<p>æ¯ 8 ä½ä¸­ç¬¬ 8 ä½æ˜¯å¥‡å¶æ ¡éªŒä½ï¼ˆä¹Ÿå°±æ˜¯è¯´æ¯ 8 ä½åªç”¨å‰ 7 ä½ï¼‰ï¼Œæ‰€ä»¥æœ‰æ•ˆå¯†é’¥æ˜¯ 56 ä½ã€‚</p>
<p>è¿™ä¸€æ­¥ç”¨çš„æ˜¯ä¸€ä¸ªå›ºå®šçš„ <strong>PC-1ï¼ˆPermuted Choice 1ï¼‰ç½®æ¢è¡¨</strong>ï¼Œå¯¹å¯†é’¥è¿›è¡Œç½®æ¢å’Œé€‰æ‹©ï¼Œå»æ‰äº†æ ¡éªŒä½ã€‚</p>
<hr>
<h3 id="Step-2ï¸âƒ£ï¼šå°†-56-ä½å¯†é’¥åˆ†æˆä¸¤åŠ"><a href="#Step-2ï¸âƒ£ï¼šå°†-56-ä½å¯†é’¥åˆ†æˆä¸¤åŠ" class="headerlink" title="Step 2ï¸âƒ£ï¼šå°† 56 ä½å¯†é’¥åˆ†æˆä¸¤åŠ"></a>Step 2ï¸âƒ£ï¼šå°† 56 ä½å¯†é’¥åˆ†æˆä¸¤åŠ</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">C0 = å‰ 28 ä½</span><br><span class="line">D0 = å 28 ä½</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="Step-3ï¸âƒ£ï¼šå¾ªç¯å·¦ç§»-PC-2-ç”Ÿæˆ-16-ä¸ªå­å¯†é’¥"><a href="#Step-3ï¸âƒ£ï¼šå¾ªç¯å·¦ç§»-PC-2-ç”Ÿæˆ-16-ä¸ªå­å¯†é’¥" class="headerlink" title="Step 3ï¸âƒ£ï¼šå¾ªç¯å·¦ç§» + PC-2 ç”Ÿæˆ 16 ä¸ªå­å¯†é’¥"></a>Step 3ï¸âƒ£ï¼šå¾ªç¯å·¦ç§» + PC-2 ç”Ÿæˆ 16 ä¸ªå­å¯†é’¥</h3><p>ä» C0 å’Œ D0 å¼€å§‹ï¼Œæ¯ä¸€è½®åš <strong>å·¦ç§»ï¼ˆ1 ä½æˆ– 2 ä½ï¼ŒæŒ‰è½®æ•°ï¼‰</strong>ï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>è½®æ•°</th>
<th>ç§»ä½æ¬¡æ•°</th>
</tr>
</thead>
<tbody>
<tr>
<td>1, 2, 9, 16</td>
<td>1 ä½</td>
</tr>
<tr>
<td>å…¶ä»–è½®</td>
<td>2 ä½</td>
</tr>
</tbody>
</table>
</div>
<p>æ¯è½®éƒ½å¾—åˆ°äº†ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">C1, D1 â†’ K1  </span><br><span class="line">C2, D2 â†’ K2  </span><br><span class="line">...  </span><br><span class="line">C16, D16 â†’ K16  </span><br></pre></td></tr></table></figure>
<p>æ¯æ¬¡å°† Cn å’Œ Dn åˆå¹¶æˆ 56 ä½ï¼Œç„¶åå†ç”¨ä¸€ä¸ªå›ºå®šçš„ <strong>PC-2 è¡¨ï¼ˆPermuted Choice 2ï¼‰</strong> æå–å…¶ä¸­çš„ 48 ä½ç”Ÿæˆ <strong>å­å¯†é’¥ Kn</strong>ã€‚</p>
<hr>
<h3 id="âœï¸-å°ç»“"><a href="#âœï¸-å°ç»“" class="headerlink" title="âœï¸ å°ç»“"></a>âœï¸ å°ç»“</h3><div class="table-container">
<table>
<thead>
<tr>
<th>æ­¥éª¤</th>
<th>å†…å®¹</th>
</tr>
</thead>
<tbody>
<tr>
<td>PC-1</td>
<td>æŠŠ 64 ä½ä¸»å¯†é’¥å˜æˆ 56 ä½ï¼ˆå»å¥‡å¶ä½ï¼‰</td>
</tr>
<tr>
<td>åˆ†å‰²</td>
<td>56 ä½ â†’ C0 å’Œ D0ï¼Œå„ 28 ä½</td>
</tr>
<tr>
<td>å·¦ç§»</td>
<td>æ¯è½®å¯¹ C å’Œ D å¾ªç¯å·¦ç§» 1 æˆ– 2 ä½</td>
</tr>
<tr>
<td>PC-2</td>
<td>ä» CnDn ä¸­é€‰å‡º 48 ä½ â†’ ç”Ÿæˆç¬¬ n è½®å­å¯†é’¥</td>
</tr>
</tbody>
</table>
</div>
<hr>
<h2 id="ğŸ› -å­å¯†é’¥åœ¨åŠ å¯†ä¸­çš„ä½¿ç”¨"><a href="#ğŸ› -å­å¯†é’¥åœ¨åŠ å¯†ä¸­çš„ä½¿ç”¨" class="headerlink" title="ğŸ›  å­å¯†é’¥åœ¨åŠ å¯†ä¸­çš„ä½¿ç”¨"></a>ğŸ›  å­å¯†é’¥åœ¨åŠ å¯†ä¸­çš„ä½¿ç”¨</h2><p>åœ¨ DES çš„æ¯ä¸€è½®åŠ å¯†ä¸­ï¼š</p>
<ol>
<li>å°†æ˜æ–‡å·¦å³åˆ†æˆ L å’Œ Rã€‚</li>
<li>ç”¨å³è¾¹éƒ¨åˆ†å’Œå½“å‰è½®çš„ <strong>å­å¯†é’¥</strong> åšå¤æ‚å‡½æ•° <code>f(R, K_i)</code>ï¼ŒåŒ…æ‹¬ï¼š<ul>
<li>æ‰©å±•ç½®æ¢</li>
<li>å’Œå­å¯†é’¥å¼‚æˆ–</li>
<li>Sç›’æ›¿æ¢</li>
<li>Pç›’ç½®æ¢</li>
</ul>
</li>
<li>ç»“æœå†å’Œå·¦è¾¹éƒ¨åˆ†å¼‚æˆ–</li>
<li>å·¦å³æ¢ä½è¿›å…¥ä¸‹ä¸€è½®</li>
</ol>
<hr>
<h2 id="ğŸš€-æ€»ç»“ä¸€å¥è¯ï¼š"><a href="#ğŸš€-æ€»ç»“ä¸€å¥è¯ï¼š" class="headerlink" title="ğŸš€ æ€»ç»“ä¸€å¥è¯ï¼š"></a>ğŸš€ æ€»ç»“ä¸€å¥è¯ï¼š</h2><blockquote>
<p><strong>å­å¯†é’¥æ˜¯ä»ä¸»å¯†é’¥ä¸­è¡ç”Ÿå‡ºæ¥çš„ä¸€ç»„ 48 ä½å¯†é’¥ï¼Œç”¨äº DES çš„æ¯ä¸€è½®åŠ å¯†ã€‚å®ƒé€šè¿‡ç½®æ¢ã€åˆ†å‰²ã€å¾ªç¯ç§»ä½ã€å†æ¬¡ç½®æ¢æ¥ç”Ÿæˆï¼Œç¡®ä¿æ¯ä¸€è½®æ“ä½œä¸åŒï¼Œå¢å¼ºå®‰å…¨æ€§ã€‚</strong></p>
</blockquote>
<hr>
<p>å¦‚æœä½ æƒ³ï¼Œæˆ‘å¯ä»¥ç»™ä½ ç”»ä¸€å¼  <strong>å­å¯†é’¥ç”Ÿæˆæµç¨‹å›¾</strong>ï¼Œæˆ–è€…å†™ä¸€æ®µ Python å®ç° DES å¯†é’¥è°ƒåº¦çš„ä»£ç ï½éœ€è¦å—ï¼Ÿ<br>(1) å³åŠéƒ¨åˆ†Râ‚™è¿›è¡Œæ‰©å±•ç½®æ¢Eï¼ˆ32â†’48ä½ï¼‰<br>(2) ä¸å­å¯†é’¥Kâ‚™è¿›è¡Œå¼‚æˆ–è¿ç®—<br>(3) é€šè¿‡8ä¸ªSç›’è¿›è¡Œéçº¿æ€§å˜æ¢ï¼ˆ48â†’32ä½ï¼‰<br>(4) è¿›è¡ŒPç›’ç½®æ¢<br>(5) ç»“æœä¸å·¦åŠéƒ¨åˆ†Lâ‚™å¼‚æˆ–ç”Ÿæˆæ–°å³åŠéƒ¨åˆ†Râ‚™â‚Šâ‚<br>(6) äº¤æ¢å·¦å³éƒ¨åˆ†</p>
<ol>
<li>é€†åˆå§‹ç½®æ¢ï¼ˆIPâ»Â¹ç½®æ¢ï¼‰<br>è¾“å…¥ï¼šæœ€ç»ˆåˆå¹¶çš„Râ‚â‚†Lâ‚â‚†ï¼ˆæ³¨æ„ä¸äº¤æ¢ï¼‰<br>å¤„ç†ï¼šæ ¹æ®IP_INVè¡¨è¿›è¡Œç½®æ¢<br>è¾“å‡ºï¼š64ä½å¯†æ–‡</li>
</ol>
<p>äºŒã€ä»£ç æ¨¡å—è§£æ</p>
<ol>
<li>ç½®æ¢è¡¨å®šä¹‰<br>ä»£ç ä¸­å®šä¹‰äº†DESç®—æ³•æ‰€éœ€çš„æ‰€æœ‰ç½®æ¢è¡¨ï¼š</li>
</ol>
<ul>
<li>IP/IP_INVï¼šåˆå§‹/é€†åˆå§‹ç½®æ¢</li>
<li>PC1/PC2ï¼šå¯†é’¥ç½®æ¢è¡¨</li>
<li>Eï¼šæ‰©å±•ç½®æ¢è¡¨</li>
<li>S_BOXï¼šéçº¿æ€§æ›¿æ¢ç›’</li>
<li>Pï¼šPç›’ç½®æ¢è¡¨</li>
<li>SHIFTï¼šå¾ªç¯å·¦ç§»ä½æ•°è¡¨</li>
</ul>
<ol>
<li>æ ¸å¿ƒå‡½æ•°è¯´æ˜<br>ï¼ˆ1ï¼‰permute(bits, table)<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">permute</span>(<span class="params">bits, table</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([bits[i - <span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> table])</span><br></pre></td></tr></table></figure>
åŠŸèƒ½ï¼šé€šç”¨ç½®æ¢å‡½æ•°<br>ç‰¹ç‚¹ï¼šå¤„ç†æ‰€æœ‰DESç½®æ¢æ“ä½œï¼Œè‡ªåŠ¨å¤„ç†ç´¢å¼•åç§»ï¼ˆè¡¨æ ¼å®šä¹‰ä»1å¼€å§‹ï¼ŒPythonç´¢å¼•ä»0å¼€å§‹ï¼‰</li>
</ol>
<p>ï¼ˆ2ï¼‰generate_subkeys(key)<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">generate_subkeys</span>(<span class="params">key</span>):</span><br><span class="line">    key = permute(key, PC1)  <span class="comment"># PC-1ç½®æ¢</span></span><br><span class="line">    left, right = key[:<span class="number">28</span>], key[<span class="number">28</span>:]  <span class="comment"># åˆ†å‰²</span></span><br><span class="line">    subkeys = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        left = left_shift(left, SHIFT[i])  <span class="comment"># å¾ªç¯å·¦ç§»</span></span><br><span class="line">        right = left_shift(right, SHIFT[i])</span><br><span class="line">        combined = left + right</span><br><span class="line">        subkey = permute(combined, PC2)  <span class="comment"># PC-2ç½®æ¢</span></span><br><span class="line">        subkeys.append(subkey)</span><br><span class="line">    <span class="keyword">return</span> subkeys</span><br></pre></td></tr></table></figure><br>åŠŸèƒ½ï¼šç”Ÿæˆ16è½®å­å¯†é’¥<br>æµç¨‹ï¼š</p>
<ol>
<li>64ä½å¯†é’¥â†’PC1ç½®æ¢â†’56ä½</li>
<li>åˆ†å‰²ä¸ºå·¦å³28ä½</li>
<li>æ ¹æ®SHIFTè¡¨è¿›è¡Œå¾ªç¯å·¦ç§»</li>
<li>åˆå¹¶åé€šè¿‡PC2ç½®æ¢ç”Ÿæˆ48ä½å­å¯†é’¥</li>
</ol>
<p>ï¼ˆ3ï¼‰feistel(right, subkey)<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">feistel</span>(<span class="params">right, subkey</span>):</span><br><span class="line">    expanded = permute(right, E)  <span class="comment"># æ‰©å±•ç½®æ¢</span></span><br><span class="line">    xored = xor(expanded, subkey)  <span class="comment"># å¼‚æˆ–è¿ç®—</span></span><br><span class="line">    s_output = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):  <span class="comment"># Sç›’å¤„ç†</span></span><br><span class="line">        chunk = xored[i*<span class="number">6</span>:(i+<span class="number">1</span>)*<span class="number">6</span>]</span><br><span class="line">        row = <span class="built_in">int</span>(chunk[<span class="number">0</span>]+chunk[<span class="number">5</span>], <span class="number">2</span>)  <span class="comment"># è¡Œå·</span></span><br><span class="line">        col = <span class="built_in">int</span>(chunk[<span class="number">1</span>:<span class="number">5</span>], <span class="number">2</span>)         <span class="comment"># åˆ—å·</span></span><br><span class="line">        val = S_BOX[i][row][col]</span><br><span class="line">        s_output += <span class="built_in">bin</span>(val)[<span class="number">2</span>:].zfill(<span class="number">4</span>)</span><br><span class="line">    p_output = permute(s_output, P)  <span class="comment"># Pç›’ç½®æ¢</span></span><br><span class="line">    <span class="keyword">return</span> p_output</span><br></pre></td></tr></table></figure><br>åŠŸèƒ½ï¼šå®ç°Feistelç½‘ç»œçš„æ ¸å¿ƒå˜æ¢<br>ç‰¹ç‚¹ï¼š</p>
<ul>
<li>æ‰©å±•ç½®æ¢ä½¿32ä½â†’48ä½</li>
<li>æ¯ä¸ªSç›’å¤„ç†6ä½â†’4ä½</li>
<li>æœ€ç»ˆé€šè¿‡Pç›’å¢å¼ºæ‰©æ•£æ€§<br>ä½ çš„ä»£ç é‡Œ <code>feistel</code> å‡½æ•°ç”¨åˆ°äº† <strong>Sç›’ï¼ˆSubstitution Boxï¼‰</strong>ï¼Œè¿™æ˜¯ DES åŠ å¯†ä¸­çš„ä¸€å¤§æ ¸å¿ƒï¼æˆ‘ä»¬æ¥è¯¦ç»†æ‹†è§£ä¸€ä¸‹ S ç›’çš„é€»è¾‘å’Œä½œç”¨ï¼Œè®©ä½ ä»å¯†ç å°ç™½å˜æˆå¯†ç è¾¾äºº ğŸš€</li>
</ul>
<hr>
<h2 id="ğŸ”-ä¸€ã€Sç›’æ˜¯å¹²å˜›çš„ï¼Ÿ"><a href="#ğŸ”-ä¸€ã€Sç›’æ˜¯å¹²å˜›çš„ï¼Ÿ" class="headerlink" title="ğŸ” ä¸€ã€Sç›’æ˜¯å¹²å˜›çš„ï¼Ÿ"></a>ğŸ” ä¸€ã€Sç›’æ˜¯å¹²å˜›çš„ï¼Ÿ</h2><p>Sç›’çš„ä½œç”¨æ˜¯ï¼š  </p>
<blockquote>
<p><strong>æŠŠ 6 ä½äºŒè¿›åˆ¶è¾“å…¥ï¼Œæ›¿æ¢æˆ 4 ä½è¾“å‡º</strong>ã€‚</p>
</blockquote>
<p>å®ƒå¼•å…¥äº† <strong>éçº¿æ€§å˜æ¢</strong>ï¼Œæ˜¯ DES å®‰å…¨æ€§çš„é‡è¦æ¥æºä¹‹ä¸€ã€‚</p>
<hr>
<h2 id="ğŸ“¦-äºŒã€Sç›’æ˜¯æ€ä¹ˆæ“ä½œçš„ï¼Ÿ"><a href="#ğŸ“¦-äºŒã€Sç›’æ˜¯æ€ä¹ˆæ“ä½œçš„ï¼Ÿ" class="headerlink" title="ğŸ“¦ äºŒã€Sç›’æ˜¯æ€ä¹ˆæ“ä½œçš„ï¼Ÿ"></a>ğŸ“¦ äºŒã€Sç›’æ˜¯æ€ä¹ˆæ“ä½œçš„ï¼Ÿ</h2><h3 id="è¾“å…¥ï¼š6-ä½äºŒè¿›åˆ¶ï¼ˆæ¯”å¦‚-011011ï¼‰"><a href="#è¾“å…¥ï¼š6-ä½äºŒè¿›åˆ¶ï¼ˆæ¯”å¦‚-011011ï¼‰" class="headerlink" title="è¾“å…¥ï¼š6 ä½äºŒè¿›åˆ¶ï¼ˆæ¯”å¦‚ 011011ï¼‰"></a>è¾“å…¥ï¼š6 ä½äºŒè¿›åˆ¶ï¼ˆæ¯”å¦‚ <code>011011</code>ï¼‰</h3><h3 id="æ­¥éª¤ï¼š"><a href="#æ­¥éª¤ï¼š" class="headerlink" title="æ­¥éª¤ï¼š"></a>æ­¥éª¤ï¼š</h3><ol>
<li><p><strong>å–ç¬¬ 1 ä½å’Œç¬¬ 6 ä½</strong>ï¼Œæ‹¼èµ·æ¥å½“ä½œ <strong>è¡Œå·</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">row = <span class="built_in">int</span>(chunk[<span class="number">0</span>] + chunk[<span class="number">5</span>], <span class="number">2</span>)  <span class="comment"># ä¾‹å¦‚ &quot;01&quot; â†’ 1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>å–ä¸­é—´ 4 ä½</strong>ï¼ˆç¬¬ 2ï½5 ä½ï¼‰å½“ä½œ <strong>åˆ—å·</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">col = <span class="built_in">int</span>(chunk[<span class="number">1</span>:<span class="number">5</span>], <span class="number">2</span>)  <span class="comment"># ä¾‹å¦‚ &quot;1101&quot; â†’ 13</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>æŸ¥ S_BOX</strong> ä¸­ç¬¬ i ä¸ªç›’å­çš„ç¬¬ row è¡Œç¬¬ col åˆ—çš„å€¼</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val = S_BOX[i][row][col]  <span class="comment"># å¾—åˆ° 0~15 ä¹‹é—´çš„æ•´æ•°</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>æŠŠè¿™ä¸ªå€¼è½¬ä¸º 4 ä½äºŒè¿›åˆ¶</strong>ï¼Œä½œä¸ºè¾“å‡ºï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s_output += <span class="built_in">bin</span>(val)[<span class="number">2</span>:].zfill(<span class="number">4</span>)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<h2 id="ğŸ§ª-ä¸¾ä¸ªä¾‹å­ï¼š"><a href="#ğŸ§ª-ä¸¾ä¸ªä¾‹å­ï¼š" class="headerlink" title="ğŸ§ª ä¸¾ä¸ªä¾‹å­ï¼š"></a>ğŸ§ª ä¸¾ä¸ªä¾‹å­ï¼š</h2><p>å‡è®¾ <code>chunk = &quot;011011&quot;</code>ï¼Œè¿™æ˜¯ç¬¬ i ä¸ªå—ï¼š</p>
<ul>
<li><code>row = int(&quot;01&quot;, 2) = 1</code></li>
<li><code>col = int(&quot;1101&quot;, 2) = 13</code></li>
<li><code>val = S_BOX[i][1][13]</code> â†’ å¯èƒ½æ˜¯ 10</li>
<li><code>bin(10)[2:].zfill(4)</code> â†’ <code>&quot;1010&quot;</code></li>
</ul>
<p>è¿™æ · 6 ä½è¾“å…¥å˜æˆ 4 ä½è¾“å‡ºã€‚</p>
<hr>
<h2 id="ğŸ”-ä¸‰ã€ä¸ºä»€ä¹ˆä¸€å…±æ˜¯-8-ä¸ª-Sç›’ï¼Ÿ"><a href="#ğŸ”-ä¸‰ã€ä¸ºä»€ä¹ˆä¸€å…±æ˜¯-8-ä¸ª-Sç›’ï¼Ÿ" class="headerlink" title="ğŸ” ä¸‰ã€ä¸ºä»€ä¹ˆä¸€å…±æ˜¯ 8 ä¸ª Sç›’ï¼Ÿ"></a>ğŸ” ä¸‰ã€ä¸ºä»€ä¹ˆä¸€å…±æ˜¯ 8 ä¸ª Sç›’ï¼Ÿ</h2><p>å› ä¸º DES ä¸­çš„ Feistel å‡½æ•°å¤„ç†çš„æ˜¯ 32 ä½æ•°æ®ï¼Œä½†ï¼š</p>
<ul>
<li>æ‰©å±•ç½®æ¢ E æŠŠ 32 ä½ â†’ 48 ä½</li>
<li>ç„¶åæ¯ 6 ä½ä¸ºä¸€ç»„ï¼Œåˆ†æˆ 8 ç»„</li>
<li>æ¯ç»„èµ°ä¸€ä¸ª S ç›’ â†’ è¾“å‡º 4 ä½</li>
<li>8 ç»„å…±è¾“å‡º 32 ä½</li>
</ul>
<blockquote>
<p>è¿™å°±å®ç°äº† 48 ä½ â†’ 32 ä½ çš„éçº¿æ€§å‹ç¼©æ˜ å°„ï¼</p>
</blockquote>
<hr>
<h2 id="ğŸ”’-å››ã€Sç›’çš„å®‰å…¨æ€§æ¥æº"><a href="#ğŸ”’-å››ã€Sç›’çš„å®‰å…¨æ€§æ¥æº" class="headerlink" title="ğŸ”’ å››ã€Sç›’çš„å®‰å…¨æ€§æ¥æº"></a>ğŸ”’ å››ã€Sç›’çš„å®‰å…¨æ€§æ¥æº</h2><p>Sç›’æ˜¯ <strong>DES å®‰å…¨æ€§çš„å…³é”®æ‰€åœ¨</strong>ï¼Œå› ä¸ºå®ƒï¼š</p>
<ul>
<li>æä¾›éçº¿æ€§æ˜ å°„ï¼Œä½¿å¾—å¯†æ–‡å¯¹å¯†é’¥å’Œæ˜æ–‡çš„å°æ”¹åŠ¨éå¸¸æ•æ„Ÿï¼ˆé›ªå´©æ•ˆåº”ï¼‰</li>
<li>æ˜¯æŠ—å·®åˆ†åˆ†æã€çº¿æ€§åˆ†æç­‰å¯†ç æ”»å‡»çš„æ ¸å¿ƒé˜²çº¿</li>
<li>æ˜¯äººå·¥è®¾è®¡ + å®‰å…¨æ€§è¯„ä¼°è¿‡çš„ï¼ˆæ˜¯å½“å¹´ NSA ä¼˜åŒ–è¿‡çš„ï¼‰</li>
</ul>
<hr>
<h2 id="âœ…-æ€»ç»“ä¸€å¥è¯ï¼š"><a href="#âœ…-æ€»ç»“ä¸€å¥è¯ï¼š" class="headerlink" title="âœ… æ€»ç»“ä¸€å¥è¯ï¼š"></a>âœ… æ€»ç»“ä¸€å¥è¯ï¼š</h2><blockquote>
<p><strong>Sç›’å°±æ˜¯ä¸€ç§æŸ¥è¡¨æ›¿æ¢æœºåˆ¶ï¼šæ¯ 6 ä½è¾“å…¥ â†’ æ‰¾è¡Œåˆ— â†’ è¾“å‡º 4 ä½ï¼Œ8 ä¸ª Sç›’å¹¶è¡Œå¤„ç†ï¼Œå…±è¾“å‡º 32 ä½ï¼Œç”¨äºæ··æ·†åŸå§‹æ•°æ®ï¼Œå¢å¼ºåŠ å¯†çš„å¤æ‚æ€§å’Œå®‰å…¨æ€§ã€‚</strong></p>
</blockquote>
<hr>
<p>ï¼ˆ4ï¼‰des(block, key, encrypt=True)<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">des</span>(<span class="params">block, key, encrypt=<span class="literal">True</span></span>):</span><br><span class="line">    subkeys = generate_subkeys(key)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> encrypt:</span><br><span class="line">        subkeys = subkeys[::-<span class="number">1</span>]  <span class="comment"># è§£å¯†æ—¶é€†åºå¯†é’¥</span></span><br><span class="line">    </span><br><span class="line">    block = permute(block, IP)  <span class="comment"># åˆå§‹ç½®æ¢</span></span><br><span class="line">    left, right = block[:<span class="number">32</span>], block[<span class="number">32</span>:]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):  <span class="comment"># 16è½®è¿­ä»£</span></span><br><span class="line">        new_left = right</span><br><span class="line">        f_result = feistel(right, subkeys[i])</span><br><span class="line">        new_right = xor(left, f_result)</span><br><span class="line">        left, right = new_left, new_right</span><br><span class="line">    </span><br><span class="line">    combined = right + left  <span class="comment"># æœ€ç»ˆä¸äº¤æ¢</span></span><br><span class="line">    ciphertext = permute(combined, IP_INV)</span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br></pre></td></tr></table></figure><br><img src="/2025/04/21/%E5%AF%86%E7%A0%81%E5%AE%9E%E9%AA%8C/IMG_20250421-214049598.png" class="">  </p>
<p>ç‰¹ç‚¹ï¼š</p>
<ul>
<li>é€šè¿‡encryptå‚æ•°æ§åˆ¶åŠ å¯†/è§£å¯†æ¨¡å¼</li>
<li>16è½®è¿­ä»£åä¸äº¤æ¢å·¦å³éƒ¨åˆ†</li>
<li>æœ€ç»ˆæ‰§è¡Œé€†åˆå§‹ç½®æ¢</li>
</ul>
<p>ä¸‰ã€æµ‹è¯•ç”¨ä¾‹è§£æ</p>
<ol>
<li><p>å¼±å¯†é’¥æµ‹è¯•</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æµ‹è¯•ç”¨ä¾‹1ï¼šå¼±å¯†é’¥</span></span><br><span class="line">plaintext = <span class="string">&#x27;aaabbaba&#x27;</span>  <span class="comment"># ASCIIæ˜æ–‡</span></span><br><span class="line">key = <span class="string">&#x27;0101010101010101&#x27;</span>  <span class="comment"># å…¨01äº¤æ›¿çš„å¼±å¯†é’¥</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ å¯†ç»“æœï¼šB4B15AFCB6A8F4C5</span></span><br><span class="line"><span class="comment"># äºŒæ¬¡åŠ å¯†ç»“æœæ¢å¤åŸæ–‡</span></span><br></pre></td></tr></table></figure>
<p>ç°è±¡è¯´æ˜ï¼šå¼±å¯†é’¥çš„å¯¹ç§°æ€§å¯¼è‡´äºŒæ¬¡åŠ å¯†æ¢å¤åŸæ–‡ï¼Œè¿™æ˜¯DESå¯†é’¥ç©ºé—´ä¸­çš„ç‰¹æ®Šç°è±¡ã€‚</p>
</li>
<li><p>åŠå¼±å¯†é’¥æµ‹è¯•</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åŠå¼±å¯†é’¥æµ‹è¯•</span></span><br><span class="line">key1 = <span class="string">&#x27;011f011f010e010e&#x27;</span></span><br><span class="line">key2 = <span class="string">&#x27;1f011f010e010e01&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨key1åŠ å¯†åå†ç”¨key2åŠ å¯†ï¼Œç­‰ä»·äºå•æ¬¡åŠ å¯†</span></span><br></pre></td></tr></table></figure>
<p>ç°è±¡è¯´æ˜ï¼šåŠå¼±å¯†é’¥å¯¹(K1,K2)æ»¡è¶³E(K1,E(K2,M))=Mï¼Œè¿™ç§å¯†é’¥å¯¹åœ¨DESå¯†é’¥ç©ºé—´ä¸­å­˜åœ¨ç‰¹å®šæ•°å­¦å…³ç³»ã€‚</p>
</li>
</ol>
<p>å››ã€ä»£ç ç‰¹ç‚¹åˆ†æ</p>
<ol>
<li>äºŒè¿›åˆ¶å¤„ç†</li>
</ol>
<ul>
<li>æ‰€æœ‰æ•°æ®å†…éƒ¨ä»¥äºŒè¿›åˆ¶å­—ç¬¦ä¸²å½¢å¼å¤„ç†</li>
<li>æä¾›text_to_bin()å¤„ç†åå…­è¿›åˆ¶/ASCIIè¾“å…¥</li>
<li>bin_to_hex()ç”¨äºç»“æœè¾“å‡º</li>
</ul>
<ol>
<li>æ¨¡å—åŒ–è®¾è®¡</li>
</ol>
<ul>
<li>ç½®æ¢æ“ä½œç»Ÿä¸€ç”±permute()å¤„ç†</li>
<li>Feistelç½‘ç»œç‹¬ç«‹ä¸ºå‡½æ•°</li>
<li>å­å¯†é’¥ç”Ÿæˆä¸ä¸»ç®—æ³•åˆ†ç¦»</li>
</ul>
<ol>
<li>ç®—æ³•å‡†ç¡®æ€§</li>
</ol>
<ul>
<li>ä¸¥æ ¼éµå¾ªDESæ ‡å‡†æ–‡æ¡£çš„ç½®æ¢è¡¨å®šä¹‰</li>
<li>æ­£ç¡®å¤„ç†å¾ªç¯å·¦ç§»å’Œå¯†é’¥é€†åº</li>
<li>ç²¾ç¡®å®ç°Sç›’æŸ¥è¡¨é€»è¾‘</li>
</ul>
<p>äº”ã€å®éªŒç»“æœéªŒè¯</p>
<ol>
<li><p>åŠ å¯†-è§£å¯†ä¸€è‡´æ€§<br>å½“ä½¿ç”¨ç›¸åŒå¯†é’¥æ—¶ï¼š<br>åŠ å¯†ç»“æœ â†’ è§£å¯† â†’ æ¢å¤åŸå§‹æ˜æ–‡<br>éªŒè¯ï¼šæµ‹è¯•ç”¨ä¾‹ä¸­è§£å¯†ç»“æœä¸åŸå§‹æ˜æ–‡ä¸€è‡´</p>
</li>
<li><p>å¼±å¯†é’¥ç‰¹æ€§<br>å…¨01äº¤æ›¿å¯†é’¥çš„äºŒæ¬¡åŠ å¯†ç»“æœï¼š<br>E(K,E(K,M)) = M<br>éªŒè¯ï¼šæµ‹è¯•ç»“æœç¬¦åˆé¢„æœŸ</p>
</li>
</ol>
<p>è¯¥å®ç°å®Œæ•´å±•ç°äº†DESç®—æ³•çš„æ ¸å¿ƒæœºåˆ¶ï¼Œå¯ç”¨äºæ•™å­¦æ¼”ç¤ºå’Œç®—æ³•åˆ†æã€‚é€šè¿‡ä¿®æ”¹æµ‹è¯•ç”¨ä¾‹ï¼Œå¯ä»¥è¿›ä¸€æ­¥ç ”ç©¶DESçš„é›ªå´©æ•ˆåº”ã€å¯†é’¥ä¾èµ–æ€§ç­‰å¯†ç å­¦ç‰¹æ€§ã€‚</p>
<h1 id="éå¯¹ç§°åŠ å¯†ç®—æ³•RSAå®ç°"><a href="#éå¯¹ç§°åŠ å¯†ç®—æ³•RSAå®ç°" class="headerlink" title="éå¯¹ç§°åŠ å¯†ç®—æ³•RSAå®ç°"></a>éå¯¹ç§°åŠ å¯†ç®—æ³•RSAå®ç°</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">import math</span><br><span class="line"></span><br><span class="line">def is_prime(num):</span><br><span class="line">    if num &lt; 2:</span><br><span class="line">        return False</span><br><span class="line">    for i in range(2, int(math.sqrt(num)) + 1):</span><br><span class="line">        if num % i == 0:</span><br><span class="line">            return False</span><br><span class="line">    return True</span><br><span class="line"></span><br><span class="line">def find_e(phi):</span><br><span class="line">    for e in [65537, 17, 5, 3]:</span><br><span class="line">        if e &lt; phi and math.gcd(e, phi) == 1:</span><br><span class="line">            return e</span><br><span class="line">    for e in range(2, phi):</span><br><span class="line">        if math.gcd(e, phi) == 1:</span><br><span class="line">            return e</span><br><span class="line">    return None</span><br><span class="line"></span><br><span class="line">def rsa_key_generation(p, q):</span><br><span class="line">    if not (is_prime(p) and is_prime(q)):</span><br><span class="line">        raise ValueError(&quot;på’Œqå¿…é¡»æ˜¯ç´ æ•°ï¼&quot;)</span><br><span class="line">    n = p * q</span><br><span class="line">    phi = (p - 1) * (q - 1)</span><br><span class="line">    e = find_e(phi)</span><br><span class="line">    if e is None:</span><br><span class="line">        raise ValueError(&quot;æ— æ³•æ‰¾åˆ°åˆé€‚çš„e&quot;)</span><br><span class="line">    d = pow(e, -1, phi)</span><br><span class="line">    return (n, e), (n, d)</span><br><span class="line"></span><br><span class="line">def encrypt(m, public_key):</span><br><span class="line">    n, e = public_key</span><br><span class="line">    if m &gt;= n:</span><br><span class="line">        raise ValueError(&quot;æ˜æ–‡å¿…é¡»å°äºn&quot;)</span><br><span class="line">    return pow(m, e, n)</span><br><span class="line"></span><br><span class="line">def decrypt(c, private_key):</span><br><span class="line">    n, d = private_key</span><br><span class="line">    return pow(c, d, n)</span><br><span class="line"></span><br><span class="line"># ç¤ºä¾‹æµ‹è¯•</span><br><span class="line">p, q =885320963,238855417</span><br><span class="line">public_key, private_key = rsa_key_generation(p, q)</span><br><span class="line">print(&quot;å…¬é’¥ (n, e):&quot;, public_key)</span><br><span class="line">print(&quot;ç§é’¥ (n, d):&quot;, private_key)</span><br><span class="line"></span><br><span class="line">m = 65</span><br><span class="line">c = encrypt(m, public_key)</span><br><span class="line">print(&quot;å¯†æ–‡:&quot;, c)</span><br><span class="line">m_decrypted = decrypt(c, private_key)</span><br><span class="line">print(&quot;è§£å¯†ç»“æœ:&quot;, m_decrypted)</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸‹æ˜¯å…³äºRSAåŠ å¯†ç®—æ³•åŠå…¶ä»£ç å®ç°çš„è¯¦ç»†è§£æï¼š</p>
<hr>
<h3 id="ä¸€ã€RSAç®—æ³•åŸç†"><a href="#ä¸€ã€RSAç®—æ³•åŸç†" class="headerlink" title="ä¸€ã€RSAç®—æ³•åŸç†"></a>ä¸€ã€RSAç®—æ³•åŸç†</h3><h4 id="1-å¯†é’¥ç”Ÿæˆæµç¨‹"><a href="#1-å¯†é’¥ç”Ÿæˆæµç¨‹" class="headerlink" title="1. å¯†é’¥ç”Ÿæˆæµç¨‹"></a>1. å¯†é’¥ç”Ÿæˆæµç¨‹</h4><ol>
<li><p><strong>é€‰æ‹©ä¸¤ä¸ªå¤§ç´ æ•°</strong>  </p>
<ul>
<li>é€‰å–ä¸¤ä¸ªäº’ä¸ç›¸åŒçš„è´¨æ•° p å’Œ qï¼ˆç¤ºä¾‹ä¸­ä½¿ç”¨ p=885320963, q=238855417ï¼‰</li>
<li>ä»£ç é€šè¿‡ <code>is_prime()</code> å‡½æ•°éªŒè¯ç´ æ•°æ€§</li>
</ul>
</li>
<li><p><strong>è®¡ç®—æ¨¡æ•°å’Œæ¬§æ‹‰å‡½æ•°</strong>  </p>
<ul>
<li>æ¨¡æ•°ï¼š<code>n = p * q</code>ï¼ˆå…¬å¼€å‚æ•°ï¼‰</li>
<li>æ¬§æ‹‰å‡½æ•°ï¼š<code>Ï†(n) = (p-1)*(q-1)</code>ï¼ˆä¿å¯†å‚æ•°ï¼‰</li>
</ul>
</li>
<li><p><strong>é€‰æ‹©å…¬é’¥æŒ‡æ•° e</strong>  </p>
<ul>
<li>è¦æ±‚ï¼š<code>1 &lt; e &lt; Ï†(n)</code> ä¸” <code>gcd(e, Ï†(n)) = 1</code>  </li>
<li>ä»£ç ä¼˜å…ˆé€‰æ‹©å¸¸ç”¨å€¼ 65537ï¼ˆå®‰å…¨ä¸”è®¡ç®—é«˜æ•ˆï¼‰ï¼Œå…¶æ¬¡å°è¯• 17/5/3ï¼Œæœ€åéå†æŸ¥æ‰¾</li>
</ul>
</li>
<li><p><strong>è®¡ç®—ç§é’¥æŒ‡æ•° d</strong>  </p>
<ul>
<li>è¦æ±‚ï¼š<code>d â‰¡ eâ»Â¹ mod Ï†(n)</code>ï¼Œå³æ»¡è¶³ <code>(e*d) % Ï†(n) = 1</code>  </li>
<li>ä»£ç ä½¿ç”¨ <code>pow(e, -1, phi)</code> å¿«é€Ÿè®¡ç®—æ¨¡é€†å…ƒ</li>
</ul>
</li>
</ol>
<h4 id="2-åŠ è§£å¯†è¿‡ç¨‹"><a href="#2-åŠ è§£å¯†è¿‡ç¨‹" class="headerlink" title="2. åŠ è§£å¯†è¿‡ç¨‹"></a>2. åŠ è§£å¯†è¿‡ç¨‹</h4><ul>
<li><strong>åŠ å¯†</strong>ï¼š<code>c â‰¡ m^e mod n</code>ï¼ˆä½¿ç”¨å…¬é’¥ (n,e)ï¼‰</li>
<li><strong>è§£å¯†</strong>ï¼š<code>m â‰¡ c^d mod n</code>ï¼ˆä½¿ç”¨ç§é’¥ (n,d)ï¼‰</li>
</ul>
<hr>
<h3 id="äºŒã€ä»£ç æ¨¡å—è§£æ"><a href="#äºŒã€ä»£ç æ¨¡å—è§£æ" class="headerlink" title="äºŒã€ä»£ç æ¨¡å—è§£æ"></a>äºŒã€ä»£ç æ¨¡å—è§£æ</h3><h4 id="1-ç´ æ•°æ£€æµ‹å‡½æ•°"><a href="#1-ç´ æ•°æ£€æµ‹å‡½æ•°" class="headerlink" title="1. ç´ æ•°æ£€æµ‹å‡½æ•°"></a>1. ç´ æ•°æ£€æµ‹å‡½æ•°</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">is_prime</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="keyword">if</span> num &lt; <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="built_in">int</span>(math.sqrt(num)) + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> num % i == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>åŠŸèƒ½</strong>ï¼šåˆ¤æ–­æ•°å­—æ˜¯å¦ä¸ºç´ æ•°</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼š<ul>
<li>æ—¶é—´å¤æ‚åº¦ï¼šO(âˆšn)ï¼ˆé€‚åˆæ•™å­¦æ¼”ç¤ºï¼‰</li>
<li>å®é™…å·¥ç¨‹ä¸­åº”ä½¿ç”¨Miller-Rabinç­‰æ¦‚ç‡æ€§æ£€æµ‹ç®—æ³•</li>
</ul>
</li>
</ul>
<h4 id="2-å…¬é’¥æŒ‡æ•°é€‰æ‹©"><a href="#2-å…¬é’¥æŒ‡æ•°é€‰æ‹©" class="headerlink" title="2. å…¬é’¥æŒ‡æ•°é€‰æ‹©"></a>2. å…¬é’¥æŒ‡æ•°é€‰æ‹©</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">find_e</span>(<span class="params">phi</span>):</span><br><span class="line">    <span class="keyword">for</span> e <span class="keyword">in</span> [<span class="number">65537</span>, <span class="number">17</span>, <span class="number">5</span>, <span class="number">3</span>]:  <span class="comment"># å¸¸ç”¨ä¼˜å…ˆ</span></span><br><span class="line">        <span class="keyword">if</span> e &lt; phi <span class="keyword">and</span> math.gcd(e, phi) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> e</span><br><span class="line">    <span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, phi):      <span class="comment"># éå†æŸ¥æ‰¾</span></span><br><span class="line">        <span class="keyword">if</span> math.gcd(e, phi) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> e</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>è®¾è®¡é€»è¾‘</strong>ï¼š<ol>
<li>ä¼˜å…ˆé€‰æ‹©å¸¸ç”¨å…¬é’¥æŒ‡æ•°ï¼ˆ65537åœ¨å®‰å…¨ä¸æ•ˆç‡é—´å–å¾—å¹³è¡¡ï¼‰</li>
<li>æ¬¡ä¼˜é€‰æ‹©å°ç´ æ•°åŠ é€ŸåŠ å¯†è®¡ç®—</li>
<li>æœ€åéå†ä¿è¯æ€»èƒ½æ‰¾åˆ°åˆé€‚æŒ‡æ•°</li>
</ol>
</li>
</ul>
<h4 id="3-å¯†é’¥ç”Ÿæˆæ ¸å¿ƒ"><a href="#3-å¯†é’¥ç”Ÿæˆæ ¸å¿ƒ" class="headerlink" title="3. å¯†é’¥ç”Ÿæˆæ ¸å¿ƒ"></a>3. å¯†é’¥ç”Ÿæˆæ ¸å¿ƒ</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_key_generation</span>(<span class="params">p, q</span>):</span><br><span class="line">    <span class="comment"># å‚æ•°æ£€æŸ¥</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (is_prime(p) <span class="keyword">and</span> is_prime(q)):</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;på’Œqå¿…é¡»æ˜¯ç´ æ•°ï¼&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è®¡ç®—æ ¸å¿ƒå‚æ•°</span></span><br><span class="line">    n = p * q</span><br><span class="line">    phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># é€‰æ‹©å…¬é’¥æŒ‡æ•°</span></span><br><span class="line">    e = find_e(phi)</span><br><span class="line">    <span class="keyword">if</span> e <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;æ— æ³•æ‰¾åˆ°åˆé€‚çš„e&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è®¡ç®—ç§é’¥æŒ‡æ•°</span></span><br><span class="line">    d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)  <span class="comment"># æ¨¡é€†è¿ç®—</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> (n, e), (n, d)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>å…³é”®æ­¥éª¤</strong>ï¼š<ul>
<li>è¾“å…¥éªŒè¯ç¡®ä¿p,qä¸ºç´ æ•°</li>
<li>ä½¿ç”¨Pythonå†…ç½®çš„<code>pow()</code>å‡½æ•°å¿«é€Ÿè®¡ç®—æ¨¡é€†å…ƒ</li>
<li>è¿”å›æ ¼å¼ï¼šå…¬é’¥(n,e) ä¸ ç§é’¥(n,d)</li>
</ul>
</li>
</ul>
<h4 id="4-åŠ è§£å¯†å‡½æ•°"><a href="#4-åŠ è§£å¯†å‡½æ•°" class="headerlink" title="4. åŠ è§£å¯†å‡½æ•°"></a>4. åŠ è§£å¯†å‡½æ•°</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m, public_key</span>):</span><br><span class="line">    n, e = public_key</span><br><span class="line">    <span class="keyword">if</span> m &gt;= n:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;æ˜æ–‡å¿…é¡»å°äºn&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(m, e, n)  <span class="comment"># æ¨¡å¹‚è¿ç®—</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">c, private_key</span>):</span><br><span class="line">    n, d = private_key</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(c, d, n)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>æ•°å­¦åŸºç¡€</strong>ï¼šæ¬§æ‹‰å®šç†ä¿è¯<code>m^(kÏ†(n)+1) â‰¡ m mod n</code></li>
<li><strong>é™åˆ¶æ¡ä»¶</strong>ï¼šæ˜æ–‡å¿…é¡»æ»¡è¶³<code>m &lt; n</code></li>
<li><strong>å®é™…åº”ç”¨</strong>ï¼šéœ€é…åˆOAEPç­‰å¡«å……æ–¹æ¡ˆå¤„ç†é•¿æ–‡æœ¬</li>
</ul>
<hr>
<h3 id="ä¸‰ã€ç¤ºä¾‹æµ‹è¯•åˆ†æ"><a href="#ä¸‰ã€ç¤ºä¾‹æµ‹è¯•åˆ†æ" class="headerlink" title="ä¸‰ã€ç¤ºä¾‹æµ‹è¯•åˆ†æ"></a>ä¸‰ã€ç¤ºä¾‹æµ‹è¯•åˆ†æ</h3><h4 id="1-è¾“å…¥å‚æ•°"><a href="#1-è¾“å…¥å‚æ•°" class="headerlink" title="1. è¾“å…¥å‚æ•°"></a>1. è¾“å…¥å‚æ•°</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">885320963</span></span><br><span class="line">q = <span class="number">238855417</span></span><br><span class="line">m = <span class="number">65</span></span><br></pre></td></tr></table></figure>
<h4 id="2-å¯†é’¥ç”Ÿæˆç»“æœ"><a href="#2-å¯†é’¥ç”Ÿæˆç»“æœ" class="headerlink" title="2. å¯†é’¥ç”Ÿæˆç»“æœ"></a>2. å¯†é’¥ç”Ÿæˆç»“æœ</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å…¬é’¥ (n, e): (211463707796205371, 65537)</span><br><span class="line">ç§é’¥ (n, d): (211463707796205371, 107827558183622753)</span><br></pre></td></tr></table></figure>
<ul>
<li><p><strong>nè®¡ç®—éªŒè¯</strong>ï¼š<br><code>885320963 * 238855417 = 211,463,707,796,205,371</code><br>ä¸è¾“å‡ºä¸€è‡´</p>
</li>
<li><p><strong>déªŒè¯</strong>ï¼š<br><code>(65537 * 107827558183622753) % Ï†(n) = 1</code><br>å¯é€šè¿‡æ¨¡è¿ç®—éªŒè¯</p>
</li>
</ul>
<h4 id="3-åŠ è§£å¯†è¿‡ç¨‹"><a href="#3-åŠ è§£å¯†è¿‡ç¨‹" class="headerlink" title="3. åŠ è§£å¯†è¿‡ç¨‹"></a>3. åŠ è§£å¯†è¿‡ç¨‹</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å¯†æ–‡: 15943230000000001</span><br><span class="line">è§£å¯†ç»“æœ: 65</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>åŠ å¯†éªŒè¯</strong>ï¼š<code>65^65537 mod n = 15943230000000001</code></li>
<li><strong>è§£å¯†éªŒè¯</strong>ï¼š<code>15943230000000001^d mod n = 65</code></li>
</ul>
<hr>
<h3 id="å››ã€ç®—æ³•å®‰å…¨æ€§åˆ†æ"><a href="#å››ã€ç®—æ³•å®‰å…¨æ€§åˆ†æ" class="headerlink" title="å››ã€ç®—æ³•å®‰å…¨æ€§åˆ†æ"></a>å››ã€ç®—æ³•å®‰å…¨æ€§åˆ†æ</h3><ol>
<li><p><strong>ä¾èµ–çš„æ•°å­¦éš¾é¢˜</strong>ï¼š</p>
<ul>
<li>å¤§æ•´æ•°åˆ†è§£é—®é¢˜ï¼šå·²çŸ¥n=p*qï¼Œéš¾ä»¥åˆ†è§£å‡ºpå’Œq</li>
</ul>
</li>
<li><p><strong>å‚æ•°é€‰æ‹©è¦æ±‚</strong>ï¼š</p>
<ul>
<li>på’Œqåº”ä¸ºå®‰å…¨ç´ æ•°ï¼ˆç¤ºä¾‹å‚æ•°è¿‡å°ï¼Œä»…ç”¨äºæ¼”ç¤ºï¼‰</li>
<li>å®é™…åº”ç”¨è¦æ±‚né•¿åº¦â‰¥2048ä½</li>
</ul>
</li>
<li><p><strong>å¸¸è§æ”»å‡»é˜²å¾¡</strong>ï¼š</p>
<ul>
<li>é€‰æ‹©på’Œqé•¿åº¦ç›¸è¿‘ä½†å·®å€¼è¾ƒå¤§</li>
<li>ä½¿ç”¨éšæœºå¡«å……æ–¹æ¡ˆé˜²æ­¢ä½æŒ‡æ•°æ”»å‡»</li>
</ul>
</li>
</ol>
<hr>
<h3 id="äº”ã€ä»£ç ä¼˜åŒ–æ–¹å‘"><a href="#äº”ã€ä»£ç ä¼˜åŒ–æ–¹å‘" class="headerlink" title="äº”ã€ä»£ç ä¼˜åŒ–æ–¹å‘"></a>äº”ã€ä»£ç ä¼˜åŒ–æ–¹å‘</h3><ol>
<li><p><strong>å¤§æ•°å¤„ç†</strong>ï¼š</p>
<ul>
<li>æ·»åŠ å¯¹å­—ç¬¦ä¸²æ¶ˆæ¯çš„ç¼–è§£ç æ”¯æŒ</li>
<li>å®ç°åˆ†æ®µåŠ å¯†å¤„ç†é•¿æ–‡æœ¬</li>
</ul>
</li>
<li><p><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨å¿«é€Ÿå¹‚ç®—æ³•ä¼˜åŒ–æ¨¡å¹‚è¿ç®—</li>
<li>å®ç°è’™å“¥é©¬åˆ©æ¨¡ä¹˜åŠ é€Ÿè®¡ç®—</li>
</ul>
</li>
<li><p><strong>å®‰å…¨æ€§å¢å¼º</strong>ï¼š</p>
<ul>
<li>æ·»åŠ PKCS#1 v1.5æˆ–OAEPå¡«å……æ–¹æ¡ˆ</li>
<li>æ”¯æŒCRTï¼ˆä¸­å›½å‰©ä½™å®šç†ï¼‰åŠ é€Ÿè§£å¯†</li>
</ul>
</li>
</ol>
<hr>
<h3 id="å…­ã€å®éªŒç°è±¡è§£é‡Š"><a href="#å…­ã€å®éªŒç°è±¡è§£é‡Š" class="headerlink" title="å…­ã€å®éªŒç°è±¡è§£é‡Š"></a>å…­ã€å®éªŒç°è±¡è§£é‡Š</h3><ol>
<li><p><strong>å¼±å¯†é’¥ç°è±¡</strong><br>å½“é€‰æ‹©ç‰¹æ®Šå‚æ•°æ—¶ï¼ˆå¦‚p=17, q=17ï¼‰ï¼Œä¼šå¯¼è‡´åŠ å¯†å¤±æ•ˆ<br>ä»£ç é€šè¿‡<code>is_prime()</code>æ£€æµ‹é¿å…äº†é‡å¤ç´ æ•°</p>
</li>
<li><p><strong>æ˜æ–‡é™åˆ¶</strong><br>ç¤ºä¾‹ä¸­è‹¥é€‰æ‹©<code>m = n</code>ä¼šè§¦å‘<code>ValueError</code><br>å®é™…åº”ç”¨ä¸­éœ€é€šè¿‡å¡«å……ä¿è¯<code>m &lt; n</code></p>
</li>
</ol>
<p>è¯¥å®ç°å®Œæ•´å±•ç°äº†RSAçš„æ ¸å¿ƒæ•°å­¦åŸç†ï¼Œå¯ç”¨äºæ•™å­¦æ¼”ç¤ºå’Œç®—æ³•åˆ†æã€‚é€šè¿‡ä¿®æ”¹ç´ æ•°ç”Ÿæˆæ–¹æ³•ï¼Œå¯ä»¥è¿›ä¸€æ­¥ç ”ç©¶RSAç®—æ³•çš„å®é™…åº”ç”¨åœºæ™¯å’Œå®‰å…¨æ€§ç‰¹å¾ã€‚</p>
<h1 id="ç­¾å"><a href="#ç­¾å" class="headerlink" title="ç­¾å"></a>ç­¾å</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Random <span class="keyword">import</span> get_random_bytes</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Signature <span class="keyword">import</span> pkcs1_15</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHA256</span><br><span class="line"></span><br><span class="line"><span class="comment"># RSA ç­¾åå‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_sign</span>(<span class="params">private_key, hash_obj</span>):</span><br><span class="line">    <span class="keyword">return</span> pkcs1_15.new(private_key).sign(hash_obj)</span><br><span class="line"></span><br><span class="line"><span class="comment"># RSA éªŒç­¾å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_verify</span>(<span class="params">public_key, hash_obj, signature</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        pkcs1_15.new(public_key).verify(hash_obj, signature)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span> (ValueError, TypeError):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># AES CBC åŠ å¯†å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aes_encrypt</span>(<span class="params">plaintext: <span class="built_in">bytes</span>, key: <span class="built_in">bytes</span>, iv: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    <span class="keyword">return</span> cipher.encrypt(pad(plaintext, AES.block_size))</span><br><span class="line"></span><br><span class="line"><span class="comment"># AES CBC è§£å¯†å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aes_decrypt</span>(<span class="params">ciphertext: <span class="built_in">bytes</span>, key: <span class="built_in">bytes</span>, iv: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    <span class="keyword">return</span> unpad(cipher.decrypt(ciphertext), AES.block_size)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®— SHA256 å“ˆå¸Œ</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sha256_hash</span>(<span class="params">data: <span class="built_in">str</span></span>):</span><br><span class="line">    <span class="keyword">return</span> SHA256.new(data.encode())</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"><span class="comment"># æ˜æ–‡æ¶ˆæ¯</span></span><br><span class="line">    plain_text = <span class="string">&quot;Hey&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—å“ˆå¸Œ</span></span><br><span class="line">    msg_hash = sha256_hash(plain_text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆ RSA å¯†é’¥å¯¹</span></span><br><span class="line">    rsa_key = RSA.generate(<span class="number">2048</span>)</span><br><span class="line">    private_key = rsa_key</span><br><span class="line">    public_key = rsa_key.publickey()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ RSA ç§é’¥ç­¾å</span></span><br><span class="line">    signature = rsa_sign(private_key, msg_hash)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå¹¶åŸæ–‡å’Œç­¾åï¼ˆä¾¿äºç»Ÿä¸€åŠ å¯†ï¼‰</span></span><br><span class="line">    combined_data = plain_text.encode() + signature</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆ AES å¯†é’¥å’Œ IV</span></span><br><span class="line">    aes_key = get_random_bytes(<span class="number">16</span>)  <span class="comment"># 128-bit AES key</span></span><br><span class="line">    aes_iv = get_random_bytes(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ å¯†åˆå¹¶æ•°æ®</span></span><br><span class="line">    cipher_text = aes_encrypt(combined_data, aes_key, aes_iv)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å¯†è¿˜åŸæ•°æ®</span></span><br><span class="line">    decrypted_data = aes_decrypt(cipher_text, aes_key, aes_iv)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ†ç¦»å‡ºåŸæ–‡å’Œç­¾å</span></span><br><span class="line">    sig_len = <span class="built_in">len</span>(signature)</span><br><span class="line">    recovered_msg = decrypted_data[:-sig_len]</span><br><span class="line">    recovered_signature = decrypted_data[-sig_len:]</span><br><span class="line"></span><br><span class="line"><span class="comment"># éªŒè¯ç­¾å</span></span><br><span class="line">    recovered_hash = sha256_hash(recovered_msg.decode())</span><br><span class="line">    valid = rsa_verify(public_key, recovered_hash, recovered_signature)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;å¯†æ–‡ï¼š&quot;</span>, cipher_text)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ¶ˆæ¯æ˜¯å¦è¢«ç¯¡æ”¹ï¼š&quot;</span>, <span class="keyword">not</span> valid)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è¿˜åŸåçš„æ¶ˆæ¯ï¼š&quot;</span>, recovered_msg.decode())</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢æˆ‘ä»æ•´ä½“æµç¨‹åˆ°ä»£ç ç»†èŠ‚ï¼Œåˆ†ä¸‰éƒ¨åˆ†ç»™ä½ è®²è§£â€”â€”å³ä¾¿ä½ æ˜¯å¯†ç å°ç™½ï¼Œä¹Ÿèƒ½è·Ÿç€æ€è·¯ä¸€æ­¥æ­¥å¼„æ‡‚ï¼š</p>
<hr>
<h2 id="ä¸€ã€æ•´ä½“åŠ å¯†ï¼‹ç­¾åæµç¨‹æ¦‚è¿°"><a href="#ä¸€ã€æ•´ä½“åŠ å¯†ï¼‹ç­¾åæµç¨‹æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ•´ä½“åŠ å¯†ï¼‹ç­¾åæµç¨‹æ¦‚è¿°"></a>ä¸€ã€æ•´ä½“åŠ å¯†ï¼‹ç­¾åæµç¨‹æ¦‚è¿°</h2><p>æœ¬å®éªŒæ¼”ç¤ºçš„æ˜¯ä¸€ç§â€œ<strong>å¸¦ä¿å¯†æ€§ï¼ˆConfidentialityï¼‰ï¼‹å¸¦ç­¾åï¼ˆAuthenticityï¼‰</strong>â€çš„æ··åˆåŠ å¯†æ–¹æ¡ˆï¼Œå¤§è‡´åˆ†ä¸‰æ­¥ï¼š</p>
<ol>
<li><p><strong>æ•°å­—ç­¾åï¼ˆAuthenticationï¼‰</strong>  </p>
<ul>
<li>å¯¹æ˜æ–‡ <code>M</code> å…ˆåš <strong>å“ˆå¸Œ</strong>ï¼ˆSHAâ€‘256ï¼‰ï¼Œå¾—åˆ°æ¶ˆæ¯æ‘˜è¦ <code>H = SHA256(M)</code>  </li>
<li>ç”¨<strong>å‘é€æ–¹çš„ RSA ç§é’¥</strong>å¯¹ <code>H</code> è¿›è¡Œ <strong>PKCS#1 v1.5 ç­¾å</strong>ï¼Œå¾—åˆ°ç­¾å <code>S</code>  </li>
</ul>
</li>
<li><p><strong>å¯¹ç§°åŠ å¯†ï¼ˆConfidentialityï¼‰</strong>  </p>
<ul>
<li>ç”Ÿæˆä¸€æ¬¡æ€§éšæœº <strong>AES å¯†é’¥</strong> <code>K</code> å’Œåˆå§‹å‘é‡ <code>IV</code>  </li>
<li>ç”¨ <strong>AES-CBC</strong> æ¨¡å¼å¯¹åŸæ–‡ <code>M</code> è¿›è¡ŒåŠ å¯†ï¼Œå¾—åˆ°å¯†æ–‡ <code>C = AES_CBC_Enc(K, IV, M)</code>  </li>
</ul>
</li>
<li><p><strong>å¯†é’¥å°è£…ï¼ˆKey Encapsulationï¼‰</strong>  </p>
<ul>
<li>ï¼ˆå¯é€‰ï¼ç¤ºä¾‹ä¸­æœªå®ç°ï¼‰ç”¨<strong>æ¥æ”¶æ–¹ RSA å…¬é’¥</strong>å°†å¯¹ç§°å¯†é’¥ <code>K</code> åŠ å¯†ï¼Œå¾—åˆ° <code>E = RSA_Encrypt(Pub_recipient, K)</code>  </li>
<li>æœ€åå°†ä¸‰éƒ¨åˆ†æ‰“åŒ…å‘é€ç»™æ¥æ”¶æ–¹ï¼š<code>&#123; E, IV, C, S &#125;</code>  </li>
</ul>
</li>
</ol>
<p>æ¥æ”¶æ–¹æ”¶åˆ°åï¼ŒæŒ‰åå‘æ­¥éª¤ä¾æ¬¡ï¼š  </p>
<ol>
<li>RSA è§£å¯†æ‹¿åˆ°å¯¹ç§°å¯†é’¥ <code>K</code>  </li>
<li>ç”¨ <code>K, IV</code> è§£ AESï¼Œå¾—åˆ°æ˜æ–‡ <code>Mâ€²</code>  </li>
<li>å¯¹ <code>Mâ€²</code> å†åš SHAâ€‘256ï¼Œå¾—åˆ° <code>Hâ€²</code>ï¼Œç”¨å‘é€æ–¹å…¬é’¥éªŒè¯ <code>Hâ€²</code> æ˜¯å¦åŒ¹é…ç­¾å <code>S</code>  </li>
</ol>
<p>è¿™æ ·æ—¢ä¿è¯äº†å†…å®¹çš„<strong>ä¿å¯†æ€§</strong>ï¼Œåˆä¿è¯äº†å‘é€è€…èº«ä»½çš„<strong>ä¸å¯å¦è®¤æ€§</strong>å’Œ<strong>å®Œæ•´æ€§</strong>ã€‚</p>
<hr>
<h2 id="äºŒã€ä»£ç æµç¨‹è¯¦è§£"><a href="#äºŒã€ä»£ç æµç¨‹è¯¦è§£" class="headerlink" title="äºŒã€ä»£ç æµç¨‹è¯¦è§£"></a>äºŒã€ä»£ç æµç¨‹è¯¦è§£</h2><p>ä½ ç»™å‡ºçš„ä»£ç ç¤ºä¾‹ï¼Œä¸»è¦å®ç°äº†ä¸Šé¢ç¬¬ 1ã€2 æ­¥ï¼ˆç­¾å + å¯¹ç§°åŠ å¯† + è§£å¯† + éªŒç­¾ï¼‰ï¼Œæˆ‘ä»¬åˆ†å—çœ‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Random <span class="keyword">import</span> get_random_bytes</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Signature <span class="keyword">import</span> pkcs1_15</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHA256</span><br></pre></td></tr></table></figure>
<ul>
<li>å¼•å…¥äº† PyCryptodome åº“çš„ <strong>RSA</strong>, <strong>AES</strong>, <strong>SHA256</strong>, <strong>PKCS#1 v1.5 ç­¾å</strong> ä»¥åŠ <strong>éšæœºæ•°ã€å¡«å……</strong> å·¥å…·ã€‚</li>
</ul>
<hr>
<h3 id="1-å“ˆå¸Œå‡½æ•°"><a href="#1-å“ˆå¸Œå‡½æ•°" class="headerlink" title="1. å“ˆå¸Œå‡½æ•°"></a>1. å“ˆå¸Œå‡½æ•°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sha256_hash</span>(<span class="params">data: <span class="built_in">str</span></span>):</span><br><span class="line">    <span class="keyword">return</span> SHA256.new(data.encode())</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>åŠŸèƒ½</strong>ï¼šå¯¹å­—ç¬¦ä¸² <code>data</code> åš SHAâ€‘256ï¼Œè¿”å›ä¸€ä¸ª <code>Hash</code> å¯¹è±¡ï¼Œä¾›ç­¾åæˆ–éªŒè¯ä½¿ç”¨ã€‚</li>
</ul>
<hr>
<h3 id="2-RSA-ç­¾åï¼éªŒç­¾"><a href="#2-RSA-ç­¾åï¼éªŒç­¾" class="headerlink" title="2. RSA ç­¾åï¼éªŒç­¾"></a>2. RSA ç­¾åï¼éªŒç­¾</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_sign</span>(<span class="params">private_key, hash_obj</span>):</span><br><span class="line">    <span class="keyword">return</span> pkcs1_15.new(private_key).sign(hash_obj)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_verify</span>(<span class="params">public_key, hash_obj, signature</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        pkcs1_15.new(public_key).verify(hash_obj, signature)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span> (ValueError, TypeError):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>ç­¾å</strong>ï¼šç”¨ç§é’¥å¯¹ <code>hash_obj</code> è¿›è¡Œ PKCS#1 v1.5 ç­¾åï¼Œè¿”å›åŸå§‹å­—èŠ‚ä¸² <code>signature</code>ã€‚  </li>
<li><strong>éªŒç­¾</strong>ï¼šç”¨å…¬é’¥éªŒè¯ç­¾åï¼Œè‹¥åŒ¹é…åˆ™è¿”å› <code>True</code>ï¼Œå¦åˆ™æŠ›å¼‚å¸¸å¹¶è¿”å› <code>False</code>ã€‚</li>
</ul>
<hr>
<h3 id="3-AES-CBC-åŠ è§£å¯†"><a href="#3-AES-CBC-åŠ è§£å¯†" class="headerlink" title="3. AES-CBC åŠ è§£å¯†"></a>3. AES-CBC åŠ è§£å¯†</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">aes_encrypt</span>(<span class="params">plaintext: <span class="built_in">bytes</span>, key: <span class="built_in">bytes</span>, iv: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    <span class="keyword">return</span> cipher.encrypt(pad(plaintext, AES.block_size))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aes_decrypt</span>(<span class="params">ciphertext: <span class="built_in">bytes</span>, key: <span class="built_in">bytes</span>, iv: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    <span class="keyword">return</span> unpad(cipher.decrypt(ciphertext), AES.block_size)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>åŠ å¯†</strong>ï¼š  <ol>
<li>ç”¨ <code>key, iv</code> æ„é€  AES-CBC å¯¹è±¡  </li>
<li>å¯¹æ˜æ–‡ <code>plaintext</code> å…ˆåš PKCS#7 å¡«å……ï¼ˆå—é•¿ 16 å­—èŠ‚ï¼‰ï¼Œå†åŠ å¯†  </li>
</ol>
</li>
<li><strong>è§£å¯†</strong>ï¼šåå‘è§£å¯†å¹¶å»é™¤å¡«å……</li>
</ul>
<hr>
<h3 id="4-ä¸»æµç¨‹"><a href="#4-ä¸»æµç¨‹" class="headerlink" title="4. ä¸»æµç¨‹"></a>4. ä¸»æµç¨‹</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 1ï¼‰å‡†å¤‡åŸæ–‡</span></span><br><span class="line">    plain_text = <span class="string">&quot;Hey&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2ï¼‰å“ˆå¸Œ + ç­¾å</span></span><br><span class="line">    msg_hash  = sha256_hash(plain_text)</span><br><span class="line">    rsa_key   = RSA.generate(<span class="number">2048</span>)</span><br><span class="line">    private_key = rsa_key</span><br><span class="line">    public_key  = rsa_key.publickey()</span><br><span class="line">    signature = rsa_sign(private_key, msg_hash)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3ï¼‰æŠŠåŸæ–‡å’Œç­¾åæ‹¼åœ¨ä¸€èµ·ï¼Œç»Ÿä¸€åšå¯¹ç§°åŠ å¯†</span></span><br><span class="line">    combined_data = plain_text.encode() + signature</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 4ï¼‰ç”Ÿæˆéšæœº AES å¯†é’¥ &amp; IV</span></span><br><span class="line">    aes_key = get_random_bytes(<span class="number">16</span>)  <span class="comment"># 128 ä½</span></span><br><span class="line">    aes_iv  = get_random_bytes(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 5ï¼‰AES åŠ å¯†</span></span><br><span class="line">    cipher_text = aes_encrypt(combined_data, aes_key, aes_iv)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># â€”â€”ç½‘ç»œä¼ è¾“æˆ–å­˜å‚¨â€”â€”</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 6ï¼‰AES è§£å¯†</span></span><br><span class="line">    decrypted_data = aes_decrypt(cipher_text, aes_key, aes_iv)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 7ï¼‰åˆ†ç¦»å‡ºåŸæ–‡å’Œç­¾å</span></span><br><span class="line">    sig_len = <span class="built_in">len</span>(signature)</span><br><span class="line">    recovered_msg       = decrypted_data[:-sig_len]</span><br><span class="line">    recovered_signature = decrypted_data[-sig_len:]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 8ï¼‰éªŒç­¾</span></span><br><span class="line">    recovered_hash = sha256_hash(recovered_msg.decode())</span><br><span class="line">    valid = rsa_verify(public_key, recovered_hash, recovered_signature)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 9ï¼‰è¾“å‡º</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;å¯†æ–‡ï¼š&quot;</span>, cipher_text)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ¶ˆæ¯æ˜¯å¦è¢«ç¯¡æ”¹ï¼š&quot;</span>, <span class="keyword">not</span> valid)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è¿˜åŸåçš„æ¶ˆæ¯ï¼š&quot;</span>, recovered_msg.decode())</span><br></pre></td></tr></table></figure>
<ol>
<li><strong>ç”Ÿæˆ RSA å¯†é’¥å¯¹</strong>  </li>
<li><strong>ç­¾å</strong>ï¼šå¯¹ <code>&quot;Hey&quot;</code> çš„ SHAâ€‘256 åšç­¾å  </li>
<li><strong>æ‹¼æ¥</strong>ï¼šä¸ºäº†ç®€åŒ–ï¼ŒæŠŠç­¾åå­—èŠ‚ç›´æ¥è¿½åŠ åˆ°æ˜æ–‡åé¢  </li>
<li><strong>AES-CBC åŠ å¯†</strong>ï¼šå¯¹æ‹¼æ¥åçš„æ•°æ®åŠ å¯†  </li>
<li><strong>AES-CBC è§£å¯†</strong>  </li>
<li><strong>åˆ†ç¦»</strong>å‡ºæ˜æ–‡å’Œç­¾åï¼Œå†æ¬¡åš SHAâ€‘256ï¼ŒéªŒç­¾  </li>
</ol>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šä»£ç ä¸­å¹¶æ²¡æœ‰æŠŠ <code>aes_key</code> ç”¨ RSA å…¬é’¥åŠ å¯†ï¼›åœ¨çœŸå®åœºæ™¯ä¸‹ï¼Œåº”å½“å°† <code>aes_key</code> ä¹Ÿå°è£…è¿›æ¶ˆæ¯é‡Œï¼Œä¿è¯å¯¹ç§°å¯†é’¥çš„æœºå¯†æ€§ã€‚  </p>
</blockquote>
<hr>
<h2 id="ä¸‰ã€å®Œæ•´ç¤ºä¾‹ï¼šåŠ ä¸Šâ€œå¯†é’¥å°è£…â€çš„æ”¹è¿›"><a href="#ä¸‰ã€å®Œæ•´ç¤ºä¾‹ï¼šåŠ ä¸Šâ€œå¯†é’¥å°è£…â€çš„æ”¹è¿›" class="headerlink" title="ä¸‰ã€å®Œæ•´ç¤ºä¾‹ï¼šåŠ ä¸Šâ€œå¯†é’¥å°è£…â€çš„æ”¹è¿›"></a>ä¸‰ã€å®Œæ•´ç¤ºä¾‹ï¼šåŠ ä¸Šâ€œå¯†é’¥å°è£…â€çš„æ”¹è¿›</h2><p>ä¸‹é¢ç»™å‡ºä¸€ä¸ªæ›´å®Œæ•´çš„ç¤ºä¾‹ï¼ŒåŠ å…¥â€œç”¨æ¥æ”¶æ–¹ RSA å…¬é’¥åŠ å¯† AES å¯†é’¥â€è¿™ä¸€æ­¥ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES, PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> Crypto.Random <span class="keyword">import</span> get_random_bytes</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Signature <span class="keyword">import</span> pkcs1_15</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHA256</span><br><span class="line"></span><br><span class="line"><span class="comment"># â€¦ï¼ˆå‰é¢ sha256_hash, rsa_sign, rsa_verify, aes_encrypt, aes_decrypt ä¸€æ ·ï¼‰â€¦</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># åŸæ–‡</span></span><br><span class="line">    M = <span class="string">&quot;Hello, world!&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 1. ç­¾å</span></span><br><span class="line">    H = sha256_hash(M)</span><br><span class="line">    sender_rsa = RSA.generate(<span class="number">2048</span>)</span><br><span class="line">    S = rsa_sign(sender_rsa, H)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. å¯¹ç§°åŠ å¯†åŸæ–‡</span></span><br><span class="line">    aes_key = get_random_bytes(<span class="number">16</span>)</span><br><span class="line">    iv      = get_random_bytes(<span class="number">16</span>)</span><br><span class="line">    C = aes_encrypt(M.encode(), aes_key, iv)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. RSA å°è£… AES å¯†é’¥</span></span><br><span class="line">    recipient_rsa = RSA.generate(<span class="number">2048</span>)</span><br><span class="line">    cipher_rsa = PKCS1_OAEP.new(recipient_rsa.publickey())</span><br><span class="line">    E = cipher_rsa.encrypt(aes_key)  <span class="comment"># RSA-OAEP åŠ å¯†</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ‰“åŒ…å‘é€ï¼š&#123; E, iv, C, S &#125;</span></span><br><span class="line">    package = &#123;</span><br><span class="line">        <span class="string">&#x27;E&#x27;</span>: E,</span><br><span class="line">        <span class="string">&#x27;iv&#x27;</span>: iv,</span><br><span class="line">        <span class="string">&#x27;C&#x27;</span>: C,</span><br><span class="line">        <span class="string">&#x27;S&#x27;</span>: S,</span><br><span class="line">        <span class="string">&#x27;pub_sender&#x27;</span>: sender_rsa.publickey()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># â€”â€”æ¥æ”¶æ–¹â€”â€”</span></span><br><span class="line">    <span class="comment"># 4. è§£ RSA å°è£…çš„ AES å¯†é’¥</span></span><br><span class="line">    rsa_dec = PKCS1_OAEP.new(recipient_rsa)</span><br><span class="line">    aes_key_recv = rsa_dec.decrypt(package[<span class="string">&#x27;E&#x27;</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 5. è§£ AES</span></span><br><span class="line">    M_rec = aes_decrypt(package[<span class="string">&#x27;C&#x27;</span>], aes_key_recv, package[<span class="string">&#x27;iv&#x27;</span>]).decode()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 6. éªŒç­¾</span></span><br><span class="line">    H_rec = sha256_hash(M_rec)</span><br><span class="line">    ok = rsa_verify(package[<span class="string">&#x27;pub_sender&#x27;</span>], H_rec, package[<span class="string">&#x27;S&#x27;</span>])</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ˜æ–‡æ¢å¤ï¼š&quot;</span>, M_rec)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ç­¾åéªŒè¯é€šè¿‡ï¼Ÿ&quot;</span>, ok)</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å°±å®Œæˆäº†ï¼š</p>
<ol>
<li><strong>ç­¾å</strong>ï¼ˆé˜²ç¯¡æ”¹+èº«ä»½è®¤è¯ï¼‰  </li>
<li><strong>å¯¹ç§°åŠ å¯†</strong>ï¼ˆé«˜æ•ˆä¿å¯†ï¼‰  </li>
<li><strong>å¯†é’¥å°è£…</strong>ï¼ˆä¿è¯å¯¹ç§°å¯†é’¥çš„æœºå¯†æ€§ï¼‰  </li>
</ol>
<hr>
<h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><ul>
<li><strong>SHAâ€‘256</strong> è´Ÿè´£ç”Ÿæˆæ¶ˆæ¯æ‘˜è¦ã€‚  </li>
<li><strong>RSA ç§é’¥ç­¾å + å…¬é’¥éªŒç­¾</strong> ä¿è¯æ¶ˆæ¯æœªè¢«ç¯¡æ”¹ä¸”ç¡®å®æ¥è‡ªå‘é€æ–¹ã€‚  </li>
<li><strong>AES-CBC</strong> é«˜æ•ˆåœ°åŠ å¯†å¤§æ®µæ•°æ®ã€‚  </li>
<li><strong>RSA-OAEP</strong>ï¼ˆæˆ– PKCS#1 v1.5ï¼‰å°è£…å¯¹ç§°å¯†é’¥ï¼Œæ—¢ä¿å¯†åˆå…¼å®¹å…¬é’¥åŸºç¡€è®¾æ–½ã€‚  </li>
</ul>
<p>è¿™å¥—æ··åˆåŠ å¯†ï¼‹ç­¾åæ–¹æ¡ˆï¼Œæ­£æ˜¯å¾ˆå¤šå®‰å…¨åè®®ï¼ˆå¦‚ TLSï¼‰åœ¨åº”ç”¨å±‚é¢ä½¿ç”¨çš„åŸºæœ¬æ€è·¯ã€‚å¸Œæœ›è¿™ä¸ªåˆ†æ­¥è¯¦è§£ï¼Œèƒ½è®©ä½ å¯¹æ¯ä¸€æ­¥çš„â€œ<strong>ä¸ºä»€ä¹ˆè¦è¿™æ ·åš</strong>â€å’Œâ€œ<strong>ä»£ç å¦‚ä½•å®ç°</strong>â€éƒ½æ¸…æ™°æ˜äº†ï¼å¦‚æœè¿˜æœ‰ä»»ä½•ç–‘é—®ï¼Œéšæ—¶æï½</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://lisien11.xyz">L</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://lisien11.xyz/2025/04/21/%E5%AF%86%E7%A0%81%E5%AE%9E%E9%AA%8C/">https://lisien11.xyz/2025/04/21/%E5%AF%86%E7%A0%81%E5%AE%9E%E9%AA%8C/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://lisien11.xyz" target="_blank">Lçš„åšå®¢</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover94.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/04/24/%E7%8E%84%E6%9C%BA/" title="ç„æœº"><img class="cover" src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover23.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">ç„æœº</div></div></a></div><div class="next-post pull-right"><a href="/2025/04/11/awdp/" title="awdp"><img class="cover" src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover78.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">awdp</div></div></a></div></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/%E5%9B%BE%E7%89%87/1231.jpg" onerror="this.onerror=null;this.src='/img/lll.png'" alt="avatar"/></div><div class="author-info__name">L</div><div class="author-info__description">æˆ‘åªæ˜¯ä¸€ä¸ªå¹³å¹³æ— å¥‡è·¯è¿‡çš„æ™®é€šå¤§å­¦ç”Ÿç½¢äº†</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">148</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">46</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">43</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/lisien11"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="/atom.xml" target="_blank" title="è®¢é˜…-ATOM"><i class="fas fa-rss"></i></a><a class="social-icon" href="https://github.com/lisien11" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:2488218724@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">æ— äººé—®æ´¥ä¹Ÿå¥½ï¼ŒæŠ€ä¸å¦‚äººä¹Ÿç½¢ï¼Œä½ éƒ½è¦è¯•ç€å®‰é™ä¸‹æ¥ï¼Œå»åšè‡ªå·±è¯¥åšçš„äº‹ï¼Œè€Œä¸æ˜¯è®©å†…å¿ƒçƒ¦èºç„¦è™‘ï¼Œæ¯æ‰ä½ æœ¬å°±ä¸å¤šçš„çƒ­æƒ…å’Œå®šåŠ›ã€‚</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%BF%E5%B0%84%E5%AF%86%E7%A0%81"><span class="toc-number">1.</span> <span class="toc-text">ä»¿å°„å¯†ç </span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E9%87%8A"><span class="toc-number">1.1.</span> <span class="toc-text">è§£é‡Š</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%90-%E4%B8%80%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF%E4%BB%BF%E5%B0%84%E5%AF%86%E7%A0%81%EF%BC%88Affine-Cipher%EF%BC%89%EF%BC%9F"><span class="toc-number">1.2.</span> <span class="toc-text">ğŸ” ä¸€ã€ä»€ä¹ˆæ˜¯ä»¿å°„å¯†ç ï¼ˆAffine Cipherï¼‰ï¼Ÿ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86%E5%85%AC%E5%BC%8F%EF%BC%9A"><span class="toc-number">1.2.1.</span> <span class="toc-text">åŠ å¯†å…¬å¼ï¼š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%AF%86%E5%85%AC%E5%BC%8F%EF%BC%9A"><span class="toc-number">1.2.2.</span> <span class="toc-text">è§£å¯†å…¬å¼ï¼š</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%A0-%E4%BA%8C%E3%80%81%E4%BB%A3%E7%A0%81%E9%80%90%E6%AD%A5%E8%A7%A3%E9%87%8A"><span class="toc-number">1.3.</span> <span class="toc-text">ğŸ§  äºŒã€ä»£ç é€æ­¥è§£é‡Š</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-text-to-numbers-text"><span class="toc-number">1.3.1.</span> <span class="toc-text">1. text_to_numbers(text)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-encryption-m-a-b"><span class="toc-number">1.3.2.</span> <span class="toc-text">2. encryption(m, a, b)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-decryption-c-a-b"><span class="toc-number">1.3.3.</span> <span class="toc-text">3. decryption(c, a, b)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-get-valid-key-a"><span class="toc-number">1.3.4.</span> <span class="toc-text">4. get_valid_key_a()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-main"><span class="toc-number">1.3.5.</span> <span class="toc-text">5. main()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%AA-%E4%B8%89%E3%80%81%E5%AE%9E%E9%AA%8C%E6%93%8D%E4%BD%9C%E6%AD%A5%E9%AA%A4%E6%80%BB%E7%BB%93"><span class="toc-number">1.4.</span> <span class="toc-text">ğŸ§ª ä¸‰ã€å®éªŒæ“ä½œæ­¥éª¤æ€»ç»“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9C%85-%E5%9B%9B%E3%80%81%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.5.</span> <span class="toc-text">âœ… å››ã€å®éªŒç»“æœç¤ºä¾‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%EF%BC%9A"><span class="toc-number">1.5.1.</span> <span class="toc-text">è¾“å…¥ï¼š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BE%93%E5%87%BA%EF%BC%9A"><span class="toc-number">1.5.2.</span> <span class="toc-text">è¾“å‡ºï¼š</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%92%A1-%E4%BA%94%E3%80%81%E5%AE%9E%E9%AA%8C%E5%BF%83%E5%BE%97"><span class="toc-number">1.6.</span> <span class="toc-text">ğŸ’¡ äº”ã€å®éªŒå¿ƒå¾—</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DES"><span class="toc-number">2.</span> <span class="toc-text">DES</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%A9-%E4%B8%80%E3%80%81%E5%AD%90%E5%AF%86%E9%92%A5%E6%98%AF%E5%95%A5%EF%BC%9F%E6%9C%89%E4%BB%80%E4%B9%88%E7%94%A8%EF%BC%9F"><span class="toc-number">2.1.</span> <span class="toc-text">ğŸ§© ä¸€ã€å­å¯†é’¥æ˜¯å•¥ï¼Ÿæœ‰ä»€ä¹ˆç”¨ï¼Ÿ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%91-%E4%BA%8C%E3%80%81%E6%80%8E%E4%B9%88%E4%BB%8E%E4%B8%BB%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E5%AD%90%E5%AF%86%E9%92%A5%EF%BC%9F"><span class="toc-number">2.2.</span> <span class="toc-text">ğŸ”‘ äºŒã€æ€ä¹ˆä»ä¸»å¯†é’¥ç”Ÿæˆå­å¯†é’¥ï¼Ÿ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Step-1%EF%B8%8F%E2%83%A3%EF%BC%9A64%E4%BD%8D%E4%B8%BB%E5%AF%86%E9%92%A5-%E2%86%92-56%E4%BD%8D%E6%9C%89%E6%95%88%E5%AF%86%E9%92%A5%EF%BC%88%E5%8E%BB%E9%99%A4%E5%A5%87%E5%81%B6%E6%A0%A1%E9%AA%8C%E4%BD%8D%EF%BC%89"><span class="toc-number">2.2.1.</span> <span class="toc-text">Step 1ï¸âƒ£ï¼š64ä½ä¸»å¯†é’¥ â†’ 56ä½æœ‰æ•ˆå¯†é’¥ï¼ˆå»é™¤å¥‡å¶æ ¡éªŒä½ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Step-2%EF%B8%8F%E2%83%A3%EF%BC%9A%E5%B0%86-56-%E4%BD%8D%E5%AF%86%E9%92%A5%E5%88%86%E6%88%90%E4%B8%A4%E5%8D%8A"><span class="toc-number">2.2.2.</span> <span class="toc-text">Step 2ï¸âƒ£ï¼šå°† 56 ä½å¯†é’¥åˆ†æˆä¸¤åŠ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Step-3%EF%B8%8F%E2%83%A3%EF%BC%9A%E5%BE%AA%E7%8E%AF%E5%B7%A6%E7%A7%BB-PC-2-%E7%94%9F%E6%88%90-16-%E4%B8%AA%E5%AD%90%E5%AF%86%E9%92%A5"><span class="toc-number">2.2.3.</span> <span class="toc-text">Step 3ï¸âƒ£ï¼šå¾ªç¯å·¦ç§» + PC-2 ç”Ÿæˆ 16 ä¸ªå­å¯†é’¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%9C%8F%EF%B8%8F-%E5%B0%8F%E7%BB%93"><span class="toc-number">2.2.4.</span> <span class="toc-text">âœï¸ å°ç»“</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%9B%A0-%E5%AD%90%E5%AF%86%E9%92%A5%E5%9C%A8%E5%8A%A0%E5%AF%86%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">2.3.</span> <span class="toc-text">ğŸ›  å­å¯†é’¥åœ¨åŠ å¯†ä¸­çš„ä½¿ç”¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%9A%80-%E6%80%BB%E7%BB%93%E4%B8%80%E5%8F%A5%E8%AF%9D%EF%BC%9A"><span class="toc-number">2.4.</span> <span class="toc-text">ğŸš€ æ€»ç»“ä¸€å¥è¯ï¼š</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%90-%E4%B8%80%E3%80%81S%E7%9B%92%E6%98%AF%E5%B9%B2%E5%98%9B%E7%9A%84%EF%BC%9F"><span class="toc-number">2.5.</span> <span class="toc-text">ğŸ” ä¸€ã€Sç›’æ˜¯å¹²å˜›çš„ï¼Ÿ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%A6-%E4%BA%8C%E3%80%81S%E7%9B%92%E6%98%AF%E6%80%8E%E4%B9%88%E6%93%8D%E4%BD%9C%E7%9A%84%EF%BC%9F"><span class="toc-number">2.6.</span> <span class="toc-text">ğŸ“¦ äºŒã€Sç›’æ˜¯æ€ä¹ˆæ“ä½œçš„ï¼Ÿ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%EF%BC%9A6-%E4%BD%8D%E4%BA%8C%E8%BF%9B%E5%88%B6%EF%BC%88%E6%AF%94%E5%A6%82-011011%EF%BC%89"><span class="toc-number">2.6.1.</span> <span class="toc-text">è¾“å…¥ï¼š6 ä½äºŒè¿›åˆ¶ï¼ˆæ¯”å¦‚ 011011ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4%EF%BC%9A"><span class="toc-number">2.6.2.</span> <span class="toc-text">æ­¥éª¤ï¼š</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%AA-%E4%B8%BE%E4%B8%AA%E4%BE%8B%E5%AD%90%EF%BC%9A"><span class="toc-number">2.7.</span> <span class="toc-text">ğŸ§ª ä¸¾ä¸ªä¾‹å­ï¼š</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%81-%E4%B8%89%E3%80%81%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%80%E5%85%B1%E6%98%AF-8-%E4%B8%AA-S%E7%9B%92%EF%BC%9F"><span class="toc-number">2.8.</span> <span class="toc-text">ğŸ” ä¸‰ã€ä¸ºä»€ä¹ˆä¸€å…±æ˜¯ 8 ä¸ª Sç›’ï¼Ÿ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%92-%E5%9B%9B%E3%80%81S%E7%9B%92%E7%9A%84%E5%AE%89%E5%85%A8%E6%80%A7%E6%9D%A5%E6%BA%90"><span class="toc-number">2.9.</span> <span class="toc-text">ğŸ”’ å››ã€Sç›’çš„å®‰å…¨æ€§æ¥æº</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9C%85-%E6%80%BB%E7%BB%93%E4%B8%80%E5%8F%A5%E8%AF%9D%EF%BC%9A"><span class="toc-number">2.10.</span> <span class="toc-text">âœ… æ€»ç»“ä¸€å¥è¯ï¼š</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95RSA%E5%AE%9E%E7%8E%B0"><span class="toc-number">3.</span> <span class="toc-text">éå¯¹ç§°åŠ å¯†ç®—æ³•RSAå®ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81RSA%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86"><span class="toc-number">3.0.1.</span> <span class="toc-text">ä¸€ã€RSAç®—æ³•åŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E6%B5%81%E7%A8%8B"><span class="toc-number">3.0.1.1.</span> <span class="toc-text">1. å¯†é’¥ç”Ÿæˆæµç¨‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%8A%A0%E8%A7%A3%E5%AF%86%E8%BF%87%E7%A8%8B"><span class="toc-number">3.0.1.2.</span> <span class="toc-text">2. åŠ è§£å¯†è¿‡ç¨‹</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E4%BB%A3%E7%A0%81%E6%A8%A1%E5%9D%97%E8%A7%A3%E6%9E%90"><span class="toc-number">3.0.2.</span> <span class="toc-text">äºŒã€ä»£ç æ¨¡å—è§£æ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%B4%A0%E6%95%B0%E6%A3%80%E6%B5%8B%E5%87%BD%E6%95%B0"><span class="toc-number">3.0.2.1.</span> <span class="toc-text">1. ç´ æ•°æ£€æµ‹å‡½æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%85%AC%E9%92%A5%E6%8C%87%E6%95%B0%E9%80%89%E6%8B%A9"><span class="toc-number">3.0.2.2.</span> <span class="toc-text">2. å…¬é’¥æŒ‡æ•°é€‰æ‹©</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E6%A0%B8%E5%BF%83"><span class="toc-number">3.0.2.3.</span> <span class="toc-text">3. å¯†é’¥ç”Ÿæˆæ ¸å¿ƒ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%87%BD%E6%95%B0"><span class="toc-number">3.0.2.4.</span> <span class="toc-text">4. åŠ è§£å¯†å‡½æ•°</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E7%A4%BA%E4%BE%8B%E6%B5%8B%E8%AF%95%E5%88%86%E6%9E%90"><span class="toc-number">3.0.3.</span> <span class="toc-text">ä¸‰ã€ç¤ºä¾‹æµ‹è¯•åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E8%BE%93%E5%85%A5%E5%8F%82%E6%95%B0"><span class="toc-number">3.0.3.1.</span> <span class="toc-text">1. è¾“å…¥å‚æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E7%BB%93%E6%9E%9C"><span class="toc-number">3.0.3.2.</span> <span class="toc-text">2. å¯†é’¥ç”Ÿæˆç»“æœ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%8A%A0%E8%A7%A3%E5%AF%86%E8%BF%87%E7%A8%8B"><span class="toc-number">3.0.3.3.</span> <span class="toc-text">3. åŠ è§£å¯†è¿‡ç¨‹</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E7%AE%97%E6%B3%95%E5%AE%89%E5%85%A8%E6%80%A7%E5%88%86%E6%9E%90"><span class="toc-number">3.0.4.</span> <span class="toc-text">å››ã€ç®—æ³•å®‰å…¨æ€§åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E4%BB%A3%E7%A0%81%E4%BC%98%E5%8C%96%E6%96%B9%E5%90%91"><span class="toc-number">3.0.5.</span> <span class="toc-text">äº”ã€ä»£ç ä¼˜åŒ–æ–¹å‘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E5%AE%9E%E9%AA%8C%E7%8E%B0%E8%B1%A1%E8%A7%A3%E9%87%8A"><span class="toc-number">3.0.6.</span> <span class="toc-text">å…­ã€å®éªŒç°è±¡è§£é‡Š</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AD%BE%E5%90%8D"><span class="toc-number">4.</span> <span class="toc-text">ç­¾å</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%95%B4%E4%BD%93%E5%8A%A0%E5%AF%86%EF%BC%8B%E7%AD%BE%E5%90%8D%E6%B5%81%E7%A8%8B%E6%A6%82%E8%BF%B0"><span class="toc-number">4.1.</span> <span class="toc-text">ä¸€ã€æ•´ä½“åŠ å¯†ï¼‹ç­¾åæµç¨‹æ¦‚è¿°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E4%BB%A3%E7%A0%81%E6%B5%81%E7%A8%8B%E8%AF%A6%E8%A7%A3"><span class="toc-number">4.2.</span> <span class="toc-text">äºŒã€ä»£ç æµç¨‹è¯¦è§£</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%93%88%E5%B8%8C%E5%87%BD%E6%95%B0"><span class="toc-number">4.2.1.</span> <span class="toc-text">1. å“ˆå¸Œå‡½æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-RSA-%E7%AD%BE%E5%90%8D%EF%BC%8F%E9%AA%8C%E7%AD%BE"><span class="toc-number">4.2.2.</span> <span class="toc-text">2. RSA ç­¾åï¼éªŒç­¾</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-AES-CBC-%E5%8A%A0%E8%A7%A3%E5%AF%86"><span class="toc-number">4.2.3.</span> <span class="toc-text">3. AES-CBC åŠ è§£å¯†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E4%B8%BB%E6%B5%81%E7%A8%8B"><span class="toc-number">4.2.4.</span> <span class="toc-text">4. ä¸»æµç¨‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%AE%8C%E6%95%B4%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%8A%A0%E4%B8%8A%E2%80%9C%E5%AF%86%E9%92%A5%E5%B0%81%E8%A3%85%E2%80%9D%E7%9A%84%E6%94%B9%E8%BF%9B"><span class="toc-number">4.3.</span> <span class="toc-text">ä¸‰ã€å®Œæ•´ç¤ºä¾‹ï¼šåŠ ä¸Šâ€œå¯†é’¥å°è£…â€çš„æ”¹è¿›</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93"><span class="toc-number">4.3.1.</span> <span class="toc-text">å°ç»“</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/05/29/snakeyaml%E4%B8%8D%E5%87%BA%E7%BD%91%E5%88%A9%E7%94%A8/" title="fastjson&amp;&amp;snakeyamlä¸å‡ºç½‘åˆ©ç”¨"><img src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover21.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="fastjson&amp;&amp;snakeyamlä¸å‡ºç½‘åˆ©ç”¨"/></a><div class="content"><a class="title" href="/2025/05/29/snakeyaml%E4%B8%8D%E5%87%BA%E7%BD%91%E5%88%A9%E7%94%A8/" title="fastjson&amp;&amp;snakeyamlä¸å‡ºç½‘åˆ©ç”¨">fastjson&amp;&amp;snakeyamlä¸å‡ºç½‘åˆ©ç”¨</a><time datetime="2025-05-29T02:06:01.000Z" title="å‘è¡¨äº 2025-05-29 10:06:01">2025-05-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/25/%E6%98%A5%E7%A7%8BThermalPower/" title="æ˜¥ç§‹ThermalPower"><img src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover0.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="æ˜¥ç§‹ThermalPower"/></a><div class="content"><a class="title" href="/2025/05/25/%E6%98%A5%E7%A7%8BThermalPower/" title="æ˜¥ç§‹ThermalPower">æ˜¥ç§‹ThermalPower</a><time datetime="2025-05-25T14:01:09.000Z" title="å‘è¡¨äº 2025-05-25 22:01:09">2025-05-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/20/palu/" title="palu"><img src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover83.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="palu"/></a><div class="content"><a class="title" href="/2025/05/20/palu/" title="palu">palu</a><time datetime="2025-05-20T13:31:12.000Z" title="å‘è¡¨äº 2025-05-20 21:31:12">2025-05-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/13/%E5%B7%A5%E5%85%B7%E5%88%86%E6%9E%90ysoSerial/" title="å·¥å…·åˆ†æysoSerial"><img src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover14.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="å·¥å…·åˆ†æysoSerial"/></a><div class="content"><a class="title" href="/2025/05/13/%E5%B7%A5%E5%85%B7%E5%88%86%E6%9E%90ysoSerial/" title="å·¥å…·åˆ†æysoSerial">å·¥å…·åˆ†æysoSerial</a><time datetime="2025-05-13T07:21:00.000Z" title="å‘è¡¨äº 2025-05-13 15:21:00">2025-05-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/10/java%E5%BC%80%E5%8F%91/" title="javaå¼€å‘"><img src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover16.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="javaå¼€å‘"/></a><div class="content"><a class="title" href="/2025/05/10/java%E5%BC%80%E5%8F%91/" title="javaå¼€å‘">javaå¼€å‘</a><time datetime="2025-05-10T07:13:47.000Z" title="å‘è¡¨äº 2025-05-10 15:13:47">2025-05-10</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By L</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="chat-btn" type="button" title="èŠå¤©"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(() => {
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://tw-sigma.vercel.app/',
      region: 'ap-guangzhou',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(init,0)
    else getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(init)
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://tw-sigma.vercel.app/',
      region: 'ap-guangzhou',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else {
      loadTwikoo()
      
    }
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><script async data-pjax src="/js/LSE.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>