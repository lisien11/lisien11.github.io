<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>密码实验 | L的博客</title><meta name="author" content="L"><meta name="copyright" content="L"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="仿射密码12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152from math import gcddef text_to_numbers(text):    return [ord(char) - ord(&#x27;a&#x27;) for char in">
<meta property="og:type" content="article">
<meta property="og:title" content="密码实验">
<meta property="og:url" content="https://lisien11.xyz/2025/04/21/%E5%AF%86%E7%A0%81%E5%AE%9E%E9%AA%8C/index.html">
<meta property="og:site_name" content="L的博客">
<meta property="og:description" content="仿射密码12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152from math import gcddef text_to_numbers(text):    return [ord(char) - ord(&#x27;a&#x27;) for char in">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover94.jpg">
<meta property="article:published_time" content="2025-04-21T11:25:07.000Z">
<meta property="article:modified_time" content="2025-04-21T13:50:39.557Z">
<meta property="article:author" content="L">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover94.jpg"><link rel="shortcut icon" href="/img/1.jpg"><link rel="canonical" href="https://lisien11.xyz/2025/04/21/%E5%AF%86%E7%A0%81%E5%AE%9E%E9%AA%8C/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":true,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '密码实验',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-04-21 21:50:39'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/LSE.css"><meta name="generator" content="Hexo 7.0.0"><link rel="alternate" href="/atom.xml" title="L的博客" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/%E5%9B%BE%E7%89%87/1231.jpg" onerror="onerror=null;src='/img/lll.png'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">148</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">46</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">43</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 个人写的小Demo</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 信息收集</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover94.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="L的博客"><span class="site-name">L的博客</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 个人写的小Demo</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 信息收集</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">密码实验</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-04-21T11:25:07.000Z" title="发表于 2025-04-21 19:25:07">2025-04-21</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-04-21T13:50:39.557Z" title="更新于 2025-04-21 21:50:39">2025-04-21</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">8.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>36分钟</span></span><span class="post-meta-separator">|</span><span id="" data-flag-title="密码实验"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="twikoo_visitors"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="仿射密码"><a href="#仿射密码" class="headerlink" title="仿射密码"></a>仿射密码</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">text_to_numbers</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">ord</span>(char) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) <span class="keyword">for</span> char <span class="keyword">in</span> text.lower() <span class="keyword">if</span> char.isalpha()]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encryption</span>(<span class="params">m, a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> gcd(a, <span class="number">26</span>) != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;密钥a必须与26互质！&quot;</span></span><br><span class="line">    numbers = text_to_numbers(m)</span><br><span class="line">    encrypted_number = [(a * num + b) % <span class="number">26</span> <span class="keyword">for</span> num <span class="keyword">in</span> numbers]</span><br><span class="line">    encrypted_text = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(num + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)) <span class="keyword">for</span> num <span class="keyword">in</span> encrypted_number)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;加密后的密文是：&#123;&#125;&quot;</span>.<span class="built_in">format</span>(encrypted_text))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decryption</span>(<span class="params">c, a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> gcd(a, <span class="number">26</span>) != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;密钥a必须与26互质！&quot;</span></span><br><span class="line">    encode_c = text_to_numbers(c)</span><br><span class="line">    a_1 = <span class="built_in">pow</span>(a, -<span class="number">1</span>, <span class="number">26</span>)</span><br><span class="line">    decryption_number = [(a_1 * (num - b)) % <span class="number">26</span> <span class="keyword">for</span> num <span class="keyword">in</span> encode_c]</span><br><span class="line">    decryption_text = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(num + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)) <span class="keyword">for</span> num <span class="keyword">in</span> decryption_number)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;解密后的明文是：&#123;&#125;&quot;</span>.<span class="built_in">format</span>(decryption_text))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_valid_key_a</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;请输入密钥a（必须与26互质）：&quot;</span>))</span><br><span class="line">        <span class="keyword">if</span> gcd(a, <span class="number">26</span>) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> a</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;密钥a必须与26互质，请重新输入！&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;******仿射密码******&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;请选择操作：&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;1：加密&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;2：解密&quot;</span>)</span><br><span class="line"></span><br><span class="line">    choose = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;请输入选项（1或2）：&quot;</span>))</span><br><span class="line">    <span class="keyword">if</span> choose == <span class="number">1</span>:</span><br><span class="line">        m = <span class="built_in">input</span>(<span class="string">&quot;请输入明文：&quot;</span>)</span><br><span class="line">        a = get_valid_key_a()</span><br><span class="line">        b = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;请输入密钥b：&quot;</span>))</span><br><span class="line">        encryption(m, a, b)</span><br><span class="line">    <span class="keyword">elif</span> choose == <span class="number">2</span>:</span><br><span class="line">        c = <span class="built_in">input</span>(<span class="string">&quot;请输入密文：&quot;</span>)</span><br><span class="line">        a = get_valid_key_a()</span><br><span class="line">        b = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;请输入密钥b：&quot;</span>))</span><br><span class="line">        decryption(c, a, b)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;无效选项，请重新运行程序并输入1或2。&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<h2 id="解释"><a href="#解释" class="headerlink" title="解释"></a>解释</h2><p>好的，我们来详细讲解一下 <strong>仿射密码</strong> 及你贴出来的这段 Python 代码，帮你理解它的原理和实现。</p>
<hr>
<h2 id="🔐-一、什么是仿射密码（Affine-Cipher）？"><a href="#🔐-一、什么是仿射密码（Affine-Cipher）？" class="headerlink" title="🔐 一、什么是仿射密码（Affine Cipher）？"></a>🔐 一、什么是仿射密码（Affine Cipher）？</h2><p>仿射密码是一种<strong>古典加密算法</strong>，属于单字母替换密码的范畴。它结合了两个数学变换：</p>
<ul>
<li>线性变换（乘法+加法）</li>
<li>模运算（取余）</li>
</ul>
<h3 id="加密公式："><a href="#加密公式：" class="headerlink" title="加密公式："></a>加密公式：</h3><p>对每个明文字母用以下公式变换：</p>
<p>[<br>E(x) = (a \cdot x + b) \mod 26<br>]</p>
<ul>
<li>( x )：明文字母在字母表中的位置（0~25）</li>
<li>( a, b )：密钥参数</li>
<li>( \mod 26 )：因为英文字母有26个，所以对26取余</li>
</ul>
<h3 id="解密公式："><a href="#解密公式：" class="headerlink" title="解密公式："></a>解密公式：</h3><p>[<br>D(y) = a^{-1} \cdot (y - b) \mod 26<br>]</p>
<ul>
<li>( y )：密文字母在字母表中的位置</li>
<li>( a^{-1} )：模 26 下的 ( a ) 的乘法逆元（即满足 ( a \cdot a^{-1} \equiv 1 \mod 26 ) 的整数）</li>
</ul>
<blockquote>
<p><strong>注意：</strong>只有当 ( \gcd(a, 26) = 1 ) 时，乘法逆元 ( a^{-1} ) 才存在，所以 <strong>a 必须与 26 互质</strong>。</p>
</blockquote>
<hr>
<h2 id="🧠-二、代码逐步解释"><a href="#🧠-二、代码逐步解释" class="headerlink" title="🧠 二、代码逐步解释"></a>🧠 二、代码逐步解释</h2><h3 id="1-text-to-numbers-text"><a href="#1-text-to-numbers-text" class="headerlink" title="1. text_to_numbers(text)"></a>1. <code>text_to_numbers(text)</code></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">text_to_numbers</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">ord</span>(char) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) <span class="keyword">for</span> char <span class="keyword">in</span> text.lower() <span class="keyword">if</span> char.isalpha()]</span><br></pre></td></tr></table></figure>
<p><strong>功能：</strong> 把文本转换为字母在字母表中的数字（a=0, b=1, …, z=25）</p>
<p>例子：<code>text_to_numbers(&quot;abc&quot;)</code> 输出 <code>[0, 1, 2]</code></p>
<hr>
<h3 id="2-encryption-m-a-b"><a href="#2-encryption-m-a-b" class="headerlink" title="2. encryption(m, a, b)"></a>2. <code>encryption(m, a, b)</code></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">encryption</span>(<span class="params">m, a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> gcd(a, <span class="number">26</span>) != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;密钥a必须与26互质！&quot;</span></span><br><span class="line">    numbers = text_to_numbers(m)</span><br><span class="line">    encrypted_number = [(a * num + b) % <span class="number">26</span> <span class="keyword">for</span> num <span class="keyword">in</span> numbers]</span><br><span class="line">    encrypted_text = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(num + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)) <span class="keyword">for</span> num <span class="keyword">in</span> encrypted_number)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;加密后的密文是：&#123;&#125;&quot;</span>.<span class="built_in">format</span>(encrypted_text))</span><br></pre></td></tr></table></figure>
<p><strong>功能：</strong>使用仿射加密公式加密明文</p>
<ul>
<li>先把明文变成数字列表</li>
<li>然后用 <code>(a*x + b) % 26</code> 加密</li>
<li>最后把加密后的数字变回字母，拼接输出</li>
</ul>
<hr>
<h3 id="3-decryption-c-a-b"><a href="#3-decryption-c-a-b" class="headerlink" title="3. decryption(c, a, b)"></a>3. <code>decryption(c, a, b)</code></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decryption</span>(<span class="params">c, a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> gcd(a, <span class="number">26</span>) != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;密钥a必须与26互质！&quot;</span></span><br><span class="line">    encode_c = text_to_numbers(c)</span><br><span class="line">    a_1 = <span class="built_in">pow</span>(a, -<span class="number">1</span>, <span class="number">26</span>)  <span class="comment"># 求 a 的模逆</span></span><br><span class="line">    decryption_number = [(a_1 * (num - b)) % <span class="number">26</span> <span class="keyword">for</span> num <span class="keyword">in</span> encode_c]</span><br><span class="line">    decryption_text = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(num + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)) <span class="keyword">for</span> num <span class="keyword">in</span> decryption_number)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;解密后的明文是：&#123;&#125;&quot;</span>.<span class="built_in">format</span>(decryption_text))</span><br></pre></td></tr></table></figure>
<p><strong>功能：</strong>仿射解密</p>
<ul>
<li>先求出 ( a^{-1} )</li>
<li>然后用解密公式解密 <code>(a_inv * (y - b)) % 26</code></li>
<li>最后还原成明文输出</li>
</ul>
<hr>
<h3 id="4-get-valid-key-a"><a href="#4-get-valid-key-a" class="headerlink" title="4. get_valid_key_a()"></a>4. <code>get_valid_key_a()</code></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_valid_key_a</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;请输入密钥a（必须与26互质）：&quot;</span>))</span><br><span class="line">        <span class="keyword">if</span> gcd(a, <span class="number">26</span>) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> a</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;密钥a必须与26互质，请重新输入！&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><strong>功能：</strong>确保用户输入的 <code>a</code> 合法，即与 26 互质。</p>
<hr>
<h3 id="5-main"><a href="#5-main" class="headerlink" title="5. main()"></a>5. <code>main()</code></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;******仿射密码******&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;请选择操作：&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;1：加密&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;2：解密&quot;</span>)</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>
<p><strong>功能：</strong>主程序入口</p>
<ul>
<li>用户选择加密或解密</li>
<li>然后输入明文或密文及密钥</li>
<li>调用加密或解密函数</li>
</ul>
<hr>
<h2 id="🧪-三、实验操作步骤总结"><a href="#🧪-三、实验操作步骤总结" class="headerlink" title="🧪 三、实验操作步骤总结"></a>🧪 三、实验操作步骤总结</h2><ol>
<li>打开 Python 开发环境（如 IDLE、PyCharm 或终端）</li>
<li>粘贴并运行上述代码</li>
<li>根据提示输入：<ul>
<li>明文或密文</li>
<li>合法的 <code>a</code>（与26互质，比如 1, 3, 5, 7, 11…）</li>
<li>任意整数 <code>b</code></li>
</ul>
</li>
<li>查看输出的加密或解密结果</li>
</ol>
<hr>
<h2 id="✅-四、实验结果示例"><a href="#✅-四、实验结果示例" class="headerlink" title="✅ 四、实验结果示例"></a>✅ 四、实验结果示例</h2><h3 id="输入："><a href="#输入：" class="headerlink" title="输入："></a>输入：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">请选择操作：1</span><br><span class="line">请输入明文：hello</span><br><span class="line">请输入密钥a：5</span><br><span class="line">请输入密钥b：8</span><br></pre></td></tr></table></figure>
<h3 id="输出："><a href="#输出：" class="headerlink" title="输出："></a>输出：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">加密后的密文是：rclla</span><br></pre></td></tr></table></figure>
<p>然后用相同的 a 和 b 解密：<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">请选择操作：2</span><br><span class="line">请输入密文：rclla</span><br><span class="line">请输入密钥a：5</span><br><span class="line">请输入密钥b：8</span><br></pre></td></tr></table></figure></p>
<p>输出：<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">解密后的明文是：hello</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="💡-五、实验心得"><a href="#💡-五、实验心得" class="headerlink" title="💡 五、实验心得"></a>💡 五、实验心得</h2><ul>
<li>仿射密码是理解更复杂密码算法的基础。</li>
<li>通过手动编码加密/解密过程，可以加深对模运算和逆元的理解。</li>
<li>加密算法不仅要保证加密效果，还必须保证可以还原，即“可逆性”。</li>
<li>Python 的 <code>pow(a, -1, m)</code> 很方便地找到了乘法逆元，不需要手写扩展欧几里得算法。</li>
</ul>
<hr>
<p>如果你还想要：</p>
<ul>
<li>图解加密过程</li>
<li>可视化步骤</li>
<li>支持大写字母或空格</li>
</ul>
<p>我也可以帮你扩展这个程序！要不要来个 GUI 版本的？😄</p>
<h1 id="DES"><a href="#DES" class="headerlink" title="DES"></a>DES</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># 初始置换 IP 表（64位 -&gt; 64位）</span><br><span class="line">IP = [</span><br><span class="line">    58, 50, 42, 34, 26, 18, 10, 2,</span><br><span class="line">    60, 52, 44, 36, 28, 20, 12, 4,</span><br><span class="line">    62, 54, 46, 38, 30, 22, 14, 6,</span><br><span class="line">    64, 56, 48, 40, 32, 24, 16, 8,</span><br><span class="line">    57, 49, 41, 33, 25, 17, 9, 1,</span><br><span class="line">    59, 51, 43, 35, 27, 19, 11, 3,</span><br><span class="line">    61, 53, 45, 37, 29, 21, 13, 5,</span><br><span class="line">    63, 55, 47, 39, 31, 23, 15, 7</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># 逆初始置换 IP^-1 表（64位 -&gt; 64位）</span><br><span class="line">IP_INV = [</span><br><span class="line">    40, 8, 48, 16, 56, 24, 64, 32,</span><br><span class="line">    39, 7, 47, 15, 55, 23, 63, 31,</span><br><span class="line">    38, 6, 46, 14, 54, 22, 62, 30,</span><br><span class="line">    37, 5, 45, 13, 53, 21, 61, 29,</span><br><span class="line">    36, 4, 44, 12, 52, 20, 60, 28,</span><br><span class="line">    35, 3, 43, 11, 51, 19, 59, 27,</span><br><span class="line">    34, 2, 42, 10, 50, 18, 58, 26,</span><br><span class="line">    33, 1, 41, 9, 49, 17, 57, 25</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># 密钥置换 PC-1 表（64位 -&gt; 56位）</span><br><span class="line">PC1 = [</span><br><span class="line">    57, 49, 41, 33, 25, 17, 9,</span><br><span class="line">    1, 58, 50, 42, 34, 26, 18,</span><br><span class="line">    10, 2, 59, 51, 43, 35, 27,</span><br><span class="line">    19, 11, 3, 60, 52, 44, 36,</span><br><span class="line">    63, 55, 47, 39, 31, 23, 15,</span><br><span class="line">    7, 62, 54, 46, 38, 30, 22,</span><br><span class="line">    14, 6, 61, 53, 45, 37, 29,</span><br><span class="line">    21, 13, 5, 28, 20, 12, 4</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># 密钥置换 PC-2 表（56位 -&gt; 48位）</span><br><span class="line">PC2 = [</span><br><span class="line">    14, 17, 11, 24, 1, 5,</span><br><span class="line">    3, 28, 15, 6, 21, 10,</span><br><span class="line">    23, 19, 12, 4, 26, 8,</span><br><span class="line">    16, 7, 27, 20, 13, 2,</span><br><span class="line">    41, 52, 31, 37, 47, 55,</span><br><span class="line">    30, 40, 51, 45, 33, 48,</span><br><span class="line">    44, 49, 39, 56, 34, 53,</span><br><span class="line">    46, 42, 50, 36, 29, 32</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># 每轮循环左移位数表（16轮）</span><br><span class="line">SHIFT = [1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1]</span><br><span class="line"></span><br><span class="line"># 扩展置换 E 表（32位 -&gt; 48位）</span><br><span class="line">E = [</span><br><span class="line">    32, 1, 2, 3, 4, 5,</span><br><span class="line">    4, 5, 6, 7, 8, 9,</span><br><span class="line">    8, 9, 10, 11, 12, 13,</span><br><span class="line">    12, 13, 14, 15, 16, 17,</span><br><span class="line">    16, 17, 18, 19, 20, 21,</span><br><span class="line">    20, 21, 22, 23, 24, 25,</span><br><span class="line">    24, 25, 26, 27, 28, 29,</span><br><span class="line">    28, 29, 30, 31, 32, 1</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># S 盒定义（8个4x16的盒）</span><br><span class="line">S_BOX = [</span><br><span class="line">    # S1</span><br><span class="line">    [</span><br><span class="line">        [14, 4, 13, 1, 2, 15, 11, 8, 3, 10, 6, 12, 5, 9, 0, 7],</span><br><span class="line">        [0, 15, 7, 4, 14, 2, 13, 1, 10, 6, 12, 11, 9, 5, 3, 8],</span><br><span class="line">        [4, 1, 14, 8, 13, 6, 2, 11, 15, 12, 9, 7, 3, 10, 5, 0],</span><br><span class="line">        [15, 12, 8, 2, 4, 9, 1, 7, 5, 11, 3, 14, 10, 0, 6, 13]</span><br><span class="line">    ],</span><br><span class="line">    # S2</span><br><span class="line">    [</span><br><span class="line">        [15, 1, 8, 14, 6, 11, 3, 4, 9, 7, 2, 13, 12, 0, 5, 10],</span><br><span class="line">        [3, 13, 4, 7, 15, 2, 8, 14, 12, 0, 1, 10, 6, 9, 11, 5],</span><br><span class="line">        [0, 14, 7, 11, 10, 4, 13, 1, 5, 8, 12, 6, 9, 3, 2, 15],</span><br><span class="line">        [13, 8, 10, 1, 3, 15, 4, 2, 11, 6, 7, 12, 0, 5, 14, 9]</span><br><span class="line">    ],</span><br><span class="line">    # S3</span><br><span class="line">    [</span><br><span class="line">        [10, 0, 9, 14, 6, 3, 15, 5, 1, 13, 12, 7, 11, 4, 2, 8],</span><br><span class="line">        [13, 7, 0, 9, 3, 4, 6, 10, 2, 8, 5, 14, 12, 11, 15, 1],</span><br><span class="line">        [13, 6, 4, 9, 8, 15, 3, 0, 11, 1, 2, 12, 5, 10, 14, 7],</span><br><span class="line">        [1, 10, 13, 0, 6, 9, 8, 7, 4, 15, 14, 3, 11, 5, 2, 12]</span><br><span class="line">    ],</span><br><span class="line">    # S4</span><br><span class="line">    [</span><br><span class="line">        [7, 13, 14, 3, 0, 6, 9, 10, 1, 2, 8, 5, 11, 12, 4, 15],</span><br><span class="line">        [13, 8, 11, 5, 6, 15, 0, 3, 4, 7, 2, 12, 1, 10, 14, 9],</span><br><span class="line">        [10, 6, 9, 0, 12, 11, 7, 13, 15, 1, 3, 14, 5, 2, 8, 4],</span><br><span class="line">        [3, 15, 0, 6, 10, 1, 13, 8, 9, 4, 5, 11, 12, 7, 2, 14]</span><br><span class="line">    ],</span><br><span class="line">    # S5</span><br><span class="line">    [</span><br><span class="line">        [2, 12, 4, 1, 7, 10, 11, 6, 8, 5, 3, 15, 13, 0, 14, 9],</span><br><span class="line">        [14, 11, 2, 12, 4, 7, 13, 1, 5, 0, 15, 10, 3, 9, 8, 6],</span><br><span class="line">        [4, 2, 1, 11, 10, 13, 7, 8, 15, 9, 12, 5, 6, 3, 0, 14],</span><br><span class="line">        [11, 8, 12, 7, 1, 14, 2, 13, 6, 15, 0, 9, 10, 4, 5, 3]</span><br><span class="line">    ],</span><br><span class="line">    # S6</span><br><span class="line">    [</span><br><span class="line">        [12, 1, 10, 15, 9, 2, 6, 8, 0, 13, 3, 4, 14, 7, 5, 11],</span><br><span class="line">        [10, 15, 4, 2, 7, 12, 9, 5, 6, 1, 13, 14, 0, 11, 3, 8],</span><br><span class="line">        [9, 14, 15, 5, 2, 8, 12, 3, 7, 0, 4, 10, 1, 13, 11, 6],</span><br><span class="line">        [4, 3, 2, 12, 9, 5, 15, 10, 11, 14, 1, 7, 6, 0, 8, 13]</span><br><span class="line">    ],</span><br><span class="line">    # S7</span><br><span class="line">    [</span><br><span class="line">        [4, 11, 2, 14, 15, 0, 8, 13, 3, 12, 9, 7, 5, 10, 6, 1],</span><br><span class="line">        [13, 0, 11, 7, 4, 9, 1, 10, 14, 3, 5, 12, 2, 15, 8, 6],</span><br><span class="line">        [1, 4, 11, 13, 12, 3, 7, 14, 10, 15, 6, 8, 0, 5, 9, 2],</span><br><span class="line">        [6, 11, 13, 8, 1, 4, 10, 7, 9, 5, 0, 15, 14, 2, 3, 12]</span><br><span class="line">    ],</span><br><span class="line">    # S8</span><br><span class="line">    [</span><br><span class="line">        [13, 2, 8, 4, 6, 15, 11, 1, 10, 9, 3, 14, 5, 0, 12, 7],</span><br><span class="line">        [1, 15, 13, 8, 10, 3, 7, 4, 12, 5, 6, 11, 0, 14, 9, 2],</span><br><span class="line">        [7, 11, 4, 1, 9, 12, 14, 2, 0, 6, 10, 13, 15, 3, 5, 8],</span><br><span class="line">        [2, 1, 14, 7, 4, 10, 8, 13, 15, 12, 9, 0, 3, 5, 6, 11]</span><br><span class="line">    ]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># P 盒置换表（32位 -&gt; 32位）</span><br><span class="line">P = [</span><br><span class="line">    16, 7, 20, 21, 29, 12, 28, 17,</span><br><span class="line">    1, 15, 23, 26, 5, 18, 31, 10,</span><br><span class="line">    2, 8, 24, 14, 32, 27, 3, 9,</span><br><span class="line">    19, 13, 30, 6, 22, 11, 4, 25</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ---------------------- 工具函数 ----------------------</span><br><span class="line"></span><br><span class="line">def text_to_bin(text, length=64):</span><br><span class="line">    &quot;&quot;&quot;将文本或十六进制字符串转换为二进制字符串&quot;&quot;&quot;</span><br><span class="line">    if all(c in &#x27;0123456789ABCDEFabcdef&#x27; for c in text):</span><br><span class="line">        # 处理十六进制输入</span><br><span class="line">        binary = bin(int(text, 16))[2:].zfill(length)</span><br><span class="line">    else:</span><br><span class="line">        # 处理ASCII输入（实验测试中暂未使用）</span><br><span class="line">        binary = &#x27;&#x27;.join([bin(ord(c))[2:].zfill(8) for c in text])</span><br><span class="line">    return binary.zfill(length)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def bin_to_hex(binary):</span><br><span class="line">    &quot;&quot;&quot;二进制字符串转十六进制&quot;&quot;&quot;</span><br><span class="line">    return hex(int(binary, 2))[2:].upper().zfill(16)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def permute(bits, table):</span><br><span class="line">    &quot;&quot;&quot;根据置换表进行位置换&quot;&quot;&quot;</span><br><span class="line">    # 注意：DES置换表索引从1开始，Python列表从0开始，故需减1</span><br><span class="line">    return &#x27;&#x27;.join([bits[i - 1] for i in table])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def left_shift(bits, n):</span><br><span class="line">    &quot;&quot;&quot;循环左移n位&quot;&quot;&quot;</span><br><span class="line">    return bits[n:] + bits[:n]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def xor(a, b):</span><br><span class="line">    &quot;&quot;&quot;异或操作&quot;&quot;&quot;</span><br><span class="line">    return &#x27;&#x27;.join(str(int(x) ^ int(y)) for x, y in zip(a, b))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ---------------------- 子密钥生成 ----------------------</span><br><span class="line"></span><br><span class="line">def generate_subkeys(key):</span><br><span class="line">    &quot;&quot;&quot;生成16轮子密钥（48位）&quot;&quot;&quot;</span><br><span class="line">    # 初始置换 PC-1（64位 -&gt; 56位）</span><br><span class="line">    key = permute(key, PC1)</span><br><span class="line">    # 分割左右28位</span><br><span class="line">    left, right = key[:28], key[28:]</span><br><span class="line">    subkeys = []</span><br><span class="line">    for i in range(16):</span><br><span class="line">        # 根据SHIFT表循环左移</span><br><span class="line">        left = left_shift(left, SHIFT[i])</span><br><span class="line">        right = left_shift(right, SHIFT[i])</span><br><span class="line">        # 合并后置换 PC-2（56位 -&gt; 48位）</span><br><span class="line">        combined = left + right</span><br><span class="line">        subkey = permute(combined, PC2)</span><br><span class="line">        subkeys.append(subkey)</span><br><span class="line">    return subkeys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def feistel(right, subkey):</span><br><span class="line">    &quot;&quot;&quot;Feistel 函数（处理右半部分）&quot;&quot;&quot;</span><br><span class="line">    # 扩展置换 E（32位 -&gt; 48位）</span><br><span class="line">    expanded = permute(right, E)</span><br><span class="line">    # 与子密钥异或</span><br><span class="line">    xored = xor(expanded, subkey)</span><br><span class="line">    # S 盒替换（48位 -&gt; 32位）</span><br><span class="line">    s_output = &#x27;&#x27;</span><br><span class="line">    for i in range(8):</span><br><span class="line">        # 提取6位输入</span><br><span class="line">        chunk = xored[i * 6:(i + 1) * 6]</span><br><span class="line">        # 计算行和列（行由首尾两位决定，列由中间4位决定）</span><br><span class="line">        row = int(chunk[0] + chunk[5], 2)</span><br><span class="line">        col = int(chunk[1:5], 2)</span><br><span class="line">        # 查S盒并转换为4位二进制</span><br><span class="line">        val = S_BOX[i][row][col]</span><br><span class="line">        s_output += bin(val)[2:].zfill(4)</span><br><span class="line">    # P 盒置换</span><br><span class="line">    p_output = permute(s_output, P)</span><br><span class="line">    return p_output</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ---------------------- DES 主函数 ----------------------</span><br><span class="line"></span><br><span class="line">def des(block, key, encrypt=True):</span><br><span class="line">    &quot;&quot;&quot;DES 加密/解密单块（64位）&quot;&quot;&quot;</span><br><span class="line">    # 生成子密钥</span><br><span class="line">    subkeys = generate_subkeys(key)</span><br><span class="line">    if not encrypt:</span><br><span class="line">        subkeys = subkeys[::-1]  # 解密时逆序使用子密钥</span><br><span class="line"></span><br><span class="line">    # 初始置换 IP</span><br><span class="line">    block = permute(block, IP)</span><br><span class="line">    # 分割左右32位</span><br><span class="line">    left, right = block[:32], block[32:]</span><br><span class="line"></span><br><span class="line">    # 16轮 Feistel 网络</span><br><span class="line">    for i in range(16):</span><br><span class="line">        new_left = right</span><br><span class="line">        # Feistel 函数处理右半部分</span><br><span class="line">        f_result = feistel(right, subkeys[i])</span><br><span class="line">        # 新右半部分 = 左半部分 XOR Feistel结果</span><br><span class="line">        new_right = xor(left, f_result)</span><br><span class="line">        left, right = new_left, new_right</span><br><span class="line"></span><br><span class="line">    # 最终合并并逆置换 IP^-1</span><br><span class="line">    combined = right + left  # 注意最后不交换</span><br><span class="line">    ciphertext = permute(combined, IP_INV)</span><br><span class="line">    return ciphertext</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ---------------------- 测试代码 ----------------------</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    # 测试用例1：弱密钥</span><br><span class="line">    plaintext = &#x27;aaabbaba&#x27;</span><br><span class="line">    key = &#x27;0101010101010101&#x27;</span><br><span class="line">    # 转换为二进制</span><br><span class="line">    bin_plain = text_to_bin(plaintext)</span><br><span class="line">    bin_key = text_to_bin(key)</span><br><span class="line">    # 加密</span><br><span class="line">    cipher_bin = des(bin_plain, bin_key, encrypt=True)</span><br><span class="line">    cipher_hex = bin_to_hex(cipher_bin)</span><br><span class="line"></span><br><span class="line">    print(f&#x27;加密结果: &#123;cipher_hex&#125;&#x27;)</span><br><span class="line">    # 解密</span><br><span class="line">    decrypted_bin = des(cipher_bin, bin_key, encrypt=False)</span><br><span class="line">    decrypted_hex = bin_to_hex(decrypted_bin)</span><br><span class="line">    print(f&#x27;解密结果: &#123;decrypted_hex&#125;&#x27;)</span><br><span class="line"></span><br><span class="line">    #二次加密</span><br><span class="line">    cipher_bin2 = des(cipher_bin, bin_key, encrypt=True)</span><br><span class="line">    bin_to_hex2 = bin_to_hex(cipher_bin2)</span><br><span class="line">    print(f&quot;二次加密: &#123;bin_to_hex2&#125;&quot;)</span><br><span class="line"></span><br><span class="line">    # 半弱密钥</span><br><span class="line">    print()</span><br><span class="line">    print(&quot;半弱密钥&quot;)</span><br><span class="line">    plaintext = &#x27;aaabbaba&#x27;</span><br><span class="line">    key1 = &#x27;011f011f010e010e&#x27;</span><br><span class="line">    key2 = &#x27;1f011f010e010e01&#x27;</span><br><span class="line">    # 转换为二进制</span><br><span class="line">    bin_plain = text_to_bin(plaintext)</span><br><span class="line">    bin_key1 = text_to_bin(key1)</span><br><span class="line">    bin_key2 = text_to_bin(key2)</span><br><span class="line">    # 加密</span><br><span class="line">    cipher_bin = des(bin_plain, bin_key1, encrypt=True)</span><br><span class="line">    cipher_hex = bin_to_hex(cipher_bin)</span><br><span class="line"></span><br><span class="line">    print(f&#x27;一次加密结果: &#123;cipher_hex&#125;&#x27;)</span><br><span class="line">    # 解密</span><br><span class="line">    decrypted_bin = des(cipher_bin, bin_key1, encrypt=False)</span><br><span class="line">    decrypted_hex = bin_to_hex(decrypted_bin)</span><br><span class="line">    print(f&#x27;解密结果: &#123;decrypted_hex&#125;&#x27;)</span><br><span class="line"></span><br><span class="line">    #二次加密</span><br><span class="line">    cipher_bin2 = des(cipher_bin, bin_key2, encrypt=True)</span><br><span class="line">    bin_to_hex2 = bin_to_hex(cipher_bin2)</span><br><span class="line">    print(f&quot;对称密钥二次加密: &#123;bin_to_hex2&#125;&quot;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>以下是关于DES加密算法及其代码实现的详细解析：</p>
<p>一、DES算法流程解析</p>
<ol>
<li><p>初始置换（IP置换）<br>输入：64位明文<br>处理：根据IP表进行位置置换（原第58位成为新第1位，第50位成为新第2位…）<br>输出：置换后的64位数据分为L₀（前32位）和R₀（后32位）</p>
</li>
<li><p>16轮Feistel结构<br>每轮处理流程：<br>好问题！DES（数据加密标准）最核心的一步之一就是子密钥的生成，也叫<strong>密钥调度（Key Schedule）</strong>。我们一步步来讲，保证你这个密码小白也能听懂😎</p>
</li>
</ol>
<hr>
<h2 id="🧩-一、子密钥是啥？有什么用？"><a href="#🧩-一、子密钥是啥？有什么用？" class="headerlink" title="🧩 一、子密钥是啥？有什么用？"></a>🧩 一、子密钥是啥？有什么用？</h2><ul>
<li>DES 是一个 <strong>对称加密算法</strong>，用了 16 轮 Feistel 结构。</li>
<li>每一轮都要用一个 <strong>不同的子密钥</strong>（共 16 个子密钥）。</li>
<li><strong>主密钥是 64 位（但只用其中的 56 位）</strong>，从它生成 <strong>16 个 48 位的子密钥</strong>。</li>
<li>每轮加密/解密时，都从这 16 个子密钥中取对应的一个用。</li>
</ul>
<blockquote>
<p>✅ <strong>子密钥的作用：</strong><br>每轮加密都要和子密钥做异或、S盒替换等操作，不同子密钥让每轮加密都不同，增强了安全性。</p>
</blockquote>
<hr>
<h2 id="🔑-二、怎么从主密钥生成子密钥？"><a href="#🔑-二、怎么从主密钥生成子密钥？" class="headerlink" title="🔑 二、怎么从主密钥生成子密钥？"></a>🔑 二、怎么从主密钥生成子密钥？</h2><h3 id="Step-1️⃣：64位主密钥-→-56位有效密钥（去除奇偶校验位）"><a href="#Step-1️⃣：64位主密钥-→-56位有效密钥（去除奇偶校验位）" class="headerlink" title="Step 1️⃣：64位主密钥 → 56位有效密钥（去除奇偶校验位）"></a>Step 1️⃣：64位主密钥 → 56位有效密钥（去除奇偶校验位）</h3><p>主密钥长这样（64 位）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">K = k1 k2 k3 ... k64</span><br></pre></td></tr></table></figure>
<p>每 8 位中第 8 位是奇偶校验位（也就是说每 8 位只用前 7 位），所以有效密钥是 56 位。</p>
<p>这一步用的是一个固定的 <strong>PC-1（Permuted Choice 1）置换表</strong>，对密钥进行置换和选择，去掉了校验位。</p>
<hr>
<h3 id="Step-2️⃣：将-56-位密钥分成两半"><a href="#Step-2️⃣：将-56-位密钥分成两半" class="headerlink" title="Step 2️⃣：将 56 位密钥分成两半"></a>Step 2️⃣：将 56 位密钥分成两半</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">C0 = 前 28 位</span><br><span class="line">D0 = 后 28 位</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="Step-3️⃣：循环左移-PC-2-生成-16-个子密钥"><a href="#Step-3️⃣：循环左移-PC-2-生成-16-个子密钥" class="headerlink" title="Step 3️⃣：循环左移 + PC-2 生成 16 个子密钥"></a>Step 3️⃣：循环左移 + PC-2 生成 16 个子密钥</h3><p>从 C0 和 D0 开始，每一轮做 <strong>左移（1 位或 2 位，按轮数）</strong>：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>轮数</th>
<th>移位次数</th>
</tr>
</thead>
<tbody>
<tr>
<td>1, 2, 9, 16</td>
<td>1 位</td>
</tr>
<tr>
<td>其他轮</td>
<td>2 位</td>
</tr>
</tbody>
</table>
</div>
<p>每轮都得到了：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">C1, D1 → K1  </span><br><span class="line">C2, D2 → K2  </span><br><span class="line">...  </span><br><span class="line">C16, D16 → K16  </span><br></pre></td></tr></table></figure>
<p>每次将 Cn 和 Dn 合并成 56 位，然后再用一个固定的 <strong>PC-2 表（Permuted Choice 2）</strong> 提取其中的 48 位生成 <strong>子密钥 Kn</strong>。</p>
<hr>
<h3 id="✏️-小结"><a href="#✏️-小结" class="headerlink" title="✏️ 小结"></a>✏️ 小结</h3><div class="table-container">
<table>
<thead>
<tr>
<th>步骤</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>PC-1</td>
<td>把 64 位主密钥变成 56 位（去奇偶位）</td>
</tr>
<tr>
<td>分割</td>
<td>56 位 → C0 和 D0，各 28 位</td>
</tr>
<tr>
<td>左移</td>
<td>每轮对 C 和 D 循环左移 1 或 2 位</td>
</tr>
<tr>
<td>PC-2</td>
<td>从 CnDn 中选出 48 位 → 生成第 n 轮子密钥</td>
</tr>
</tbody>
</table>
</div>
<hr>
<h2 id="🛠-子密钥在加密中的使用"><a href="#🛠-子密钥在加密中的使用" class="headerlink" title="🛠 子密钥在加密中的使用"></a>🛠 子密钥在加密中的使用</h2><p>在 DES 的每一轮加密中：</p>
<ol>
<li>将明文左右分成 L 和 R。</li>
<li>用右边部分和当前轮的 <strong>子密钥</strong> 做复杂函数 <code>f(R, K_i)</code>，包括：<ul>
<li>扩展置换</li>
<li>和子密钥异或</li>
<li>S盒替换</li>
<li>P盒置换</li>
</ul>
</li>
<li>结果再和左边部分异或</li>
<li>左右换位进入下一轮</li>
</ol>
<hr>
<h2 id="🚀-总结一句话："><a href="#🚀-总结一句话：" class="headerlink" title="🚀 总结一句话："></a>🚀 总结一句话：</h2><blockquote>
<p><strong>子密钥是从主密钥中衍生出来的一组 48 位密钥，用于 DES 的每一轮加密。它通过置换、分割、循环移位、再次置换来生成，确保每一轮操作不同，增强安全性。</strong></p>
</blockquote>
<hr>
<p>如果你想，我可以给你画一张 <strong>子密钥生成流程图</strong>，或者写一段 Python 实现 DES 密钥调度的代码～需要吗？<br>(1) 右半部分Rₙ进行扩展置换E（32→48位）<br>(2) 与子密钥Kₙ进行异或运算<br>(3) 通过8个S盒进行非线性变换（48→32位）<br>(4) 进行P盒置换<br>(5) 结果与左半部分Lₙ异或生成新右半部分Rₙ₊₁<br>(6) 交换左右部分</p>
<ol>
<li>逆初始置换（IP⁻¹置换）<br>输入：最终合并的R₁₆L₁₆（注意不交换）<br>处理：根据IP_INV表进行置换<br>输出：64位密文</li>
</ol>
<p>二、代码模块解析</p>
<ol>
<li>置换表定义<br>代码中定义了DES算法所需的所有置换表：</li>
</ol>
<ul>
<li>IP/IP_INV：初始/逆初始置换</li>
<li>PC1/PC2：密钥置换表</li>
<li>E：扩展置换表</li>
<li>S_BOX：非线性替换盒</li>
<li>P：P盒置换表</li>
<li>SHIFT：循环左移位数表</li>
</ul>
<ol>
<li>核心函数说明<br>（1）permute(bits, table)<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">permute</span>(<span class="params">bits, table</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([bits[i - <span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> table])</span><br></pre></td></tr></table></figure>
功能：通用置换函数<br>特点：处理所有DES置换操作，自动处理索引偏移（表格定义从1开始，Python索引从0开始）</li>
</ol>
<p>（2）generate_subkeys(key)<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">generate_subkeys</span>(<span class="params">key</span>):</span><br><span class="line">    key = permute(key, PC1)  <span class="comment"># PC-1置换</span></span><br><span class="line">    left, right = key[:<span class="number">28</span>], key[<span class="number">28</span>:]  <span class="comment"># 分割</span></span><br><span class="line">    subkeys = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        left = left_shift(left, SHIFT[i])  <span class="comment"># 循环左移</span></span><br><span class="line">        right = left_shift(right, SHIFT[i])</span><br><span class="line">        combined = left + right</span><br><span class="line">        subkey = permute(combined, PC2)  <span class="comment"># PC-2置换</span></span><br><span class="line">        subkeys.append(subkey)</span><br><span class="line">    <span class="keyword">return</span> subkeys</span><br></pre></td></tr></table></figure><br>功能：生成16轮子密钥<br>流程：</p>
<ol>
<li>64位密钥→PC1置换→56位</li>
<li>分割为左右28位</li>
<li>根据SHIFT表进行循环左移</li>
<li>合并后通过PC2置换生成48位子密钥</li>
</ol>
<p>（3）feistel(right, subkey)<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">feistel</span>(<span class="params">right, subkey</span>):</span><br><span class="line">    expanded = permute(right, E)  <span class="comment"># 扩展置换</span></span><br><span class="line">    xored = xor(expanded, subkey)  <span class="comment"># 异或运算</span></span><br><span class="line">    s_output = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):  <span class="comment"># S盒处理</span></span><br><span class="line">        chunk = xored[i*<span class="number">6</span>:(i+<span class="number">1</span>)*<span class="number">6</span>]</span><br><span class="line">        row = <span class="built_in">int</span>(chunk[<span class="number">0</span>]+chunk[<span class="number">5</span>], <span class="number">2</span>)  <span class="comment"># 行号</span></span><br><span class="line">        col = <span class="built_in">int</span>(chunk[<span class="number">1</span>:<span class="number">5</span>], <span class="number">2</span>)         <span class="comment"># 列号</span></span><br><span class="line">        val = S_BOX[i][row][col]</span><br><span class="line">        s_output += <span class="built_in">bin</span>(val)[<span class="number">2</span>:].zfill(<span class="number">4</span>)</span><br><span class="line">    p_output = permute(s_output, P)  <span class="comment"># P盒置换</span></span><br><span class="line">    <span class="keyword">return</span> p_output</span><br></pre></td></tr></table></figure><br>功能：实现Feistel网络的核心变换<br>特点：</p>
<ul>
<li>扩展置换使32位→48位</li>
<li>每个S盒处理6位→4位</li>
<li>最终通过P盒增强扩散性<br>你的代码里 <code>feistel</code> 函数用到了 <strong>S盒（Substitution Box）</strong>，这是 DES 加密中的一大核心！我们来详细拆解一下 S 盒的逻辑和作用，让你从密码小白变成密码达人 🚀</li>
</ul>
<hr>
<h2 id="🔐-一、S盒是干嘛的？"><a href="#🔐-一、S盒是干嘛的？" class="headerlink" title="🔐 一、S盒是干嘛的？"></a>🔐 一、S盒是干嘛的？</h2><p>S盒的作用是：  </p>
<blockquote>
<p><strong>把 6 位二进制输入，替换成 4 位输出</strong>。</p>
</blockquote>
<p>它引入了 <strong>非线性变换</strong>，是 DES 安全性的重要来源之一。</p>
<hr>
<h2 id="📦-二、S盒是怎么操作的？"><a href="#📦-二、S盒是怎么操作的？" class="headerlink" title="📦 二、S盒是怎么操作的？"></a>📦 二、S盒是怎么操作的？</h2><h3 id="输入：6-位二进制（比如-011011）"><a href="#输入：6-位二进制（比如-011011）" class="headerlink" title="输入：6 位二进制（比如 011011）"></a>输入：6 位二进制（比如 <code>011011</code>）</h3><h3 id="步骤："><a href="#步骤：" class="headerlink" title="步骤："></a>步骤：</h3><ol>
<li><p><strong>取第 1 位和第 6 位</strong>，拼起来当作 <strong>行号</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">row = <span class="built_in">int</span>(chunk[<span class="number">0</span>] + chunk[<span class="number">5</span>], <span class="number">2</span>)  <span class="comment"># 例如 &quot;01&quot; → 1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>取中间 4 位</strong>（第 2～5 位）当作 <strong>列号</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">col = <span class="built_in">int</span>(chunk[<span class="number">1</span>:<span class="number">5</span>], <span class="number">2</span>)  <span class="comment"># 例如 &quot;1101&quot; → 13</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>查 S_BOX</strong> 中第 i 个盒子的第 row 行第 col 列的值</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val = S_BOX[i][row][col]  <span class="comment"># 得到 0~15 之间的整数</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>把这个值转为 4 位二进制</strong>，作为输出：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s_output += <span class="built_in">bin</span>(val)[<span class="number">2</span>:].zfill(<span class="number">4</span>)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<h2 id="🧪-举个例子："><a href="#🧪-举个例子：" class="headerlink" title="🧪 举个例子："></a>🧪 举个例子：</h2><p>假设 <code>chunk = &quot;011011&quot;</code>，这是第 i 个块：</p>
<ul>
<li><code>row = int(&quot;01&quot;, 2) = 1</code></li>
<li><code>col = int(&quot;1101&quot;, 2) = 13</code></li>
<li><code>val = S_BOX[i][1][13]</code> → 可能是 10</li>
<li><code>bin(10)[2:].zfill(4)</code> → <code>&quot;1010&quot;</code></li>
</ul>
<p>这样 6 位输入变成 4 位输出。</p>
<hr>
<h2 id="🔁-三、为什么一共是-8-个-S盒？"><a href="#🔁-三、为什么一共是-8-个-S盒？" class="headerlink" title="🔁 三、为什么一共是 8 个 S盒？"></a>🔁 三、为什么一共是 8 个 S盒？</h2><p>因为 DES 中的 Feistel 函数处理的是 32 位数据，但：</p>
<ul>
<li>扩展置换 E 把 32 位 → 48 位</li>
<li>然后每 6 位为一组，分成 8 组</li>
<li>每组走一个 S 盒 → 输出 4 位</li>
<li>8 组共输出 32 位</li>
</ul>
<blockquote>
<p>这就实现了 48 位 → 32 位 的非线性压缩映射！</p>
</blockquote>
<hr>
<h2 id="🔒-四、S盒的安全性来源"><a href="#🔒-四、S盒的安全性来源" class="headerlink" title="🔒 四、S盒的安全性来源"></a>🔒 四、S盒的安全性来源</h2><p>S盒是 <strong>DES 安全性的关键所在</strong>，因为它：</p>
<ul>
<li>提供非线性映射，使得密文对密钥和明文的小改动非常敏感（雪崩效应）</li>
<li>是抗差分分析、线性分析等密码攻击的核心防线</li>
<li>是人工设计 + 安全性评估过的（是当年 NSA 优化过的）</li>
</ul>
<hr>
<h2 id="✅-总结一句话："><a href="#✅-总结一句话：" class="headerlink" title="✅ 总结一句话："></a>✅ 总结一句话：</h2><blockquote>
<p><strong>S盒就是一种查表替换机制：每 6 位输入 → 找行列 → 输出 4 位，8 个 S盒并行处理，共输出 32 位，用于混淆原始数据，增强加密的复杂性和安全性。</strong></p>
</blockquote>
<hr>
<p>（4）des(block, key, encrypt=True)<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">des</span>(<span class="params">block, key, encrypt=<span class="literal">True</span></span>):</span><br><span class="line">    subkeys = generate_subkeys(key)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> encrypt:</span><br><span class="line">        subkeys = subkeys[::-<span class="number">1</span>]  <span class="comment"># 解密时逆序密钥</span></span><br><span class="line">    </span><br><span class="line">    block = permute(block, IP)  <span class="comment"># 初始置换</span></span><br><span class="line">    left, right = block[:<span class="number">32</span>], block[<span class="number">32</span>:]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):  <span class="comment"># 16轮迭代</span></span><br><span class="line">        new_left = right</span><br><span class="line">        f_result = feistel(right, subkeys[i])</span><br><span class="line">        new_right = xor(left, f_result)</span><br><span class="line">        left, right = new_left, new_right</span><br><span class="line">    </span><br><span class="line">    combined = right + left  <span class="comment"># 最终不交换</span></span><br><span class="line">    ciphertext = permute(combined, IP_INV)</span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br></pre></td></tr></table></figure><br><img src="/2025/04/21/%E5%AF%86%E7%A0%81%E5%AE%9E%E9%AA%8C/IMG_20250421-214049598.png" class="">  </p>
<p>特点：</p>
<ul>
<li>通过encrypt参数控制加密/解密模式</li>
<li>16轮迭代后不交换左右部分</li>
<li>最终执行逆初始置换</li>
</ul>
<p>三、测试用例解析</p>
<ol>
<li><p>弱密钥测试</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 测试用例1：弱密钥</span></span><br><span class="line">plaintext = <span class="string">&#x27;aaabbaba&#x27;</span>  <span class="comment"># ASCII明文</span></span><br><span class="line">key = <span class="string">&#x27;0101010101010101&#x27;</span>  <span class="comment"># 全01交替的弱密钥</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 加密结果：B4B15AFCB6A8F4C5</span></span><br><span class="line"><span class="comment"># 二次加密结果恢复原文</span></span><br></pre></td></tr></table></figure>
<p>现象说明：弱密钥的对称性导致二次加密恢复原文，这是DES密钥空间中的特殊现象。</p>
</li>
<li><p>半弱密钥测试</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 半弱密钥测试</span></span><br><span class="line">key1 = <span class="string">&#x27;011f011f010e010e&#x27;</span></span><br><span class="line">key2 = <span class="string">&#x27;1f011f010e010e01&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用key1加密后再用key2加密，等价于单次加密</span></span><br></pre></td></tr></table></figure>
<p>现象说明：半弱密钥对(K1,K2)满足E(K1,E(K2,M))=M，这种密钥对在DES密钥空间中存在特定数学关系。</p>
</li>
</ol>
<p>四、代码特点分析</p>
<ol>
<li>二进制处理</li>
</ol>
<ul>
<li>所有数据内部以二进制字符串形式处理</li>
<li>提供text_to_bin()处理十六进制/ASCII输入</li>
<li>bin_to_hex()用于结果输出</li>
</ul>
<ol>
<li>模块化设计</li>
</ol>
<ul>
<li>置换操作统一由permute()处理</li>
<li>Feistel网络独立为函数</li>
<li>子密钥生成与主算法分离</li>
</ul>
<ol>
<li>算法准确性</li>
</ol>
<ul>
<li>严格遵循DES标准文档的置换表定义</li>
<li>正确处理循环左移和密钥逆序</li>
<li>精确实现S盒查表逻辑</li>
</ul>
<p>五、实验结果验证</p>
<ol>
<li><p>加密-解密一致性<br>当使用相同密钥时：<br>加密结果 → 解密 → 恢复原始明文<br>验证：测试用例中解密结果与原始明文一致</p>
</li>
<li><p>弱密钥特性<br>全01交替密钥的二次加密结果：<br>E(K,E(K,M)) = M<br>验证：测试结果符合预期</p>
</li>
</ol>
<p>该实现完整展现了DES算法的核心机制，可用于教学演示和算法分析。通过修改测试用例，可以进一步研究DES的雪崩效应、密钥依赖性等密码学特性。</p>
<h1 id="非对称加密算法RSA实现"><a href="#非对称加密算法RSA实现" class="headerlink" title="非对称加密算法RSA实现"></a>非对称加密算法RSA实现</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">import math</span><br><span class="line"></span><br><span class="line">def is_prime(num):</span><br><span class="line">    if num &lt; 2:</span><br><span class="line">        return False</span><br><span class="line">    for i in range(2, int(math.sqrt(num)) + 1):</span><br><span class="line">        if num % i == 0:</span><br><span class="line">            return False</span><br><span class="line">    return True</span><br><span class="line"></span><br><span class="line">def find_e(phi):</span><br><span class="line">    for e in [65537, 17, 5, 3]:</span><br><span class="line">        if e &lt; phi and math.gcd(e, phi) == 1:</span><br><span class="line">            return e</span><br><span class="line">    for e in range(2, phi):</span><br><span class="line">        if math.gcd(e, phi) == 1:</span><br><span class="line">            return e</span><br><span class="line">    return None</span><br><span class="line"></span><br><span class="line">def rsa_key_generation(p, q):</span><br><span class="line">    if not (is_prime(p) and is_prime(q)):</span><br><span class="line">        raise ValueError(&quot;p和q必须是素数！&quot;)</span><br><span class="line">    n = p * q</span><br><span class="line">    phi = (p - 1) * (q - 1)</span><br><span class="line">    e = find_e(phi)</span><br><span class="line">    if e is None:</span><br><span class="line">        raise ValueError(&quot;无法找到合适的e&quot;)</span><br><span class="line">    d = pow(e, -1, phi)</span><br><span class="line">    return (n, e), (n, d)</span><br><span class="line"></span><br><span class="line">def encrypt(m, public_key):</span><br><span class="line">    n, e = public_key</span><br><span class="line">    if m &gt;= n:</span><br><span class="line">        raise ValueError(&quot;明文必须小于n&quot;)</span><br><span class="line">    return pow(m, e, n)</span><br><span class="line"></span><br><span class="line">def decrypt(c, private_key):</span><br><span class="line">    n, d = private_key</span><br><span class="line">    return pow(c, d, n)</span><br><span class="line"></span><br><span class="line"># 示例测试</span><br><span class="line">p, q =885320963,238855417</span><br><span class="line">public_key, private_key = rsa_key_generation(p, q)</span><br><span class="line">print(&quot;公钥 (n, e):&quot;, public_key)</span><br><span class="line">print(&quot;私钥 (n, d):&quot;, private_key)</span><br><span class="line"></span><br><span class="line">m = 65</span><br><span class="line">c = encrypt(m, public_key)</span><br><span class="line">print(&quot;密文:&quot;, c)</span><br><span class="line">m_decrypted = decrypt(c, private_key)</span><br><span class="line">print(&quot;解密结果:&quot;, m_decrypted)</span><br></pre></td></tr></table></figure>
<p>以下是关于RSA加密算法及其代码实现的详细解析：</p>
<hr>
<h3 id="一、RSA算法原理"><a href="#一、RSA算法原理" class="headerlink" title="一、RSA算法原理"></a>一、RSA算法原理</h3><h4 id="1-密钥生成流程"><a href="#1-密钥生成流程" class="headerlink" title="1. 密钥生成流程"></a>1. 密钥生成流程</h4><ol>
<li><p><strong>选择两个大素数</strong>  </p>
<ul>
<li>选取两个互不相同的质数 p 和 q（示例中使用 p=885320963, q=238855417）</li>
<li>代码通过 <code>is_prime()</code> 函数验证素数性</li>
</ul>
</li>
<li><p><strong>计算模数和欧拉函数</strong>  </p>
<ul>
<li>模数：<code>n = p * q</code>（公开参数）</li>
<li>欧拉函数：<code>φ(n) = (p-1)*(q-1)</code>（保密参数）</li>
</ul>
</li>
<li><p><strong>选择公钥指数 e</strong>  </p>
<ul>
<li>要求：<code>1 &lt; e &lt; φ(n)</code> 且 <code>gcd(e, φ(n)) = 1</code>  </li>
<li>代码优先选择常用值 65537（安全且计算高效），其次尝试 17/5/3，最后遍历查找</li>
</ul>
</li>
<li><p><strong>计算私钥指数 d</strong>  </p>
<ul>
<li>要求：<code>d ≡ e⁻¹ mod φ(n)</code>，即满足 <code>(e*d) % φ(n) = 1</code>  </li>
<li>代码使用 <code>pow(e, -1, phi)</code> 快速计算模逆元</li>
</ul>
</li>
</ol>
<h4 id="2-加解密过程"><a href="#2-加解密过程" class="headerlink" title="2. 加解密过程"></a>2. 加解密过程</h4><ul>
<li><strong>加密</strong>：<code>c ≡ m^e mod n</code>（使用公钥 (n,e)）</li>
<li><strong>解密</strong>：<code>m ≡ c^d mod n</code>（使用私钥 (n,d)）</li>
</ul>
<hr>
<h3 id="二、代码模块解析"><a href="#二、代码模块解析" class="headerlink" title="二、代码模块解析"></a>二、代码模块解析</h3><h4 id="1-素数检测函数"><a href="#1-素数检测函数" class="headerlink" title="1. 素数检测函数"></a>1. 素数检测函数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">is_prime</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="keyword">if</span> num &lt; <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="built_in">int</span>(math.sqrt(num)) + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> num % i == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>功能</strong>：判断数字是否为素数</li>
<li><strong>特点</strong>：<ul>
<li>时间复杂度：O(√n)（适合教学演示）</li>
<li>实际工程中应使用Miller-Rabin等概率性检测算法</li>
</ul>
</li>
</ul>
<h4 id="2-公钥指数选择"><a href="#2-公钥指数选择" class="headerlink" title="2. 公钥指数选择"></a>2. 公钥指数选择</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">find_e</span>(<span class="params">phi</span>):</span><br><span class="line">    <span class="keyword">for</span> e <span class="keyword">in</span> [<span class="number">65537</span>, <span class="number">17</span>, <span class="number">5</span>, <span class="number">3</span>]:  <span class="comment"># 常用优先</span></span><br><span class="line">        <span class="keyword">if</span> e &lt; phi <span class="keyword">and</span> math.gcd(e, phi) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> e</span><br><span class="line">    <span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, phi):      <span class="comment"># 遍历查找</span></span><br><span class="line">        <span class="keyword">if</span> math.gcd(e, phi) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> e</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>设计逻辑</strong>：<ol>
<li>优先选择常用公钥指数（65537在安全与效率间取得平衡）</li>
<li>次优选择小素数加速加密计算</li>
<li>最后遍历保证总能找到合适指数</li>
</ol>
</li>
</ul>
<h4 id="3-密钥生成核心"><a href="#3-密钥生成核心" class="headerlink" title="3. 密钥生成核心"></a>3. 密钥生成核心</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_key_generation</span>(<span class="params">p, q</span>):</span><br><span class="line">    <span class="comment"># 参数检查</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (is_prime(p) <span class="keyword">and</span> is_prime(q)):</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;p和q必须是素数！&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 计算核心参数</span></span><br><span class="line">    n = p * q</span><br><span class="line">    phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 选择公钥指数</span></span><br><span class="line">    e = find_e(phi)</span><br><span class="line">    <span class="keyword">if</span> e <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;无法找到合适的e&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 计算私钥指数</span></span><br><span class="line">    d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)  <span class="comment"># 模逆运算</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> (n, e), (n, d)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>关键步骤</strong>：<ul>
<li>输入验证确保p,q为素数</li>
<li>使用Python内置的<code>pow()</code>函数快速计算模逆元</li>
<li>返回格式：公钥(n,e) 与 私钥(n,d)</li>
</ul>
</li>
</ul>
<h4 id="4-加解密函数"><a href="#4-加解密函数" class="headerlink" title="4. 加解密函数"></a>4. 加解密函数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m, public_key</span>):</span><br><span class="line">    n, e = public_key</span><br><span class="line">    <span class="keyword">if</span> m &gt;= n:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;明文必须小于n&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(m, e, n)  <span class="comment"># 模幂运算</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">c, private_key</span>):</span><br><span class="line">    n, d = private_key</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(c, d, n)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>数学基础</strong>：欧拉定理保证<code>m^(kφ(n)+1) ≡ m mod n</code></li>
<li><strong>限制条件</strong>：明文必须满足<code>m &lt; n</code></li>
<li><strong>实际应用</strong>：需配合OAEP等填充方案处理长文本</li>
</ul>
<hr>
<h3 id="三、示例测试分析"><a href="#三、示例测试分析" class="headerlink" title="三、示例测试分析"></a>三、示例测试分析</h3><h4 id="1-输入参数"><a href="#1-输入参数" class="headerlink" title="1. 输入参数"></a>1. 输入参数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">885320963</span></span><br><span class="line">q = <span class="number">238855417</span></span><br><span class="line">m = <span class="number">65</span></span><br></pre></td></tr></table></figure>
<h4 id="2-密钥生成结果"><a href="#2-密钥生成结果" class="headerlink" title="2. 密钥生成结果"></a>2. 密钥生成结果</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">公钥 (n, e): (211463707796205371, 65537)</span><br><span class="line">私钥 (n, d): (211463707796205371, 107827558183622753)</span><br></pre></td></tr></table></figure>
<ul>
<li><p><strong>n计算验证</strong>：<br><code>885320963 * 238855417 = 211,463,707,796,205,371</code><br>与输出一致</p>
</li>
<li><p><strong>d验证</strong>：<br><code>(65537 * 107827558183622753) % φ(n) = 1</code><br>可通过模运算验证</p>
</li>
</ul>
<h4 id="3-加解密过程"><a href="#3-加解密过程" class="headerlink" title="3. 加解密过程"></a>3. 加解密过程</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">密文: 15943230000000001</span><br><span class="line">解密结果: 65</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>加密验证</strong>：<code>65^65537 mod n = 15943230000000001</code></li>
<li><strong>解密验证</strong>：<code>15943230000000001^d mod n = 65</code></li>
</ul>
<hr>
<h3 id="四、算法安全性分析"><a href="#四、算法安全性分析" class="headerlink" title="四、算法安全性分析"></a>四、算法安全性分析</h3><ol>
<li><p><strong>依赖的数学难题</strong>：</p>
<ul>
<li>大整数分解问题：已知n=p*q，难以分解出p和q</li>
</ul>
</li>
<li><p><strong>参数选择要求</strong>：</p>
<ul>
<li>p和q应为安全素数（示例参数过小，仅用于演示）</li>
<li>实际应用要求n长度≥2048位</li>
</ul>
</li>
<li><p><strong>常见攻击防御</strong>：</p>
<ul>
<li>选择p和q长度相近但差值较大</li>
<li>使用随机填充方案防止低指数攻击</li>
</ul>
</li>
</ol>
<hr>
<h3 id="五、代码优化方向"><a href="#五、代码优化方向" class="headerlink" title="五、代码优化方向"></a>五、代码优化方向</h3><ol>
<li><p><strong>大数处理</strong>：</p>
<ul>
<li>添加对字符串消息的编解码支持</li>
<li>实现分段加密处理长文本</li>
</ul>
</li>
<li><p><strong>性能优化</strong>：</p>
<ul>
<li>使用快速幂算法优化模幂运算</li>
<li>实现蒙哥马利模乘加速计算</li>
</ul>
</li>
<li><p><strong>安全性增强</strong>：</p>
<ul>
<li>添加PKCS#1 v1.5或OAEP填充方案</li>
<li>支持CRT（中国剩余定理）加速解密</li>
</ul>
</li>
</ol>
<hr>
<h3 id="六、实验现象解释"><a href="#六、实验现象解释" class="headerlink" title="六、实验现象解释"></a>六、实验现象解释</h3><ol>
<li><p><strong>弱密钥现象</strong><br>当选择特殊参数时（如p=17, q=17），会导致加密失效<br>代码通过<code>is_prime()</code>检测避免了重复素数</p>
</li>
<li><p><strong>明文限制</strong><br>示例中若选择<code>m = n</code>会触发<code>ValueError</code><br>实际应用中需通过填充保证<code>m &lt; n</code></p>
</li>
</ol>
<p>该实现完整展现了RSA的核心数学原理，可用于教学演示和算法分析。通过修改素数生成方法，可以进一步研究RSA算法的实际应用场景和安全性特征。</p>
<h1 id="签名"><a href="#签名" class="headerlink" title="签名"></a>签名</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Random <span class="keyword">import</span> get_random_bytes</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Signature <span class="keyword">import</span> pkcs1_15</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHA256</span><br><span class="line"></span><br><span class="line"><span class="comment"># RSA 签名函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_sign</span>(<span class="params">private_key, hash_obj</span>):</span><br><span class="line">    <span class="keyword">return</span> pkcs1_15.new(private_key).sign(hash_obj)</span><br><span class="line"></span><br><span class="line"><span class="comment"># RSA 验签函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_verify</span>(<span class="params">public_key, hash_obj, signature</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        pkcs1_15.new(public_key).verify(hash_obj, signature)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span> (ValueError, TypeError):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># AES CBC 加密函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aes_encrypt</span>(<span class="params">plaintext: <span class="built_in">bytes</span>, key: <span class="built_in">bytes</span>, iv: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    <span class="keyword">return</span> cipher.encrypt(pad(plaintext, AES.block_size))</span><br><span class="line"></span><br><span class="line"><span class="comment"># AES CBC 解密函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aes_decrypt</span>(<span class="params">ciphertext: <span class="built_in">bytes</span>, key: <span class="built_in">bytes</span>, iv: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    <span class="keyword">return</span> unpad(cipher.decrypt(ciphertext), AES.block_size)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算 SHA256 哈希</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sha256_hash</span>(<span class="params">data: <span class="built_in">str</span></span>):</span><br><span class="line">    <span class="keyword">return</span> SHA256.new(data.encode())</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"><span class="comment"># 明文消息</span></span><br><span class="line">    plain_text = <span class="string">&quot;Hey&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算哈希</span></span><br><span class="line">    msg_hash = sha256_hash(plain_text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成 RSA 密钥对</span></span><br><span class="line">    rsa_key = RSA.generate(<span class="number">2048</span>)</span><br><span class="line">    private_key = rsa_key</span><br><span class="line">    public_key = rsa_key.publickey()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 RSA 私钥签名</span></span><br><span class="line">    signature = rsa_sign(private_key, msg_hash)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 合并原文和签名（便于统一加密）</span></span><br><span class="line">    combined_data = plain_text.encode() + signature</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成 AES 密钥和 IV</span></span><br><span class="line">    aes_key = get_random_bytes(<span class="number">16</span>)  <span class="comment"># 128-bit AES key</span></span><br><span class="line">    aes_iv = get_random_bytes(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加密合并数据</span></span><br><span class="line">    cipher_text = aes_encrypt(combined_data, aes_key, aes_iv)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密还原数据</span></span><br><span class="line">    decrypted_data = aes_decrypt(cipher_text, aes_key, aes_iv)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分离出原文和签名</span></span><br><span class="line">    sig_len = <span class="built_in">len</span>(signature)</span><br><span class="line">    recovered_msg = decrypted_data[:-sig_len]</span><br><span class="line">    recovered_signature = decrypted_data[-sig_len:]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证签名</span></span><br><span class="line">    recovered_hash = sha256_hash(recovered_msg.decode())</span><br><span class="line">    valid = rsa_verify(public_key, recovered_hash, recovered_signature)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;密文：&quot;</span>, cipher_text)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;消息是否被篡改：&quot;</span>, <span class="keyword">not</span> valid)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;还原后的消息：&quot;</span>, recovered_msg.decode())</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>下面我从整体流程到代码细节，分三部分给你讲解——即便你是密码小白，也能跟着思路一步步弄懂：</p>
<hr>
<h2 id="一、整体加密＋签名流程概述"><a href="#一、整体加密＋签名流程概述" class="headerlink" title="一、整体加密＋签名流程概述"></a>一、整体加密＋签名流程概述</h2><p>本实验演示的是一种“<strong>带保密性（Confidentiality）＋带签名（Authenticity）</strong>”的混合加密方案，大致分三步：</p>
<ol>
<li><p><strong>数字签名（Authentication）</strong>  </p>
<ul>
<li>对明文 <code>M</code> 先做 <strong>哈希</strong>（SHA‑256），得到消息摘要 <code>H = SHA256(M)</code>  </li>
<li>用<strong>发送方的 RSA 私钥</strong>对 <code>H</code> 进行 <strong>PKCS#1 v1.5 签名</strong>，得到签名 <code>S</code>  </li>
</ul>
</li>
<li><p><strong>对称加密（Confidentiality）</strong>  </p>
<ul>
<li>生成一次性随机 <strong>AES 密钥</strong> <code>K</code> 和初始向量 <code>IV</code>  </li>
<li>用 <strong>AES-CBC</strong> 模式对原文 <code>M</code> 进行加密，得到密文 <code>C = AES_CBC_Enc(K, IV, M)</code>  </li>
</ul>
</li>
<li><p><strong>密钥封装（Key Encapsulation）</strong>  </p>
<ul>
<li>（可选／示例中未实现）用<strong>接收方 RSA 公钥</strong>将对称密钥 <code>K</code> 加密，得到 <code>E = RSA_Encrypt(Pub_recipient, K)</code>  </li>
<li>最后将三部分打包发送给接收方：<code>&#123; E, IV, C, S &#125;</code>  </li>
</ul>
</li>
</ol>
<p>接收方收到后，按反向步骤依次：  </p>
<ol>
<li>RSA 解密拿到对称密钥 <code>K</code>  </li>
<li>用 <code>K, IV</code> 解 AES，得到明文 <code>M′</code>  </li>
<li>对 <code>M′</code> 再做 SHA‑256，得到 <code>H′</code>，用发送方公钥验证 <code>H′</code> 是否匹配签名 <code>S</code>  </li>
</ol>
<p>这样既保证了内容的<strong>保密性</strong>，又保证了发送者身份的<strong>不可否认性</strong>和<strong>完整性</strong>。</p>
<hr>
<h2 id="二、代码流程详解"><a href="#二、代码流程详解" class="headerlink" title="二、代码流程详解"></a>二、代码流程详解</h2><p>你给出的代码示例，主要实现了上面第 1、2 步（签名 + 对称加密 + 解密 + 验签），我们分块看：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Random <span class="keyword">import</span> get_random_bytes</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Signature <span class="keyword">import</span> pkcs1_15</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHA256</span><br></pre></td></tr></table></figure>
<ul>
<li>引入了 PyCryptodome 库的 <strong>RSA</strong>, <strong>AES</strong>, <strong>SHA256</strong>, <strong>PKCS#1 v1.5 签名</strong> 以及 <strong>随机数、填充</strong> 工具。</li>
</ul>
<hr>
<h3 id="1-哈希函数"><a href="#1-哈希函数" class="headerlink" title="1. 哈希函数"></a>1. 哈希函数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sha256_hash</span>(<span class="params">data: <span class="built_in">str</span></span>):</span><br><span class="line">    <span class="keyword">return</span> SHA256.new(data.encode())</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>功能</strong>：对字符串 <code>data</code> 做 SHA‑256，返回一个 <code>Hash</code> 对象，供签名或验证使用。</li>
</ul>
<hr>
<h3 id="2-RSA-签名／验签"><a href="#2-RSA-签名／验签" class="headerlink" title="2. RSA 签名／验签"></a>2. RSA 签名／验签</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_sign</span>(<span class="params">private_key, hash_obj</span>):</span><br><span class="line">    <span class="keyword">return</span> pkcs1_15.new(private_key).sign(hash_obj)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_verify</span>(<span class="params">public_key, hash_obj, signature</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        pkcs1_15.new(public_key).verify(hash_obj, signature)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span> (ValueError, TypeError):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>签名</strong>：用私钥对 <code>hash_obj</code> 进行 PKCS#1 v1.5 签名，返回原始字节串 <code>signature</code>。  </li>
<li><strong>验签</strong>：用公钥验证签名，若匹配则返回 <code>True</code>，否则抛异常并返回 <code>False</code>。</li>
</ul>
<hr>
<h3 id="3-AES-CBC-加解密"><a href="#3-AES-CBC-加解密" class="headerlink" title="3. AES-CBC 加解密"></a>3. AES-CBC 加解密</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">aes_encrypt</span>(<span class="params">plaintext: <span class="built_in">bytes</span>, key: <span class="built_in">bytes</span>, iv: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    <span class="keyword">return</span> cipher.encrypt(pad(plaintext, AES.block_size))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aes_decrypt</span>(<span class="params">ciphertext: <span class="built_in">bytes</span>, key: <span class="built_in">bytes</span>, iv: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    <span class="keyword">return</span> unpad(cipher.decrypt(ciphertext), AES.block_size)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>加密</strong>：  <ol>
<li>用 <code>key, iv</code> 构造 AES-CBC 对象  </li>
<li>对明文 <code>plaintext</code> 先做 PKCS#7 填充（块长 16 字节），再加密  </li>
</ol>
</li>
<li><strong>解密</strong>：反向解密并去除填充</li>
</ul>
<hr>
<h3 id="4-主流程"><a href="#4-主流程" class="headerlink" title="4. 主流程"></a>4. 主流程</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 1）准备原文</span></span><br><span class="line">    plain_text = <span class="string">&quot;Hey&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2）哈希 + 签名</span></span><br><span class="line">    msg_hash  = sha256_hash(plain_text)</span><br><span class="line">    rsa_key   = RSA.generate(<span class="number">2048</span>)</span><br><span class="line">    private_key = rsa_key</span><br><span class="line">    public_key  = rsa_key.publickey()</span><br><span class="line">    signature = rsa_sign(private_key, msg_hash)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3）把原文和签名拼在一起，统一做对称加密</span></span><br><span class="line">    combined_data = plain_text.encode() + signature</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 4）生成随机 AES 密钥 &amp; IV</span></span><br><span class="line">    aes_key = get_random_bytes(<span class="number">16</span>)  <span class="comment"># 128 位</span></span><br><span class="line">    aes_iv  = get_random_bytes(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 5）AES 加密</span></span><br><span class="line">    cipher_text = aes_encrypt(combined_data, aes_key, aes_iv)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ——网络传输或存储——</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 6）AES 解密</span></span><br><span class="line">    decrypted_data = aes_decrypt(cipher_text, aes_key, aes_iv)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 7）分离出原文和签名</span></span><br><span class="line">    sig_len = <span class="built_in">len</span>(signature)</span><br><span class="line">    recovered_msg       = decrypted_data[:-sig_len]</span><br><span class="line">    recovered_signature = decrypted_data[-sig_len:]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 8）验签</span></span><br><span class="line">    recovered_hash = sha256_hash(recovered_msg.decode())</span><br><span class="line">    valid = rsa_verify(public_key, recovered_hash, recovered_signature)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 9）输出</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;密文：&quot;</span>, cipher_text)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;消息是否被篡改：&quot;</span>, <span class="keyword">not</span> valid)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;还原后的消息：&quot;</span>, recovered_msg.decode())</span><br></pre></td></tr></table></figure>
<ol>
<li><strong>生成 RSA 密钥对</strong>  </li>
<li><strong>签名</strong>：对 <code>&quot;Hey&quot;</code> 的 SHA‑256 做签名  </li>
<li><strong>拼接</strong>：为了简化，把签名字节直接追加到明文后面  </li>
<li><strong>AES-CBC 加密</strong>：对拼接后的数据加密  </li>
<li><strong>AES-CBC 解密</strong>  </li>
<li><strong>分离</strong>出明文和签名，再次做 SHA‑256，验签  </li>
</ol>
<blockquote>
<p><strong>注意</strong>：代码中并没有把 <code>aes_key</code> 用 RSA 公钥加密；在真实场景下，应当将 <code>aes_key</code> 也封装进消息里，保证对称密钥的机密性。  </p>
</blockquote>
<hr>
<h2 id="三、完整示例：加上“密钥封装”的改进"><a href="#三、完整示例：加上“密钥封装”的改进" class="headerlink" title="三、完整示例：加上“密钥封装”的改进"></a>三、完整示例：加上“密钥封装”的改进</h2><p>下面给出一个更完整的示例，加入“用接收方 RSA 公钥加密 AES 密钥”这一步：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES, PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> Crypto.Random <span class="keyword">import</span> get_random_bytes</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Signature <span class="keyword">import</span> pkcs1_15</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHA256</span><br><span class="line"></span><br><span class="line"><span class="comment"># …（前面 sha256_hash, rsa_sign, rsa_verify, aes_encrypt, aes_decrypt 一样）…</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 原文</span></span><br><span class="line">    M = <span class="string">&quot;Hello, world!&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 1. 签名</span></span><br><span class="line">    H = sha256_hash(M)</span><br><span class="line">    sender_rsa = RSA.generate(<span class="number">2048</span>)</span><br><span class="line">    S = rsa_sign(sender_rsa, H)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 对称加密原文</span></span><br><span class="line">    aes_key = get_random_bytes(<span class="number">16</span>)</span><br><span class="line">    iv      = get_random_bytes(<span class="number">16</span>)</span><br><span class="line">    C = aes_encrypt(M.encode(), aes_key, iv)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. RSA 封装 AES 密钥</span></span><br><span class="line">    recipient_rsa = RSA.generate(<span class="number">2048</span>)</span><br><span class="line">    cipher_rsa = PKCS1_OAEP.new(recipient_rsa.publickey())</span><br><span class="line">    E = cipher_rsa.encrypt(aes_key)  <span class="comment"># RSA-OAEP 加密</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 打包发送：&#123; E, iv, C, S &#125;</span></span><br><span class="line">    package = &#123;</span><br><span class="line">        <span class="string">&#x27;E&#x27;</span>: E,</span><br><span class="line">        <span class="string">&#x27;iv&#x27;</span>: iv,</span><br><span class="line">        <span class="string">&#x27;C&#x27;</span>: C,</span><br><span class="line">        <span class="string">&#x27;S&#x27;</span>: S,</span><br><span class="line">        <span class="string">&#x27;pub_sender&#x27;</span>: sender_rsa.publickey()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ——接收方——</span></span><br><span class="line">    <span class="comment"># 4. 解 RSA 封装的 AES 密钥</span></span><br><span class="line">    rsa_dec = PKCS1_OAEP.new(recipient_rsa)</span><br><span class="line">    aes_key_recv = rsa_dec.decrypt(package[<span class="string">&#x27;E&#x27;</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 5. 解 AES</span></span><br><span class="line">    M_rec = aes_decrypt(package[<span class="string">&#x27;C&#x27;</span>], aes_key_recv, package[<span class="string">&#x27;iv&#x27;</span>]).decode()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 6. 验签</span></span><br><span class="line">    H_rec = sha256_hash(M_rec)</span><br><span class="line">    ok = rsa_verify(package[<span class="string">&#x27;pub_sender&#x27;</span>], H_rec, package[<span class="string">&#x27;S&#x27;</span>])</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;明文恢复：&quot;</span>, M_rec)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;签名验证通过？&quot;</span>, ok)</span><br></pre></td></tr></table></figure>
<p>这样就完成了：</p>
<ol>
<li><strong>签名</strong>（防篡改+身份认证）  </li>
<li><strong>对称加密</strong>（高效保密）  </li>
<li><strong>密钥封装</strong>（保证对称密钥的机密性）  </li>
</ol>
<hr>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><ul>
<li><strong>SHA‑256</strong> 负责生成消息摘要。  </li>
<li><strong>RSA 私钥签名 + 公钥验签</strong> 保证消息未被篡改且确实来自发送方。  </li>
<li><strong>AES-CBC</strong> 高效地加密大段数据。  </li>
<li><strong>RSA-OAEP</strong>（或 PKCS#1 v1.5）封装对称密钥，既保密又兼容公钥基础设施。  </li>
</ul>
<p>这套混合加密＋签名方案，正是很多安全协议（如 TLS）在应用层面使用的基本思路。希望这个分步详解，能让你对每一步的“<strong>为什么要这样做</strong>”和“<strong>代码如何实现</strong>”都清晰明了！如果还有任何疑问，随时提～</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://lisien11.xyz">L</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://lisien11.xyz/2025/04/21/%E5%AF%86%E7%A0%81%E5%AE%9E%E9%AA%8C/">https://lisien11.xyz/2025/04/21/%E5%AF%86%E7%A0%81%E5%AE%9E%E9%AA%8C/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://lisien11.xyz" target="_blank">L的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover94.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/04/24/%E7%8E%84%E6%9C%BA/" title="玄机"><img class="cover" src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover23.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">玄机</div></div></a></div><div class="next-post pull-right"><a href="/2025/04/11/awdp/" title="awdp"><img class="cover" src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover78.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">awdp</div></div></a></div></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/%E5%9B%BE%E7%89%87/1231.jpg" onerror="this.onerror=null;this.src='/img/lll.png'" alt="avatar"/></div><div class="author-info__name">L</div><div class="author-info__description">我只是一个平平无奇路过的普通大学生罢了</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">148</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">46</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">43</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/lisien11"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="/atom.xml" target="_blank" title="订阅-ATOM"><i class="fas fa-rss"></i></a><a class="social-icon" href="https://github.com/lisien11" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:2488218724@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">无人问津也好，技不如人也罢，你都要试着安静下来，去做自己该做的事，而不是让内心烦躁焦虑，毁掉你本就不多的热情和定力。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%BF%E5%B0%84%E5%AF%86%E7%A0%81"><span class="toc-number">1.</span> <span class="toc-text">仿射密码</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E9%87%8A"><span class="toc-number">1.1.</span> <span class="toc-text">解释</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%90-%E4%B8%80%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF%E4%BB%BF%E5%B0%84%E5%AF%86%E7%A0%81%EF%BC%88Affine-Cipher%EF%BC%89%EF%BC%9F"><span class="toc-number">1.2.</span> <span class="toc-text">🔐 一、什么是仿射密码（Affine Cipher）？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86%E5%85%AC%E5%BC%8F%EF%BC%9A"><span class="toc-number">1.2.1.</span> <span class="toc-text">加密公式：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%AF%86%E5%85%AC%E5%BC%8F%EF%BC%9A"><span class="toc-number">1.2.2.</span> <span class="toc-text">解密公式：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%A0-%E4%BA%8C%E3%80%81%E4%BB%A3%E7%A0%81%E9%80%90%E6%AD%A5%E8%A7%A3%E9%87%8A"><span class="toc-number">1.3.</span> <span class="toc-text">🧠 二、代码逐步解释</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-text-to-numbers-text"><span class="toc-number">1.3.1.</span> <span class="toc-text">1. text_to_numbers(text)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-encryption-m-a-b"><span class="toc-number">1.3.2.</span> <span class="toc-text">2. encryption(m, a, b)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-decryption-c-a-b"><span class="toc-number">1.3.3.</span> <span class="toc-text">3. decryption(c, a, b)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-get-valid-key-a"><span class="toc-number">1.3.4.</span> <span class="toc-text">4. get_valid_key_a()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-main"><span class="toc-number">1.3.5.</span> <span class="toc-text">5. main()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%AA-%E4%B8%89%E3%80%81%E5%AE%9E%E9%AA%8C%E6%93%8D%E4%BD%9C%E6%AD%A5%E9%AA%A4%E6%80%BB%E7%BB%93"><span class="toc-number">1.4.</span> <span class="toc-text">🧪 三、实验操作步骤总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9C%85-%E5%9B%9B%E3%80%81%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.5.</span> <span class="toc-text">✅ 四、实验结果示例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%EF%BC%9A"><span class="toc-number">1.5.1.</span> <span class="toc-text">输入：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BE%93%E5%87%BA%EF%BC%9A"><span class="toc-number">1.5.2.</span> <span class="toc-text">输出：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%92%A1-%E4%BA%94%E3%80%81%E5%AE%9E%E9%AA%8C%E5%BF%83%E5%BE%97"><span class="toc-number">1.6.</span> <span class="toc-text">💡 五、实验心得</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DES"><span class="toc-number">2.</span> <span class="toc-text">DES</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%A9-%E4%B8%80%E3%80%81%E5%AD%90%E5%AF%86%E9%92%A5%E6%98%AF%E5%95%A5%EF%BC%9F%E6%9C%89%E4%BB%80%E4%B9%88%E7%94%A8%EF%BC%9F"><span class="toc-number">2.1.</span> <span class="toc-text">🧩 一、子密钥是啥？有什么用？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%91-%E4%BA%8C%E3%80%81%E6%80%8E%E4%B9%88%E4%BB%8E%E4%B8%BB%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E5%AD%90%E5%AF%86%E9%92%A5%EF%BC%9F"><span class="toc-number">2.2.</span> <span class="toc-text">🔑 二、怎么从主密钥生成子密钥？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Step-1%EF%B8%8F%E2%83%A3%EF%BC%9A64%E4%BD%8D%E4%B8%BB%E5%AF%86%E9%92%A5-%E2%86%92-56%E4%BD%8D%E6%9C%89%E6%95%88%E5%AF%86%E9%92%A5%EF%BC%88%E5%8E%BB%E9%99%A4%E5%A5%87%E5%81%B6%E6%A0%A1%E9%AA%8C%E4%BD%8D%EF%BC%89"><span class="toc-number">2.2.1.</span> <span class="toc-text">Step 1️⃣：64位主密钥 → 56位有效密钥（去除奇偶校验位）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Step-2%EF%B8%8F%E2%83%A3%EF%BC%9A%E5%B0%86-56-%E4%BD%8D%E5%AF%86%E9%92%A5%E5%88%86%E6%88%90%E4%B8%A4%E5%8D%8A"><span class="toc-number">2.2.2.</span> <span class="toc-text">Step 2️⃣：将 56 位密钥分成两半</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Step-3%EF%B8%8F%E2%83%A3%EF%BC%9A%E5%BE%AA%E7%8E%AF%E5%B7%A6%E7%A7%BB-PC-2-%E7%94%9F%E6%88%90-16-%E4%B8%AA%E5%AD%90%E5%AF%86%E9%92%A5"><span class="toc-number">2.2.3.</span> <span class="toc-text">Step 3️⃣：循环左移 + PC-2 生成 16 个子密钥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%9C%8F%EF%B8%8F-%E5%B0%8F%E7%BB%93"><span class="toc-number">2.2.4.</span> <span class="toc-text">✏️ 小结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%9B%A0-%E5%AD%90%E5%AF%86%E9%92%A5%E5%9C%A8%E5%8A%A0%E5%AF%86%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">2.3.</span> <span class="toc-text">🛠 子密钥在加密中的使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%9A%80-%E6%80%BB%E7%BB%93%E4%B8%80%E5%8F%A5%E8%AF%9D%EF%BC%9A"><span class="toc-number">2.4.</span> <span class="toc-text">🚀 总结一句话：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%90-%E4%B8%80%E3%80%81S%E7%9B%92%E6%98%AF%E5%B9%B2%E5%98%9B%E7%9A%84%EF%BC%9F"><span class="toc-number">2.5.</span> <span class="toc-text">🔐 一、S盒是干嘛的？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%A6-%E4%BA%8C%E3%80%81S%E7%9B%92%E6%98%AF%E6%80%8E%E4%B9%88%E6%93%8D%E4%BD%9C%E7%9A%84%EF%BC%9F"><span class="toc-number">2.6.</span> <span class="toc-text">📦 二、S盒是怎么操作的？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%EF%BC%9A6-%E4%BD%8D%E4%BA%8C%E8%BF%9B%E5%88%B6%EF%BC%88%E6%AF%94%E5%A6%82-011011%EF%BC%89"><span class="toc-number">2.6.1.</span> <span class="toc-text">输入：6 位二进制（比如 011011）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4%EF%BC%9A"><span class="toc-number">2.6.2.</span> <span class="toc-text">步骤：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%AA-%E4%B8%BE%E4%B8%AA%E4%BE%8B%E5%AD%90%EF%BC%9A"><span class="toc-number">2.7.</span> <span class="toc-text">🧪 举个例子：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%81-%E4%B8%89%E3%80%81%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%80%E5%85%B1%E6%98%AF-8-%E4%B8%AA-S%E7%9B%92%EF%BC%9F"><span class="toc-number">2.8.</span> <span class="toc-text">🔁 三、为什么一共是 8 个 S盒？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%92-%E5%9B%9B%E3%80%81S%E7%9B%92%E7%9A%84%E5%AE%89%E5%85%A8%E6%80%A7%E6%9D%A5%E6%BA%90"><span class="toc-number">2.9.</span> <span class="toc-text">🔒 四、S盒的安全性来源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9C%85-%E6%80%BB%E7%BB%93%E4%B8%80%E5%8F%A5%E8%AF%9D%EF%BC%9A"><span class="toc-number">2.10.</span> <span class="toc-text">✅ 总结一句话：</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95RSA%E5%AE%9E%E7%8E%B0"><span class="toc-number">3.</span> <span class="toc-text">非对称加密算法RSA实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81RSA%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86"><span class="toc-number">3.0.1.</span> <span class="toc-text">一、RSA算法原理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E6%B5%81%E7%A8%8B"><span class="toc-number">3.0.1.1.</span> <span class="toc-text">1. 密钥生成流程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%8A%A0%E8%A7%A3%E5%AF%86%E8%BF%87%E7%A8%8B"><span class="toc-number">3.0.1.2.</span> <span class="toc-text">2. 加解密过程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E4%BB%A3%E7%A0%81%E6%A8%A1%E5%9D%97%E8%A7%A3%E6%9E%90"><span class="toc-number">3.0.2.</span> <span class="toc-text">二、代码模块解析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%B4%A0%E6%95%B0%E6%A3%80%E6%B5%8B%E5%87%BD%E6%95%B0"><span class="toc-number">3.0.2.1.</span> <span class="toc-text">1. 素数检测函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%85%AC%E9%92%A5%E6%8C%87%E6%95%B0%E9%80%89%E6%8B%A9"><span class="toc-number">3.0.2.2.</span> <span class="toc-text">2. 公钥指数选择</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E6%A0%B8%E5%BF%83"><span class="toc-number">3.0.2.3.</span> <span class="toc-text">3. 密钥生成核心</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%87%BD%E6%95%B0"><span class="toc-number">3.0.2.4.</span> <span class="toc-text">4. 加解密函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E7%A4%BA%E4%BE%8B%E6%B5%8B%E8%AF%95%E5%88%86%E6%9E%90"><span class="toc-number">3.0.3.</span> <span class="toc-text">三、示例测试分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E8%BE%93%E5%85%A5%E5%8F%82%E6%95%B0"><span class="toc-number">3.0.3.1.</span> <span class="toc-text">1. 输入参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E7%BB%93%E6%9E%9C"><span class="toc-number">3.0.3.2.</span> <span class="toc-text">2. 密钥生成结果</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%8A%A0%E8%A7%A3%E5%AF%86%E8%BF%87%E7%A8%8B"><span class="toc-number">3.0.3.3.</span> <span class="toc-text">3. 加解密过程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E7%AE%97%E6%B3%95%E5%AE%89%E5%85%A8%E6%80%A7%E5%88%86%E6%9E%90"><span class="toc-number">3.0.4.</span> <span class="toc-text">四、算法安全性分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E4%BB%A3%E7%A0%81%E4%BC%98%E5%8C%96%E6%96%B9%E5%90%91"><span class="toc-number">3.0.5.</span> <span class="toc-text">五、代码优化方向</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E5%AE%9E%E9%AA%8C%E7%8E%B0%E8%B1%A1%E8%A7%A3%E9%87%8A"><span class="toc-number">3.0.6.</span> <span class="toc-text">六、实验现象解释</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AD%BE%E5%90%8D"><span class="toc-number">4.</span> <span class="toc-text">签名</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%95%B4%E4%BD%93%E5%8A%A0%E5%AF%86%EF%BC%8B%E7%AD%BE%E5%90%8D%E6%B5%81%E7%A8%8B%E6%A6%82%E8%BF%B0"><span class="toc-number">4.1.</span> <span class="toc-text">一、整体加密＋签名流程概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E4%BB%A3%E7%A0%81%E6%B5%81%E7%A8%8B%E8%AF%A6%E8%A7%A3"><span class="toc-number">4.2.</span> <span class="toc-text">二、代码流程详解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%93%88%E5%B8%8C%E5%87%BD%E6%95%B0"><span class="toc-number">4.2.1.</span> <span class="toc-text">1. 哈希函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-RSA-%E7%AD%BE%E5%90%8D%EF%BC%8F%E9%AA%8C%E7%AD%BE"><span class="toc-number">4.2.2.</span> <span class="toc-text">2. RSA 签名／验签</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-AES-CBC-%E5%8A%A0%E8%A7%A3%E5%AF%86"><span class="toc-number">4.2.3.</span> <span class="toc-text">3. AES-CBC 加解密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E4%B8%BB%E6%B5%81%E7%A8%8B"><span class="toc-number">4.2.4.</span> <span class="toc-text">4. 主流程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%AE%8C%E6%95%B4%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%8A%A0%E4%B8%8A%E2%80%9C%E5%AF%86%E9%92%A5%E5%B0%81%E8%A3%85%E2%80%9D%E7%9A%84%E6%94%B9%E8%BF%9B"><span class="toc-number">4.3.</span> <span class="toc-text">三、完整示例：加上“密钥封装”的改进</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93"><span class="toc-number">4.3.1.</span> <span class="toc-text">小结</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/05/29/snakeyaml%E4%B8%8D%E5%87%BA%E7%BD%91%E5%88%A9%E7%94%A8/" title="fastjson&amp;&amp;snakeyaml不出网利用"><img src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover21.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="fastjson&amp;&amp;snakeyaml不出网利用"/></a><div class="content"><a class="title" href="/2025/05/29/snakeyaml%E4%B8%8D%E5%87%BA%E7%BD%91%E5%88%A9%E7%94%A8/" title="fastjson&amp;&amp;snakeyaml不出网利用">fastjson&amp;&amp;snakeyaml不出网利用</a><time datetime="2025-05-29T02:06:01.000Z" title="发表于 2025-05-29 10:06:01">2025-05-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/25/%E6%98%A5%E7%A7%8BThermalPower/" title="春秋ThermalPower"><img src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover0.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="春秋ThermalPower"/></a><div class="content"><a class="title" href="/2025/05/25/%E6%98%A5%E7%A7%8BThermalPower/" title="春秋ThermalPower">春秋ThermalPower</a><time datetime="2025-05-25T14:01:09.000Z" title="发表于 2025-05-25 22:01:09">2025-05-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/20/palu/" title="palu"><img src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover83.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="palu"/></a><div class="content"><a class="title" href="/2025/05/20/palu/" title="palu">palu</a><time datetime="2025-05-20T13:31:12.000Z" title="发表于 2025-05-20 21:31:12">2025-05-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/13/%E5%B7%A5%E5%85%B7%E5%88%86%E6%9E%90ysoSerial/" title="工具分析ysoSerial"><img src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover14.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="工具分析ysoSerial"/></a><div class="content"><a class="title" href="/2025/05/13/%E5%B7%A5%E5%85%B7%E5%88%86%E6%9E%90ysoSerial/" title="工具分析ysoSerial">工具分析ysoSerial</a><time datetime="2025-05-13T07:21:00.000Z" title="发表于 2025-05-13 15:21:00">2025-05-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/10/java%E5%BC%80%E5%8F%91/" title="java开发"><img src="https://raw.githubusercontent.com/lisien11/lisien11.github.io/refs/heads/master/cover/cover16.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="java开发"/></a><div class="content"><a class="title" href="/2025/05/10/java%E5%BC%80%E5%8F%91/" title="java开发">java开发</a><time datetime="2025-05-10T07:13:47.000Z" title="发表于 2025-05-10 15:13:47">2025-05-10</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By L</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat-btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(() => {
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://tw-sigma.vercel.app/',
      region: 'ap-guangzhou',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(init,0)
    else getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(init)
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://tw-sigma.vercel.app/',
      region: 'ap-guangzhou',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else {
      loadTwikoo()
      
    }
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><script async data-pjax src="/js/LSE.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>